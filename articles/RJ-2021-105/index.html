<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Visual Diagnostics for Constrained Optimisation with Application to Guided Tours</title>

<meta property="description" itemprop="description" content="A guided tour helps to visualise high-dimensional data by showing low-dimensional projections along a projection pursuit optimisation path. Projection pursuit is a generalisation of principal component analysis in the sense that different indexes are used to define the interestingness of the projected data. While much work has been done in developing new indexes in the literature, less has been done on understanding the optimisation. Index functions can be noisy, might have multiple local maxima as well as an optimal maximum, and are constrained to generate orthonormal projection frames, which complicates the optimization. In addition, projection pursuit is primarily used for exploratory data analysis, and finding the local maxima is also useful. The guided tour is especially useful for exploration because it conducts geodesic interpolation connecting steps in the optimisation and shows how the projected data changes as a maxima is approached. This work provides new visual diagnostics for examining a choice of optimisation procedure based on the provision of a new data object which collects information throughout the optimisation. It has helped to diagnose and fix several problems with projection pursuit guided tour. This work might be useful more broadly for diagnosing optimisers and comparing their performance. The diagnostics are implemented in the R package [ferrn](https://github.com/huizezhang-sherry/ferrn)."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2021-105/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-12-15"/>
<meta property="article:created" itemprop="dateCreated" content="2021-12-15"/>
<meta name="article:author" content="H. Sherry Zhang"/>
<meta name="article:author" content="Dianne Cook"/>
<meta name="article:author" content="Ursula Laa"/>
<meta name="article:author" content="Nicolas Langrené"/>
<meta name="article:author" content="Patricia Menéndez"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Visual Diagnostics for Constrained Optimisation with Application to Guided Tours"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A guided tour helps to visualise high-dimensional data by showing low-dimensional projections along a projection pursuit optimisation path. Projection pursuit is a generalisation of principal component analysis in the sense that different indexes are used to define the interestingness of the projected data. While much work has been done in developing new indexes in the literature, less has been done on understanding the optimisation. Index functions can be noisy, might have multiple local maxima as well as an optimal maximum, and are constrained to generate orthonormal projection frames, which complicates the optimization. In addition, projection pursuit is primarily used for exploratory data analysis, and finding the local maxima is also useful. The guided tour is especially useful for exploration because it conducts geodesic interpolation connecting steps in the optimisation and shows how the projected data changes as a maxima is approached. This work provides new visual diagnostics for examining a choice of optimisation procedure based on the provision of a new data object which collects information throughout the optimisation. It has helped to diagnose and fix several problems with projection pursuit guided tour. This work might be useful more broadly for diagnosing optimisers and comparing their performance. The diagnostics are implemented in the R package [ferrn](https://github.com/huizezhang-sherry/ferrn)."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2021-105/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2021-105/preview.png"/>
<meta property="og:image:width" content="720"/>
<meta property="og:image:height" content="360"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Visual Diagnostics for Constrained Optimisation with Application to Guided Tours"/>
<meta property="twitter:description" content="A guided tour helps to visualise high-dimensional data by showing low-dimensional projections along a projection pursuit optimisation path. Projection pursuit is a generalisation of principal component analysis in the sense that different indexes are used to define the interestingness of the projected data. While much work has been done in developing new indexes in the literature, less has been done on understanding the optimisation. Index functions can be noisy, might have multiple local maxima as well as an optimal maximum, and are constrained to generate orthonormal projection frames, which complicates the optimization. In addition, projection pursuit is primarily used for exploratory data analysis, and finding the local maxima is also useful. The guided tour is especially useful for exploration because it conducts geodesic interpolation connecting steps in the optimisation and shows how the projected data changes as a maxima is approached. This work provides new visual diagnostics for examining a choice of optimisation procedure based on the provision of a new data object which collects information throughout the optimisation. It has helped to diagnose and fix several problems with projection pursuit guided tour. This work might be useful more broadly for diagnosing optimisers and comparing their performance. The diagnostics are implemented in the R package [ferrn](https://github.com/huizezhang-sherry/ferrn)."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2021-105/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2021-105/preview.png"/>
<meta property="twitter:image:width" content="720"/>
<meta property="twitter:image:height" content="360"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Visual Diagnostics for Constrained Optimisation with Application to Guided Tours"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2021-105"/>
<meta name="citation_pdf_url" content="RJ-2021-105.pdf"/>
<meta name="citation_volume" content="13"/>
<meta name="citation_issue" content="2"/>
<meta name="citation_doi" content="10.32614/RJ-2021-105"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="624"/>
<meta name="citation_lastpage" content="641"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2021/12/15"/>
<meta name="citation_publication_date" content="2021/12/15"/>
<meta name="citation_author" content="H. Sherry Zhang"/>
<meta name="citation_author_institution" content="Monash University"/>
<meta name="citation_author" content="Dianne Cook"/>
<meta name="citation_author_institution" content="Monash University"/>
<meta name="citation_author" content="Ursula Laa"/>
<meta name="citation_author_institution" content="University of Natural Resources and Life Sciences"/>
<meta name="citation_author" content="Nicolas Langrené"/>
<meta name="citation_author_institution" content="CSIRO Data61"/>
<meta name="citation_author" content="Patricia Menéndez"/>
<meta name="citation_author_institution" content="Monash University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Grand tour methods: An outline;citation_publisher=Elsevier North-Holland, Inc.;citation_author=Andreas Buja;citation_author=Daniel Asimov"/>
  <meta name="citation_reference" content="citation_title=Ferrn: Facilitate exploration of touRR optimisatioN;citation_author=H. Sherry Zhang;citation_author=Dianne Cook;citation_author=Ursula Laa;citation_author=Nicolas Langrené;citation_author=Patricia Menéndez"/>
  <meta name="citation_reference" content="citation_title=Exploratory data analysis;citation_publisher=Reading, MA;citation_volume=2;citation_author=John W Tukey"/>
  <meta name="citation_reference" content="citation_title=Graphical data analysis with r;citation_publisher=CRC Press;citation_volume=27;citation_author=Antony Unwin"/>
  <meta name="citation_reference" content="citation_title=Fundamentals of data visualization: A primer on making informative and compelling figures;citation_publisher=O’Reilly Media;citation_author=Claus O Wilke"/>
  <meta name="citation_reference" content="citation_title=Data visualization: A practical introduction;citation_publisher=Princeton University Press;citation_author=Kieran Healy"/>
  <meta name="citation_reference" content="citation_title=Visualizing neural networks with the grand tour;citation_author=Mingwei Li;citation_author=Zhenge Zhao;citation_author=Carlos Scheidegger"/>
  <meta name="citation_reference" content="citation_title=Computational methods for high-dimensional rotations in data visualization;citation_publisher=Elsevier;citation_volume=24;citation_author=Andreas Buja;citation_author=Dianne Cook;citation_author=Daniel Asimov;citation_author=Catherine Hurley"/>
  <meta name="citation_reference" content="citation_title=Grand tours, projection pursuit guided tours, and manual controls;citation_publisher=Springer;citation_author=Dianne Cook;citation_author=Andreas Buja;citation_author=Eun-Kyung Lee;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Efficient global optimization of expensive black-box functions;citation_publisher=Springer;citation_volume=13;citation_author=Donald R Jones;citation_author=Matthias Schonlau;citation_author=William J Welch"/>
  <meta name="citation_reference" content="citation_title=Constrained optimization and lagrange multiplier methods;citation_publisher=Academic press;citation_author=Dimitri P Bertsekas"/>
  <meta name="citation_reference" content="citation_title=Derivative-free optimization: A review of algorithms and comparison of software implementations;citation_publisher=Springer;citation_volume=56;citation_author=Luis Miguel Rios;citation_author=Nikolaos V Sahinidis"/>
  <meta name="citation_reference" content="citation_title=Introduction to derivative-free optimization;citation_publisher=SIAM;citation_author=Andrew R Conn;citation_author=Katya Scheinberg;citation_author=Luis N Vicente"/>
  <meta name="citation_reference" content="citation_title=Stochastic adaptive search for global optimization;citation_publisher=Springer Science &amp; Business Media;citation_volume=72;citation_author=Zelda B Zabinsky"/>
  <meta name="citation_reference" content="citation_title=Random search methods;citation_publisher=Springer US;citation_author=H. Edwin Romeijn"/>
  <meta name="citation_reference" content="citation_title=A review of random search methods;citation_publisher=Springer;citation_author=Sigrún Andradóttir"/>
  <meta name="citation_reference" content="citation_title=A discussion of random methods for seeking maxima;citation_publisher=INFORMS;citation_volume=6;citation_author=Samuel H Brooks"/>
  <meta name="citation_reference" content="citation_title=Introduction to stochastic search and optimization: Estimation, simulation, and control;citation_publisher=John Wiley &amp; Sons;citation_volume=65;citation_author=James C Spall"/>
  <meta name="citation_reference" content="citation_title=A survey of random methods for parameter optimization;citation_publisher=SAGE Publications Ltd STM;citation_volume=17;citation_author=R C White"/>
  <meta name="citation_reference" content="citation_title=Optimization by simulated annealing;citation_publisher=American association for the advancement of science;citation_volume=220;citation_author=Scott Kirkpatrick;citation_author=C Daniel Gelatt;citation_author=Mario P Vecchi"/>
  <meta name="citation_reference" content="citation_title=Simulated annealing;citation_publisher=Institute of Mathematical Statistics;citation_volume=8;citation_author=Dimitris Bertsimas;citation_author=John Tsitsiklis"/>
  <meta name="citation_reference" content="citation_title=Convergence and finite-time behavior of simulated annealing;citation_publisher=Cambridge University Press;citation_volume=18;citation_author=Debasis Mitra;citation_author=Fabio Romeo;citation_author=Alberto Sangiovanni-Vincentelli"/>
  <meta name="citation_reference" content="citation_title=Simulated annealing: A proof of convergence;citation_publisher=IEEE;citation_volume=16;citation_author=Vincent Granville;citation_author=Mirko Krivánek;citation_author=J-P Rasson"/>
  <meta name="citation_reference" content="citation_title=A projection pursuit algorithm for exploratory data analysis;citation_publisher=IEEE;citation_volume=100;citation_author=Jerome H Friedman;citation_author=John W Tukey"/>
  <meta name="citation_reference" content="citation_title=Grand tour and projection pursuit;citation_publisher=Taylor &amp; Francis Group;citation_volume=4;citation_author=Dianne Cook;citation_author=Andreas Buja;citation_author=Javier Cabrera;citation_author=Catherine Hurley"/>
  <meta name="citation_reference" content="citation_title=Asymptotics of graphical projection pursuit;citation_publisher=JSTOR;citation_author=Persi Diaconis;citation_author=David Freedman"/>
  <meta name="citation_reference" content="citation_title=On polynomial-based projection indices for exploratory projection pursuit;citation_publisher=Institute of Mathematical Statistics;citation_volume=17;citation_author=Peter Hall"/>
  <meta name="citation_reference" content="citation_title=Projection pursuit indexes based on orthonormal function expansions;citation_publisher=Taylor &amp; Francis Group;citation_volume=2;citation_author=D. Cook;citation_author=A. Buja;citation_author=J. Cabrera"/>
  <meta name="citation_reference" content="citation_title=Projection pursuit exploratory data analysis;citation_publisher=Elsevier;citation_volume=20;citation_author=Christian Posse"/>
  <meta name="citation_reference" content="citation_title=Projection pursuit for exploratory supervised classification;citation_publisher=Taylor &amp; Francis;citation_volume=14;citation_author=E. Lee;citation_author=D. Cook;citation_author=S. Klinke;citation_author=T. Lumley"/>
  <meta name="citation_reference" content="citation_title=A projection pursuit index for large p small n data;citation_publisher=Springer;citation_volume=20;citation_author=Eun-Kyung Lee;citation_author=Dianne Cook"/>
  <meta name="citation_reference" content="citation_title=Kurtosis-based projection pursuit for outlier detection in financial time series;citation_publisher=Routledge;citation_volume=26;citation_author=Nicola Loperfido"/>
  <meta name="citation_reference" content="citation_title=Skewness-based projection pursuit: A computational approach;citation_publisher=Elsevier;citation_volume=120;citation_author=Nicola Loperfido"/>
  <meta name="citation_reference" content="citation_title=Using tours to visually investigate properties of new projection pursuit indexes with application to problems in physics;citation_publisher=Springer;citation_author=Ursula Laa;citation_author=Dianne Cook"/>
  <meta name="citation_reference" content="citation_title=Manual controls for high-dimensional data projections;citation_publisher=Taylor &amp; Francis;citation_volume=6;citation_author=Dianne Cook;citation_author=Andreas Buja"/>
  <meta name="citation_reference" content="citation_title=tourr: An R package for exploring multivariate data with projections;citation_volume=40;citation_author=H. Wickham;citation_author=D. Cook;citation_author=H. Hofmann;citation_author=A. Buja"/>
  <meta name="citation_reference" content="citation_title=Tidy data;citation_volume=59;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Dplyr: A grammar of data manipulation;citation_author=Hadley Wickham;citation_author=Romain François;citation_author=Lionel  Henry;citation_author=Kirill Müller"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Elegant graphics for data analysis;citation_publisher=Springer-Verlag New York;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Geozoo: Zoo of geometric objects;citation_author=Barret Schloerke"/>
  <meta name="citation_reference" content="citation_title=Dynamic documents with R and knitr;citation_publisher=Chapman; Hall/CRC;citation_author=Yihui Xie"/>
  <meta name="citation_reference" content="citation_title=R markdown: The definitive guide;citation_publisher=Chapman; Hall/CRC;citation_author=Yihui Xie;citation_author=J. J. Allaire;citation_author=Garrett Grolemund"/>
  <meta name="citation_reference" content="citation_title=Graph-theoretic scagnostics;citation_volume=;citation_issn=1522-404X;citation_author=L. Wilkinson;citation_author=A. Anand;citation_author=R. Grossman"/>
  <meta name="citation_reference" content="citation_title=Scagnostics distributions;citation_publisher=Taylor &amp; Francis;citation_volume=17;citation_author=Leland Wilkinson;citation_author=Graham Wills"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","description","keywords","preamble","type","date","date_received","journal","volume","issue","slug","packages","preview","CTV","output","css","bibliography","draft","pdf_url","citation_url","doi","creative_commons","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Visual Diagnostics for Constrained Optimisation with Application to Guided Tours"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["H. Sherry Zhang"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Department of Econometrics and Business Statistics","Melbourne, Australia"]},{"type":"character","attributes":{},"value":["huize.zhang@monash.edu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Dianne Cook"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Department of Econometrics and Business Statistics","Melbourne, Australia"]},{"type":"character","attributes":{},"value":["dicook@monash.edu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Ursula Laa"]},{"type":"character","attributes":{},"value":["University of Natural Resources and Life Sciences"]},{"type":"character","attributes":{},"value":["Institute of Statistics","Vienna, Austria"]},{"type":"character","attributes":{},"value":["ursula.laa@boku.ac.at"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Nicolas Langrené"]},{"type":"character","attributes":{},"value":["CSIRO Data61"]},{"type":"character","attributes":{},"value":["34 Village Street, Docklands VIC 3008 Australia","Melbourne, Australia"]},{"type":"character","attributes":{},"value":["nicolas.langrene@csiro.au"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Patricia Menéndez"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Department of Econometrics and Business Statistics","Melbourne, Australia"]},{"type":"character","attributes":{},"value":["patricia.menendez@monash.edu"]}]}]},{"type":"character","attributes":{},"value":["A guided tour helps to visualise high-dimensional data by showing low-dimensional projections along a projection pursuit optimisation path. Projection pursuit is a generalisation of principal component analysis in the sense that different indexes are used to define the interestingness of the projected data. While much work has been done in developing new indexes in the literature, less has been done on understanding the optimisation. Index functions can be noisy, might have multiple local maxima as well as an optimal maximum, and are constrained to generate orthonormal projection frames, which complicates the optimization. In addition, projection pursuit is primarily used for exploratory data analysis, and finding the local maxima is also useful. The guided tour is especially useful for exploration because it conducts geodesic interpolation connecting steps in the optimisation and shows how the projected data changes as a maxima is approached. This work provides new visual diagnostics for examining a choice of optimisation procedure based on the provision of a new data object which collects information throughout the optimisation. It has helped to diagnose and fix several problems with projection pursuit guided tour. This work might be useful more broadly for diagnosing optimisers and comparing their performance. The diagnostics are implemented in the R package [ferrn](https://github.com/huizezhang-sherry/ferrn)."]},{"type":"character","attributes":{},"value":["graphics, multivariate, optimization"]},{"type":"character","attributes":{},"value":["\\usepackage{mathtools, longtable} \\usepackage[ruled, linesnumbered]{algorithm2e} \\usepackage{longtable}\n"]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["2021-12-15"]},{"type":"character","attributes":{},"value":["2021-04-12"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[624]},{"type":"integer","attributes":{},"value":[641]}]},{"type":"integer","attributes":{},"value":[13]},{"type":"integer","attributes":{},"value":[2]},{"type":"character","attributes":{},"value":["RJ-2021-105"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["ferrn","tourr","dplyr","ggplot2","geozoo","knitr","rmarkdown"]},{"type":"NULL"}]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["ReproducibleResearch","Databases","ModelDeployment","Multivariate","Phylogenetics","TeachingStatistics"]},{"type":"character","attributes":{},"value":["rjtools::rjournal_web_article"]},{"type":"character","attributes":{},"value":["style.css"]},{"type":"character","attributes":{},"value":["zhang-cook-laa-langrene-menendez.bib"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["RJ-2021-105.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2021-105"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2021-105"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.1/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2021-105/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["DESCRIPTION","RJ-2021-105.log","RJ-2021-105.pdf","RJ-2021-105.tex","RJournal.sty","RJwrapper.log","RJwrapper.tex","anim/pca/pca0001.png","anim/pca/pca0002.png","anim/pca/pca0003.png","anim/pca/pca0004.png","anim/pca/pca0005.png","anim/pca/pca0006.png","anim/pca/pca0007.png","anim/pca/pca0008.png","anim/pca/pca0009.png","anim/pca/pca0010.png","anim/pca/pca0011.png","anim/pca/pca0012.png","anim/pca/pca0013.png","anim/pca/pca0014.png","anim/pca/pca0015.png","anim/pca/pca0016.png","anim/pca/pca0017.png","anim/pca/pca0018.png","anim/pca/pca0019.png","anim/pca/pca0020.png","anim/pca/pca0021.png","anim/pca/pca0022.png","anim/pca/pca0023.png","anim/pca/pca0024.png","anim/pca/pca0025.png","anim/pca/pca0026.png","anim/pca/pca0027.png","anim/pca/pca0028.png","anim/pca/pca0029.png","anim/pca/pca0030.png","anim/pca/pca0031.png","anim/pca/pca0032.png","anim/pca/pca0033.png","anim/pca/pca0034.png","anim/pca/pca0035.png","anim/pca/pca0036.png","anim/pca/pca0037.png","anim/pca/pca0038.png","anim/pca/pca0039.png","anim/pca/pca0040.png","anim/pca/pca0041.png","anim/pca/pca0042.png","anim/pca/pca0043.png","anim/pca/pca0044.png","anim/pca/pca0045.png","anim/pca/pca0046.png","anim/pca/pca0047.png","anim/pca/pca0048.png","anim/pca/pca0049.png","anim/pca/pca0050.png","anim/pca/pca0051.png","anim/pca/pca0052.png","anim/pca/pca0053.png","anim/pca/pca0054.png","anim/pca/pca0055.png","anim/pca/pca0056.png","anim/pca/pca0057.png","anim/pca/pca0058.png","anim/pca/pca0059.png","anim/pca/pca0060.png","anim/pca/pca0061.png","anim/pca/pca0062.png","anim/pca/pca0063.png","anim/pca/pca0064.png","anim/pca/pca0065.png","anim/pca/pca0066.png","anim/pca/pca0067.png","anim/pca/pca0068.png","anim/pca/pca0069.png","anim/pca/pca0070.png","anim/pca/pca0071.png","anim/pca/pca0072.png","anim/pca/pca0073.png","anim/pca/pca0074.png","anim/pca/pca0075.png","anim/pca/pca0076.png","anim/pca/pca0077.png","anim/pca/pca0078.png","anim/pca/pca0079.png","anim/pca/pca0080.png","anim/pca/pca0081.png","anim/pca/pca0082.png","anim/pca/pca0083.png","anim/pca/pca0084.png","anim/pca/pca0085.png","anim/pca/pca0086.png","anim/pca/pca0087.png","anim/pca/pca0088.png","anim/pca/pca0089.png","anim/pca/pca0090.png","anim/pca/pca0091.png","anim/pca/pca0092.png","anim/pca/pca0093.png","anim/pca/pca0094.png","anim/pca/pca0095.png","anim/pca/pca0096.png","anim/pca/pca0097.png","anim/pca/pca0098.png","anim/pca/pca0099.png","anim/pca/pca0100.png","anim/polish/after001.png","anim/polish/after002.png","anim/polish/after003.png","anim/polish/after004.png","anim/polish/after005.png","anim/polish/after006.png","anim/polish/before001.png","anim/polish/before002.png","anim/polish/before003.png","anim/polish/before004.png","anim/polish/before005.png","anim/polish/before006.png","anim/polish/before007.png","anim/polish/before008.png","anim/polish/before009.png","anim/polish/before010.png","anim/polish/before011.png","anim/polish/before012.png","anim/polish/before013.png","anim/polish/before014.png","anim/polish/before015.png","anim/polish/before016.png","anim/polish/before017.png","anim/polish/before018.png","anim/polish/before019.png","anim/polish/before020.png","anim/polish/before021.png","anim/polish/before022.png","anim/polish/before023.png","anim/polish/before024.png","anim/polish/before025.png","anim/polish/before026.png","anim/polish/before027.png","anim/polish/before028.png","anim/polish/before029.png","anim/polish/before030.png","anim/polish/before031.png","anim/polish/before032.png","anim/polish/before033.png","anim/polish/before034.png","anim/polish/before035.png","anim/polish/before036.png","anim/polish/before037.png","anim/polish/before038.png","anim/polish/before039.png","anim/polish/before040.png","anim/polish/before041.png","anim/polish/before042.png","anim/polish/before043.png","anim/polish/before044.png","anim/polish/before045.png","anim/polish/before046.png","anim/polish/before047.png","anim/polish/before048.png","anim/polish/before049.png","anim/polish/before050.png","anim/polish/before051.png","anim/polish/before052.png","anim/polish/before053.png","anim/polish/before054.png","anim/polish/before055.png","anim/polish/before056.png","anim/polish/before057.png","anim/polish/before058.png","anim/polish/before059.png","anim/polish/before060.png","anim/polish/before061.png","anim/polish/before062.png","anim/polish/before063.png","anim/polish/before064.png","anim/polish/before065.png","anim/polish/before066.png","anim/polish/before067.png","anim/polish/before068.png","anim/polish/before069.png","anim/polish/before070.png","anim/polish/before071.png","anim/polish/before072.png","anim/polish/before073.png","anim/torus.gif","anim/torus/torus001.png","anim/torus/torus002.png","anim/torus/torus003.png","anim/torus/torus004.png","anim/torus/torus005.png","anim/torus/torus006.png","anim/torus/torus007.png","anim/torus/torus008.png","anim/torus/torus009.png","anim/torus/torus010.png","anim/torus/torus011.png","anim/torus/torus012.png","anim/torus/torus013.png","anim/torus/torus014.png","anim/torus/torus015.png","anim/torus/torus016.png","anim/torus/torus017.png","anim/torus/torus018.png","anim/torus/torus019.png","anim/torus/torus020.png","anim/torus/torus021.png","anim/torus/torus022.png","anim/torus/torus023.png","anim/torus/torus024.png","anim/torus/torus025.png","anim/torus/torus026.png","anim/torus/torus027.png","anim/torus/torus028.png","anim/torus/torus029.png","anim/torus/torus030.png","anim/torus/torus031.png","anim/torus/torus032.png","anim/torus/torus033.png","anim/torus/torus034.png","anim/torus/torus035.png","anim/torus/torus036.png","anim/torus/torus037.png","anim/torus/torus038.png","anim/torus/torus039.png","anim/torus/torus040.png","anim/torus/torus041.png","anim/torus/torus042.png","anim/torus/torus043.png","anim/torus/torus044.png","anim/torus/torus045.png","anim/torus/torus046.png","anim/torus/torus047.png","anim/torus/torus048.png","anim/torus/torus049.png","anim/torus/torus050.png","anim/torus/torus051.png","anim/torus/torus052.png","anim/torus/torus053.png","anim/torus/torus054.png","anim/torus/torus055.png","anim/torus/torus056.png","anim/torus/torus057.png","anim/torus/torus058.png","anim/torus/torus059.png","anim/torus/torus060.png","anim/torus/torus061.png","anim/torus/torus062.png","anim/torus/torus063.png","anim/torus/torus064.png","anim/torus/torus065.png","anim/torus/torus066.png","anim/torus/torus067.png","anim/torus/torus068.png","anim/torus/torus069.png","anim/torus/torus070.png","anim/torus/torus071.png","anim/torus/torus072.png","anim/torus/torus073.png","anim/torus/torus074.png","anim/torus/torus075.png","anim/torus/torus076.png","anim/torus/torus077.png","anim/torus/torus078.png","anim/torus/torus079.png","anim/torus/torus080.png","anim/torus/torus081.png","anim/torus/torus082.png","anim/torus/torus083.png","anim/torus/torus084.png","anim/torus/torus085.png","anim/torus/torus086.png","anim/torus/torus087.png","anim/torus/torus088.png","anim/torus/torus089.png","anim/torus/torus090.png","anim/torus/torus091.png","anim/torus/torus092.png","anim/torus/torus093.png","anim/torus/torus094.png","anim/torus/torus095.png","anim/torus/torus096.png","anim/torus/torus097.png","anim/torus/torus098.png","anim/torus/torus099.png","anim/torus/torus100.png","anim/tour.gif","anim/tour/tour001.png","anim/tour/tour002.png","anim/tour/tour003.png","anim/tour/tour004.png","anim/tour/tour005.png","anim/tour/tour006.png","anim/tour/tour007.png","anim/tour/tour008.png","anim/tour/tour009.png","anim/tour/tour010.png","anim/tour/tour011.png","anim/tour/tour012.png","anim/tour/tour013.png","anim/tour/tour014.png","anim/tour/tour015.png","anim/tour/tour016.png","anim/tour/tour017.png","anim/tour/tour018.png","anim/tour/tour019.png","anim/tour/tour020.png","anim/tour/tour021.png","anim/tour/tour022.png","anim/tour/tour023.png","anim/tour/tour024.png","anim/tour/tour025.png","anim/tour/tour026.png","anim/tour/tour027.png","anim/tour/tour028.png","anim/tour/tour029.png","anim/tour/tour030.png","anim/tour/tour031.png","anim/tour/tour032.png","anim/tour/tour033.png","anim/tour/tour034.png","anim/tour/tour035.png","anim/tour/tour036.png","anim/tour/tour037.png","anim/tour/tour038.png","anim/tour/tour039.png","anim/tour/tour040.png","anim/tour/tour041.png","anim/tour/tour042.png","anim/tour/tour043.png","anim/tour/tour044.png","anim/tour/tour045.png","anim/tour/tour046.png","anim/tour/tour047.png","anim/tour/tour048.png","anim/tour/tour049.png","anim/tour/tour050.png","anim/tour/tour051.png","anim/tour/tour052.png","anim/tour/tour053.png","anim/tour/tour054.png","anim/tour/tour055.png","anim/tour/tour056.png","anim/tour/tour057.png","anim/tour/tour058.png","anim/tour/tour059.png","anim/tour/tour060.png","anim/tour/tour061.png","anim/tour/tour062.png","anim/tour/tour063.png","anim/tour/tour064.png","anim/tour/tour065.png","anim/tour/tour066.png","anim/tour/tour067.png","anim/tour/tour068.png","anim/tour/tour069.png","anim/tour/tour070.png","anim/tour/tour071.png","anim/tour/tour072.png","anim/tour/tour073.png","anim/tour/tour074.png","anim/tour/tour075.png","anim/tour/tour076.png","anim/tour/tour077.png","anim/tour/tour078.png","anim/tour/tour079.png","anim/tour/tour080.png","anim/tour/tour081.png","anim/tour/tour082.png","anim/tour/tour083.png","anim/tour/tour084.png","anim/tour/tour085.png","anim/tour/tour086.png","anim/tour/tour087.png","anim/tour/tour088.png","anim/tour/tour089.png","anim/tour/tour090.png","anim/tour/tour091.png","anim/tour/tour092.png","anim/tour/tour093.png","anim/tour/tour094.png","anim/tour/tour095.png","anim/tour/tour096.png","anim/tour/tour097.png","anim/tour/tour098.png","anim/tour/tour099.png","anim/tour/tour100.png","anim/toy-pca-animated.gif","anim.zip","data/after.rda","data/before.rda","data/clean.rda","data/holes_2d_better.rda","data/holes_2d_better_3var.rda","data/holes_2d_better_max_tries_polish.rda","data/holes_2d_better_polish.rda","data/holes_2d_better_random.rda","data/holes_2d_geo.rda","data/holes_2d_geo_3var.rda","data/holes_2d_geo_polish.rda","data/interrupt_no.rda","data/interrupt_yes.rda","data/kol_1d_better.rda","data/kol_1d_better_polish.rda","data/kol_1d_better_random.rda","data/kol_1d_geo.rda","data/orientation_corrected.rda","data/orientation_different.rda","figs/flip-sign.pdf","figs/flip-sign.svg","figs/interrupt.pdf","figs/interrupt.svg","figs/kol-result.pdf","figs/kol-result.svg","figs/noisy-better-geo.pdf","figs/noisy-better-geo.svg","figs/polish.pdf","figs/polish.svg","figs/tour-path.png","figs/toy-interp.pdf","figs/toy-interp.svg","figs/toy-pca-animated-1.pdf","figs/toy-pca.pdf","figs/toy-pca.svg","figs/toy-search.pdf","figs/toy-search.svg","figs/toy-torus-1.pdf","figs/toy-tour-1.pdf","preview.png","style.css","supplementaries.zip","supplementary_materials.pdf","zhang-cook-laa-langrene-menendez.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.24/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="https://twitter.com/intent/tweet?text='+title+'&url=' + cite_url + '" class="dt-tag"><i class="fab fa-twitter"></i> Tweet</a>')

      const abstract = $('<d-abstract>')
      abstract.append('<b>Abstract:</b><br>')
      abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
      $("d-title p:empty").remove() // Remove empty paragraphs after title
      abstract.append(buttons)
      abstract.insertAfter($('d-title')) // Add abstract section after title

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
  </style>

  <link rel="stylesheet" href="style.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Visual Diagnostics for Constrained Optimisation with Application to Guided Tours","description":"A guided tour helps to visualise high-dimensional data by showing low-dimensional projections along a projection pursuit optimisation path. Projection pursuit is a generalisation of principal component analysis in the sense that different indexes are used to define the interestingness of the projected data. While much work has been done in developing new indexes in the literature, less has been done on understanding the optimisation. Index functions can be noisy, might have multiple local maxima as well as an optimal maximum, and are constrained to generate orthonormal projection frames, which complicates the optimization. In addition, projection pursuit is primarily used for exploratory data analysis, and finding the local maxima is also useful. The guided tour is especially useful for exploration because it conducts geodesic interpolation connecting steps in the optimisation and shows how the projected data changes as a maxima is approached. This work provides new visual diagnostics for examining a choice of optimisation procedure based on the provision of a new data object which collects information throughout the optimisation. It has helped to diagnose and fix several problems with projection pursuit guided tour. This work might be useful more broadly for diagnosing optimisers and comparing their performance. The diagnostics are implemented in the R package [ferrn](https://github.com/huizezhang-sherry/ferrn).","doi":"10.32614/RJ-2021-105","authors":[{"author":"H. Sherry Zhang","authorURL":"#","affiliation":"Monash University","affiliationURL":"#","orcidID":""},{"author":"Dianne Cook","authorURL":"#","affiliation":"Monash University","affiliationURL":"#","orcidID":""},{"author":"Ursula Laa","authorURL":"#","affiliation":"University of Natural Resources and Life Sciences","affiliationURL":"#","orcidID":""},{"author":"Nicolas Langrené","authorURL":"#","affiliation":"CSIRO Data61","affiliationURL":"#","orcidID":""},{"author":"Patricia Menéndez","authorURL":"#","affiliation":"Monash University","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-12-15T00:00:00.000+00:00","citationText":"Zhang, et al., 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-1">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Visual Diagnostics for Constrained Optimisation with Application to Guided Tours</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A guided tour helps to visualise high-dimensional data by showing low-dimensional projections along a projection pursuit optimisation path. Projection pursuit is a generalisation of principal component analysis in the sense that different indexes are used to define the interestingness of the projected data. While much work has been done in developing new indexes in the literature, less has been done on understanding the optimisation. Index functions can be noisy, might have multiple local maxima as well as an optimal maximum, and are constrained to generate orthonormal projection frames, which complicates the optimization. In addition, projection pursuit is primarily used for exploratory data analysis, and finding the local maxima is also useful. The guided tour is especially useful for exploration because it conducts geodesic interpolation connecting steps in the optimisation and shows how the projected data changes as a maxima is approached. This work provides new visual diagnostics for examining a choice of optimisation procedure based on the provision of a new data object which collects information throughout the optimisation. It has helped to diagnose and fix several problems with projection pursuit guided tour. This work might be useful more broadly for diagnosing optimisers and comparing their performance. The diagnostics are implemented in the R package <a href="https://github.com/huizezhang-sherry/ferrn">ferrn</a>.</p></p>
</div>

<div class="d-byline">
  H. Sherry Zhang  (Monash University)
  
,   Dianne Cook  (Monash University)
  
,   Ursula Laa  (University of Natural Resources and Life Sciences)
  
,   Nicolas Langrené  (CSIRO Data61)
  
,   Patricia Menéndez  (Monash University)
  
<br/>2021-12-15
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<p>Visualisation is widely used in exploratory data analysis <span class="citation" data-cites="tukey1977exploratory unwin2015graphical healy2018data wilke2019fundamentals">(<a href="#ref-tukey1977exploratory" role="doc-biblioref">Tukey 1977</a>; <a href="#ref-unwin2015graphical" role="doc-biblioref">Unwin 2015</a>; <a href="#ref-healy2018data" role="doc-biblioref">Healy 2018</a>; <a href="#ref-wilke2019fundamentals" role="doc-biblioref">Wilke 2019</a>)</span>. Presenting information in graphics often unveils insights that would otherwise not be discovered and provides a more comprehensive understanding of the problem at hand. Task-specific tools such as <span class="citation" data-cites="li2020visualizing">Li et al. (<a href="#ref-li2020visualizing" role="doc-biblioref">2020</a>)</span> show how visualisation can be used to understand, for instance, the behaviour of the optimisation for the example of neural network classification models. However, no general visualisation tool is available for diagnosing optimisation procedures. The work presented in this paper brings visualization tools into optimisation problems with the aim to better understand the performance of optimisers in practice.</p>
<p>The focus of this paper is on the optimisation problem arising in the projection pursuit guided tour <span class="citation" data-cites="buja2005computational">(<a href="#ref-buja2005computational" role="doc-biblioref">Buja et al. 2005</a>)</span>, an exploratory data analysis technique used for detecting interesting structures in high-dimensional data through a set of lower-dimensional projections <span class="citation" data-cites="cook2008grand">(<a href="#ref-cook2008grand" role="doc-biblioref">Cook et al. 2008</a>)</span>. The goal of the optimisation is to identify the projection, represented by the projection matrix, that gives the most interesting low-dimensional view. A view is said to be interesting if it can show some structures of the data that depart from normality, such as bimodality, clustering, or outliers.</p>
<p>The optimization challenges encountered in the projection pursuit guided tour problem are common to those of optimization in general. Examples include the existence of multiple optima (local and global), the trade-off between computational burden and proximity to the optima, or dealing with noisy objective functions that might be non-smooth and non-differentiable <span class="citation" data-cites="jones1998efficient">(<a href="#ref-jones1998efficient" role="doc-biblioref">Jones et al. 1998</a>)</span>. The visualization tools, optimization methods, and conceptual framework presented in this paper can therefore be applied to other optimization problems.</p>
<p>The remainder of the paper is organised as follows. The next section provides an overview of optimisation methods, specifically random search and line search methods. A review of the projection pursuit guided tour, an overview of the optimisation problem and, outlines of three existing algorithms follows. The third section presents the new visual diagnostics, including the design of a data structure to capture information during the optimisation, from which several diagnostic plots are created. An illustration of how the diagnostic plots can be used to examine the performance of different optimisers and guide improvements to existing algorithms is shown using simulated data. Finally, an explanation of the implementation in the R package, <a href="https://cran.r-project.org/package=ferrn">ferrn</a> <span class="citation" data-cites="ferrn">(<a href="#ref-ferrn" role="doc-biblioref">Zhang et al. 2021</a>)</span>, is provided.</p>
<h1 data-number="2" id="optim"><span class="header-section-number">2</span> Optimisation methods</h1>
<p>The type of optimisation problem considered in this paper is constrained optimization <span class="citation" data-cites="bertsekas2014constrained">(<a href="#ref-bertsekas2014constrained" role="doc-biblioref">Bertsekas 2014</a>)</span>, assuming it is not possible to find a solution to the problem in the way of a closed-form. That is, the problem consists in finding the minimum or maximum of a function <span class="math inline">\(f \in L^p\)</span> in the constrained space <span class="math inline">\(\mathcal{A}\)</span>, where <span class="math inline">\(L^p\)</span> defines the vector space of function <span class="math inline">\(f\)</span>, whose <span class="math inline">\(p\)</span>th power is integrable.</p>
<p>Gradient-based methods are commonly used to optimise an objective function, with the most notable one being the gradient ascent (descent) method. Although these methods are popular, they rely on the availability of the objective function derivatives. As will be shown in the next section, the independent variables in our optimisation problem are the entries of a projection matrix, and the computational time required to perform differentiation on a matrix could impede the rendering of tour animation. In addition, some objective functions rely on the empirical distribution of the data, which makes it in general not possible to get the gradient. Hence, gradient-based methods are not the focus of this paper, and consideration will be given to derivative-free methods.</p>
<p>Derivative-free methods <span class="citation" data-cites="conn2009introduction rios2013derivative">(<a href="#ref-conn2009introduction" role="doc-biblioref">Conn et al. 2009</a>; <a href="#ref-rios2013derivative" role="doc-biblioref">Rios and Sahinidis 2013</a>)</span>, which do not rely on the knowledge of the gradient, are more generally applicable. Derivative-free methods have been developed over the years, where the emphasis is on finding, in most cases, a near-optimal solution. Here we consider three derivative-free methods, two of which are random search methods: creeping random search and simulated annealing, and the other one is pseudo-derivative search.</p>
<p>Random search methods <span class="citation" data-cites="Romeijn2009 zabinsky2013stochastic andradottir2015review">(<a href="#ref-Romeijn2009" role="doc-biblioref">Romeijn 2009</a>; <a href="#ref-zabinsky2013stochastic" role="doc-biblioref">Zabinsky 2013</a>; <a href="#ref-andradottir2015review" role="doc-biblioref">Andradóttir 2015</a>)</span> have a random sampling component as part of their algorithms and have been shown to have the ability to optimise non-convex and non-smooth functions. The initial random search algorithm, pure random search <span class="citation" data-cites="Brooks1958-zk">(<a href="#ref-Brooks1958-zk" role="doc-biblioref">Brooks 1958</a>)</span>, draws candidate points from the entire space without using any information of the current position and updates the current position when an improvement on the objective function is made. As the dimension of the space becomes larger, sufficient sampling from the entire space would require a long time for convergence to occur, despite a guaranteed global convergence <span class="citation" data-cites="spall2005introduction">(<a href="#ref-spall2005introduction" role="doc-biblioref">Spall 2005</a>)</span>. Various algorithms have thus been developed to improve pure random search by either concentrating on a narrower sampling space or using a different updating mechanism. Creeping random search <span class="citation" data-cites="White1971-ci">(<a href="#ref-White1971-ci" role="doc-biblioref">White 1971</a>)</span> is such a variation, where a candidate point is generated within a neighbourhood of the current point. This makes creeping random search faster to compute but global convergence is no longer guaranteed. On the other hand, simulated annealing <span class="citation" data-cites="kirkpatrick1983optimization bertsimas1993simulated">(<a href="#ref-kirkpatrick1983optimization" role="doc-biblioref">Kirkpatrick et al. 1983</a>; <a href="#ref-bertsimas1993simulated" role="doc-biblioref">Bertsimas and Tsitsiklis 1993</a>)</span>, introduces a different updating mechanism. Rather than only updating the current point when an improvement is made, it uses a Metropolis acceptance criterion, where worse candidates still have a chance to be accepted. The convergence of simulated annealing algorithms has been widely researched <span class="citation" data-cites="mitra1986convergence granville1994simulated">(<a href="#ref-mitra1986convergence" role="doc-biblioref">Mitra et al. 1986</a>; <a href="#ref-granville1994simulated" role="doc-biblioref">Granville et al. 1994</a>)</span> and the global optimum can be attained under mild regularity conditions.</p>
<p>The pseudo-derivative search uses a common search scheme in optimisation: line search. In line search methods, users are required to provide an initial estimate <span class="math inline">\(x_{1}\)</span> and, at each iteration, a search direction <span class="math inline">\(S_k\)</span> and a step size <span class="math inline">\(\alpha_k\)</span> are generated. Then one moves on to the next point following <span class="math inline">\(x_{k+1} = x_k + \alpha_kS_k\)</span> and the process is repeated until the desired convergence is reached. In derivative-free methods, local information of the objective function is used to determine the search direction. The choice of step size also needs consideration, as inadequate step sizes might prevent the optimisation method from converging to an optimum. An ideal step size can be chosen by finding the value of <span class="math inline">\(\alpha_k \in \mathbb{R}\)</span> that maximises <span class="math inline">\(f(x_k + \alpha_kS_k)\)</span> with respect to <span class="math inline">\(\alpha_k\)</span> at each iteration.</p>
<h1 data-number="3" id="projection-pursuit-guided-tour"><span class="header-section-number">3</span> Projection pursuit guided tour</h1>
<p>A projection pursuit guided tour combines two different methods (projection pursuit and guided tour) to explore interesting features in a high-dimensional space. Projection pursuit, coined by <span class="citation" data-cites="friedman1974projection">Friedman and Tukey (<a href="#ref-friedman1974projection" role="doc-biblioref">1974</a>)</span>, detects interesting structures (e.g., clustering, outliers, and skewness) in multivariate data via low-dimensional projections. Guided tour <span class="citation" data-cites="cook1995grand">(<a href="#ref-cook1995grand" role="doc-biblioref">Cook et al. 1995</a>)</span> is one variation of a broader class of data visualisation methods, tour <span class="citation" data-cites="buja2005computational">(<a href="#ref-buja2005computational" role="doc-biblioref">Buja et al. 2005</a>)</span>, which displays high-dimensional data through a series of animated projections.</p>
<p>Let <span class="math inline">\(\mathbf{X}_{n \times p}\)</span> be the data matrix with <span class="math inline">\(n\)</span> observations in <span class="math inline">\(p\)</span> dimensions. A <span class="math inline">\(d\)</span>-dimensional projection is a linear transformation from <span class="math inline">\(\mathbb{R}^p\)</span> into <span class="math inline">\(\mathbb{R}^d\)</span> defined as <span class="math inline">\(\mathbf{Y} = \mathbf{X} \cdot \mathbf{A}\)</span>, where <span class="math inline">\(\mathbf{Y}_{n \times d}\)</span> is the projected data and <span class="math inline">\(\mathbf{A}_{p\times d}\)</span> is the projection matrix. We define <span class="math inline">\(f: \mathbb{R}^{n \times d} \mapsto \mathbb{R}\)</span> to be an index function that maps the projected data <span class="math inline">\(\mathbf{Y}\)</span> onto a scalar value. This is commonly known as the projection pursuit index function, or just index function, and is used to measure the “interestingness” of a given projection. An interesting projection shows structures that are non-normal since theoretical proofs from <span class="citation" data-cites="diaconis1984asymptotics">Diaconis and Freedman (<a href="#ref-diaconis1984asymptotics" role="doc-biblioref">1984</a>)</span> have shown that projections tend to be normal as <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> approach infinity under certain conditions. There have been many index functions proposed in the literature, here are a few examples: early indexes that can be categorised as measuring the <span class="math inline">\(L^2\)</span> distance between the projection and a normal distribution: Legendre index <span class="citation" data-cites="friedman1974projection">(<a href="#ref-friedman1974projection" role="doc-biblioref">Friedman and Tukey 1974</a>)</span>; Hermite index <span class="citation" data-cites="hall1989polynomial">(<a href="#ref-hall1989polynomial" role="doc-biblioref">Hall 1989</a>)</span>; natural Hermite index <span class="citation" data-cites="cook1993projection">(<a href="#ref-cook1993projection" role="doc-biblioref">Cook et al. 1993</a>)</span>; chi-square index <span class="citation" data-cites="posse1995projection">(<a href="#ref-posse1995projection" role="doc-biblioref">Posse 1995</a>)</span> for detecting spiral structure; LDA index <span class="citation" data-cites="lee2005projection">(<a href="#ref-lee2005projection" role="doc-biblioref">Lee et al. 2005</a>)</span> and PDA <span class="citation" data-cites="lee2010projection">(<a href="#ref-lee2010projection" role="doc-biblioref">Lee and Cook 2010</a>)</span> index for supervised classification; kurtosis index <span class="citation" data-cites="Loperfido2020">(<a href="#ref-Loperfido2020" role="doc-biblioref">Loperfido 2020</a>)</span> and skewness index <span class="citation" data-cites="Loperfido2018">(<a href="#ref-Loperfido2018" role="doc-biblioref">Loperfido 2018</a>)</span> for detecting outliers in financial time series; and most recently, scagnostic indexes <span class="citation" data-cites="laa2020using">(<a href="#ref-laa2020using" role="doc-biblioref">Laa and Cook 2020</a>)</span> for summarising structures in scatterplot matrices based on eight scagnostic measures <span class="citation" data-cites="scag WW08">(<a href="#ref-scag" role="doc-biblioref">Wilkinson et al. 2005</a>; <a href="#ref-WW08" role="doc-biblioref">Wilkinson and Wills 2008</a>)</span>.</p>
<p>As a general visualisation method, tour produces animations of high-dimensional data via rotations of low-dimensional planes. There are different versions depending on how the high-dimensional space is investigated: grand tour <span class="citation" data-cites="cook2008grand">(<a href="#ref-cook2008grand" role="doc-biblioref">Cook et al. 2008</a>)</span> selects the planes randomly to provide a general overview; manual tour <span class="citation" data-cites="cook1997manual">(<a href="#ref-cook1997manual" role="doc-biblioref">Cook and Buja 1997</a>)</span> gradually phases in and out one variable to understand the contribution of that variable in the projection. Guided tour, the main interest of this paper, chooses the planes with the aid of projection pursuit to gradually reveal the most interesting projection. Given a random start, projection pursuit iteratively finds bases with higher index values, and the guided tour constructs a geodesic interpolation between these planes to form a tour path. Figure <a href="#fig:tour-path">1</a> shows a sketch of the tour path where the blue squares represent planes (targets) selected by the projection pursuit optimisation, and the white squares represent planes in the geodesic interpolation between targets. Mathematical details of the geodesic interpolation can be found in <span class="citation" data-cites="buja2005computational">Buja et al. (<a href="#ref-buja2005computational" role="doc-biblioref">2005</a>)</span>. (Note that the term <em>frame</em> used in Buja’s paper refers to a particular set of orthonormal vectors defining a plane. This is also conventionally referred to as a basis, which is used in this paper and the associated software.) The aforementioned tour method has been implemented in the R package <a href="https://cran.r-project.org/package=tourr">tourr</a> <span class="citation" data-cites="tourr">(<a href="#ref-tourr" role="doc-biblioref">Wickham et al. 2011</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tour-path"></span>
<img src="figs/tour-path.png" alt="A series of overlaying white and blue squares forming a path. A line passes through all the squares with an arrow pointing to the last blue square." width="100%" />
<p class="caption">
Figure 1: An illustration for demonstrating the frames in a tour path. Each square (frame) represents the projected data with a corresponding basis. Blue frames are returned by the projection pursuit optimisation and white frames are constructed between two blue frames by geodesic interpolation.
</p>
</div>
</div>
<h2 class="unnumbered" id="tour-optim">Optimisation in the tour</h2>
<p>In projection pursuit, the optimisation aims at finding the global and local maxima that give interesting projections according to an index function. That is, it starts with a given randomly selected basis <span class="math inline">\(\mathbf{A}_1\)</span> and aims at finding an optimal final projection basis <span class="math inline">\(\mathbf{A}_T\)</span> that satisfies the following optimisation problem:</p>
<p><span class="math display">\[\begin{align}
\arg \max_{\mathbf{A} \in \mathcal{A}} f(\mathbf{X} \cdot \mathbf{A})  ~~~ s.t. ~~~ \mathbf{A}^{\prime} \mathbf{A} = I_d \,,
\end{align}\]</span></p>
<p>where <span class="math inline">\(f\)</span> and <span class="math inline">\(\mathbf{X}\)</span> are defined as in the previous section, <span class="math inline">\(\mathcal{A}\)</span> is the set of all <span class="math inline">\(p\)</span>-dimensional projection bases, <span class="math inline">\(I_d\)</span> is the <span class="math inline">\(d\)</span>-dimensional identity matrix, and the constraint ensures the projection bases, <span class="math inline">\(\mathbf{A}\)</span>, to be orthonormal. It is worth noticing the following: 1) The optimisation is constrained, and the orthonormality constraint imposes a geometrical structure on the bases space: it forms a Stiefel manifold. 2) There may be index functions for which the objective function might not be differentiable. 3) While finding the global optimum is the goal of the optimisation problem, interesting projections may also appear in the local optimum. 4) The optimisation should be fast to compute since the tour animation is viewed by the users during the optimisation.</p>
<h2 class="unnumbered" id="existing-algorithms">Existing algorithms</h2>
<p>Three optimisers have been implemented in the <a href="#">tourr</a> <span class="citation" data-cites="tourr">(<a href="#ref-tourr" role="doc-biblioref">Wickham et al. 2011</a>)</span> package: creeping random search (CRS), simulated annealing (SA), and pseudo-derivative (PD). Creeping random search (CRS) is a random search optimiser that samples a candidate basis <span class="math inline">\(\mathbf{A}_{l}\)</span> in the neighbourhood of the current basis <span class="math inline">\(\mathbf{A}_{\text{cur}}\)</span> by <span class="math inline">\(\mathbf{A}_{l} = (1- \alpha)\mathbf{A}_{\text{cur}} + \alpha \mathbf{A}_{\text{rand}}\)</span> where <span class="math inline">\(\alpha \in [0,1]\)</span> controls the radius of the sampling neighbourhood and <span class="math inline">\(\mathbf{A}_{\text{rand}}\)</span> is generated randomly. <span class="math inline">\(\mathbf{A}_{l}\)</span> is then orthonormalised to fulfil the basis constraint. If <span class="math inline">\(\mathbf{A}_{l}\)</span> has an index value higher than the current basis <span class="math inline">\(\mathbf{A}_{\text{cur}}\)</span>, the optimiser outputs <span class="math inline">\(\mathbf{A}_{l}\)</span> for a guided tour to construct an interpolation path. The neighbourhood parameter <span class="math inline">\(\alpha\)</span> is adjusted by a cooling parameter: <span class="math inline">\(\alpha_{j+1} = \alpha_j * \text{cooling}\)</span> before the next iteration starts. The optimiser terminates when the maximum number of iteration <span class="math inline">\(l_{\max}\)</span> is reached before a better basis can be found. The algorithm of CRS can be found in the appendix. <span class="citation" data-cites="posse1995projection">Posse (<a href="#ref-posse1995projection" role="doc-biblioref">1995</a>)</span> has proposed a slightly different cooling scheme by introducing a halving parameter <span class="math inline">\(c\)</span>. In his proposal, <span class="math inline">\(\alpha\)</span> is only adjusted if the last iteration takes more than <span class="math inline">\(c\)</span> times to find a better basis.</p>
<p>Simulated annealing (SA) uses the same sampling process as CRS but allows a probabilistic acceptance of a basis with lower index value than the current one. Given an initial value of <span class="math inline">\(T_0 \in \mathbb{R^{+}}\)</span>, the “temperature” at iteration <span class="math inline">\(l\)</span> is defined as <span class="math inline">\(T(l) = \frac{T_0}{\log(l + 1)}\)</span>. When a candidate basis fails to have an index value larger than the current basis, SA gives it a second chance to be accepted with probability <span class="math display">\[P= \min\left\{\exp\left[-\frac{\mid I_{\text{cur}} - I_{l} \mid}{T(l)}\right],1\right\} \,,\]</span> where <span class="math inline">\(I_{(\cdot)} \in \mathbb{R}\)</span> denotes the index value of a given basis. This implementation allows the optimiser to make a move and explore the basis space even if the candidate basis does not have a higher index value. Hence it enables the optimiser to jump out of a local optimum. The second algorithm in the appendix highlights how SA differs from CRS in the inner loop.</p>
<p>Pseudo-derivative (PD) search uses a different strategy than CRS and SA. Rather than randomly sample the basis space, PD first computes a search direction by evaluating bases close to the current basis. The step size is then chosen along the corresponding geodesic by another optimisation over a 90 degree angle from <span class="math inline">\(-\pi/4\)</span> to <span class="math inline">\(\pi/4\)</span>. The resulting candidate basis <span class="math inline">\(\mathbf{A}_{**}\)</span> is returned for the current iteration if it has a higher index value than the current one. The third algorithm in the appendix summarises the inner loop of the PD.</p>
<h1 data-number="4" id="vis-diag"><span class="header-section-number">4</span> Visual diagnostics</h1>
<p>A data structure for diagnosing optimisers in projection pursuit guided tour is first defined. With this data structure, four types of diagnostic plots are presented.</p>
<h2 class="unnumbered" id="data-structure-for-diagnostics">Data structure for diagnostics</h2>
<p>Three main pieces of information are recorded during the projection pursuit optimisation: 1) projection bases <span class="math inline">\(\mathbf{A}\)</span>, 2) index values <span class="math inline">\(I\)</span>, and 3) state <span class="math inline">\(S\)</span>. For CRS and SA, possible states include <code>random_search</code>, <code>new_basis</code>, and <code>interpolation</code>. Pseudo-derivative (PD) has a wider variety of states, including <code>new_basis</code>, <code>direction_search</code>, <code>best_direction_search</code>, <code>best_line_search</code>, and <code>interpolation</code>. Multiple iterators index the information collected at different levels: <span class="math inline">\(t\)</span> is a unique identifier prescribing the natural ordering of each observation; <span class="math inline">\(j\)</span> and <span class="math inline">\(l\)</span> are the counter of the outer and inner loop, respectively. Other parameters of interest recorded, <span class="math inline">\(V\)</span>, include <code>method</code> that tags the name of the optimiser, and <code>alpha</code> that indicates the sampling neighbourhood size for searching observations. A matrix notation describing the data structure is:</p>
<div style="page-break-after: always;"></div>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(t\)</span></th>
<th><span class="math inline">\(\mathbf{A}\)</span></th>
<th><span class="math inline">\(I\)</span></th>
<th><span class="math inline">\(S\)</span></th>
<th><span class="math inline">\(j\)</span></th>
<th><span class="math inline">\(l\)</span></th>
<th><span class="math inline">\(V_{1}\)</span></th>
<th><span class="math inline">\(V_{2}\)</span></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(\mathbf{A}_1\)</span></td>
<td><span class="math inline">\(I_1\)</span></td>
<td><span class="math inline">\(S_1\)</span></td>
<td>1</td>
<td>1</td>
<td><span class="math inline">\(V_{11}\)</span></td>
<td><span class="math inline">\(V_{12}\)</span></td>
<td>start basis</td>
</tr>
<tr class="even">
<td><span class="math inline">\(2\)</span></td>
<td><span class="math inline">\(\mathbf{A}_2\)</span></td>
<td><span class="math inline">\(I_2\)</span></td>
<td><span class="math inline">\(S_2\)</span></td>
<td>2</td>
<td>1</td>
<td><span class="math inline">\(V_{21}\)</span></td>
<td><span class="math inline">\(V_{22}\)</span></td>
<td>search</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>2</td>
<td><span class="math inline">\(l_2\)</span></td>
<td>…</td>
<td>…</td>
<td>search (accepted)</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>2</td>
<td>1</td>
<td>…</td>
<td>…</td>
<td>interpolation</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>2</td>
<td><span class="math inline">\(k_2\)</span></td>
<td>…</td>
<td>…</td>
<td>interpolation</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td><span class="math inline">\(J\)</span></td>
<td>1</td>
<td>…</td>
<td>…</td>
<td>search</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(T\)</span></td>
<td><span class="math inline">\(\mathbf{A}_T\)</span></td>
<td><span class="math inline">\(I_T\)</span></td>
<td><span class="math inline">\(S_T\)</span></td>
<td><span class="math inline">\(J\)</span></td>
<td><span class="math inline">\(l_J\)</span></td>
<td><span class="math inline">\(V_{T1}\)</span></td>
<td><span class="math inline">\(V_{T2}\)</span></td>
<td>search (final)</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td><span class="math inline">\(J\)</span></td>
<td>1</td>
<td>…</td>
<td>…</td>
<td>interpolation</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td><span class="math inline">\(J\)</span></td>
<td><span class="math inline">\(k_J\)</span></td>
<td>…</td>
<td>…</td>
<td>interpolation</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td><span class="math inline">\(J+1\)</span></td>
<td>1</td>
<td>…</td>
<td>…</td>
<td>search (last round)</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(T^{\prime}\)</span></td>
<td><span class="math inline">\(\mathbf{A}_{T^{\prime}}\)</span></td>
<td><span class="math inline">\(I_{T^{\prime}}\)</span></td>
<td><span class="math inline">\(S_{T^{\prime}}\)</span></td>
<td><span class="math inline">\(J+1\)</span></td>
<td><span class="math inline">\(l_{J+1}\)</span></td>
<td><span class="math inline">\(V_{{T}^{\prime}1}\)</span></td>
<td><span class="math inline">\(V_{{T}^{\prime}2}\)</span></td>
<td>search (last round)</td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(T^{\prime} = T + k_{J}+ l_{J+1}\)</span>. Note that there is no output in iteration <span class="math inline">\(J + 1\)</span> since the optimiser does not find a better basis in the last iteration and terminates. The final basis found is <span class="math inline">\(A_T\)</span> with index value <span class="math inline">\(I_T\)</span>.</p>
<p>The data structure constructed above meets the tidy data principle <span class="citation" data-cites="wickham2014tidy">(<a href="#ref-wickham2014tidy" role="doc-biblioref">Wickham 2014</a>)</span> that requires each observation to form a row and each variable to form a column. With tidy data structure, data wrangling and visualisation can be significantly simplified by well-developed packages such as <a href="https://cran.r-project.org/package=dplyr">dplyr</a> <span class="citation" data-cites="dplyr">(<a href="#ref-dplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span> and <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span>.</p>
<h2 class="unnumbered" id="diagnostic-1-checking-how-hard-the-optimiser-is-working">Diagnostic 1: Checking how hard the optimiser is working</h2>
<p>A starting point of diagnosing an optimiser is to understand how many searches it has conducted, i.e., we want to summarise how the index is increasing over iterations and how many basis need to be sampled at each iteration. This is achieved using the function <code>explore_trace_search()</code>: a boxplot shows the distribution of index values for each try, where the accepted basis (corresponding to the highest index value) is always shown as a point. When there are only few tries at a given iteration, showing the data points directly is preferred over the boxplot and this is controlled via the <code>cutoff</code> argument. Additional annotations are added to facilitate better reading of the plot, and these include 1) the number of points searched in each iteration can be added as text label at the bottom of each iteration; 2) the anchor bases to interpolate are connected and highlighted in a larger size; 3) the colour of the last iteration is in greyscale to indicate no better basis found in this iteration.</p>
<p>Figure <a href="#fig:toy-search">2</a> shows an example of the search plot for CRS (left) and SA (right). Both optimisers quickly find better bases in the first few iterations and then take longer to find one in the later iterations. The anchor bases, the ones found with the highest index value in each iteration, always have an increased index value in the optimiser CRS while this is not the case for SA. This feature gives CRS an advantage in this simple example to quickly find the optimum.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:toy-search"></span>
<img src="figs/toy-search.svg" alt="Two plots of index value against the number of iteration. In each plot, a line connects the largest index value in each iteration. There are points or boxplots showing other sampled index values in some iterations. There is a number just above the x-axis with the number of searches in each iteration. The left plot has less iteration and finishes at a slightly higher index value than the right one. " width="100%" />
<p class="caption">
Figure 2: A comparison of the searches by two optimisers: CRS (left) and SA (right) on a 2D projection problem of a six-variable dataset, using the holes index. Both optimisers reach the final basis with a similar index value, while it takes SA longer to find the final basis. In the earlier iterations, optimisers quickly find a better basis to proceed, while in the later iterations, most sampled bases fail to make an improvement on the index value, and a boxplot is used to summarise the distribution of the index values. There is no better basis found in the last iteration, 9 (left) and 15 (right), before reaching the maximum number of try and hence it is coloured grey. The colour scale is from the customised botanical palette in the <strong>ferrn</strong> package.
</p>
</div>
</div>
<h2 class="unnumbered" id="toy-interp">Diagnostic 2: Examining the optimisation progress</h2>
<p>Another interesting feature to examine is the changes in the index value between interpolating bases since the projection on these bases is shown in the tour animation. Trace plots are created by plotting the index value against time. Figure <a href="#fig:toy-interp">3</a> presents the trace plot of the same optimisations as Figure <a href="#fig:toy-search">2</a>, and one can observe that the trace is smooth in both cases. It may seem bizarre at first sight that the interpolation sometimes passes bases with higher index values before it decreases to a lower target. This happens because, on the one hand, the probabilistic acceptance in SA implies that some worse bases will be accepted by the optimiser. In addition, the guided tour interpolates between the current and target basis to provide a smooth transition between projections, and sometimes a higher index value will be observed along the interpolation path. This indicates that a non-monotonic interpolation cannot be avoided, even for CRS. Later, in Section <em>A problem of non-monotonicity</em>, there will be a discussion on improving the non-monotonic interpolation for CRS.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:toy-interp"></span>
<img src="figs/toy-interp.svg" alt="Two line charts of time against index value. There are points coloured by the index value on each smooth increasing line. The left plot uses less time and the right plot has a few non-monotonic increases." width="100%" />
<p class="caption">
Figure 3: An inspection of the index values as the optimisation progress for two optimisers: CRS (left) and SA (right). The holes index is optimised for a 2D projection problem on the six-variable dataset . Lines indicate the interpolation, and dots indicate new target bases generated by the optimisers. Interpolation in both optimisation is smooth, while SA is observed to first pass by some bases with higher index values before reaching the target bases in time 76-130.
</p>
</div>
</div>
<h2 class="unnumbered" id="toy-pca">Diagnostic 3a: Understanding the optimiser’s coverage of the search space</h2>
<p>Apart from checking the search and progression of an optimiser, looking at where the bases are positioned in the basis space is also of interest. Given the orthonormality constraint, the space of projection bases <span class="math inline">\(\mathbf{A}_{p \times d}\)</span> is a Stiefel manifold. For one-dimensional projections, this forms a <span class="math inline">\(p\)</span>-dimensional sphere. A dimensionality reduction method, e.g., principal component analysis, is applied to first project all the bases onto a 2D space. In a projection pursuit guided tour optimisation, there are various types of bases involved: 1) The starting basis; 2) The search bases that the optimiser evaluated to produce the anchor bases; 3) The anchor bases that have the highest index value in each iteration; 4) The interpolating bases on the interpolation path; and finally, 5) the end basis. The importance of these bases differs but the most important ones are the starting, interpolating, and end bases. Sometimes, two optimisers can start with the same basis but finish with bases of opposite signs. This happens because the projection is invariant to the orientation of the basis, and so is the index value. However, this creates difficulties for comparing the optimisers since the end bases will be symmetric to the origin. A sign flipping step is conducted to flip the signs of all the bases in one routine if different optimisations finish at opposite places.</p>
<p>Several annotations have been made to help understand this plot. As mentioned previously, the original basis space is a high-dimensional sphere, and random bases on the sphere can be generated via the <a href="https://cran.r-project.org/package=geozoo">geozoo</a> <span class="citation" data-cites="geozoo">(<a href="#ref-geozoo" role="doc-biblioref">Schloerke 2016</a>)</span> package. We use PCA to project and visualize the parameters/ bases in 2D. The centre of the 2D view is the first two PCs of the data matrix. It theoretically should be a circle but may have some irregular edges due to finite sampling. Thus the edge is smoothed by using a radius estimated as the largest distance from the centre to any basis. In the simulation, the theoretical best basis is known and can be labelled to compare how close to this that the optimisers stopped. Various aesthetics, i.e., size, alpha (transparency), and colour, are applicable to emphasize critical elements and adjust for the presentation. For example, anchor points and search points are less important, and hence a smaller size and alpha are used. Alpha can also be applied on the interpolation paths to show start to finish from transparent to opaque.</p>
<p>Figure <a href="#fig:toy-pca">4</a> shows the PCA plot of CRS and PD for a 1D projection problem. Both optimisers find the optimum, but PD gets closer. With the PCA plot, one can visually appreciate the nature of these two optimisers: PD first evaluates points in a small neighbourhood for a promising direction, while CRS evaluates points randomly in the search space to search for the next target. There are dashed lines annotated for CRS, and it describes the interruption of the interpolation, which will be discussed in detail in Section <em>A problem of non-monotonicity</em>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:toy-pca"></span>
<img src="figs/toy-pca.svg" alt="Two paths with different colours in the grey circle. The starting point of each path, on the left and right, is symmetric to the origin of the circle. There is a star on the top left of the grey circle where both paths finish. The left path finishes closer to the star." width="70%" />
<p class="caption">
Figure 4: Search paths of CRS (green) and PD (brown) in the PCA-reduced basis space for 1D projection problem on the five-variable dataset, using holes index. The basis space, a 5D unit sphere, is projected onto a 2D circle by PCA. The black star represents the theoretical best basis the optimisers are aiming to find. All the bases in PD have been flipped for easier comparison of the final bases, and a grey dashed line has been annotated to indicate the symmetry of the two start bases.
</p>
</div>
</div>
<h2 class="unnumbered" id="diagnostic-3b-animating-the-diagnostic-plots">Diagnostic 3b: Animating the diagnostic plots</h2>
<p>Animation is another type of display to show how the search progresses from start to finish in the space. Figure <a href="#fig:toy-pca-animated-interactive">5</a> shows the animated version (six frames from the animation if viewed in pdf) of the PCA plot in Figure <a href="#fig:toy-pca">4</a>. An additional piece of information one can learn from this animation is that CRS finds its end basis quicker than PD since CRS finishes its search in the 5th frame while PD is still making more progress.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:toy-pca-animated-interactive"></span>
<img src="anim/toy-pca-animated.gif" alt="Animation of the previous figure where the path on the right finishes faster than the left one." width="100%" class = 'gif' />
<p class="caption">
Figure 5: Animated version of Figure 4. With animation, the progression of the search paths from start to finish can better identified and CRS (green) finishes the optimisation quicker than PD (brown).
</p>
</div>
</div>
<h2 class="unnumbered" id="diagnostic-4a-the-tour-looking-at-itself">Diagnostic 4a: The tour looking at itself</h2>
<p>As mentioned previously, the original <span class="math inline">\(p \times d\)</span> dimension space can be simulated via randomly generated bases in the <a href="#">geozoo</a> <span class="citation" data-cites="geozoo">(<a href="#ref-geozoo" role="doc-biblioref">Schloerke 2016</a>)</span> package. While the PCA plot projects the bases from the direction that maximises the variance, the tour plot displays the original high-dimensional space from various directions using animation. Figure <a href="#fig:toy-tour-interactive">6</a> shows some frames from the tour plot of the same two optimisations in its original space.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:toy-tour-interactive"></span>
<img src="anim/tour.gif" alt="Animation of previous two paths in the full 5D space characterised by small grey dots." width="100%" class = 'tour-gif' />
<p class="caption">
Figure 6: Animating the two paths from Figure 4 and 5 in the full basis space. The full basis space in this example is a 5D unit sphere, on which points (grey) are randomly generated via the CRAN package geozoo.
</p>
</div>
</div>
<h2 class="unnumbered" id="diagnostic-4b-forming-a-torus">Diagnostic 4b: Forming a torus</h2>
<p>While the previous few examples have looked at the space of 1D basis in a unit sphere, this section visualises the space of 2D basis. Recall that the columns in a 2D basis are orthogonal to each other, so the space of <span class="math inline">\(p \times 2\)</span> bases is a torus in the <span class="math inline">\(p\)</span>-D space <span class="citation" data-cites="Buja1986-sw">(<a href="#ref-Buja1986-sw" role="doc-biblioref">Buja and Asimov 1986</a>)</span>. For <span class="math inline">\(p = 3\)</span> one would see a classical 3D torus shape as shown by the grey points in Figure <a href="#fig:toy-torus-interactive">7</a>. The two circles of the torus can be observed to be perpendicular to each other and this can be linked back to the orthogonality condition. Two paths from CRS and PD are plotted on top of the torus and coloured in green and brown, respectively, to match the previous plots. The final basis found by PD and CRS are shown in a larger shape and printed below, respectively:</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>             [,1]        [,2]
[1,]  0.001196285  0.03273881
[2,] -0.242432715  0.96965761
[3,] -0.970167484 -0.24226493</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>            [,1]         [,2]
[1,]  0.05707994 -0.007220138
[2,] -0.40196202 -0.915510160
[3,] -0.91387549  0.402230054</code></pre>
</div>
<p>Both optimisers have found the third variable in the first direction and the second variable in the second direction. Note, however, the different orientation of the basis, following from the different sign in the second column. One would expect to see this in the torus plot as the final bases match each other when projected onto one torus circle (due to the same sign in the first column) and are symmetric when projected onto the other (due to the different sign in the second column). In Figure <a href="#fig:toy-torus-interactive">7</a>, this can be seen most clearly in frame 5 where the two circles are rotated into a line from our view.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:toy-torus-interactive"></span>
<img src="anim/torus.gif" alt="Animation of two paths in a space characterised by small grey dots. The shape of the grey dots is a torus." width="100%" class = 'tour-gif' />
<p class="caption">
Figure 7: Animation of rotating the 2D basis space along with two search paths optimised by PD (brown) and CRS (green). The projection problem is a 2D projection with three variables using the holes index. The grey points are randomly generated 2D projection bases in the space and it can be observed that these points form a torus.
</p>
</div>
</div>
<h1 data-number="5" id="application"><span class="header-section-number">5</span> Diagnosing an optimiser</h1>
<p>In this section, several examples will be presented to show how the diagnostic plots discover something unexpected in projection pursuit optimisation, and guide the implementation of new features.</p>
<h2 class="unnumbered" id="simulation-setup">Simulation setup</h2>
<p>Random variables with different distributions have been simulated as follows:</p>
<p><span class="math display">\[\begin{align}
x_1 \overset{d}{=} x_8 \overset{d}{=} x_9 \overset{d}{=} x_{10}&amp; \sim \mathcal{N}(0, 1) \\
x_2 &amp;\sim 0.5 \mathcal{N}(-3, 1) + 0.5 \mathcal{N}(3, 1)\\
\Pr(x_3) &amp;=
\begin{cases}
0.5 &amp; \text{if $x_3 = -1$ or $1$}\\
0 &amp; \text{otherwise}
\end{cases}\\
x_4 &amp;\sim 0.25 \mathcal{N}(-3, 1) + 0.75 \mathcal{N}(3, 1)\\
x_5 &amp;\sim \frac{1}{3} \mathcal{N}(-5, 1) + \frac{1}{3} \mathcal{N}(0, 1) + \frac{1}{3} \mathcal{N}(5, 1)\\
x_6 &amp;\sim 0.45 \mathcal{N}(-5, 1) + 0.1 \mathcal{N}(0, 1) + 0.45 \mathcal{N}(5, 1)\\
x_7 &amp;\sim 0.5 \mathcal{N}(-5, 1) + 0.5 \mathcal{N}(5, 1)
\end{align}\]</span></p>
<p>Variables <code>x1</code>, <code>x8</code> to <code>x10</code> are normal noise with zero mean, and unit variance and <code>x2</code> to <code>x7</code> are normal mixtures with varied weights and locations. All the variables have been scaled to have overall unit variance before projection pursuit. The holes index <span class="citation" data-cites="cook2008grand">(<a href="#ref-cook2008grand" role="doc-biblioref">Cook et al. 2008</a>)</span>, used for detecting bimodality of the variables, is used throughout the examples unless otherwise specified.</p>
<h2 class="unnumbered" id="monotonic">A problem of non-monotonicity</h2>
<p>An example of non-monotonic interpolation has been given in Figure <a href="#fig:toy-interp">3</a>: a path that passes bases with a higher index value than the target one. For SA, a non-monotonic interpolation is justified since target bases do not necessarily have a higher index value than the current one, while this is not the case for CRS. The original trace plot for a 2D projection problem, optimised by CRS, is shown on the left panel of Figure <a href="#fig:interruption">8</a>, and one can observe that the non-monotonic interpolation has undermined the optimiser to realise its full potential. Hence, an interruption is implemented to stop at the best basis found in the interpolation. The right panel of Figure <a href="#fig:interruption">8</a> shows the trace plot after implementing the interruption, and while the first two interpolations are identical, the basis at time 61 has a higher index value than the target in the third interpolation. Rather than starting the next iteration from the target basis on time 65, CRS starts the next iteration at time 61 on the right panel and reaches a better final basis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:interruption"></span>
<img src="figs/interrupt.svg" alt="Two line charts of index value against time. Starting with the same index value, the left plot shows an increasing smooth line but it is not non-monotonic, and the right plot shows a monotonic increase with a higher finishing index value and smaller finishing time." width="100%" />
<p class="caption">
Figure 8: Comparison of the interpolation before and after implementing the interruption for the 2D projection problem on data using holes index, optimised by CRS. On the left panel, the basis with a higher index value is found during the interpolation but not used. On the right panel, the interruption stops the interpolation at the basis with the highest index value for each iteration and results in a final basis with a higher index value, as shown on the right panel.
</p>
</div>
</div>
<h2 class="unnumbered" id="close-but-not-close-enough">Close but not close enough</h2>
<p>Once the final basis has been found by an optimiser, one may want to push further in the close neighbourhood to see if an even better basis can be found. A polish search takes the final basis of an optimiser as the start of a new guided tour to search for local improvements. The polish algorithm is similar to the CRS but with three distinctions: 1) a hundred rather than one candidate bases are generated each time in the inner loop; 2) the neighbourhood size is reduced in the inner loop, rather than in the outer loop; and 3) three more termination conditions have been added to ensure the new basis generated is distinguishable from the current one in terms of the distance in the space, the relative change in the index value, and neighbourhood size:</p>
<ol type="1">
<li>the distance between the basis found and the current needs to be larger than 1e-3;</li>
<li>the relative change of the index value needs to be larger than 1e-5; and</li>
<li>the alpha parameter needs to be larger than 0.01.</li>
</ol>
<p>Figure <a href="#fig:polish">9</a> presents the projected data and trace plot of a 2D projection, optimised by CRS and followed by the polish step. The top row shows the initial projection, the final projection after CRS, and the final projection after polish, respectively. The end basis found by CRS reveals the four clusters in the data, but the edges of each cluster are not clean-cut. Polish works with this end basis and further pushes the index value to produce clearer edges of the cluster, especially along the vertical axis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:polish"></span>
<img src="figs/polish.svg" alt="A composite plot with an upper and lower panels. The upper panel contains three subplots of scattered small points: the points form a circular shape in the left subplot; form four clusters in the middle subplot; and form four tighter clusters, in a different colour, in the right subplot. The lower panel shows the connected points of index value again time with the last few points in the same colour as the right subplot in the upper panel." width="100%" />
<p class="caption">
Figure 9: Comparison of the projected data before and after using polishing for a 2D projection problem on data using holes index. The top row shows the initial projected data and the final views after CRS and polish search, and the second row traces the index value. The clustering structure in the data is detected by CRS (top middle panel), but the polish step improves the index value and produces clearer boundaries of the clusters (top right panel), especially along the vertical axis. Note that the parameter is set to 400 in this experiment for CRS to do its best.
</p>
</div>
</div>
<h2 class="unnumbered" id="seeing-the-signal-in-the-noise">Seeing the signal in the noise</h2>
<p>The holes index function used for all the examples before this section produces a smooth interpolation, while this is not the case for all the indexes. An example of a noisy index function for 1D projections compares the projected data, <span class="math inline">\(\mathbf{Y}_{n \times 1}\)</span>, to a randomly generated normal distribution, <span class="math inline">\(\mathcal{N}_{n \times 1}\)</span>, using the Kolmogorov test. Let <span class="math inline">\(F_{.}(n)\)</span> be the empirical cumulative distribution function (ECDF) with two possible subscripts, <span class="math inline">\(Y\)</span> and <span class="math inline">\(\mathcal{N}\)</span>, representing the projected and randomly generated data, and <span class="math inline">\(n\)</span> denoting the number of observations, the Kolmogorov index <span class="math inline">\(I^{nk}(n)\)</span>, is defined as:</p>
<p><span class="math display">\[I^{K}(n) = \max \left[F_{Y}(n) - F_{\mathcal{N}}(n)\right].\]</span> With a non-smooth index function, two research questions are raised:</p>
<ol type="1">
<li>whether any optimiser fails to optimise this non-smooth index; and</li>
<li>whether the optimisers can find the global optimum despite the presence of a local optimum.</li>
</ol>
<p>Figure <a href="#fig:noisy-better-geo">10</a> presents the trace and PCA plots of all three optimisers, and as expected, none of the interpolated paths are smooth. There is barely any improvement made by PD, indicating its failure in optimising non-smooth index functions. While CRS and SA have managed to get close to the index value of the theoretical best, the trace plot shows that it takes SA much longer to find the final basis. This long interpolation path is partially due to the fluctuation in the early iterations, where SA tends to generously accept inferior bases before concentrating near the optimum. The PCA plot shows the interpolation path and search points, excluding the last termination iteration. Pseudo-Derivative (PD) quickly gets stuck near the starting position. Comparing the amount of random search done by CRS and SA, it is surprising that SA does not carry as many samples as CRS. Combining the insights from both the trace and PCA plot, one can learn the two different search strategies by CRS and SA: CRS frequently samples in the space and only make a move when an improvement is guaranteed to be made, while SA first broadly accepts bases in the space and then starts the extensive sampling in a narrowed subspace. The specific decision of which optimiser to use will depend on the index curve in the basis space, but if the basis space is non-smooth, accepting inferior bases at first, as SA has done here, can lead to a more efficient search in terms of the overall number of points evaluated.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:noisy-better-geo"></span>
<img src="figs/noisy-better-geo.svg" alt="A composition plot with upper and lower panel and in each panel there are three side-by-side plots. The upper panel shows the line plot of index value again time. The left subplot finishes with a much lower index value than the latter two. The latter two finish at a similar index value but the right subplot takes a longer time. The lower panel shows the paths in the grey circle. The left subplot has a much shorter path than the right two. The right-most subplot has the longest path that occupies the whole space." width="100%" />
<p class="caption">
Figure 10: Comparison of the three optimisers in optimising <span class="math inline">\(I^{nk}(n)\)</span> index for a 1D projection problem on a five-variable dataset, . Both CRS and SA succeed in the optimisation, PD fails to optimise this non-smooth index. Further, SA takes much longer than CRS to finish the optimisation, but finishes off closer to the theoretical best.
</p>
</div>
</div>
<p>The next experiment compares the performance of CRS and SA when a local maximum exists. Two search neighbourhood sizes, 0.5 and 0.7, are compared to understand how a large search neighbourhood would affect the final basis and the length of the search. Figure <a href="#fig:kol-result">11</a> shows 80 paths simulated using 20 seeds in the PCA plot, faceted by the optimiser and search size. With CRS and a search size of 0.5, despite being the simplest and fastest, the optimiser fails in three instances where the final basis lands neither near the local nor the global optimum. With a larger search size of 0.7, more seeds have found the global maximum. Comparing CRS and SA for a search size of 0.5, SA does not seem to improve the final basis found, despite having longer interpolation paths. However, the denser paths near the local maximum are an indicator that SA is working hard to examine if there is any other optimum in the basis space, but the relatively small search size has diminished its ability to reach the global maximum. With a larger search size, almost all the seeds (16 out of 20) have found the global maximum, and some final bases are much closer to the theoretical best, as compared to the three other cases. This indicates that SA, with a reasonable large search window, is able to overcome the local optimum and optimise close towards the global optimum.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kol-result"></span>
<img src="figs/kol-result.svg" alt="Twenty paths in two different colours in four grey circles arranged in a 2-by-2 grid." width="100%" />
<p class="caption">
Figure 11: Comparing 20 search paths in the PCA-projected basis space faceted by two optimisers: CRS and SA, and two search sizes: 0.5 and 0.7. The optimisation is on the 1D projection index, <span class="math inline">\(I^{nk}(n)\)</span>, for data, where a local optimum, annotated by the cross (x), is presented in this experiment, along with the global optimum (*).
</p>
</div>
</div>
<h2 class="unnumbered" id="reconciling-the-orientation">Reconciling the orientation</h2>
<p>One interesting situation observed in the previous examples is that, for some simulations, as shown on the left panel of Figure <a href="#fig:flip-sign">12</a>, the target basis is generated on the other half of the basis space, and the interpolator seems to draw a straight line to interpolate. Bases with opposite signs do not affect the projection and index value, but we would prefer the target to have the same orientation as the current basis. The orientation of two bases can be computationally checked by calculating the determinant – a negative value suggests the two bases have a different orientation. For 1D bases, this can be corrected by flipping the sign on one basis. For higher dimensions, it can be a bit more difficult because the orthonormality of the basis needs to be also maintained when an individual vector is flipped. Here, an orientation check is carried out once a new target basis is generated, and the sign in the target basis will be flipped if a negative determinant is obtained. The interpolation after implementing the orientation check is shown on the right panel of Figure <a href="#fig:flip-sign">12</a>, where the unsatisfactory interpolation no longer exists.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:flip-sign"></span>
<img src="figs/flip-sign.svg" alt="Two plots of points connected into a path in the grey circle. In both plots, most of both points are located in the left half of the circle while a single point in the left plot is located in the right half of the circle, creating a connected path across the origin of the circle." width="100%" />
<p class="caption">
Figure 12: Comparison of the interpolation in the PCA-projected basis space before and after reconciling the orientation of the target basis. Optimisation is on the 1D projection index, <span class="math inline">\(I^{nk}(n)\)</span>, for boa6 data using CRS with seed 2463. The dots represent the target basis in each iteration, and the path shows the interpolation. On the left panel, one target basis is generated with an opposite orientation to the current basis (hence appear on the other side of the basis space), and the interpolator crosses the origin to perform the interpolation. The right panel shows the same interpolation after implementing an orientation check, and the undesirable interpolation disappears.
</p>
</div>
</div>
<h1 data-number="6" id="implementation"><span class="header-section-number">6</span> Implementation</h1>
<p>This project contributes to the software development in two packages: a data collection object is implemented in <a href="#">tourr</a> <span class="citation" data-cites="tourr">(<a href="#ref-tourr" role="doc-biblioref">Wickham et al. 2011</a>)</span>, while the visual diagnostics of the optimisers is implemented in <a href="#">ferrn</a> <span class="citation" data-cites="ferrn">(<a href="#ref-ferrn" role="doc-biblioref">Zhang et al. 2021</a>)</span>. The functions in the <a href="#">ferrn</a> <span class="citation" data-cites="ferrn">(<a href="#ref-ferrn" role="doc-biblioref">Zhang et al. 2021</a>)</span> package are listed below:</p>
<ul>
<li><p>Main plotting functions:</p>
<ul>
<li><code>explore_trace_search()</code> produces summary plots in Figure <a href="#fig:toy-search">2</a>.</li>
<li><code>explore_trace_interp()</code> produces trace plots for the interpolation points in Figure <a href="#fig:toy-interp">3</a>.</li>
<li><code>explore_space_pca()</code> produces the PCA plot of projection bases on the reduced space. Figure <a href="#fig:toy-pca">4</a> includes the additional details of anchor and search bases, which can be turned on by the argument <code>details = TRUE</code>. The animated version in Figure <a href="#fig:toy-pca-animated-interactive">5</a> is produced with argument <code>animate = TRUE</code>.</li>
<li><code>explore_space_tour()</code> produces animated tour view on the full space of the projection bases in Figure <a href="#fig:toy-tour-interactive">6</a>.</li>
</ul></li>
<li><p><code>get_*()</code> extracts and manipulates certain components from the existing data object.</p>
<ul>
<li><code>get_anchor()</code> extracts target observations.</li>
<li><code>get_basis_matrix()</code> flattens all the bases into a matrix.</li>
<li><code>get_best()</code> extracts the observation with the highest index value in the data object.</li>
<li><code>get_dir_search()</code> extracts directional search observations for PD search.</li>
<li><code>get_interp()</code> extracts interpolated observations.</li>
<li><code>get_interp_last()</code> extracts the ending interpolated observations in each iteration.</li>
<li><code>get_interrupt()</code> extracts the ending interpolated observations and the target observations if the interpolation is .interrupted</li>
<li><code>get_search()</code> extracts search observations.</li>
<li><code>get_search_count()</code> extracts the count of search observations.</li>
<li><code>get_space_param()</code> produces the coordinates of the centre and radius of the basis space.</li>
<li><code>get_start()</code> extracts the starting observation.</li>
<li><code>get_theo()</code> extracts the theoretical best observations, if given.</li>
</ul></li>
<li><p><code>bind_*()</code> incorporates additional information outside the tour optimisation into the data object.</p>
<ul>
<li><code>bind_theoretical()</code> binds the theoretical best observation in simulated experiment.</li>
<li><code>bind_random()</code> binds randomly generated bases in the projection bases space to the data object.</li>
<li><code>bind_random_matrix()</code> binds randomly generated bases and outputs in a matrix format.</li>
</ul></li>
<li><p><code>add_*()</code> provides wrapper functions to create ggprotos for different components for the PCA plot</p>
<ul>
<li><code>add_anchor()</code> for plotting anchor bases.</li>
<li><code>add_anno()</code> for annotating the symmetry of start bases.</li>
<li><code>add_dir_search()</code> for plotting the directional search bases with magnified distance.</li>
<li><code>add_end()</code> for plotting end bases.</li>
<li><code>add_interp()</code> for plotting the interpolation path.</li>
<li><code>add_interp_last()</code> for plotting the last interpolation bases for comparing with target bases when interruption is used.</li>
<li><code>add_interrupt()</code> for linking the last interpolation bases with target ones when interruption is used.</li>
<li><code>add_search()</code> for plotting search bases.</li>
<li><code>add_space()</code> for plotting the circular space.</li>
<li><code>add_start()</code> for plotting start bases.</li>
<li><code>add_theo()</code> for plotting theoretical best bases, if applicable.</li>
</ul></li>
<li><p>Utilities</p>
<ul>
<li><code>theme_fern()</code> and <code>format_label()</code> for better display of the grid lines and axis formatting.</li>
<li><code>clean_method()</code> to clean up the name of the optimisers.</li>
<li><code>botanical_palettes()</code> is a collection of colour palettes from Australian native plants. Quantitative palettes include daisy, banksia, and cherry, and sequential palettes contain fern and acacia.</li>
<li><code>botanical_pal()</code> as the colour interpolator.</li>
<li><code>scale_color_*()</code> and <code>scale_fill_*()</code> for scaling the colour and fill of the plot.</li>
</ul></li>
</ul>
<h1 data-number="7" id="conclusion"><span class="header-section-number">7</span> Conclusion</h1>
<p>This paper has provided several visual diagnostics that can be used for understanding a complex optimisation procedure and are implemented in the <strong>ferrn</strong> package. The methods were illustrated using the optimisers available for projection pursuit guided tour. Here the constraint is the orthonormality condition of the projection bases, which corresponds to optimisation over spheres and torii. The approach described broadly applies to other constrained optimisers. Although the manifold in <span class="math inline">\(p\)</span>-space might be different the diagnostic techniques are the same. A researcher would begin by saving the path of the optimiser in a form required to input into the ferrn package, as described in this paper. One might generally make more samples from the constrained space upon which to assess and compare the optimisation paths. These high-dimensional data objects can then be viewed using the tour.</p>
<p>The progressive optimisation of a target function and its coverage of the search space can be viewed in both reduced 2D space and the full space. These visualisations can lead to insights for evaluating and comparing the performance of multiple optimisers operating on the same task. They can provide a better understanding of existing methods or motivate the development of new approaches. For example, we have compared how three optimisers perform when maximising a non-smooth index function and have illustrated how the pseudo-derivative search fails in this setting. The observations from our experiments have also been translated into improved optimisation methods for the guided tour, e.g., we introduced the option to interrupt the search if a better basis is found along the path.</p>
<p>This work might be considered an effort to bring transparency into algorithms. Although little attention is paid by algorithm developers to providing ways to output information during intermediate steps, this is an important component for enabling others to understand and diagnose the performance. Algorithms are an essential component of artificial intelligence that is used to make daily life easier. Interpretability of algorithms is important to guard against aspects like bias and inappropriate use. The data object underlying the visual diagnostics here is an example of what might be useful in algorithm development generally.</p>
<h1 data-number="8" id="acknowledgements"><span class="header-section-number">8</span> Acknowledgements</h1>
<p>This article is created using <a href="https://cran.r-project.org/package=knitr">knitr</a> <span class="citation" data-cites="knitr">(<a href="#ref-knitr" role="doc-biblioref">Xie 2015</a>)</span> and <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a> <span class="citation" data-cites="rmarkdown">(<a href="#ref-rmarkdown" role="doc-biblioref">Xie et al. 2018</a>)</span> in R. The source code for reproducing this paper can be found at: <a href="https://github.com/huizezhang-sherry/paper-ferrn" class="uri">https://github.com/huizezhang-sherry/paper-ferrn</a>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 class="appendix unnumbered" id="cran-packages-used">CRAN packages used</h2>
<p><a href="https://cran.r-project.org/package=ferrn">ferrn</a>, <a href="https://cran.r-project.org/package=tourr">tourr</a>, <a href="https://cran.r-project.org/package=dplyr">dplyr</a>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=geozoo">geozoo</a>, <a href="https://cran.r-project.org/package=knitr">knitr</a>, <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a></p>
<h2 class="appendix unnumbered" id="cran-task-views-implied-by-cited-packages">CRAN Task Views implied by cited packages</h2>
<p><a href="https://cran.r-project.org/view=ReproducibleResearch">ReproducibleResearch</a>, <a href="https://cran.r-project.org/view=Databases">Databases</a>, <a href="https://cran.r-project.org/view=ModelDeployment">ModelDeployment</a>, <a href="https://cran.r-project.org/view=Multivariate">Multivariate</a>, <a href="https://cran.r-project.org/view=Phylogenetics">Phylogenetics</a>, <a href="https://cran.r-project.org/view=TeachingStatistics">TeachingStatistics</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-andradottir2015review" class="csl-entry" role="listitem">
S. Andradóttir. A review of random search methods. In <em>Handbook of simulation optimization</em>, pages. 277–292 2015. Springer. URL <a href="https://doi.org/10.1007/978-1-4939-1384-8">https://doi.org/10.1007/978-1-4939-1384-8</a>.
</div>
<div id="ref-bertsekas2014constrained" class="csl-entry" role="listitem">
D. P. Bertsekas. <em>Constrained optimization and lagrange multiplier methods.</em> Academic press, 2014. URL <a href="https://doi.org/10.1016/C2013-0-10366-2">https://doi.org/10.1016/C2013-0-10366-2</a>.
</div>
<div id="ref-bertsimas1993simulated" class="csl-entry" role="listitem">
D. Bertsimas and J. Tsitsiklis. Simulated annealing. <em>Statistical Science</em>, 8(1): 10–15, 1993. URL <a href="https://doi.org/10.1214/ss/1177011077">https://doi.org/10.1214/ss/1177011077</a>.
</div>
<div id="ref-Brooks1958-zk" class="csl-entry" role="listitem">
S. H. Brooks. A discussion of random methods for seeking maxima. <em>Operations Research</em>, 6(2): 244–251, 1958. URL <a href="https://doi.org/10.1287/opre.6.2.244">https://doi.org/10.1287/opre.6.2.244</a>.
</div>
<div id="ref-Buja1986-sw" class="csl-entry" role="listitem">
A. Buja and D. Asimov. Grand tour methods: An outline. In <em>Proceedings of the seventeenth symposium on the interface of computer sciences and statistics</em>, pages. 63–67 1986. USA: Elsevier North-Holland, Inc. ISBN 9780444700186. URL <a href="https://dl.acm.org/doi/10.5555/26036.26046">https://dl.acm.org/doi/10.5555/26036.26046</a>.
</div>
<div id="ref-buja2005computational" class="csl-entry" role="listitem">
A. Buja, D. Cook, D. Asimov and C. Hurley. Computational methods for high-dimensional rotations in data visualization. <em>Handbook of Statistics</em>, 24: 391–413, 2005. URL <a href="https://doi.org/10.1016/S0169-7161(04)24014-7">https://doi.org/10.1016/S0169-7161(04)24014-7</a>.
</div>
<div id="ref-conn2009introduction" class="csl-entry" role="listitem">
A. R. Conn, K. Scheinberg and L. N. Vicente. <em>Introduction to derivative-free optimization.</em> SIAM, 2009. URL <a href="https://doi.org/10.1137/1.9780898718768">https://doi.org/10.1137/1.9780898718768</a>.
</div>
<div id="ref-cook1997manual" class="csl-entry" role="listitem">
D. Cook and A. Buja. Manual controls for high-dimensional data projections. <em>Journal of Computational and Graphical Statistics</em>, 6(4): 464–480, 1997. URL <a href="https://doi.org/10.2307/1390747">https://doi.org/10.2307/1390747</a>.
</div>
<div id="ref-cook1993projection" class="csl-entry" role="listitem">
D. Cook, A. Buja and J. Cabrera. Projection pursuit indexes based on orthonormal function expansions. <em>Journal of Computational and Graphical Statistics</em>, 2(3): 225–250, 1993. URL <a href="https://doi.org/10.2307/1390644">https://doi.org/10.2307/1390644</a>.
</div>
<div id="ref-cook1995grand" class="csl-entry" role="listitem">
D. Cook, A. Buja, J. Cabrera and C. Hurley. Grand tour and projection pursuit. <em>Journal of Computational and Graphical Statistics</em>, 4(3): 155–172, 1995. URL <a href="https://doi.org/10.1080/10618600.1995.10474674">https://doi.org/10.1080/10618600.1995.10474674</a>.
</div>
<div id="ref-cook2008grand" class="csl-entry" role="listitem">
D. Cook, A. Buja, E.-K. Lee and H. Wickham. Grand tours, projection pursuit guided tours, and manual controls. In <em>Handbook of data visualization</em>, pages. 295–314 2008. Springer. URL <a href="https://doi.org/10.1007/978-3-540-33037-0_13">https://doi.org/10.1007/978-3-540-33037-0_13</a>.
</div>
<div id="ref-diaconis1984asymptotics" class="csl-entry" role="listitem">
P. Diaconis and D. Freedman. Asymptotics of graphical projection pursuit. <em>The Annals of Statistics</em>, 793–815, 1984. URL <a href="https://doi.org/10.1214/aos/1176346703">https://doi.org/10.1214/aos/1176346703</a>.
</div>
<div id="ref-friedman1974projection" class="csl-entry" role="listitem">
J. H. Friedman and J. W. Tukey. A projection pursuit algorithm for exploratory data analysis. <em>IEEE Transactions on Computers</em>, 100(9): 881–890, 1974. URL <a href="https://doi.org/10.1109/T-C.1974.224051">https://doi.org/10.1109/T-C.1974.224051</a>.
</div>
<div id="ref-granville1994simulated" class="csl-entry" role="listitem">
V. Granville, M. Krivánek and J.-P. Rasson. Simulated annealing: A proof of convergence. <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 16(6): 652–656, 1994. URL <a href="https://doi.org/10.1109/34.295910">https://doi.org/10.1109/34.295910</a>.
</div>
<div id="ref-hall1989polynomial" class="csl-entry" role="listitem">
P. Hall. On polynomial-based projection indices for exploratory projection pursuit. <em>The Annals of Statistics</em>, 17(2): 589–605, 1989. URL <a href="https://doi.org/10.1214/aos/1176347127">https://doi.org/10.1214/aos/1176347127</a>.
</div>
<div id="ref-healy2018data" class="csl-entry" role="listitem">
K. Healy. <em>Data visualization: A practical introduction.</em> Princeton University Press, 2018. URL <a href="https://socviz.co/">https://socviz.co/</a>.
</div>
<div id="ref-jones1998efficient" class="csl-entry" role="listitem">
D. R. Jones, M. Schonlau and W. J. Welch. Efficient global optimization of expensive black-box functions. <em>Journal of Global optimization</em>, 13(4): 455–492, 1998. URL <a href="https://doi.org/10.1023/A:1008306431147">https://doi.org/10.1023/A:1008306431147</a>.
</div>
<div id="ref-kirkpatrick1983optimization" class="csl-entry" role="listitem">
S. Kirkpatrick, C. D. Gelatt and M. P. Vecchi. Optimization by simulated annealing. <em>Science</em>, 220(4598): 671–680, 1983. URL <a href="https://doi.org/10.1126/science.220.4598.671">https://doi.org/10.1126/science.220.4598.671</a>.
</div>
<div id="ref-laa2020using" class="csl-entry" role="listitem">
U. Laa and D. Cook. Using tours to visually investigate properties of new projection pursuit indexes with application to problems in physics. <em>Computational Statistics</em>, 1–35, 2020. URL <a href="https://doi.org/10.1007/s00180-020-00954-8">https://doi.org/10.1007/s00180-020-00954-8</a>.
</div>
<div id="ref-lee2005projection" class="csl-entry" role="listitem">
E. Lee, D. Cook, S. Klinke and T. Lumley. Projection pursuit for exploratory supervised classification. <em>Journal of Computational and Graphical Statistics</em>, 14(4): 831–846, 2005. URL <a href="https://doi.org/10.1198/106186005X77702">https://doi.org/10.1198/106186005X77702</a>.
</div>
<div id="ref-lee2010projection" class="csl-entry" role="listitem">
E.-K. Lee and D. Cook. A projection pursuit index for large p small n data. <em>Statistics and Computing</em>, 20(3): 381–392, 2010. URL <a href="https://doi.org/10.1007/s11222-009-9131-1">https://doi.org/10.1007/s11222-009-9131-1</a>.
</div>
<div id="ref-li2020visualizing" class="csl-entry" role="listitem">
M. Li, Z. Zhao and C. Scheidegger. Visualizing neural networks with the grand tour. <em>Distill</em>, 2020. URL <a href="https://doi.org/10.23915/distill.00025">https://doi.org/10.23915/distill.00025</a>.
</div>
<div id="ref-Loperfido2020" class="csl-entry" role="listitem">
N. Loperfido. Kurtosis-based projection pursuit for outlier detection in financial time series. <em>The European Journal of Finance</em>, 26(2-3): 142–164, 2020. URL <a href="https://doi.org/10.1080/1351847X.2019.1647864">https://doi.org/10.1080/1351847X.2019.1647864</a>.
</div>
<div id="ref-Loperfido2018" class="csl-entry" role="listitem">
N. Loperfido. Skewness-based projection pursuit: A computational approach. <em>Computational Statistics and Data Analysis</em>, 120(C): 42–57, 2018. URL <a href="https://doi.org/10.1016/j.csda.2017.11.001">https://doi.org/10.1016/j.csda.2017.11.001</a>.
</div>
<div id="ref-mitra1986convergence" class="csl-entry" role="listitem">
D. Mitra, F. Romeo and A. Sangiovanni-Vincentelli. Convergence and finite-time behavior of simulated annealing. <em>Advances in Applied Probability</em>, 18(3): 747–771, 1986. URL <a href="https://doi.org/10.1109/CDC.1985.268600">https://doi.org/10.1109/CDC.1985.268600</a>.
</div>
<div id="ref-posse1995projection" class="csl-entry" role="listitem">
C. Posse. Projection pursuit exploratory data analysis. <em>Computational Statistics &amp; Data Analysis</em>, 20(6): 669–687, 1995. URL <a href="https://doi.org/10.1016/0167-9473(95)00002-8">https://doi.org/10.1016/0167-9473(95)00002-8</a>.
</div>
<div id="ref-rios2013derivative" class="csl-entry" role="listitem">
L. M. Rios and N. V. Sahinidis. Derivative-free optimization: A review of algorithms and comparison of software implementations. <em>Journal of Global Optimization</em>, 56(3): 1247–1293, 2013. URL <a href="https://doi.org/10.1007/s10898-012-9951-y">https://doi.org/10.1007/s10898-012-9951-y</a>.
</div>
<div id="ref-Romeijn2009" class="csl-entry" role="listitem">
H. E. Romeijn. Random search methods. In <em>Encyclopedia of optimization</em>, pages. 3245–3251 2009. Boston, MA: Springer US. URL <a href="https://doi.org/10.1007/978-0-387-74759-0_556">https://doi.org/10.1007/978-0-387-74759-0_556</a>.
</div>
<div id="ref-geozoo" class="csl-entry" role="listitem">
B. Schloerke. <em>Geozoo: Zoo of geometric objects.</em> 2016. URL <a href="https://CRAN.R-project.org/package=geozoo">https://CRAN.R-project.org/package=geozoo</a>. R package version 0.5.1.
</div>
<div id="ref-spall2005introduction" class="csl-entry" role="listitem">
J. C. Spall. <em>Introduction to stochastic search and optimization: Estimation, simulation, and control.</em> John Wiley &amp; Sons, 2005. URL <a href="https://www.jhuapl.edu/ISSO/">https://www.jhuapl.edu/ISSO/</a>.
</div>
<div id="ref-tukey1977exploratory" class="csl-entry" role="listitem">
J. W. Tukey. <em>Exploratory data analysis.</em> Reading, MA, 1977.
</div>
<div id="ref-unwin2015graphical" class="csl-entry" role="listitem">
A. Unwin. <em>Graphical data analysis with r.</em> CRC Press, 2015. URL <a href="https://doi.org/10.1201/9781315370088">https://doi.org/10.1201/9781315370088</a>.
</div>
<div id="ref-White1971-ci" class="csl-entry" role="listitem">
R. C. White. A survey of random methods for parameter optimization. <em>Simulation</em>, 17(5): 197–205, 1971. URL <a href="https://doi.org/10.1177/003754977101700504">https://doi.org/10.1177/003754977101700504</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
H. Wickham. <em>ggplot2: Elegant graphics for data analysis.</em> Springer-Verlag New York, 2016. URL <a href="https://doi.org/10.1007/978-0-387-98141-3">https://doi.org/10.1007/978-0-387-98141-3</a>.
</div>
<div id="ref-wickham2014tidy" class="csl-entry" role="listitem">
H. Wickham. Tidy data. <em>Journal of Statistical Software</em>, 59(10): 1–23, 2014. URL <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
<div id="ref-tourr" class="csl-entry" role="listitem">
H. Wickham, D. Cook, H. Hofmann and A. Buja. <span class="nocase">tourr</span>: An <span>R</span> package for exploring multivariate data with projections. <em>Journal of Statistical Software</em>, 40(2): 1–18, 2011. URL <a href="http://doi.org/10.18637/jss.v040.i02">http://doi.org/10.18637/jss.v040.i02</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
H. Wickham, R. François, L. Henry and K. Müller. <em>Dplyr: A grammar of data manipulation.</em> 2020. URL <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>. R package version 1.0.2.
</div>
<div id="ref-wilke2019fundamentals" class="csl-entry" role="listitem">
C. O. Wilke. <em>Fundamentals of data visualization: A primer on making informative and compelling figures.</em> O<span>’</span>Reilly Media, 2019. URL <a href="https://clauswilke.com/dataviz/">https://clauswilke.com/dataviz/</a>.
</div>
<div id="ref-scag" class="csl-entry" role="listitem">
L. Wilkinson, A. Anand and R. Grossman. Graph-theoretic scagnostics. In <em>IEEE symposium on information visualization, 2005. INFOVIS 2005.</em>, pages. 157–164 2005.
</div>
<div id="ref-WW08" class="csl-entry" role="listitem">
L. Wilkinson and G. Wills. Scagnostics distributions. <em>Journal of Computational and Graphical Statistics</em>, 17(2): 473–491, 2008.
</div>
<div id="ref-knitr" class="csl-entry" role="listitem">
Y. Xie. <em>Dynamic documents with <span>R</span> and knitr.</em> 2nd ed Boca Raton, Florida: Chapman; Hall/CRC, 2015. URL <a href="https://yihui.name/knitr/">https://yihui.name/knitr/</a>. ISBN 978-1498716963.
</div>
<div id="ref-rmarkdown" class="csl-entry" role="listitem">
Y. Xie, J. J. Allaire and G. Grolemund. <em>R markdown: The definitive guide.</em> Boca Raton, Florida: Chapman; Hall/CRC, 2018. URL <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>. ISBN 978-1138359338.
</div>
<div id="ref-zabinsky2013stochastic" class="csl-entry" role="listitem">
Z. B. Zabinsky. <em>Stochastic adaptive search for global optimization.</em> Springer Science &amp; Business Media, 2013. URL <a href="https://doi.org/10.1007/978-1-4419-9182-9">https://doi.org/10.1007/978-1-4419-9182-9</a>.
</div>
<div id="ref-ferrn" class="csl-entry" role="listitem">
H. S. Zhang, D. Cook, U. Laa, N. Langrené and P. Menéndez. <em>Ferrn: Facilitate exploration of touRR optimisatioN.</em> 2021. URL <a href="https://github.com/huizezhang-sherry/ferrn/">https://github.com/huizezhang-sherry/ferrn/</a>. R package version 0.0.1.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Zhang, et al., "Visual Diagnostics for Constrained Optimisation with Application to Guided Tours", The R Journal, 2021</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2021-105,
  author = {Zhang, H. Sherry and Cook, Dianne and Laa, Ursula and Langrené, Nicolas and Menéndez, Patricia},
  title = {Visual Diagnostics for Constrained Optimisation with Application to Guided Tours},
  journal = {The R Journal},
  year = {2021},
  note = {https://doi.org/10.32614/RJ-2021-105},
  doi = {10.32614/RJ-2021-105},
  volume = {13},
  issue = {2},
  issn = {2073-4859},
  pages = {624-641}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
