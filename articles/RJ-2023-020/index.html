<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>The R Journal: The openVA Toolkit for Verbal Autopsies</title>

<meta property="description" itemprop="description" content="Verbal autopsy (VA) is a survey-based tool widely used to infer cause of death (COD) in regions without complete-coverage civil registration and vital statistics systems. In such settings, many deaths happen outside of medical facilities and are not officially documented by a medical professional. VA surveys, consisting of signs and symptoms reported by a person close to the decedent, are used to infer the COD for an individual, and to estimate and monitor the COD distribution in the population. Several classification algorithms have been developed and widely used to assign causes of death using VA data. However, the incompatibility between different idiosyncratic model implementations and required data structure makes it difficult to systematically apply and compare different methods. The openVA package provides the first standardized framework for analyzing VA data that is compatible with all openly available methods and data structure. It provides an open-source, R implementation of several most widely used VA methods. It supports different data input and output formats, and customizable information about the associations between causes and symptoms. The paper discusses the relevant algorithms, their implementations in R packages under the openVA suite, and demonstrates the pipeline of model fitting, summary, comparison, and visualization in the R environment."/>

<link rel="canonical" href="https://journal.r-project.org/articles/RJ-2023-020/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-02-25"/>
<meta property="article:created" itemprop="dateCreated" content="2023-02-25"/>
<meta name="article:author" content="Zehang Richard Li"/>
<meta name="article:author" content="Jason Thomas"/>
<meta name="article:author" content="Eungang Choi"/>
<meta name="article:author" content="Tyler H. McCormick"/>
<meta name="article:author" content="Samuel J Clark"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="The R Journal: The openVA Toolkit for Verbal Autopsies"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Verbal autopsy (VA) is a survey-based tool widely used to infer cause of death (COD) in regions without complete-coverage civil registration and vital statistics systems. In such settings, many deaths happen outside of medical facilities and are not officially documented by a medical professional. VA surveys, consisting of signs and symptoms reported by a person close to the decedent, are used to infer the COD for an individual, and to estimate and monitor the COD distribution in the population. Several classification algorithms have been developed and widely used to assign causes of death using VA data. However, the incompatibility between different idiosyncratic model implementations and required data structure makes it difficult to systematically apply and compare different methods. The openVA package provides the first standardized framework for analyzing VA data that is compatible with all openly available methods and data structure. It provides an open-source, R implementation of several most widely used VA methods. It supports different data input and output formats, and customizable information about the associations between causes and symptoms. The paper discusses the relevant algorithms, their implementations in R packages under the openVA suite, and demonstrates the pipeline of model fitting, summary, comparison, and visualization in the R environment."/>
<meta property="og:url" content="https://journal.r-project.org/articles/RJ-2023-020/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="The R Journal: The openVA Toolkit for Verbal Autopsies"/>
<meta property="twitter:description" content="Verbal autopsy (VA) is a survey-based tool widely used to infer cause of death (COD) in regions without complete-coverage civil registration and vital statistics systems. In such settings, many deaths happen outside of medical facilities and are not officially documented by a medical professional. VA surveys, consisting of signs and symptoms reported by a person close to the decedent, are used to infer the COD for an individual, and to estimate and monitor the COD distribution in the population. Several classification algorithms have been developed and widely used to assign causes of death using VA data. However, the incompatibility between different idiosyncratic model implementations and required data structure makes it difficult to systematically apply and compare different methods. The openVA package provides the first standardized framework for analyzing VA data that is compatible with all openly available methods and data structure. It provides an open-source, R implementation of several most widely used VA methods. It supports different data input and output formats, and customizable information about the associations between causes and symptoms. The paper discusses the relevant algorithms, their implementations in R packages under the openVA suite, and demonstrates the pipeline of model fitting, summary, comparison, and visualization in the R environment."/>
<meta property="twitter:url" content="https://journal.r-project.org/articles/RJ-2023-020/"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="The R Journal: The openVA Toolkit for Verbal Autopsies"/>
<meta name="citation_fulltext_html_url" content="https://journal.r-project.org/articles/RJ-2023-020/"/>
<meta name="citation_pdf_url" content="openVA-RJ-R1.pdf"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="1"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/02/25"/>
<meta name="citation_publication_date" content="2023/02/25"/>
<meta name="citation_author" content="Zehang Richard Li"/>
<meta name="citation_author_institution" content="University of California, Santa Cruz"/>
<meta name="citation_author" content="Jason Thomas"/>
<meta name="citation_author_institution" content="The Ohio State University"/>
<meta name="citation_author" content="Eungang Choi"/>
<meta name="citation_author_institution" content="The Ohio State University"/>
<meta name="citation_author" content="Tyler H. McCormick"/>
<meta name="citation_author_institution" content="University of Washington"/>
<meta name="citation_author" content="Samuel J Clark"/>
<meta name="citation_author_institution" content="The Ohio State University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Bayesian nested latent class models for cause-of-death assignment using verbal autopsies across multiple domains;citation_author=Zehang Richard Li;citation_author=Zhenke Wu;citation_author=Irena Chen;citation_author=Samuel J Clark"/>
  <meta name="citation_reference" content="citation_title=Tree-informed Bayesian multi-source domain adaptation: Cross-population probabilistic cause-of-death assignment using verbal autopsy;citation_author=Zhenke Wu;citation_author=Zehang Richard Li;citation_author=Irena Chen;citation_author=Mengbing Li"/>
  <meta name="citation_reference" content="citation_title=Shiny: Web application framework for r;citation_author=Winston Chang;citation_author=Joe Cheng;citation_author=JJ Allaire;citation_author=Carson Sievert;citation_author=Barret Schloerke;citation_author=Yihui Xie;citation_author=Jeff Allen;citation_author=Jonathan McPherson;citation_author=Alan Dipert;citation_author=Barbara Borges"/>
  <meta name="citation_reference" content="citation_title=An integrated approach to processing WHO-2016 verbal autopsy data: The InterVA-5 model;citation_publisher=BioMed Central;citation_volume=17;citation_author=Peter Byass;citation_author=Laith Hussain-Alkhateeb;citation_author=Lucia D’Ambruoso;citation_author=Samuel Clark;citation_author=Justine Davies;citation_author=Edward Fottrell;citation_author=Jon Bird;citation_author=Chodziwadziwa Kabudula;citation_author=Stephen Tollman;citation_author=Kathleen Kahn;citation_author=Linus Schiöler;citation_author=Max Petzold"/>
  <meta name="citation_reference" content="citation_title=Software for automating the processing of verbal autopsy data;citation_publisher=https://github.com/verbal-autopsy-software/openVA_App; Accessed July 21, 2021.;citation_author=Jason Thomas"/>
  <meta name="citation_reference" content="citation_title=Prepare data from WHO and PHRMC instruments for verbal autopsy algorithms;citation_publisher=https://pypi.org/project/pycrossva/; Accessed July 21, 2021.;citation_author=Eungang Choi;citation_author=Jason Thomas;citation_author=Elizabeth Karpinski"/>
  <meta name="citation_reference" content="citation_title=Software for automating the processing of verbal autopsy data.;citation_publisher=https://openva-pipeline.readthedocs.io/; Accessed July 21, 2021.;citation_author=Jason Thomas;citation_author=Sam J. Clark;citation_author=Martin W. Bratschi"/>
  <meta name="citation_reference" content="citation_title=SmartVA-Analyze desktop application;citation_publisher=https://github.com/ihmeuw/SmartVA-Analyze; Accessed July 21, 2021.;citation_author=SmartVA-Analyze desktop application"/>
  <meta name="citation_reference" content="citation_title=Naive bayes classifiers for verbal autopsies: Comparison to physician-based classification for 21,000 child and adult deaths;citation_publisher=BioMed Central;citation_volume=13;citation_author=Pierre Miasnikof;citation_author=Vasily Giannakeas;citation_author=Mireille Gomes;citation_author=Lukasz Aleksandrowicz;citation_author=Alexander Y Shestopaloff;citation_author=Dewan Alam;citation_author=Stephen Tollman;citation_author=Akram Samarikhalaj;citation_author=Prabhat Jha"/>
  <meta name="citation_reference" content="citation_title=Performance of the tariff method: Validation of a simple additive algorithm for analysis of verbal autopsies;citation_volume=9;citation_author=S. L. James;citation_author=A. D. Flaxman;citation_author=C. J. Murray;citation_author=Performance of the tariff method: Validation of a simple additive algorithm for analysis of verbal autopsies"/>
  <meta name="citation_reference" content="citation_title=FActor regression for verbal autopsy;citation_publisher=https://github.com/kelrenmor/farva; Accessed July 21, 2021. GitHub;citation_author=Kelly R Moran"/>
  <meta name="citation_reference" content="citation_title=Generalized Bayesian quantification learning;citation_publisher=Taylor &amp; Francis;citation_author=Jacob Fiksel;citation_author=Abhirup Datta;citation_author=Agbessi Amouzou;citation_author=Scott Zeger"/>
  <meta name="citation_reference" content="citation_title=calibratedVA: Locally calibrated cause specific mortality fractions using verbal autopsy data;citation_author=Jacob Fiksel;citation_author=Abhirup Datta"/>
  <meta name="citation_reference" content="citation_title=: Verbal autopsy data transformation for InSilicoVA and InterVA5 algorithms;citation_author=Jason Thomas;citation_author=Eungang Choi;citation_author=Zehang Li;citation_author=Nicolas Maire;citation_author=Tyler McCormick;citation_author=Peter Byass;citation_author=Sam Clark"/>
  <meta name="citation_reference" content="citation_title=Bayesian hierarchical factor regression models to infer cause of death from verbal autopsy data;citation_publisher=Wiley Online Library;citation_author=Kelly R Moran;citation_author=Elizabeth L Turner;citation_author=David Dunson;citation_author=Amy H Herring"/>
  <meta name="citation_reference" content="citation_title=Strengthening standardised interpretation of verbal autopsy data: The new InterVA-4 tool;citation_publisher=Co-Action Publishing;citation_volume=5;citation_author=Peter Byass;citation_author=Daniel Chandramohan;citation_author=Samuel J Clark;citation_author=Lucia D’Ambruoso;citation_author=Edward Fottrell;citation_author=Wendy J Graham;citation_author=Abraham J Herbst;citation_author=Abraham Hodgson;citation_author=Sennen Hounton;citation_author=Kathleen Kahn;citation_author=Strengthening standardised interpretation of verbal autopsy data: The new InterVA-4 tool"/>
  <meta name="citation_reference" content="citation_title=Population Health Metrics Research Consortium gold standard verbal autopsy validation study: Design, implementation, and development of analysis datasets;citation_publisher=BioMed Central Ltd;citation_volume=9;citation_author=Christopher JL Murray;citation_author=Alan D Lopez;citation_author=Robert Black;citation_author=Ramesh Ahuja;citation_author=Said M Ali;citation_author=Abdullah Baqui;citation_author=Lalit Dandona;citation_author=Emily Dantzer;citation_author=Vinita Das;citation_author=Usha Dhingra;citation_author=Population Health Metrics Research Consortium gold standard verbal autopsy validation study: Design, implementation, and development of analysis datasets"/>
  <meta name="citation_reference" content="citation_title=Probabilistic cause-of-death assignment using verbal autopsies;citation_volume=111;citation_author=Tyler H. McCormick;citation_author=Zehang Richard Li;citation_author=Clara Calvert;citation_author=Amelia C. Crampin;citation_author=Kathleen Kahn;citation_author=Samuel J. Clark"/>
  <meta name="citation_reference" content="citation_title=Bayesian factor models for probabilistic cause of death assessment with verbal autopsies;citation_publisher=The Institute of Mathematical Statistics;citation_volume=14;citation_author=Tsuyoshi Kunihama;citation_author=Zehang R Li;citation_author=Samuel J Clark;citation_author=Tyler H McCormick"/>
  <meta name="citation_reference" content="citation_title=The case for verbal autopsy in health systems strengthening;citation_publisher=ELSEVIER SCI LTD;citation_volume=5;citation_issn={2214-109X};citation_author=Lucia D’Ambruoso;citation_author=Ties Boerma;citation_author=Peter Byass;citation_author=Edward Fottrell;citation_author=Kobus Herbst;citation_author=Karin Kallander;citation_author=Zoe Mullan"/>
  <meta name="citation_reference" content="citation_title=InterVA-4 Software [Windows Executable];citation_author=Peter Byass"/>
  <meta name="citation_reference" content="citation_title=Using Bayesian latent Gaussian graphical models to infer symptom associations in verbal autopsies;citation_publisher=NIH Public Access;citation_volume=15;citation_author=Zehang R Li;citation_author=Tyler H McCormick;citation_author=Samuel J Clark"/>
  <meta name="citation_reference" content="citation_title=Regularized bayesian transfer learning for population-level etiological distributions;citation_author=Abhirup Datta;citation_author=Jacob Fiksel;citation_author=Agbessi Amouzou;citation_author=Scott L Zeger"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","description","type","preamble","bibliography","output","journal","slug","pdf_url","creative_commons","date","packages","CTV","csl","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["The openVA Toolkit for Verbal Autopsies"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Zehang Richard Li"]},{"type":"character","attributes":{},"value":["University of California, Santa Cruz"]},{"type":"character","attributes":{},"value":["Santa Cruz CA, USA"]},{"type":"character","attributes":{},"value":["0000-0001-9551-9638"]},{"type":"character","attributes":{},"value":["lizehang@ucsc.edu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","orcid_id","email","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Jason Thomas"]},{"type":"character","attributes":{},"value":["0000-0002-7694-3262"]},{"type":"character","attributes":{},"value":["thomas.3912@osu.edu"]},{"type":"character","attributes":{},"value":["The Ohio State University"]},{"type":"character","attributes":{},"value":["Columbus, OH, USA"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","orcid_id","email","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Eungang Choi"]},{"type":"character","attributes":{},"value":["0000-0003-1333-8126"]},{"type":"character","attributes":{},"value":["choi.1443@osu.edu"]},{"type":"character","attributes":{},"value":["The Ohio State University"]},{"type":"character","attributes":{},"value":["Columbus, OH, USA"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","orcid_id","email","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Tyler H. McCormick"]},{"type":"character","attributes":{},"value":["0000-0002-6490-1129"]},{"type":"character","attributes":{},"value":["tylermc@u.washington.edu"]},{"type":"character","attributes":{},"value":["University of Washington"]},{"type":"character","attributes":{},"value":["Seattle, WA, USA"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","orcid_id","email","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Samuel J Clark"]},{"type":"character","attributes":{},"value":["0000-0002-4929-6231"]},{"type":"character","attributes":{},"value":["work@samclark.net"]},{"type":"character","attributes":{},"value":["The Ohio State University"]},{"type":"character","attributes":{},"value":["Columbus, OH, USA"]}]}]},{"type":"character","attributes":{},"value":["Verbal autopsy (VA) is a survey-based tool widely used to infer cause of death (COD) in regions without complete-coverage civil registration and vital statistics systems. In such settings, many deaths happen outside of medical facilities and are not officially documented by a medical professional. VA surveys, consisting of signs and symptoms reported by a person close to the decedent, are used to infer the COD for an individual, and to estimate and monitor the COD distribution in the population. Several classification algorithms have been developed and widely used to assign causes of death using VA data. However, the incompatibility between different idiosyncratic model implementations and required data structure makes it difficult to systematically apply and compare different methods. The openVA package provides the first standardized framework for analyzing VA data that is compatible with all openly available methods and data structure. It provides an open-source, R implementation of several most widely used VA methods. It supports different data input and output formats, and customizable information about the associations between causes and symptoms. The paper discusses the relevant algorithms, their implementations in R packages under the openVA suite, and demonstrates the pipeline of model fitting, summary, comparison, and visualization in the R environment."]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["\\usepackage{amsmath, amsthm, amsfonts, amssymb, bm, natbib}\n\\newcommand{\\red}[1]{\\textcolor{red}{#1}}\n\\newcommand{\\proglang}[1]{\\text{#1}}\n"]},{"type":"character","attributes":{},"value":["openVA-RJ-R1.bib"]},{"type":"character","attributes":{},"value":["rjtools::rjournal_web_article"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"double","attributes":{},"value":[1]},{"type":"NULL"}]},{"type":"character","attributes":{},"value":["openVA-RJ-R1"]},{"type":"character","attributes":{},"value":["openVA-RJ-R1.pdf"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["2023-02-25"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["openVA","InterVA4","InterVA5","InSilicoVA","Tariff","nbc4va","shiny","CrossVA"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["WebTechnologies"]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://journal.r-project.org/articles/RJ-2023-020/"]},{"type":"character","attributes":{},"value":["https://journal.r-project.org/articles/RJ-2023-020/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["correspondence/1-invite-1.txt","correspondence/1-invite-2.txt","correspondence/1-invite-3.txt","correspondence/1-invite-4.txt","correspondence/1-review-1.docx","correspondence/1-review-4.pdf","cover_letter.pdf","DESCRIPTION","errorlog.txt","Figures.zip","history/1.zip","history/2.zip","initial_checks.log","openVA-RJ-R1_files/anchor-4.2.2/anchor.min.js","openVA-RJ-R1_files/bowser-1.9.3/bowser.min.js","openVA-RJ-R1_files/distill-2.2.21/template.v2.js","openVA-RJ-R1_files/figure-html5/ins3-1.png","openVA-RJ-R1_files/figure-html5/ins4-1.png","openVA-RJ-R1_files/figure-html5/ins5-1.png","openVA-RJ-R1_files/figure-html5/ins6-1.png","openVA-RJ-R1_files/figure-html5/ins6-2.png","openVA-RJ-R1_files/figure-html5/phy3-1.png","openVA-RJ-R1_files/figure-html5/phy3-2.png","openVA-RJ-R1_files/figure-html5/vis-1-1.png","openVA-RJ-R1_files/figure-html5/vis-2-1.png","openVA-RJ-R1_files/figure-html5/vis-3-1.png","openVA-RJ-R1_files/figure-latex/ins3-1.png","openVA-RJ-R1_files/figure-latex/ins4-1.png","openVA-RJ-R1_files/figure-latex/ins5-1.png","openVA-RJ-R1_files/figure-latex/ins6-1.png","openVA-RJ-R1_files/figure-latex/ins6-2.png","openVA-RJ-R1_files/figure-latex/phy3-1.png","openVA-RJ-R1_files/figure-latex/phy3-2.png","openVA-RJ-R1_files/figure-latex/vis-1-1.png","openVA-RJ-R1_files/figure-latex/vis-2-1.png","openVA-RJ-R1_files/figure-latex/vis-3-1.png","openVA-RJ-R1_files/header-attrs-2.20/header-attrs.js","openVA-RJ-R1_files/jquery-3.6.0/jquery-3.6.0.js","openVA-RJ-R1_files/jquery-3.6.0/jquery-3.6.0.min.js","openVA-RJ-R1_files/jquery-3.6.0/jquery-3.6.0.min.map","openVA-RJ-R1_files/popper-2.6.0/popper.min.js","openVA-RJ-R1_files/tippy-6.2.7/tippy-bundle.umd.min.js","openVA-RJ-R1_files/tippy-6.2.7/tippy-light-border.css","openVA-RJ-R1_files/tippy-6.2.7/tippy.css","openVA-RJ-R1_files/tippy-6.2.7/tippy.umd.min.js","openVA-RJ-R1_files/webcomponents-2.0.0/webcomponents.js","openVA-RJ-R1.bib","openVA-RJ-R1.pdf","openVA-RJ-R1.tex","responses.pdf","RJwrapper.tex","supplementaries.zip","VA_result.csv","warnings.txt"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.20/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="https://twitter.com/intent/tweet?text='+title+'&url=' + cite_url + '" class="dt-tag"><i class="fab fa-twitter"></i> Tweet</a>')

      const abstract = $('<d-abstract>')
      abstract.append('<b>Abstract:</b><br>')
      abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
      $("d-title p:empty").remove() // Remove empty paragraphs after title
      abstract.append(buttons)
      abstract.insertAfter($('d-title')) // Add abstract section after title

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"The openVA Toolkit for Verbal Autopsies","description":"Verbal autopsy (VA) is a survey-based tool widely used to infer cause of death (COD) in regions without complete-coverage civil registration and vital statistics systems. In such settings, many deaths happen outside of medical facilities and are not officially documented by a medical professional. VA surveys, consisting of signs and symptoms reported by a person close to the decedent, are used to infer the COD for an individual, and to estimate and monitor the COD distribution in the population. Several classification algorithms have been developed and widely used to assign causes of death using VA data. However, the incompatibility between different idiosyncratic model implementations and required data structure makes it difficult to systematically apply and compare different methods. The openVA package provides the first standardized framework for analyzing VA data that is compatible with all openly available methods and data structure. It provides an open-source, R implementation of several most widely used VA methods. It supports different data input and output formats, and customizable information about the associations between causes and symptoms. The paper discusses the relevant algorithms, their implementations in R packages under the openVA suite, and demonstrates the pipeline of model fitting, summary, comparison, and visualization in the R environment.","authors":[{"author":"Zehang Richard Li","authorURL":"#","affiliation":"University of California, Santa Cruz","affiliationURL":"#","orcidID":"0000-0001-9551-9638"},{"author":"Jason Thomas","authorURL":"#","affiliation":"The Ohio State University","affiliationURL":"#","orcidID":"0000-0002-7694-3262"},{"author":"Eungang Choi","authorURL":"#","affiliation":"The Ohio State University","affiliationURL":"#","orcidID":"0000-0003-1333-8126"},{"author":"Tyler H. McCormick","authorURL":"#","affiliation":"University of Washington","affiliationURL":"#","orcidID":"0000-0002-6490-1129"},{"author":"Samuel J Clark","authorURL":"#","affiliation":"The Ohio State University","affiliationURL":"#","orcidID":"0000-0002-4929-6231"}],"publishedDate":"2023-02-25T00:00:00.000+00:00","citationText":"Li, et al., 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../issues/2023-1">Current</a>
<a href="../../submissions.html">Submit</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>The openVA Toolkit for Verbal Autopsies</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Verbal autopsy (VA) is a survey-based tool widely used to infer cause of death (COD) in regions without complete-coverage civil registration and vital statistics systems. In such settings, many deaths happen outside of medical facilities and are not officially documented by a medical professional. VA surveys, consisting of signs and symptoms reported by a person close to the decedent, are used to infer the COD for an individual, and to estimate and monitor the COD distribution in the population. Several classification algorithms have been developed and widely used to assign causes of death using VA data. However, the incompatibility between different idiosyncratic model implementations and required data structure makes it difficult to systematically apply and compare different methods. The openVA package provides the first standardized framework for analyzing VA data that is compatible with all openly available methods and data structure. It provides an open-source, R implementation of several most widely used VA methods. It supports different data input and output formats, and customizable information about the associations between causes and symptoms. The paper discusses the relevant algorithms, their implementations in R packages under the openVA suite, and demonstrates the pipeline of model fitting, summary, comparison, and visualization in the R environment.</p></p>
</div>

<div class="d-byline">
  Zehang Richard Li  (University of California, Santa Cruz)
  
,   Jason Thomas  (The Ohio State University)
  
,   Eungang Choi  (The Ohio State University)
  
,   Tyler H. McCormick  (University of Washington)
  
,   Samuel J Clark  (The Ohio State University)
  
<br/>2023-02-25
</div>

<div class="d-article">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<div class="layout-chunk" data-layout="l-body">

</div>
<!----------------------------------------------------------------->
<!----------------------------------------------------------------->
<h1 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<!----------------------------------------------------------------->
<!----------------------------------------------------------------->
<p>Verbal autopsy (VA) is a well-established approach to ascertaining the cause of death (COD) when medical certification and full autopsies are not feasible or practical <span class="citation" data-cites="garenne2014prospects-BMC taylor1983child">(<a href="#ref-taylor1983child" role="doc-biblioref">Taylor et al. 1983</a>; <a href="#ref-garenne2014prospects-BMC" role="doc-biblioref">Garenne 2014</a>)</span>. After a death is identified, a specially-trained fieldworker interviews the caregivers (usually family members) of the decedent. A typical VA interview includes a set of structured questions with categorical or quantitative responses and a narrative section that records the “story” of the death from the respondent’s point of view <span class="citation" data-cites="world2012verbal">(<a href="#ref-world2012verbal" role="doc-biblioref">World Health Organization 2012</a>)</span>. Currently, there are multiple commonly used questionnaires with overlapping, but not identical questions. VAs are routinely used both by researchers in health and demographic surveillance systems <span class="citation" data-cites="Sankoh2012 maher2010translating">(<a href="#ref-maher2010translating" role="doc-biblioref">Maher et al. 2010</a>; <a href="#ref-Sankoh2012" role="doc-biblioref">Sankoh and Byass 2012</a>)</span> and multi-country research projects <span class="citation" data-cites="nkengasong2020improving breiman2021postmortem">(<a href="#ref-nkengasong2020improving" role="doc-biblioref">Nkengasong et al. 2020</a>; <a href="#ref-breiman2021postmortem" role="doc-biblioref">Breiman et al. 2021</a>)</span>, and in national-scale surveys in many low- and middle-income countries (LMICs). For a more comprehensive overview of the current use of VA, we refer readers to <span class="citation" data-cites="Chandramohan2021Estimating">Chandramohan et al. (<a href="#ref-Chandramohan2021Estimating" role="doc-biblioref">2021</a>)</span>.</p>
<p>The process of inferring a cause from VA data consists of two components. First, there must be some external information about the relationship between causes and symptoms. In supervised learning problems, the external information is typically derived from training datasets with known labels. In the context of VA, a common practice is to obtain training data using clinically trained, experienced physicians who read a fraction of the interviews and determine causes. To address the fact that physicians frequently do not agree on causes, VA interviews are often read by two physicians, and sometimes three, and the final causes are determined through a consensus mechanism <span class="citation" data-cites="kahn2012profile">(e.g., <a href="#ref-kahn2012profile" role="doc-biblioref">Kahn et al. 2012</a>)</span>. This process can be extremely time- and resource-intensive. Another means of obtaining this information is directly through expert opinion. For example, one can ask groups of physicians to rate the likelihood of a symptoms occurring, given a particular COD, which can be converted into a set of probabilities of observing a symptom given a particular cause. Such expert knowledge can be highly useful in analyzing VA data when training datasets do not exist.</p>
<p>Secondly, an algorithmic or statistical model is needed to assign the causes of death by extrapolating the relationship between symptoms and causes to the target population. The cause-of-death assignment model is conceptually a separate construct from the symptom-cause information. The current state of the VA literature, however, often does not distinguish between the two. This is in part due to popular VA software that combines a source of symptom-cause information (e.g., a certain training data or a database of expert knowledge) with a specific algorithm, and requires a specific type of survey instrument to be used. This restriction prevents robust comparison between methods and contexts. A health agency in one region may, for example, want to analyze VA data using the same VA algorithm as a neighboring region to ensure estimates are comparable. Unless the agencies used the same survey format, however, this is not possible with existing tools.</p>
<p>The <a href="https://cran.r-project.org/package=openVA">openVA</a> package <span class="citation" data-cites="openvapkg">(<a href="#ref-openvapkg" role="doc-biblioref">Li et al. 2022b</a>)</span> addresses this issue through an open-source toolkit. The <a href="https://cran.r-project.org/package=openVA">openVA</a> suite comprises a collection of R packages for the analysis of verbal autopsy data. The goal of this package is to provide researchers with an open-source tool that supports flexible data input formats and allows easier data manipulation and model fitting. The <a href="https://cran.r-project.org/package=openVA">openVA</a> suite consists of four core packages that are on CRAN, <a href="https://cran.r-project.org/package=InterVA4">InterVA4</a> <span class="citation" data-cites="interVA4">(<a href="#ref-interVA4" role="doc-biblioref">Li et al. 2019</a>)</span>, <a href="https://cran.r-project.org/package=InterVA5">InterVA5</a> <span class="citation" data-cites="interVA5">(<a href="#ref-interVA5" role="doc-biblioref">Thomas et al. 2021b</a>)</span>, <a href="https://cran.r-project.org/package=InSilicoVA">InSilicoVA</a> <span class="citation" data-cites="insilicovapkg">(<a href="#ref-insilicovapkg" role="doc-biblioref">Li et al. 2022a</a>)</span>, and <a href="https://cran.r-project.org/package=Tariff">Tariff</a> <span class="citation" data-cites="tariffpkg">(<a href="#ref-tariffpkg" role="doc-biblioref">Li et al. 2018</a>)</span>, and an optional package <a href="https://cran.r-project.org/package=nbc4va">nbc4va</a> <span class="citation" data-cites="nbcpkg">(<a href="#ref-nbcpkg" role="doc-biblioref">Wen et al. 2022</a>)</span>. Each of these packages implements one coding algorithm. For three of these algorithms – namely, InterVA-4, InterVA-5 and Tariff – there are also compiled software programs distributed by the original authors.</p>
<p>The main focus of this paper is to provide a general introduction to the implementation details of the included algorithms both in terms of the underlying methodology, and through case studies. The <a href="https://cran.r-project.org/package=openVA">openVA</a> package has four major contributions:</p>
<ol type="1">
<li>It provides a standardized and user-friendly interface for analysts to fit and evaluate each method on different types of data input using standard syntax. Previously, most of the methods were designed to be used specifically with their own input formats and are usually incompatible with others. The <a href="https://cran.r-project.org/package=openVA">openVA</a> package closes this gap by allowing easier and fair model comparison of multiple algorithms on the same data. This significantly facilitates further research on VA algorithms.</li>
<li>It provides a series of functionalities to summarize and visualize results from multiple algorithms, which is helpful for analysts not familiar with data manipulation and visualization in R.</li>
<li>It does not directly implement any algorithms for coding VA data, so that it is possible for a research group to maintain their own algorithm implementations callable from the <a href="https://cran.r-project.org/package=openVA">openVA</a> package, while also making it available to general users as a standalone piece of software. For example, the <a href="https://cran.r-project.org/package=nbc4va">nbc4va</a> was developed and maintained independently by researchers at the Center for Global Health Research in Toronto, but is designed so that it can be seamlessly integrated into the <a href="https://cran.r-project.org/package=openVA">openVA</a> package.</li>
<li>It is fully open source, and can be run on multiple platforms. The open-source nature of <a href="https://cran.r-project.org/package=openVA">openVA</a> significantly expands its potential for methodological research and its suitability for integration within a larger data analysis pipeline. Compared to the alternative implementations, the InterVA-4 and InterVA-5 software are distributed as compiled software that can only be run on Windows system. They provide the source codes as an additional code script, which are difficult to modify and re-compile. Tariff, as implemented through the SmartVA-Analyze application <span class="citation" data-cites="serina2015improving">(<a href="#ref-serina2015improving" role="doc-biblioref">Serina et al. 2015</a>)</span>, was also primarily distributed as a compiled application that can only be run on Windows system <span class="citation" data-cites="smartVA-web">(<a href="#ref-smartVA-web" role="doc-biblioref">Institute for Health Metrics and Evaluation 2021b</a>)</span>. However, their source codes were recently made available under the open source MIT License on GitHub <span class="citation" data-cites="smartVA-git">(<a href="#ref-smartVA-git" role="doc-biblioref">Institute for Health Metrics and Evaluation 2021a</a>)</span>.</li>
</ol>
<p>The rest of this paper is organized as follows: We first briefly introduce the main component packages and the underlying algorithms. We then demonstrate standard data structures and model fitting steps with the <a href="https://cran.r-project.org/package=openVA">openVA</a> package and functionalities to summarize results. We then discuss how additional information can be incorporated into modeling VA data, and we briefly survey additional packages and software developments built around the <a href="https://cran.r-project.org/package=openVA">openVA</a> package. We end with a discussion of remaining issues and limitations of the existing automated VA algorithms and propose new functionalities to be included in <a href="https://cran.r-project.org/package=openVA">openVA</a> package.</p>
<h1 data-number="2" id="structure-of-the-openva-package"><span class="header-section-number">2</span> Structure of the openVA package</h1>
<p>The <a href="https://cran.r-project.org/package=openVA">openVA</a> suite of packages currently consists of four standalone packages that are available on CRAN and one optional package hosted on GitHub. In this section, we first provide a brief introduction to these five packages, and we discuss the mathematical details behind each algorithm in the next subsection.</p>
<ul>
<li><p><a href="https://cran.r-project.org/package=InterVA4">InterVA4</a> <span class="citation" data-cites="li2014interva4 interVA4">(<a href="#ref-li2014interva4" role="doc-biblioref">Li et al. 2014</a>; <a href="#ref-interVA4" role="doc-biblioref">Li et al. 2019</a>)</span> is an R package that implements the InterVA-4 model <span class="citation" data-cites="byass2012strengthening">(<a href="#ref-byass2012strengthening" role="doc-biblioref">Byass et al. 2012</a>)</span>. It provides replication of the widely used InterVA software <span class="citation" data-cites="2015interVA">(<a href="#ref-2015interVA" role="doc-biblioref">Byass 2015</a>)</span>. The standard input of <a href="https://cran.r-project.org/package=InterVA4">InterVA4</a> is in the form of a pre-defined set of indicators, based on the 2012 World Health Organization (WHO) VA instrument <span class="citation" data-cites="world2012verbal">(<a href="#ref-world2012verbal" role="doc-biblioref">World Health Organization 2012</a>)</span>. The default InterVA-4 algorithm cannot be applied to other data input formats because its internal built-in prior information is specific to a fixed set of indicators and causes. The same restriction is also maintained in the <a href="https://cran.r-project.org/package=InterVA4">InterVA4</a> package. However, the mathematical formulation of the InterVA-4 model is completely generalizable to other binary input formats, as described in later sections, and is also implemented in the <a href="https://cran.r-project.org/package=openVA">openVA</a> package.</p></li>
<li><p><a href="https://cran.r-project.org/package=InterVA5">InterVA5</a> <span class="citation" data-cites="interVA5">(<a href="#ref-interVA5" role="doc-biblioref">Thomas et al. 2021b</a>)</span> is an R package that implements the InterVA-5 model <span class="citation" data-cites="byass2019integrated">(<a href="#ref-byass2019integrated" role="doc-biblioref">Byass et al. 2019</a>)</span>. The InterVA-5 model updates the previous version in several ways. First, the input data must adhere to the format of the 2016 WHO VA instrument <span class="citation" data-cites="dambruoso2017">(<a href="#ref-dambruoso2017" role="doc-biblioref">D’Ambruoso et al. 2017</a>)</span>. Second, changes have been made to the data processing steps. It is also worth noting that the model outputs have been expanded by the inclusion of the most likely Circumstances Of Mortality CATegory, or COMCAT, among the results – the categories include: culture, emergency, health systems, inevitable, knowledge, resources, or an indeterminant combination of multiple factors <span class="citation" data-cites="dambruoso2017">(for more details, see <a href="#ref-dambruoso2017" role="doc-biblioref">D’Ambruoso et al. 2017</a>)</span>. Despite these changes, the mathematical formulation of InterVA-5 is identical to that of InterVA-4.</p></li>
<li><p><a href="https://cran.r-project.org/package=InSilicoVA">InSilicoVA</a> <span class="citation" data-cites="insilicovapkg">(<a href="#ref-insilicovapkg" role="doc-biblioref">Li et al. 2022a</a>)</span> is an R package that implements the InSilicoVA algorithm, a Bayesian hierarchical framework for cause-of-death assignment and cause-specific mortality fraction estimation proposed in <span class="citation" data-cites="insilico">McCormick et al. (<a href="#ref-insilico" role="doc-biblioref">2016</a>)</span>. It is originally designed to work with the WHO VA instrument, i.e., the same input data used by the InterVA software, but is also generalizable to other data input formats. It is a fully probabilistic algorithm and can incorporate multiple sources of information, such as known sub-populations in the dataset, and physician coding when such data are available. The Markov Chain Monte Carlo (MCMC) sampler is implemented in Java for improved speed.</p></li>
<li><p><a href="https://cran.r-project.org/package=Tariff">Tariff</a> <span class="citation" data-cites="tariffpkg">(<a href="#ref-tariffpkg" role="doc-biblioref">Li et al. 2018</a>)</span> is an R package that implements the Tariff algorithm <span class="citation" data-cites="james">(<a href="#ref-james" role="doc-biblioref">James et al. 2011</a>)</span>. It most closely reflects the description of the Tariff 2.0 method <span class="citation" data-cites="serina2015improving">(<a href="#ref-serina2015improving" role="doc-biblioref">Serina et al. 2015</a>)</span>. The Tariff algorithm is developed by the Institute for Health Metrics and Evaluation (IHME) and is officially implemented in the SmartVA-Analyze software <span class="citation" data-cites="smartVA-web">(<a href="#ref-smartVA-web" role="doc-biblioref">Institute for Health Metrics and Evaluation 2021b</a>)</span>. However, as the developers of this R package are not affiliated with the authors of the original algorithm, there are some discrepancies in implementation. The source code of the two versions of Tariff was not publicly available at the time when the <a href="https://cran.r-project.org/package=Tariff">Tariff</a> package was created, so the package was developed based solely on the descriptions in the published work. Despite the difference in implementation, <a href="https://cran.r-project.org/package=Tariff">Tariff</a> is able to achieve comparable results as the published work as demonstrated in <span class="citation" data-cites="insilico">McCormick et al. (<a href="#ref-insilico" role="doc-biblioref">2016</a>)</span>. More detailed descriptions of the <a href="https://cran.r-project.org/package=Tariff">Tariff</a> implementations are also discussed in the supplement of <span class="citation" data-cites="insilico">McCormick et al. (<a href="#ref-insilico" role="doc-biblioref">2016</a>)</span>. The later released Python source codes of SmartVA-Analyze have been incorporated in the web application extension of the <a href="https://cran.r-project.org/package=openVA">openVA</a> package.</p></li>
<li><p><a href="https://cran.r-project.org/package=nbc4va">nbc4va</a> <span class="citation" data-cites="nbcpkg">(<a href="#ref-nbcpkg" role="doc-biblioref">Wen et al. 2022</a>)</span> is an R package that implements the Naive Bayes Classifier for VA encoding <span class="citation" data-cites="miasnikof2015naive">(<a href="#ref-miasnikof2015naive" role="doc-biblioref">Miasnikof et al. 2015</a>)</span>. It calculates the conditional probabilities of symptoms given causes of death from a training dataset, instead of using physician-provided values. <a href="https://cran.r-project.org/package=nbc4va">nbc4va</a> is developed and maintained by researchers at the Center for Global Health Research in Toronto, but is designed so that it can be seamlessly integrated into <a href="https://cran.r-project.org/package=openVA">openVA</a>. It is an optional package that users can choose to load separately.</p></li>
</ul>
<p>We note that there are additional methods and implementations to assign causes of death using VA data that are not included in the <a href="https://cran.r-project.org/package=openVA">openVA</a> implementation <span class="citation" data-cites="flaxman2011random jeblee2019automatically">(e.g., <a href="#ref-flaxman2011random" role="doc-biblioref">Flaxman et al. 2011</a>; <a href="#ref-jeblee2019automatically" role="doc-biblioref">Jeblee et al. 2019</a>)</span>. These methods are not widely adopted by VA practitioners and most of these implementations are either not publicly available or require data processing steps that are specific to certain datasets, making them impractical for routine use in general. In addition, while the cause-of-death assignment process is closely related to the generic multi-class classification problem, naive application of off-the-shelf classification algorithms has been shown to perform poorly in the context of VA <span class="citation" data-cites="murray2014using">(<a href="#ref-murray2014using" role="doc-biblioref">Murray et al. 2014</a>)</span>. Therefore, we focus on the methods that are currently adopted by practitioners. We briefly survey some more recent developments and their implementations at the end of this paper.</p>
<p>The <a href="https://cran.r-project.org/package=openVA">openVA</a> package is hosted on CRAN and can be installed with the following commands. Since posterior inference is carried out using MCMC in the InSilicoVA algorithm, we set the seed for the random number generator to make the paper reproducible. For the analysis in this paper, we also install the <a href="https://cran.r-project.org/package=nbc4va">nbc4va</a> package separately from GitHub. The versions of the supporting packages can be checked in R using the <code>openVA_status()</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/verbal-autopsy-software/openVA'>openVA</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/openVA/man/openVA_status.html'>openVA_status</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 class="unnumbered" id="overview-of-va-cause-of-death-assignment-methods">Overview of VA cause-of-death assignment methods</h2>
<p>The common modeling framework for VA data consists of first converting the survey responses into a series of binary variables, and then assigning a COD to each death based on the binary input variables. Typically, the target of inference consists of two parts: the individual cause-of-death assignment, and the population-level cause-specific mortality fractions (CSMF), i.e., the fraction of deaths due to each cause. In this section, we formally compare the modeling approaches utilized by each algorithm for these two targets. We adopt the following notations. Consider <span class="math inline">\(N\)</span> deaths, each with <span class="math inline">\(S\)</span> binary indicators of symptoms. Let <span class="math inline">\(s_{ij}\)</span> denote the indicator for the presence of <span class="math inline">\(j\)</span>-th symptom in the <span class="math inline">\(i\)</span>-th death, which can take values 0, 1, or NA (for missing data). We consider a pre-defined set of causes of size <span class="math inline">\(C\)</span>. For the <span class="math inline">\(i\)</span>-th death, denote the COD by <span class="math inline">\(y_i \in \{1, ..., C\}\)</span> and the probability of dying from cause <span class="math inline">\(k\)</span> is denoted by <span class="math inline">\(P_{ik}\)</span>. For the population, the CSMF of cause <span class="math inline">\(k\)</span> is denoted as <span class="math inline">\(\pi_k\)</span>, with <span class="math inline">\(\sum_{k=1}^C \pi_k = 1\)</span>.</p>
<ul>
<li><p><strong>InterVA4</strong> <span class="citation" data-cites="byass2012strengthening">(<a href="#ref-byass2012strengthening" role="doc-biblioref">Byass et al. 2012</a>)</span> and <strong>InterVA5</strong> <span class="citation" data-cites="byass2019integrated">(<a href="#ref-byass2019integrated" role="doc-biblioref">Byass et al. 2019</a>)</span> algorithms calculate the probability of each COD given the observed symptoms using the following formula,
<span class="math display">\[
P_{ik} = \frac{\pi_{k}^{(0)} \prod_{j=1}^S P(s_{ij}=1|y_{i}=k) \mathbf{1}_{s_{ij} = 1}}
{\sum_{k&#39; = 1}^C \pi_{k&#39;}^{(0)} \prod_{j=1}^S P(s_{ij}=1|y_{i}=k&#39;) \mathbf{1}_{s_{ij} = 1}},
\]</span>
where both the prior distribution of each of the causes, <span class="math inline">\(\pi_{k}^{(0)}\)</span> and the conditional probabilities <span class="math inline">\(P(s_{ij} = 1 | y_i = k)\)</span> are fixed values provided in the InterVA software. It is worth noting that the formula does not follow the standard Bayes’ rule as it omits the probability that any symptom is absent. A detailed discussion of this modeling choice can be found in <span class="citation" data-cites="insilico">McCormick et al. (<a href="#ref-insilico" role="doc-biblioref">2016</a>)</span>. The conditional probabilities, <span class="math inline">\(P(s_{ij}=1|y_{i}=k)\)</span>, used in InterVA algorithms are represented as rankings with letter grades instead of numerical values <span class="citation" data-cites="byass2012strengthening">(<a href="#ref-byass2012strengthening" role="doc-biblioref">Byass et al. 2012</a>)</span>. For example, <span class="math inline">\(P(s_{ij}=1|y_{i}=k) = A+\)</span> is translated into <span class="math inline">\(P(s_{ij}=1|y_{i}=k) = 0.8\)</span>, etc. The standard InterVA software only supports the fixed set of symptoms and causes where such prior information is provided. For a different data input format, this formulation can be easily generalized if training data are available. We include in the <a href="https://cran.r-project.org/package=openVA">openVA</a> package an extension of the algorithm that calculates <span class="math inline">\(\hat P(s_{ij}=1|y_{i}=k)\)</span> from the empirical distribution in the training data and then maps to letter grades with different truncation rules. Details of the extended InterVA algorithm can be found in <span class="citation" data-cites="insilico">McCormick et al. (<a href="#ref-insilico" role="doc-biblioref">2016</a>)</span>.</p>
<p>After the individual COD distributions are calculated, InterVA-4 utilizes a series of pre-defined rules to identify up to the top three most likely COD assignments, and truncates the probabilities for the rest of the CODs to 0 and adds an ‘undetermined’ category so that the probabilities sum up to 1 (See the user guide of <span class="citation" data-cites="2015interVA">Byass (<a href="#ref-2015interVA" role="doc-biblioref">2015</a>)</span>). Then the population-level CSMFs are calculated as the aggregation of individual COD distributions, such that
<span class="math display">\[
\pi_k = \sum_{i=1}^N P^*_{ik},
\]</span>
where <span class="math inline">\(P^*_{ik}\)</span> denotes the individual COD distribution after introducing the undetermined category.</p></li>
<li><p><strong>Naive Bayes Classifier</strong> <span class="citation" data-cites="miasnikof2015naive">(<a href="#ref-miasnikof2015naive" role="doc-biblioref">Miasnikof et al. 2015</a>)</span> is very similar to the InterVA algorithm with two major differences. First, instead of considering only symptoms that present, the NBC algorithm also considers symptoms that are absent. Second, the conditional probabilities of symptoms given causes are calculated from training data instead of given by physicians, which is similar to our extension of InterVA discussed above. Similar to InterVA, the NBC method can be written as
<span class="math display">\[
P_{ik} = \frac{\pi_{k}^{(0)} \prod_{j=1}^S (P(s_{ij}=1|y_{i}=k) \mathbf{1}_{s_{ij} = 1} + P(s_{ij} \neq 1|y_{i}=k) \mathbf{1}_{s_{ij} \neq 1})}
{\sum_{k&#39; = 1}^C \pi_{k&#39;}^{(0)} \prod_{j=1}^S (P(s_{ij}=1|y_{i}=k&#39;) \mathbf{1}_{s_{ij} = 1}+ P(s_{ij} \neq 1|y_{i}=k&#39;) \mathbf{1}_{s_{ij} \neq 1})},
\]</span>
and the CSMFs are calculated by <span class="math inline">\(\pi_k = \sum_{i=1}^N P_{ik}\)</span>.</p></li>
<li><p><strong>InSilicoVA</strong> algorithm <span class="citation" data-cites="insilico">(<a href="#ref-insilico" role="doc-biblioref">McCormick et al. 2016</a>)</span> assumes a generative model that characterizes both the CSMF at the population level, and the COD distributions at the individual level. In short, the core generative process assumes
<span class="math display">\[\begin{eqnarray}
s_{ij} | y_i = k &amp;\propto&amp; \mbox{Bernoulli}(P(s_{ij} | y_i = k)), \\
y_i | \pi_1, ..., \pi_C &amp;\propto&amp; \mbox{Categorical}(\pi_1, ..., \pi_C), \\
\pi_k &amp;=&amp; \exp \theta_k / \sum_{k=1}^C \exp \theta_k, \\
\theta_k &amp;\propto&amp; \mbox{Normal}(\mu, \sigma^2).
\end{eqnarray}\]</span>
Hyperpriors are also placed on <span class="math inline">\(P(s_{ij} | y_i = k)\)</span>, <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(\sigma^2\)</span>. The priors for <span class="math inline">\(P(s_{ij} | y_i = k)\)</span> are set by the rankings used in InterVA-4 if the data are prepared into InterVA format, otherwise they are learned from training data. The priors on <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are diffuse uniform priors. Parameter estimation is performed using MCMC, so that a sample of posterior distributions of <span class="math inline">\(\pi_k\)</span> can be obtained after the sampler converges.
<!-- Additional heuristics of data processing steps introduced since the original publication of the method is discussed in Section \ref{app:insilico} of the Appendix. --></p></li>
<li><p><strong>Tariff</strong> algorithm <span class="citation" data-cites="james">(<a href="#ref-james" role="doc-biblioref">James et al. 2011</a>)</span> differs from the other three methods in that it does not calculate an explicit probability distribution of the COD for each death. Instead, for each death <span class="math inline">\(i\)</span>, a Tariff score is calculated for each COD <span class="math inline">\(k\)</span> so that
<span class="math display">\[
Score_{ik} = \sum_{j = 1}^{S} \mbox{Tariff}_{kj}\mathbf{1}_{s_{ij}=1},
\]</span>
where the symptom-specific Tariff score <span class="math inline">\(\mbox{Tariff}_{kj}\)</span> is defined as
<span class="math display">\[
\mbox{Tariff}_{kj} = \frac{n_{kj} - median(n_{1j}, n_{2j}, ..., n_{Cj})} {IQR(n_{1j}, n_{2j}, ..., n_{Cj})},
\]</span>
where <span class="math inline">\(n_{kj}\)</span> is the count of how many deaths from cause <span class="math inline">\(k\)</span> contain symptom <span class="math inline">\(j\)</span> in the training data. The Tariff scores are then turned into rankings by comparing them to a reference distribution of scores calculated from re-sampling the training dataset to obtain a uniform COD distribution. It is worth noting that the Tariff algorithm produces the COD distribution for each death in terms of their rankings instead of the probability distributions. And thus the CSMF for each cause <span class="math inline">\(k\)</span> is calculated by the fraction of deaths with cause <span class="math inline">\(k\)</span> being the highest ranked cause, i.e.,
<span class="math display">\[
\pi_k = \frac{\sum_{i=1}^N\mathbf{1}_{y_i = k}}{N}.
\]</span></p></li>
</ul>
<p>In addition to the different model specifications underlying each algorithm, there is also a major conceptual difference in handling missing symptoms across the algorithms. Missing symptoms could arise from different stages of the data collection process. For example, the respondent may not know whether certain symptoms existed or may refuse to answer a question. From a statistical point of view, knowing that a symptom does not exist provides some information to the possible cause assignment, while a missing symptom does not. Although in theory, most of the VA algorithms could benefit from distinguishing ‘missing’ from ‘absence’, InSilicoVA is the only algorithm that has been implemented to acknowledge missing data. Missing indicators are assumed to be equivalent to ‘absence’ in InterVA, NBC, and Tariff.</p>
<!-- Some further feature comparisons are summarized in Table [\@ref(tab:compare)].

\begin{table}[htb]
\begin{tabular}{l|c|c|c|c}
\toprule
Feature  &  InterVA & Tariff & NBC & InSilicoVA \\\hline
Exact replication in the current \CRANpkg{openVA} package & Yes & No& Yes & Yes \\
Implementable without training dataset  & Yes & No & No & Yes \\
Can produce instantaneous results for single death  & Yes & Yes & Yes & No \\
Accounts for absence of symptoms & No & No & Yes & Yes \\
Accounts for missing symptoms & No & No & No & Yes \\
Provides individual COD distribution & Yes & No & Yes & Yes\\
Direct estimation of CSMF and its uncertainty & No & No & No & Yes\\
\bottomrule
\end{tabular}
\caption{Comparison the features of the four VA methods implemented in the \CRANpkg{openVA} package.}
\label{tab:compare}
\end{table}
 -->
<h1 data-number="3" id="data-preparation"><span class="header-section-number">3</span> Data preparation</h1>
<p>In the <a href="https://cran.r-project.org/package=openVA">openVA</a> package, we consider two main types of standardized questionnaire: the WHO instrument and the IHME questionnaire. In this section, we focus on describing these two data formats and tools to clean and convert data. Pre-processing the raw data collected from the survey instrument (usually with Open Data Toolkit) is usually performed with additional packages and software outside of the analysis pipeline in R. We briefly mention software for data pre-processing towards the end of this paper.</p>
<h2 class="unnumbered" id="the-who-standard-format">The WHO standard format</h2>
<p>For users familiar with InterVA software and the associated data processing steps, the standard input format from the WHO 2012 and 2016 instruments is usually well understood. For the 2012 instrument, the data expected by the InterVA-4 software are organized into a data frame where each row represents one death and the corresponding VA information is contained in <span class="math inline">\(246\)</span> fields, starting from the first item being the ID of the death. The <span class="math inline">\(245\)</span> items following the ID each represent one binary variable of symptom/indicator, where ‘presence’ is coded by ‘Y’, and ‘absence’ is coded by an empty cell.</p>
<p>To accommodate updates for the WHO 2016 instrument <span class="citation" data-cites="dambruoso2017">(<a href="#ref-dambruoso2017" role="doc-biblioref">D’Ambruoso et al. 2017</a>)</span>, the InterVA-5 software accepts a data frame with <span class="math inline">\(354\)</span> columns that include <span class="math inline">\(353\)</span> columns of symptom/indicators followed by an additional column for the record ID. It should be noted that the R package <a href="https://cran.r-project.org/package=InterVA5">InterVA5</a> retains the format with the record ID residing in the first column. Another important update with InterVA-5 is that it acknowledges the difference between “Yes” and “No” (or “Y/y” and “N/n”, which is different from the coding scheme in InterVA-4), both of which are processed as relevant responses, while all other responses are treated as missing values and ignored. With respect to the list of causes of death, InterVA-5 utilizes the WHO 2016 COD categories, which is nearly identical to the WHO 2012 COD categories (used by InterVA-4) except that hemorrhagic fever and dengue fever are two separate categories in the 2016 COD categories.</p>
<p>The same input format is inherited by the <a href="https://cran.r-project.org/package=openVA">openVA</a> package, except for one modification. We further distinguish ‘missing’ and ‘absence’ in the input data frame explicitly. We highly recommend that users pre-process all the raw data so that a ‘missing’ value in the data spreadsheet is coded as a ‘.’ (following the Stata practice familiar to many VA practitioners), and an ‘absence’ value is indicated by an empty cell, as in the standard InterVA-4 software. For WHO 2016 data, both ‘.’ and ‘-’ (following the default coding scheme of InterVA-5 software) are interpreted as missing values. For methods other than InSilicoVA, ‘missing’ and ‘absence’ will be considered the same internally and thus will not introduce a compatibility problem.</p>
<h2 class="unnumbered" id="the-phmrc-format">The PHMRC format</h2>
<p>The Population Health Metrics Research Consortium (PHMRC) gold standard VA data <span class="citation" data-cites="murray2011population">(<a href="#ref-murray2011population" role="doc-biblioref">Murray et al. 2011</a>)</span> consist of three datasets corresponding to adult, child, and neonatal deaths, respectively. All deaths occurred in health facilities and gold-standard causes are determined based on laboratory, pathology and medical imaging findings.
These datasets can be downloaded directly using the link returned by the function <code>getPHMRC_url()</code>. For example, we can read the adult VA dataset using the following command.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PHMRC_adult</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/openVA/man/getPHMRC_url.html'>getPHMRC_url</a></span><span class='op'>(</span><span class='st'>"adult"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Although the data are publicly accessible, a major practical challenge for studies involving the PHMRC gold standard dataset is that the pre-processing steps described from the relevant publications are not clear enough nor easy to implement. The <a href="https://cran.r-project.org/package=openVA">openVA</a> package internally cleans up the PHMRC gold standard data when calling the <code>codeVA()</code> function on the PHMRC data. The procedure follows the steps described in the supplement material of <span class="citation" data-cites="insilico">McCormick et al. (<a href="#ref-insilico" role="doc-biblioref">2016</a>)</span>. Notice that the original PHMRC data are useful for comparing and validating new methods, as well as for using as training data, but the cleaning functions only require that the columns are exactly the same as the PHMRC gold standard datasets, so they could also be used for new data that are pre-processed into the same format.</p>
<h2 class="unnumbered" id="customized-format">Customized format</h2>
<p>In addition to the two standard questionnaires discussed previously, researchers might also be interested in including customized dichotomous symptoms in their analysis. The <a href="https://cran.r-project.org/package=openVA">openVA</a> package also supports customized inputs as long as they are dichotomous. In such case, neither the built-in conditional probability matrix of InterVA nor the PHMRC gold standard dataset could be used to learn the relationship between training and testing data, thus different training data with known causes of death are necessary for all three algorithms. The <code>ConvertData()</code> function can be used to convert data with customized coding schemes into the format recognized by the <a href="https://cran.r-project.org/package=openVA">openVA</a> package.</p>
<p>Finally, we note that the <a href="https://cran.r-project.org/package=openVA">openVA</a> package currently does not reformat data from one standardized questionnaire to another. This is because mapping the symptoms collected from one questionnaire to those collected by another questionnaire inevitably creates loss of information. Such mapping tasks can be useful for some applications. For example, a full mapping of a PHMRC dataset into the WHO format enables the use of physician provided conditional probabilities included in the InterVA software on data collected by PHMRC questionnaires. This remains as an important feature to be added to the package in the future.</p>
<h1 data-number="4" id="fitting-va-cause-of-death-assignment-models"><span class="header-section-number">4</span> Fitting VA cause-of-death assignment models</h1>
<p>In this section, we demonstrate the model fitting process in the <a href="https://cran.r-project.org/package=openVA">openVA</a> package using two datasets: (1) a random sample of <span class="math inline">\(1,000\)</span> deaths from the ALPHA network without cause-of-death labels collected with the WHO 2012 instrument, and (2) the adult VA records in the PHMRC gold standard data, with the <span class="math inline">\(1,554\)</span> records from Andhra Pradesh, India used as a testing set and the rest used as a training dataset. In the first case without gold standard training data, only InterVA and InSilicoVA can be fitted. All four methods can be fitted in the second case.</p>
<h2 class="unnumbered" id="modeling-data-collected-with-who-2012-questionnaire">Modeling data collected with WHO 2012 questionnaire</h2>
<p>The randomly sampled VA records from the ALPHA network sites are already included in the openVA package as a dataset <code>RandomVA1</code> and can be loaded directly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>RandomVA1</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>RandomVA1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 1000  246</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>RandomVA1</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>  ID elder midage adult child under5 infant neonate male female
1 d1     Y                                             Y       
2 d2     Y                                                    Y
3 d3            Y                                      Y       
4 d4                  Y                                       Y
5 d5                  Y                                Y       
6 d6                  Y                                       Y</code></pre>
</div>
<p>The <code>codeVA()</code> function provides a standardized syntax to fit different VA models. Internally, the <code>codeVA()</code> function organizes the input data according to the specified data type, checks for incompatibility of the data and specified model, and calls the corresponding model fitting functions. It returns a classed object of the specified model class. In this example, we use version 4.03 of the InterVA software, which is the latest release of the original software compatible with the WHO 2012 instrument. Any additional model-specific parameters can be passed through the arguments of <code>codeVA()</code>. Here we specify the HIV and malaria prevalence levels required by the InterVA model to be ‘high’. Guidelines on how to set these parameters can be found in <span class="citation" data-cites="byass2012strengthening">Byass et al. (<a href="#ref-byass2012strengthening" role="doc-biblioref">2012</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_inter_who</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/openVA/man/codeVA.html'>codeVA</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>RandomVA1</span>, data.type <span class='op'>=</span> <span class='st'>"WHO2012"</span>, </span>
<span>                        model <span class='op'>=</span> <span class='st'>"InterVA"</span>, version <span class='op'>=</span> <span class='st'>"4.03"</span>, </span>
<span>                        HIV <span class='op'>=</span> <span class='st'>"h"</span>, Malaria <span class='op'>=</span> <span class='st'>"h"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit_inter_who</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code>InterVA-4 fitted on 1000 deaths
CSMF calculated using reported causes by InterVA-4 only
The remaining probabilities are assigned to &#39;Undetermined&#39;

Top 5 CSMFs:
 cause                     likelihood
 Undetermined              0.154     
 HIV/AIDS related death    0.122     
 Stroke                    0.072     
 Reproductive neoplasms MF 0.058     
 Pulmonary tuberculosis    0.055     </code></pre>
</div>
<p>We can implement InSilicoVA method with similar syntax. We use the default parameters and run the MCMC for <span class="math inline">\(10,000\)</span> iterations. Setting the <code>auto.length</code> argument to FALSE specifies that the algorithm does not automatically increase the length of the chain when convergence failed. In practice, we recommend setting this argument to TRUE if the algorithm displays warnings concerning MCMC convergence. The InSilicoVA algorithm is implemented using a Metropolis-Hastings within Gibbs sampler. The acceptance rate is printed as part of the message as the model samples from the posterior distribution.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_ins_who</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/openVA/man/codeVA.html'>codeVA</a></span><span class='op'>(</span><span class='va'>RandomVA1</span>, data.type <span class='op'>=</span> <span class='st'>"WHO2012"</span>, model <span class='op'>=</span> <span class='st'>"InSilicoVA"</span>,</span>
<span>                    Nsim <span class='op'>=</span> <span class='fl'>10000</span>, auto.length <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit_ins_who</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code>InSilicoVA Call: 
1000 death processed
10000 iterations performed, with first 5000 iterations discarded
 250 iterations saved after thinning
Fitted with re-estimated conditional probability level table
Data consistency check performed as in InterVA4

Top 10 CSMFs:
                                   Mean Std.Error Lower Median Upper
Other and unspecified infect dis  0.266    0.0168 0.235  0.265 0.301
HIV/AIDS related death            0.102    0.0091 0.085  0.102 0.119
Renal failure                     0.101    0.0108 0.084  0.101 0.123
Other and unspecified neoplasms   0.062    0.0089 0.046  0.061 0.080
Other and unspecified cardiac dis 0.058    0.0076 0.044  0.058 0.075
Digestive neoplasms               0.050    0.0077 0.033  0.050 0.065
Acute resp infect incl pneumonia  0.048    0.0073 0.034  0.049 0.063
Pulmonary tuberculosis            0.039    0.0068 0.025  0.039 0.054
Stroke                            0.038    0.0061 0.027  0.038 0.052
Other and unspecified NCD         0.034    0.0089 0.018  0.034 0.052</code></pre>
</div>
<h2 class="unnumbered" id="modeling-the-phmrc-data">Modeling the PHMRC data</h2>
<p>In the second example, we consider a prediction task using the PHMRC adult dataset. We first load the complete PHMRC adult dataset from its on-line repository, and organize it into training and test datasets. We treat all deaths from Andhra Pradesh, India as the test dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PHMRC_adult</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/openVA/man/getPHMRC_url.html'>getPHMRC_url</a></span><span class='op'>(</span><span class='st'>"adult"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>is.test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>PHMRC_adult</span><span class='op'>$</span><span class='va'>site</span> <span class='op'>==</span> <span class='st'>"AP"</span><span class='op'>)</span></span>
<span><span class='va'>test</span> <span class='op'>&lt;-</span> <span class='va'>PHMRC_adult</span><span class='op'>[</span><span class='va'>is.test</span>, <span class='op'>]</span></span>
<span><span class='va'>train</span> <span class='op'>&lt;-</span> <span class='va'>PHMRC_adult</span><span class='op'>[</span><span class='op'>-</span><span class='va'>is.test</span>, <span class='op'>]</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 1554  946</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>train</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 6287  946</code></pre>
</div>
<p>In order to fit the models on the PHMRC data, we specify <code>data.type = "PHMRC"</code> and <code>phmrc.type = "adult"</code> to indicate the data input is collected using the PHMRC adult questionnaire. We also specify the column of the causes-of-death label in the training data. The rest of the syntax is similar to the previous example.</p>
<p>When the input consists of both training and testing data, the InterVA and InSilicoVA algorithms estimate the conditional probabilities of symptoms using the training data, instead of using the built-in values. In such case, the <code>version</code> argument for the InterVA algorithm is suppressed. There are several ways to map the conditional probabilities of symptoms given causes in the training dataset to a letter grade system, specified by the <code>convert.type</code> argument. The <code>convert.type = "quantile"</code> performs the mapping so that the percentile of each rank stays the same as the original <span class="math inline">\(P_{s|c}\)</span> matrix in InterVA software. Alternatively we can also use the original fixed values of translation, and assign letter grades closest to each entry in <span class="math inline">\(\hat{P}_{s|c}\)</span>. This conversion is specified by <code>convert.type = "fixed"</code>, and is more closely aligned to the original InterVA and InSilicoVA setting. Finally, we can also directly use the values in the <span class="math inline">\(\hat{P}_{s|c}\)</span> without converting them to ranks and re-estimating the values associated with each rank. This can be specified by <code>convert.type = "empirical"</code>. In this demonstration, we assume the fixed value conversion.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_inter</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/openVA/man/codeVA.html'>codeVA</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>test</span>, data.type <span class='op'>=</span> <span class='st'>"PHMRC"</span>, model <span class='op'>=</span> <span class='st'>"InterVA"</span>, </span>
<span>                     data.train <span class='op'>=</span> <span class='va'>train</span>, causes.train <span class='op'>=</span> <span class='st'>"gs_text34"</span>, </span>
<span>                     phmrc.type <span class='op'>=</span> <span class='st'>"adult"</span>, convert.type <span class='op'>=</span> <span class='st'>"fixed"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_ins</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/openVA/man/codeVA.html'>codeVA</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>test</span>, data.type <span class='op'>=</span> <span class='st'>"PHMRC"</span>, model <span class='op'>=</span> <span class='st'>"InSilicoVA"</span>,</span>
<span>                    data.train <span class='op'>=</span> <span class='va'>train</span>, causes.train <span class='op'>=</span> <span class='st'>"gs_text34"</span>, </span>
<span>                    phmrc.type <span class='op'>=</span> <span class='st'>"adult"</span>, convert.type <span class='op'>=</span> <span class='st'>"fixed"</span>, </span>
<span>                    Nsim<span class='op'>=</span><span class='fl'>10000</span>, auto.length <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The NBC and Tariff method can be fit using similar syntax.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_nbc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/openVA/man/codeVA.html'>codeVA</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>test</span>, data.type <span class='op'>=</span> <span class='st'>"PHMRC"</span>, model <span class='op'>=</span> <span class='st'>"NBC"</span>, </span>
<span>                   data.train <span class='op'>=</span> <span class='va'>train</span>, causes.train <span class='op'>=</span> <span class='st'>"gs_text34"</span>, </span>
<span>                   phmrc.type <span class='op'>=</span> <span class='st'>"adult"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_tariff</span> <span class='op'>&lt;-</span> <span class='fu'>codeVA</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>test</span>, data.type <span class='op'>=</span> <span class='st'>"PHMRC"</span>, model <span class='op'>=</span> <span class='st'>"Tariff"</span>,</span>
<span>                     data.train <span class='op'>=</span> <span class='va'>train</span>, causes.train <span class='op'>=</span> <span class='st'>"gs_text34"</span>, </span>
<span>                     phmrc.type <span class='op'>=</span> <span class='st'>"adult"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Notice that we do not need to transform the PHMRC data manually. Data transformations are performed automatically within the <code>codeVA()</code> function.</p>
<h1 data-number="5" id="summarizing-results"><span class="header-section-number">5</span> Summarizing results</h1>
<p>In this section we demonstrate how to summarize results, extract output, and visualize and compare fitted results. All the fitted object returned by <code>codeVA()</code> are S3 objects, for which a readable summary of model results can be obtained with the <code>summary()</code> function as shown in the previous section. In addition, several other metrics are commonly used to evaluate and compare VA algorithms at either the population or individual levels. In the rest of this section, we show how to easily calculate and visualize some of these metrics with the <a href="https://cran.r-project.org/package=openVA">openVA</a> package.</p>
<h2 class="unnumbered" id="csmf-accuracy">CSMF accuracy</h2>
<p>We can extract the CSMFs directly using the <code>getCSMF()</code> function. The function returns a vector of the point estimates of the CSMFs, or a matrix of posterior summaries of the CSMF for the InSilicoVA algorithm.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>csmf_inter</span> <span class='op'>&lt;-</span> <span class='fu'>getCSMF</span><span class='op'>(</span><span class='va'>fit_inter</span><span class='op'>)</span></span>
<span><span class='va'>csmf_ins</span> <span class='op'>&lt;-</span> <span class='fu'>getCSMF</span><span class='op'>(</span><span class='va'>fit_ins</span><span class='op'>)</span></span>
<span><span class='va'>csmf_nbc</span> <span class='op'>&lt;-</span> <span class='fu'>getCSMF</span><span class='op'>(</span><span class='va'>fit_nbc</span><span class='op'>)</span></span>
<span><span class='va'>csmf_tariff</span> <span class='op'>&lt;-</span> <span class='fu'>getCSMF</span><span class='op'>(</span><span class='va'>fit_tariff</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>One commonly used metric to evaluate the CSMF estimates is the so-called CSMF accuracy, defined as
<span class="math display">\[
CSMF_{acc} = 1 - \frac{\sum_j^C CSMF_i - CSMF_j^{(true)}}{2(1 - \min CSMF^{(true)})}
\]</span>
The CSMF accuracy can be readily computed using functions in <a href="https://cran.r-project.org/package=openVA">openVA</a> as the codes below shows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>csmf_true</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>gs_text34</span>, <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>PHMRC_adult</span><span class='op'>$</span><span class='va'>gs_text34</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span></span>
<span><span class='va'>csmf_true</span> <span class='op'>&lt;-</span> <span class='va'>csmf_true</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>csmf_true</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>getCSMF_accuracy</span><span class='op'>(</span><span class='va'>csmf_inter</span>, <span class='va'>csmf_true</span>, undet <span class='op'>=</span> <span class='st'>"Undetermined"</span><span class='op'>)</span>, </span>
<span>  <span class='fu'>getCSMF_accuracy</span><span class='op'>(</span><span class='va'>csmf_ins</span><span class='op'>[</span>, <span class='st'>"Mean"</span><span class='op'>]</span>, <span class='va'>csmf_true</span><span class='op'>)</span>, </span>
<span>  <span class='fu'>getCSMF_accuracy</span><span class='op'>(</span><span class='va'>csmf_nbc</span>, <span class='va'>csmf_true</span><span class='op'>)</span>, </span>
<span>  <span class='fu'>getCSMF_accuracy</span><span class='op'>(</span><span class='va'>csmf_tariff</span>, <span class='va'>csmf_true</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.53 0.74 0.77 0.68</code></pre>
</div>
<p>We use the empirical distribution in the test data to calculate the true CSMF distribution, i.e., <span class="math inline">\(CSMF_j^{(true)} = \frac{1}{n}\sum_{i=1}^n {1}_{y_i = j}\)</span>. Then we evaluate the CSMF accuracy using the <code>getCSMF_accuracy()</code> function. As discussed previously, the default CSMF calculation is slightly different for diCfferent methods. For example, the InterVA algorithm creates the additional category of <code>Undetermined</code> by default, which is not in the true CSMF categories and needs to be specified. The creation of the undetermined category can also be suppressed by <code>interVA.rule = FALSE</code> in the <code>getCSMF()</code> function call. For the InSilicoVA algorithm, we use the posterior mean to calculate the point estimates of the CSMF accuracy.</p>
<h2 class="unnumbered" id="individual-cod-summary">Individual COD summary</h2>
<p>At the individual level, we can extract the most likely cause-of-death assignment from the fitted object using the <code>getTopCOD()</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cod_inter</span> <span class='op'>&lt;-</span> <span class='fu'>getTopCOD</span><span class='op'>(</span><span class='va'>fit_inter</span><span class='op'>)</span></span>
<span><span class='va'>cod_ins</span> <span class='op'>&lt;-</span> <span class='fu'>getTopCOD</span><span class='op'>(</span><span class='va'>fit_ins</span><span class='op'>)</span></span>
<span><span class='va'>cod_nbc</span> <span class='op'>&lt;-</span> <span class='fu'>getTopCOD</span><span class='op'>(</span><span class='va'>fit_nbc</span><span class='op'>)</span></span>
<span><span class='va'>cod_tariff</span> <span class='op'>&lt;-</span> <span class='fu'>getTopCOD</span><span class='op'>(</span><span class='va'>fit_tariff</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>With the most likely COD assignment, other types of metrics based on individual COD assignment accuracy can be similarly constructed by users. The summary methods can also be called for each death ID. For example, using the Tariff method, we can extract the fitted rankings of causes for the death with ID 6288 by</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit_inter</span>, id <span class='op'>=</span> <span class='st'>"6288"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>InterVA-4 fitted top 5 causes for death ID: 6288

 Cause                     Likelihood
 Stroke                    0.509     
 Pneumonia                 0.318     
 COPD                      0.081     
 Other Infectious Diseases 0.064     
 Renal Failure             0.013     </code></pre>
</div>
<p>The <code>summary()</code> function for InSilcoVA does not provide uncertainty estimates for individual COD assignments by default. This is because, in practice, the calculation of individual posterior probabilities of COD distribution can be memory-intensive when the dataset is large. To obtain individual-level uncertainty measurements, we can either run the MCMC chain with the additional argument <code>indiv.CI = 0.95</code> when calling <code>codeVA()</code>, or update the fitted object directly with the saved posterior draws.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_ins</span> <span class='op'>&lt;-</span> <span class='fu'>updateIndiv</span><span class='op'>(</span><span class='va'>fit_ins</span>, CI <span class='op'>=</span> <span class='fl'>0.95</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit_ins</span>, id <span class='op'>=</span> <span class='st'>"6288"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>InSilicoVA fitted top  causes for death ID: 6288
Credible intervals shown: 95%
                              Mean  Lower Median  Upper
Stroke                      0.5043 0.3485 0.5083 0.6361
Pneumonia                   0.4116 0.2615 0.4083 0.5834
Other Infectious Diseases   0.0660 0.0411 0.0642 0.0966
Epilepsy                    0.0099 0.0064 0.0097 0.0142
COPD                        0.0053 0.0031 0.0052 0.0079
Malaria                     0.0007 0.0005 0.0007 0.0011
Diabetes                    0.0005 0.0003 0.0005 0.0009
Acute Myocardial Infarction 0.0004 0.0003 0.0004 0.0006
Falls                       0.0004 0.0001 0.0004 0.0013
Renal Failure               0.0004 0.0002 0.0003 0.0005</code></pre>
</div>
<p>For <span class="math inline">\(N\)</span> deaths, <span class="math inline">\(C\)</span> causes, the posterior mean of individual COD distributions returned by the InSilicoVA model, along with median and with credible intervals can be represented by a <span class="math inline">\((N \times C \times 4)\)</span>-dimensional array. The function <code>getIndivProb()</code> extracts this summary in the form of a list of <span class="math inline">\(4\)</span> matrices of dimension <span class="math inline">\(N\)</span> by <span class="math inline">\(C\)</span>, which can then be saved to other formats to facilitate further analysis. For other methods, the point estimates of individual COD distribution are returned as the <span class="math inline">\(N\)</span> by <span class="math inline">\(C\)</span> matrix.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_prob</span> <span class='op'>&lt;-</span> <span class='fu'>getIndivProb</span><span class='op'>(</span><span class='va'>fit_inter</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>fit_prob</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 1554   34</code></pre>
</div>
<h2 class="unnumbered" id="visualization">Visualization</h2>
<p>The previous sections discuss how results could be extracted and examined in R. In this subsection, we show some visualization tools provided in the <a href="https://cran.r-project.org/package=openVA">openVA</a> package for presenting these results. The fitted CSMFs for the top causes can be easily visualized by the <code>plotVA()</code> function. The default graph components are specific to each algorithm and individual package implementations, with options for further customization. For example, Figure[<a href="#fig:vis-1">1</a>] shows the estimated CSMF from the InterVA algorithm in the PHMRC data example.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>plotVA</span><span class='op'>(</span><span class='va'>fit_inter</span>, title <span class='op'>=</span> <span class='st'>"InterVA"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vis-1"></span>
<img src="openVA-RJ-R1_files/figure-html5/vis-1-1.png" alt="Bar plot of the top CSMFs estimated by InterVA. The five causes of death with the highes estimated mortality fraction predicted by InterVA are plotted. Colors of the bar indicate the corresponding fractions." width="80%"  />
<p class="caption">
Figure 1: Bar plot of the top CSMFs estimated by InterVA. The five causes of death with the highes estimated mortality fraction predicted by InterVA are plotted. Colors of the bar indicate the corresponding fractions.
</p>
</div>
</div>
<p>The CSMFs can also be aggregated for easier visualization of groups of causes. For the InterVA-4 cause list, we included an example grouping built into the package, so the aggregated CSMFs can be compared directly. In practice, the grouping of causes of deaths often needs to be determined according to context and the research question of interest. Changing the grouping can be easily achieved by modifying the <code>grouping</code> argument in the <code>stackplotVA()</code> function. For example, to facilitate the new category of <code>Undetermined</code> returned by InterVA, we first modify the grouping matrix to include it as a new cause and visualize the aggregated CSMF estimates in Figure [<a href="#fig:vis-2">2</a>].</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>SampleCategory</span><span class='op'>)</span></span>
<span><span class='va'>grouping</span> <span class='op'>&lt;-</span> <span class='va'>SampleCategory</span></span>
<span><span class='va'>grouping</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>grouping</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>grouping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>grouping</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Undetermined"</span>, <span class='st'>"Undetermined"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>compare</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>InterVA4 <span class='op'>=</span> <span class='va'>fit_inter_who</span>,</span>
<span>                InSilicoVA <span class='op'>=</span> <span class='va'>fit_ins_who</span><span class='op'>)</span></span>
<span><span class='fu'>stackplotVA</span><span class='op'>(</span><span class='va'>compare</span>, xlab <span class='op'>=</span> <span class='st'>""</span>, angle <span class='op'>=</span> <span class='fl'>0</span>,  grouping <span class='op'>=</span> <span class='va'>grouping</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vis-2"></span>
<img src="openVA-RJ-R1_files/figure-html5/vis-2-1.png" alt="Estimated aggregated CSMFs for InterVA-4 and InSilicoVA, adding undetermined category. The causes of death are aggregated to seven broad categories. Color indicate the category and the height of bar indicate the fraction of deaths due to the cause category. Overall, InterVA-4 and InSilicoVA estimate similar aggregated CSMFs, except in the communicable disease (excluding TA/AIDS) category, InSilicoVA estimates a larger fraction." width=".7\linewidth"  />
<p class="caption">
Figure 2: Estimated aggregated CSMFs for InterVA-4 and InSilicoVA, adding undetermined category. The causes of death are aggregated to seven broad categories. Color indicate the category and the height of bar indicate the fraction of deaths due to the cause category. Overall, InterVA-4 and InSilicoVA estimate similar aggregated CSMFs, except in the communicable disease (excluding TA/AIDS) category, InSilicoVA estimates a larger fraction.
</p>
</div>
</div>
<p>The ordering of the stacked bars can also be changed to reflect the structures within the aggregated causes, as demonstrated in Figure [<a href="#fig:vis-3">3</a>].</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>group_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TB/AIDS"</span>,  <span class='st'>"Communicable"</span>, <span class='st'>"NCD"</span>, <span class='st'>"External"</span>, <span class='st'>"Maternal"</span>,</span>
<span>            <span class='st'>"causes specific to infancy"</span>, <span class='st'>"Undetermined"</span><span class='op'>)</span> </span>
<span><span class='fu'>stackplotVA</span><span class='op'>(</span><span class='va'>compare</span>, xlab <span class='op'>=</span> <span class='st'>""</span>, angle <span class='op'>=</span> <span class='fl'>0</span>, grouping <span class='op'>=</span> <span class='va'>grouping</span>, </span>
<span>            group_order <span class='op'>=</span> <span class='va'>group_order</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vis-3"></span>
<img src="openVA-RJ-R1_files/figure-html5/vis-3-1.png" alt="Estimated aggregated CSMFs for InterVA-4 and InSilicoVA, with the causes reordered. The causes of death are aggregated to seven broad categories. Color indicate the category and the height of bar indicate the fraction of deaths due to the cause category. The order of the bars are arranged according to user input." width=".7\linewidth"  />
<p class="caption">
Figure 3: Estimated aggregated CSMFs for InterVA-4 and InSilicoVA, with the causes reordered. The causes of death are aggregated to seven broad categories. Color indicate the category and the height of bar indicate the fraction of deaths due to the cause category. The order of the bars are arranged according to user input.
</p>
</div>
</div>
<h1 data-number="6" id="incorporating-additional-information"><span class="header-section-number">6</span> Incorporating additional information</h1>
<p>Among the VA methods discussed in this paper, the InSilicoVA algorithm <span class="citation" data-cites="insilico">(<a href="#ref-insilico" role="doc-biblioref">McCormick et al. 2016</a>)</span> allows for more flexible modifications to the Bayesian hierarchical model structure when additional information is available. In this section, we illustrate two features unique to the InSilicoVA method: jointly estimating CSMFs from multiple populations, and incorporating partial and potentially noisy physician coding into the algorithm.</p>
<h2 class="unnumbered" id="sub-population-specific-csmfs">Sub-population specific CSMFs</h2>
<p>In practice researchers may want to estimate and compare CSMFs for different regions, time periods, or demographic groups in the population. Running separate models on subsets of data can be inefficient and does not allow parameter estimation to borrow information across different groups. The generative framework adopted by InSilicoVA allows the specification of sub-populations in analyzing VA data. Consider an input dataset with <span class="math inline">\(G\)</span> different sub-populations. We can estimate different CSMFs <span class="math inline">\(\pi^{(g)}\)</span> for <span class="math inline">\(g = 1, ..., G\)</span> for each sub-population, while assuming the same conditional probability matrix, <span class="math inline">\(P_{s|c}\)</span> and other hyperpriors. As an example, we show how to estimate different CSMFs for sub-populations specified by sex and age groups, using a randomly sampled ALPHA dataset with additional columns specifying the sub-population each death belongs to.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>RandomVA2</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>RandomVA2</span><span class='op'>[</span>, <span class='fl'>244</span><span class='op'>:</span><span class='fl'>248</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>  stradm smobph scosts   sex age
1      .      .      .   Men 60+
2      .      .      . Women 60-
3      .      .      . Women 60-
4      .      .      . Women 60+
5      .      .      . Women 60-
6      .      .      . Women 60-</code></pre>
</div>
<p>Then we can fit the model with one or multiple additional columns specifying sub-population membership for each observation.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_sub</span> <span class='op'>&lt;-</span> <span class='fu'>codeVA</span><span class='op'>(</span><span class='va'>RandomVA2</span>, model <span class='op'>=</span> <span class='st'>"InSilicoVA"</span>, </span>
<span>              subpop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"sex"</span>, <span class='st'>"age"</span><span class='op'>)</span>,  indiv.CI <span class='op'>=</span> <span class='fl'>0.95</span>,</span>
<span>              Nsim <span class='op'>=</span> <span class='fl'>10000</span>, auto.length <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Functions discussed in the previous sections work in the same way for the fitted object with multiple sub-populations. Additional visualization tools are also available. Figure [<a href="#fig:ins3">4</a>] plots the CSMFs for two sub-populations on the same plot by specify <code>type = "compare"</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>plotVA</span><span class='op'>(</span><span class='va'>fit_sub</span>, type <span class='op'>=</span> <span class='st'>"compare"</span>, title <span class='op'>=</span> <span class='st'>"Comparing CSMFs"</span>, top <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ins3"></span>
<img src="openVA-RJ-R1_files/figure-html5/ins3-1.png" alt="Estimated CSMFs for different sub-populations. The points indicate posterior means of the CSMF and the error bars indicate 95\% credible intervals of the CSMF." width="90%"  />
<p class="caption">
Figure 4: Estimated CSMFs for different sub-populations. The points indicate posterior means of the CSMF and the error bars indicate 95% credible intervals of the CSMF.
</p>
</div>
</div>
<p>By default, the comparison plots will select all the CODs that are included in the top causes (specified by the <code>top</code> argument) for each of the sub-populations. We can also plot only subsets of them by specifying the causes of interest, as shown in Figure [<a href="#fig:ins4">5</a>].</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>plotVA</span><span class='op'>(</span><span class='va'>fit_sub</span>, type <span class='op'>=</span> <span class='st'>"compare"</span>, title <span class='op'>=</span> <span class='st'>"Comparing CSMFs"</span>,</span>
<span>                causelist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"HIV/AIDS related death"</span>, </span>
<span>                              <span class='st'>"Pulmonary tuberculosis"</span>, </span>
<span>                              <span class='st'>"Other and unspecified infect dis"</span>, </span>
<span>                              <span class='st'>"Other and unspecified NCD"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ins4"></span>
<img src="openVA-RJ-R1_files/figure-html5/ins4-1.png" alt=" Estimated fraction of deaths due to selected CODs for different sub-populations. The points indicate posterior means of the CSMF and the error bars indicate 95\% credible intervals of the CSMF." width="80%"  />
<p class="caption">
Figure 5:  Estimated fraction of deaths due to selected CODs for different sub-populations. The points indicate posterior means of the CSMF and the error bars indicate 95% credible intervals of the CSMF.
</p>
</div>
</div>
<p>Figure [<a href="#fig:ins5">6</a>] shows the visualization of the top CSMFs for a chosen sub-population using the <code>which.sub</code> argument.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>plotVA</span><span class='op'>(</span><span class='va'>fit_sub</span>, which.sub <span class='op'>=</span> <span class='st'>"Women 60-"</span>, title <span class='op'>=</span> <span class='st'>"Women 60-"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ins5"></span>
<img src="openVA-RJ-R1_files/figure-html5/ins5-1.png" alt="Top 10 CSMFs for a specified sub-population (women under $60$ years old)." width="80%"  />
<p class="caption">
Figure 6: Top 10 CSMFs for a specified sub-population (women under <span class="math inline">\(60\)</span> years old).
</p>
</div>
</div>
<p>Similar to before, the <code>stackplotVA()</code> function can also be used to compare different sub-populations in aggregated cause groups, as shown in Figure [<a href="#fig:ins6">7</a>].</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>stackplotVA</span><span class='op'>(</span><span class='va'>fit_sub</span><span class='op'>)</span></span>
<span><span class='fu'>stackplotVA</span><span class='op'>(</span><span class='va'>fit_sub</span>, type <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ins6"></span>
<img src="openVA-RJ-R1_files/figure-html5/ins6-1.png" alt="Aggregated CSMFs for four different sub-populations. Left: comparison using the stacked bar chart. Right: comparison using the bar chart arranged side to side. The height of the bars indicate posterior means of the CSMF and the error bars indicate 95\% credible intervals of the CSMF. Sub-populations corresponding to 60+ age groups are estimated to have a larger fraction of deaths due to NCD compared to 60- age groups." width="49%"  /><img src="openVA-RJ-R1_files/figure-html5/ins6-2.png" alt="Aggregated CSMFs for four different sub-populations. Left: comparison using the stacked bar chart. Right: comparison using the bar chart arranged side to side. The height of the bars indicate posterior means of the CSMF and the error bars indicate 95\% credible intervals of the CSMF. Sub-populations corresponding to 60+ age groups are estimated to have a larger fraction of deaths due to NCD compared to 60- age groups." width="49%"  />
<p class="caption">
Figure 7: Aggregated CSMFs for four different sub-populations. Left: comparison using the stacked bar chart. Right: comparison using the bar chart arranged side to side. The height of the bars indicate posterior means of the CSMF and the error bars indicate 95% credible intervals of the CSMF. Sub-populations corresponding to 60+ age groups are estimated to have a larger fraction of deaths due to NCD compared to 60- age groups.
</p>
</div>
</div>
<h2 class="unnumbered" id="physician-coding">Physician coding</h2>
<p>When physician-coded causes of death are available for all or a subset of the deaths, we can incorporate such information in the InSilicoVA model. The physician-coded causes can be either the same as the CODs used for the final algorithm, or consist of causes at a higher level of aggregation. When there is more than one physician code for each death and the physician identity is known, we can first de-bias the multiple codes provided from different physicians using the process described in <span class="citation" data-cites="insilico">McCormick et al. (<a href="#ref-insilico" role="doc-biblioref">2016</a>)</span>. For the purpose of implementation, we only need to specify which columns are physician IDs, and which are their coded causes, respectively.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>SampleCategory</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>RandomPhysician</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>RandomPhysician</span><span class='op'>[</span>, <span class='fl'>245</span><span class='op'>:</span><span class='fl'>250</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>  smobph scosts        code1 rev1        code2 rev2
1      .      .          NCD doc9          NCD doc6
2      .      .          NCD doc4          NCD doc3
3      .      .          NCD doc1          NCD doc5
4      .      .      TB/AIDS doc4      TB/AIDS doc7
5      .      .      TB/AIDS doc5      TB/AIDS doc9
6      .      . Communicable doc9 Communicable &lt;NA&gt;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>doctors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"doc"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>causelist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Communicable"</span>, <span class='st'>"TB/AIDS"</span>, <span class='st'>"Maternal"</span>,</span>
<span>              <span class='st'>"NCD"</span>, <span class='st'>"External"</span>, <span class='st'>"Unknown"</span><span class='op'>)</span></span>
<span><span class='va'>phydebias</span> <span class='op'>&lt;-</span> <span class='fu'>physician_debias</span><span class='op'>(</span><span class='va'>RandomPhysician</span>, </span>
<span>          phy.id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rev1"</span>, <span class='st'>"rev2"</span><span class='op'>)</span>, phy.code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"code1"</span>, <span class='st'>"code2"</span><span class='op'>)</span>, </span>
<span>          phylist <span class='op'>=</span> <span class='va'>doctors</span>, causelist <span class='op'>=</span> <span class='va'>causelist</span>, tol <span class='op'>=</span> <span class='fl'>0.0001</span>, max.itr <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The de-biased step essentially creates a prior probability distribution for each death over the broader categories of causes. Then to run InSilicoVA with the de-biased physician coding, we can simply pass the fitted object from the previous step to the model. Additional arguments are needed to specify both the external cause category, since external causes are handled by separate heuristics, and the unknown category, which is equivalent to a uniform probability distribution over all other categories, i.e., the same as the case where no physician coding exists.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_ins_phy</span> <span class='op'>&lt;-</span> <span class='fu'>codeVA</span><span class='op'>(</span><span class='va'>RandomVA1</span>, model <span class='op'>=</span> <span class='st'>"InSilicoVA"</span>,</span>
<span>             phy.debias <span class='op'>=</span> <span class='va'>phydebias</span>, phy.cat <span class='op'>=</span> <span class='va'>SampleCategory</span>, </span>
<span>             phy.external <span class='op'>=</span> <span class='st'>"External"</span>, phy.unknown <span class='op'>=</span> <span class='st'>"Unknown"</span>,</span>
<span>             Nsim <span class='op'>=</span> <span class='fl'>10000</span>, auto.length <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<p>Figure [<a href="#fig:phy3">8</a>] compares the previous results without including physicians codes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>plotVA</span><span class='op'>(</span><span class='va'>fit_ins_who</span>, title <span class='op'>=</span> <span class='st'>"Without physician coding"</span><span class='op'>)</span></span>
<span><span class='fu'>plotVA</span><span class='op'>(</span><span class='va'>fit_ins_phy</span>, title <span class='op'>=</span> <span class='st'>"With physician coding"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:phy3"></span>
<img src="openVA-RJ-R1_files/figure-html5/phy3-1.png" alt="Comparing fitted CSMF with and without physicians. Top: top 10 CSMFs and the 95\% credible intervals estimated by InSilicoVA without using physician coding. Bottom: top 10 CSMFs and the 95\% credible intervals estimated by InSilicoVA taking physician coding into account. More deaths were assigned from 'Other and unspecified infectious disease' to 'HIV/AIDS related death' after accounting for physician coding." width="100%"  /><img src="openVA-RJ-R1_files/figure-html5/phy3-2.png" alt="Comparing fitted CSMF with and without physicians. Top: top 10 CSMFs and the 95\% credible intervals estimated by InSilicoVA without using physician coding. Bottom: top 10 CSMFs and the 95\% credible intervals estimated by InSilicoVA taking physician coding into account. More deaths were assigned from 'Other and unspecified infectious disease' to 'HIV/AIDS related death' after accounting for physician coding." width="100%"  />
<p class="caption">
Figure 8: Comparing fitted CSMF with and without physicians. Top: top 10 CSMFs and the 95% credible intervals estimated by InSilicoVA without using physician coding. Bottom: top 10 CSMFs and the 95% credible intervals estimated by InSilicoVA taking physician coding into account. More deaths were assigned from ‘Other and unspecified infectious disease’ to ‘HIV/AIDS related death’ after accounting for physician coding.
</p>
</div>
</div>
<h2 class="unnumbered" id="removal-of-physically-impossible-causes">Removal of physically impossible causes</h2>
<p>The originally proposed InSilicoVA assumes all causes of death are possible for each observation. The impact from such an assumption is mild when data are abundant, but could be problematic when either the sample size is small or the proportion of missing data is high. In both cases, physically impossible causes might get assigned with non-ignorable posterior mass. Since version 1.1.5 of <a href="https://cran.r-project.org/package=InSilicoVA">InSilicoVA</a>, when the input is in the WHO format, the algorithm automatically checks and removes impossible causes before fitting the model. The <span class="math inline">\(k\)</span>-th cause is defined as physically impossible for the <span class="math inline">\(i\)</span>-th death if <span class="math inline">\(P(s_{ij}=1 | y_{i}=k) = 0\)</span> where <span class="math inline">\(s_{ij}\)</span> is an indicator that the decedent belongs to a particular sex or age group. We then consider a cause to be physically impossible for the underlying population if it is impossible for all the observations in the input data. For example, with the new implementation, CSMF for pregnancy-related causes will not be estimated if the input data consist of only male deaths.</p>
<h1 data-number="7" id="other-related-software-packages"><span class="header-section-number">7</span> Other related software packages</h1>
<p>
Since the release of the <a href="https://cran.r-project.org/package=openVA">openVA</a> package on CRAN, there have been several new developments in both methodology and software that build on the <a href="https://cran.r-project.org/package=openVA">openVA</a> suite of packages and further extend its functionalities. Here we briefly survey some of the related methods, software packages, and ongoing work in the VA community that are related to <a href="https://cran.r-project.org/package=openVA">openVA</a>.</p>
<p>First, the ability to easily fit and compare existing methods using the <a href="https://cran.r-project.org/package=openVA">openVA</a> package facilitated the development of several new VA methods in the last several years. Most of the development focuses on building statistical models to relax the conditional independence assumption of symptoms given a cause of death <span class="citation" data-cites="li2017mix tsuyoshi2017 moran2021bayesian li2021bayesian wu2021double">(e.g., <a href="#ref-li2017mix" role="doc-biblioref">Li et al. 2020</a>; <a href="#ref-tsuyoshi2017" role="doc-biblioref">Kunihama et al. 2020</a>; <a href="#ref-li2021bayesian" role="doc-biblioref">Li et al. 2021</a>; <a href="#ref-moran2021bayesian" role="doc-biblioref">Moran et al. 2021</a>; <a href="#ref-wu2021double" role="doc-biblioref">Wu et al. 2021</a>)</span>. These methods tend to be computationally more demanding compared to the algorithms currently included in the <a href="https://cran.r-project.org/package=openVA">openVA</a> package, but usually provide improved inference. It is future work to include some of these latest developments in the <a href="https://cran.r-project.org/package=openVA">openVA</a> package for routine use. Most of these methods have publicly available implementations, such as the <a href="#">farva</a> package <span class="citation" data-cites="farva">(<a href="#ref-farva" role="doc-biblioref">Moran 2020</a>)</span> on GitHub. In another direction of research, a class of transfer learning methods focuses on building models to correct for bias in existing methods when predicting out of domain. These methods take the predicted cause of death assignments and distributions obtained with the <a href="https://cran.r-project.org/package=openVA">openVA</a> package and learn an ensemble of the predictions calibrated to the target population <span class="citation" data-cites="caliva fiksel2020generalized">(<a href="#ref-caliva" role="doc-biblioref">Datta et al. 2020</a>; <a href="#ref-fiksel2020generalized" role="doc-biblioref">Fiksel et al. 2021</a>)</span>. The <a href="#">calibratedVA</a> package <span class="citation" data-cites="calibratedVA">(<a href="#ref-calibratedVA" role="doc-biblioref">Fiksel and Datta 2018</a>)</span> is available to implement these models.</p>
<p>Outside of research community that develops new VA algorithms, <a href="https://cran.r-project.org/package=openVA">openVA</a> has also been used extensively by governments and health care organizations, particularly in locations that lack a strong vital registration system and use VA data to identify the leading causes of death. To facilitate the work of these users, <a href="https://cran.r-project.org/package=openVA">openVA</a> has been wrapped into a web application, the openVA App <span class="citation" data-cites="openva-app">(<a href="#ref-openva-app" role="doc-biblioref">Thomas 2021</a>)</span>, using the <a href="https://cran.r-project.org/package=shiny">shiny</a> package <span class="citation" data-cites="shinypkg">(<a href="#ref-shinypkg" role="doc-biblioref">Chang et al. 2021</a>)</span>. The open source openVA App is available on GitHub and provides an intuitive interface to <a href="https://cran.r-project.org/package=openVA">openVA</a> that does not require one to learn R, but provides visual and tabular output produced by the different VA algorithms. It also runs the official Tariff algorithm by calling the Python source code of SmartVA-Analyze <span class="citation" data-cites="smartVA-git">(<a href="#ref-smartVA-git" role="doc-biblioref">Institute for Health Metrics and Evaluation 2021a</a>)</span> and processing the output to be consistent with the other algorithms. The <a href="https://cran.r-project.org/package=openVA">openVA</a> R package has also been a key component in a larger data analysis pipeline that pulls VA data from an Open Data Kit (ODK) Collect server and deposits the assigned causes of death to another server running the District Health Information Software 2 (DHIS2), which is a common information management system used in low and middle-income countries. This open-source software is implemented as a Python package, openva-pipeline, and is available on GitHub and the Python Package Index <span class="citation" data-cites="openva-pipe">(<a href="#ref-openva-pipe" role="doc-biblioref">Thomas et al. 2021a</a>)</span>. Finally, the R package <a href="https://cran.r-project.org/package=CrossVA">CrossVA</a> <span class="citation" data-cites="crossvapkg">(<a href="#ref-crossvapkg" role="doc-biblioref">Thomas et al. 2020</a>)</span> and the Python package pyCrossVA <span class="citation" data-cites="pyCrossVA">(<a href="#ref-pyCrossVA" role="doc-biblioref">Choi et al. 2021</a>)</span> provide additional toolkits to convert raw VA data from its original format from the ODK server to the standardized formats discussed before. Both packages are open source and available on GitHub. The pyCrossVA package is also available on the Python Package Index.</p>
<h1 data-number="8" id="conclusion"><span class="header-section-number">8</span> Conclusion</h1>
<p>In this paper, we introduce the <a href="https://cran.r-project.org/package=openVA">openVA</a> package. This is the first open-source software that implements and compares the major VA methods. The <a href="https://cran.r-project.org/package=openVA">openVA</a> package allows researchers to easily access the most recent tools that were previously difficult to work with or unavailable. It also enables the compatibility of multiple data input formats and significantly reduces the tedious work to pre-process different data formats specific to each algorithm. The software framework of the <a href="https://cran.r-project.org/package=openVA">openVA</a> package allows for the integration of new methods developed in the future. The <a href="https://cran.r-project.org/package=openVA">openVA</a> package makes all the steps involved in analyzing VA data – i.e., data processing, model tuning and fitting, summarizing results, and evaluation metrics – transparent and reproducible. This contributes significantly to the public health community using VA.</p>
<p>Finally, we make note of several features that will be helpful for future development. First, many users of the <a href="https://cran.r-project.org/package=openVA">openVA</a> package may not be familiar with the command line tools or do not have access to R on their local machines. A well designed graphical user interface can be very useful in such settings. The work on the shiny web application, openVA app, is a first step towards making the package more accessible. The authors intend to extend it to a better front end hosted on secure centralized servers. Second, although we aim to provide users with all the available methods for assigning causes of death, there is a lack of tools for comparing the accuracy and robustness between algorithms. Thus, much future work is needed to systematically assess, compare, and combine these methods in a better analytic framework. Finally, the development of VA algorithms is still an active area of research and it would be possible to extend the <a href="https://cran.r-project.org/package=openVA">openVA</a> suite to incorporate better VA algorithms and new types of data such as free-text narratives.</p>
<h1 data-number="9" id="acknowledgement"><span class="header-section-number">9</span> Acknowledgement</h1>
<p>This work was supported by grants K01HD078452, R01HD086227, and R21HD095451 from the Eunice Kennedy Shriver National Institute of Child Health and Human Development (NICHD). Funding was also received from the Data for Health Initiative, a joint project of Vital Strategies, the CDC Foundation and Bloomberg Philanthropies, through Vital Strategies. The views expressed are not necessarily those of the initiative.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 class="appendix unnumbered" id="cran-packages-used">CRAN packages used</h2>
<p><a href="https://cran.r-project.org/package=openVA">openVA</a>, <a href="https://cran.r-project.org/package=InterVA4">InterVA4</a>, <a href="https://cran.r-project.org/package=InterVA5">InterVA5</a>, <a href="https://cran.r-project.org/package=InSilicoVA">InSilicoVA</a>, <a href="https://cran.r-project.org/package=Tariff">Tariff</a>, <a href="https://cran.r-project.org/package=nbc4va">nbc4va</a>, <a href="https://cran.r-project.org/package=shiny">shiny</a>, <a href="https://cran.r-project.org/package=CrossVA">CrossVA</a></p>
<h2 class="appendix unnumbered" id="cran-task-views-implied-by-cited-packages">CRAN Task Views implied by cited packages</h2>
<p><a href="https://cran.r-project.org/view=WebTechnologies">WebTechnologies</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-breiman2021postmortem" class="csl-entry" role="doc-biblioentry">
R. F. Breiman, D. M. Blau, P. Mutevedzi, V. Akelo, I. Mandomando, I. U. Ogbuanu, S. O. Sow, L. Madrid, S. El Arifeen, M. Garel, et al. Postmortem investigations and identification of multiple causes of child deaths: An analysis of findings from the <span class="nocase">Child Health and Mortality Prevention Surveillance</span> (<span>CHAMPS</span>) network. <em>PLoS medicine</em>, 18(9): e1003814, 2021.
</div>
<div id="ref-2015interVA" class="csl-entry" role="doc-biblioentry">
P. Byass. <span>InterVA-4 Software [Windows Executable]</span>. <em>www.interva.net</em>, 2015.
</div>
<div id="ref-byass2012strengthening" class="csl-entry" role="doc-biblioentry">
P. Byass, D. Chandramohan, S. J. Clark, L. D’Ambruoso, E. Fottrell, W. J. Graham, A. J. Herbst, A. Hodgson, S. Hounton, K. Kahn, et al. Strengthening standardised interpretation of verbal autopsy data: The new <span>InterVA-4</span> tool. <em>Global Health Action</em>, 5: 2012.
</div>
<div id="ref-byass2019integrated" class="csl-entry" role="doc-biblioentry">
P. Byass, L. Hussain-Alkhateeb, L. D’Ambruoso, S. Clark, J. Davies, E. Fottrell, J. Bird, C. Kabudula, S. Tollman, K. Kahn, et al. An integrated approach to processing <span>WHO-2016</span> verbal autopsy data: The InterVA-5 model. <em>BMC Medicine</em>, 17(1): 1–12, 2019.
</div>
<div id="ref-Chandramohan2021Estimating" class="csl-entry" role="doc-biblioentry">
D. Chandramohan, E. Fottrell, J. Leitao, E. Nichols, S. J. Clark, C. Alsokhn, D. C. Munoz, C. AbouZahr, A. D. Pasquale, R. Mswia, et al. Estimating causes of death where there is no medical certification: Evolution and state of the art of verbal autopsy. <em>Global Health Action</em>, 14(sup1): 1982486, 2021. URL<a href=" 
        https://doi.org/10.1080/16549716.2021.1982486
    
">
https://doi.org/10.1080/16549716.2021.1982486
</a>. PMID: 35377290.
</div>
<div id="ref-shinypkg" class="csl-entry" role="doc-biblioentry">
W. Chang, J. Cheng, J. Allaire, C. Sievert, B. Schloerke, Y. Xie, J. Allen, J. McPherson, A. Dipert and B. Borges. <em>Shiny: Web application framework for r.</em> 2021. URL <a href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</a>. R package version 1.7.1.
</div>
<div id="ref-pyCrossVA" class="csl-entry" role="doc-biblioentry">
E. Choi, J. Thomas and E. Karpinski. Prepare data from WHO and PHRMC instruments for verbal autopsy algorithms. 2021.
</div>
<div id="ref-dambruoso2017" class="csl-entry" role="doc-biblioentry">
L. D’Ambruoso, T. Boerma, P. Byass, E. Fottrell, K. Herbst, K. Kallander and Z. Mullan. <span class="nocase">The case for verbal autopsy in health systems strengthening</span>. <em>LANCET GLOBAL HEALTH</em>, <span>5</span>(<span>1</span>): E20–E21, 2017.
</div>
<div id="ref-caliva" class="csl-entry" role="doc-biblioentry">
A. Datta, J. Fiksel, A. Amouzou and S. L. Zeger. Regularized bayesian transfer learning for population-level etiological distributions. <em>Biostatistics</em>, ISSN 1465–4644, 2020.
</div>
<div id="ref-calibratedVA" class="csl-entry" role="doc-biblioentry">
J. Fiksel and A. Datta. <em>calibratedVA: Locally calibrated cause specific mortality fractions using verbal autopsy data.</em> 2018. URL <a href="https://github.com/jfiksel/CalibratedVA">https://github.com/jfiksel/CalibratedVA</a>.
</div>
<div id="ref-fiksel2020generalized" class="csl-entry" role="doc-biblioentry">
J. Fiksel, A. Datta, A. Amouzou and S. Zeger. Generalized <span>Bayesian</span> quantification learning. <em>Journal of the American Statistical Association</em>, 1–19, 2021.
</div>
<div id="ref-flaxman2011random" class="csl-entry" role="doc-biblioentry">
A. D. Flaxman, A. Vahdatpour, S. Green, S. L. James and C. J. Murray. Random forests for verbal autopsy analysis: Multisite validation study using clinical diagnostic gold standards. <em>Population health metrics</em>, 9(1): 1–11, 2011.
</div>
<div id="ref-garenne2014prospects-BMC" class="csl-entry" role="doc-biblioentry">
M. Garenne. Prospects for automated diagnosis of verbal autopsies. <em>BMC Medicine</em>, 12(1): 18, 2014.
</div>
<div id="ref-smartVA-git" class="csl-entry" role="doc-biblioentry">
Institute for Health Metrics and Evaluation. <span>SmartVA-Analyze</span> desktop application. 2021a.
</div>
<div id="ref-smartVA-web" class="csl-entry" role="doc-biblioentry">
Institute for Health Metrics and Evaluation. Verbal autopsy tools. 2021b.
</div>
<div id="ref-james" class="csl-entry" role="doc-biblioentry">
S. L. James, A. D. Flaxman, C. J. Murray and Consortium Population Health Metrics Research. Performance of the tariff method: Validation of a simple additive algorithm for analysis of verbal autopsies. <em>Population Health Metrics</em>, 9(31): 2011.
</div>
<div id="ref-jeblee2019automatically" class="csl-entry" role="doc-biblioentry">
S. Jeblee, M. Gomes, P. Jha, F. Rudzicz and G. Hirst. Automatically determining cause of death from verbal autopsy narratives. <em>BMC medical informatics and decision making</em>, 19(1): 1–13, 2019.
</div>
<div id="ref-kahn2012profile" class="csl-entry" role="doc-biblioentry">
K. Kahn, M. A. Collinson, F. X. Gómez-Olivé, O. Mokoena, R. Twine, P. Mee, S. A. Afolabi, B. D. Clark, C. W. Kabudula, A. Khosa, et al. Profile: <span>Agincourt</span> health and socio-demographic surveillance system. <em>International Journal of Epidemiology</em>, 41(4): 988–1001, 2012.
</div>
<div id="ref-tsuyoshi2017" class="csl-entry" role="doc-biblioentry">
T. Kunihama, Z. R. Li, S. J. Clark and T. H. McCormick. <span>Bayesian</span> factor models for probabilistic cause of death assessment with verbal autopsies. <em>The Annals of Applied Statistics</em>, 14(1): 241–256, 2020.
</div>
<div id="ref-insilicovapkg" class="csl-entry" role="doc-biblioentry">
Z. R. Li, T. H. McCormick and S. J. Clark. <em>: Probabilistic verbal autopsy coding with ’InSilicoVA’ algorithm.</em> 2022a. URL <a href="https://CRAN.R-project.org/package=InSilicoVA">https://CRAN.R-project.org/package=InSilicoVA</a>. R package version 1.4.0.
</div>
<div id="ref-tariffpkg" class="csl-entry" role="doc-biblioentry">
Z. R. Li, T. H. McCormick and S. J. Clark. <em>: Replicate tariff method for verbal autopsy.</em> 2018. URL <a href="https://CRAN.R-project.org/package=Tariff">https://CRAN.R-project.org/package=Tariff</a>. R package version 1.0.5.
</div>
<div id="ref-li2014interva4" class="csl-entry" role="doc-biblioentry">
Z. R. Li, T. H. McCormick and S. J. Clark. InterVA4: An <span>R</span> package to analyze verbal autopsy data. <em>Center for Statistics and the Social Sciences Working Paper, No.146</em>, 2014.
</div>
<div id="ref-li2017mix" class="csl-entry" role="doc-biblioentry">
Z. R. Li, T. H. McCormick and S. J. Clark. Using <span>Bayesian</span> latent <span>Gaussian</span> graphical models to infer symptom associations in verbal autopsies. <em>Bayesian Analysis</em>, 15(3): 781, 2020.
</div>
<div id="ref-interVA4" class="csl-entry" role="doc-biblioentry">
Z. R. Li, T. H. McCormick, S. J. Clark and P. Byass. <em>: Replicate and analyse ’InterVA4’.</em> 2019. URL <a href="https://CRAN.R-project.org/package=InterVA4">https://CRAN.R-project.org/package=InterVA4</a>. R package version 1.7.6.
</div>
<div id="ref-openvapkg" class="csl-entry" role="doc-biblioentry">
Z. R. Li, J. Thomas, T. McCormick and S. Clark. <em>: Automated method for verbal autopsy.</em> 2022b. URL <a href="https://CRAN.R-project.org/package=openVA">https://CRAN.R-project.org/package=openVA</a>. R package version 1.1.0.
</div>
<div id="ref-li2021bayesian" class="csl-entry" role="doc-biblioentry">
Z. R. Li, Z. Wu, I. Chen and S. J. Clark. <span>B</span>ayesian nested latent class models for cause-of-death assignment using verbal autopsies across multiple domains. <em>arXiv preprint arXiv:2112.12186</em>, 2021.
</div>
<div id="ref-maher2010translating" class="csl-entry" role="doc-biblioentry">
D. Maher, S. Biraro, V. Hosegood, R. Isingo, T. Lutalo, P. Mushati, B. Ngwira, M. Nyirenda, J. Todd and B. Zaba. Translating global health research aims into action: The example of the ALPHA network. <em>Tropical Medicine &amp; International Health</em>, 15(3): 321–328, 2010.
</div>
<div id="ref-insilico" class="csl-entry" role="doc-biblioentry">
T. H. McCormick, Z. R. Li, C. Calvert, A. C. Crampin, K. Kahn and S. J. Clark. Probabilistic cause-of-death assignment using verbal autopsies. <em>Journal of the American Statistical Association</em>, 111(515): 1036–1049, 2016.
</div>
<div id="ref-miasnikof2015naive" class="csl-entry" role="doc-biblioentry">
P. Miasnikof, V. Giannakeas, M. Gomes, L. Aleksandrowicz, A. Y. Shestopaloff, D. Alam, S. Tollman, A. Samarikhalaj and P. Jha. Naive bayes classifiers for verbal autopsies: Comparison to physician-based classification for 21,000 child and adult deaths. <em>BMC Medicine</em>, 13(1): 1, 2015.
</div>
<div id="ref-farva" class="csl-entry" role="doc-biblioentry">
K. R. Moran. FActor regression for verbal autopsy. <em>GitHub repository</em>, 2020.
</div>
<div id="ref-moran2021bayesian" class="csl-entry" role="doc-biblioentry">
K. R. Moran, E. L. Turner, D. Dunson and A. H. Herring. Bayesian hierarchical factor regression models to infer cause of death from verbal autopsy data. <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, 2021.
</div>
<div id="ref-murray2011population" class="csl-entry" role="doc-biblioentry">
C. J. Murray, A. D. Lopez, R. Black, R. Ahuja, S. M. Ali, A. Baqui, L. Dandona, E. Dantzer, V. Das, U. Dhingra, et al. <span>Population Health Metrics Research Consortium</span> gold standard verbal autopsy validation study: Design, implementation, and development of analysis datasets. <em>Population Health Metrics</em>, 9(1): 27, 2011.
</div>
<div id="ref-murray2014using" class="csl-entry" role="doc-biblioentry">
C. J. Murray, R. Lozano, A. D. Flaxman, P. Serina, D. Phillips, A. Stewart, S. L. James, A. Vahdatpour, C. Atkinson, M. K. Freeman, et al. Using verbal autopsy to measure causes of death: The comparative performance of existing methods. <em>BMC medicine</em>, 12(1): 1–19, 2014.
</div>
<div id="ref-nkengasong2020improving" class="csl-entry" role="doc-biblioentry">
J. Nkengasong, E. Gudo, I. Macicame, X. Maunze, A. Amouzou, K. Banke, S. Dowell and I. Jani. Improving birth and death data for <span>African</span> decision making. <em>The Lancet Global Health</em>, 8(1): e35–e36, 2020.
</div>
<div id="ref-Sankoh2012" class="csl-entry" role="doc-biblioentry">
O. Sankoh and P. Byass. The <span>INDEPTH</span> network: Filling vital gaps in global epidemiology. <em>International Journal of Epidemiology</em>, 41(3): 2012.
</div>
<div id="ref-serina2015improving" class="csl-entry" role="doc-biblioentry">
P. Serina, I. Riley, A. Stewart, S. L. James, A. D. Flaxman, R. Lozano, B. Hernandez, M. D. Mooney, R. Luning, R. Black, et al. Improving performance of the tariff method for assigning causes of death to verbal autopsies. <em>BMC Medicine</em>, 13(1): 1, 2015.
</div>
<div id="ref-taylor1983child" class="csl-entry" role="doc-biblioentry">
C. E. Taylor, R. Parker, W. Reinke and R. Faruquee. <em>Child and maternal health services in rural india. The narangwal experiment. 2. Integrated family planning and health care.</em> Johns Hopkins University Press, 1983.
</div>
<div id="ref-openva-app" class="csl-entry" role="doc-biblioentry">
J. Thomas. Software for automating the processing of verbal autopsy data. 2021.
</div>
<div id="ref-crossvapkg" class="csl-entry" role="doc-biblioentry">
J. Thomas, E. Choi, Z. Li, N. Maire, T. McCormick, P. Byass and S. Clark. <em>: Verbal autopsy data transformation for <span>InSilicoVA</span> and <span>InterVA5</span> algorithms.</em> 2020. URL <a href="https://CRAN.R-project.org/package=CrossVA">https://CRAN.R-project.org/package=CrossVA</a>. R package version 1.0.0.
</div>
<div id="ref-openva-pipe" class="csl-entry" role="doc-biblioentry">
J. Thomas, S. J. Clark and M. W. Bratschi. Software for automating the processing of verbal autopsy data. 2021a.
</div>
<div id="ref-interVA5" class="csl-entry" role="doc-biblioentry">
J. Thomas, Z. Li, P. Byass, T. McCormick, M. Boyas and S. Clark. <em><span>InterVA5</span>: Replicate and analyse <span>’InterVA5’</span>.</em> 2021b. URL <a href="https://CRAN.R-project.org/package=InterVA5">https://CRAN.R-project.org/package=InterVA5</a>. R package version 1.1.3.
</div>
<div id="ref-nbcpkg" class="csl-entry" role="doc-biblioentry">
R. Wen, P. Miasnikof, V. Giannakeas and M. Gomes. <em>: Bayes classifier for verbal autopsy data.</em> 2022. URL <a href="https://CRAN.R-project.org/package=nbc4va">https://CRAN.R-project.org/package=nbc4va</a>. R package version 1.2.
</div>
<div id="ref-world2012verbal" class="csl-entry" role="doc-biblioentry">
World Health Organization. Verbal autopsy standards: The 2012 WHO verbal autopsy instrument release candidate 1. Geneva: World Health Organization (WHO). 2012.
</div>
<div id="ref-wu2021double" class="csl-entry" role="doc-biblioentry">
Z. Wu, Z. R. Li, I. Chen and M. Li. Tree-informed <span>B</span>ayesian multi-source domain adaptation: Cross-population probabilistic cause-of-death assignment using verbal autopsy. <em>arXiv preprint arXiv:2112.10978</em>, 2021.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Li, et al., "The R Journal: The openVA Toolkit for Verbal Autopsies", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{openVA-RJ-R1,
  author = {Li, Zehang Richard and Thomas, Jason and Choi, Eungang and McCormick, Tyler H. and Clark, Samuel J},
  title = {The R Journal: The openVA Toolkit for Verbal Autopsies},
  journal = {The R Journal},
  year = {2023},
  note = {https://journal.r-project.org/articles/RJ-2023-020/},
  issn = {2073-4859},
  pages = {1}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
