<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely</title>

<meta property="description" itemprop="description" content="This paper proposes a spatiotemporal clustering algorithm and its implementation in the R package spotoroo. This work is motivated by the catastrophic bushfires in Australia throughout the summer of 2019-2020 and made possible by the availability of satellite hotspot data. The algorithm is inspired by two existing spatiotemporal clustering algorithms but makes enhancements to cluster points spatially in conjunction with their movement across consecutive time periods. It also allows for the adjustment of key parameters, if required, for different locations and satellite data sources. Bushfire data from Victoria, Australia, is used to illustrate the algorithm and its use within the package."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-022/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-08-26"/>
<meta property="article:created" itemprop="dateCreated" content="2023-08-26"/>
<meta name="article:author" content="Weihao Li"/>
<meta name="article:author" content="Emily Dodwell"/>
<meta name="article:author" content="Dianne Cook"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This paper proposes a spatiotemporal clustering algorithm and its implementation in the R package spotoroo. This work is motivated by the catastrophic bushfires in Australia throughout the summer of 2019-2020 and made possible by the availability of satellite hotspot data. The algorithm is inspired by two existing spatiotemporal clustering algorithms but makes enhancements to cluster points spatially in conjunction with their movement across consecutive time periods. It also allows for the adjustment of key parameters, if required, for different locations and satellite data sources. Bushfire data from Victoria, Australia, is used to illustrate the algorithm and its use within the package."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-022/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2023-022/RJ-2023-022_files/figure-html5/step2figs-1.png"/>
<meta property="og:image:width" content="5760"/>
<meta property="og:image:height" content="1440"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely"/>
<meta property="twitter:description" content="This paper proposes a spatiotemporal clustering algorithm and its implementation in the R package spotoroo. This work is motivated by the catastrophic bushfires in Australia throughout the summer of 2019-2020 and made possible by the availability of satellite hotspot data. The algorithm is inspired by two existing spatiotemporal clustering algorithms but makes enhancements to cluster points spatially in conjunction with their movement across consecutive time periods. It also allows for the adjustment of key parameters, if required, for different locations and satellite data sources. Bushfire data from Victoria, Australia, is used to illustrate the algorithm and its use within the package."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-022/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2023-022/RJ-2023-022_files/figure-html5/step2figs-1.png"/>
<meta property="twitter:image:width" content="5760"/>
<meta property="twitter:image:height" content="1440"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-022"/>
<meta name="citation_pdf_url" content="RJ-2023-022.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="1"/>
<meta name="citation_doi" content="10.32614/RJ-2023-022"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="17"/>
<meta name="citation_lastpage" content="33"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/08/26"/>
<meta name="citation_publication_date" content="2023/08/26"/>
<meta name="citation_author" content="Weihao Li"/>
<meta name="citation_author_institution" content="Monash University"/>
<meta name="citation_author" content="Emily Dodwell"/>
<meta name="citation_author" content="Dianne Cook"/>
<meta name="citation_author_institution" content="Monash University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Example Code to Generate Animation Frames of Himawari-8 Hotspots;citation_author=Grant Williamson"/>
  <meta name="citation_reference" content="citation_title=Open Data Shows Lightning, Not Arson, Was the Likely Cause of Most Victorian Bushfires Last Summer;citation_author=Dianne Cook"/>
  <meta name="citation_reference" content="citation_title=Fire Origins - Current and Historical;citation_author=Fire Origins - Current and Historical"/>
  <meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;citation_publisher=R Foundation for Statistical Computing;citation_author=R: A language and environment for statistical computing"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","description","type","creative_commons","date","output","bibliography","editor_options","date_received","volume","issue","slug","draft","journal","pdf_url","citation_url","doi","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Weihao Li"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Econometrics and Business Statistics"]},{"type":"character","attributes":{},"value":["weihao.li@monash.edu"]},{"type":"character","attributes":{},"value":["0000-0003-4959-106X"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","email"]}},"value":[{"type":"character","attributes":{},"value":["Emily Dodwell"]},{"type":"character","attributes":{},"value":["emdodwell@gmail.com"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Dianne Cook"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Econometrics and Business Statistics"]},{"type":"character","attributes":{},"value":["http://www.dicook.org"]},{"type":"character","attributes":{},"value":["dicook@monash.edu"]},{"type":"character","attributes":{},"value":["0000-0002-3813-7155"]}]}]},{"type":"character","attributes":{},"value":["This paper proposes a spatiotemporal clustering algorithm and its implementation in the R package spotoroo. This work is motivated by the catastrophic bushfires in Australia throughout the summer of 2019-2020 and made possible by the availability of satellite hotspot data. The algorithm is inspired by two existing spatiotemporal clustering algorithms but makes enhancements to cluster points spatially in conjunction with their movement across consecutive time periods. It also allows for the adjustment of key parameters, if required, for different locations and satellite data sources. Bushfire data from Victoria, Australia, is used to illustrate the algorithm and its use within the package."]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["2023-08-26"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["css","keep_md"]}},"value":[{"type":"character","attributes":{},"value":["style.css"]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["li-dodwell-cook.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]},{"type":"character","attributes":{},"value":["2021-12-06"]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[1]},{"type":"character","attributes":{},"value":["RJ-2023-022"]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[33]}]},{"type":"character","attributes":{},"value":["RJ-2023-022.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-022"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-022"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["spotoroo","dplyr","dbscan","rmarkdown","knitr","rjtools","readr","ggplot2","ggforce","patchwork"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["Cluster","Databases","ModelDeployment","Phylogenetics","ReproducibleResearch","Spatial","TeachingStatistics","WebTechnologies"]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-022/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["2021-196-copyedit.pdf","data/grid.csv","data/small.rda","data/VIC_hotspots_raw2.csv","data/VIC_result.rda","li-dodwell-cook_files/figure-html5/clusteringfinalresults-1.png","li-dodwell-cook_files/figure-html5/demodefplot-1.png","li-dodwell-cook_files/figure-html5/demomovplot-1.png","li-dodwell-cook_files/figure-html5/demotimeline-1.png","li-dodwell-cook_files/figure-html5/firemovem-1.png","li-dodwell-cook_files/figure-html5/himtimeline-1.png","li-dodwell-cook_files/figure-html5/step2figs-1.png","li-dodwell-cook_files/figure-html5/step3figs-1.png","li-dodwell-cook_files/figure-html5/vis1-1.png","li-dodwell-cook_files/jquery-3.6.0/jquery-3.6.0.js","li-dodwell-cook_files/jquery-3.6.0/jquery-3.6.0.min.js","li-dodwell-cook_files/jquery-3.6.0/jquery-3.6.0.min.map","li-dodwell-cook_files/popper-2.6.0/popper.min.js","li-dodwell-cook_files/webcomponents-2.0.0/webcomponents.js","li-dodwell-cook.bib","li-dodwell-cook.tex","motivation-letter.pdf","response_to_reviews.pdf","RJ-2023-022_files/anchor-4.2.2/anchor.min.js","RJ-2023-022_files/bowser-1.9.3/bowser.min.js","RJ-2023-022_files/distill-2.2.21/template.v2.js","RJ-2023-022_files/figure-html5/clusteringfinalresults-1.png","RJ-2023-022_files/figure-html5/demodefplot-1.png","RJ-2023-022_files/figure-html5/demomovplot-1.png","RJ-2023-022_files/figure-html5/demotimeline-1.png","RJ-2023-022_files/figure-html5/firemovem-1.png","RJ-2023-022_files/figure-html5/himtimeline-1.png","RJ-2023-022_files/figure-html5/step2figs-1.png","RJ-2023-022_files/figure-html5/step3figs-1.png","RJ-2023-022_files/figure-html5/vis1-1.png","RJ-2023-022_files/header-attrs-2.23/header-attrs.js","RJ-2023-022_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2023-022_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2023-022_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2023-022_files/popper-2.6.0/popper.min.js","RJ-2023-022_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2023-022_files/tippy-6.2.7/tippy-light-border.css","RJ-2023-022_files/tippy-6.2.7/tippy.css","RJ-2023-022_files/tippy-6.2.7/tippy.umd.min.js","RJ-2023-022_files/webcomponents-2.0.0/webcomponents.js","RJ-2023-022.log","RJ-2023-022.pdf","RJ-2023-022.tex","RJ-2023-022.zip","rjournal.csl","RJwrapper.log","RJwrapper.tex","scripts/grid_search.R","style.css"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.24/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="https://twitter.com/intent/tweet?text='+title+'&url=' + cite_url + '" class="dt-tag"><i class="fab fa-twitter"></i> Tweet</a>')

      const abstract = $('<d-abstract>')
      abstract.append('<b>Abstract:</b><br>')
      abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
      $("d-title p:empty").remove() // Remove empty paragraphs after title
      abstract.append(buttons)
      abstract.insertAfter($('d-title')) // Add abstract section after title

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
  </style>

  <link rel="stylesheet" href="style.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely","description":"This paper proposes a spatiotemporal clustering algorithm and its implementation in the R package spotoroo. This work is motivated by the catastrophic bushfires in Australia throughout the summer of 2019-2020 and made possible by the availability of satellite hotspot data. The algorithm is inspired by two existing spatiotemporal clustering algorithms but makes enhancements to cluster points spatially in conjunction with their movement across consecutive time periods. It also allows for the adjustment of key parameters, if required, for different locations and satellite data sources. Bushfire data from Victoria, Australia, is used to illustrate the algorithm and its use within the package.","doi":"10.32614/RJ-2023-022","authors":[{"author":"Weihao Li","authorURL":"#","affiliation":"Monash University","affiliationURL":"#","orcidID":"0000-0003-4959-106X"},{"author":"Emily Dodwell","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""},{"author":"Dianne Cook","authorURL":"http://www.dicook.org","affiliation":"Monash University","affiliationURL":"#","orcidID":"0000-0002-3813-7155"}],"publishedDate":"2023-08-26T00:00:00.000+00:00","citationText":"Li, et al., 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-4">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>This paper proposes a spatiotemporal clustering algorithm and its implementation in the R package spotoroo. This work is motivated by the catastrophic bushfires in Australia throughout the summer of 2019-2020 and made possible by the availability of satellite hotspot data. The algorithm is inspired by two existing spatiotemporal clustering algorithms but makes enhancements to cluster points spatially in conjunction with their movement across consecutive time periods. It also allows for the adjustment of key parameters, if required, for different locations and satellite data sources. Bushfire data from Victoria, Australia, is used to illustrate the algorithm and its use within the package.</p></p>
</div>

<div class="d-byline">
  Weihao Li  (Monash University)
  
,   Emily Dodwell  
  
,   Dianne Cook <a href="http://www.dicook.org" class="uri">http://www.dicook.org</a> (Monash University)
  
<br/>2023-08-26
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 class="unnumbered" id="introduction">Introduction</h2>
<p>The 2019-2020 Australia bushfire season was catastrophic in the scale of damage caused to agricultural resources, property, infrastructure, and ecological systems. By the end of 2020, the devastation attributable to these Black Summer fires totalled 33 lives lost, almost 19 million hectares of land burned, over 3,000 homes destroyed and AUD $1.7 billion in insurance losses, as well as an estimated 1 billion animals killed, including half of Kangaroo Islands population of koalas <span class="citation" data-cites="Filkov2020">(<a href="#ref-Filkov2020" role="doc-biblioref">Filkov et al. 2020</a>)</span>. According to the <span class="citation" data-cites="climate2021">Australian Government Bureau of Meteorology (<a href="#ref-climate2021" role="doc-biblioref">2021</a>)</span>, 2019 was the warmest year on record in Australia, and the period from 2013-2020 represents eight of the ten warmest years in recorded history. There is concern and expectation that impacts of climate change  including more extreme temperatures, persistent drought, and changes in plant growth and landscape drying  will worsen conditions for extreme bushfires <span class="citation" data-cites="climate2020 Deb2020">(<a href="#ref-climate2020" role="doc-biblioref">CSIRO and Australian Government Bureau of Meteorology 2020</a>; <a href="#ref-Deb2020" role="doc-biblioref">Deb et al. 2020</a>)</span>. Contributing to the problem is that dry lightning represents the main source of natural ignition, and fires that start in remote areas deep in the temperate forests are difficult to access and monitor <span class="citation" data-cites="Abram2021">(<a href="#ref-Abram2021" role="doc-biblioref">Abram et al. 2021</a>)</span>. Therefore, opportunities to detect fire ignitions, monitor bushfire spread, and understand movement patterns in remote areas are important for developing effective strategies to mitigate bushfire impact.</p>
<p>Remote satellite data provides a potential solution to the challenge of active fire detection and monitoring. Development of algorithms that process satellite imagery into hotspots  points that represent likely fires  is an active area of research (see for example <span class="citation" data-cites="Giglio2016">Giglio et al. (<a href="#ref-Giglio2016" role="doc-biblioref">2016</a>)</span>, <span class="citation" data-cites="Xu2017">Xu and Zhong (<a href="#ref-Xu2017" role="doc-biblioref">2017</a>)</span>, <span class="citation" data-cites="Wickramasinghe2016">Wickramasinghe et al. (<a href="#ref-Wickramasinghe2016" role="doc-biblioref">2016</a>)</span>, <span class="citation" data-cites="Jang2019">Jang et al. (<a href="#ref-Jang2019" role="doc-biblioref">2019</a>)</span>). Throughout this paper and the associated package, we make use of the Japan Aerospace Exploration Agency (JAXA) Himawari-8 satellite wildfire product <span class="citation" data-cites="jaxa">(<a href="#ref-jaxa" role="doc-biblioref">P-Tree System 2020</a>)</span> that identifies the location and fire radiative power (FRP) of hotspots across East Asia and Australia according to an algorithm developed by <span class="citation" data-cites="Kurihara2020">Kurihara et al. (<a href="#ref-Kurihara2020" role="doc-biblioref">2020</a>)</span>. It contains records of 1,989,572 hotspots from October 2019 to March 2020 with a 0.02<span class="math inline">\(^o\)</span> (~2km) spatial resolution and 10-minute temporal resolution. Detection of bushfire ignition and movement requires the clustering of satellite hotspots into meaningful clusters, which may then be considered in their entirety or summarized by a trajectory.</p>
<p>In this paper, we present a spatiotemporal clustering algorithm to organize hotspots into groups in order to estimate bushfire ignition locations and track bushfire movements over space and time. Inspired by two existing clustering algorithms, namely Density Based Spatial Clustering of Applications with Noise (DBSCAN) <span class="citation" data-cites="ester1996density">(<a href="#ref-ester1996density" role="doc-biblioref">Ester et al. 1996</a>)</span> and Fire Spread Reconstruction (FSR) <span class="citation" data-cites="Loboda2007">(<a href="#ref-Loboda2007" role="doc-biblioref">Loboda and Csiszar 2007</a>)</span>, our algorithm adopts the notion of noise from DBSCAN, while drawing upon the fire movement dynamics presented in FSR. We generalize the latters specification of spatiotemporal parameters, thereby providing an intuitive, straightforward, and extendable approach to the complex problem of bushfire identification and monitoring that may be applied to any satellite wildfire product. In clustering hotspots into bushfires of arbitrary shape and size, we aim to capture key fire behavior:</p>
<ul>
<li>fire evolution occurs only forwards in time,</li>
<li>fires can smolder undetectably for some time and then flare up again,</li>
<li>fires can merge with other bushfires, and</li>
<li>solitary hotspots, which we classify as noise, may not represent true fires or are otherwise very brief ignitions that do not spread.</li>
</ul>
<p>This algorithm is implemented in the R package <a href="https://cran.r-project.org/package=spotoroo">spotoroo</a>, available on CRAN. By enabling the user to cluster satellite hotspot data across space and time, this software provides the ability to relate findings to key factors in bushfire ignition (e.g.weather, proximity to roads and campsites, and fuel sources) and patterns in their spread.</p>
<p>The core functionality of this spatiotemporal clustering algorithm determines whether a hotspot represents a new ignition point or a continuation of an existing bushfire by comparing and combining cluster membership information via incremental updates from one time window to the next. Our algorithm first slices the hotspot data by its temporal dimension into fixed time intervals, according to a user-defined time step. Doing so divides the overall spatiotemporal clustering task into many smaller spatial clustering tasks that may be completed in parallel. Within each time window, which can be considered a static snapshot of hotspots observed across a user-specified number of time intervals, hotspots that fall within the threshold of a user-defined spatial metric of each other are joined into a cluster. Then, proceeding sequentially, we identify whether or not a hotspot was observed in the previous time window. If so, it retains its cluster membership from the previous time window; if not, the hotspot adopts the membership of the nearest hotspot with which it has been clustered. If no such neighbor exists, a hotspot represents the start of a new fire. It is important to note that each hotspot does not necessarily represent an individual fire, so those clusters that do not pass the threshold of a minimum number of hotspots or exist for a minimum amount of time are labelled noise.</p>
<p>As emphasized by <span class="citation" data-cites="kisilevich2009spatio">Kisilevich et al. (<a href="#ref-kisilevich2009spatio" role="doc-biblioref">2009</a>)</span>, the selection of spatial resolution and time granularity  and relevance of domain knowledge in their choice  are imperative to the understanding and interpretation of resulting clusters. These choices can influence the shape and number of clusters discovered. In the case of satellite hotspot data, these parameters depend on the spatial resolution and temporal frequency at which images are captured. We suggest that parameter tuning can be assessed using a visual heuristic, which also enables selection of appropriate values in a unit-free manner, independent of a satellites spatial and temporal resolutions.</p>
<p>This paper is organized as follows. The next section provides an introduction to the literature on spatiotemporal clustering and applications to bushfire modeling. Section <a href="#algorithm">Algorithm</a> details the steps of the clustering algorithm, and Section <a href="#package">Package</a> introduces its implementation in <a href="https://cran.r-project.org/package=spotoroo">spotoroo</a> on CRAN, including demonstration of the packages key functions and visualization capabilities. We illustrate the clustering algorithms functionality to study bushfire ignition and spread in Victoria, Australia throughout the 2020 bushfire season in <a href="#application">Application</a>, and describe a visual heuristic to inform parameter selection. Finally, we give a brief conclusion of the paper and discuss potential opportunities for use of the clustering algorithm.</p>
<h2 class="unnumbered" id="background">Background</h2>
<p><span class="citation" data-cites="datamining2012">Han et al. (<a href="#ref-datamining2012" role="doc-biblioref">2012</a>)</span> overviews clustering methods and groups algorithms into five types: partitioning, hierarchical, density-based, grid-based, and model-based methods. Clustering of hotspot data lends itself nicely to hierarchical and density-based methods because they allow for the identification of clusters of various shapes and sizes without requiring that the user pre-specify the number of clusters. Particularly, density-based methods have the notion of noise, which is convenient for eliminating non-fire events from the clustering result. We therefore focus on a review of density-based methods and refer the reader to <span class="citation" data-cites="datamining2012">Han et al. (<a href="#ref-datamining2012" role="doc-biblioref">2012</a>)</span> for algorithms in other categories and <span class="citation" data-cites="kisilevich2009spatio">Kisilevich et al. (<a href="#ref-kisilevich2009spatio" role="doc-biblioref">2009</a>)</span> for appropriate extensions to spatiotemporal data.</p>
<h3 class="unnumbered" id="spatiotemporal-clustering-based-on-dbscan">Spatiotemporal clustering based on DBSCAN</h3>
<p>Density-based methods separate regions constituting a high density of points from low-density regions by identifying pairwise distances between points, and then requiring that a threshold for their grouping be satisfied <span class="citation" data-cites="datamining2012">(<a href="#ref-datamining2012" role="doc-biblioref">Han et al. 2012</a>)</span>. Density Based Spatial Clustering of Applications with Noise (DBSCAN) <span class="citation" data-cites="ester1996density">(<a href="#ref-ester1996density" role="doc-biblioref">Ester et al. 1996</a>)</span> is an implementation of this methodology designed to address three challenges of clustering algorithms: (1) requirements of domain knowledge to determine the hyperparameters, (2) arbitrary shape of clusters and (3) computational efficiency. DBSCAN defines a maximum radius to construct a neighborhood around each point. It distinguishes between a core point, for which the number of points that fall in its neighborhood meets a minimum threshold, and a boundary point, whose neighborhood does not meet this threshold, but can be reached via overlapping neighborhoods extending from the core point. Intersecting neighborhoods are defined to be a cluster, while points that cannot be assigned to a cluster are identified as noise. DBSCAN also provides a heuristic to inform selection of threshold and cluster size.</p>
<p>What is often identified as a limitation of DBSCAN  its inability to differentiate between clusters of different densities and those adjacent to each other <span class="citation" data-cites="stdbscan">(<a href="#ref-stdbscan" role="doc-biblioref">Birant and Kut 2007</a>)</span>  is of less concern for the application to satellite data, which by nature is a set of points corresponding to the equidistant center of pixels on grid of latitudes and longitudes. However, its application to spatiotemporal clustering problems, which contain at least three components  spatial location (e.g.latitude and longitude) and time  requires specification of temporal granularity and treatment of temporal similarity <span class="citation" data-cites="kisilevich2009spatio">(<a href="#ref-kisilevich2009spatio" role="doc-biblioref">Kisilevich et al. 2009</a>)</span>. As such, several extensions to DBSCANs spatial clustering functionality have been proposed for spatiotemporal clustering solutions.</p>
<p>ST-DBSCAN <span class="citation" data-cites="stdbscan">(<a href="#ref-stdbscan" role="doc-biblioref">Birant and Kut 2007</a>)</span> was developed as an extension of DBSCANs functionality to cluster points according to their non-spatial, spatial, and temporal attributes, and it simultaneously addresses DBSCANs limitations regarding identification of clusters of varying densities and differentiation of adjacent clusters. ST-DBSCAN also introduces a second metric that considers similarity of variables associated with temporal neighbors.</p>
<p>Another spatiotemporal extension of DBSCAN called MC1 was developed by <span class="citation" data-cites="kalnis2005discovering">Kalnis et al. (<a href="#ref-kalnis2005discovering" role="doc-biblioref">2005</a>)</span>. The authors slice the data into snapshots along the time dimension and define moving clusters using the percentage of common objects shared by clusters in two consecutive snapshots.
The clustering result is obtained by linking the outputs of DBSCAN applied on each snapshot with the definition of moving clusters. This algorithm enables tracking of moving clusters such as a convoy of cars moving in a city efficiently. However, the definition of moving clusters assumes that data points are individual objects with unique IDs that can move throughout time, which does not translate to hotspots.</p>
<h3 class="unnumbered" id="spatiotemporal-clustering-with-fsr">Spatiotemporal clustering with FSR</h3>
<p>Satellite hotspot data has been effectively clustered and visualized using DBSCAN, as demonstrated in studies by <span class="citation" data-cites="nisa2014">Nisa et al. (<a href="#ref-nisa2014" role="doc-biblioref">2014</a>)</span> and <span class="citation" data-cites="hermawati2016">Hermawati and Sitanggang (<a href="#ref-hermawati2016" role="doc-biblioref">2016</a>)</span>. However, it should be noted that DBSCAN does not enable the tracking of fire ignition and movement over time.</p>
<p>FSR <span class="citation" data-cites="Loboda2007">(<a href="#ref-Loboda2007" role="doc-biblioref">Loboda and Csiszar 2007</a>)</span> addresses this limitation with a focus on fire dynamics, which aim to characterize the ignition location, spatial progression, and rate of movement of individual fire events. It introduces what is effectively a hierarchical-based clustering algorithm to identify fire spread in the Russian boreal forest based on active fire detection from MODIS (Moderate Resolution Imaging Spectroradiometer), which has a temporal frequency of six hours. The algorithm proposed by the authors constructs a tree based on three rules: (1) the earliest observed hotspot is the root of the tree, (2) any node is within a 2.5km radius from its parent and (3) any node is observed no later than four days from its parent. When the tree is closed and there are still unassigned hotspots, the algorithm continues at the earliest unassigned hotspot to construct a new tree. Finally, each tree is a cluster, and the earliest observed hotspot(s) is defined as the ignition point (i.e.a cluster may have multiple ignition points).</p>
<p>The selection of parameters for FSR is tailored to the specific region and data product being utilized. As a result, these parameter settings cannot be immediately generalized or applied to other sources of satellite hotspot data.</p>
<h3 class="unnumbered" id="limitations-of-existing-methods-for-the-purposes-of-bushfire-monitoring">Limitations of existing methods for the purposes of bushfire monitoring</h3>
<p>When considered in the context of clustering hotspot data, the existing methods discussed in the previous section are not ideal. Here we clarify these limitations that have led to different choices in our algorithm, particularly in combining the clustering results of two consecutive time periods.</p>
<p>ST-DBSCANs consideration of the similarity of variables associated with consecutive time periods adds an unnecessary complexity for the spatiotemporal clustering of hotspots, for which we focus on three variables (latitude, longitude, time). It also does not guarantee that clusters are processed temporally, which is required to determine bushfire ignition sites. For this reason, we have developed a different handling of the temporal variable for our hotspot clustering.</p>
<p>MC1 applies DBSCAN to each snapshot of data, which has the potential to treat some fire ignitions as noise. It is possible for a fire ignition to be initially identified by only a few hotspots, which may not be enough to meet DBSCANs density constraint. While we believe it is important to introduce the concept of noise to filter out non-fire events, their identification and removal should not occur at each temporal snapshot for this reason. We have therefore implemented the noise filter differently.</p>
<p>We also consider how best to handle the spatial convergence of clusters, that is, when two or more clusters from a previous time period merge together in the current time period. In such situations, both MC1 and FSR assign only one membership to the cluster of hotspots in the current time period. The consequence of such treatment is twofold: spatial coverage of one fire may increase dramatically in a short amount of time, which may not accurately reflect the natural speed of a bushfires spread, convergence or shifts in directions. This is not necessarily appropriate in light of our goal of identifying bushfire ignition locations. For this reason, and in contrast to MC1 and FSR, our algorithm inherently enables tracking of individual fires through their potential merging by keeping separate cluster ids in the current time period. This is because cluster membership is informed by a hotspots appearance in previous time periods. In the event that multiple hotspots are observed in a clusters first appearance, we calculate their centroid and record it as the ignition location.</p>
<h2 class="unnumbered" id="algorithm">Algorithm</h2>
<p>Our spatiotemporal clustering algorithm consists of four steps: (1) divide hotspots into equal time intervals, (2) cluster hotspots spatially across a series of time intervals, which we will refer to as a time window, (3) combine cluster information between consecutive time windows, and (4) identify hotspots that represent noise so they can be filtered out. These four steps are described in detail in this section.</p>
<h3 class="unnumbered" id="divide-hotspots-into-intervals">1. Divide hotspots into intervals</h3>
<p>Because fires progress through time and our aim is to determine the ignition point of any particular bushfire, time is a critical component for determining a fires starting point and tracking its subsequent progression. To manage this analysis, it is convenient to partition time into intervals to support the spatial clustering of hotspots and eventual combination of results with those of future intervals.</p>
<p>Selection of an appropriate time interval for clustering hotspot data represents a balance between maintaining the resolution of the original satellite data (which may record observations every five minutes or every hour or every four hours, for example) and computational efficiency of the algorithm. For example, a time interval of half an hour produces twice the number of iterations of the spatial clustering algorithm than a time interval of an hour; computation time is approximately linear with number of iterations. Himawari-8 hotspot data is recorded every 10 minutes; using this original temporal granularity has the potential to introduce significant noise, and would represent many more iterations of the clustering algorithm. For mitigation of this noise, we may choose an interval of 60 minutes = 1 hour. We then maintain an overall index of each hour across our entire data set, denoted as <span class="math inline">\(t=1,...,T\)</span> where T is the total number of hours in the data set.</p>
<p>A hotspot is a likely indication of a burning fire, although it is possible that a hotspot may disappear between two consecutive intervals, perhaps due to cloud cover or moisture that dampens the fire such that it becomes temporarily undetectable. The algorithm must take these considerations into account when combining information across consecutive time intervals. We need a parameter to measure how long a fire may burn undetected even if we dont see a hotspot; that is, the amount of time a bushfire is considered to be active but unaccounted for in the hotspot data.</p>
<p>For this reason, the parameter <span class="math inline">\(activeTime\)</span> is defined to reflect in intervals the maximum amount of time a fire may stay smoldering but undetectable by satellite before flaring up again. For example, if it is reasonable to assume that a bushfire not observed for 24 hours has burned out, the implication on <span class="math inline">\(activeTime\)</span> is as follows: if time is divided into half hour intervals, the parameter <span class="math inline">\(activeTime\)</span> will be 48, whereas with hour intervals, <span class="math inline">\(activeTime\)</span> is 24. The <span class="math inline">\(activeTime\)</span> parameter is a unitless integer.</p>
<p>Let <span class="math inline">\(\boldsymbol{S}_t\)</span> be a series of time intervals defined by</p>
<p><span class="math display">\[\boldsymbol{S}_t = [max(1,t-activeTime),t]\quad t = 1,2,...,T,\]</span></p>
<p>where <span class="math inline">\(max(.)\)</span> is the maximum function, <span class="math inline">\(t\)</span> is an integer time index, and <span class="math inline">\(T\)</span> is the integer length of the time window.</p>
<p>Suppose the data set contains <span class="math inline">\(T\)</span> hours of hotspot data, our time interval is one hour, and <span class="math inline">\(activeTime = 24\)</span>. This produces a sequence of time windows
<span class="math inline">\(\boldsymbol{S}_1,\boldsymbol{S}_2,\ldots,\boldsymbol{S}_{T}\)</span>, where</p>
<span class="math display">\[\begin{align*}
\boldsymbol{S}_1 &amp;= [1,1],\\
\boldsymbol{S}_2 &amp;= [1,2],\\
&amp;...\\
\boldsymbol{S}_{25} &amp;= [1,25],\\
\boldsymbol{S}_{26} &amp;= [2,26],\\
&amp;...\\
\boldsymbol{S}_{47} &amp;= [23,47],\\
\boldsymbol{S}_{48} &amp;= [24,48],\\
&amp;...\\
\boldsymbol{S}_{T} &amp;= [T-24,T].
\end{align*}\]</span>
<h3 class="unnumbered" id="cluster-hotspots-spatially-within-each-time-window">2. Cluster hotspots spatially within each time window</h3>
<p>We next cluster the hotspots within each time window. Each time window represents a static unified view of all hotspots observed across 25 consecutive time intervals (as of <span class="math inline">\(\boldsymbol{S}_{25}\)</span>). The clustering within a time window disregards the specific hourly time index associated with each observed hotspot to focus exclusively on the spatial relationship between them. A hierarchical-based method with a maximum distance stopping criterion <span class="math inline">\(adjDist\)</span> is applied.</p>
<p>The parameter <span class="math inline">\(adjDist\)</span> is used to represent the maximum distance between two adjacent hotspots, which are connected to form a graph. For example, the Himawari-8 hotspot data collection has 0.02<span class="math inline">\(^o\)</span> resolution, which corresponds to approximately 2000m. Thus, <span class="math inline">\(adjDist\)</span> is set to 3000m to indicate diagonal distance between observations. Every connected component of the graph is then considered as an individual cluster.</p>
<p>Given <span class="math inline">\(adjDist&gt;0~m\)</span> and a window <span class="math inline">\(\boldsymbol{S}_t\)</span>, the algorithm performs the following substeps:</p>
<ol type="a">
<li><p>Append a randomly selected hotspot <span class="math inline">\(h_i\)</span> to a empty list <span class="math inline">\(\boldsymbol{L}\)</span>, where <span class="math inline">\(h_i\)</span> is the <span class="math inline">\(i\)</span>th hotspot in the time window <span class="math inline">\(\boldsymbol{S}_t\)</span>. Let point <span class="math inline">\(\boldsymbol{P}\)</span> be the first item of the list <span class="math inline">\(\boldsymbol{L}\)</span>.</p></li>
<li><p>For every <span class="math inline">\(h_i \notin \boldsymbol{L}\)</span>, if <span class="math inline">\(geodesic(h_i, \boldsymbol{P})\leq adjDist\)</span>, append <span class="math inline">\(h_i\)</span> to the list <span class="math inline">\(\boldsymbol{L}\)</span>.</p></li>
<li><p>Let point <span class="math inline">\(\boldsymbol{P}\)</span> be the next item of the list <span class="math inline">\(\boldsymbol{L}\)</span>.</p></li>
<li><p>Repeat (b) and (c) until the point <span class="math inline">\(\boldsymbol{P}\)</span> reaches the end of the list <span class="math inline">\(\boldsymbol{L}\)</span>.</p></li>
<li><p>For all hotspots <span class="math inline">\(h_i \in \boldsymbol{L}\)</span>, assign a new membership to them. Remove these hotspots from the time window <span class="math inline">\(\boldsymbol{S}_t\)</span>. Repeat (a) to (e) until time window <span class="math inline">\(\boldsymbol{S}_t\)</span> is empty.</p></li>
<li><p>Recover the time window <span class="math inline">\(\boldsymbol{S}_t\)</span> and record the memberships.</p></li>
</ol>
<p>Figure <a href="#fig:step2figs">1</a> provides an example of this step.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:step2figs"></span>
<img src="RJ-2023-022_files/figure-html5/step2figs-1.png" alt="Illustration showing Step 2 of the clustering algorithm on a sample of 20 hotspots in one time window $\boldsymbol{S}_t$. Initially (a), a hotspot is selected randomly ($\boldsymbol{P}$) in order to seed a cluster. The circle indicates the maximum neighborhood distance ($adjDist$). Nearby hotspots as shown in red are clustered with $\boldsymbol{P}$ (b) to initialize list $\boldsymbol{L}$. The neighborhood is moved following every point in that collected list $\boldsymbol{L}$ and new observations are added (c), until there no more points that can be grouped (d). Then a new hotspot is selected external to the existing cluster, and the process is repeated (e). At the end, all the hotspots will be clustered (f)." width="100%" />
<p class="caption">
Figure 1: Illustration showing Step 2 of the clustering algorithm on a sample of 20 hotspots in one time window <span class="math inline">\(\boldsymbol{S}_t\)</span>. Initially (a), a hotspot is selected randomly (<span class="math inline">\(\boldsymbol{P}\)</span>) in order to seed a cluster. The circle indicates the maximum neighborhood distance (<span class="math inline">\(adjDist\)</span>). Nearby hotspots as shown in red are clustered with <span class="math inline">\(\boldsymbol{P}\)</span> (b) to initialize list <span class="math inline">\(\boldsymbol{L}\)</span>. The neighborhood is moved following every point in that collected list <span class="math inline">\(\boldsymbol{L}\)</span> and new observations are added (c), until there no more points that can be grouped (d). Then a new hotspot is selected external to the existing cluster, and the process is repeated (e). At the end, all the hotspots will be clustered (f).
</p>
</div>
</div>
<h3 class="unnumbered" id="update-memberships-for-next-time-window">3. Update memberships for next time window</h3>
<p>Step 3 assigns membership to hotspots in the next time window (<span class="math inline">\(t=2, ..., T\)</span> ) based on memberships in the previous window, as illustrated by Figure <a href="#fig:step3figs">2</a>. The algorithm performs the following substeps:</p>
<ol type="a">
<li><p>Collect the hotspots, <span class="math inline">\(h_i\)</span>, belonging to <span class="math inline">\(\boldsymbol{S}_{t}\)</span>, where some may have also been present in <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span>, into the set <span class="math inline">\(\boldsymbol{H}_t = \{h_1,h_2,...\}\)</span>. Hotspots that were present in <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> are labelled, and new hotspots are unlabeled.</p></li>
<li><p>Construct the connectivity graph, based on <span class="math inline">\(adjDist\)</span>, measuring proximity between all hotspots in <span class="math inline">\(\boldsymbol{H}_t\)</span>. There may be some hotspots from multiple <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> clusters connected together here, due to new hotspots appearing between previous hotspots. This is resolved at the next step.</p></li>
<li><p>For all unlabeled hotspots, use the label of the closest labelled point, if it is connected in the graph. Any unlabeled hotspots not connected to labelled hotspots are assigned a new label (cluster 5 in Figure <a href="#fig:step3figs">2</a>). Also, any connected graph where memberships from multiple <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> clusters occur are effectively split into the same multiple clusters (clusters 2 and 4 in Figure <a href="#fig:step3figs">2</a>). This would correspond to two existing fires burning into each other, but they keep their original label. These fires might die at this time, or they might progress in different directions.</p></li>
</ol>
<p>This consideration of cluster memberships in consecutive time windows enables us to capture the long-term behavior of individual fires, namely whether they go undetected for 24 hours or more. Intuitively, a fire is undetected for 24 hours if a cluster is represented in <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> but not <span class="math inline">\(\boldsymbol{S}_{t}\)</span>; that is, all hotspots in the cluster as of time window <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> were from time index <span class="math inline">\(t-25\)</span>. By moving through the temporal sequence of time windows this way, we gradually identify the ignition time and location of new fires by considering hotspot activity in a region over the last 24 hours.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:step3figs"></span>
<img src="RJ-2023-022_files/figure-html5/step3figs-1.png" alt="Illustration of clustering Step 3, which involves combining results from one time window to the next. There are 33 hotspots at $\boldsymbol{S}_t$, where 20 (green) of them have been previously clustered at $\boldsymbol{S}_{t-1}$ (Figure 1 f) and 13 (orange) of them are new hotspots. The connected graph show the clustering in this time window. Hotspots previously clustered at $\boldsymbol{S}_{t-1}$ keep their cluster labels. The 13 new hotspots are assigned labels of the nearest hotspot's cluster label. This might mean that a big cluster $\boldsymbol{S}_t$ (indicated by the graph) would be split back into two, if it corresponded to two clusters at $\boldsymbol{S}_{t-1}$ (e.g. clusters 2, 4). New clusters of hotspots are assigned a new label (e.g. cluster 5)." width="100%" />
<p class="caption">
Figure 2: Illustration of clustering Step 3, which involves combining results from one time window to the next. There are 33 hotspots at <span class="math inline">\(\boldsymbol{S}_t\)</span>, where 20 (green) of them have been previously clustered at <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> (Figure 1 f) and 13 (orange) of them are new hotspots. The connected graph show the clustering in this time window. Hotspots previously clustered at <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> keep their cluster labels. The 13 new hotspots are assigned labels of the nearest hotspots cluster label. This might mean that a big cluster <span class="math inline">\(\boldsymbol{S}_t\)</span> (indicated by the graph) would be split back into two, if it corresponded to two clusters at <span class="math inline">\(\boldsymbol{S}_{t-1}\)</span> (e.g.clusters 2, 4). New clusters of hotspots are assigned a new label (e.g.cluster 5).
</p>
</div>
</div>
<h3 class="unnumbered" id="handle-noise-in-the-clustering-result">4. Handle noise in the clustering result</h3>
<p>After performing step 3, all hotspots will have been assigned a membership label. However, there may exist small clusters, where small refers to number of associated hotspots and/or length of time for which a cluster is observed. These small clusters are less important for bushfire monitoring due to their limited spread, and we may be less certain that they represent true fires. To address this issue, we provide a noise filter as the last step.</p>
<p>Parameter <span class="math inline">\(minPts\)</span> specifies the minimum number of hotspots a cluster can contain and parameter <span class="math inline">\(minTime\)</span> specifies the minimum amount of time for which a cluster can exist and still be considered a bushfire. Any cluster that does not satisfy these two conditions will be reassigned membership label <span class="math inline">\(-1\)</span> to indicate they represent noise.</p>
<h3 class="unnumbered" id="result">Result</h3>
<p>The result of the spatiotemporal clustering algorithm applied to the hotspot data is a vector of memberships with length equal to the number of observations in the data.</p>
<h2 class="unnumbered" id="package">Package</h2>
<p>Our spatiotemporal clustering algorithm detailed in the previous section is implemented in the R package <a href="https://cran.r-project.org/package=spotoroo">spotoroo</a>, which is available for download on CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spotoroo&quot;</span>)</span></code></pre></div>
<p>The development version can be installed from Github:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;TengMCing/spotoroo&quot;</span>)</span></code></pre></div>
<p>The following demonstration of the packages functionality assumes <a href="https://cran.r-project.org/package=spotoroo">spotoroo</a> and <a href="https://cran.r-project.org/package=dplyr">dplyr</a> have been loaded. We also want to load the built-in data set <code>hotspots</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spotoroo)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hotspots)</span></code></pre></div>
<p>The <code>hotspots</code> data is a subset of the original Himawari-8 wildfire product and contains 1070 observations observed in the state of Victoria in Australia from December 2019 through February 2020.</p>
<p>To create this illustrative data set, records from the original October 2019-March 2020 data set were filtered to include only those hotspots in the boundary of Victorias borders with an irradiance over 100 watts per square meter. This threshold of the hotspots intensity is proposed by landscape ecologist and spatial scientist Dr.Grant Williamson <span class="citation" data-cites="hotspots">(<a href="#ref-hotspots" role="doc-biblioref">2020</a>)</span> to reduce the likelihood of including hotspots that do not represent true fires in our analysis. These two processing steps capture 75,936 observations, for which we preserve fields longitude, latitude, and observed date and time; we sample approximately 1% of these records for the packages final <code>hotspots</code> data set.</p>
<h3 class="unnumbered" id="performing-spatiotemporal-cluster-analysis">Performing spatiotemporal cluster analysis</h3>
<p>The main function of this package is <code>hotspot_cluster()</code>, which implements the spatiotemporal clustering algorithm on satellite hotspot data input by the user.</p>
<p>This function accepts a data set of hotspots (<code>hotspots</code>) which must contain fields corresponding to longitude (<code>lon</code>), latitude (<code>lat</code>), and observed time (<code>obsTime</code>). Arguments <code>activeTime</code>, <code>adjDist</code>, <code>minPts</code>, and <code>minTime</code> were previously defined in the <a href="#algorithm">Algorithm</a> section, and represent parameters for the algorithms functionality. Arguments <code>timeUnit</code> and <code>timestep</code> represent the conversion from a hotspots observed time to its corresponding integer time index.</p>
<p>We illustrate the use of function <code>hotspot_cluster()</code> below. Our <code>hotspots</code> data set has columns with names that correspond to the first four arguments. Parameters <code>timeUnit</code> and <code>timeStep</code> define the difference between two adjacent time indices as <span class="math inline">\(1\)</span> hour, and <code>activeTime</code> is <span class="math inline">\(24\)</span> time indexes, <code>adjDist</code> is <span class="math inline">\(3000\)</span> meters, <code>minPts</code> is <span class="math inline">\(4\)</span> hotspots, and <code>minTime</code> is <span class="math inline">\(3\)</span> time indices. That is, we consider any cluster that lasts longer than <span class="math inline">\(3\)</span> hours and contains at least <span class="math inline">\(4\)</span> hotspots to be a bushfire, although since the definition of a bushfire may vary according to geography, these parameters may be adjusted accordingly by the user.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">hotspot_cluster</span>(<span class="at">hotspots =</span> hotspots,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lon =</span> <span class="st">&quot;lon&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lat =</span> <span class="st">&quot;lat&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">obsTime =</span> <span class="st">&quot;obsTime&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">activeTime =</span> <span class="dv">24</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adjDist =</span> <span class="dv">3000</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">minPts =</span> <span class="dv">4</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">minTime =</span> <span class="dv">3</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">timeUnit =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">timeStep =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>This function returns a <code>spotoroo</code> object, which is a three-object <code>list</code> containing two <code>data.frame</code>s  <code>hotspots</code> and <code>ignition</code>  and a <code>list</code> called <code>setting</code>. Printing this output tells us that of the 1070 original hotspots, 10 were identified as noise points, and the remaining 1060 were clustered into 6 clusters.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>result</span></span></code></pre>
</div>
<pre><code> spotoroo object: 6 clusters | 1070 hot spots (including noise points)</code></pre>
</div>
<p>Within <code>result</code>, the first item is a <code>hotspots</code> data frame. This contains the three fields from our original input data (namely, <code>lon</code>, <code>lat</code>, and <code>obsTime</code>), as well as each hotspots assigned time index (<code>timeID</code>) and cluster <code>membership</code>. Each hotspot is also associated with the calculated distance from and time since its associated fires ignition, <code>distToIgnition</code> and <code>timeFromIgnition</code>, respectively. Any hotspot with a membership of <span class="math inline">\(-1\)</span> is identified as noise (<code>noise</code> == <code>TRUE</code>).</p>
<p>Our original hotspot data was recorded at 10-minute intervals, and we defined each time interval to be one hour. A hotspots <code>timeID</code> is assigned starting from the first observed timestamp in the data. For example, <code>2019-12-29 13:10:00</code> is the earliest <code>obsTime</code> in <code>hotspots</code> and begins the hour for which <code>timeID == 1</code>; any hotspot observed from <code>2019-12-29 14:10:00</code> to <code>2019-12-29 15:00</code> is assigned <code>timeID == 2</code>, and so on. This enumeration continues through the last hour for which we observe hotspots in the data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>result</span><span class='op'>$</span><span class='va'>hotspots</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>obsTime</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>glimpse</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 1,070
Columns: 10
$ lon                  &lt;dbl&gt; 149.30, 149.30, 149.32, 149.30, 149.30,
$ lat                  &lt;dbl&gt; -37.75999, -37.78000, -37.78000, -37.75
$ obsTime              &lt;dttm&gt; 2019-12-29 13:10:00, 2019-12-29 13:10:
$ timeID               &lt;int&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 4, 4, 5, 
$ membership           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
$ noise                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALS
$ distToIgnition       &lt;dbl&gt; 1111.885, 1111.885, 2080.914, 1111.885,
$ distToIgnitionUnit   &lt;chr&gt; &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;,
$ timeFromIgnition     &lt;drtn&gt; 0.0000000 hours, 0.0000000 hours, 0.33
$ timeFromIgnitionUnit &lt;chr&gt; &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;,</code></pre>
</div>
<p>The second item within <code>result</code> is the <code>ignition</code> data set, which contains one row for each cluster identified by the algorithm. Each clusters row captures information regarding its ignition location, observed time of ignition, number of hotspots in the cluster, and for how long the cluster was observed. The coordinates of each ignition point represent the earliest observed hotspot associated with the cluster, or the calculated centroid if there are multiple hotspots observed in the first time index associated with the cluster.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>result</span><span class='op'>$</span><span class='va'>ignition</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 6
Columns: 8
$ membership         &lt;int&gt; 1, 2, 3, 4, 5, 6
$ lon                &lt;dbl&gt; 149.3000, 146.7200, 149.0200, 149.1600, 1
$ lat                &lt;dbl&gt; -37.77000, -36.84000, -37.42000, -37.2900
$ obsTime            &lt;dttm&gt; 2019-12-29 13:10:00, 2020-01-08 01:40:00,
$ timeID             &lt;int&gt; 1, 229, 258, 280, 327, 859
$ obsInCluster       &lt;dbl&gt; 146, 165, 126, 256, 111, 256
$ clusterTimeLen     &lt;drtn&gt; 116.1667 hours, 148.3333 hours, 146.3333
$ clusterTimeLenUnit &lt;chr&gt; &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;</code></pre>
</div>
<p>The final object contained in <code>result</code> is a list that records the user-input values for the algorithms parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>result</span><span class='op'>$</span><span class='va'>setting</span></span></code></pre>
</div>
<pre><code>$activeTime
[1] 24

$adjDist
[1] 3000

$minPts
[1] 4

$ignitionCenter
[1] &quot;mean&quot;

$timeUnit
[1] &quot;h&quot;

$timeStep
[1] 1</code></pre>
</div>
<p>The user can run the function <code>summary()</code> to return key distributions that summarize the clustering results. For clusters, it captures the distribution of the number of hotspots in a cluster and the duration of the cluster (in hours). Similarly, for hotspots, it captures the distribution of their distance to ignition, both spatially (in meters) and temporally (in hours). It also notes the number of noise observations identified by the clustering algorithm.</p>
<h3 class="unnumbered" id="extracting-a-subset-of-clusters">Extracting a subset of clusters</h3>
<p>Some users may prefer to engage with a data frame of the results, rather than parsing the <code>spotoroo</code> list object described above. For this purpose, the package provides a function <code>extract_fire()</code>, which converts a <code>spotoroo</code> object to a <code>data.frame</code> by collapsing the <code>hotspots</code> and <code>ignition</code> objects. A new field, <code>type</code>, records whether a row in this data frame represents a hotspot, ignition point, or noise point. Cluster information is available for each hotspot that was not identified to be noise. Users can include or disregard noise points by toggling the argument <code>noise = TRUE</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>all_fires</span> <span class='op'>&lt;-</span> <span class='fu'>extract_fire</span><span class='op'>(</span><span class='va'>result</span>, noise <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='va'>all_fires</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>obsTime</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>glimpse</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 1,076
Columns: 14
$ lon                  &lt;dbl&gt; 149.30, 149.30, 149.30, 149.32, 149.30,
$ lat                  &lt;dbl&gt; -37.75999, -37.78000, -37.77000, -37.78
$ obsTime              &lt;dttm&gt; 2019-12-29 13:10:00, 2019-12-29 13:10:
$ timeID               &lt;int&gt; 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 4, 4, 
$ membership           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
$ noise                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALS
$ distToIgnition       &lt;dbl&gt; 1111.885, 1111.885, 0.000, 2080.914, 11
$ distToIgnitionUnit   &lt;chr&gt; &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;, &quot;m&quot;,
$ timeFromIgnition     &lt;drtn&gt; 0.0000000 hours, 0.0000000 hours, 0.00
$ timeFromIgnitionUnit &lt;chr&gt; &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;,
$ type                 &lt;chr&gt; &quot;hotspot&quot;, &quot;hotspot&quot;, &quot;ignition&quot;, &quot;hots
$ obsInCluster         &lt;dbl&gt; 146, 146, 146, 146, 146, 146, 146, 146,
$ clusterTimeLen       &lt;drtn&gt; 116.1667 hours, 116.1667 hours, 116.16
$ clusterTimeLenUnit   &lt;chr&gt; &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;, &quot;h&quot;,</code></pre>
</div>
<p>By providing a vector of indices to the argument <code>cluster</code>, the function will extract the corresponding clusters from the clustering result.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fire_1_and_2</span> <span class='op'>&lt;-</span> <span class='fu'>extract_fire</span><span class='op'>(</span><span class='va'>result</span>, cluster <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, noise <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 class="unnumbered" id="visualizing-the-clustering-result">Visualizing the clustering result</h3>
<p>The package provides three basic methods to visualize the clustering results, all of which can be produced by the function <code>plot()</code>. Users can draw advanced graphics using the results provided by the algorithm.</p>
<h4 class="unnumbered" id="default-plot-for-visualizing-the-spatial-distribution-of-clusters">Default plot for visualizing the spatial distribution of clusters</h4>
<p>The default plot allows for visualization of the spatial distribution of the fires. As shown in Figure <a href="#fig:demodefplot">3</a>, it presents the hotspots of each cluster identified by the algorithm with a single color. The black dot on top of each colored set of points is the ignition location of that fire.
This graphical representation only provides a static view of the hotspot data. To get a dynamic view, users can draw subplots grouped by time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>result</span>, bg <span class='op'>=</span> <span class='fu'>plot_vic_map</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:demodefplot"></span>
<img src="RJ-2023-022_files/figure-html5/demodefplot-1.png" alt="This is the default plot for visualizing the spatial distribution of clusters. In the results shown there are six clusters, which correspond to six fires, shown using different colors. The black dots indicate the ignition site for each fire." width="100%" />
<p class="caption">
Figure 3: This is the default plot for visualizing the spatial distribution of clusters. In the results shown there are six clusters, which correspond to six fires, shown using different colors. The black dots indicate the ignition site for each fire.
</p>
</div>
</div>
<h4 class="unnumbered" id="fire-movement-plot-for-visualizing-the-fire-dynamics">Fire movement plot for visualizing the fire dynamics</h4>
<p>Figure <a href="#fig:demomovplot">4</a> shows the path of each fires movement, which is produced by setting the plot argument <code>type = 'mov'</code>. The fire movement is computed by the <code>get_fire_mov()</code> function. Its argument <code>step</code> controls the number of time intervals combined for calculation of the hotspots centroid for the purpose of this visualization. Using a small value of <code>step</code> will produce a complex path; for example, <code>step = 1</code> means that the centroid of hotspots in each hour will be calculated to trace the fires path, while <code>step = 12</code> combines intervals over the course of half a day.</p>
<p>Note that centroids wont adequately summarize unusual cluster shapes, and it may be necessary to change the visualization to show a full shape with perhaps a convex hull. This would make for a complicated visualization of temporal movement, though. Also if a fire spreads simultaneously in different directions, the centroids would remain in approximately the same locations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>result</span>, type <span class='op'>=</span> <span class='st'>"mov"</span>, step <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:demomovplot"></span>
<img src="RJ-2023-022_files/figure-html5/demomovplot-1.png" alt="This is the fire movement plot for visualizing the fire dynamics. Here there are six clusters, corresponding to six different fires. The path between the ignition point and the end point is drawn with black line, where the triangle is the ignition point and the circle is the end point. (Note that the aspect ratio of the plot reflects the relative spatial ratio of latitude and longitude.)" width="100%" />
<p class="caption">
Figure 4: This is the fire movement plot for visualizing the fire dynamics. Here there are six clusters, corresponding to six different fires. The path between the ignition point and the end point is drawn with black line, where the triangle is the ignition point and the circle is the end point. (Note that the aspect ratio of the plot reflects the relative spatial ratio of latitude and longitude.)
</p>
</div>
</div>
<p>In this plot, hotspots are slightly jittered from their original recorded locations on the spatial grid so repeat observations at a specific latitude and longitude are visible. The triangle identifies the fires ignition point and the circle is the fires final location. This provides us with a view into the distribution of hotspots over the course of the fire, as well as the bushfires overall movement. For example, fire 1 ended southeast of its original ignition location.</p>
<h4 class="unnumbered" id="timeline-plot-for-providing-an-overview-of-the-bushfire-season">Timeline plot for providing an overview of the bushfire season</h4>
<p>Figure <a href="#fig:demotimeline">5</a> shows a timeline of fires produced by setting plot argument <code>type = 'timeline'</code>, which enables study of the intensity of the bushfire season. Hotspots observed times are plotted along the horizontal line corresponding to their assigned clusters. The green curve along the top captures the temporal density of all fires throughout the season. Noise points are represented with orange dots. The plots demonstrates that the majority of fires in our sample data set burned in mid-January.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>result</span>, type <span class='op'>=</span> <span class='st'>"timeline"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:demotimeline"></span>
<img src="RJ-2023-022_files/figure-html5/demotimeline-1.png" alt="This is the timeline plot for providing an overview of the bushfire season. The x-axis is the date and the y-axis is the cluster membership. The observed time of hotspots are shown as dot plots (green). The density plot at the top display the temporal frequency of fire occurrence over the timeframe. The dot plot at the bottom (orange) shows the observed time of hotspots that are considered to be noise." width="100%" />
<p class="caption">
Figure 5: This is the timeline plot for providing an overview of the bushfire season. The x-axis is the date and the y-axis is the cluster membership. The observed time of hotspots are shown as dot plots (green). The density plot at the top display the temporal frequency of fire occurrence over the timeframe. The dot plot at the bottom (orange) shows the observed time of hotspots that are considered to be noise.
</p>
</div>
</div>
<h2 class="unnumbered" id="application">Application</h2>
<p>We illustrate the use of the algorithm by applying it to the entirety of the 75,936 hotspots in Victoria. The spatial distribution of these hotspots for October 2019-March 2020 is shown in Figure <a href="#fig:clusteringfinalresults">6</a>. This example takes around 5 minutes to run on a 2020 Apple MacBook Pro.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 class="unnumbered" id="clustering-the-victorian-hotspot-data">Clustering the Victorian hotspot data</h3>
<p>To perform the clustering algorithm on the Victorian hotspot data, we first convert the observed time of each hotspot to its corresponding time index by setting the time difference between two successive indices to be <span class="math inline">\(1\)</span> hour via parameters <code>timeStep</code> and <code>timeUnit</code>. As initially discussed in <a href="#algorithm">Algorithm</a>, because the original Himawari-8 data is recorded at 10-minute intervals, reassigning each hotspot to its corresponding hourly time index does not cause great loss of information, but serves to significantly shorten the computation time. We then let <code>activeTime</code> be <span class="math inline">\(24\)</span> time indices and <code>adjDist</code> be <span class="math inline">\(3000\)</span> meters; see <a href="#selecting-parameter-values">Selecting parameter values</a> for further discussion of and guidance regarding selection of these choices. Finally, <code>minPts</code> is <span class="math inline">\(3\)</span> hotspots and <code>minTime</code> is <span class="math inline">\(3\)</span> time indices.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">hotspot_cluster</span>(<span class="at">hotspots =</span> vic_hotspots,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lon =</span> <span class="st">&quot;lon&quot;</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lat =</span> <span class="st">&quot;lat&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">obsTime =</span> <span class="st">&quot;obsTime&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">activeTime =</span> <span class="dv">24</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adjDist =</span> <span class="dv">3000</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">minPts =</span> <span class="dv">4</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">minTime =</span> <span class="dv">3</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">timeUnit =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">timeStep =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The clustering result shows that 407 bushfires are identified among the 75,936 hotspots. This result is reasonable, as historically the number of bushfires reported in Victoria in a year ranges from about <span class="math inline">\(200\)</span> to <span class="math inline">\(700\)</span> <span class="citation" data-cites="fireorigin">(<a href="#ref-fireorigin" role="doc-biblioref">Department of Environment, Land, Water &amp; Planning 2019</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>result</span></span></code></pre>
</div>
<pre><code> spotoroo object: 407 clusters | 75936 hot spots (including noise points)</code></pre>
</div>
<h3 class="unnumbered" id="determining-the-ignition-point-and-time-for-individual-fires">Determining the ignition point and time for individual fires</h3>
<p>The clustering result provides the ignition location of the bushfire represented by each cluster, and the <code>plot()</code> function now enables us to examine the spatial distribution of bushfire ignitions over the course of the entire summer. The result is given in Figure <a href="#fig:clusteringfinalresults">6</a>. From this plot, we observe that the large majority of fires burned in eastern Victoria, with a smattering in the south west. These areas are primarily forests and mountains. Very few fires started in or around city of Melbourne, which is located along the southern coast in the middle of the state.</p>
<p>Note that because there are now too many fires to color each of them uniquely (as done previously in Figure <a href="#fig:demodefplot">3</a>, the default <code>plot</code> function colors each cluster of fires black with their respective ignition points in red. This change in plot output occurs once the number of clusters is greater than nine.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">bg =</span> <span class="fu">plot_vic_map</span>(), <span class="at">hotspot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The ignition time of individual fires and representation of how long they burned is produced with the following code, the output of which is Figure <a href="#fig:himtimeline">7</a>. This plot shows that the majority of fires were ignited from late December 2019 to early January 2020. We observe a significant number of hotspots identified to be noise points in mid-December, which may imply there are some undetected fire events that were short-lived.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">&quot;timeline&quot;</span>, <span class="at">mainBreak =</span> <span class="st">&quot;1 month&quot;</span>, <span class="at">dateLabel =</span> <span class="st">&quot;%b %d, %y&quot;</span>)<span class="st">`</span><span class="at">. </span></span></code></pre></div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:clusteringfinalresults"></span>
<img src="RJ-2023-022_files/figure-html5/clusteringfinalresults-1.png" alt=" The distribution of hotspots (black) and bushfire ignitions (red) in Victoria during 2019-2020 Australian bushfire season. The spatial distribution of the ignition locations suggest that most of the fires were observed in the east of Victoria." width="100%" />
<p class="caption">
Figure 6:  The distribution of hotspots (black) and bushfire ignitions (red) in Victoria during 2019-2020 Australian bushfire season. The spatial distribution of the ignition locations suggest that most of the fires were observed in the east of Victoria.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:himtimeline"></span>
<img src="RJ-2023-022_files/figure-html5/himtimeline-1.png" alt="Timeline of fires observed in Victoria during the 2019-2020 Australian bushfire season. Clustered hotspots are shown as dotplots (green). The density display of the timeline shows that most fires started in late December and early January. Noise is shown at the bottom (orange), with the dashed lines indicating the density. This plot shows there is a significant number of hotspots that could be considered to be noise, especially in mid-December. It might also suggest that there are lots of short-lived and spatially constrained fires." width="100%" />
<p class="caption">
Figure 7: Timeline of fires observed in Victoria during the 2019-2020 Australian bushfire season. Clustered hotspots are shown as dotplots (green). The density display of the timeline shows that most fires started in late December and early January. Noise is shown at the bottom (orange), with the dashed lines indicating the density. This plot shows there is a significant number of hotspots that could be considered to be noise, especially in mid-December. It might also suggest that there are lots of short-lived and spatially constrained fires.
</p>
</div>
</div>
<h3 class="unnumbered" id="tracking-fire-movement">Tracking fire movement</h3>
<p>We further study the movement of the four most intensive fires, as identified by the number of hotspots clustered together. These fires burned in the eastern part of Victoria, and the output of the following code is shown in Figure <a href="#fig:firemovem">8</a>. These fires burned during the time period from December 18th through January 4th. According to the plot, 3 out of the 4 fires moved over the course of their burning, while the center of fire 163 does not appear to move much. This is because simultaneous spread in different directions kept the centroid of the cluster in a similar location over time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>result</span>, </span>
<span>     type <span class='op'>=</span> <span class='st'>"mov"</span>, </span>
<span>     cluster <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>result</span><span class='op'>$</span><span class='va'>ignition</span><span class='op'>$</span><span class='va'>obsInCluster</span>,</span>
<span>                     decreasing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>, </span>
<span>     step <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>     bg <span class='op'>=</span> <span class='fu'>plot_vic_map</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:firemovem"></span>
<img src="RJ-2023-022_files/figure-html5/firemovem-1.png" alt="Examining the dynamics of the four most intensive fires in Victoria during the 2019-2020 Australian bushfire season. All of the fires covered similar spatial areas over their lifetimes, but the trajectory was quite different. Fire 163 may have spread in many directions simultaneously over the time period, as indicated by the near constant location of the centroid." width="100%" />
<p class="caption">
Figure 8: Examining the dynamics of the four most intensive fires in Victoria during the 2019-2020 Australian bushfire season. All of the fires covered similar spatial areas over their lifetimes, but the trajectory was quite different. Fire 163 may have spread in many directions simultaneously over the time period, as indicated by the near constant location of the centroid.
</p>
</div>
</div>
<h3 class="unnumbered" id="selecting-parameter-values">Selecting parameter values</h3>
<p>We previously introduced two key parameters, <span class="math inline">\(adjDist\)</span> and <span class="math inline">\(activeTime\)</span>, in our explanation of the algorithm. While their optimal choice is unknown, a visualization tool enables their tuning such that the user can select reasonable values.</p>
<p>Consider the relationships between <span class="math inline">\(adjDist\)</span>, <span class="math inline">\(activeTime\)</span>, and the percentage of hotspots observed to be noise points. Increase of either <span class="math inline">\(adjDist\)</span> or <span class="math inline">\(activeTime\)</span> represents greater spatial and temporal tolerance, respectively, either of which usually reduces the percentage of noise points. However, if the noise points are spatially and temporally far from the meaningful clusters, increasing either of these two parameters may not significantly reduce the number of clusters. Therefore, to identify what are likely real noise points, we find the smallest values for each of <span class="math inline">\(adjDist\)</span> and <span class="math inline">\(activeTime\)</span> after which the percentage of noise points no longer decreases significantly. Based on this logic, we develop a visualization tool inspired by the scree plot <span class="citation" data-cites="cattell1966scree">(<a href="#ref-cattell1966scree" role="doc-biblioref">Cattell 1966</a>)</span> used in the principal component analysis and the sorted k-dist plot used in DBSCAN <span class="citation" data-cites="ester1996density">(<a href="#ref-ester1996density" role="doc-biblioref">Ester et al. 1996</a>)</span>. Similar to these two plots, users need to determine the values of <span class="math inline">\(activeTime\)</span> and <span class="math inline">\(adjDist\)</span> for which the greatest decrease in the percentage of noise points is captured. Figure <a href="#fig:vis1">9</a> shows the parameter tuning process using this visualization tool. To produce these plots, a grid of parameter values must be evaluated, which can be computationally intensive. For this reason, we do not include this tool in the <a href="https://cran.r-project.org/package=spotoroo">spotoroo</a>, but leave it for the user to build. The final choice of <span class="math inline">\(activeTime\)</span> is <span class="math inline">\(24\)</span> hours and <span class="math inline">\(adjDist\)</span> is <span class="math inline">\(3000\)</span> meters.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vis1"></span>
<img src="RJ-2023-022_files/figure-html5/vis1-1.png" alt="Parameter tuning plots, where the best choice of parameter is at a large drop in the percentage of noise points. Here, these are at $AdjDist = 3000$ and $activeTime = 24$. " width="100%" />
<p class="caption">
Figure 9: Parameter tuning plots, where the best choice of parameter is at a large drop in the percentage of noise points. Here, these are at <span class="math inline">\(AdjDist = 3000\)</span> and <span class="math inline">\(activeTime = 24\)</span>.
</p>
</div>
</div>
<h2 class="unnumbered" id="conclusions">Conclusions</h2>
<p>In this paper, we have proposed a spatiotemporal clustering algorithm to organize satellite hotspot data for the purpose of determining points of bushfire ignition and tracking their movement remotely. This algorithm can be used to cluster hotspots into bushfires of arbitrary shape and size, while following some basic characteristics of bushfire dynamics. It is necessary to tune the parameters of the algorithm. This can be done visually, as demonstrated in the previous sections example application, or determined by expert knowledge of fire dynamics for a geography of interest.</p>
<p>We have provided an implementation of the algorithm in the R package <a href="https://cran.r-project.org/package=spotoroo">spotoroo</a>, which supports three types of visualizations for presenting different aspects of the bushfire data: the spatial distribution of fires, the movement of individual bushfires, and the timeline of fire ignitions and length of burning. In addition, we have illustrated the use of this package in studying the 2019-2020 Australian bushfire season. The main benefit of this work is that information otherwise infeasible to collect about fires in remote areas can be extracted from satellite hotspot data and processed with the use of this package.</p>
<p>We have previously discussed the ways in which existing algorithms for spatial clustering that incorporate a temporal component are not suitable for our intended purpose. Furthermore, there are no R packages on CRAN that provide implementations of ST-DBSCAN, FSR or MC1 in order to run a direct comparison of computational efficiency or clustering performance. There is an implementation of DBSCAN in R package <a href="https://cran.r-project.org/package=dbscan">dbscan</a> that runs extremely fast (&lt; 10 seconds) on hotspot data from our example application with the proper choice of parameters. However, it clusters over 30% of the hotspots into one fire, which is not very helpful for tracking fire ignition and spread.</p>
<p>There are possible modifications that could be made to our algorithm for the purpose of improving quality of the clustering result or reduced computation time. We might consider alternative clustering techniques  for example, grid-based clustering  at each time window. It may also be possible to use an adaptable <span class="math inline">\(adjDist\)</span> at different time windows. We leave these extensions for future research.</p>
<p>More complex analyses can be conducted when clustering results are merged with data such as recreation sites, fire stations, roads, weather and vegetation types. An analysis of this type to predict the causes of bushfires in Victoria during the 2019-2020 bushfire season is described in <span class="citation" data-cites="conart">Cook (<a href="#ref-conart" role="doc-biblioref">2020</a>)</span>, which yields meaningful suggestions for future fire prevention. We hope others can build upon this work to make use of satellite hotspot data for bushfire research, especially in the context of future bushfire planning and prevention.</p>
<h2 class="unnumbered" id="acknowledgements">Acknowledgements</h2>
<p>This work was made possible through funding by the Australian Centre of Excellence for Mathematical &amp; Statistical Frontiers, which supported Emilys travel.</p>
<p>This paper was written in <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a> with <a href="https://cran.r-project.org/package=knitr">knitr</a> and <a href="https://cran.r-project.org/package=rjtools">rjtools</a>. All analyses were performed using R version 4.2.2 <span class="citation" data-cites="r2022">(<a href="#ref-r2022" role="doc-biblioref">R Core Team 2022</a>)</span>. Data were processed with <a href="https://cran.r-project.org/package=readr">readr</a> and <a href="https://cran.r-project.org/package=dplyr">dplyr</a>. Plots were produced with <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=ggforce">ggforce</a> and <a href="https://cran.r-project.org/package=patchwork">patchwork</a>. The code and data to reproduce this paper are available on <a href="https://github.com/TengMCing/Hotspots-Clustering-Algorithm">GitHub</a>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 class="appendix unnumbered" id="supplementary-materials">Supplementary materials</h2>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-022.zip">RJ-2023-022.zip</a></p>
<h2 class="appendix unnumbered" id="cran-packages-used">CRAN packages used</h2>
<p><a href="https://cran.r-project.org/package=spotoroo">spotoroo</a>, <a href="https://cran.r-project.org/package=dplyr">dplyr</a>, <a href="https://cran.r-project.org/package=dbscan">dbscan</a>, <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a>, <a href="https://cran.r-project.org/package=knitr">knitr</a>, <a href="https://cran.r-project.org/package=rjtools">rjtools</a>, <a href="https://cran.r-project.org/package=readr">readr</a>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=ggforce">ggforce</a>, <a href="https://cran.r-project.org/package=patchwork">patchwork</a></p>
<h2 class="appendix unnumbered" id="cran-task-views-implied-by-cited-packages">CRAN Task Views implied by cited packages</h2>
<p><a href="https://cran.r-project.org/view=Cluster">Cluster</a>, <a href="https://cran.r-project.org/view=Databases">Databases</a>, <a href="https://cran.r-project.org/view=ModelDeployment">ModelDeployment</a>, <a href="https://cran.r-project.org/view=Phylogenetics">Phylogenetics</a>, <a href="https://cran.r-project.org/view=ReproducibleResearch">ReproducibleResearch</a>, <a href="https://cran.r-project.org/view=Spatial">Spatial</a>, <a href="https://cran.r-project.org/view=TeachingStatistics">TeachingStatistics</a>, <a href="https://cran.r-project.org/view=WebTechnologies">WebTechnologies</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Abram2021" class="csl-entry" role="listitem">
N. J. Abram, B. J. Henley, A. Sen Gupta, T. J. R. Lippmann, H. Clarke, A. J. Dowdy, J. J. Sharples, R. H. Nolan, T. Zhang, M. J. Wooster, et al. <span class="nocase">Connections of Climate Change and Variability to Large and Extreme Forest Fires in Southeast Australia</span>. <em><span>Communications Earth &amp; Environment</span></em>, 2(1): 8, 2021. URL <a href="https://doi.org/10.1038/s43247-020-00065-8">https://doi.org/10.1038/s43247-020-00065-8</a>.
</div>
<div id="ref-climate2021" class="csl-entry" role="listitem">
Australian Government Bureau of Meteorology. <span>Annual Climate Statement 2020</span>. 2021. URL <a href="http://www.bom.gov.au/climate/current/annual/aus/">http://www.bom.gov.au/climate/current/annual/aus/</a>.
</div>
<div id="ref-stdbscan" class="csl-entry" role="listitem">
D. Birant and A. Kut. <span class="nocase">ST-DBSCAN: An Algorithm for Clustering Spatial-Temporal Data</span>. <em><span>Data &amp; Knowledge Engineering</span></em>, 60(1): 208221, 2007. URL <a href="https://doi.org/10.1016/j.datak.2006.01.013">https://doi.org/10.1016/j.datak.2006.01.013</a>.
</div>
<div id="ref-cattell1966scree" class="csl-entry" role="listitem">
R. B. Cattell. <span class="nocase">The Scree Test for the Number of Factors</span>. <em><span>Multivariate Behavioral Research</span></em>, 1(2): 245276, 1966.
</div>
<div id="ref-conart" class="csl-entry" role="listitem">
D. Cook. <span class="nocase">Open Data Shows Lightning, Not Arson, Was the Likely Cause of Most Victorian Bushfires Last Summer</span>. 2020. URL <a href="https://theconversation.com/open-data-shows-lightning-not-arson-was-the-likely-cause-of-most-victorian-bushfires-last-summer-151912">https://theconversation.com/open-data-shows-lightning-not-arson-was-the-likely-cause-of-most-victorian-bushfires-last-summer-151912</a>.
</div>
<div id="ref-climate2020" class="csl-entry" role="listitem">
CSIRO and Australian Government Bureau of Meteorology. <span class="nocase">State of the Climate 2020</span>. 2020. URL <a href="http://www.bom.gov.au/state-of-the-climate/documents/State-of-the-Climate-2020.pdf">http://www.bom.gov.au/state-of-the-climate/documents/State-of-the-Climate-2020.pdf</a>.
</div>
<div id="ref-Deb2020" class="csl-entry" role="listitem">
P. Deb, H. Moradkhani, P. Abbaszadeh, A. S. Kiem, J. Engstrom, D. Keellings and A. Sharma. <span class="nocase">Causes of the Widespread 2019-2020 Australian Bushfire Season</span>. <em><span>Earths Future</span></em>, 8(11): e2020EF001671, 2020. URL <a href="https://doi.org/10.1029/2020EF001671">https://doi.org/10.1029/2020EF001671</a>.
</div>
<div id="ref-fireorigin" class="csl-entry" role="listitem">
Department of Environment, Land, Water &amp; Planning. <span class="nocase">Fire Origins - Current and Historical</span>. 2019. URL <a href="https://discover.data.vic.gov.au/dataset/fire-origins-current-and-historical">https://discover.data.vic.gov.au/dataset/fire-origins-current-and-historical</a>.
</div>
<div id="ref-ester1996density" class="csl-entry" role="listitem">
M. Ester, H.-P. Kriegel, J. Sander and X. Xu. <span class="nocase">A Density-Based Algorithm for Discovering Clusters in Large Spatial Databases with Noise</span>. In <em><span class="nocase">Proceedings of the Second International Conference on Knowledge Discovery and Data Mining</span></em>, pages. 226231 1996. Portland, Oregon: <span>AAAI Press</span>. URL <a href="https://dl.acm.org/doi/10.5555/3001460.3001507">https://dl.acm.org/doi/10.5555/3001460.3001507</a>.
</div>
<div id="ref-Filkov2020" class="csl-entry" role="listitem">
A. I. Filkov, T. Ngo, S. Matthews, S. Telfer and T. D. Penman. <span class="nocase">Impact of Australias Catastrophic 2019/20 Bushfire Season on Communities and Environment. Retrospective Analysis and Current Trends</span>. <em><span>Journal of Safety Science and Resilience</span></em>, 1(1): 4456, 2020. URL <a href="https://doi.org/10.1016/j.jnlssr.2020.06.009">https://doi.org/10.1016/j.jnlssr.2020.06.009</a>.
</div>
<div id="ref-Giglio2016" class="csl-entry" role="listitem">
L. Giglio, W. Schroeder and C. O. Justice. <span class="nocase">The Collection 6 MODIS Active Fire Detection Algorithm and Fire Products</span>. <em><span>Remote Sensing of Environment</span></em>, 178: 3141, 2016. URL <a href="https://doi.org/10.1016/j.rse.2016.02.054">https://doi.org/10.1016/j.rse.2016.02.054</a>.
</div>
<div id="ref-datamining2012" class="csl-entry" role="listitem">
J. Han, M. Kamber and J. Pei. <em><span class="nocase">Data Mining: Concepts and Techniques, 3rd ed.</span></em> <span>Morgan Kaufman</span>, 2012. URL <a href="https://www.sciencedirect.com/book/9780123814791/data-mining-concepts-and-techniques">https://www.sciencedirect.com/book/9780123814791/data-mining-concepts-and-techniques</a>.
</div>
<div id="ref-hermawati2016" class="csl-entry" role="listitem">
R. Hermawati and I. S. Sitanggang. <span class="nocase">Web-Based Clustering Application Using Shiny Framework and DBSCAN Algorithm for Hotspots Data in Peatland in Sumatra</span>. <em><span>Procedia Environmental Sciences</span></em>, 33: 317323, 2016. URL <a href="https://doi.org/10.1016/j.proenv.2016.03.082">https://doi.org/10.1016/j.proenv.2016.03.082</a>.
</div>
<div id="ref-Jang2019" class="csl-entry" role="listitem">
E. Jang, Y. Kang, J. Im, D.-W. Lee, J. Yoon and S.-K. Kim. <span class="nocase">Detection and Monitoring of Forest Fires Using Himawari-8 Geostationary Satellite Data in South Korea</span>. <em><span>Remote Sensing</span></em>, 11(3): 2019. URL <a href="https://doi.org/10.3390/rs11030271">https://doi.org/10.3390/rs11030271</a>.
</div>
<div id="ref-kalnis2005discovering" class="csl-entry" role="listitem">
P. Kalnis, N. Mamoulis and S. Bakiras. <span class="nocase">On Discovering Moving Clusters in Spatio-Temporal Data</span>. In <em><span class="nocase">Advances in Spatial and Temporal Databases: 9th International Symposium, SSTD 2005, Angra dos Reis, Brazil, August 22-24, 2005. Proceedings 9</span></em>, pages. 364381 2005. Springer. URL <a href="https://link.springer.com/chapter/10.1007/11535331_21">https://link.springer.com/chapter/10.1007/11535331_21</a>.
</div>
<div id="ref-kisilevich2009spatio" class="csl-entry" role="listitem">
S. Kisilevich, F. Mansmann, M. Nanni and S. Rinzivillo. <span>Spatio-Temporal Clustering</span>. In <em><span class="nocase">Data Mining and Knowledge Discovery Handbook</span></em>, pages. 855874 2009. Springer. URL <a href="https://link.springer.com/chapter/10.1007/978-0-387-09823-4_44">https://link.springer.com/chapter/10.1007/978-0-387-09823-4_44</a>.
</div>
<div id="ref-Kurihara2020" class="csl-entry" role="listitem">
Y. Kurihara, K. Tanada, H. Murakami and M. Kachi. <span class="nocase">Australian Bushfire Captured by AHI/Himawari-8 and SGLI/GCOM-C</span>. In <em><span class="nocase">Proceedings of the JpGU-AGU Joint Meeting</span></em>, 2020. URL <a href="https://www.eorc.jaxa.jp/ptree/documents/Poster_H8Wfire_JpGU2020.pdf">https://www.eorc.jaxa.jp/ptree/documents/Poster_H8Wfire_JpGU2020.pdf</a>.
</div>
<div id="ref-Loboda2007" class="csl-entry" role="listitem">
T. V. Loboda and I. A. Csiszar. <span class="nocase">Reconstruction of Fire Spread Within Wildland Fire Events in Northern Eurasia From the MODIS Active Fire Product</span>. <em><span>Global and Planetary Change</span></em>, 56(3): 258273, 2007. URL <a href="https://doi.org/10.1016/j.gloplacha.2006.07.015">https://doi.org/10.1016/j.gloplacha.2006.07.015</a>.
</div>
<div id="ref-nisa2014" class="csl-entry" role="listitem">
K. K. Nisa, H. A. Andrianto and R. Mardhiyyah. <span class="nocase">Hotspot Clustering Using DBSCAN Algorithm and Shiny Web Framework</span>. In <em><span class="nocase">2014 International Conference on Advanced Computer Science and Information System</span></em>, pages. 129132 2014. URL <a href="https://doi.org/10.1109/ICACSIS.2014.7065840">https://doi.org/10.1109/ICACSIS.2014.7065840</a>.
</div>
<div id="ref-jaxa" class="csl-entry" role="listitem">
P-Tree System. <span class="nocase">JAXA Himawari Monitor - Users Guide</span>. 2020. URL <a href="https://www.eorc.jaxa.jp/ptree/userguide.html">https://www.eorc.jaxa.jp/ptree/userguide.html</a>.
</div>
<div id="ref-r2022" class="csl-entry" role="listitem">
R Core Team. <em>R: A language and environment for statistical computing.</em> Vienna, Austria: R Foundation for Statistical Computing, 2022. URL <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Wickramasinghe2016" class="csl-entry" role="listitem">
C. H. Wickramasinghe, S. Jones, K. Reinke and L. Wallace. <span class="nocase">Development of a Multi-Spatial Resolution Approach to the Surveillance of Active Fire Lines Using Himawari-8</span>. <em><span>Remote Sensing</span></em>, 8(11): 2016. URL <a href="https://doi.org/10.3390/rs8110932">https://doi.org/10.3390/rs8110932</a>.
</div>
<div id="ref-hotspots" class="csl-entry" role="listitem">
G. Williamson. <span class="nocase">Example Code to Generate Animation Frames of Himawari-8 Hotspots</span>. 2020. URL <a href="https://gist.github.com/ozjimbob/80254988922140fec4c06e3a43d069a6">https://gist.github.com/ozjimbob/80254988922140fec4c06e3a43d069a6</a>.
</div>
<div id="ref-Xu2017" class="csl-entry" role="listitem">
G. Xu and X. Zhong. <span class="nocase">Real-Time Wildfire Detection and Tracking in Australia Using Geostationary Satellite: Himawari-8</span>. <em><span>Remote Sensing Letters</span></em>, 8(11): 10521061, 2017. URL <a href="https://doi.org/10.1080/2150704X.2017.1350303">https://doi.org/10.1080/2150704X.2017.1350303</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Li, et al., "A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-022,
  author = {Li, Weihao and Dodwell, Emily and Cook, Dianne},
  title = {A Clustering Algorithm to Organize Satellite Hotspot Data for the Purpose of Tracking Bushfires Remotely},
  journal = {The R Journal},
  year = {2023},
  note = {https://doi.org/10.32614/RJ-2023-022},
  doi = {10.32614/RJ-2023-022},
  volume = {15},
  issue = {1},
  issn = {2073-4859},
  pages = {17-33}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p> The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
