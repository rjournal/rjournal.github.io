<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables</title>

<meta property="description" itemprop="description" content="Several new tests have been proposed for testing interaction in unreplicated two-way analysis of variance models. Unfortunately, each test is powerful for detecting a pattern of interaction. Therefore, it is reasonable to combine multiple interaction tests to increase the power of detection for significant interactions. We introduce the package [combinIT](https://CRAN.R-project.org/package=combinIT) that provides researchers the results of six existing recommended interaction tests, including: the value of test statistics, exact Monte Carlo p-values, approximated or adjusted p-values, the results of four combined tests and explanations of interaction types if the discussed tests are significant. The software combinIT is a more comprehensive R package in comparison with the two existing packages. In addition, the software is executed quickly to obtain the exact Monte Carlo p-values, even for large Monte Carlo runs, in contrast to existing packages."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-037/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-08-26"/>
<meta property="article:created" itemprop="dateCreated" content="2023-08-26"/>
<meta name="article:author" content="Mahmood Kharrati-Kopaei"/>
<meta name="article:author" content="Zahra Shenavari"/>
<meta name="article:author" content="Hossein Haghbin"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Several new tests have been proposed for testing interaction in unreplicated two-way analysis of variance models. Unfortunately, each test is powerful for detecting a pattern of interaction. Therefore, it is reasonable to combine multiple interaction tests to increase the power of detection for significant interactions. We introduce the package [combinIT](https://CRAN.R-project.org/package=combinIT) that provides researchers the results of six existing recommended interaction tests, including: the value of test statistics, exact Monte Carlo p-values, approximated or adjusted p-values, the results of four combined tests and explanations of interaction types if the discussed tests are significant. The software combinIT is a more comprehensive R package in comparison with the two existing packages. In addition, the software is executed quickly to obtain the exact Monte Carlo p-values, even for large Monte Carlo runs, in contrast to existing packages."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-037/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables"/>
<meta property="twitter:description" content="Several new tests have been proposed for testing interaction in unreplicated two-way analysis of variance models. Unfortunately, each test is powerful for detecting a pattern of interaction. Therefore, it is reasonable to combine multiple interaction tests to increase the power of detection for significant interactions. We introduce the package [combinIT](https://CRAN.R-project.org/package=combinIT) that provides researchers the results of six existing recommended interaction tests, including: the value of test statistics, exact Monte Carlo p-values, approximated or adjusted p-values, the results of four combined tests and explanations of interaction types if the discussed tests are significant. The software combinIT is a more comprehensive R package in comparison with the two existing packages. In addition, the software is executed quickly to obtain the exact Monte Carlo p-values, even for large Monte Carlo runs, in contrast to existing packages."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-037/"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-037"/>
<meta name="citation_pdf_url" content="RJ-2023-037.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="1"/>
<meta name="citation_doi" content="10.32614/RJ-2023-037"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="284"/>
<meta name="citation_lastpage" content="296"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/08/26"/>
<meta name="citation_publication_date" content="2023/08/26"/>
<meta name="citation_author" content="Mahmood Kharrati-Kopaei"/>
<meta name="citation_author_institution" content="Department of Statistics, College of Science, Shiraz University"/>
<meta name="citation_author" content="Zahra Shenavari"/>
<meta name="citation_author_institution" content="Department of Mathematics, Faculty of Sciences, Shiraz Branch, Islamic&#10;Azad University"/>
<meta name="citation_author" content="Hossein Haghbin"/>
<meta name="citation_author_institution" content="Department of Statistics, Faculty of Intelligent Systems Engineering&#10;and Data Science, Persian Gulf University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=A method for testing additivity in unreplicated two-way layouts based on combining multiple interaction tests;citation_volume=86;citation_author=Zahra Shenavari;citation_author=Mahmood Kharrati-Kopaei"/>
  <meta name="citation_reference" content="citation_title=A new method for testing interaction in unreplicated two-way analysis of variance;citation_volume=36;citation_author=Mahmood Kharrati-Kopaei;citation_author=S. M. Sadooghi-Alvandi"/>
  <meta name="citation_reference" content="citation_title=Design and analysis of experiments;citation_publisher=John Wiley; Sons, Inc.;citation_author=Douglas C. Montgomery"/>
  <meta name="citation_reference" content="citation_title=One degree of freedom for non-additivity;citation_publisher=[Wiley, International Biometric Society];citation_volume=5;citation_issn=0006341X, 15410420;citation_author=John W. Tukey"/>
  <meta name="citation_reference" content="citation_title=Non-additivity in two-way analysis of variance;citation_publisher=Taylor &amp; Francis;citation_volume=56;citation_author=John Mandel"/>
  <meta name="citation_reference" content="citation_title=A new analysis of variance model for non-additive data;citation_publisher=Taylor &amp; Francis;citation_volume=13;citation_author=John Mandel"/>
  <meta name="citation_reference" content="citation_title=Hiddenf: The all-configurations, maximum-interaction f-test for hidden additivity;citation_author=Jason A. Osborne;citation_author=Christopher T. Franck;citation_author=Bongseog Choi"/>
  <meta name="citation_reference" content="citation_title=Exploring interaction effects in two-factor studies using the hiddenf package in r.;citation_volume=8;citation_author=Christopher T. Franck;citation_author=Jason A. Osborne"/>
  <meta name="citation_reference" content="citation_title=A method for detecting hidden additivity in two-factor unreplicated experiments;citation_publisher=Elsevier BV;citation_volume=67;citation_issn=0167-9473;citation_author=Christopher T. Franck;citation_author=Dahlia M. Nielsen;citation_author=Jason A. Osborne"/>
  <meta name="citation_reference" content="citation_title=A clustering-based test for nonadditivity in an unreplicated two-way layout;citation_publisher=Taylor; Francis;citation_volume=45;citation_author=W. A. Malik;citation_author=J. Möhring;citation_author=H. P. Piepho"/>
  <meta name="citation_reference" content="citation_title=Testing additivity in two-way classifications with no replications:the locally best invariant test;citation_publisher=Taylor; Francis;citation_volume=20;citation_author=Robert J. Boik"/>
  <meta name="citation_reference" content="citation_title=ON TESTS FOR INTERACTION IN a NONREPLICATED TWO-WAY LAYOUT;citation_volume=36;citation_author=Hans-Peter Piepho"/>
  <meta name="citation_reference" content="citation_title=A method for testing interaction in unreplicated two-way tables: Using all pairwise interaction contrasts;citation_publisher=Taylor; Francis;citation_volume=86;citation_author=Mahmood Kharrati-Kopaei;citation_author=Arden Miller"/>
  <meta name="citation_reference" content="citation_title=combinIT: A combined interaction test for unreplicated two-way tables;citation_author=Zahra Shenavari;citation_author=Hossein Haghbin;citation_author=Mahmood Kharrati-Kopaei;citation_author=Seyed Morteza Najibi"/>
  <meta name="citation_reference" content="citation_title=Multiplicative effects in two-way analysis of variance;citation_volume=26;citation_author=L. C. A. Corsten;citation_author=A. C. Eijnsbergen"/>
  <meta name="citation_reference" content="citation_title=Addendum to “multiplicative effects in two-way analysis of variance”;citation_volume=28;citation_author=L. C. A. Corsten;citation_author=A. C. Eijnsbergen"/>
  <meta name="citation_reference" content="citation_title=An analysis of a two-way model with interaction and no replication;citation_publisher=[American Statistical Association, Taylor &amp; Francis, Ltd.];citation_volume=67;citation_issn=01621459;citation_author=Dallas E. Johnson;citation_author=Franklin A. Graybill"/>
  <meta name="citation_reference" content="citation_title=Analysis of messy data, volume II: Nonreplicated experiments;citation_publisher=Chapman; Hall/CRC;citation_author=G. A. Milliken;citation_author=D. E. Johnson"/>
  <meta name="citation_reference" content="citation_title=Testing non-additivity (interaction) in two-way ANOVA tables with no replication;citation_volume=15;citation_author=Aylin Alin;citation_author=S. Kurt"/>
  <meta name="citation_reference" content="citation_title=A HEURISTIC TECHNIQUE FOR TESTING FOR THE PRESENCE OF INTERACTION IN NONREPLICATED FACTORIAL EXPERIMENTS;citation_volume=19;citation_author=George A. Milliken;citation_author=Dale M. Rasmuson"/>
  <meta name="citation_reference" content="citation_title=Modification of tukey’s additivity test;citation_volume=143;citation_author=Petr Simecek;citation_author=Marie Simeckova"/>
  <meta name="citation_reference" content="citation_title=Testing for interaction in two-way ANOVA tables with no replication;citation_volume=10;citation_issn=0167-9473;citation_author=Fernando Tusell"/>
  <meta name="citation_reference" content="citation_title=A comparison of three invariant tests of additivity in two-way classifications with no replications;citation_volume=15;citation_author=Robert J. Boik"/>
  <meta name="citation_reference" content="citation_title=Rcpp: Seamless R and C++ integration;citation_volume=40;citation_author=Dirk Eddelbuettel;citation_author=Romain François"/>
  <meta name="citation_reference" content="citation_title=Seamless R and C++ integration with Rcpp;citation_publisher=Springer;citation_author=Dirk Eddelbuettel"/>
  <meta name="citation_reference" content="citation_title=Extending extitR with extitC++: A Brief Introduction to extitRcpp;citation_volume=72;citation_author=Dirk Eddelbuettel;citation_author=James Joseph Balamuta"/>
  <meta name="citation_reference" content="citation_title=Testing three-factor interaction in unreplicated three-way layouts;citation_publisher=Taylor; Francis;citation_volume=44;citation_author=S. M. Sadooghi-Alvandi;citation_author=M. Kharrati-Kopaei"/>
  <meta name="citation_reference" content="citation_title=additivityTests: Additivity tests in the two way anova with single sub-class numbers;citation_author=Marie Simeckova;citation_author=Thomas Rusch;citation_author=Petr Simecek"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","slug","packages","draft","preview","bibliography","CTV","output","pdf_url","citation_url","doi","creative_commons","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables"]},{"type":"character","attributes":{},"value":["Several new tests have been proposed for testing interaction in unreplicated two-way analysis of variance models. Unfortunately, each test is powerful for detecting a pattern of interaction. Therefore, it is reasonable to combine multiple interaction tests to increase the power of detection for significant interactions. We introduce the package [combinIT](https://CRAN.R-project.org/package=combinIT) that provides researchers the results of six existing recommended interaction tests, including: the value of test statistics, exact Monte Carlo p-values, approximated or adjusted p-values, the results of four combined tests and explanations of interaction types if the discussed tests are significant. The software combinIT is a more comprehensive R package in comparison with the two existing packages. In addition, the software is executed quickly to obtain the exact Monte Carlo p-values, even for large Monte Carlo runs, in contrast to existing packages."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","email","address"]}},"value":[{"type":"character","attributes":{},"value":["Mahmood Kharrati-Kopaei"]},{"type":"character","attributes":{},"value":["Department of Statistics, College of Science, Shiraz University"]},{"type":"character","attributes":{},"value":["mkharati@shirazu.ac.ir\n"]},{"type":"character","attributes":{},"value":["Shiraz","Iran","(ORCiD 0000-0001-5555-253X)"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","email","address"]}},"value":[{"type":"character","attributes":{},"value":["Zahra Shenavari"]},{"type":"character","attributes":{},"value":["Department of Mathematics, Faculty of Sciences, Shiraz Branch, Islamic\nAzad University"]},{"type":"character","attributes":{},"value":["zshenavari@yahoo.com\n"]},{"type":"character","attributes":{},"value":["Shiraz","Iran","(ORCiD 0000-0001-8347-0590)"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","email","address"]}},"value":[{"type":"character","attributes":{},"value":["Hossein Haghbin"]},{"type":"character","attributes":{},"value":["Department of Statistics, Faculty of Intelligent Systems Engineering\nand Data Science, Persian Gulf University"]},{"type":"character","attributes":{},"value":["haghbin@pgu.ac.ir\n"]},{"type":"character","attributes":{},"value":["Boushehr","Iran","(ORCiD 0000-0001-8416-2354)","<https://github.com/haghbinh>"]}]}]},{"type":"character","attributes":{},"value":["2023-08-26"]},{"type":"character","attributes":{},"value":["2022-07-11"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[284]},{"type":"integer","attributes":{},"value":[296]}]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[1]},{"type":"character","attributes":{},"value":["RJ-2023-037"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"NULL"},{"type":"NULL"}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["Kharrati-Kopaei.bib"]},{"type":"list","attributes":{},"value":[]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","legacy_pdf"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["RJ-2023-037.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-037"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-037"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.4/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-037/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["Kharrati-Kopaei.bib","Kharrati-Kopaei.tex","RJ-2023-037.pdf","RJ-2023-037.zip","RJ-2023-037_files/anchor-4.2.2/anchor.min.js","RJ-2023-037_files/bowser-1.9.3/bowser.min.js","RJ-2023-037_files/distill-2.2.21/template.v2.js","RJ-2023-037_files/header-attrs-2.23/header-attrs.js","RJ-2023-037_files/header-attrs-2.24/header-attrs.js","RJ-2023-037_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2023-037_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2023-037_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2023-037_files/popper-2.6.0/popper.min.js","RJ-2023-037_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2023-037_files/tippy-6.2.7/tippy-light-border.css","RJ-2023-037_files/tippy-6.2.7/tippy.css","RJ-2023-037_files/tippy-6.2.7/tippy.umd.min.js","RJ-2023-037_files/webcomponents-2.0.0/webcomponents.js","RJournal.sty","RJwrapper.log","RJwrapper.tex","elapsed.csv","elapsedtime.pdf","interactionplot1.pdf","interactionplot2.pdf","preamble.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.27/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").first();
      if (tpar && ! tpar.hasClass("subtitle")) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables","description":"Several new tests have been proposed for testing interaction in unreplicated two-way analysis of variance models. Unfortunately, each test is powerful for detecting a pattern of interaction. Therefore, it is reasonable to combine multiple interaction tests to increase the power of detection for significant interactions. We introduce the package [combinIT](https://CRAN.R-project.org/package=combinIT) that provides researchers the results of six existing recommended interaction tests, including: the value of test statistics, exact Monte Carlo p-values, approximated or adjusted p-values, the results of four combined tests and explanations of interaction types if the discussed tests are significant. The software combinIT is a more comprehensive R package in comparison with the two existing packages. In addition, the software is executed quickly to obtain the exact Monte Carlo p-values, even for large Monte Carlo runs, in contrast to existing packages.","doi":"10.32614/RJ-2023-037","authors":[{"author":"Mahmood Kharrati-Kopaei","authorURL":"#","affiliation":"Department of Statistics, College of Science, Shiraz University","affiliationURL":"#","orcidID":""},{"author":"Zahra Shenavari","authorURL":"#","affiliation":"Department of Mathematics, Faculty of Sciences, Shiraz Branch, Islamic\nAzad University","affiliationURL":"#","orcidID":""},{"author":"Hossein Haghbin","authorURL":"#","affiliation":"Department of Statistics, Faculty of Intelligent Systems Engineering\nand Data Science, Persian Gulf University","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-08-26T00:00:00.000+00:00","citationText":"Kharrati-Kopaei, et al., 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2024-4">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>Several new tests have been proposed for testing interaction in unreplicated two-way analysis of variance models. Unfortunately, each test is powerful for detecting a pattern of interaction. Therefore, it is reasonable to combine multiple interaction tests to increase the power of detection for significant interactions. We introduce the package <a href="https://CRAN.R-project.org/package=combinIT">combinIT</a> that provides researchers the results of six existing recommended interaction tests, including: the value of test statistics, exact Monte Carlo p-values, approximated or adjusted p-values, the results of four combined tests and explanations of interaction types if the discussed tests are significant. The software combinIT is a more comprehensive R package in comparison with the two existing packages. In addition, the software is executed quickly to obtain the exact Monte Carlo p-values, even for large Monte Carlo runs, in contrast to existing packages.</p>
</div>

<div class="d-byline">
  Mahmood Kharrati-Kopaei  (Department of Statistics, College of Science, Shiraz University)
  
,   Zahra Shenavari  (Department of Mathematics, Faculty of Sciences, Shiraz Branch, Islamic
Azad University)
  
,   Hossein Haghbin  (Department of Statistics, Faculty of Intelligent Systems Engineering
and Data Science, Persian Gulf University)
  
<br/>2023-08-26
</div>

<div class="d-article">
<h2 data-number="1" id="sec:introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Suppose that there are two factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> levels,
respectively. To investigate the effect of the factors on a response
variable <span class="math inline">\(y\)</span>, an unreplicated two-way analysis of variance (ANOVA) model
is sometimes used to reduce the experiment cost. Formally, this model is
<span class="math display">\[\label{eq:1}
    y_{ij}=\mu +\alpha_i+\beta _j+\gamma _{ij}+\epsilon_{ij},\ i=1,\dots ,a;\ \ j=1,\dots ,b,\]</span>
where <span class="math inline">\(y_{ij}\)</span> denotes the <span class="math inline">\(i\)</span>-th and the <span class="math inline">\(j\)</span>-th observation of the
response variable, <span class="math inline">\(\mu\)</span> is the grand mean, <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\beta_j\)</span>
denote the main effects of the factors, <span class="math inline">\(\gamma_{ij}\)</span>s are interaction
terms, and <span class="math inline">\(\epsilon_{ij}\)</span>s are random errors which are independent and
identically normal variables with mean zero and variance <span class="math inline">\(\sigma^2\)</span>. As
noted by <span class="citation" data-cites="Franck:2016">Franck and Osborne (<a href="#ref-Franck:2016" role="doc-biblioref">2016</a>)</span>, the unreplicated two-way ANOVA models arise in
the context of (a) completely randomized two-factor experiments, (b)
randomized complete block experiments that block on a source of nuisance
variability, and (c) observational studies with two factors. The main
problem in an unreplicated two-way ANOVA model is that all observations
are used to estimate the model parameters and no observations remain to
estimate <span class="math inline">\(\sigma^2\)</span>; see <span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span> and <span class="citation" data-cites="KKSA:2007">Kharrati-Kopaei and Sadooghi-Alvandi (<a href="#ref-KKSA:2007" role="doc-biblioref">2007</a>)</span>. Therefore, neither
F-test nor t-test can be used to make inferences on the effects
(including the interaction effect). The textbook approach is to assume
that the interaction terms are zero (i.e. the model is additive). In
this case, <span class="math inline">\(\left(a-1\right)\left(b-1\right)\)</span> degrees of freedom are
left to estimate <span class="math inline">\(\sigma^2\)</span> and the usual F-tests can be used to make
inferences about the main effects. However, if the interaction effects
are present (i.e. the model is non-additive), the main effects may be
masked by the interaction effect; see <span class="citation" data-cites="Montgomery:2017">Montgomery (<a href="#ref-Montgomery:2017" role="doc-biblioref">2017</a>)</span>. Therefore, it is
important to implement some method to test if there exists a significant
interaction in an unreplicated ANOVA model.</p>
<p>The existing approaches to test interaction in unreplicated two-way
ANOVA models can be categorized into two main groups:
functional-based-form (FBF) and non-functional-based-form (NFBF). In FBF
approaches, a functional form is assumed for the interaction terms. This
group includes interaction tests proposed by <span class="citation" data-cites="Tukey:1949">Tukey (<a href="#ref-Tukey:1949" role="doc-biblioref">1949</a>)</span>, <span class="citation" data-cites="Mandel:1961 Mandel:1971">Mandel (<a href="#ref-Mandel:1961" role="doc-biblioref">1961</a>, <a href="#ref-Mandel:1971" role="doc-biblioref">1971</a>)</span>, <span class="citation" data-cites="JG:1972">Johnson and Graybill (<a href="#ref-JG:1972" role="doc-biblioref">1972</a>)</span>, and <span class="citation" data-cites="CE:1972 CE:1974">Corsten and Eijnsbergen (<a href="#ref-CE:1972" role="doc-biblioref">1972</a>, <a href="#ref-CE:1974" role="doc-biblioref">1974</a>)</span>; see <span class="citation" data-cites="MJ:1989">Milliken and Johnson (<a href="#ref-MJ:1989" role="doc-biblioref">1989</a>, pp
2–63)</span> for a discussion of some of these interaction tests. <span class="citation" data-cites="SS:2013">Simecek and Simeckova (<a href="#ref-SS:2013" role="doc-biblioref">2013</a>)</span>
also modified Tukey’s test. It is known that these tests are powerful
for detecting interaction only when the specified functional form for
the interaction terms is appropriate; see <span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span>, <span class="citation" data-cites="AK:2006">Alin and Kurt (<a href="#ref-AK:2006" role="doc-biblioref">2006</a>)</span>,
<span class="citation" data-cites="SS:2013">Simecek and Simeckova (<a href="#ref-SS:2013" role="doc-biblioref">2013</a>)</span>, and <span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span>. In NFBF approaches, a specific functional form
is not assumed for the interaction terms. The NFBF group includes
interaction tests proposed by <span class="citation" data-cites="MR:1977">Milliken and Rasmuson (<a href="#ref-MR:1977" role="doc-biblioref">1977</a>)</span>, <span class="citation" data-cites="Tusell:1990">Tusell (<a href="#ref-Tusell:1990" role="doc-biblioref">1990</a>)</span>, <span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span>,
<span class="citation" data-cites="Piepho:1994">Piepho (<a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span>, <span class="citation" data-cites="KKSA:2007">Kharrati-Kopaei and Sadooghi-Alvandi (<a href="#ref-KKSA:2007" role="doc-biblioref">2007</a>)</span>, <span class="citation" data-cites="Franck:2013">Franck et al. (<a href="#ref-Franck:2013" role="doc-biblioref">2013</a>)</span>, <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span> and <span class="citation" data-cites="KKM:2016">Kharrati-Kopaei and Miller (<a href="#ref-KKM:2016" role="doc-biblioref">2016</a>)</span>.
<span class="citation" data-cites="KKSA:2007">Kharrati-Kopaei and Sadooghi-Alvandi (<a href="#ref-KKSA:2007" role="doc-biblioref">2007</a>)</span> formally showed that there does not exist the best
interaction test in an unreplicated two-way ANOVA model in the sense
that there is no test that can detect all patterns of interaction with
high power. This means that each test is powerful for detecting certain
types of interaction. Therefore, it is meaningful to combine multiple
interaction tests to provide researchers with a testing approach that
leverages many existing methods to detect different patterns of
non-additivity. We note that the interaction tests are dependent and the
main problem is how to combine multiple dependent tests into a single
test procedure for testing additivity such that it controls the Type I
error rate and has an acceptable power. <span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span> evaluated the
performances of different combination methods and ultimately recommended
combining the interaction tests by the Bonferroni method, a Beta (Sidak)
approximation, the Jacobi polynomial expansion, and the Gaussian copula
method. These methods are abbreviated as Bon, Sidak, JPE, and GC,
respectively, throughout this paper.</p>
<p>Despite the application of unreplicated two-way ANOVA models in
industry, biology, agriculture, and medicine, the newly proposed
interaction tests have not been discussed in statistical packages; as
similarly noted by <span class="citation" data-cites="Franck:2016">Franck and Osborne (<a href="#ref-Franck:2016" role="doc-biblioref">2016</a>)</span>. Recently, <span class="citation" data-cites="Osborne:2016">Osborne et al. (<a href="#ref-Osborne:2016" role="doc-biblioref">2016</a>)</span> released the
package <a href="https://CRAN.R-project.org/package=hiddenf">hiddenf</a> which is
available from the Comprehensive R Archive Network (CRAN). As the name
of the package hiddenf implies, this package mainly focuses on detecting
a hidden non-additivity structure proposed by <span class="citation" data-cites="Franck:2013">Franck et al. (<a href="#ref-Franck:2013" role="doc-biblioref">2013</a>)</span>. This package
also reports the p-values of tests for non-additivity developed by
<span class="citation" data-cites="Tukey:1949">Tukey (<a href="#ref-Tukey:1949" role="doc-biblioref">1949</a>)</span>, <span class="citation" data-cites="Mandel:1961">Mandel (<a href="#ref-Mandel:1961" role="doc-biblioref">1961</a>)</span>, <span class="citation" data-cites="KKSA:2007">Kharrati-Kopaei and Sadooghi-Alvandi (<a href="#ref-KKSA:2007" role="doc-biblioref">2007</a>)</span>, and <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span>. However, this
package neither provides the result of NFBF interaction tests proposed
in <span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span>, <span class="citation" data-cites="Piepho:1994">Piepho (<a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span>, and <span class="citation" data-cites="KKM:2016">Kharrati-Kopaei and Miller (<a href="#ref-KKM:2016" role="doc-biblioref">2016</a>)</span> nor the result of the
combined interaction test. In addition, this package uses a Monte Carlo
procedure to report the p-value of <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span>; however, the applied
procedure is rather time-consuming. Further, the package hiddenf
provides only adjusted Bonferroni p-values of the tests proposed by
<span class="citation" data-cites="KKSA:2007">Kharrati-Kopaei and Sadooghi-Alvandi (<a href="#ref-KKSA:2007" role="doc-biblioref">2007</a>)</span> and <span class="citation" data-cites="Franck:2013">Franck et al. (<a href="#ref-Franck:2013" role="doc-biblioref">2013</a>)</span> instead of the exact Monte Carlo p-values.
Although <span class="citation" data-cites="Franck:2016">Franck and Osborne (<a href="#ref-Franck:2016" role="doc-biblioref">2016</a>)</span> mentioned that the Bonferroni adjustment is not
overly conservative for <span class="math inline">\(a \leq 7\)</span>, one might be interested in knowing
the exact p-values. We note that <span class="citation" data-cites="SRS:2014">Simeckova et al. (<a href="#ref-SRS:2014" role="doc-biblioref">2014</a>)</span> also developed the
<a href="https://CRAN.R-project.org/package=additivityTests">additivityTests</a>
package that provides test statistics, critical values, and binary
reject/fail-to-reject decisions for tests proposed by <span class="citation" data-cites="Tukey:1949">Tukey (<a href="#ref-Tukey:1949" role="doc-biblioref">1949</a>)</span>,
<span class="citation" data-cites="Mandel:1961">Mandel (<a href="#ref-Mandel:1961" role="doc-biblioref">1961</a>)</span>, <span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span>, <span class="citation" data-cites="Tusell:1990">Tusell (<a href="#ref-Tusell:1990" role="doc-biblioref">1990</a>)</span>, <span class="citation" data-cites="JG:1972">Johnson and Graybill (<a href="#ref-JG:1972" role="doc-biblioref">1972</a>)</span>, and <span class="citation" data-cites="SS:2013">Simecek and Simeckova (<a href="#ref-SS:2013" role="doc-biblioref">2013</a>)</span>. However,
the additivityTests package does not provide the p-values of tests; see
<span class="citation" data-cites="Franck:2016">Franck and Osborne (<a href="#ref-Franck:2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>In this paper, we introduce the R package combinIT, which is available
from CRAN <span class="citation" data-cites="SHKKN:2022">(<a href="#ref-SHKKN:2022" role="doc-biblioref">Shenavari et al. 2022</a>)</span>. This package reports both exact Monte Carlo and
adjusted or approximate (if available) p-values of the six NFBF
interaction tests developed by <span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span>, <span class="citation" data-cites="Piepho:1994">Piepho (<a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span>, <span class="citation" data-cites="KKSA:2007">Kharrati-Kopaei and Sadooghi-Alvandi (<a href="#ref-KKSA:2007" role="doc-biblioref">2007</a>)</span>,
<span class="citation" data-cites="Franck:2013">Franck et al. (<a href="#ref-Franck:2013" role="doc-biblioref">2013</a>)</span>, <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span>, and <span class="citation" data-cites="KKM:2016">Kharrati-Kopaei and Miller (<a href="#ref-KKM:2016" role="doc-biblioref">2016</a>)</span>. We use abbreviations Boik,
Piepho, KKSA, Franck, Malik, and KKM, respectively, for these NFBF
tests. In addition, this package provides the results of four combined
interaction tests that are based on the Bon, Sidak, JPE, and GC methods.
Furthermore, if a significant interaction is detected by a combined
test, the package combinIT gives some explanations of the interaction
type or pattern. Note that FBF tests have not been considered in
combinIT because <span class="citation" data-cites="Boik:1993b">Boik (<a href="#ref-Boik:1993b" role="doc-biblioref">1993a</a>)</span> showed that the Boik test is never less
powerful and is sometimes much more powerful than the test proposed by
<span class="citation" data-cites="JG:1972">Johnson and Graybill (<a href="#ref-JG:1972" role="doc-biblioref">1972</a>)</span>, which can be regarded as an extension of FBF tests proposed by
<span class="citation" data-cites="Tukey:1949">Tukey (<a href="#ref-Tukey:1949" role="doc-biblioref">1949</a>)</span> and <span class="citation" data-cites="Mandel:1961 Mandel:1971">Mandel (<a href="#ref-Mandel:1961" role="doc-biblioref">1961</a>, <a href="#ref-Mandel:1971" role="doc-biblioref">1971</a>)</span>. In addition, <span class="citation" data-cites="Boik:1993b">Boik (<a href="#ref-Boik:1993b" role="doc-biblioref">1993a</a>)</span>
compared the Boik test with the NFBF test developed by <span class="citation" data-cites="Tusell:1990">Tusell (<a href="#ref-Tusell:1990" role="doc-biblioref">1990</a>)</span> and
recommended the Boik test. Furthermore, the Piepho test is a modified
version of the NFBF test proposed by <span class="citation" data-cites="MR:1977">Milliken and Rasmuson (<a href="#ref-MR:1977" role="doc-biblioref">1977</a>)</span> hence this test has not
been considered in combinIT, either. In summary, the combinIT package
reports the results of all recommended existing interaction tests in
unreplicated two-way ANOVA models and, in this view, can be regarded as
a more comprehensive package than hiddenf for testing interaction. In
terms of code execution speed, nearly 25% of the code has been written
in C++; see <a href="https://github.com/haghbinh/combinIT" class="uri">https://github.com/haghbinh/combinIT</a>. We used the
<a href="https://CRAN.R-project.org/package=Rcpp">Rcpp</a> package
<span class="citation" data-cites="RcppArticle1 RcppBook RcppArticle2">(<a href="#ref-RcppArticle1" role="doc-biblioref">Eddelbuettel and François 2011</a>; <a href="#ref-RcppBook" role="doc-biblioref">Eddelbuettel 2013</a>; <a href="#ref-RcppArticle2" role="doc-biblioref">Eddelbuettel and Balamuta 2018</a>)</span> for writing some parts of the
codes in C++. Thus, Monte Carlo simulations for calculating the p-value
of the Malik test are not as time-consuming as those in the hiddenf
package. In addition, using the Rcpp package allows us to calculate the
exact Monte Carlo p-values of the Franck and KKSA tests in a reasonable
time, in contrast to the hiddenf package, which provides only adjusted
Bonferroni p-values; see <span class="citation" data-cites="Franck:2016">Franck and Osborne (<a href="#ref-Franck:2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>The rest of the paper is organized as follows. In the next section, the
six NFBF interaction tests and the four combination methods that are
utilized in the combinIT package are briefly reviewed. Then, technical
details of the combinIT package are provided. After that, use of the
package combinIT is illustrated with an example. The execution speed of
the code is also discussed in this section. Finally, the performances of
the combined interaction tests in terms of controlling the Type I error
rate are discussed via a simulation study by using the hiddenf and
combinIT packages.</p>
<h2 data-number="2" id="six-nfbf-interaction-tests-and-four-combination-methods"><span class="header-section-number">2</span> Six NFBF interaction tests and four combination methods</h2>
<p>This section has two subsections. We first review the Boik, Piepho,
KKSA, Franck, Malik, and KKM interaction tests. We also discuss what
patterns of interactions these tests are powerful for detecting. We then
review the Bon, Beta, JPE, and GC combination methods. These tests and
combination methods are utilized in the combinIT package. Throughout
this section, the null hypothesis of interest is <span class="math inline">\(H_0:\)</span> There is no
interaction or, equivalently, <span class="math inline">\(H_0: \gamma_{ij}=0\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>
and <span class="math inline">\(r_{ij}=y_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y}_{..}\)</span> (in usual
notation) denote the residuals of the model
<a href="#eq:1" data-reference-type="ref" data-reference="eq:1"><span class="math display">\[eq:1\]</span></a> under <span class="math inline">\(H_0\)</span>.</p>
<h3 data-number="2.1" id="six-nfbf-interaction-tests"><span class="header-section-number">2.1</span> Six NFBF interaction tests</h3>
<p>Boik. Let <span class="math inline">\(p=\text{min}\{a-1,b-1\}\)</span>, <span class="math inline">\(q=\text{max}\{a-1,b-1\}\)</span> and
<span class="math inline">\(\text{tr}\left(\mathbold{X}\right)\)</span> denote the trace of matrix
<span class="math inline">\(\mathbold{X}\)</span>. <span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span> proposed a locally best invariant (LBI) test
and <span class="math inline">\(H_0\)</span> is rejected when
<span class="math display">\[T_{\text{Boik}}=\text{tr}^{2}\left(\mathbold{R}^{\prime}\mathbold{R}\right)/\left(p\text{tr}\left(\left(\mathbold{R}^{\prime}\mathbold{R}\right)^2\right)\right)\]</span>
is small, where <span class="math inline">\(\mathbold{R}=[r_{ij}]\)</span> denotes the residual matrix of
the model <a href="#eq:1" data-reference-type="ref" data-reference="eq:1"><span class="math display">\[eq:1\]</span></a>.
<span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span> provided the exact distribution of the test statistic under
the null hypothesis <span class="math inline">\(H_0\)</span> when <span class="math inline">\(p=2\)</span> and its asymptotic distribution
when <span class="math inline">\(q\)</span> is large. Note that the p-value of the Boik test is always 1
when <span class="math inline">\(p=1\)</span>. Note that the <span class="citation" data-cites="Boik:1993">Boik (<a href="#ref-Boik:1993" role="doc-biblioref">1993b</a>)</span> test is powerful for detecting
interaction when the matrix of interaction terms <span class="math inline">\([\gamma_{ij}]\)</span> has
small rank and one singular value dominates the remaining singular
values; see <span class="citation" data-cites="Boik:1993b">Boik (<a href="#ref-Boik:1993b" role="doc-biblioref">1993a</a>)</span>. For example, the Boik test is powerful for
detecting the multiplicative form of interaction. The package combinIT
provides the value of test statistic <span class="math inline">\(T_{\text{Boik}}\)</span>, an asymptotic
p-value, and an exact p-value of the Boik test based on a Monte Carlo
simulation procedure.</p>
<p>Piepho. <span class="citation" data-cites="Piepho:1994">Piepho (<a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span> discussed and modified an interaction test
procedure proposed by <span class="citation" data-cites="MR:1977">Milliken and Rasmuson (<a href="#ref-MR:1977" role="doc-biblioref">1977</a>)</span> by using the estimator of variance for
each level of one factor; i.e.,
<span class="math display">\[\hat{\sigma}^2_{i}=\frac{a\left(a-1\right) W_{i}-\sum_{k=1}^a W_{k}}{\left(a-1\right)\left(a-2\right)\left(b-1\right)},\]</span>
where <span class="math inline">\(W_{i}=\sum_{j=1}^b r_{ij}^2\)</span> . <span class="citation" data-cites="Piepho:1994">Piepho (<a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span> proposed three test
statistics. The combinIT package utilizes the third one, which detects a
significant interaction when
<span class="math display">\[T_{\text{Piepho}}=-\left(a-1\right)\left(a-2\right)\left(b-1\right)\log(U)/2\]</span>
is large, where
<span class="math inline">\(U=2a \sum_{i&lt;j} \hat{\sigma}^2_{i} \hat{\sigma}^2_{j}/\left(\left(a-1\right) \left(\sum_{i=1}^a \hat{\sigma}^2_{i}\right)^2\right)\)</span>.
<span class="citation" data-cites="Piepho:1994">Piepho (<a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span> provided only an asymptotic chi-square distribution of
<span class="math inline">\(T_{\text{Piepho}}\)</span> under <span class="math inline">\(H_0\)</span>. By construction, the Piepho test is
powerful for detecting interactions when the estimators of variances are
heterogeneous across the levels of one factor. The package combinIT
provides the value of test statistic <span class="math inline">\(T_{\text{Piepho}}\)</span>, an asymptotic
chi-square p-value, and an exact p-value of the Piepho test based on a
Monte Carlo simulation procedure.</p>
<p>KKSA. Suppose that <span class="math inline">\(a\geq b\)</span> and <span class="math inline">\(b \geq4\)</span>. Split the data table into
two sub-tables, obtained by putting <span class="math inline">\(a_1\)</span> (<span class="math inline">\(2\leq a_1 \leq a-2\)</span>) rows in
the first sub-table and the remaining <span class="math inline">\(a_2\)</span> rows in the second sub-table
(<span class="math inline">\(a_1+a_2=a\)</span>). The number of all possible divisions of the data table is
<span class="math inline">\(\text{APD}=2^{\left(a-1\right)}-a-1\)</span>. For the <span class="math inline">\(l\)</span>-th division, let RSS1
and RSS2 denote the residual sum of squares for the two sub-tables. Let
<span class="math inline">\(F_l^*=\text{max}\{F_l,1/F_l\}\)</span> where
<span class="math inline">\(F_l=\left(a_2-1\right)RSS1/\left(\left(a_1-1\right)RSS2\right)\)</span> and
<span class="math inline">\(P_l\)</span> denote the corresponding p-value. <span class="citation" data-cites="KKSA:2007">Kharrati-Kopaei and Sadooghi-Alvandi (<a href="#ref-KKSA:2007" role="doc-biblioref">2007</a>)</span> proposed
<span class="math inline">\(\text{minP}=\min_{1\leq l \leq \text{APD}} P_l\)</span> as a test statistic and
the hypothesis of no interaction is rejected for a small value of
<span class="math inline">\(\text{minP}\)</span>. The KKSA test is powerful for detecting interaction when
the magnitude of interaction effects is heteroscedastic across the
sub-tables of observations. The package combinIT provides the value of
the test statistic and an exact p-value of the KKSA test based on a
Monte Carlo simulation procedure. In addition, it provides an
approximate p-value based on the Bonferroni adjustment. Note that the
KKSA test is not applicable when both <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are less than 4.</p>
<p>Franck. <span class="citation" data-cites="Franck:2013">Franck et al. (<a href="#ref-Franck:2013" role="doc-biblioref">2013</a>)</span> defined the hidden additivity structure as “the
levels of one factor belong in two or more groups such that within each
group the effects of the two factors are additive but the groups may
interact with the ungrouped factor”. Based on this concept, <span class="citation" data-cites="Franck:2013">Franck et al. (<a href="#ref-Franck:2013" role="doc-biblioref">2013</a>)</span>
proposed a test statistic by dividing the table of data into two
sub-tables and developing an interaction F-test. Then, they considered
all possible configurations of data and used the maximum of the
interaction F-tests as a test statistic; the all-configurations and
maximum-interaction F-test (ACMIF). The hypothesis of no interaction is
rejected when ACMIF is large. It is clear that the Franck test is
powerful when there is a hidden additivity structure in the data set.
The package combinIT provides the value of the test statistic (ACMIF),
an exact p-value of the Franck test based on a Monte Carlo simulation
procedure, and an approximate p-value based on the Bonferroni
adjustment.</p>
<p>Malik. <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span> used the idea that some cells may be involved in a
significant interaction pattern and those cells might produce large
positive or negative residuals. Therefore, <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span> proposed to
partition the residuals into three clusters using a suitable clustering
method like k-means clustering. The hypothesis of no interaction can be
interpreted as the effect of the three clusters being equal. In more
detail, <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span> proposed the model
<span class="math inline">\(y_{ij}=\mu^{*}+\alpha_i^{*}+\beta_j^{*}+\xi_{k\left(ij\right)}+\epsilon_{ij}\)</span>
where <span class="math inline">\(\xi_{k}\)</span> is the cluster effect for the <span class="math inline">\(k\)</span>-th cluster,
<span class="math inline">\(k=1, 2, 3\)</span>, and <span class="math inline">\(k\left(ij\right)\)</span> denotes the cluster <span class="math inline">\(k\)</span> to which the
residual of the <span class="math inline">\(\left(i,j\right)\)</span>-th cell is assigned by the clustering
procedure. <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span> considered the hypothesis of no interaction as
<span class="math inline">\(H_0: \xi_1=\xi_2=\xi_3\)</span>. Let
<span class="math inline">\(\text{SSE}\left(\text{cluster}\right)=\sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^3\left(y_{ij}-\hat{\mu}^{*}-\hat{\alpha}_i^{*}-\hat{\beta}_j^{*}-\hat{\xi}_{k\left(ij\right)}\right)^2\)</span>
where the hat notation denotes the estimates of effects. <span class="citation" data-cites="Malik:2016">Malik et al. (<a href="#ref-Malik:2016" role="doc-biblioref">2016</a>)</span>
proposed the following test statistic to test <span class="math inline">\(H_0\)</span></p>
<p><span class="math display">\[T_{\text{Malik}}=\frac{\left(\sum_{i=1}^a\sum_{j=1}^b
        r_{ij}^2-\text{SEE}\left(\text{cluster}\right)\right)/2}{\text{SSE}\left(\text{cluster}\right)⁄\left(\left(a-1\right)\left(b-1\right)-2\right)}.\]</span>
The hypothesis <span class="math inline">\(H_0\)</span> is rejected for large values of <span class="math inline">\(T_{\text{Malik}}\)</span>.
Note that the result of the Malik test may depend on the method of
clustering. In the combinIT package, clustering is done by
<a href="https://CRAN.R-project.org/view=kmeans"><em>kmeans</em></a> function in
<a href="https://CRAN.R-project.org/package=RcppArmadillo">RcppArmadillo</a>. The
speedmode parameter on the kmeans clustering was set as staticsubset.
Note that the Malik test performs well when there are some cells that
produce large negative or positive residuals due to significant
interaction. The package combinIT provides the value of test statistic
<span class="math inline">\(T_{\text{Malik}}\)</span> and an exact p-value of the Malik test based on a
Monte Carlo simulation procedure.</p>
<p>KKM. Let <span class="math inline">\(\mu_{ij}=\mu +\alpha_i+\beta _j+\gamma _{ij}\)</span> denote the
<span class="math inline">\(\left(i,j\right)\)</span>-th cell mean and let
<span class="math inline">\(\eta_{ij}=\mu_{ij}-\mu_{i^{\prime}j}-\mu_{ij^{\prime}}+\mu_{i^{\prime}j^{\prime}}, i\neq i^{\prime}; j \neq j^{\prime},\)</span>
denote pairwise interaction contrasts. <span class="citation" data-cites="KKM:2016">Kharrati-Kopaei and Miller (<a href="#ref-KKM:2016" role="doc-biblioref">2016</a>)</span> used the idea that if a
significant interaction is present, its corresponding interaction
contrast shall be significant. To describe this method, let
<span class="math inline">\(\mathbold{Z}\)</span> be an <span class="math inline">\(n\times 1\)</span> vector with elements
<span class="math inline">\(y_{ij}-y_{i^{\prime}j}-y_{ij^{\prime}}+y_{i^{\prime}j^{\prime}}\)</span> where
<span class="math inline">\(n=ab\left(a-1\right)\left(b-1\right)/4\)</span> is the total number of
estimated pairwise interaction contrasts. <span class="citation" data-cites="KKM:2016">Kharrati-Kopaei and Miller (<a href="#ref-KKM:2016" role="doc-biblioref">2016</a>)</span> proposed as a test
statistic, where <span class="math inline">\(Z_k\)</span> is the <span class="math inline">\(k\)</span>-th element of <span class="math inline">\(\mathbold{Z}\)</span>,
<span class="math inline">\(\text{PSE}=\text{median}\{|Z_k|; |Z_k|\leq 5S_0\}\)</span> in which
<span class="math inline">\(S_0=\text{median}\{|Z_k|; k=1,…,n\}/c_0\)</span> where <span class="math inline">\(c_0\)</span> is an unbiasing
constant obtained by a Monte Carlo simulation. <span class="math inline">\(H_0\)</span> is rejected when
<span class="math inline">\(T_{\text{KKM}}\)</span> is large. This test procedure is powerful for detecting
significant interactions when they are caused by some cells; i.e. some
values of <span class="math inline">\(|Z_k|\)</span> are large. The package combinIT provides the value of
test statistic <span class="math inline">\(T_{\text{KKM}}\)</span> and the exact p-value of the KKM test
based on a Monte Carlo simulation procedure.</p>
<h3 data-number="2.2" id="four-methods-for-combining-interaction-tests"><span class="header-section-number">2.2</span> Four methods for combining interaction tests</h3>
<p>Since there is no single best interaction test in an unreplicated
two-way ANOVA model, it is reasonable to combine multiple interaction
tests to provide researchers with a testing approach that leverages many
existing methods to detect different patterns of non-additivity. In this
section, we review four combination methods that were proposed by
<span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span>. Throughout the section, we assume that <span class="math inline">\(K \geq 2\)</span> tests,
whose test statistics are dependent and whose distribution functions are
continuous, have been performed for a null hypothesis <span class="math inline">\(H_0\)</span>. Therefore,
there are <span class="math inline">\(K\)</span> dependent p-values <span class="math inline">\(P_1, \ldots, P_K\)</span> corresponding to the
interaction tests. We are going to combine these p-values into a single
p-value using one of the following four test procedures for testing
<span class="math inline">\(H_0\)</span>.</p>
<p>Bon. Following the Bonferroni inequality, <span class="math inline">\(H_0\)</span> can be rejected at level
<span class="math inline">\(\alpha\)</span> when <span class="math inline">\(Kp_{\text{min}}&lt;\alpha\)</span> where <span class="math inline">\(p_{\text{min}}\)</span> is the
observed value of <span class="math inline">\(P_{\text{min}}=\min_{1 \leq i \leq K} \{ P_i \}\)</span>.
Note that the Bonferroni method leads to a <u>conservative</u>
method of combination; i.e. its Type I error rate is always less than
<span class="math inline">\(\alpha\)</span>; <span class="math inline">\(\text{Pr}_{H_0}\{ KP_{\text{min}}&lt;\alpha \} \leq \alpha\)</span>.</p>
<p>Sidak. The distribution function of <span class="math inline">\(P_\text{min}\)</span> under <span class="math inline">\(H_0\)</span> would be
a beta distribution with parameters <span class="math inline">\(1\)</span> and <span class="math inline">\(K\)</span> if
<span class="math inline">\(P_i, i=1, \ldots, K\)</span>, were independent; i.e.
<span class="math inline">\(\text{Pr}_{H_0} \{P_{\text{min}} \leq x \}=1-\left(1-x\right)^K\)</span>. When
<span class="math inline">\(P_i\)</span>s are dependent, it can be shown that there is an
<span class="math inline">\(x^{*}\in \left(0,1\right)\)</span> such that
<span class="math inline">\(\text{Pr}_{H_0} \{P_{\text{min}} \leq x \} \leq 1-\left(1-x\right)^K\)</span>
for all <span class="math inline">\(x &lt; x^{*}\)</span>; see <span class="citation" data-cites="SAKK:2015">Sadooghi-Alvandi and Kharrati-Kopaei (<a href="#ref-SAKK:2015" role="doc-biblioref">2015</a>)</span>. Therefore, <span class="math inline">\(H_0\)</span> would be rejected
at level <span class="math inline">\(\alpha\)</span> when <span class="math inline">\(1-\left(1-p_\text{min} \right)^K&lt;\alpha\)</span>.</p>
<p>JPE. The distribution of <span class="math inline">\(P_{\text{min}}\)</span> under <span class="math inline">\(H_0\)</span> can be
approximated by the Jacobi polynomial expansion. In this expansion, the
distribution of <span class="math inline">\(P_{\min}\)</span> is approximated by the weighted sum of
several Beta distribution functions with parameters <span class="math inline">\(p=1\)</span> and
<span class="math inline">\(q=1/E_1-1\)</span> where <span class="math inline">\(E_1\)</span> denotes the first moment of <span class="math inline">\(P_{\min}\)</span>; see
<span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span>. Up to the second term in the Jacobi polynomial expansion, the
distribution of <span class="math inline">\(P_{\min}\)</span> is approximated by a Beta distribution with
parameters <span class="math inline">\(1\)</span> and <span class="math inline">\(q\)</span>. In practice, the parameter <span class="math inline">\(q\)</span> can be estimated
as <span class="math inline">\(\hat{q}=\min \{ \max \{ 1,1/P_{\min}-1 \}, K-1 \}\)</span>; see <span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span>.
By this approximation, the null hypothesis <span class="math inline">\(H_0\)</span> is rejected at level
<span class="math inline">\(\alpha\)</span> when <span class="math inline">\(1-\left(1-p_{\min}\right)^{\hat{q}}&lt;\alpha\)</span>.</p>
<p>GC. Let <span class="math inline">\(Z_i=\Phi^{-1} \left(P_i\right)\)</span>, <span class="math inline">\(i=1,\ldots ,K\)</span>, where
<span class="math inline">\(\Phi^{-1}\left(.\right)\)</span> is the quantile function of the standard
normal distribution. Although it is well known that <span class="math inline">\(Z_i\)</span>s are
marginally distributed as the standard normal distribution under the
null hypothesis <span class="math inline">\(H_0\)</span>, the joint distribution of the <span class="math inline">\(Z_i\)</span> is unknown in
practice. One can use the Gaussian copula (GC) family to model the joint
distribution of <span class="math inline">\(Z_i\)</span>s. Therefore, one can assume that the random vector
<span class="math inline">\(\left(Z_1,\ldots,Z_K\right)\)</span> has a <span class="math inline">\(K\)</span>-variate normal distribution
under the null hypothesis <span class="math inline">\(H_0\)</span> with zero mean vector and
variance-covariance matrix <span class="math inline">\(\mathbold\Sigma\)</span>. In this case, the null
hypothesis <span class="math inline">\(H_0\)</span> is rejected at level <span class="math inline">\(\alpha\)</span> when
<span class="math display">\[\text{Pr}_{H_0} \{P_{\min} \leq p_{\min} \}=1-\text{Pr}_{H_0} \{ Z_1&gt; \Phi^{-1}\left(p_{\min}\right), \ldots , Z_K&gt; \Phi^{-1}\left(p_{\min}\right) \}&lt; \alpha.\]</span>
This probability is calculated by using
<a href="https://CRAN.R-project.org/package=mvtnorm">mvtnorm</a> in the package
combinIT. Note that <span class="math inline">\(\mathbold{\Sigma}\)</span> can be estimated by
<span class="math inline">\(\hat{\mathbold{\Sigma}}=\left(1-\hat{\rho}\right)\mathbold{I}_K+\hat{\rho}\mathbold{1}_K \mathbold{1}^{&#39;}_K\)</span>
where <span class="math inline">\(\mathbold{I}_K\)</span> is a <span class="math inline">\(K \times K\)</span> identity matrix,
<span class="math inline">\(\mathbold{1}_K\)</span> is a <span class="math inline">\(K\)</span>-dimensional vector of ones, and
<span class="math inline">\(\hat{\rho}=\max \{-1/\left(K-1\right), 1-\sum_{i=1}^K \left(Z_i-\bar{Z}\right)^2/\left(K-1\right) \}\)</span>;
see <span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>Note 1. If the null hypothesis <span class="math inline">\(H_0\)</span> is rejected, the combined tests can
suggest a pattern of non-additivity by examining the interaction test
for which <span class="math inline">\(P_{\min}=\min_{1 \leq i \leq K} \{ P_i\}\)</span> occurs.</p>
<p>Note 2. The inequality
<span class="math inline">\(K p_{\min} \leq 1-\left(1-p_{\min}\right)^{K} \leq 1-\left(1-p_{\min}\right)^{\hat{q}}\)</span>
guarantees that the JPE method provides an interaction test that is
never less powerful and is sometimes much more powerful than the Bon and
Sidak counterparts.</p>
<h2 data-number="3" id="technical-details-about-the-combinit-package"><span class="header-section-number">3</span> Technical details about the combinIT package</h2>
<p>The combinIT package stands for "Combined Interaction Test". This
package allows users to perform the six NFBF interaction tests
individually and to perform a combined test of the six NFBF interaction
tests. It also has a function to produce an interaction plot and four
data sets. The available functions in the combinIT package are described
in Table <a href="#tab:1" data-reference-type="ref" data-reference="tab:1">1</a>. This
package produces two S3-class objects: (i) ITtest, produced by functions
that perform a single test and (ii) combtest, produced by the function
that performs the combined test. These returned objects are lists with
the following components:</p>
<ul>
<li><p>ITtest class: For the return object of the functions Malik_test,
Franck_test, Boik_test, KKSA_test, KKM_test, and Piepho_test. An
object of this class consists of a list of six components,
including:</p>
<ul>
<li><p>pvalue_exact: The calculated exact Monte Carlo p-value. For
Boik_test, this is an exact Monte Carlo p-value when <span class="math inline">\(p&gt;2\)</span> and
it is an exact p-value for <span class="math inline">\(p=2\)</span>.</p></li>
<li><p>pvalue_appro: For Piepho_test this is an asymptotic p-value.
This component is the Bonferroni-adjusted p-value for
Franck.test and KKSA_test. This component is not available for
Malik_test and KKM_test.</p></li>
<li><p>nsim: The number of Monte Carlo samples used to calculate the
exact Monte Carlo p-values.</p></li>
<li><p>statistic: The value of the test statistic.</p></li>
<li><p>data_name: The name of the input data set.</p></li>
<li><p>test: The name of the test.</p></li>
</ul></li>
<li><p>combtest class: For the return object of the function CI_test. An
object of this class consists of a list of 19 components, including:</p>
<ul>
<li><p>nsim: The number of Monte Carlo samples used to calculate the
exact Monte Carlo p-values.</p></li>
<li><p>Piepho_pvalue: The p-value of Piepho’s (1994) test.</p></li>
<li><p>Piepho_Stat: The value of Piepho’s (1994) test statistic.</p></li>
<li><p>Boik_pvalue: The p-value of Boik test.</p></li>
<li><p>Boik_Stat: The value of Boik’s (1993) test statistic.</p></li>
<li><p>Malik_pvalue: The p-value of Malik, et al.’s (2016) test.</p></li>
<li><p>Malik_Stat: The value of Malik, et al.’s (2016) test statistic.</p></li>
<li><p>KKM_pvalue: The p-value of Kharrati-Kopaei and Miller’s (2016)
test.</p></li>
<li><p>KKM_Stat: The value of Kharrati-Kopaei and Miller’s (2016) test
statistic.</p></li>
<li><p>KKSA_pvalue: The p-value of Kharrati-Kopaei and
Sadooghi-Alvandi’s (2007) test.</p></li>
<li><p>KKSA_Stat: The value of Kharrati-Kopaei and
Sadooghi-Alvandi’s (2007) test statistic.</p></li>
<li><p>Franck_pvalue: The p-value of Franck, et al.’s (2013) test.</p></li>
<li><p>Franck_Stat: The value of Franck, et al.’s (2013) test
statistic.</p></li>
<li><p>Bonferroni: The combined p-value by using the Bonferroni method.</p></li>
<li><p>Sidak: The combined p-value by using the Sidak method.</p></li>
<li><p>Jacobi: The combined p-value by using the Jacobi method.</p></li>
<li><p>GC: The combined p-value by using the Gaussian copula.</p></li>
<li><p>data_name: The name of the input data set.</p></li>
<li><p>test: The name of the test.</p></li>
</ul></li>
</ul>
<div id="tab:1">
<table>
<caption>A summary of the functions in the combinIT package .</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Descriptions</th>
<th></th>
<th style="text-align: left;">Main outputs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Boik_test</td>
<td style="text-align: left;">Performs the Boik test</td>
<td>The data matrix, the number of Monte Carlo samples for calculating the exact p-value.</td>
<td style="text-align: left;">The value of test statistic, an asymptotic p-value, the exact Monte Carlo p-value.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Piepho_test</td>
<td style="text-align: left;">Performs the Piepho test</td>
<td>The data matrix, the number of Monte Carlo samples for calculating an exact p-value.</td>
<td style="text-align: left;">The value of test statistic, an asymptotic p-value, the exact Monte Carlo p-value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KKSA_test</td>
<td style="text-align: left;">Performs the KKSA test</td>
<td>The data matrix, the number of Monte Carlo samples for calculating the exact p-value, logical Elapsed_time for printing the progress.</td>
<td style="text-align: left;">The value of test statistic, an adjusted p-value, the exact Monte Carlo p-value.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Franck_test</td>
<td style="text-align: left;">Performs the Franck test</td>
<td>The data matrix, the number of Monte Carlo samples for calculating the exact p-value, logical Elapsed_time for printing the progress.</td>
<td style="text-align: left;">The value of test statistic, an adjusted p-value, the exact Monte Carlo p-value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malik_test</td>
<td style="text-align: left;">Performs the Malik test</td>
<td>The data matrix, the number of Monte Carlo samples for calculating the exact p-value, logical Elapsed_time for printing the progress.</td>
<td style="text-align: left;">The value of test statistic and the exact Monte Carlo p-value.</td>
</tr>
<tr class="even">
<td style="text-align: left;">KKM_test</td>
<td style="text-align: left;">Performs the KKM test</td>
<td>The data matrix, the number of Monte Carlo samples for calculating the exact p-value and the unbiasing constant.</td>
<td style="text-align: left;">The value of test statistic and the exact Monte Carlo p-value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CI_test</td>
<td style="text-align: left;">Performs the six NFBF tests and their combined tests</td>
<td>The data matrix, the number of Monte Carlo samples for calculating the exact p-value and the unbiasing constant, logical Elapsed_time for printing the progress.</td>
<td style="text-align: left;">The value of six test statistics, the exact Monte Carlo p-values of tests, and the result of four combined tests.</td>
</tr>
<tr class="even">
<td style="text-align: left;">interaction_plot</td>
<td style="text-align: left;">Plots the interaction plot</td>
<td>The matrix of data.</td>
<td style="text-align: left;">Interaction plot.</td>
</tr>
</tbody>
</table>
</div>
<p>The print method is developed for a brief displaying of these objects.
One of the key features of this package is to make it possible for users
to obtain accurate results for various tests within a reasonable time.
This feature was achieved by assigning the time-consuming parts of these
tests to several C++ functions that are called from R using Rcpp.</p>
<h2 data-number="4" id="using-the-package-combinit"><span class="header-section-number">4</span> Using the package combinIT</h2>
<p>Here, we illustrate the usage of the combinIT package. We also compare
the new package with hiddenf in terms of execution speed. For reference,
the functions of combinIT have been shown in Table
<a href="#tab:1" data-reference-type="ref" data-reference="tab:1">1</a>. This table also
presents some information about the inputs and outputs of functions.</p>
<p>We consider the copy number variation (CNV) data set that contains CNV
values for normal and tumor tissue samples among six dogs. In this data
set, the value of CNV was measured as a signal intensity obtained from a
comparative genomic hybridization (CGH) array, with higher signals
corresponding to higher copy numbers; see <span class="citation" data-cites="Franck:2013">Franck et al. (<a href="#ref-Franck:2013" role="doc-biblioref">2013</a>)</span> and
<span class="citation" data-cites="Osborne:2016">Osborne et al. (<a href="#ref-Osborne:2016" role="doc-biblioref">2016</a>)</span>. The following code loads the data and plots the
interaction plot. It can be seen from Figure
<a href="#fig:1" data-reference-type="ref" data-reference="fig:1">1</a> that a hidden
structure might exist (rows 4 and 5 are parallel and they interact with
rows 1, 2, 3, and 6).</p>
<div class="example">
<p>&gt; library(combinIT) &gt; data(CNV) &gt; interaction_plot(CNV)</p>
</div>
<figure id="fig:1">
<embed src="interactionplot1.pdf" style="width:14cm;height:6cm" />
<figcaption aria-hidden="true">The interaction plot of the CNV data.</figcaption>
</figure>
<p>Now, we use CI_test to combine the result of the six interaction tests
to see if there exists any significant interaction. We note that the
exact Monte Carlo p-values are obtained based on 10000 Monte Carlo
samples and hence the absolute error of Monte Carlo approximation is at
most <span class="math inline">\(0.0082\)</span> with the 0.95 confidence coefficient (following the
Central Limit Theorem). In addition, the p-value of the Boik test will
be 1 since <span class="math inline">\(p=1\)</span>. We also set <span class="math inline">\(\alpha=0.05\)</span> (as default to test at the
5% level) and report=TRUE (to provide a report on the test), and
opvalue=0.6187 as the p-value of the Tukey’s test (that is, we are going
to combine the p-value of the Tukey’s test in addition to the six
interaction tests).</p>
<div class="example">
<p>&gt; CI_test(CNV, nsim = 10000, alpha = 0.05, report = TRUE, nc0 = 10000,
opvalue = 0.6187, Elapsed_time = FALSE) Test: Combined interaction Test
Data: CNV Piepho Test: Statistic = 1.73949 , Pvalue = 0.8743 Boik Test:
Statistic = 1 , Pvalue = 1 Malik Test: Statistic = 526.66767 , Pvalue =
0.0289 KKM Test: Statistic = 1.18173 , Pvalue = 0.9994 KKSA Test:
Statistic = 0.0112 , Pvalue = 0.2092 Franck Test: Statistic = 526.66767
, Pvalue = 7e-04 Bonferroni method: Pvalue = 0.0049 Sidak method: Pvalue
= 0.00489 Jacobi method: Pvalue = 0.00419 Gaussian copula: Pvalue =
0.00491 ———————————————— A report on the
combined interaction test: A significant hidden structure exists at the
5 group includes rows: 4, 5. The second group includes rows: 1, 2, 3, 6.
The estimated critical value of the Franck_test at the 5 with 10000
Monte Carlo samples is 57.327.</p>
</div>
<p>The CI_test function has detected a significant interaction at the 5<span class="math inline">\(\%\)</span>
level and the detected interaction type is the hidden structure as we
expect. All combined tests report that there is a significant
interaction. It is worth mentioning that a significant interaction would
not be detected if only Boik or Piepho or KKM or KKSA test was used.
However, the combined tests provide researchers with much more
opportunity to detect a significant interaction. One can use the
Franck_test to analyze the hidden structure in the CNV data set in more
detail. The argument plot was set as TRUE to plot the interaction plot
in the Franck_test function. This interaction plot in Figure
<a href="#fig:2" data-reference-type="ref" data-reference="fig:2">2</a> shows that rows 4
and 5 are parallel (plotted in blue and solid line) and that they
interact with rows 1, 2, 3, and 6 (plotted in red and broken line).</p>
<figure id="fig:2">
<embed src="interactionplot2.pdf" />
<figcaption aria-hidden="true">The interaction plot of the CNV data to see the hidden structure of
interaction.</figcaption>
</figure>
<div class="example">
<p>&gt; Franck_test(CNV, nsim = 10000, alpha = 0.05, report = TRUE, plot =
TRUE, Elapsed_time = FALSE) Test: Franck Test Data: CNV Statistic =
526.668 Exact Monte Carlo P-value = 0 Approximate P-value = 0.001 Nsim =
10000 ————————————— A report on the test: A
significant hidden structure exists at the 5 group includes rows: 4, 5.
The second group includes rows: 1, 2, 3, 6. The estimated critical value
of the Franck_test at the 5 with 10000 Monte Carlo samples is 56.7246.</p>
</div>
<p>Although the other five interaction tests can be used individually to
test interaction, one should take care that a Type I error has not
resulted from the multiple tests that have been performed. Code for each
test is shown below.</p>
<div class="example">
<p>&gt; Boik_test(CNV, nsim = 10000, alpha = 0.05, report = TRUE) Test: Boik
Test Data: CNV Statistic = 1 Exact Monte Carlo P-value = 1 Approximate
P-value = 1 Nsim = 10000 ————————————— A
report on the test: The Boik_test could not detect any significant
interaction at the 5 level. The exact critical value of the Boik_test
is 1. &gt; Piepho_test(CNV, nsim = 10000, alpha =0.05, report = TRUE)
Test: Piepho Test Data: CNV Statistic = 1.739 Exact Monte Carlo P-value
= 0.878 Approximate P-value = 0.884 Nsim = 10000
————————————— A report on the test: The
Piepho_test could not detect any significant interaction at the 5 level
with 10000 Monte Carlo samples is 12.5169. &gt; KKSA_test(CNV, nsim =
10000, alpha = 0.05, report = TRUE, plot = FALSE, Elapsed_time = FALSE)
Test: KKSA Test Data: CNV Statistic = 0.011 Exact Monte Carlo P-value =
0.206 Approximate P-value = 0.28 Nsim = 10000
————————————— A report on the test: The
KKSA_test could not detect any significant interaction at the 5 level.
The estimated critical value of the KKSA_test at the 5 with 10000 Monte
Carlo samples is 0.0023. &gt; Malik_test(CNV, nsim = 10000, alpha = 0.05,
report = TRUE, Elapsed_time = FALSE) Test: Malik Test Data: CNV
Statistic = 526.668 Exact Monte Carlo P-value = 0.026 Approximate
P-value = NULL Nsim = 10000 ————————————— A
report on the test: There exists a significant interaction at the 5
significant interaction might due to the some outliers in residuals;
some cells produce large negative or positive residuals: The cell with
row=5 and column=1 produces a large negative residual The cell with
row=5 and column=2 produces a large positive residual The estimated
critical value of the Malik_test at the 5 10000 Monte Carlo samples is
362.0247. &gt; KKM_test(CNV, nsim = 10000, alpha = 0.05, report = TRUE,
nc0 = 10000) Test: KKM Test Data: CNV Statistic = 1.182 Exact Monte
Carlo P-value = 0.999 Approximate P-value = NULL Nsim = 10000
————————————— A report on the test: The
KKM_test could not detect any significant interaction at the 5 level.
The estimated critical value of the KKM_test at the 5 with 10000 Monte
Carlo samples is 4.2359.</p>
</div>
<p>As we see, Boik_test, Piepho_test, KKSA_test, and KKM_test could not
detect any significant interaction at the 5% level. However, Malik_test
is significant and the significant interaction is due to the cells
<span class="math inline">\(\left(5,1\right)\)</span> and <span class="math inline">\(\left(5,2\right)\)</span> that produce large negative
and positive residuals, respectively. Note that the KKSA_test has an
argument plot that if plot is TRUE an interaction plot will be plotted.
Color and line type are used to display which levels of row factor are
assigned to which sub-tables based on the minimum p-values among all
possible configurations. The values of the Monte Carlo p-value and the
adjusted p-value of the Franck test differ little (the presented values
were rounded up to three decimal digits and the actual value of the
Monte Carlo p-value is around 0.00069); on the other hand, they differ
for the KKSA test. This shows the importance of calculating the exact
Monte Carlo p-values, while the package hiddenf provides only the
adjusted p-values.</p>
<p>We now compare the execution speed of the Malik_test function in the
combinIT package with the MalikPavlue function in the hiddenf package.
To do this, we consider the CNV data again. We use the command
system.time in R to record the elapsed time of execution in seconds for
comparing the speed of execution. The elapsed time for 500 (the default
of the hiddenf package), 1000, 5000, 10000 (the default of the combinIT
package), 50000, and 100000 Monte Carlo samples are shown in Figure
<a href="#fig:3" data-reference-type="ref" data-reference="fig:3">3</a>. All computations
were done on a laptop with Windows 10 operating system, Intel(R)
Core(TM) i5-4200U CPU,1.60GHz 2.30 GHz processor, and 8G of RAM. The
following shows the R code used and the output for 500 Monte Carlo
samples.</p>
<div class="example">
<p>&gt; library(hiddenf) &gt; CNV.mtx&lt;-HiddenF(CNV) &gt; system.time( +
Malik_test(CNV,nsim=500,Elapsed_time = FALSE) + ) user system elapsed
0.15 0.13 0.22 &gt; system.time( + MalikPvalue(CNV.mtx,N=500) + ) (Pvalue
from Malik’s test estimated with N=500 Monte Carlo datasets) user system
elapsed 4.05 0.00 4.08</p>
</div>
<figure id="fig:3">
<embed src="elapsedtime.pdf" />
<figcaption aria-hidden="true">The elapsed time of executing MalikPvalue and Malik_test functions for
the CNV data.</figcaption>
</figure>
<p>It is seen that the run time of the Malik_test function is much shorter
than that of the MalikPvalue function. Actually, the run speed of the
Malik_test function is at least 18.5 times faster than the run speed of
the MalikPvalue function.</p>
<h2 data-number="5" id="simulation-study"><span class="header-section-number">5</span> Simulation study</h2>
<p>In this section, we examine the performance of the Bon, Sidak, JPE, and
GC methods in terms of controlling the Type I error rate using the
combinIT and hiddenf packages. Note that <span class="citation" data-cites="SKK:2018">Shenavari and Kharrati-Kopaei (<a href="#ref-SKK:2018" role="doc-biblioref">2018</a>)</span> evaluated the
performance of these methods for combining the p-values of the Boik,
Piepho, KKSA, Franck, KKM, and Malik tests. Here, in addition to the six
p-values, we consider the p-values of Tukey’s test and Mandel’s test
<span class="citation" data-cites="Tukey:1949 Mandel:1961">(<a href="#ref-Tukey:1949" role="doc-biblioref">Tukey 1949</a>; <a href="#ref-Mandel:1961" role="doc-biblioref">Mandel 1961</a>)</span> as the two other tests that may apply. We
used the following procedure to estimate the Type I error rate of the
combination methods. For given <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, an <span class="math inline">\(a\times b\)</span> data table is
generated from the standard normal distribution. We also took
<span class="math inline">\(\sigma^2=1\)</span> without loss of generality (since the tests are scale
invariant). For the computed interaction effects" changes to "For the
generated data table, the tests are done and their p-values are
recorded. For each method of combination, these p-values are combined
and the result of the combined test’s rejection of the null hypothesis
of no interaction is recorded. This process is repeated <span class="math inline">\(N1\)</span> times and
the fraction of times that the combined test rejects the null hypothesis
is calculated as an estimate of the Type I error rate of the combining
method.</p>
<p>The results of simulation for <span class="math inline">\(\alpha=0.10, 0.05, 0.01\)</span>, <span class="math inline">\(N1=10,000\)</span>,
and different values of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are shown in Table
<a href="#tab:2" data-reference-type="ref" data-reference="tab:2">2</a>. The exact Monte
Carlo p-values of tests were calculated based on <span class="math inline">\(N2=100,000\)</span> Monte
Carlo samples. In this table, the estimated absolute errors (EAE) in
estimating the Type I error rate with confidence coefficient 0.95 are
shown in parentheses. The value of EAE with confidence coefficient 0.95
is <span class="math inline">\(1.96\sqrt{\hat{\alpha}\left(1-\hat{\alpha}\right)/N1}\)</span> where
<span class="math inline">\(\hat{\alpha}\)</span> denotes the estimated Type I error rate.</p>
<div id="tab:2">
<table>
<caption>The estimated Type I error rates of the combined tests and their EAE
(the values in parentheses).</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\alpha\)</span></td>
<td style="text-align: left;"><span class="math inline">\(a\times b\)</span></td>
<td style="text-align: left;">Bon</td>
<td style="text-align: left;">Sidak</td>
<td style="text-align: left;">JPE</td>
<td style="text-align: left;">GC</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">\[5\]</span>*0.10</td>
<td style="text-align: left;"><span class="math inline">\(4\times3\)</span></td>
<td style="text-align: left;">(0.0049)</td>
<td style="text-align: left;">(0.0051)</td>
<td style="text-align: left;">(0.0054)</td>
<td style="text-align: left;">0.0770(0.0052)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(5\times3\)</span></td>
<td style="text-align: left;">(0.0051)</td>
<td style="text-align: left;">(0.0052)</td>
<td style="text-align: left;">(0.0055)</td>
<td style="text-align: left;">0.0784(0.0054)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(5\times5\)</span></td>
<td style="text-align: left;">(0.0052)</td>
<td style="text-align: left;">(0.0053)</td>
<td style="text-align: left;">(0.0055)</td>
<td style="text-align: left;">0.0799(0.0053)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(6\times6\)</span></td>
<td style="text-align: left;">(0.0051)</td>
<td style="text-align: left;">(0.0052)</td>
<td style="text-align: left;">(0.0055)</td>
<td style="text-align: left;">0.0764(0.0052)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">\[5\]</span>*0.05</td>
<td style="text-align: left;"><span class="math inline">\(4\times3\)</span></td>
<td style="text-align: left;">(0.0037)</td>
<td style="text-align: left;">(0.0037)</td>
<td style="text-align: left;">(0.0039)</td>
<td style="text-align: left;">0.0388(0.0038)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(5\times3\)</span></td>
<td style="text-align: left;">(0.0038)</td>
<td style="text-align: left;">(0.0038)</td>
<td style="text-align: left;">(0.0040)</td>
<td style="text-align: left;">0.0396(0.0038)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(5\times5\)</span></td>
<td style="text-align: left;">(0.0038)</td>
<td style="text-align: left;">(0.0038)</td>
<td style="text-align: left;">(0.0041)</td>
<td style="text-align: left;">0.0406(0.0039)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(6\times6\)</span></td>
<td style="text-align: left;">(0.0038)</td>
<td style="text-align: left;">(0.0038)</td>
<td style="text-align: left;">(0.0041)</td>
<td style="text-align: left;">0.0402(0.0038)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">\[5\]</span>*0.01</td>
<td style="text-align: left;"><span class="math inline">\(4\times3\)</span></td>
<td style="text-align: left;">(0.0019)</td>
<td style="text-align: left;">(0.0019)</td>
<td style="text-align: left;">(0.0020)</td>
<td style="text-align: left;">0.0091(0.0019)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(5\times3\)</span></td>
<td style="text-align: left;">(0.0017)</td>
<td style="text-align: left;">(0.0017)</td>
<td style="text-align: left;">(0.0018)</td>
<td style="text-align: left;">0.0079(0.0017)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(5\times5\)</span></td>
<td style="text-align: left;">(0.0019)</td>
<td style="text-align: left;">(0.0019)</td>
<td style="text-align: left;">(0.0020)</td>
<td style="text-align: left;">0.0092(0.0019)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(6\times6\)</span></td>
<td style="text-align: left;">(0.0018)</td>
<td style="text-align: left;">(0.0018)</td>
<td style="text-align: left;">(0.0019)</td>
<td style="text-align: left;">0.0086(0.0018)</td>
</tr>
</tbody>
</table>
</div>
<p>It is seen from Table <a href="#tab:2" data-reference-type="ref" data-reference="tab:2">2</a> that the combining methods control the Type I error
rate. This shows that these methods can be used for combining the
p-values of the other tests successfully that may be introduced in the
future. Among these four combination methods, the JPE method performs
better than the others since the values of its estimated Type I error
are fairly close to the nominal Type I error. We did not examine the
performance of methods in terms of detecting a significant interaction
power, because the considered methods do not have the same estimated
Type I error rate (The JPE method would have the highest power, because
its estimated Type I error rate is higher than the other methods; see
also Note 2).</p>
<h2 data-number="6" id="summary"><span class="header-section-number">6</span> Summary</h2>
<p>We reviewed six recommended interaction tests in the context of
unreplicated two-way ANOVA models and four combination methods for
combining dependent interaction tests. Then, we introduced the combinIT
package and demonstrated that the advantages of this package over the
two existing packages are: (i) it reports test statistics, estimated
critical value, approximate p-values, and exact Monte Carlo p-values of
six recommended NFBF interaction tests, (ii) it provides the results of
the four combined interaction tests in addition to some descriptions of
detected significant interaction patterns, and (iii) its execution is
fast enough to make it feasible to calculate the exact Monte Carlo
p-values. Using the combinIT package, we evaluated the performance of
the four combined tests in terms of controlling the Type I error rate.
Simulation results show that the combined tests control the Type I error
rate, and therefore can be used as an interaction test that leverages
existing methods to detect different patterns of non-additivity.</p>
<p>We note that the combinIT package can handle data sets as large as
<span class="math inline">\(15\times15\)</span>, although performing the KKSA and Franck tests may be
time-consuming when the size of the data set is larger. We will focus on
solving this problem in the next version of the package.</p>
<h2 data-number="7" id="acknowledgment"><span class="header-section-number">7</span> Acknowledgment</h2>
<p>The first author would like to acknowledge the Research Council of
Shiraz University.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="7.1" id="supplementary-materials"><span class="header-section-number">7.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-037.zip">RJ-2023-037.zip</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-AK:2006" class="csl-entry" role="listitem">
A. Alin and S. Kurt. Testing non-additivity (interaction) in two-way ANOVA tables with no replication. <em>Statistical Methods in Medical Research</em>, 15(1): 63–85, 2006. URL <a href="https://doi.org/10.1191/0962280206sm426oa">https://doi.org/10.1191/0962280206sm426oa</a>. PMID: 16477949.
</div>
<div id="ref-Boik:1993b" class="csl-entry" role="listitem">
R. J. Boik. A comparison of three invariant tests of additivity in two-way classifications with no replications. <em>Computational Statistics and Data Analysis</em>, 15: 411–424, 1993a. URL <a href="https://doi.org/10.1016/0167-9473(93)90173-Q">https://doi.org/10.1016/0167-9473(93)90173-Q</a>.
</div>
<div id="ref-Boik:1993" class="csl-entry" role="listitem">
R. J. Boik. Testing additivity in two-way classifications with no replications:the locally best invariant test. <em>Journal of Applied Statistics</em>, 20(1): 41–55, 1993b. URL<a href="
        https://doi.org/10.1080/02664769300000004

">
https://doi.org/10.1080/02664769300000004
</a>.
</div>
<div id="ref-CE:1974" class="csl-entry" role="listitem">
L. C. A. Corsten and A. C. van Eijnsbergen. Addendum to <span>“multiplicative effects in two-way analysis of variance.”</span> <em>Statistica Neerlandica</em>, 28(1): 51–51, 1974. URL <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9574.1974.tb00231.x">https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9574.1974.tb00231.x</a>.
</div>
<div id="ref-CE:1972" class="csl-entry" role="listitem">
L. C. A. Corsten and A. C. van Eijnsbergen. Multiplicative effects in two-way analysis of variance. <em>Statistica Neerlandica</em>, 26(3): 61–68, 1972. URL <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9574.1972.tb00173.x">https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9574.1972.tb00173.x</a>.
</div>
<div id="ref-RcppBook" class="csl-entry" role="listitem">
D. Eddelbuettel. <em>Seamless <span>R</span> and <span>C++</span> integration with <span>Rcpp</span>.</em> New York: Springer, 2013. URL <a href="https://doi.org/10.1007/978-1-4614-6868-4">https://doi.org/10.1007/978-1-4614-6868-4</a>. ISBN 978-1-4614-6867-7.
</div>
<div id="ref-RcppArticle2" class="csl-entry" role="listitem">
D. Eddelbuettel and J. J. Balamuta. <span class="nocase">Extending extit<span>R</span> with extit<span>C++</span>: A Brief Introduction to extit<span>Rcpp</span></span>. <em>The American Statistician</em>, 72(1): 28–36, 2018. URL <a href="https://doi.org/10.1080/00031305.2017.1375990">https://doi.org/10.1080/00031305.2017.1375990</a>.
</div>
<div id="ref-RcppArticle1" class="csl-entry" role="listitem">
D. Eddelbuettel and R. François. <span>Rcpp</span>: Seamless <span>R</span> and <span>C++</span> integration. <em>Journal of Statistical Software</em>, 40(8): 1–18, 2011. URL<a href=" https://doi.org/10.18637/jss.v040.i08"> https://doi.org/10.18637/jss.v040.i08</a>.
</div>
<div id="ref-Franck:2013" class="csl-entry" role="listitem">
C. T. Franck, D. M. Nielsen and J. A. Osborne. A method for detecting hidden additivity in two-factor unreplicated experiments. <em>Computational Statistics and Data Analysis</em>, 67: 95–104, 2013. URL <a href="http://dx.doi.org/10.1016/j.csda.2013.05.002">http://dx.doi.org/10.1016/j.csda.2013.05.002</a>.
</div>
<div id="ref-Franck:2016" class="csl-entry" role="listitem">
C. T. Franck and J. A. Osborne. Exploring interaction effects in two-factor studies using the hiddenf package in r. <em>The R Journal</em>, 8(1): 159–172, 2016. URL <a href="https://doi.org/10.32614/RJ-2016-011">https://doi.org/10.32614/RJ-2016-011</a>.
</div>
<div id="ref-JG:1972" class="csl-entry" role="listitem">
D. E. Johnson and F. A. Graybill. An analysis of a two-way model with interaction and no replication. <em>Journal of the American Statistical Association</em>, 67(340): 862–868, 1972. URL <a href="http://www.jstor.org/stable/2284651">http://www.jstor.org/stable/2284651</a> [online; last accessed April 16, 2022].
</div>
<div id="ref-KKM:2016" class="csl-entry" role="listitem">
M. Kharrati-Kopaei and A. Miller. A method for testing interaction in unreplicated two-way tables: Using all pairwise interaction contrasts. <em>Journal of Statistical Computation and Simulation</em>, 86(6): 1203–1215, 2016. URL<a href="
        https://doi.org/10.1080/00949655.2015.1057821

">
https://doi.org/10.1080/00949655.2015.1057821
</a>.
</div>
<div id="ref-KKSA:2007" class="csl-entry" role="listitem">
M. Kharrati-Kopaei and S. M. Sadooghi-Alvandi. A new method for testing interaction in unreplicated two-way analysis of variance. <em>Communications in Statistics - Theory and Methods</em>, 36: 2787–2803, 2007. URL <a href="https://doi.org/10.1080/03610920701386851">https://doi.org/10.1080/03610920701386851</a>.
</div>
<div id="ref-Malik:2016" class="csl-entry" role="listitem">
W. A. Malik, J. Möhring and H. P. Piepho. A clustering-based test for nonadditivity in an unreplicated two-way layout. <em>Communications in Statistics - Simulation and Computation</em>, 45(2): 660–670, 2016. URL<a href="
        https://doi.org/10.1080/03610918.2013.870196">
https://doi.org/10.1080/03610918.2013.870196</a>.
</div>
<div id="ref-Mandel:1971" class="csl-entry" role="listitem">
J. Mandel. A new analysis of variance model for non-additive data. <em>Technometrics</em>, 13(1): 1–18, 1971. URL<a href="
        https://www.tandfonline.com/doi/abs/10.1080/00401706.1971.10488751
">
https://www.tandfonline.com/doi/abs/10.1080/00401706.1971.10488751
</a>.
</div>
<div id="ref-Mandel:1961" class="csl-entry" role="listitem">
J. Mandel. Non-additivity in two-way analysis of variance. <em>Journal of the American Statistical Association</em>, 56(296): 878–888, 1961. URL<a href="
        https://www.tandfonline.com/doi/abs/10.1080/01621459.1961.10482132
">
https://www.tandfonline.com/doi/abs/10.1080/01621459.1961.10482132
</a>.
</div>
<div id="ref-MJ:1989" class="csl-entry" role="listitem">
G. A. Milliken and D. E. Johnson. <em>Analysis of messy data, volume II: Nonreplicated experiments.</em> 1st ed Chapman; Hall/CRC, 1989. URL <a href="https://doi.org/10.1201/9781315172194">https://doi.org/10.1201/9781315172194</a>.
</div>
<div id="ref-MR:1977" class="csl-entry" role="listitem">
G. A. Milliken and D. M. Rasmuson. A HEURISTIC TECHNIQUE FOR TESTING FOR THE PRESENCE OF INTERACTION IN NONREPLICATED FACTORIAL EXPERIMENTS. <em>Australian and New Zealand Journal of Statistics</em>, 19: 32–38, 1977. URL <a href="https://onlinelibrary.wiley.com/doi/10.1111/j.1467-842X.1994.tb00889.x">https://onlinelibrary.wiley.com/doi/10.1111/j.1467-842X.1994.tb00889.x</a>.
</div>
<div id="ref-Montgomery:2017" class="csl-entry" role="listitem">
D. C. Montgomery. <em>Design and analysis of experiments.</em> Hoboken, NJ, USA: John Wiley; Sons, Inc., 2017.
</div>
<div id="ref-Osborne:2016" class="csl-entry" role="listitem">
J. A. Osborne, C. T. Franck and B. Choi. <em>Hiddenf: The all-configurations, maximum-interaction f-test for hidden additivity.</em> 2016. URL <a href="https://CRAN.R-project.org/package=hiddenf">https://CRAN.R-project.org/package=hiddenf</a>. R package version 2.0.
</div>
<div id="ref-Piepho:1994" class="csl-entry" role="listitem">
H.-P. Piepho. ON TESTS FOR INTERACTION IN a NONREPLICATED TWO-WAY LAYOUT. <em>Australian Journal of Statistics</em>, 36(3): 363–369, 1994. URL <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-842X.1994.tb00889.x">https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-842X.1994.tb00889.x</a>.
</div>
<div id="ref-SAKK:2015" class="csl-entry" role="listitem">
S. M. Sadooghi-Alvandi and M. Kharrati-Kopaei. Testing three-factor interaction in unreplicated three-way layouts. <em>Communications in Statistics - Theory and Methods</em>, 44(3): 587–606, 2015. URL<a href="
        https://doi.org/10.1080/03610926.2012.748915

">
https://doi.org/10.1080/03610926.2012.748915
</a>.
</div>
<div id="ref-SHKKN:2022" class="csl-entry" role="listitem">
Z. Shenavari, H. Haghbin, M. Kharrati-Kopaei and S. M. Najibi. <em>combinIT: A combined interaction test for unreplicated two-way tables.</em> 2022. URL <a href="https://CRAN.R-project.org/package=combinIT">https://CRAN.R-project.org/package=combinIT</a>. R package version 2.0.0.
</div>
<div id="ref-SKK:2018" class="csl-entry" role="listitem">
Z. Shenavari and M. Kharrati-Kopaei. A method for testing additivity in unreplicated two-way layouts based on combining multiple interaction tests. <em>International Statistical Review</em>, 86(3): 469–487, 2018. URL <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/insr.12262">https://onlinelibrary.wiley.com/doi/abs/10.1111/insr.12262</a>.
</div>
<div id="ref-SS:2013" class="csl-entry" role="listitem">
P. Simecek and M. Simeckova. Modification of tukey’s additivity test. <em>Journal of Statistical Planning and Inference</em>, 143: 197–201, 2013. URL <a href="https://doi.org/10.1016/j.jspi.2012.07.002">https://doi.org/10.1016/j.jspi.2012.07.002</a>.
</div>
<div id="ref-SRS:2014" class="csl-entry" role="listitem">
M. Simeckova, T. Rusch and P. Simecek. <em>additivityTests: Additivity tests in the two way anova with single sub-class numbers.</em> 2014. URL <a href="https://CRAN.R-project.org/package=additivityTests">https://CRAN.R-project.org/package=additivityTests</a>. R package version 1.1-4.
</div>
<div id="ref-Tukey:1949" class="csl-entry" role="listitem">
J. W. Tukey. One degree of freedom for non-additivity. <em>Biometrics</em>, 5(3): 232–242, 1949. URL <a href="http://www.jstor.org/stable/3001938">http://www.jstor.org/stable/3001938</a> [online; last accessed April 13, 2022].
</div>
<div id="ref-Tusell:1990" class="csl-entry" role="listitem">
F. Tusell. Testing for interaction in two-way ANOVA tables with no replication. <em>Computational Statistics and Data Analysis</em>, 10(1): 29–45, 1990. URL <a href="https://www.sciencedirect.com/science/article/pii/016794739090101M">https://www.sciencedirect.com/science/article/pii/016794739090101M</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Kharrati-Kopaei, et al., "combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-037,
  author = {Kharrati-Kopaei, Mahmood and Shenavari, Zahra and Haghbin, Hossein},
  title = {combinIT: An R Package for Combining Interaction Tests for Unreplicated Two-Way Tables},
  journal = {The R Journal},
  year = {2023},
  note = {https://doi.org/10.32614/RJ-2023-037},
  doi = {10.32614/RJ-2023-037},
  volume = {15},
  issue = {1},
  issn = {2073-4859},
  pages = {284-296}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
