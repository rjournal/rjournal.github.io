<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>The R Journal: hydrotoolbox, a Package for Hydrometeorological Data Management</title>

<meta property="description" itemprop="description" content="The hydrometeorological data provided by federal agencies, research groups and private companies tend to be heterogeneous: records are kept in different formats, quality control processes are not standardized and may even vary within a given agency, variables are not always recorded with the same temporal resolution, and there are data gaps and incorrectly recorded values. Once these problems are dealt with, it is useful to have tools to safely store and manipulate the series, providing temporal aggregation, interactive visualization for analysis, static graphics to publish and/or communicate results, techniques to correct and/or modify the series, among others. Here we introduce a package written in the R language using object-oriented programming and designed to accomplish these objectives, giving to the user a general framework for working with any kind of hydrometeorological series. We present the package design, its strengths, limitations and show its application for two real cases."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-041/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-11-01"/>
<meta property="article:created" itemprop="dateCreated" content="2023-11-01"/>
<meta name="article:author" content="Ezequiel Toum"/>
<meta name="article:author" content="Pierre Pitte"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="The R Journal: hydrotoolbox, a Package for Hydrometeorological Data Management"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="The hydrometeorological data provided by federal agencies, research groups and private companies tend to be heterogeneous: records are kept in different formats, quality control processes are not standardized and may even vary within a given agency, variables are not always recorded with the same temporal resolution, and there are data gaps and incorrectly recorded values. Once these problems are dealt with, it is useful to have tools to safely store and manipulate the series, providing temporal aggregation, interactive visualization for analysis, static graphics to publish and/or communicate results, techniques to correct and/or modify the series, among others. Here we introduce a package written in the R language using object-oriented programming and designed to accomplish these objectives, giving to the user a general framework for working with any kind of hydrometeorological series. We present the package design, its strengths, limitations and show its application for two real cases."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-041/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2023-041/flow_diagram_classes_crop.png"/>
<meta property="og:image:width" content="589"/>
<meta property="og:image:height" content="151"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="The R Journal: hydrotoolbox, a Package for Hydrometeorological Data Management"/>
<meta property="twitter:description" content="The hydrometeorological data provided by federal agencies, research groups and private companies tend to be heterogeneous: records are kept in different formats, quality control processes are not standardized and may even vary within a given agency, variables are not always recorded with the same temporal resolution, and there are data gaps and incorrectly recorded values. Once these problems are dealt with, it is useful to have tools to safely store and manipulate the series, providing temporal aggregation, interactive visualization for analysis, static graphics to publish and/or communicate results, techniques to correct and/or modify the series, among others. Here we introduce a package written in the R language using object-oriented programming and designed to accomplish these objectives, giving to the user a general framework for working with any kind of hydrometeorological series. We present the package design, its strengths, limitations and show its application for two real cases."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-041/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2023-041/flow_diagram_classes_crop.png"/>
<meta property="twitter:image:width" content="589"/>
<meta property="twitter:image:height" content="151"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="The R Journal: hydrotoolbox, a Package for Hydrometeorological Data Management"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-041"/>
<meta name="citation_pdf_url" content="RJ-2023-041.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="2"/>
<meta name="citation_doi" content="10.32614/RJ-2023-041"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="25"/>
<meta name="citation_lastpage" content="38"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/11/01"/>
<meta name="citation_publication_date" content="2023/11/01"/>
<meta name="citation_author" content="Ezequiel Toum"/>
<meta name="citation_author_institution" content="IANIGLA-CONICET"/>
<meta name="citation_author" content="Pierre Pitte"/>
<meta name="citation_author_institution" content="IANIGLA-CONICET"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=The tidyverse style guide;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=When All Science Becomes Data Science;citation_author=Vijaysree Venkatraman"/>
  <meta name="citation_reference" content="citation_title=50 Years of Data Science;citation_volume=26;citation_doi=10.1080/10618600.2017.1384734;citation_issn=1061-8600;citation_author=David Donoho"/>
  <meta name="citation_reference" content="citation_title=Rainfall - Runoff Modelling;citation_publisher=Wiley;citation_author=Keith J. Beven"/>
  <meta name="citation_reference" content="citation_title=Hddtools: Hydrological data discovery tools;citation_publisher=The Open Journal;citation_volume=2;citation_doi=10.21105/joss.00056;citation_author=Claudia Vitolo"/>
  <meta name="citation_reference" content="citation_title=Climate: An R Package to Access Free In-Situ Meteorological and Hydrological Datasets For Environmental Assessment;citation_volume=12;citation_doi=10.3390/su12010394;citation_issn=2071-1050;citation_author=Bartosz Czernecki;citation_author=Arkadiusz Głogowski;citation_author=Jakub Nowosad"/>
  <meta name="citation_reference" content="citation_title=waterData: Retrieval, analysis, and anomaly calculation of daily hydrologic time series data;citation_author=Karen R. Ryberg;citation_author=Aldo V. Vecchia"/>
  <meta name="citation_reference" content="citation_title=hydroTSM: Time series management, analysis and interpolation for hydrological modelling;citation_author=Mauricio Zambrano-Bigiarini"/>
  <meta name="citation_reference" content="citation_title=dataRetrieval: R packages for discovering and retrieving water data available from u.s. Federal hydrologic web services;citation_publisher=U.S. Geological Survey; U.S. Geological Survey;citation_doi=10.5066/P9X4L3GE;citation_author=Laura A. De Cicco;citation_author=David Lorenz;citation_author=Robert M. Hirsch;citation_author=William Watkins;citation_author=Mike Johnson"/>
  <meta name="citation_reference" content="citation_title=Hyfo: Hydrology and climate forecasting;citation_author=Yuanchao Xu"/>
  <meta name="citation_reference" content="citation_title=Extending R;citation_publisher=CRC Press;citation_author=John M. Chambers"/>
  <meta name="citation_reference" content="citation_title=Using R in hydrology: A review of recent developments and future directions;citation_doi=https://doi.org/10.5194/hess-2019-50;citation_issn=1027-5606;citation_author=Louise J. Slater;citation_author=Guillaume Thirel;citation_author=Shaun Harrigan;citation_author=Olivier Delaigue;citation_author=Alexander Hurley;citation_author=Abdou Khouakhi;citation_author=Ilaria Prodoscimi;citation_author=Claudia Vitolo;citation_author=Katie Smith"/>
  <meta name="citation_reference" content="citation_title=HBV.IANIGLA: Modular hydrological model;citation_author=Ezequiel Toum"/>
  <meta name="citation_reference" content="citation_title=Most computational hydrology is not reproducible, so is it really science?;citation_volume=52;citation_doi=10.1002/2016WR019285;citation_issn=1944-7973;citation_author=Christopher Hutton;citation_author=Thorsten Wagener;citation_author=Jim Freer;citation_author=Dawei Han;citation_author=Chris Duffy;citation_author=Berit Arheimer"/>
  <meta name="citation_reference" content="citation_title=WMO Solid Precipitation Measurement Intercomparison;citation_publisher=WMO;citation_number=67;citation_author= Goodinson;citation_author= Louie"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Elegant graphics for data analysis;citation_publisher=Springer-Verlag New York;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Interactive web-based data visualization with r, plotly, and shiny;citation_publisher=Chapman; Hall/CRC;citation_author=Carson Sievert"/>
  <meta name="citation_reference" content="citation_title=Tidyhydat: Extract and tidy canadian hydrometric data;citation_publisher=The Open Journal;citation_volume=2;citation_doi=10.21105/joss.00511;citation_author=Sam Albers"/>
  <meta name="citation_reference" content="citation_title=weathercan: Download and format weather data from environment and climate change canada;citation_volume=3;citation_author=Stefanie E LaZerte;citation_author=Sam Albers"/>
  <meta name="citation_reference" content="citation_title=Raster: Geographic data analysis and modeling;citation_author=Robert J. Hijmans"/>
  <meta name="citation_reference" content="citation_title=ncdf4: Interface to unidata netCDF (version 4 or earlier) format data files;citation_author=David Pierce"/>
  <meta name="citation_reference" content="citation_title=System for Automated Geoscientific Analyses (SAGA) v. 2.1.4;citation_volume=8;citation_doi=https://doi.org/10.5194/gmd-8-1991-2015;citation_issn=1991-959X;citation_author=O. Conrad;citation_author=B. Bechtel;citation_author=M. Bock;citation_author=H. Dietrich;citation_author=E. Fischer;citation_author=L. Gerlitz;citation_author=J. Wehberg;citation_author=V. Wichmann;citation_author=J. Böhner"/>
  <meta name="citation_reference" content="citation_title=Hydrotoolbox: Hydrological tools for handling hydro-meteorological data records;citation_author=Ezequiel Toum"/>
  <meta name="citation_reference" content="citation_title=The HBV.IANIGLA Hydrological Model;citation_volume=13;citation_doi=10.32614/RJ-2021-059;citation_author=Ezequiel Toum;citation_author=Mariano H. Masiokas;citation_author=Ricardo Villalba;citation_author=Pierre Pitte;citation_author=Lucas Ruiz"/>
  <meta name="citation_reference" content="citation_title=Large-sample hydrology: Recent progress, guidelines for new datasets and grand challenges;citation_volume=65;citation_doi=10.1080/02626667.2019.1683182;citation_issn=0262-6667;citation_author=Nans Addor;citation_author=Hong X. Do;citation_author=Camila Alvarez-Garreton;citation_author=Gemma Coxon;citation_author=Keirnan Fowler;citation_author=Pablo A. Mendoza"/>
  <meta name="citation_reference" content="citation_title=Simple Features for R: Standardized Support for Spatial Vector Data;citation_volume=10;citation_doi=10.32614/RJ-2018-009;citation_author=Edzer Pebesma"/>
  <meta name="citation_reference" content="citation_title=The CAMELS-CL dataset: Catchment attributes and meteorology for large sample studies – Chile dataset;citation_volume=22;citation_doi=https://doi.org/10.5194/hess-22-5817-2018;citation_issn=1027-5606;citation_author=Camila Alvarez-Garreton;citation_author=Pablo A. Mendoza;citation_author=Juan Pablo Boisier;citation_author=Nans Addor;citation_author=Mauricio Galleguillos;citation_author=Mauricio Zambrano-Bigiarini;citation_author=Antonio Lara;citation_author=Cristóbal Puelma;citation_author=Gonzalo Cortes;citation_author=Rene Garreaud;citation_author=James McPhee;citation_author=Alvaro Ayala"/>
  <meta name="citation_reference" content="citation_title=The CAMELS data set: Catchment attributes and meteorology for large-sample studies;citation_volume=21;citation_doi=10.5194/hess-21-5293-2017;citation_issn=1027-5606;citation_author=Nans Addor;citation_author=Andrew J. Newman;citation_author=Naoki Mizukami;citation_author=Martyn P. Clark"/>
  <meta name="citation_reference" content="citation_title=R for Data Science: Import, Tidy, Transform, Visualize, and Model Data;citation_publisher=O’Reilly Media;citation_author=Hadley Wickham;citation_author=Garrett Grolemund"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","draft","author","type","output","bibliography","editor_options","date","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["hydrotoolbox, a Package for Hydrometeorological Data Management"]},{"type":"character","attributes":{},"value":["The hydrometeorological data provided by federal agencies, research groups and private companies tend to be heterogeneous: records are kept in different formats, quality control processes are not standardized and may even vary within a given agency, variables are not always recorded with the same temporal resolution, and there are data gaps and incorrectly recorded values. Once these problems are dealt with, it is useful to have tools to safely store and manipulate the series, providing temporal aggregation, interactive visualization for analysis, static graphics to publish and/or communicate results, techniques to correct and/or modify the series, among others. Here we introduce a package written in the R language using object-oriented programming and designed to accomplish these objectives, giving to the user a general framework for working with any kind of hydrometeorological series. We present the package design, its strengths, limitations and show its application for two real cases."]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Ezequiel Toum"]},{"type":"character","attributes":{},"value":["IANIGLA-CONICET"]},{"type":"character","attributes":{},"value":["Av. Ruiz Leal s/n Parque General San Martin - Mendoza","Argentina"]},{"type":"character","attributes":{},"value":["0000-0002-4482-0559"]},{"type":"character","attributes":{},"value":["etoum@mendoza-conicet.gob.ar"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Pierre Pitte"]},{"type":"character","attributes":{},"value":["IANIGLA-CONICET"]},{"type":"character","attributes":{},"value":["Av. Ruiz Leal s/n Parque General San Martin - Mendoza","Argentina"]},{"type":"character","attributes":{},"value":["0000-0001-5625-8287"]},{"type":"character","attributes":{},"value":["pierrepitte@mendoza-conicet.gob.ar"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["markdown"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["wrap"]}},"value":[{"type":"integer","attributes":{},"value":[72]}]}]},{"type":"character","attributes":{},"value":["2023-11-01"]},{"type":"character","attributes":{},"value":["2021-11-08"]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[2]},{"type":"character","attributes":{},"value":["RJ-2023-041"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[25]},{"type":"integer","attributes":{},"value":[38]}]},{"type":"character","attributes":{},"value":["RJ-2023-041.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-041"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-041"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["waterData","hydroTSM","dataRetrieval","hyfo","hydrotoolbox","HBV.IANIGLA","ggplot2","plotly","dplyr","tidyhydat","hydroToolkit","leaflet","raster","sf"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["Databases","Hydrology","ModelDeployment","Phylogenetics","Spatial","SpatioTemporal","TeachingStatistics","WebTechnologies"]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-041/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["00render-pdf.log","00render-web.log","data/cuevas_mb.rds","data/h_relativa_cuevas.csv","data/mnemos_guido.xlsx","data/p_atm_cuevas.csv","data/precip_total_cuevas.csv","data/temp_aire_cuevas.csv","data/vel_viento_cuevas.csv","DESCRIPTION","distill-preview.png","flow_diagram_classes_crop.png","graphical_abstract.png","mza_basin.png","pdf-OK","readr_like.png","readxl_like.png","RJ-2023-041_files/anchor-4.2.2/anchor.min.js","RJ-2023-041_files/bowser-1.9.3/bowser.min.js","RJ-2023-041_files/crosstalk-1.2.0/css/crosstalk.min.css","RJ-2023-041_files/crosstalk-1.2.0/js/crosstalk.js","RJ-2023-041_files/crosstalk-1.2.0/js/crosstalk.js.map","RJ-2023-041_files/crosstalk-1.2.0/js/crosstalk.min.js","RJ-2023-041_files/crosstalk-1.2.0/js/crosstalk.min.js.map","RJ-2023-041_files/crosstalk-1.2.0/scss/crosstalk.scss","RJ-2023-041_files/distill-2.2.21/template.v2.js","RJ-2023-041_files/figure-html5/cuevas-mb-1.png","RJ-2023-041_files/figure-html5/guido-ggplot-1.png","RJ-2023-041_files/figure-latex/cuevas-mb-1.pdf","RJ-2023-041_files/figure-latex/guido-ggplot-1.pdf","RJ-2023-041_files/figure-latex/guido-plot-static-1.pdf","RJ-2023-041_files/header-attrs-2.25/header-attrs.js","RJ-2023-041_files/htmlwidgets-1.6.2/htmlwidgets.js","RJ-2023-041_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2023-041_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2023-041_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2023-041_files/kePrint-0.0.1/kePrint.js","RJ-2023-041_files/lightable-0.0.1/lightable.css","RJ-2023-041_files/plotly-binding-4.10.2/plotly.js","RJ-2023-041_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css","RJ-2023-041_files/plotly-main-2.11.1/plotly-latest.min.js","RJ-2023-041_files/popper-2.6.0/popper.min.js","RJ-2023-041_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2023-041_files/tippy-6.2.7/tippy-light-border.css","RJ-2023-041_files/tippy-6.2.7/tippy.css","RJ-2023-041_files/tippy-6.2.7/tippy.umd.min.js","RJ-2023-041_files/typedarray-0.1/typedarray.min.js","RJ-2023-041_files/webcomponents-2.0.0/webcomponents.js","RJ-2023-041.log","RJ-2023-041.pdf","RJ-2023-041.tex","RJ-2023-041.zip","RJournal.sty","RJreferences.bib","RJwrapper.aux","RJwrapper.log","RJwrapper.out","RJwrapper.tex","Rlogo-5.png","scripts/hydrotoolbox.R","toum_files/figure-html5/cuevas-mb-1.png","toum_files/figure-html5/guido-ggplot-1.png","toum_files/figure-latex/cuevas-mb-1.pdf","toum_files/figure-latex/guido-ggplot-1.pdf","toum_files/figure-latex/guido-plot-static-1.pdf","toum.log","toum.sty","toum.tex","web-OK"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
  <script src="../../site_libs/plotly-binding-4.10.2/plotly.js"></script>
  <script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
  <script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  <link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
  <script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')


      const abstract = $('<d-abstract>')
      abstract.append('<b>Abstract:</b><br>')
      abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
      $("d-title p:empty").remove() // Remove empty paragraphs after title
      abstract.append(buttons)
      abstract.insertAfter($('d-title')) // Add abstract section after title

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"hydrotoolbox, a Package for Hydrometeorological Data Management","description":"The hydrometeorological data provided by federal agencies, research groups and private companies tend to be heterogeneous: records are kept in different formats, quality control processes are not standardized and may even vary within a given agency, variables are not always recorded with the same temporal resolution, and there are data gaps and incorrectly recorded values. Once these problems are dealt with, it is useful to have tools to safely store and manipulate the series, providing temporal aggregation, interactive visualization for analysis, static graphics to publish and/or communicate results, techniques to correct and/or modify the series, among others. Here we introduce a package written in the R language using object-oriented programming and designed to accomplish these objectives, giving to the user a general framework for working with any kind of hydrometeorological series. We present the package design, its strengths, limitations and show its application for two real cases.","doi":"10.32614/RJ-2023-041","authors":[{"author":"Ezequiel Toum","authorURL":"#","affiliation":"IANIGLA-CONICET","affiliationURL":"#","orcidID":"0000-0002-4482-0559"},{"author":"Pierre Pitte","authorURL":"#","affiliation":"IANIGLA-CONICET","affiliationURL":"#","orcidID":"0000-0001-5625-8287"}],"publishedDate":"2023-11-01T00:00:00.000+00:00","citationText":"Toum & Pitte, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../issues/2023-1">Current</a>
<a href="../../submissions.html">Submit</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>hydrotoolbox, a Package for Hydrometeorological Data Management</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>The hydrometeorological data provided by federal agencies, research groups and private companies tend to be heterogeneous: records are kept in different formats, quality control processes are not standardized and may even vary within a given agency, variables are not always recorded with the same temporal resolution, and there are data gaps and incorrectly recorded values. Once these problems are dealt with, it is useful to have tools to safely store and manipulate the series, providing temporal aggregation, interactive visualization for analysis, static graphics to publish and/or communicate results, techniques to correct and/or modify the series, among others. Here we introduce a package written in the R language using object-oriented programming and designed to accomplish these objectives, giving to the user a general framework for working with any kind of hydrometeorological series. We present the package design, its strengths, limitations and show its application for two real cases.</p></p>
</div>

<div class="d-byline">
  Ezequiel Toum  (IANIGLA-CONICET)
  
,   Pierre Pitte  (IANIGLA-CONICET)
  
<br/>2023-11-01
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Data management has generated growing interest among the scientific community
<span class="citation" data-cites="venkatraman:2013 donoho:2017">(<a href="#ref-venkatraman:2013" role="doc-biblioref">Venkatraman 2013</a>; <a href="#ref-donoho:2017" role="doc-biblioref">Donoho 2017</a>)</span>, driven by the proliferation of
data sharing through the internet, new
measurement techniques and equipment, and open and free access to
information obtained from remote sensing. It is also fueled by new and
growing demands from agencies and governments (national and/or regional)
for data-informed decision-making. To realize the full potential of
the available information, there is a need for accurate and efficient
tools that can pre-process these vast and heterogeneous data into more
convenient data sets <span class="citation" data-cites="addor:2020">(<a href="#ref-addor:2020" role="doc-biblioref">Addor et al. 2020</a>)</span>.<br />
The hydrological community uses data from hydrometeorological stations,
remote sensing observations and outputs from climatic and/or
hydrological models <span class="citation" data-cites="beven:2012">(<a href="#ref-beven:2012" role="doc-biblioref">Beven 2012</a>)</span>. These data types may include (but
are not limited to):</p>
<ol type="a">
<li><p><strong>remote sensing</strong>: snow cover images, soil humidity, glacier cover
areas, digital elevation models.</p></li>
<li><p><strong>hydro-met stations</strong>: air temperature, relative humidity, incoming
solar radiation, atmospheric pressure, precipitation, streamflow
records.</p></li>
<li><p><strong>numerical weather models</strong>: air temperature, precipitation, and
wind speed forecasting.</p></li>
<li><p><strong>hydrological models</strong>: evolution of the snowpack, simulated
streamflow, infiltration rates.</p></li>
<li><p><strong>large-sample hydrology datasets</strong></p></li>
</ol>
<p>
Data from remote sensing and climate models is distributed in
standardized formats (e.g., <em>.nc</em>, <em>.tiff</em>, <em>.grb</em>) and therefore there
are standardized tools to manipulate them <span class="citation" data-cites="raster:2017 saga:2015 netcdf:2019">(<a href="#ref-saga:2015" role="doc-biblioref">Conrad et al. 2015</a>; <a href="#ref-raster:2017" role="doc-biblioref">Hijmans 2017</a>; <a href="#ref-netcdf:2019" role="doc-biblioref">Pierce 2019</a>)</span>. This is not the case for hydrometeorological data as each
agency, research group or private company has its own standards.
Therefore, the formats, publication frequency, temporal resolution and
quality control vary. As an example, in Argentina, the
organizations that manage hydrological data tend to use proprietary software:
a) the <em>Autoridad Interjurisdiccional de las Cuencas de los ríos Limay, Neuquén</em>
<em>y Negro</em> (AIC) uses DIMS (Dynamic Integrated Monitoring System), b) the
<em>Sistema Nacional de Información Hídrica</em> (SNIH) works with Mnemos, and
c) the <em>Instituto Nacional del Agua</em> (INA) uses their own software
(personal communication).</p>
<p>The R language has gained a central role within the hydrological
community during the last decade because it allows the user to: a)
download and work with multiple data types and formats, b) extract,
manipulate and order data, c) develop hydrological models, d) conduct
statistical analyses, e) view results, and f) export images and
documents ready for publication. <span class="citation" data-cites="slater:2019">Slater et al. (<a href="#ref-slater:2019" role="doc-biblioref">2019</a>)</span> pointed out the
benefits and advantages of using R in the hydrological
field: (1) it democratizes science and numerical literacy; (2) it helps
the research to be reproducible and open; (3) provides statistical
tools; (4) allows connection to and from other languages; and (5) has
the support from a constantly growing community. Indeed the R
community has developed many packages for managing hydrological data
(<a href="https://cran.r-project.org/web/views/Hydrology.html" class="uri">https://cran.r-project.org/web/views/Hydrology.html</a>), but they tend
to be either focused on Europe and North America or lack a
general-purpose framework for efficiently and safely storing and manipulating
hydrometeorological series:</p>
<ol type="1">
<li><p><strong>hddtools</strong> <span class="citation" data-cites="vitolo:2017">(<a href="#ref-vitolo:2017" role="doc-biblioref">Vitolo 2017</a>)</span>: is designed to facilitate
access to a variety of online open data sources relevant for
hydrologists and, more generally, environmental scientists and
practitioners. It includes functionality for Koppen Climate
Classification, Global Runoff Data Centre, Data60UK, MOPEX (USA) and
SEPA (Scotland).</p></li>
<li><p><strong>climate</strong> <span class="citation" data-cites="climate:2020">(<a href="#ref-climate:2020" role="doc-biblioref">Czernecki et al. 2020</a>)</span>: allows automatic downloading
of OGIMET, University of Wyoming (atmospheric vertical profiling
data), Polish Institute of Meteorology and Water Management
(National Research Institute) and National Oceanic &amp; Atmospheric
Administration (NOAA).</p></li>
<li><p><a href="https://cran.r-project.org/package=waterData">waterData</a> <span class="citation" data-cites="ryberg:2017">(<a href="#ref-ryberg:2017" role="doc-biblioref">Ryberg and Vecchia 2017</a>)</span>: imports U.S. Geological
Survey (USGS) daily hydrologic data from USGS web services, plots
the data, addresses some common data problems, calculates and plots
anomalies.</p></li>
<li><p><a href="https://cran.r-project.org/package=hydroTSM">hydroTSM</a> <span class="citation" data-cites="zambrano:2020">(<a href="#ref-zambrano:2020" role="doc-biblioref">Zambrano-Bigiarini 2020</a>)</span>: provides functions for
management, analysis, interpolation and plotting of time series used
in hydrology and related environmental sciences. This package is
highly oriented towards hydrological modeling tasks.</p></li>
<li><p><a href="https://cran.r-project.org/package=dataRetrieval">dataRetrieval</a> <span class="citation" data-cites="cicco:2018">(<a href="#ref-cicco:2018" role="doc-biblioref">De Cicco et al. 2018</a>)</span>: is a collection of
functions that help to retrieve U.S. Geological Survey (USGS) and U.S.
Environmental Protection Agency (EPA) water quality and hydrology
data from web services.</p></li>
<li><p><a href="https://cran.r-project.org/package=hyfo">hyfo</a> <span class="citation" data-cites="hyfo:2020">(<a href="#ref-hyfo:2020" role="doc-biblioref">Xu 2020</a>)</span>: is a package with focus on
processing and visualization of hydrological data and
climate forecasting.
Main function includes data extraction, data downscaling,
resampling, gap filler of precipitation, bias correction of
forecasting data, flexible time series plot, and spatial map
generation.</p></li>
</ol>
<p><a href="https://cran.r-project.org/package=hydrotoolbox">hydrotoolbox</a> <span class="citation" data-cites="htoolbox:2021">(<a href="#ref-htoolbox:2021" role="doc-biblioref">Toum 2022</a>)</span> is an R package developed
using R’s object-oriented programming system (S4 classes; <span class="citation" data-cites="chambers:2017">Chambers (<a href="#ref-chambers:2017" role="doc-biblioref">2017</a>)</span>) that
provides a general framework for efficiently storing and manipulating multiple
hydrometeorological datasets, exploiting not only S4 advantages but
base R’s copy on modify semantics. The series and its metadata (e.g.:
geo-referenced location, river basin name, country, among others) are
agglomerated in a single class object, allowing for an effective management
of vast and heterogeneous hydrometeorological data.
<a href="#">hydrotoolbox</a> also provides a general set of methods regarding: a)
reading multiple datasets with their unique data formats (i.e.
delimited files such as comma-separated values (CSV) and tab-separated
values (TSV) and excel files), b) static and interactive time-series
plotting, c) data manipulation, d) data temporal aggregation, among
others. In addition, the current version (v 1.1.2) has specific
functions for reading data from Argentina and Chile. Despite this fact,
we want to stress that every user can combine other R functions or
packages for downloading and reading data (including those coming from
large-sample hydrological datasets; <span class="citation" data-cites="addor:2020">Addor et al. (<a href="#ref-addor:2020" role="doc-biblioref">2020</a>)</span>) with the
functionality of the package.</p>
<p>The rest of this work is organized as follows:
in the <strong>Package design</strong> section we
describe the underlying ideas with a brief description of the
classes, subclasses, methods and functions that <a href="#">hydrotoolbox</a>
offers. In the <strong>Case studies section</strong> we show two applied
examples: the first deals with a hydrometerological data set and the second
deals with post-processing the results of a modeling exercise with the
<a href="https://cran.r-project.org/package=HBV.IANIGLA">HBV.IANIGLA</a> model <span class="citation" data-cites="toum:2021 toum-rj:2021">(<a href="#ref-toum:2021" role="doc-biblioref">Toum 2021</a>; <a href="#ref-toum-rj:2021" role="doc-biblioref">Toum et al. 2021</a>)</span>. These cases
lead to discussion about the package performance. We conclude with a
discussion of possible improvements and ways to extend the functionality
<a href="#">hydrotoolbox</a>.</p>
<h2 data-number="2" id="package-design"><span class="header-section-number">2</span> Package design</h2>
<p><a href="#">hydrotoolbox</a> uses the object-oriented programming (OOP) paradigm,
a feature that makes the package flexible and allows other programmers
to extend its functionality. In this package, the properties are related to the
hydrometeorological variables and the methods with functions for
these objects manipulation. The following principles guided the
design of <a href="#">hydrotoolbox</a>:</p>
<ol type="1">
<li><p><strong>The time series of each variable must be grouped into stations</strong>,
as they are organized based on their geographic location. This allows
series registered in the same station or at different ones to be
compared without losing their position, a fundamental aspect for a
correct physical interpretation of the data.</p></li>
<li><p><strong>Modifications must be recorded in the same file</strong>. Most time
series have errors that need to be corrected. This could happen
because the time series are discontinuous, the instruments fail, the
variables are not all measured in the same temporal resolution,
because of power cuts, or because local natural conditions
induce erroneous measurements (e.g., snowfall undercatch
due to wind; <span class="citation" data-cites="goodinson:1998">Goodinson and Louie (<a href="#ref-goodinson:1998" role="doc-biblioref">1998</a>)</span>). Errors are corrected in successive
steps but it is crucial to have access to all versions of the
series. This principle also seeks to avoid having multiple records
of the same variable in a given station. The reader will find
an example in the <em>Case studies</em> section.</p></li>
<li><p><strong>Expedited visualization</strong>. Fast and flexible visualization
techniques are a powerful tool for analyzing and communicating results.
The series should be able to be viewed statically and dynamically.</p></li>
<li><p><strong>There should be general functions for data manipulation</strong> to
reduce the need to permanently create custom functions.</p></li>
<li><p><strong>Open-ended design</strong> to incorporate new objects and/or methods to
continue expanding the package’s functionality.</p></li>
</ol>
<h3 data-number="2.1" id="classes-and-subclasses"><span class="header-section-number">2.1</span> Classes and subclasses</h3>
<p>Following the first design principle, there is a class and two
subclasses for managing hydrometereological data (Figure <a href="#fig:class-htb">1</a>).
The class, called <code>hydromet</code>,
contains the station’s metadata (e.g., geographic coordinates, name of
the basin, province, country, unique identifier, etc.). The two
subclasses correspond to <strong>(a)</strong> data from meteorological stations and
<strong>(b)</strong> data derived from modeling. The <code>hydromet_station</code> subclass
contains a table for each measured variable (some of them are shown in
Table
<a href="#tab:table-variables-html">1</a>)
in combination with the metadata, allowing users to store in a single
object all the information concerning an hydrometeorological station.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:class-htb"></span>
<img src="flow_diagram_classes_crop.png" alt="Classes for hydrometeorological data in $\textbf{hydrotoolbox}$ package. Arrows indicate the class that each entity inherits from. The dotted arrow means that an $\texttt{hydromet\_station}$ class can be transformed (by the $\texttt{hm\_melt}$ method) to a  $\texttt{hydromet\_compact}$ class object." width="70%" />
<p class="caption">
Figure 1: Classes for hydrometeorological data in <span class="math inline">\(\textbf{hydrotoolbox}\)</span> package. Arrows indicate the class that each entity inherits from. The dotted arrow means that an <span class="math inline">\(\texttt{hydromet\_station}\)</span> class can be transformed (by the <span class="math inline">\(\texttt{hm\_melt}\)</span> method) to a <span class="math inline">\(\texttt{hydromet\_compact}\)</span> class object.
</p>
</div>
</div>
<p>
The remaining subclass, called <code>hydromet_compact</code>, stores all
series in a single table (called <code>compact</code>). It was created so that
users could store input/output data from models or to save the same
variable to perform regional analyzes (e.g., precipitation series
recorded in different rain gauges).</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption>
<span id="tab:table-variables-html">Table 1: </span>Eight out of forty hydrometeorological variables supported in <span class="math inline">\(\texttt{hydromet_station}\)</span> class (use <span class="math inline">\(\texttt{slotNames(x = &quot;hydromet_station&quot;)}\)</span> to see all of them). In the package most of them are rectangular tables containing date series in their first column (<span class="math inline">\(\texttt{Date}\)</span> and <span class="math inline">\(\texttt{POSIX*}\)</span> classes are allowed).
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Slot
</th>
<th style="text-align:left;font-weight: bold;">
Variable
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hq
</td>
<td style="text-align:left;">
water-height vs stream-discharge measurements
</td>
</tr>
<tr>
<td style="text-align:left;">
hw
</td>
<td style="text-align:left;">
water height level records
</td>
</tr>
<tr>
<td style="text-align:left;">
qh
</td>
<td style="text-align:left;">
hourly mean river discharge
</td>
</tr>
<tr>
<td style="text-align:left;">
qd
</td>
<td style="text-align:left;">
daily mean river discharge
</td>
</tr>
<tr>
<td style="text-align:left;">
qm
</td>
<td style="text-align:left;">
monthly mean river discharge
</td>
</tr>
<tr>
<td style="text-align:left;">
qa
</td>
<td style="text-align:left;">
annual river discharge
</td>
</tr>
<tr>
<td style="text-align:left;">
wspd
</td>
<td style="text-align:left;">
wind speed
</td>
</tr>
<tr>
<td style="text-align:left;">
wdir
</td>
<td style="text-align:left;">
wind direction
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 data-number="2.2" id="methods"><span class="header-section-number">2.2</span> Methods</h3>
<p>The present package’s version provides a set of data processing
operations (methods) widely required in hydrology such as: temporal
aggregation, interactive and static visualization, series modification and
statistical summaries. Table
<a href="#tab:table-methods-html">2</a>
provides a complete list accompanied with a brief description. Also, to
make the package more user-friendly, all the methods for object
manipulation follow the syntax <code>hm_action</code>; the <code>hm_</code> prefix being
indicative of the superclass (<code>hydromet</code>) and the action being
indicative of what it does. We believe that this feature greatly eases
its application.</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption>
<span id="tab:table-methods-html">Table 2: </span>Processing operations for object manipulation in the <a href="#">hydrotoolbox</a> package.
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Method
</th>
<th style="text-align:left;font-weight: bold;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_agg}\)</span>
</td>
<td style="text-align:left;">
temporally aggregates data
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_build_generic}\)</span>
</td>
<td style="text-align:left;">
automatically loads raw data inside the <span class="math inline">\(\texttt{hydromet_station}\)</span> object
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_create}\)</span>
</td>
<td style="text-align:left;">
constructs the <span class="math inline">\(\texttt{hydromet}\)</span> class and its subclasses
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_get}\)</span>
</td>
<td style="text-align:left;">
extracts the required table (or metadata) from the object
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_melt}\)</span>
</td>
<td style="text-align:left;">
merges several tables into a single one and set it into a <span class="math inline">\(\texttt{hydromet_compact}\)</span> class object
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_mutate}\)</span>
</td>
<td style="text-align:left;">
creates, modifies and deletes columns inside an object table (slot)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_name}\)</span>
</td>
<td style="text-align:left;">
changes data frame column names
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_plot}\)</span>
</td>
<td style="text-align:left;">
makes static and dynamic graphs of the required hydrometeorological variables
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_report}\)</span>
</td>
<td style="text-align:left;">
gets basic statistic and a table with missing data
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_set}\)</span>
</td>
<td style="text-align:left;">
assigns the (meta)data to an <span class="math inline">\(\texttt{hydromet}\)</span> class or subclass object
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_show}\)</span>
</td>
<td style="text-align:left;">
shows the head or tail of the tables inside the object
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\texttt{hm_subset}\)</span>
</td>
<td style="text-align:left;">
subsets the required table
</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Although more details and examples about each of the methods are given
in the <strong>Case studies</strong> section and in the package documentation and
vignettes <span class="citation" data-cites="htoolbox:2021">(<a href="#ref-htoolbox:2021" role="doc-biblioref">Toum 2022</a>)</span>, in the next lines we explain the use of <code>hm_build_generic</code>.
This is a core package function, since it allows to automatically
load raw hydrometeorological data inside an <code>hydromet_station</code> class
object. Figure <a href="#fig:read-like">2</a> depicts five different
compatible rectangular data configurations. The upper scheme shows
allowed configurations for any delimited type file <span class="citation" data-cites="readr_pkg">(<a href="#ref-readr_pkg" role="doc-biblioref">Wickham et al. 2022</a>)</span>: a)
all time series are stored in a single file with the first column being
the date and the others numeric time series (measured variables),
b) every variable is saved in a single file containing the date,
the time series and other kind of data (like data-quality flags).<br />
Another widely used file type to store hydrometeorological measurements are
excel files. The bottom scheme of Figure <a href="#fig:read-like">2</a> depicts the
three approaches: a) all time series are stored in a single file
and sheet, b) every sheet (all in the same file) contains a
variable (non-numeric columns allowed), and c) multiple files storing a
single variable.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:read-like"></span>
<img src="readr_like.png" alt="Rectangular data formats/file types compatible with the $\texttt{hm\_build\_generic}$ function. Top scheme depicts allowed delimited file arrangements while the bottom scheme is for excel files." width="52%" /><img src="readxl_like.png" alt="Rectangular data formats/file types compatible with the $\texttt{hm\_build\_generic}$ function. Top scheme depicts allowed delimited file arrangements while the bottom scheme is for excel files." width="52%" />
<p class="caption">
Figure 2: Rectangular data formats/file types compatible with the <span class="math inline">\(\texttt{hm\_build\_generic}\)</span> function. Top scheme depicts allowed delimited file arrangements while the bottom scheme is for excel files.
</p>
</div>
</div>
<p>
The use of this function is illustrated with two examples (the data can be
downloaded from
<a href="https://gitlab.com/ezetoum27/hydrotoolbox/-/tree/master/my_data" class="uri">https://gitlab.com/ezetoum27/hydrotoolbox/-/tree/master/my_data</a>), but
the user can find full-covered documentation using the
<code>??hm_build_generic</code> command.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#* This code example shows how to use </span></span>
<span><span class='co'>#* the hm_build_generic() method to </span></span>
<span><span class='co'>#* automatically load raw hydrometeorological </span></span>
<span><span class='co'>#* data</span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://gitlab.com/ezetoum27/hydrotoolbox'>hydrotoolbox</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readr.tidyverse.org'>readr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># path to data</span></span>
<span><span class='va'>my_path</span> <span class='op'>&lt;-</span> <span class='st'>"./home/my_folder/my_data"</span></span>
<span></span>
<span><span class='co'>#+++++++++++++++++++</span></span>
<span><span class='co'># Rectangular data</span></span>
<span><span class='co'>#+++++++++++++++++++</span></span>
<span><span class='co'>#* Case B: multiple files (one per variable)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_create.html'>hm_create</a></span><span class='op'>(</span>class_name <span class='op'>=</span> <span class='st'>"station"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span> <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_build_generic.html'>hm_build_generic</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>my_path</span>,</span>
<span>                  file_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"h_relativa_cuevas.csv"</span>,</span>
<span>                                <span class='st'>"p_atm_cuevas.csv"</span>,</span>
<span>                                <span class='st'>"precip_total_cuevas.csv"</span>,</span>
<span>                                <span class='st'>"temp_aire_cuevas.csv"</span>,</span>
<span>                                <span class='st'>"vel_viento_cuevas.csv"</span><span class='op'>)</span>,</span>
<span>                  slot_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rh"</span>, <span class='st'>"patm"</span>, <span class='st'>"precip"</span>,</span>
<span>                                <span class='st'>"tair"</span>, <span class='st'>"wspd"</span><span class='op'>)</span>,</span>
<span>                  by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"hour"</span>, <span class='st'>"45 min"</span>, <span class='st'>"30 min"</span>, <span class='st'>"1 hour"</span>, <span class='st'>"15 min"</span><span class='op'>)</span>,</span>
<span>                  FUN <span class='op'>=</span> <span class='va'>read_csv</span>  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span> <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_show.html'>hm_show</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#+++++++++++++++++++</span></span>
<span><span class='co'># Excel files</span></span>
<span><span class='co'>#+++++++++++++++++++</span></span>
<span><span class='co'>#* Case B: single file - multiple sheets (one per variable)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_create.html'>hm_create</a></span><span class='op'>(</span>class_name <span class='op'>=</span> <span class='st'>"station"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span> <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_build_generic.html'>hm_build_generic</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>my_path</span>,</span>
<span>                  file_name <span class='op'>=</span> <span class='st'>"mnemos_guido.xlsx"</span>,</span>
<span>                  slot_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"qd"</span>, <span class='st'>"evap"</span>,</span>
<span>                                <span class='st'>"tair"</span>,<span class='st'>"tmax"</span>,</span>
<span>                                <span class='st'>"tmin"</span><span class='op'>)</span>,</span>
<span>                  by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>q <span class='op'>=</span> <span class='st'>"day"</span>, evap <span class='op'>=</span>  <span class='st'>"day"</span>,</span>
<span>                         tair <span class='op'>=</span> <span class='st'>"6 hour"</span>, tmax <span class='op'>=</span> <span class='st'>"day"</span>,</span>
<span>                         tmin <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>,</span>
<span>                  FUN <span class='op'>=</span> <span class='va'>read_excel</span>,</span>
<span>                  sheet <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span><span class='op'>:</span><span class='fl'>5L</span><span class='op'>)</span>,</span>
<span>                  skip <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>                  out_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"q_m3/s"</span>, <span class='st'>"flag"</span><span class='op'>)</span>,</span>
<span>                                   <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"evap_mm"</span>, <span class='st'>"flag"</span><span class='op'>)</span>,</span>
<span>                                   <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tair"</span>, <span class='st'>"flag"</span><span class='op'>)</span>,</span>
<span>                                   <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tmax"</span>, <span class='st'>"flag"</span><span class='op'>)</span>,</span>
<span>                                   <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tmin"</span>, <span class='st'>"flag"</span><span class='op'>)</span></span>
<span>                  <span class='op'>)</span></span>
<span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span> <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_show.html'>hm_show</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 data-number="3" id="case-studies"><span class="header-section-number">3</span> Case studies</h2>
<h3 data-number="3.1" id="daily-streamflow-record-at-the-guido-station-mendoza---argentina"><span class="header-section-number">3.1</span> Daily streamflow record at the Guido station (Mendoza - Argentina)</h3>
<p>The following example illustrates how to work with a time-series
recorded in an Excel file with a single sheet (Case <strong>A</strong> in the
<strong>bottom</strong> panel of Figure <a href="#fig:read-like">2</a>). This variable is
measured at a station located in the Mendoza River basin from Argentina,
a watershed that covers an area of approximately <span class="math inline">\(7110 \, km^2\)</span> and
provides water to almost <span class="math inline">\(1m\)</span> inhabitants (Figure <a href="#fig:mza-basin">3</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mza-basin"></span>
<img src="mza_basin.png" alt="Map of the Mendoza basin including Guido hydrological station, cities, river and main mountain summits for reference." width="60%" />
<p class="caption">
Figure 3: Map of the Mendoza basin including Guido hydrological station, cities, river and main mountain summits for reference.
</p>
</div>
</div>
<p>In order to explore the data, we propose the following operations:</p>
<ol type="a">
<li><p>Build the station and obtain basic statistics of the data
(<code>hm_build_generic</code>, <code>hm_report</code> and <code>hm_set</code> methods will be used).</p></li>
<li><p>Make a visual inspection of the series with <code>hm_plot</code>.</p></li>
<li><p>Smooth the streamflow record using a five days moving average
windows. <code>hm_mutate</code> allows data manipulation and it can be combined
with the user’s or other package’s functions via <code>FUN</code> and <code>...</code>
arguments.</p></li>
<li><p>Aggregate the series to monthly average values (via <code>hm_agg</code>).</p></li>
<li><p>Plot results for publishing using the <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> <span class="citation" data-cites="ggplot2_pkg">(<a href="#ref-ggplot2_pkg" role="doc-biblioref">Wickham 2016</a>)</span>
output of <code>hm_plot</code>.</p></li>
</ol>
<p>
The first step is to load the original data in a
<code>hydromet_station</code> that we are going to called <em>guido</em>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://gitlab.com/ezetoum27/hydrotoolbox'>hydrotoolbox</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># package's data-base</span></span>
<span><span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, package <span class='op'>=</span> <span class='st'>"hydrotoolbox"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># station building</span></span>
<span><span class='va'>guido</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_create.html'>hm_create</a></span><span class='op'>(</span>class_name <span class='op'>=</span> <span class='st'>"station"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_build_generic.html'>hm_build_generic</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path</span>, </span>
<span>                   file_name <span class='op'>=</span> <span class='st'>"snih_qd_guido.xlsx"</span>, </span>
<span>                   slot_name <span class='op'>=</span> <span class='st'>"qd"</span>,</span>
<span>                   by <span class='op'>=</span> <span class='st'>"1 day"</span>, </span>
<span>                   out_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"q_m3/s"</span><span class='op'>)</span>, </span>
<span>                   sheet <span class='op'>=</span> <span class='fl'>1L</span>, </span>
<span>                   FUN <span class='op'>=</span> <span class='va'>read_excel</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>
After executing these lines, the user will have an object that
contains a table (a <code>tibble</code> in this case) with the streamflow record in
the <code>qd</code> slot. When setting the argument <code>by = "1 day"</code>, the function
automatically fill with <code>NA_real_</code> values the missing dates and also removes
duplicated records. On the other hand, using the default value (<code>by = NULL</code>)
will ignore gaps, a feature that can be useful when loading
irregular time series.<br />
As it was previously mentioned, the package also allows setting the
metadata inside the object. In this case we proposed to add the
basin area using <code>hm_set</code>, but the user can apply the same command
to incorporate other information (see <code>??hm_set</code>). Then <code>hm_report</code>
is used to get basic statistics on the streamflow
record and also a table with a summary of the missing data. Note that this
function also contains the string
<code>"Missings total are in the last rows."</code>
(under <code>$miss_data$comment</code>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># set the basin area</span></span>
<span><span class='va'>guido</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_set.html'>hm_set</a></span><span class='op'>(</span>basin_area <span class='op'>=</span> <span class='fl'>7110</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># get streamflow's report</span></span>
<span><span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_report.html'>hm_report</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qd"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>$stats
           date    q_m3/s
min  1956-07-01   8.00000
max  2020-06-30 401.00000
mean       &lt;NA&gt;  44.47951
sd         &lt;NA&gt;  36.53992

$miss_data
$miss_data$`q_m3/s`
       first       last time_steps
1 1962-09-01 1962-09-30         30
2 1970-02-13 1970-02-14          2
3 1976-06-22 1976-07-31         40
4 1985-06-01 1985-06-30         30
5       &lt;NA&gt;       &lt;NA&gt;        102

$miss_data$comment
[1] &quot;Missings total are in the last row.&quot;</code></pre>
</div>
<p>Another essential part of the workflow is data visualization
<span class="citation" data-cites="hadley_r_data">(<a href="#ref-hadley_r_data" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span>. The user of <a href="#">hydrotoolbox</a> can use the <code>hm_plot</code>
function and switch between static and interactive versions of the plot
(using the <code>interactive = TRUE</code> argument). Internally, this function
uses <a href="#">ggplot2</a> and <a href="https://cran.r-project.org/package=plotly">plotly</a> <span class="citation" data-cites="ggplot2_pkg plotly_pkg">(<a href="#ref-ggplot2_pkg" role="doc-biblioref">Wickham 2016</a>; <a href="#ref-plotly_pkg" role="doc-biblioref">Sievert 2020</a>)</span>
to reproduce time-series plots and provides several arguments to set
axes labels, define colors, line thickness
and type, transparency, among others. The following
example shows how to plot the mean daily streamflow. To see the interactive version
of Figure <a href="#fig:guido-plot-html">4</a>
please visit the HTML (online) version of the article.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ggplot2 daily flow</span></span>
<span><span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_plot.html'>hm_plot</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qd"</span>,</span>
<span>          col_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='st'>"q_m3/s"</span> <span class='op'>)</span>, </span>
<span>          interactive <span class='op'>=</span> <span class='cn'>FALSE</span>, </span>
<span>          line_color <span class='op'>=</span> <span class='st'>"dodgerblue"</span>,</span>
<span>          line_size <span class='op'>=</span> <span class='fl'>.7</span>,</span>
<span>          y_lab <span class='op'>=</span> <span class='st'>"Q(m3/s)"</span>, </span>
<span>          from <span class='op'>=</span> <span class='st'>"2010-07-01"</span>, </span>
<span>          to <span class='op'>=</span> <span class='st'>"2014-06-30"</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># plotly daily flow</span></span>
<span><span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_plot.html'>hm_plot</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qd"</span>,</span>
<span>          col_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='st'>"q_m3/s"</span> <span class='op'>)</span>, </span>
<span>          interactive <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>          line_color <span class='op'>=</span> <span class='st'>"dodgerblue"</span>,</span>
<span>          line_size <span class='op'>=</span> <span class='fl'>.7</span>,</span>
<span>          y_lab <span class='op'>=</span> <span class='st'>"Q(m3/s)"</span>, </span>
<span>          from <span class='op'>=</span> <span class='st'>"2010-07-01"</span>,</span>
<span>          to <span class='op'>=</span> <span class='st'>"2014-06-30"</span><span class='op'>)</span> </span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:guido-plot-html"></span>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9a00d05c92dc8b3787f3" style="width:100%;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-9a00d05c92dc8b3787f3">{"x":{"visdat":{"9a48613248dc":["function () ","plotlyVisDat"]},"cur_data":"9a48613248dc","attrs":{"9a48613248dc":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[21,21,21,21,21,23,22,22,22,22,21,20,20,20,20,20,19,19,20,20,19,19,20,19,19,19,19,18,18,19,18,19,19,19,19,19,19,18,19,19,19,19,18,18,18,18,18,18,17,19,20,22,23,22,20,20,20,20,20,19,21,19,20,19,19,18,18,19,19,20,20,19,17,17,16,16,16,15,15,16,16,16,16,16,15,15,15,17,17,16,16,16,15,16,17,18,17,16,16,18,20,21,22,23,23,21,20,18,18,19,20,20,19,20,19,18,18,19,19,18,16,15,16,18,21,23,21,19,21,24,21,18,18,18,18,18,19,19,20,21,21,20,19,18,19,19,21,22,23,24,23,22,22,20,20,19,19,21,23,26,25,25,24,23,21,21,25,31,32,30,28,28,29,32,35,39,39,38,45,49,46,48,40,39,36,43,41,39,34,35,36,36,39,38,37,38,42,42,44,43,41,42,43,44,47,48,51,56,54,51,51,52,55,56,54,53,56,57,55,60,63,64,64,62,59,55,50,45,46,51,52,51,54,51,51,57,57,56,55,49,48,50,52,53,56,57,56,56,51,50,51,54,55,55,48,43,42,34,32,33,32,34,36,38,36,34,34,33,31,30,29,30,30,31,30,30,30,30,30,30,30,31,30,32,31,29,27,26,26,26,25,25,25,24,24,23,23,24,23,23,23,23,22,22,23,22,22,22,22,22,22,21,21,21,21,21,21,20,21,20,20,20,19,20,19,19,19,19,18,18,18,19,19,19,19,19,18,18,18,18,19,18,18,18,18,18,18,18,17,17,18,18,18,18,18,18,17,17,18,17,16,16,16,16,17,14,13,13,13,14,13,13,13,13,14,14,13,13,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,13,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,12,12,13,13,12,12,13,12,12,13,12,13,13,13,13,13,12,13,13,13,13,13,13,14,17,19,18,18,17,16,17,17,18,19,17,18,20,19,20,22,19,18,17,17,19,20,18,19,18,16,14,15,14,14,14,13,13,13,14,15,16,19,24,24,22,22,20,20,19,19,19,20,23,25,24,27,29,27,31,35,27,20,18,22,27,29,23,26,32,29,28,27,24,21,23,31,32,33,38,40,41,41,43,43,44,40,39,37,39,37,37,38,41,41,40,41,49,57,59,54,55,54,51,48,47,47,47,48,54,61,66,74,73,72,77,76,73,76,80,77,66,70,73,69,67,66,69,74,81,77,70,66,67,71,69,65,63,51,52,55,62,65,61,60,59,58,55,55,58,59,60,65,68,64,69,71,73,66,66,63,62,60,61,55,57,56,56,60,48,47,41,45,46,40,38,40,43,48,51,48,48,51,58,69,61,51,46,48,51,52,54,52,48,43,39,38,39,41,39,36,37,36,38,40,41,41,39,39,36,34,33,33,32,31,29,28,27,26,27,27,25,25,25,24,24,24,24,23,23,23,23,23,23,22,21,21,21,21,21,21,21,21,20,20,20,20,20,20,19,19,20,20,20,20,20,19,19,19,19,19,20,31,23,21,20,20,20,23,22,20,19,18,18,18,18,18,18,18,18,17,18,18,17,18,17,16,16,16,16,16,16,16,16,17,18,18,19,19,18,18,18,18,18,17,17,18,18,18,18,18,18,18,18,18,18,18,18,17,17,17,17,17,17,18,18,18,18,18,18,17,18,17,17,17,17,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,16,17,17,17,18,17,18,17,17,19,20,21,20,20,19,19,19,20,20,20,20,22,22,21,19,18,18,18,17,18,18,18,18,19,22,22,22,20,19,18,18,18,18,18,18,18,18,19,21,23,25,27,26,23,24,25,25,25,22,21,20,19,19,18,18,18,18,19,20,23,25,29,31,35,38,44,46,40,33,31,32,39,41,44,46,41,39,43,48,55,54,45,42,42,42,43,45,44,37,34,35,41,42,44,44,41,43,50,57,57,57,58,61,60,58,60,61,50,43,39,40,44,49,48,46,48,48,51,55,58,54,58,63,64,63,58,65,66,70,83,90,96,96,97,104,102,102,98,99,95,95,86,90,82,74,67,70,60,51,51,55,57,56,55,66,77,85,85,121,110,102,83,76,78,73,69,67,58,52,47,44,44,45,47,45,44,45,46,45,39,36,38,37,38,38,37,34,33,35,35,33,32,32,31,32,32,32,31,31,29,30,29,30,28,29,30,31,31,30,30,28,27,26,26,25,25,25,25,24,24,23,23,22,22,22,22,22,22,23,23,23,23,23,23,23,23,22,22,22,21,21,21,21,20,20,20,20,21,20,20,20,20,20,19,19,19,19,19,19,18,18,18,18,18,18,18,18,19,17,18,20,18,18,19,19,20,20,21,21,21,20,20,20,20,20,19,19,19,18,18,18,18,18,18,18,17,17,18,18,16,16,17,17,18,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,17,16,16,16,16,16,15,16,16,16,16,16,16,16,16,16,16,16,15,16,16,16,16,15,15,16,16,17,18,18,18,17,17,16,16,16,16,16,16,18,20,19,18,17,17,17,17,16,18,17,18,17,18,18,17,17,17,16,16,16,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,18,19,19,18,18,20,21,22,22,25,26,26,26,23,20,20,18,18,17,18,18,22,26,25,27,24,22,22,22,28,33,40,33,31,30,31,25,24,31,38,35,41,47,46,40,34,38,44,49,51,46,43,38,38,40,42,44,46,46,50,52,43,48,55,45,47,55,61,63,68,68,68,72,75,72,79,85,91,97,106,116,110,104,102,100,96,91,88,89,79,78,86,92,91,91,89,84,80,85,91,95,88,89,91,85,75,81,76,72,69,65,65,64,63,60,61,68,71,69,66,57,57,57,56,57,60,62,61,63,61,63,63,62,51,46,45,46,45,45,44,46,46,50,43,43,43,43,44,43,42,42,41,41,42,42,39,37,36,37,36,35,33,34,34,33,33,33,33,34,35,34,34,34,32,33,32,30,28,28,27,28,28,28,27,26,26,26,26,24,25,25,25,25,24,23,23,23,23,23,23,23,23,23,23,23,23,23,22,23,22,23,23,23,23,24,24,23,23,23,22,22,22,21,21,21,21,21,21,21,19,19,19,19,19,19,19,18,18,18,18,19,19,18,18,18,17,18,18,18,18,17,17,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17],"type":"scatter","mode":"lines","color":["dodgerblue"],"line":{"width":0.69999999999999996},"opacity":1,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"date"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Q(m3/s)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2010-07-01","2010-07-02","2010-07-03","2010-07-04","2010-07-05","2010-07-06","2010-07-07","2010-07-08","2010-07-09","2010-07-10","2010-07-11","2010-07-12","2010-07-13","2010-07-14","2010-07-15","2010-07-16","2010-07-17","2010-07-18","2010-07-19","2010-07-20","2010-07-21","2010-07-22","2010-07-23","2010-07-24","2010-07-25","2010-07-26","2010-07-27","2010-07-28","2010-07-29","2010-07-30","2010-07-31","2010-08-01","2010-08-02","2010-08-03","2010-08-04","2010-08-05","2010-08-06","2010-08-07","2010-08-08","2010-08-09","2010-08-10","2010-08-11","2010-08-12","2010-08-13","2010-08-14","2010-08-15","2010-08-16","2010-08-17","2010-08-18","2010-08-19","2010-08-20","2010-08-21","2010-08-22","2010-08-23","2010-08-24","2010-08-25","2010-08-26","2010-08-27","2010-08-28","2010-08-29","2010-08-30","2010-08-31","2010-09-01","2010-09-02","2010-09-03","2010-09-04","2010-09-05","2010-09-06","2010-09-07","2010-09-08","2010-09-09","2010-09-10","2010-09-11","2010-09-12","2010-09-13","2010-09-14","2010-09-15","2010-09-16","2010-09-17","2010-09-18","2010-09-19","2010-09-20","2010-09-21","2010-09-22","2010-09-23","2010-09-24","2010-09-25","2010-09-26","2010-09-27","2010-09-28","2010-09-29","2010-09-30","2010-10-01","2010-10-02","2010-10-03","2010-10-04","2010-10-05","2010-10-06","2010-10-07","2010-10-08","2010-10-09","2010-10-10","2010-10-11","2010-10-12","2010-10-13","2010-10-14","2010-10-15","2010-10-16","2010-10-17","2010-10-18","2010-10-19","2010-10-20","2010-10-21","2010-10-22","2010-10-23","2010-10-24","2010-10-25","2010-10-26","2010-10-27","2010-10-28","2010-10-29","2010-10-30","2010-10-31","2010-11-01","2010-11-02","2010-11-03","2010-11-04","2010-11-05","2010-11-06","2010-11-07","2010-11-08","2010-11-09","2010-11-10","2010-11-11","2010-11-12","2010-11-13","2010-11-14","2010-11-15","2010-11-16","2010-11-17","2010-11-18","2010-11-19","2010-11-20","2010-11-21","2010-11-22","2010-11-23","2010-11-24","2010-11-25","2010-11-26","2010-11-27","2010-11-28","2010-11-29","2010-11-30","2010-12-01","2010-12-02","2010-12-03","2010-12-04","2010-12-05","2010-12-06","2010-12-07","2010-12-08","2010-12-09","2010-12-10","2010-12-11","2010-12-12","2010-12-13","2010-12-14","2010-12-15","2010-12-16","2010-12-17","2010-12-18","2010-12-19","2010-12-20","2010-12-21","2010-12-22","2010-12-23","2010-12-24","2010-12-25","2010-12-26","2010-12-27","2010-12-28","2010-12-29","2010-12-30","2010-12-31","2011-01-01","2011-01-02","2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07","2011-01-08","2011-01-09","2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14","2011-01-15","2011-01-16","2011-01-17","2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-22","2011-01-23","2011-01-24","2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-29","2011-01-30","2011-01-31","2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-05","2011-02-06","2011-02-07","2011-02-08","2011-02-09","2011-02-10","2011-02-11","2011-02-12","2011-02-13","2011-02-14","2011-02-15","2011-02-16","2011-02-17","2011-02-18","2011-02-19","2011-02-20","2011-02-21","2011-02-22","2011-02-23","2011-02-24","2011-02-25","2011-02-26","2011-02-27","2011-02-28","2011-03-01","2011-03-02","2011-03-03","2011-03-04","2011-03-05","2011-03-06","2011-03-07","2011-03-08","2011-03-09","2011-03-10","2011-03-11","2011-03-12","2011-03-13","2011-03-14","2011-03-15","2011-03-16","2011-03-17","2011-03-18","2011-03-19","2011-03-20","2011-03-21","2011-03-22","2011-03-23","2011-03-24","2011-03-25","2011-03-26","2011-03-27","2011-03-28","2011-03-29","2011-03-30","2011-03-31","2011-04-01","2011-04-02","2011-04-03","2011-04-04","2011-04-05","2011-04-06","2011-04-07","2011-04-08","2011-04-09","2011-04-10","2011-04-11","2011-04-12","2011-04-13","2011-04-14","2011-04-15","2011-04-16","2011-04-17","2011-04-18","2011-04-19","2011-04-20","2011-04-21","2011-04-22","2011-04-23","2011-04-24","2011-04-25","2011-04-26","2011-04-27","2011-04-28","2011-04-29","2011-04-30","2011-05-01","2011-05-02","2011-05-03","2011-05-04","2011-05-05","2011-05-06","2011-05-07","2011-05-08","2011-05-09","2011-05-10","2011-05-11","2011-05-12","2011-05-13","2011-05-14","2011-05-15","2011-05-16","2011-05-17","2011-05-18","2011-05-19","2011-05-20","2011-05-21","2011-05-22","2011-05-23","2011-05-24","2011-05-25","2011-05-26","2011-05-27","2011-05-28","2011-05-29","2011-05-30","2011-05-31","2011-06-01","2011-06-02","2011-06-03","2011-06-04","2011-06-05","2011-06-06","2011-06-07","2011-06-08","2011-06-09","2011-06-10","2011-06-11","2011-06-12","2011-06-13","2011-06-14","2011-06-15","2011-06-16","2011-06-17","2011-06-18","2011-06-19","2011-06-20","2011-06-21","2011-06-22","2011-06-23","2011-06-24","2011-06-25","2011-06-26","2011-06-27","2011-06-28","2011-06-29","2011-06-30","2011-07-01","2011-07-02","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-09","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-16","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-23","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-30","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-06","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-13","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-20","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-27","2011-08-28","2011-08-29","2011-08-30","2011-08-31","2011-09-01","2011-09-02","2011-09-03","2011-09-04","2011-09-05","2011-09-06","2011-09-07","2011-09-08","2011-09-09","2011-09-10","2011-09-11","2011-09-12","2011-09-13","2011-09-14","2011-09-15","2011-09-16","2011-09-17","2011-09-18","2011-09-19","2011-09-20","2011-09-21","2011-09-22","2011-09-23","2011-09-24","2011-09-25","2011-09-26","2011-09-27","2011-09-28","2011-09-29","2011-09-30","2011-10-01","2011-10-02","2011-10-03","2011-10-04","2011-10-05","2011-10-06","2011-10-07","2011-10-08","2011-10-09","2011-10-10","2011-10-11","2011-10-12","2011-10-13","2011-10-14","2011-10-15","2011-10-16","2011-10-17","2011-10-18","2011-10-19","2011-10-20","2011-10-21","2011-10-22","2011-10-23","2011-10-24","2011-10-25","2011-10-26","2011-10-27","2011-10-28","2011-10-29","2011-10-30","2011-10-31","2011-11-01","2011-11-02","2011-11-03","2011-11-04","2011-11-05","2011-11-06","2011-11-07","2011-11-08","2011-11-09","2011-11-10","2011-11-11","2011-11-12","2011-11-13","2011-11-14","2011-11-15","2011-11-16","2011-11-17","2011-11-18","2011-11-19","2011-11-20","2011-11-21","2011-11-22","2011-11-23","2011-11-24","2011-11-25","2011-11-26","2011-11-27","2011-11-28","2011-11-29","2011-11-30","2011-12-01","2011-12-02","2011-12-03","2011-12-04","2011-12-05","2011-12-06","2011-12-07","2011-12-08","2011-12-09","2011-12-10","2011-12-11","2011-12-12","2011-12-13","2011-12-14","2011-12-15","2011-12-16","2011-12-17","2011-12-18","2011-12-19","2011-12-20","2011-12-21","2011-12-22","2011-12-23","2011-12-24","2011-12-25","2011-12-26","2011-12-27","2011-12-28","2011-12-29","2011-12-30","2011-12-31","2012-01-01","2012-01-02","2012-01-03","2012-01-04","2012-01-05","2012-01-06","2012-01-07","2012-01-08","2012-01-09","2012-01-10","2012-01-11","2012-01-12","2012-01-13","2012-01-14","2012-01-15","2012-01-16","2012-01-17","2012-01-18","2012-01-19","2012-01-20","2012-01-21","2012-01-22","2012-01-23","2012-01-24","2012-01-25","2012-01-26","2012-01-27","2012-01-28","2012-01-29","2012-01-30","2012-01-31","2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12","2012-02-13","2012-02-14","2012-02-15","2012-02-16","2012-02-17","2012-02-18","2012-02-19","2012-02-20","2012-02-21","2012-02-22","2012-02-23","2012-02-24","2012-02-25","2012-02-26","2012-02-27","2012-02-28","2012-02-29","2012-03-01","2012-03-02","2012-03-03","2012-03-04","2012-03-05","2012-03-06","2012-03-07","2012-03-08","2012-03-09","2012-03-10","2012-03-11","2012-03-12","2012-03-13","2012-03-14","2012-03-15","2012-03-16","2012-03-17","2012-03-18","2012-03-19","2012-03-20","2012-03-21","2012-03-22","2012-03-23","2012-03-24","2012-03-25","2012-03-26","2012-03-27","2012-03-28","2012-03-29","2012-03-30","2012-03-31","2012-04-01","2012-04-02","2012-04-03","2012-04-04","2012-04-05","2012-04-06","2012-04-07","2012-04-08","2012-04-09","2012-04-10","2012-04-11","2012-04-12","2012-04-13","2012-04-14","2012-04-15","2012-04-16","2012-04-17","2012-04-18","2012-04-19","2012-04-20","2012-04-21","2012-04-22","2012-04-23","2012-04-24","2012-04-25","2012-04-26","2012-04-27","2012-04-28","2012-04-29","2012-04-30","2012-05-01","2012-05-02","2012-05-03","2012-05-04","2012-05-05","2012-05-06","2012-05-07","2012-05-08","2012-05-09","2012-05-10","2012-05-11","2012-05-12","2012-05-13","2012-05-14","2012-05-15","2012-05-16","2012-05-17","2012-05-18","2012-05-19","2012-05-20","2012-05-21","2012-05-22","2012-05-23","2012-05-24","2012-05-25","2012-05-26","2012-05-27","2012-05-28","2012-05-29","2012-05-30","2012-05-31","2012-06-01","2012-06-02","2012-06-03","2012-06-04","2012-06-05","2012-06-06","2012-06-07","2012-06-08","2012-06-09","2012-06-10","2012-06-11","2012-06-12","2012-06-13","2012-06-14","2012-06-15","2012-06-16","2012-06-17","2012-06-18","2012-06-19","2012-06-20","2012-06-21","2012-06-22","2012-06-23","2012-06-24","2012-06-25","2012-06-26","2012-06-27","2012-06-28","2012-06-29","2012-06-30","2012-07-01","2012-07-02","2012-07-03","2012-07-04","2012-07-05","2012-07-06","2012-07-07","2012-07-08","2012-07-09","2012-07-10","2012-07-11","2012-07-12","2012-07-13","2012-07-14","2012-07-15","2012-07-16","2012-07-17","2012-07-18","2012-07-19","2012-07-20","2012-07-21","2012-07-22","2012-07-23","2012-07-24","2012-07-25","2012-07-26","2012-07-27","2012-07-28","2012-07-29","2012-07-30","2012-07-31","2012-08-01","2012-08-02","2012-08-03","2012-08-04","2012-08-05","2012-08-06","2012-08-07","2012-08-08","2012-08-09","2012-08-10","2012-08-11","2012-08-12","2012-08-13","2012-08-14","2012-08-15","2012-08-16","2012-08-17","2012-08-18","2012-08-19","2012-08-20","2012-08-21","2012-08-22","2012-08-23","2012-08-24","2012-08-25","2012-08-26","2012-08-27","2012-08-28","2012-08-29","2012-08-30","2012-08-31","2012-09-01","2012-09-02","2012-09-03","2012-09-04","2012-09-05","2012-09-06","2012-09-07","2012-09-08","2012-09-09","2012-09-10","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-29","2012-09-30","2012-10-01","2012-10-02","2012-10-03","2012-10-04","2012-10-05","2012-10-06","2012-10-07","2012-10-08","2012-10-09","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-20","2012-10-21","2012-10-22","2012-10-23","2012-10-24","2012-10-25","2012-10-26","2012-10-27","2012-10-28","2012-10-29","2012-10-30","2012-10-31","2012-11-01","2012-11-02","2012-11-03","2012-11-04","2012-11-05","2012-11-06","2012-11-07","2012-11-08","2012-11-09","2012-11-10","2012-11-11","2012-11-12","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-17","2012-11-18","2012-11-19","2012-11-20","2012-11-21","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-27","2012-11-28","2012-11-29","2012-11-30","2012-12-01","2012-12-02","2012-12-03","2012-12-04","2012-12-05","2012-12-06","2012-12-07","2012-12-08","2012-12-09","2012-12-10","2012-12-11","2012-12-12","2012-12-13","2012-12-14","2012-12-15","2012-12-16","2012-12-17","2012-12-18","2012-12-19","2012-12-20","2012-12-21","2012-12-22","2012-12-23","2012-12-24","2012-12-25","2012-12-26","2012-12-27","2012-12-28","2012-12-29","2012-12-30","2012-12-31","2013-01-01","2013-01-02","2013-01-03","2013-01-04","2013-01-05","2013-01-06","2013-01-07","2013-01-08","2013-01-09","2013-01-10","2013-01-11","2013-01-12","2013-01-13","2013-01-14","2013-01-15","2013-01-16","2013-01-17","2013-01-18","2013-01-19","2013-01-20","2013-01-21","2013-01-22","2013-01-23","2013-01-24","2013-01-25","2013-01-26","2013-01-27","2013-01-28","2013-01-29","2013-01-30","2013-01-31","2013-02-01","2013-02-02","2013-02-03","2013-02-04","2013-02-05","2013-02-06","2013-02-07","2013-02-08","2013-02-09","2013-02-10","2013-02-11","2013-02-12","2013-02-13","2013-02-14","2013-02-15","2013-02-16","2013-02-17","2013-02-18","2013-02-19","2013-02-20","2013-02-21","2013-02-22","2013-02-23","2013-02-24","2013-02-25","2013-02-26","2013-02-27","2013-02-28","2013-03-01","2013-03-02","2013-03-03","2013-03-04","2013-03-05","2013-03-06","2013-03-07","2013-03-08","2013-03-09","2013-03-10","2013-03-11","2013-03-12","2013-03-13","2013-03-14","2013-03-15","2013-03-16","2013-03-17","2013-03-18","2013-03-19","2013-03-20","2013-03-21","2013-03-22","2013-03-23","2013-03-24","2013-03-25","2013-03-26","2013-03-27","2013-03-28","2013-03-29","2013-03-30","2013-03-31","2013-04-01","2013-04-02","2013-04-03","2013-04-04","2013-04-05","2013-04-06","2013-04-07","2013-04-08","2013-04-09","2013-04-10","2013-04-11","2013-04-12","2013-04-13","2013-04-14","2013-04-15","2013-04-16","2013-04-17","2013-04-18","2013-04-19","2013-04-20","2013-04-21","2013-04-22","2013-04-23","2013-04-24","2013-04-25","2013-04-26","2013-04-27","2013-04-28","2013-04-29","2013-04-30","2013-05-01","2013-05-02","2013-05-03","2013-05-04","2013-05-05","2013-05-06","2013-05-07","2013-05-08","2013-05-09","2013-05-10","2013-05-11","2013-05-12","2013-05-13","2013-05-14","2013-05-15","2013-05-16","2013-05-17","2013-05-18","2013-05-19","2013-05-20","2013-05-21","2013-05-22","2013-05-23","2013-05-24","2013-05-25","2013-05-26","2013-05-27","2013-05-28","2013-05-29","2013-05-30","2013-05-31","2013-06-01","2013-06-02","2013-06-03","2013-06-04","2013-06-05","2013-06-06","2013-06-07","2013-06-08","2013-06-09","2013-06-10","2013-06-11","2013-06-12","2013-06-13","2013-06-14","2013-06-15","2013-06-16","2013-06-17","2013-06-18","2013-06-19","2013-06-20","2013-06-21","2013-06-22","2013-06-23","2013-06-24","2013-06-25","2013-06-26","2013-06-27","2013-06-28","2013-06-29","2013-06-30","2013-07-01","2013-07-02","2013-07-03","2013-07-04","2013-07-05","2013-07-06","2013-07-07","2013-07-08","2013-07-09","2013-07-10","2013-07-11","2013-07-12","2013-07-13","2013-07-14","2013-07-15","2013-07-16","2013-07-17","2013-07-18","2013-07-19","2013-07-20","2013-07-21","2013-07-22","2013-07-23","2013-07-24","2013-07-25","2013-07-26","2013-07-27","2013-07-28","2013-07-29","2013-07-30","2013-07-31","2013-08-01","2013-08-02","2013-08-03","2013-08-04","2013-08-05","2013-08-06","2013-08-07","2013-08-08","2013-08-09","2013-08-10","2013-08-11","2013-08-12","2013-08-13","2013-08-14","2013-08-15","2013-08-16","2013-08-17","2013-08-18","2013-08-19","2013-08-20","2013-08-21","2013-08-22","2013-08-23","2013-08-24","2013-08-25","2013-08-26","2013-08-27","2013-08-28","2013-08-29","2013-08-30","2013-08-31","2013-09-01","2013-09-02","2013-09-03","2013-09-04","2013-09-05","2013-09-06","2013-09-07","2013-09-08","2013-09-09","2013-09-10","2013-09-11","2013-09-12","2013-09-13","2013-09-14","2013-09-15","2013-09-16","2013-09-17","2013-09-18","2013-09-19","2013-09-20","2013-09-21","2013-09-22","2013-09-23","2013-09-24","2013-09-25","2013-09-26","2013-09-27","2013-09-28","2013-09-29","2013-09-30","2013-10-01","2013-10-02","2013-10-03","2013-10-04","2013-10-05","2013-10-06","2013-10-07","2013-10-08","2013-10-09","2013-10-10","2013-10-11","2013-10-12","2013-10-13","2013-10-14","2013-10-15","2013-10-16","2013-10-17","2013-10-18","2013-10-19","2013-10-20","2013-10-21","2013-10-22","2013-10-23","2013-10-24","2013-10-25","2013-10-26","2013-10-27","2013-10-28","2013-10-29","2013-10-30","2013-10-31","2013-11-01","2013-11-02","2013-11-03","2013-11-04","2013-11-05","2013-11-06","2013-11-07","2013-11-08","2013-11-09","2013-11-10","2013-11-11","2013-11-12","2013-11-13","2013-11-14","2013-11-15","2013-11-16","2013-11-17","2013-11-18","2013-11-19","2013-11-20","2013-11-21","2013-11-22","2013-11-23","2013-11-24","2013-11-25","2013-11-26","2013-11-27","2013-11-28","2013-11-29","2013-11-30","2013-12-01","2013-12-02","2013-12-03","2013-12-04","2013-12-05","2013-12-06","2013-12-07","2013-12-08","2013-12-09","2013-12-10","2013-12-11","2013-12-12","2013-12-13","2013-12-14","2013-12-15","2013-12-16","2013-12-17","2013-12-18","2013-12-19","2013-12-20","2013-12-21","2013-12-22","2013-12-23","2013-12-24","2013-12-25","2013-12-26","2013-12-27","2013-12-28","2013-12-29","2013-12-30","2013-12-31","2014-01-01","2014-01-02","2014-01-03","2014-01-04","2014-01-05","2014-01-06","2014-01-07","2014-01-08","2014-01-09","2014-01-10","2014-01-11","2014-01-12","2014-01-13","2014-01-14","2014-01-15","2014-01-16","2014-01-17","2014-01-18","2014-01-19","2014-01-20","2014-01-21","2014-01-22","2014-01-23","2014-01-24","2014-01-25","2014-01-26","2014-01-27","2014-01-28","2014-01-29","2014-01-30","2014-01-31","2014-02-01","2014-02-02","2014-02-03","2014-02-04","2014-02-05","2014-02-06","2014-02-07","2014-02-08","2014-02-09","2014-02-10","2014-02-11","2014-02-12","2014-02-13","2014-02-14","2014-02-15","2014-02-16","2014-02-17","2014-02-18","2014-02-19","2014-02-20","2014-02-21","2014-02-22","2014-02-23","2014-02-24","2014-02-25","2014-02-26","2014-02-27","2014-02-28","2014-03-01","2014-03-02","2014-03-03","2014-03-04","2014-03-05","2014-03-06","2014-03-07","2014-03-08","2014-03-09","2014-03-10","2014-03-11","2014-03-12","2014-03-13","2014-03-14","2014-03-15","2014-03-16","2014-03-17","2014-03-18","2014-03-19","2014-03-20","2014-03-21","2014-03-22","2014-03-23","2014-03-24","2014-03-25","2014-03-26","2014-03-27","2014-03-28","2014-03-29","2014-03-30","2014-03-31","2014-04-01","2014-04-02","2014-04-03","2014-04-04","2014-04-05","2014-04-06","2014-04-07","2014-04-08","2014-04-09","2014-04-10","2014-04-11","2014-04-12","2014-04-13","2014-04-14","2014-04-15","2014-04-16","2014-04-17","2014-04-18","2014-04-19","2014-04-20","2014-04-21","2014-04-22","2014-04-23","2014-04-24","2014-04-25","2014-04-26","2014-04-27","2014-04-28","2014-04-29","2014-04-30","2014-05-01","2014-05-02","2014-05-03","2014-05-04","2014-05-05","2014-05-06","2014-05-07","2014-05-08","2014-05-09","2014-05-10","2014-05-11","2014-05-12","2014-05-13","2014-05-14","2014-05-15","2014-05-16","2014-05-17","2014-05-18","2014-05-19","2014-05-20","2014-05-21","2014-05-22","2014-05-23","2014-05-24","2014-05-25","2014-05-26","2014-05-27","2014-05-28","2014-05-29","2014-05-30","2014-05-31","2014-06-01","2014-06-02","2014-06-03","2014-06-04","2014-06-05","2014-06-06","2014-06-07","2014-06-08","2014-06-09","2014-06-10","2014-06-11","2014-06-12","2014-06-13","2014-06-14","2014-06-15","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-20","2014-06-21","2014-06-22","2014-06-23","2014-06-24","2014-06-25","2014-06-26","2014-06-27","2014-06-28","2014-06-29","2014-06-30"],"y":[21,21,21,21,21,23,22,22,22,22,21,20,20,20,20,20,19,19,20,20,19,19,20,19,19,19,19,18,18,19,18,19,19,19,19,19,19,18,19,19,19,19,18,18,18,18,18,18,17,19,20,22,23,22,20,20,20,20,20,19,21,19,20,19,19,18,18,19,19,20,20,19,17,17,16,16,16,15,15,16,16,16,16,16,15,15,15,17,17,16,16,16,15,16,17,18,17,16,16,18,20,21,22,23,23,21,20,18,18,19,20,20,19,20,19,18,18,19,19,18,16,15,16,18,21,23,21,19,21,24,21,18,18,18,18,18,19,19,20,21,21,20,19,18,19,19,21,22,23,24,23,22,22,20,20,19,19,21,23,26,25,25,24,23,21,21,25,31,32,30,28,28,29,32,35,39,39,38,45,49,46,48,40,39,36,43,41,39,34,35,36,36,39,38,37,38,42,42,44,43,41,42,43,44,47,48,51,56,54,51,51,52,55,56,54,53,56,57,55,60,63,64,64,62,59,55,50,45,46,51,52,51,54,51,51,57,57,56,55,49,48,50,52,53,56,57,56,56,51,50,51,54,55,55,48,43,42,34,32,33,32,34,36,38,36,34,34,33,31,30,29,30,30,31,30,30,30,30,30,30,30,31,30,32,31,29,27,26,26,26,25,25,25,24,24,23,23,24,23,23,23,23,22,22,23,22,22,22,22,22,22,21,21,21,21,21,21,20,21,20,20,20,19,20,19,19,19,19,18,18,18,19,19,19,19,19,18,18,18,18,19,18,18,18,18,18,18,18,17,17,18,18,18,18,18,18,17,17,18,17,16,16,16,16,17,14,13,13,13,14,13,13,13,13,14,14,13,13,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,13,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,12,12,13,13,12,12,13,12,12,13,12,13,13,13,13,13,12,13,13,13,13,13,13,14,17,19,18,18,17,16,17,17,18,19,17,18,20,19,20,22,19,18,17,17,19,20,18,19,18,16,14,15,14,14,14,13,13,13,14,15,16,19,24,24,22,22,20,20,19,19,19,20,23,25,24,27,29,27,31,35,27,20,18,22,27,29,23,26,32,29,28,27,24,21,23,31,32,33,38,40,41,41,43,43,44,40,39,37,39,37,37,38,41,41,40,41,49,57,59,54,55,54,51,48,47,47,47,48,54,61,66,74,73,72,77,76,73,76,80,77,66,70,73,69,67,66,69,74,81,77,70,66,67,71,69,65,63,51,52,55,62,65,61,60,59,58,55,55,58,59,60,65,68,64,69,71,73,66,66,63,62,60,61,55,57,56,56,60,48,47,41,45,46,40,38,40,43,48,51,48,48,51,58,69,61,51,46,48,51,52,54,52,48,43,39,38,39,41,39,36,37,36,38,40,41,41,39,39,36,34,33,33,32,31,29,28,27,26,27,27,25,25,25,24,24,24,24,23,23,23,23,23,23,22,21,21,21,21,21,21,21,21,20,20,20,20,20,20,19,19,20,20,20,20,20,19,19,19,19,19,20,31,23,21,20,20,20,23,22,20,19,18,18,18,18,18,18,18,18,17,18,18,17,18,17,16,16,16,16,16,16,16,16,17,18,18,19,19,18,18,18,18,18,17,17,18,18,18,18,18,18,18,18,18,18,18,18,17,17,17,17,17,17,18,18,18,18,18,18,17,18,17,17,17,17,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,16,17,17,17,18,17,18,17,17,19,20,21,20,20,19,19,19,20,20,20,20,22,22,21,19,18,18,18,17,18,18,18,18,19,22,22,22,20,19,18,18,18,18,18,18,18,18,19,21,23,25,27,26,23,24,25,25,25,22,21,20,19,19,18,18,18,18,19,20,23,25,29,31,35,38,44,46,40,33,31,32,39,41,44,46,41,39,43,48,55,54,45,42,42,42,43,45,44,37,34,35,41,42,44,44,41,43,50,57,57,57,58,61,60,58,60,61,50,43,39,40,44,49,48,46,48,48,51,55,58,54,58,63,64,63,58,65,66,70,83,90,96,96,97,104,102,102,98,99,95,95,86,90,82,74,67,70,60,51,51,55,57,56,55,66,77,85,85,121,110,102,83,76,78,73,69,67,58,52,47,44,44,45,47,45,44,45,46,45,39,36,38,37,38,38,37,34,33,35,35,33,32,32,31,32,32,32,31,31,29,30,29,30,28,29,30,31,31,30,30,28,27,26,26,25,25,25,25,24,24,23,23,22,22,22,22,22,22,23,23,23,23,23,23,23,23,22,22,22,21,21,21,21,20,20,20,20,21,20,20,20,20,20,19,19,19,19,19,19,18,18,18,18,18,18,18,18,19,17,18,20,18,18,19,19,20,20,21,21,21,20,20,20,20,20,19,19,19,18,18,18,18,18,18,18,17,17,18,18,16,16,17,17,18,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,17,16,16,16,16,16,15,16,16,16,16,16,16,16,16,16,16,16,15,16,16,16,16,15,15,16,16,17,18,18,18,17,17,16,16,16,16,16,16,18,20,19,18,17,17,17,17,16,18,17,18,17,18,18,17,17,17,16,16,16,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,18,19,19,18,18,20,21,22,22,25,26,26,26,23,20,20,18,18,17,18,18,22,26,25,27,24,22,22,22,28,33,40,33,31,30,31,25,24,31,38,35,41,47,46,40,34,38,44,49,51,46,43,38,38,40,42,44,46,46,50,52,43,48,55,45,47,55,61,63,68,68,68,72,75,72,79,85,91,97,106,116,110,104,102,100,96,91,88,89,79,78,86,92,91,91,89,84,80,85,91,95,88,89,91,85,75,81,76,72,69,65,65,64,63,60,61,68,71,69,66,57,57,57,56,57,60,62,61,63,61,63,63,62,51,46,45,46,45,45,44,46,46,50,43,43,43,43,44,43,42,42,41,41,42,42,39,37,36,37,36,35,33,34,34,33,33,33,33,34,35,34,34,34,32,33,32,30,28,28,27,28,28,28,27,26,26,26,26,24,25,25,25,25,24,23,23,23,23,23,23,23,23,23,23,23,23,23,22,23,22,23,23,23,23,24,24,23,23,23,22,22,22,21,21,21,21,21,21,21,19,19,19,19,19,19,19,18,18,18,18,19,19,18,18,18,17,18,18,18,18,17,17,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17],"type":"scatter","mode":"lines","line":{"color":"rgba(30,144,255,1)","width":0.69999999999999996},"opacity":1,"marker":{"color":"rgba(30,144,255,1)","line":{"color":"rgba(30,144,255,1)"}},"textfont":{"color":"rgba(30,144,255,1)"},"error_y":{"color":"rgba(30,144,255,1)"},"error_x":{"color":"rgba(30,144,255,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4: Plot of the Guido’s streamflow time series (hydrologial year 2010/11 to 2013/14).
</p>
</div>
</div>
<p>As depicted in Figure <a href="#fig:guido-plot-html">4</a> the time
series shows the effect of instrumental oscillations during the low water
flow periods.
One possible solution is to smooth the series using a moving average window.
To do this <a href="#">hydrotoolbox</a> provides the <code>hm_mutate</code>
method, a function that enable object’s data manipulation. In this
example we combined the aforementioned method with the package’s
function <code>roll_fun</code>. Furthermore, in order to show another <code>hm_mutate</code>
case, we removed two periods with records below a minimum
admissible value by setting them to <code>NA_real_</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># smooth with roll_fun</span></span>
<span><span class='va'>guido</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_mutate.html'>hm_mutate</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qd"</span>,</span>
<span>            FUN <span class='op'>=</span> <span class='va'>roll_fun</span>,</span>
<span>            col_name <span class='op'>=</span> <span class='st'>"last"</span>,</span>
<span>            pos <span class='op'>=</span> <span class='st'>"c"</span>,</span>
<span>            k <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>            <span class='va'>mean</span>,</span>
<span>            out_name <span class='op'>=</span> <span class='st'>"q_smooth"</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># remove doubtful records with set_value</span></span>
<span><span class='va'>guido</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_mutate.html'>hm_mutate</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qd"</span>,</span>
<span>            FUN <span class='op'>=</span> <span class='va'>set_value</span>,</span>
<span>            col_name <span class='op'>=</span> <span class='st'>"q_smooth"</span>,</span>
<span>            out_name <span class='op'>=</span> <span class='st'>"q_set"</span>,</span>
<span>            value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA_real_</span>, <span class='fl'>2</span><span class='op'>)</span>,</span>
<span>            from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1965-08-09"</span>, <span class='st'>"1974-06-26"</span><span class='op'>)</span>,</span>
<span>            to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1965-08-25"</span>, <span class='st'>"1974-07-04"</span><span class='op'>)</span> <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>
After executing these expressions, the original and new series remain
stored in the same object. This feature avoids having multiple file
versions and allows to track the time series modifications,
achieving the second package’s design principle
<em>Modifications must be recorded in the same file</em>.</p>
<p>Moving forwards, the following code lines show how to temporally
aggregate this series at a monthly resolution via <code>hm_agg</code> and how
to extract this new series and the basin area out of the
<em>guido</em> object using <code>hm_get</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># aggregate daily mean streamflow </span></span>
<span><span class='co'># to mean monthly values</span></span>
<span><span class='va'>guido</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_agg.html'>hm_agg</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qd"</span>,</span>
<span>         col_name <span class='op'>=</span> <span class='st'>"q_set"</span>, </span>
<span>         fun <span class='op'>=</span> <span class='st'>"mean"</span>, </span>
<span>         period <span class='op'>=</span> <span class='st'>"monthly"</span>, </span>
<span>         out_name <span class='op'>=</span> <span class='st'>"q_mean"</span>, </span>
<span>         relocate <span class='op'>=</span> <span class='st'>"qm"</span>, </span>
<span>         allow_na <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># extract the table </span></span>
<span><span class='va'>tb_q_month</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_get.html'>hm_get</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qm"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># extract baisn area</span></span>
<span><span class='va'>basin_area</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_get.html'>hm_get</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"basin_area"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>
In <code>hm_agg</code> we allow a maximum of two missing daily discharge records
to compute the mean monthly streamflow and then, <code>hm_get</code> extracts this
table so that the user may save and share it with others in <em>CSV</em> format.
At this point is important to clarify that while <code>hm_get</code> method extracts
any slot’s data, the function <code>hm_show</code> just prints the desired slot.</p>
<p>To conclude this first case study the monthly streamflow is
plotted (Figure <a href="#fig:guido-ggplot">5</a>). As the <code>hm_plot</code>
function generates a <code>ggplot2</code> object (when <code>interactive = FALSE</code>)
the user can save and customize the graph to any style requirement.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># library</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># plot</span></span>
<span><span class='va'>gg_hm</span> <span class='op'>&lt;-</span></span>
<span>  <span class='va'>guido</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_plot.html'>hm_plot</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"qm"</span>, </span>
<span>          col_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"q_mean"</span><span class='op'>)</span> <span class='op'>)</span>, </span>
<span>          line_color <span class='op'>=</span> <span class='st'>"dodgerblue"</span>,</span>
<span>          line_size <span class='op'>=</span> <span class='fl'>.7</span>,</span>
<span>          y_lab <span class='op'>=</span> <span class='st'>"Q(m3/s)"</span>, x_lab <span class='op'>=</span> <span class='st'>""</span>, </span>
<span>          legend_lab <span class='op'>=</span> <span class='st'>"Mendoza River"</span>, </span>
<span>          from <span class='op'>=</span> <span class='st'>"1980-07-01"</span>, to <span class='op'>=</span> <span class='st'>"1990-06-30"</span><span class='op'>)</span> </span>
<span>  </span>
<span> <span class='co'># customize the graph</span></span>
<span><span class='va'>gg_out</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>gg_hm</span> <span class='op'>+</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_light</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span> date_breaks <span class='op'>=</span> <span class='st'>"4 month"</span>, date_labels <span class='op'>=</span> <span class='st'>"%Y-%m"</span> <span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>300</span>, <span class='fl'>50</span><span class='op'>)</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>300</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>          axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>          axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, vjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>          axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>, </span>
<span>          legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span>        </span>
<span></span>
<span><span class='va'>gg_out</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:guido-ggplot"></span>
<img src="RJ-2023-041_files/figure-html5/guido-ggplot-1.png" alt="Example of customized time-series plot using the $\texttt{hm\_plot()}$ method in combination with labeling, scaling and theme options available on $\textbf{ggplot2}$." width="100%" />
<p class="caption">
Figure 5: Example of customized time-series plot using the <span class="math inline">\(\texttt{hm\_plot()}\)</span> method in combination with labeling, scaling and theme options available on <span class="math inline">\(\textbf{ggplot2}\)</span>.
</p>
</div>
</div>
<h3 data-number="3.2" id="post-processing-of-the-hbv.ianigla-hydrological-model"><span class="header-section-number">3.2</span> Post processing of the HBV.IANIGLA hydrological model</h3>
<p>The second case study shows how to use the package for post-processing a
numerical model output series. Specifically, it illustrates another
<code>hm_mutate</code> case but in combination with another package function
(<code>mutate</code> from <a href="https://cran.r-project.org/package=dplyr">dplyr</a> package; <span class="citation" data-cites="dplyr:2021">Wickham et al. (<a href="#ref-dplyr:2021" role="doc-biblioref">2021</a>)</span>). The exercise
proposes to transform the units of the Cuevas River basin
(Figure <a href="#fig:mza-basin">3</a>) glacier mass balance simulations
from <em>millimeters of water equivalent</em> to <em>meters of water equivalent</em>
and then plot it (Figure <a href="#fig:cuevas-mb">6</a>). The
data for this example has been previously loaded into an
<code>hydromet_compact</code> class object and the reader can download
the file from <a href="https://gitlab.com/ezetoum27/hydrotoolbox/-/tree/master/my_data" class="uri">https://gitlab.com/ezetoum27/hydrotoolbox/-/tree/master/my_data</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># dplyr contains mutate()</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># glacier mass balance simulation</span></span>
<span><span class='va'>cuevas_mb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"data/cuevas_mb.rds"</span> <span class='op'>)</span></span>
<span></span>
<span><span class='va'>cuevas_mb</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>cuevas_mb</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_mutate.html'>hm_mutate</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"compact"</span>,</span>
<span>            FUN <span class='op'>=</span> <span class='va'>mutate</span>, </span>
<span>            `bm (m we)` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span> <span class='va'>cuevas</span> <span class='op'>/</span> <span class='fl'>1000</span>, <span class='fl'>2</span> <span class='op'>)</span>,</span>
<span>            .keep <span class='op'>=</span> <span class='st'>"all"</span></span>
<span>            <span class='op'>)</span> </span>
<span></span>
<span><span class='va'>cuevas_mb</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_show.html'>hm_show</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>$compact
        date cuevas bm (m we)
1 1981-04-01      0      0.00
2 1982-04-01   1240      1.24
3 1983-04-01    130      0.13
4 1984-04-01    350      0.35
5 1985-04-01    -80     -0.08
6 1986-04-01    350      0.35</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># use hm_plot()</span></span>
<span><span class='va'>gg_out</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>cuevas_mb</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/hydrotoolbox/man/hm_plot.html'>hm_plot</a></span><span class='op'>(</span>slot_name <span class='op'>=</span> <span class='st'>"compact"</span>, </span>
<span>          col_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"bm (m we)"</span><span class='op'>)</span>, </span>
<span>          line_color <span class='op'>=</span> <span class='st'>"red3"</span>, </span>
<span>          line_size <span class='op'>=</span> <span class='fl'>.7</span>, </span>
<span>          x_lab <span class='op'>=</span> <span class='st'>""</span>, y_lab <span class='op'>=</span> <span class='st'>"MB (m we)"</span>  <span class='op'>)</span></span>
<span>  </span>
<span><span class='co'># customize the figure</span></span>
<span><span class='va'>gg_out</span> <span class='op'>+</span> </span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"blue"</span>, size <span class='op'>=</span> <span class='fl'>.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_light</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span> date_breaks <span class='op'>=</span> <span class='st'>"2 year"</span>, date_labels <span class='op'>=</span> <span class='st'>"%Y"</span> <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.5</span>, <span class='fl'>1.5</span>, <span class='fl'>0.25</span><span class='op'>)</span>,</span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.5</span>, <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>        axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>        axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, vjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>        axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>, </span>
<span>        legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> </span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cuevas-mb"></span>
<img src="RJ-2023-041_files/figure-html5/cuevas-mb-1.png" alt="Model post-processing case example for the Cuevas basin annual glacier mass balance." width="100%" />
<p class="caption">
Figure 6: Model post-processing case example for the Cuevas basin annual glacier mass balance.
</p>
</div>
</div>
<p>
This simple example suggests that <a href="#">hydrotoolbox</a> is not only
suited for managing hydrometeorological series, but also for pre
and post processing hydrological modeling data.</p>
<h2 data-number="4" id="discussion"><span class="header-section-number">4</span> Discussion</h2>
<p>The R language community has made significant advances in the development
of hydrological packages, with many of them focusing on data access,
numerical modeling, and pre/post-processing <span class="citation" data-cites="slater:2019">(<a href="#ref-slater:2019" role="doc-biblioref">Slater et al. 2019</a>)</span>. The new
<a href="#">hydrotoolbox</a> package offers a general framework and methods for working with
hydrometeorological time series data management. To our knowledge, this
is the first general-purpose package for manipulating and visualizing
hydrometeorological data to this date.<br />
In the literature there are at least two other packages available in the
CRAN repository that have some functionalities that could be considered
similar to <a href="#">hydrotoolbox</a>, namely <a href="#">hyfo</a> and <a href="#">hydroTSM</a>
<span class="citation" data-cites="hyfo:2020 zambrano:2020">(<a href="#ref-hyfo:2020" role="doc-biblioref">Xu 2020</a>; <a href="#ref-zambrano:2020" role="doc-biblioref">Zambrano-Bigiarini 2020</a>)</span>. The first one was designed
as part of the European project EUPORIAS, and it is mainly focused
on data processing and visualization for hydrological and weather forecasting.
Therefore, this package’s functions are specialized in spatial data
(e.g., NetCDF) in contrast to <a href="#">hydrotoolbox</a> which focuses on
hydrometeorological stations recorded time series.
Additionally, <a href="#">hyfo</a> uses <a href="#">ggplot2</a> for visualization, which
can be used to create publication-quality static graphs but not interactive
visualizations. The other package, <a href="#">hydroTSM</a>, is oriented towards tasks
related to modeling, a shared feature with <a href="#">hydrotoolbox</a> but lacks
of a general-purpose system for hydrometeorological time series manipulation.
In programming terms, we think that object-oriented programming
(encapsulated or functional) is an essential mechanism for dealing with the
diversity of available data, while keeping things simpler for the user.
In addition, this paradigm makes <a href="#">hydrotoolbox</a> robust in the following
aspects:</p>
<ol type="a">
<li><p>There are specific methods for manipulating and visualizing the objects
that can be created with the package. This feature makes the workflow
less prone to user error because specific and dedicated functions should
be used to access the data.</p></li>
<li><p>The objects and the modifications that the user makes to the data time
series are stored in the same object, avoiding the duplication of records
that can occur in other datasets.</p></li>
<li><p>Once data has been incorporated, it is easy to get access and plot them.
Additionally, <a href="#">hydrotoolbox</a> allows saving the metadata which is a desirable
feature when working with meteorological stations, data from numerical modeling, or
series from large-sample hydrological datasets <span class="citation" data-cites="addor:2020">(<a href="#ref-addor:2020" role="doc-biblioref">Addor et al. 2020</a>)</span>.</p></li>
</ol>
<p><!-- d. As there is a single class and two sublcasses, creating new methods  -->
<!-- should fit this data structures (`hydromet`, `hydromet_station` and -->
<!-- `hydromet_compact` - Figure \@ref(fig:class-htb)) making this  -->
<!-- task less prone to programming error. We hope this feature will -->
<a href="#">hydrotoolbox</a></p>
<p><!-- d. The package allows the user to easily define new methods and objects to -->
<!-- further expand its capabilities. -->
Although <a href="#">hyfo</a> and <a href="#">hydroTSM</a> overlap with <a href="#">hydrotoolbox</a>
in terms of numerical modeling and pre- and post-processing tasks,
neither of these two packages (or those mentionned previously) explicitly
cover hydrometeorological stations data management nor
provide a general working framework for this kind of records.</p>
<p>The package can be used in many applications and the user can also adapt
existing functions or packages with <a href="#">hydrotoolbox</a>’s framework.
As case examples, the package’s vignettes show how the <a href="https://cran.r-project.org/package=tidyhydat">tidyhydat</a>
<span class="citation" data-cites="tidyhydat:2017">(<a href="#ref-tidyhydat:2017" role="doc-biblioref">Albers 2017</a>)</span> and <strong>weathercan</strong> <span class="citation" data-cites="weathercan:2018">(<a href="#ref-weathercan:2018" role="doc-biblioref">LaZerte and Albers 2018</a>)</span> can be combined to work
with Canadian hydrometeorological records
(see <code>vignette(topic = "tidyhydat_can", package = "hydrotoolbox")</code> and
<code>vignette(topic = "weathercan_can", package = "hydrotoolbox")</code>).</p>
<p>In a recent publication, <span class="citation" data-cites="addor:2020">Addor et al. (<a href="#ref-addor:2020" role="doc-biblioref">2020</a>)</span> made a review of the current
state of large-sample hydrology (LSH) datasets. The authors proposed
general guidelines to support the creation of future LSH with some of
them listed here,</p>
<ol type="1">
<li><p><strong>provide basic data for each basin</strong>, with streamflow records being
the cornerstone. The metadata should include the name, unique identifier,
river and geographical coordinates of each streamgauge, catchment area
and elevation info.<br />
<a href="#">hydrotoolbox</a> provides all the objects with this metadata.</p></li>
<li><p><strong>following standards when naming variables</strong>. Despite the fact that
the package doesn’t have the WATER ML-2
(<a href="https://www.ogc.org/standards/waterml" class="uri">https://www.ogc.org/standards/waterml</a> - last access 2022-10-13)
variable names, the purpose of this feature is to ensure the
consistency and comparability of environmental datasets.
This R package provides with a description for each variable,
allowing possible inter-dataset comparisons.</p></li>
<li><p><strong>use publicly available code for data processing</strong>, making code
for producing the LSH dataset available. This feature is important
among free and open source software (FOSS).<br />
As a case example, the CAMELS dataset <span class="citation" data-cites="camila:2018 addor:2017">(<a href="#ref-addor:2017" role="doc-biblioref">Addor et al. 2017</a>; <a href="#ref-camila:2018" role="doc-biblioref">Alvarez-Garreton et al. 2018</a>)</span> provides
their users with a GitHub repository with code written in R
(<a href="https://github.com/naddor/camels" class="uri">https://github.com/naddor/camels</a>). Despite this, the repository
contains a set of functions instead of a package that can be installed
in many operating systems, with documented functions and reproducible
examples. The specialized <a href="#">hydrotoolbox</a> may provide a general framework
to integrate this functions.</p></li>
</ol>
<p>Though there are similar and commonly used software in departments related
to the management of hydrometeorological data, they are closed-source
proprietary programs. <a href="#">hydrotoolbox</a> is a FOSS, which
is a key feature not only from the research perspective but also
for hydrological
practice. Open source brings transparency to the decision-making
and hydrological design processes, and helps to save license money
in emerging countries <span class="citation" data-cites="hutton:2016">(<a href="#ref-hutton:2016" role="doc-biblioref">Hutton et al. 2016</a>)</span>.</p>
<p>To conclude this discussion, some users may have used the
older <a href="https://cran.r-project.org/package=hydroToolkit">hydroToolkit</a> package. This turned out to be an
early version of <a href="#">hydrotoolbox</a> that we decided to reform after
using it in a large project. We realized that the original five
subclasses could be reduced to two, simplifying not only their use
but also improving their long-term maintainability. In addition, we decided
to improve several methods (e.g., time series visualization) that were
limited in functionality. Also, to elaborate the syntax of the functions,
methods and their arguments, we followed the suggestions of
<em>The tidyverse style guide</em> document <span class="citation" data-cites="tidystyle">(<a href="#ref-tidystyle" role="doc-biblioref">Wickham 2023</a>)</span>, adapting the package
to the new standards used within the community of R programmers.</p>
<h2 data-number="5" id="summary"><span class="header-section-number">5</span> Summary</h2>
<p><a href="#">hydrotoolbox</a> is an new contribution to the R hydrological community,
as it is specifically designed for working with hydrometeorological
station records. The package allows the data to be viewed
interactively3 (<a href="#">plotly</a>) or statically (<a href="#">ggplot2</a>) using the same method
(<code>hm_plot</code>),3 it also allows the use of functions from other packages or
created by the user via the <code>hm_mutate</code> method.</p>
<p>The case studies show two examples with different aims: the first processed
a streamflow record and the second uses a numerical model output to
plot results. More complete and varied examples are in the documentation of the
package and in3 its vignettes (<code>vignette(package = "hydrotoolbox")</code>).</p>
<p><a href="#">hydrotoolbox</a> is designed to incorporate future improvements. One of them
could be functions for visualizing station’s geographical position
(using the metadata) on an
interactive map, and perhaps to allow the user to plot and compare recorded
time series. This new function could use capabilities of the
<a href="https://cran.r-project.org/package=leaflet">leaflet</a> package, a JavaScript library for producing interactive maps.
The main class, <code>hydromet</code>, could also combine the functionality of
existing packages such as <a href="https://cran.r-project.org/package=raster">raster</a> <span class="citation" data-cites="raster:2017">(<a href="#ref-raster:2017" role="doc-biblioref">Hijmans 2017</a>)</span> or <a href="https://cran.r-project.org/package=sf">sf</a>
<span class="citation" data-cites="sf:2018">(<a href="#ref-sf:2018" role="doc-biblioref">Pebesma 2018</a>)</span> to include other kind of spatial data (e.g., catchment
boundary, soil types, gridded meteorological data, among others).
Finally, new classes and methods could be included for processing field data
from glacier mass balance studies, an activity closely related to the study
of the hydrological cycle in cold regions. This kind of improvements may
also make the package useful in other scientific communities such as glaciology.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="5.1" id="supplementary-materials"><span class="header-section-number">5.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-041.zip">RJ-2023-041.zip</a></p>
<h3 class="appendix" data-number="5.2" id="cran-packages-used"><span class="header-section-number">5.2</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=waterData">waterData</a>, <a href="https://cran.r-project.org/package=hydroTSM">hydroTSM</a>, <a href="https://cran.r-project.org/package=dataRetrieval">dataRetrieval</a>, <a href="https://cran.r-project.org/package=hyfo">hyfo</a>, <a href="https://cran.r-project.org/package=hydrotoolbox">hydrotoolbox</a>, <a href="https://cran.r-project.org/package=HBV.IANIGLA">HBV.IANIGLA</a>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=plotly">plotly</a>, <a href="https://cran.r-project.org/package=dplyr">dplyr</a>, <a href="https://cran.r-project.org/package=tidyhydat">tidyhydat</a>, <a href="https://cran.r-project.org/package=hydroToolkit">hydroToolkit</a>, <a href="https://cran.r-project.org/package=leaflet">leaflet</a>, <a href="https://cran.r-project.org/package=raster">raster</a>, <a href="https://cran.r-project.org/package=sf">sf</a></p>
<h3 class="appendix" data-number="5.3" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">5.3</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Databases">Databases</a>, <a href="https://cran.r-project.org/view=Hydrology">Hydrology</a>, <a href="https://cran.r-project.org/view=ModelDeployment">ModelDeployment</a>, <a href="https://cran.r-project.org/view=Phylogenetics">Phylogenetics</a>, <a href="https://cran.r-project.org/view=Spatial">Spatial</a>, <a href="https://cran.r-project.org/view=SpatioTemporal">SpatioTemporal</a>, <a href="https://cran.r-project.org/view=TeachingStatistics">TeachingStatistics</a>, <a href="https://cran.r-project.org/view=WebTechnologies">WebTechnologies</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-addor:2020" class="csl-entry" role="listitem">
N. Addor, H. X. Do, C. Alvarez-Garreton, G. Coxon, K. Fowler and P. A. Mendoza. Large-sample hydrology: Recent progress, guidelines for new datasets and grand challenges. <em>Hydrological Sciences Journal</em>, 65: 712–725, 2020. URL <a href="https://doi.org/10.1080/02626667.2019.1683182">https://doi.org/10.1080/02626667.2019.1683182</a> [online; last accessed August 23, 2021].
</div>
<div id="ref-addor:2017" class="csl-entry" role="listitem">
N. Addor, A. J. Newman, N. Mizukami and M. P. Clark. The <span>CAMELS</span> data set: Catchment attributes and meteorology for large-sample studies. <em>Hydrology and Earth System Sciences</em>, 21(10): 5293–5313, 2017. URL <a href="https://hess.copernicus.org/articles/21/5293/2017/">https://hess.copernicus.org/articles/21/5293/2017/</a> [online; last accessed August 26, 2021]. Publisher: Copernicus GmbH.
</div>
<div id="ref-tidyhydat:2017" class="csl-entry" role="listitem">
S. Albers. Tidyhydat: Extract and tidy canadian hydrometric data. <em>The Journal of Open Source Software</em>, 2(20): 2017. URL <a href="http://dx.doi.org/10.21105/joss.00511">http://dx.doi.org/10.21105/joss.00511</a>.
</div>
<div id="ref-camila:2018" class="csl-entry" role="listitem">
C. Alvarez-Garreton, P. A. Mendoza, J. P. Boisier, N. Addor, M. Galleguillos, M. Zambrano-Bigiarini, A. Lara, C. Puelma, G. Cortes, R. Garreaud, et al. The <span>CAMELS</span>-<span>CL</span> dataset: Catchment attributes and meteorology for large sample studies – <span>Chile</span> dataset. <em>Hydrology and Earth System Sciences</em>, 22(11): 5817–5846, 2018. URL <a href="https://www.hydrol-earth-syst-sci.net/22/5817/2018/">https://www.hydrol-earth-syst-sci.net/22/5817/2018/</a> [online; last accessed October 29, 2019]. 0371.
</div>
<div id="ref-beven:2012" class="csl-entry" role="listitem">
K. J. Beven. <em>Rainfall - <span>Runoff</span> <span>Modelling</span>.</em> 2 edition Chichester: Wiley, 2012.
</div>
<div id="ref-chambers:2017" class="csl-entry" role="listitem">
J. M. Chambers. <em>Extending <span>R</span>.</em> CRC Press, 2017.
</div>
<div id="ref-saga:2015" class="csl-entry" role="listitem">
O. Conrad, B. Bechtel, M. Bock, H. Dietrich, E. Fischer, L. Gerlitz, J. Wehberg, V. Wichmann and J. Böhner. System for <span>Automated</span> <span>Geoscientific</span> <span>Analyses</span> (<span>SAGA</span>) v. 2.1.4. <em>Geoscientific Model Development</em>, 8(7): 2015. URL <a href="https://www.geosci-model-dev.net/8/1991/2015/gmd-8-1991-2015.html">https://www.geosci-model-dev.net/8/1991/2015/gmd-8-1991-2015.html</a> [online; last accessed January 30, 2020].
</div>
<div id="ref-climate:2020" class="csl-entry" role="listitem">
B. Czernecki, A. Głogowski and J. Nowosad. Climate: <span>An</span> <span>R</span> <span>Package</span> to <span>Access</span> <span>Free</span> <span>In</span>-<span>Situ</span> <span>Meteorological</span> and <span>Hydrological</span> <span>Datasets</span> <span>For</span> <span>Environmental</span> <span>Assessment</span>. <em>Sustainability</em>, 12(1): 2020. URL <a href="https://www.mdpi.com/2071-1050/12/1/394">https://www.mdpi.com/2071-1050/12/1/394</a> [online; last accessed November 1, 2022].
</div>
<div id="ref-cicco:2018" class="csl-entry" role="listitem">
L. A. De Cicco, D. Lorenz, R. M. Hirsch, W. Watkins and M. Johnson. <em>dataRetrieval: R packages for discovering and retrieving water data available from u.s. Federal hydrologic web services.</em> Reston, VA: U.S. Geological Survey; U.S. Geological Survey, 2018. URL <a href="https://code.usgs.gov/water/dataRetrieval">https://code.usgs.gov/water/dataRetrieval</a>.
</div>
<div id="ref-donoho:2017" class="csl-entry" role="listitem">
D. Donoho. 50 <span>Years</span> of <span>Data</span> <span>Science</span>. <em>Journal of Computational and Graphical Statistics</em>, 26(4): 745–766, 2017. URL <a href="https://amstat.tandfonline.com/doi/full/10.1080/10618600.2017.1384734">https://amstat.tandfonline.com/doi/full/10.1080/10618600.2017.1384734</a> [online; last accessed April 30, 2020]. Publisher: Taylor &amp; Francis.
</div>
<div id="ref-goodinson:1998" class="csl-entry" role="listitem">
Goodinson and Louie. <span>WMO</span> <span>Solid</span> <span>Precipitation</span> <span>Measurement</span> <span>Intercomparison</span>. 67, 318 pages. WMO. 1998. 0348.
</div>
<div id="ref-raster:2017" class="csl-entry" role="listitem">
R. J. Hijmans. <em>Raster: Geographic data analysis and modeling.</em> 2017. URL <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>. R package version 2.6-7.
</div>
<div id="ref-hutton:2016" class="csl-entry" role="listitem">
C. Hutton, T. Wagener, J. Freer, D. Han, C. Duffy and B. Arheimer. Most computational hydrology is not reproducible, so is it really science? <em>Water Resources Research</em>, 52(10): 7548–7555, 2016. URL <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1002/2016WR019285">https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1002/2016WR019285</a> [online; last accessed June 18, 2019].
</div>
<div id="ref-weathercan:2018" class="csl-entry" role="listitem">
S. E. LaZerte and S. Albers. <span class="nocase">weathercan</span>: <span>D</span>ownload and format weather data from environment and climate change canada. <em>The Journal of Open Source Software</em>, 3(22): 571, 2018. URL <a href="https://joss.theoj.org/papers/10.21105/joss.00571">https://joss.theoj.org/papers/10.21105/joss.00571</a>.
</div>
<div id="ref-sf:2018" class="csl-entry" role="listitem">
E. Pebesma. <span class="nocase">Simple Features for R: Standardized Support for Spatial Vector Data</span>. <em><span>The R Journal</span></em>, 10(1): 439–446, 2018. URL <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-netcdf:2019" class="csl-entry" role="listitem">
D. Pierce. <em>ncdf4: Interface to unidata netCDF (version 4 or earlier) format data files.</em> 2019. URL <a href="https://CRAN.R-project.org/package=ncdf4">https://CRAN.R-project.org/package=ncdf4</a>. R package version 1.17.
</div>
<div id="ref-ryberg:2017" class="csl-entry" role="listitem">
K. R. Ryberg and A. V. Vecchia. <em>waterData: Retrieval, analysis, and anomaly calculation of daily hydrologic time series data.</em> 2017. URL <a href="https://CRAN.R-project.org/package=waterData">https://CRAN.R-project.org/package=waterData</a>. R package version 1.0.8.
</div>
<div id="ref-plotly_pkg" class="csl-entry" role="listitem">
C. Sievert. <em>Interactive web-based data visualization with r, plotly, and shiny.</em> Chapman; Hall/CRC, 2020. URL <a href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-slater:2019" class="csl-entry" role="listitem">
L. J. Slater, G. Thirel, S. Harrigan, O. Delaigue, A. Hurley, A. Khouakhi, I. Prodoscimi, C. Vitolo and K. Smith. Using <span>R</span> in hydrology: A review of recent developments and future directions. <em>Hydrology and Earth System Sciences Discussions</em>, 1–33, 2019. URL <a href="https://www.hydrol-earth-syst-sci-discuss.net/hess-2019-50/">https://www.hydrol-earth-syst-sci-discuss.net/hess-2019-50/</a> [online; last accessed May 6, 2019].
</div>
<div id="ref-toum:2021" class="csl-entry" role="listitem">
E. Toum. <em><span>HBV.IANIGLA</span>: Modular hydrological model.</em> 2021. URL <a href="https://CRAN.R-project.org/package=HBV.IANIGLA">https://CRAN.R-project.org/package=HBV.IANIGLA</a>. 0.2.0.
</div>
<div id="ref-htoolbox:2021" class="csl-entry" role="listitem">
E. Toum. <em>Hydrotoolbox: Hydrological tools for handling hydro-meteorological data records.</em> 2022. URL <a href="https://CRAN.R-project.org/package=hydrotoolbox">https://CRAN.R-project.org/package=hydrotoolbox</a>. 1.1.0.
</div>
<div id="ref-toum-rj:2021" class="csl-entry" role="listitem">
E. Toum, M. H. Masiokas, R. Villalba, P. Pitte and L. Ruiz. <span>The HBV.IANIGLA Hydrological Model</span>. <em><span>The R Journal</span></em>, 13(1): 378–395, 2021. URL <a href="https://doi.org/10.32614/RJ-2021-059">https://doi.org/10.32614/RJ-2021-059</a>.
</div>
<div id="ref-venkatraman:2013" class="csl-entry" role="listitem">
V. Venkatraman. When <span>All</span> <span>Science</span> <span>Becomes</span> <span>Data</span> <span>Science</span>. <em>Science <span></span> AAAS</em>, 2013. URL <a href="https://www.sciencemag.org/careers/2013/05/when-all-science-becomes-data-science">https://www.sciencemag.org/careers/2013/05/when-all-science-becomes-data-science</a> [online; last accessed April 30, 2020]. Library Catalog: www.sciencemag.org.
</div>
<div id="ref-vitolo:2017" class="csl-entry" role="listitem">
C. Vitolo. Hddtools: Hydrological data discovery tools. <em>The Journal of Open Source Software</em>, 2(9): 2017. DOI <a href="https://doi.org/10.21105/joss.00056">10.21105/joss.00056</a>.
</div>
<div id="ref-ggplot2_pkg" class="csl-entry" role="listitem">
H. Wickham. <em>ggplot2: Elegant graphics for data analysis.</em> Springer-Verlag New York, 2016. URL <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-tidystyle" class="csl-entry" role="listitem">
H. Wickham. <em>The tidyverse style guide.</em> 2023. URL <a href="https://style.tidyverse.org/">https://style.tidyverse.org/</a> [online; last accessed October 4, 2023].
</div>
<div id="ref-dplyr:2021" class="csl-entry" role="listitem">
H. Wickham, R. François, L. Henry and K. Müller. <em>Dplyr: A grammar of data manipulation.</em> 2021. URL <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>. R package version 1.0.5.
</div>
<div id="ref-hadley_r_data" class="csl-entry" role="listitem">
H. Wickham and G. Grolemund. <em>R for <span>Data</span> <span>Science</span>: <span>Import</span>, <span>Tidy</span>, <span>Transform</span>, <span>Visualize</span>, and <span>Model</span> <span>Data</span>.</em> Edición: 1 Sebastopol, CA: O’Reilly Media, 2017.
</div>
<div id="ref-readr_pkg" class="csl-entry" role="listitem">
H. Wickham, J. Hester and J. Bryan. <em>Readr: Read rectangular text data.</em> 2022. URL <a href="https://CRAN.R-project.org/package=readr">https://CRAN.R-project.org/package=readr</a>. R package version 2.1.2.
</div>
<div id="ref-hyfo:2020" class="csl-entry" role="listitem">
Y. Xu. <em>Hyfo: Hydrology and climate forecasting.</em> 2020. URL <a href="https://CRAN.R-project.org/package=hyfo">https://CRAN.R-project.org/package=hyfo</a>. R package version 1.4.3.
</div>
<div id="ref-zambrano:2020" class="csl-entry" role="listitem">
M. Zambrano-Bigiarini. <em>hydroTSM: Time series management, analysis and interpolation for hydrological modelling.</em> 2020. URL <a href="https://github.com/hzambran/hydroTSM">https://github.com/hzambran/hydroTSM</a>. R package version 0.6-0 . doi: https://doi.org/10.5281/zenodo.83964.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Toum &amp; Pitte, "The R Journal: hydrotoolbox, a Package for Hydrometeorological Data Management", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-041,
  author = {Toum, Ezequiel and Pitte, Pierre},
  title = {The R Journal: hydrotoolbox, a Package for Hydrometeorological Data Management},
  journal = {The R Journal},
  year = {2023},
  note = {https://doi.org/10.32614/RJ-2023-041},
  doi = {10.32614/RJ-2023-041},
  volume = {15},
  issue = {2},
  issn = {2073-4859},
  pages = {25-38}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
