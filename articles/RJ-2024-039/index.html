<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>MultiStatM: Multivariate Statistical Methods in R</title>

<meta property="description" itemprop="description" content="The package MultiStatM presents a vectorial approach to multivariate moments and cumulants.  Functions provided concern algorithms to build set partitions and commutator matrices,  multivariate d-Hermite polynomials;  theoretical  vector moments and vector cumulants  of multivariate distributions and their conversion formulae. Applications discussed concern  multivariate measures of skewness and kurtosis;   asymptotic covariances for d-variate Hermite polynomials and multivariate moments and       cumulants;  Gram-Charlier approximations."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2024-039/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-07-14"/>
<meta property="article:created" itemprop="dateCreated" content="2025-07-14"/>
<meta name="article:author" content="György Terdik"/>
<meta name="article:author" content="Emanuele Taufer"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="MultiStatM: Multivariate Statistical Methods in R"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="The package MultiStatM presents a vectorial approach to multivariate moments and cumulants.  Functions provided concern algorithms to build set partitions and commutator matrices,  multivariate d-Hermite polynomials;  theoretical  vector moments and vector cumulants  of multivariate distributions and their conversion formulae. Applications discussed concern  multivariate measures of skewness and kurtosis;   asymptotic covariances for d-variate Hermite polynomials and multivariate moments and       cumulants;  Gram-Charlier approximations."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2024-039/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2024-039/figures/GCALL.png"/>
<meta property="og:image:width" content="975"/>
<meta property="og:image:height" content="506"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="MultiStatM: Multivariate Statistical Methods in R"/>
<meta property="twitter:description" content="The package MultiStatM presents a vectorial approach to multivariate moments and cumulants.  Functions provided concern algorithms to build set partitions and commutator matrices,  multivariate d-Hermite polynomials;  theoretical  vector moments and vector cumulants  of multivariate distributions and their conversion formulae. Applications discussed concern  multivariate measures of skewness and kurtosis;   asymptotic covariances for d-variate Hermite polynomials and multivariate moments and       cumulants;  Gram-Charlier approximations."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2024-039/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2024-039/figures/GCALL.png"/>
<meta property="twitter:image:width" content="975"/>
<meta property="twitter:image:height" content="506"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="MultiStatM: Multivariate Statistical Methods in R"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2024-039"/>
<meta name="citation_pdf_url" content="RJ-2024-039.pdf"/>
<meta name="citation_volume" content="16"/>
<meta name="citation_issue" content="4"/>
<meta name="citation_doi" content="10.32614/RJ-2024-039"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="1"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/07/14"/>
<meta name="citation_publication_date" content="2025/07/14"/>
<meta name="citation_author" content="György Terdik"/>
<meta name="citation_author_institution" content="University of Debrecen"/>
<meta name="citation_author" content="Emanuele Taufer"/>
<meta name="citation_author_institution" content="University of Trento"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=On fundamental skew distributions;citation_publisher=Elsevier;citation_volume=96;citation_author=R B Arellano-Valle;citation_author=Marc G Genton"/>
  <meta name="citation_reference" content="citation_title=The multivariate skew-normal distribution;citation_publisher=Oxford University Press;citation_volume=83;citation_author=A Azzalini;citation_author=A Dalla Valle"/>
  <meta name="citation_reference" content="citation_title=The R package sn: The skew-normal and related distributions such as the skew-t and the SUN (version 2.1.0).;citation_author=A Azzalini"/>
  <meta name="citation_reference" content="citation_title=A revisit of the Gram-Charlier and Edgeworth series expansions;citation_publisher=Department of Physics; Technology, University of Tromsø, The Arctic University of Norway,;citation_author=T Brenn;citation_author=S N Anfinsen"/>
  <meta name="citation_reference" content="citation_title=Efficient recursive algorithms for functionals based on higher order derivatives of the multivariate gaussian density;citation_publisher=Springer Science; Business Media LLC;citation_volume=25;citation_author=J E Chacón;citation_author=T Duong"/>
  <meta name="citation_reference" content="citation_title=kStatistics: Unbiased estimators for cumulant products and faa di bruno’s formula;citation_author=E Di Nardo;citation_author=G Guarino"/>
  <meta name="citation_reference" content="citation_title=The d-variate vector Hermite polynomial of order;citation_volume=237/238;citation_author=B Holmquist"/>
  <meta name="citation_reference" content="citation_title=On multivariate skewness and kurtosis;citation_publisher=Springer;citation_volume=83-A;citation_author=S Rao Jammalamadaka;citation_author=E Taufer;citation_author=G H Terdik"/>
  <meta name="citation_reference" content="citation_title=Asymptotic theory for statistics based on cumulant vectors with applications;citation_publisher=Wiley Online Library;citation_volume=48;citation_author=S Rao Jammalamadaka;citation_author=E Taufer;citation_author=G H Terdik"/>
  <meta name="citation_reference" content="citation_title=Mpoly: Multivariate polynomials in R;citation_volume=5;citation_author=D Kahle"/>
  <meta name="citation_reference" content="citation_title=Multivariate skewness and kurtosis measures with an application in ICA;citation_publisher=Elsevier;citation_volume=99;citation_author=T Kollo"/>
  <meta name="citation_reference" content="citation_title=Tensor decompositions and applications;citation_publisher=SIAM;citation_volume=51;citation_author=Tamara G Kolda;citation_author=Brett W Bader"/>
  <meta name="citation_reference" content="citation_title=Moments: Moments, cumulants, skewness, kurtosis and related tests;citation_author=Lukasz Komsta;citation_author=Frederick Novomestky"/>
  <meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;citation_publisher=R Foundation for Statistical Computing;citation_author=R: A language and environment for statistical computing"/>
  <meta name="citation_reference" content="citation_title=Arrangements: Fast generators and iterators for permutations, combinations, integer partitions and compositions;citation_author=Randy Lai"/>
  <meta name="citation_reference" content="citation_title=MaxSkew: Orthogonal data projections with maximal skewness;citation_author=Cinzia Franceschini;citation_author=Nicola Loperfido"/>
  <meta name="citation_reference" content="citation_title=MultiSkew: Measures, tests and removes multivariate skewness;citation_author=Cinzia Franceschini;citation_author=Nicola Loperfido"/>
  <meta name="citation_reference" content="citation_title=Measures of multivariate skewness and kurtosis with applications;citation_volume=57;citation_author=K V Mardia"/>
  <meta name="citation_reference" content="citation_title=Mathematica, Version 14.0;citation_author=Wolfram Research Inc."/>
  <meta name="citation_reference" content="citation_title=On multivariate skewness and kurtosis;citation_publisher=SIAM;citation_volume=38;citation_author=T F Móri;citation_author=V K Rohatgi;citation_author=G J Székely"/>
  <meta name="citation_reference" content="citation_title=Tensor methods in statistics;citation_publisher=Chapman; Hall/CRC;citation_author=Peter McCullagh"/>
  <meta name="citation_reference" content="citation_title=Matrixcalc: Collection of functions for matrix calculations;citation_author=Frederick Novomestky"/>
  <meta name="citation_reference" content="citation_title=Orthopolynom: Collection of functions for orthogonal and orthonormal polynomials;citation_author=Frederick Novomestky"/>
  <meta name="citation_reference" content="citation_title=Concise formulae for the cumulant matrices of a random vector;citation_publisher=Elsevier;citation_volume=485;citation_author=Hanany Ould-Baba;citation_author=Vincent Robin;citation_author=Jérôme Antoni"/>
  <meta name="citation_reference" content="citation_title=Rank and eigenvalues of a supersymmetric tensor, the multivariate homogeneous polynomial and the algebraic hypersurface it defines;citation_publisher=Elsevier;citation_volume=41;citation_author=Liqun Qi"/>
  <meta name="citation_reference" content="citation_title=Higher order cumulants of random vectors and applications to statistical inference and time series;citation_volume=68;citation_author=S Rao Jammalamadaka;citation_author=T Subba Rao;citation_author=G H Terdik"/>
  <meta name="citation_reference" content="citation_title=Multivariate statistical methods: Going beyond the linear;citation_publisher=Springer Nature;citation_author=G H Terdik"/>
  <meta name="citation_reference" content="citation_title=MultiStatM: Multivariate statistical methods;citation_author=Gyorgy H Terdik;citation_author=Emanuele Taufer"/>
  <meta name="citation_reference" content="citation_title=Modern applied statistics with s;citation_publisher=Springer;citation_author=W N Venables;citation_author=B D Ripley"/>
  <meta name="citation_reference" content="citation_title=Matrix: Sparse and dense matrix classes and methods;citation_author=Douglas Bates;citation_author=Martin Maechler;citation_author=Mikael Jagan"/>
  <meta name="citation_reference" content="citation_title=Computation of multivariate normal and t probabilities;citation_publisher=Springer-Verlag;citation_author=Alan Genz;citation_author=Frank Bretz"/>
  <meta name="citation_reference" content="citation_title=Singular value decomposition of the third multivariate moment;citation_volume=473;citation_doi=https://doi.org/10.1016/j.laa.2014.05.043;citation_issn=0024-3795;citation_author=Nicola Loperfido"/>
  <meta name="citation_reference" content="citation_title=A new kurtosis matrix, with statistical applications;citation_volume=512;citation_doi=https://doi.org/10.1016/j.laa.2016.09.033;citation_issn=0024-3795;citation_author=Nicola Loperfido"/>
  <meta name="citation_reference" content="citation_title=ICS for multivariate outlier detection with application to quality control;citation_volume=128;citation_doi=https://doi.org/10.1016/j.csda.2018.06.011;citation_issn=0167-9473;citation_author=Aurore Archimbaud;citation_author=Klaus Nordhausen;citation_author=Anne Ruiz-Gazen"/>
  <meta name="citation_reference" content="citation_title=Data projections by skewness maximization under scale mixtures of skew-normal vectors;citation_publisher=Springer;citation_volume=14;citation_author=Jorge M Arevalillo;citation_author=Hilario Navarro"/>
  <meta name="citation_reference" content="citation_title=Skewness-based projection pursuit as an eigenvector problem in scale mixtures of skew-normal distributions;citation_publisher=MDPI;citation_volume=13;citation_author=Jorge M Arevalillo;citation_author=Hilario Navarro"/>
  <meta name="citation_reference" content="citation_title=An alternative formulation of neyman’s smooth goodness of fit tests under composite alternatives;citation_publisher=Springer;citation_volume=34;citation_author=J A Koziol"/>
  <meta name="citation_reference" content="citation_title=A note on measures of multivariate kurtosis;citation_publisher=Wiley Online Library;citation_volume=31;citation_author=James A Koziol"/>
  <meta name="citation_reference" content="citation_title=On tests for multivariate normality;citation_publisher=Taylor &amp; Francis;citation_volume=68;citation_author=James Francis Malkovich;citation_author=A A Afifi"/>
  <meta name="citation_reference" content="citation_title=Eigenvectors of a kurtosis matrix as interesting directions to reveal cluster structure;citation_publisher=Elsevier;citation_volume=101;citation_author=Daniel Peña;citation_author=Francisco J Prieto;citation_author=Júlia Viladomat"/>
  <meta name="citation_reference" content="citation_title=Invariant co-ordinate selection;citation_publisher=Oxford University Press;citation_volume=71;citation_author=David E Tyler;citation_author=Frank Critchley;citation_author=Lutz Dümbgen;citation_author=Hannu Oja"/>
  <meta name="citation_reference" content="citation_title=calculus: High-dimensional numerical and symbolic calculus in R;citation_volume=104;citation_doi=10.18637/jss.v104.i05;citation_author=Emanuele Guidotti"/>
  <meta name="citation_reference" content="citation_title=kStatistics: Unbiased estimates of joint cumulant products from the multivariate faà di bruno’s formula;citation_volume=14;citation_doi=10.32614/RJ-2022-033;citation_issn=2073-4859;citation_author=Elvira Di Nardo;citation_author=Giuseppe Guarino"/>
  <meta name="citation_reference" content="citation_title=A tutorial on multivariate k-statistics and their computation;citation_author=Kevin D Smith"/>
  <meta name="citation_reference" content="citation_title=Kurt: Performs kurtosis-based statistical analyses;citation_author=Cinzia Franceschini;citation_author=Nicola Loperfido"/>
  <meta name="citation_reference" content="citation_title=Higher order statistics and multivariate vector Hermite polynomials for nonlinear analysis of multidimensional time series;citation_publisher=Providence, American Mathematical Society,;citation_author=Gy H Terdik"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","description","draft","author","type","header-includes","output","bibliography","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["MultiStatM: Multivariate Statistical Methods in R"]},{"type":"character","attributes":{},"value":["2025-07-14"]},{"type":"character","attributes":{},"value":["The package MultiStatM presents a vectorial approach to multivariate moments and cumulants.  Functions provided concern algorithms to build set partitions and commutator matrices,  multivariate d-Hermite polynomials;  theoretical  vector moments and vector cumulants  of multivariate distributions and their conversion formulae. Applications discussed concern  multivariate measures of skewness and kurtosis;   asymptotic covariances for d-variate Hermite polynomials and multivariate moments and       cumulants;  Gram-Charlier approximations."]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["György Terdik"]},{"type":"character","attributes":{},"value":["University of Debrecen"]},{"type":"character","attributes":{},"value":["Department of Informatics","Debrecen, Hungary"]},{"type":"character","attributes":{},"value":["0000-0002-9663-6892"]},{"type":"character","attributes":{},"value":["terdik.gyorgy@inf.unideb.hu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Emanuele Taufer"]},{"type":"character","attributes":{},"value":["University of Trento"]},{"type":"character","attributes":{},"value":["Department of Economics and Management","Trento, Italy"]},{"type":"character","attributes":{},"value":["emanuele.taufer@unitn.it"]},{"type":"character","attributes":{},"value":["0000-0001-5140-9912"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["\\usepackage{longtable}","\\usepackage{calc}"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"character","attributes":{},"value":["2024-02-09"]},{"type":"integer","attributes":{},"value":[16]},{"type":"integer","attributes":{},"value":[4]},{"type":"character","attributes":{},"value":["RJ-2024-039"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"double","attributes":{},"value":[1]},{"type":"NULL"}]},{"type":"character","attributes":{},"value":["RJ-2024-039.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2024-039"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2024-039"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["MultiStatM","R","arrangements","matrixcalc","calculus","kStatistics","sn","moments","mpoly","orthopolynom","MaxSkew","MultiSkew","Kurt","MASS","Matrix","mvtnorm","stats","kstatistics"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["Distributions","Econometrics","Environmetrics","Finance","MixedModels","NetworkAnalysis","NumericalMathematics","Psychometrics","Robust","TeachingStatistics"]},{"type":"character","attributes":{},"value":["/home/mark/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2024-039/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["distill-preview.png","figures/GCALL.eps","figures/GCALL.png","MultiStatM_files/anchor-4.2.2/anchor.min.js","MultiStatM_files/bowser-1.9.3/bowser.min.js","MultiStatM_files/distill-2.2.21/template.v2.js","MultiStatM_files/header-attrs-2.29/header-attrs.js","MultiStatM_files/jquery-3.6.0/jquery-3.6.0.js","MultiStatM_files/jquery-3.6.0/jquery-3.6.0.min.js","MultiStatM_files/jquery-3.6.0/jquery-3.6.0.min.map","MultiStatM_files/popper-2.6.0/popper.min.js","MultiStatM_files/tippy-6.2.7/tippy-bundle.umd.min.js","MultiStatM_files/tippy-6.2.7/tippy-light-border.css","MultiStatM_files/tippy-6.2.7/tippy.css","MultiStatM_files/tippy-6.2.7/tippy.umd.min.js","MultiStatM_files/webcomponents-2.0.0/webcomponents.js","MultiStatM.log","MultiStatM.tex","RJ-2024-039.log","RJ-2024-039.pdf","RJ-2024-039.tex","RJ-2024-039.zip","RJournal.sty","RJreferences.bib","RJwrapper.aux","RJwrapper.bbl","RJwrapper.blg","RJwrapper.brf","RJwrapper.log","RJwrapper.out","RJwrapper.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.29/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"MultiStatM: Multivariate Statistical Methods in R","description":"The package MultiStatM presents a vectorial approach to multivariate moments and cumulants.  Functions provided concern algorithms to build set partitions and commutator matrices,  multivariate d-Hermite polynomials;  theoretical  vector moments and vector cumulants  of multivariate distributions and their conversion formulae. Applications discussed concern  multivariate measures of skewness and kurtosis;   asymptotic covariances for d-variate Hermite polynomials and multivariate moments and       cumulants;  Gram-Charlier approximations.","doi":"10.32614/RJ-2024-039","authors":[{"author":"György Terdik","authorURL":"#","affiliation":"University of Debrecen","affiliationURL":"#","orcidID":"0000-0002-9663-6892"},{"author":"Emanuele Taufer","authorURL":"#","affiliation":"University of Trento","affiliationURL":"#","orcidID":"0000-0001-5140-9912"}],"publishedDate":"2025-07-14T00:00:00.000+00:00","citationText":"Terdik & Taufer, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2024-3">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>MultiStatM: Multivariate Statistical Methods in R</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>The package MultiStatM presents a vectorial approach to multivariate moments and cumulants. Functions provided concern algorithms to build set partitions and commutator matrices, multivariate d-Hermite polynomials; theoretical vector moments and vector cumulants of multivariate distributions and their conversion formulae. Applications discussed concern multivariate measures of skewness and kurtosis; asymptotic covariances for d-variate Hermite polynomials and multivariate moments and cumulants; Gram-Charlier approximations.</p></p>
</div>

<div class="d-byline">
  György Terdik  (University of Debrecen)
  
,   Emanuele Taufer  (University of Trento)
  
<br/>2025-07-14
</div>

<div class="d-article">
<h2 data-number="1" id="introduction-and-background"><span class="header-section-number">1</span> Introduction and background</h2>
<p>The package <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> (<span class="citation" data-cites="Taufer22">Terdik and Taufer (<a href="#ref-Taufer22" role="doc-biblioref">2024</a>)</span>) provides a set of tools such as set partitions, commutator matrices and vector Hermite polynomials which are needed in developing general computational and conversion formulae for multivariate moments and cumulants of any order. Applications are provided for theoretical moments and cumulants of some important symmetric and skew-symmetric multivariate distributions; measures of multivariate skewness and kurtosis; asymptotic covariance formulae for vector Hermite polynomials; last but not least, estimation functions for all theoretical results discussed are provided. All the methods implemented in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> are discussed in detail in <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>.</p>
<p>A careful study of the cumulants is a necessary and typical part of nonlinear statistics.
Dealing with cumulants for multivariate distributions is made complicated by
the index notations: <span class="citation" data-cites="mccullagh2018tensor">McCullagh (<a href="#ref-mccullagh2018tensor" role="doc-biblioref">2018</a>)</span> provides quite an elegant approach using tensor methods; however, tensor methods are not very well known and computationally not so simple. <span class="citation" data-cites="kollo2008multivariate">Kollo (<a href="#ref-kollo2008multivariate" role="doc-biblioref">2008</a>)</span> and <span class="citation" data-cites="mori1994multivariate">Móri et al. (<a href="#ref-mori1994multivariate" role="doc-biblioref">1994</a>)</span> provide formulae for cumulants in terms of matrices; however, retaining a matrix structure for all higher-order cumulants leads to high-dimensional matrices with special symmetric structures which are quite hard to follow notionally and computationally. Cumulant matrices, with special attention to the third and fourth order, are ubiquitous in the literature. The use of decompositions and approximations allow for dimensionality reduction and find several statistical applications; see <span class="citation" data-cites="Loperfido15">Loperfido (<a href="#ref-Loperfido15" role="doc-biblioref">2015</a>)</span> and <span class="citation" data-cites="Loperfido17">Loperfido (<a href="#ref-Loperfido17" role="doc-biblioref">2017</a>)</span> for analysis and discussion of skewness and kurtosis matrices and their applications.</p>
<p><a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> offers an alternative method, which we believe is simpler to follow: the higher-order cumulants of the same degree for some random <span class="math inline">\(d\)</span>-vector <span class="math inline">\(\mathbf{X}\)</span> are collected together and kept as a vector (see <span class="citation" data-cites="terdik2003higher">Terdik (<a href="#ref-terdik2003higher" role="doc-biblioref">2003</a>)</span>). In order to do so, a particular differential operator on a multivariate function, called the <span class="math inline">\(\operatorname{T}\)</span>-derivative, is introduced. Although the tensor product of Euclidean vectors is not commutative, it has the advantage of permutation equivalence and allows one to obtain general formulae for cumulants and moments of any order. Methods based on a matrix approach do not provide this type of result; see also <span class="citation" data-cites="ould2015concise">Ould-Baba et al. (<a href="#ref-ould2015concise" role="doc-biblioref">2015</a>)</span>, which goes at most up to the sixth-order moment matrices, whereas there is no such limitation in our derivations and formulae. The vectorial approach has also been advocated by <span class="citation" data-cites="Holmquist96">Holmquist (<a href="#ref-Holmquist96" role="doc-biblioref">1996</a>)</span> and <span class="citation" data-cites="Chacon2014">Chacón and Duong (<a href="#ref-Chacon2014" role="doc-biblioref">2015</a>)</span>; for further discussion, one can see also <span class="citation" data-cites="kolda2009tensor">Kolda and Bader (<a href="#ref-kolda2009tensor" role="doc-biblioref">2009</a>)</span> and <span class="citation" data-cites="qi2006rank">Qi (<a href="#ref-qi2006rank" role="doc-biblioref">2006</a>)</span>.</p>
<p>More formally, with the symbol <span class="math inline">\(\otimes\)</span> denoting the Cartesian tensor product, consider the operator <span class="math inline">\(D_{\boldsymbol{\lambda}}^{\otimes}\)</span>,
which we refer to as the
<span class="math inline">\(\operatorname{T}\)</span>-derivative; see <span class="citation" data-cites="TerdikRaosSankhya06">Jammalamadaka et al. (<a href="#ref-TerdikRaosSankhya06" role="doc-biblioref">2006</a>)</span> for details. For any function <span class="math inline">\({\phi}(\boldsymbol{\lambda})\)</span>, the <span class="math inline">\(\operatorname{T}\)</span>-derivative is defined as
<span class="math display">\[\begin{equation}\label{Tderiv}
D_{\boldsymbol{\lambda}}^{\otimes}{{\phi}}%
(\boldsymbol{\lambda})=\operatorname{vec}\left(\left(  \frac{\partial{\phi
}(\boldsymbol{\lambda})}{\partial\boldsymbol{\lambda}&#39;}\right)&#39;  \right)={\phi}(\boldsymbol{\lambda})\otimes\frac{\partial}{\partial
\boldsymbol{\lambda}}.%
\end{equation}\]</span>
If <span class="math inline">\({{\phi}}\)</span> is <span class="math inline">\(k\)</span>-times differentiable, its <span class="math inline">\(k\)</span>-th
<span class="math inline">\(\operatorname{T}\)</span>-derivative is simply
<span class="math inline">\(D_{\boldsymbol{\lambda}}^{\otimes k}{{\phi} }(\boldsymbol{\lambda})=D_{\boldsymbol{\lambda}}^{\otimes}\left( D_{\boldsymbol{\lambda}}^{\otimes k-1}{{\phi} }(\boldsymbol{\lambda})\right)\)</span>. When <span class="math inline">\({{\phi}}\)</span> is the characteristic function of some random <span class="math inline">\(d\)</span>-vector, <span class="math inline">\(k\)</span>-times application of the <span class="math inline">\(\operatorname{T}\)</span>-derivative will allow to retrieve the so-called multivariate <span class="math inline">\(\operatorname{T}\)</span>-moments vector of order <span class="math inline">\(k\)</span>, which lists all moments of the same order and has dimension <span class="math inline">\(d^k\)</span>. In the same way, multivariate <span class="math inline">\(\operatorname{T}\)</span>-cumulants and <span class="math inline">\(\operatorname{T}\)</span>-Hermite polynomials can be derived. <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> aims at exploiting the advantages of this method for multivariate analysis and dealing with the high-dimensionality implied by this approach.</p>
<p>We could not find any <a href="https://cran.r-project.org/package=R">R</a> (<span class="citation" data-cites="RRR">R Core Team (<a href="#ref-RRR" role="doc-biblioref">2023</a>)</span>) package using this approach although there is a partial overlapping between functions in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> and functions that can be found in other <a href="https://cran.r-project.org/package=R">R</a> packages; when this happens, the functions in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> provide useful generalizations.</p>
<p>The package <a href="https://cran.r-project.org/package=arrangements">arrangements</a> (<span class="citation" data-cites="Lai20">Lai (<a href="#ref-Lai20" role="doc-biblioref">2020</a>)</span>) provides, among other things, all possible partitions of a set (or an integer) in lexicographical order. In <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> all possible partitions in terms of partition matrices together with information about types, sizes and groups of partitions are given. Furthermore <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> provides other partition functions which produce indecomposable partitions, partitions that bring to a closed graph, partitions in only two groups.</p>
<p>The package <a href="https://cran.r-project.org/package=matrixcalc">matrixcalc</a> (<span class="citation" data-cites="Novom21">Novomestky (<a href="#ref-Novom21" role="doc-biblioref">2021</a>)</span>) provides the commutation, elimination and duplication matrices for Cartesian tensor products of two vectors, which are particular cases of those provided in the package <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a>. Furthermore, in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> a commutator matrix for any T-product of vectors of any size is given; also, a fast algorithm to produce a symmetrizer of T-products of vectors is implemented (see <span class="citation" data-cites="Holmquist96">Holmquist (<a href="#ref-Holmquist96" role="doc-biblioref">1996</a>)</span>). One of the problems of commutators matrices is their high-dimensionality which can become soon quite cumbersome; on the other hand, commutator matrices are useful if one needs to work with linear combinations of matrices. To deal with the high-dimensionality issue, index versions of the commutators are also provided (more details below).</p>
<p>The package <a href="https://cran.r-project.org/package=calculus">calculus</a> (<span class="citation" data-cites="guidotti22">Guidotti (<a href="#ref-guidotti22" role="doc-biblioref">2022</a>)</span>) dealing with high dimensional numerical and symbolic calculus provides, up to a given order, the list of all symbolic entries of the multivariate Hermite polynomials with given covariance matrix used here. <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> does not deal with single symbolic expressions rather provides full numerical evaluation of multivariate T-Hermite polynomials suitable for immediate use in further formulas and applications.</p>
<p><a href="https://cran.r-project.org/package=kStatistics">kStatistics</a> (<span class="citation" data-cites="dinardo22a">Di Nardo and Guarino (<a href="#ref-dinardo22a" role="doc-biblioref">2022b</a>)</span>) gives string expressions for converting single entries of multivariate cumulants or moments which need to be joined and evaluated for numerical computations, for details and examples see <span class="citation" data-cites="dinardo22b">Di Nardo and Guarino (<a href="#ref-dinardo22b" role="doc-biblioref">2022a</a>)</span>. This differs to a large degree from the formulae provided in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> which are always in numerical form and ready for applications; for example, conversion of multivariate moments to multivariate cumulants and viceversa, given any list of (numerical) multivariate moments up to order <span class="math inline">\(r\)</span>, or multivariate cumulants up to order <span class="math inline">\(r\)</span> are provided.</p>
<p>In <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a>, exploiting the conversion formulae and some results on uniform spherical and folded multivariate normal distributions due to <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span> and <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, the multivariate moments and cumulants of any order of the multivariate skew normal and its generalization (<span class="citation" data-cites="azzalini1996multivariate">Azzalini and Dalla Valle (<a href="#ref-azzalini1996multivariate" role="doc-biblioref">1996</a>)</span> , <span class="citation" data-cites="arellano2005fundamental">Arellano-Valle and Genton (<a href="#ref-arellano2005fundamental" role="doc-biblioref">2005</a>)</span>) are provided. The package <a href="https://cran.r-project.org/package=sn">sn</a> (<span class="citation" data-cites="Azza22">Azzalini (<a href="#ref-Azza22" role="doc-biblioref">2022</a>)</span>) provides moments and cumulants of any order for the univariate skew-normal and the skew-t distributions; statistical methods are provided for data fitting and model diagnostics, in the univariate and the multivariate case. In <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> random numbers generator for multivariate skew distributions are provided also.</p>
<p>The package <a href="https://cran.r-project.org/package=moments">moments</a> (<span class="citation" data-cites="Komsta22">Komsta and Novomestky (<a href="#ref-Komsta22" role="doc-biblioref">2022</a>)</span>) deals with functions to calculate, cumulants, Pearson’s kurtosis, Geary’s kurtosis and skewness; tests related to them from univariate data. However the multivariate approach is not considered. The packages <a href="https://cran.r-project.org/package=mpoly">mpoly</a> (<span class="citation" data-cites="khale13">Kahle (<a href="#ref-khale13" role="doc-biblioref">2013</a>)</span>) and <a href="https://cran.r-project.org/package=orthopolynom">orthopolynom</a> (<span class="citation" data-cites="Novom22">Novomestky (<a href="#ref-Novom22" role="doc-biblioref">2022</a>)</span>) deal with Hermite polynomials in the univariate case.</p>
<p><a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> provides some common measures of cumulant-based multivariate skewness and kurtosis (<span class="citation" data-cites="Mardia70">Mardia (<a href="#ref-Mardia70" role="doc-biblioref">1970</a>)</span>, <span class="citation" data-cites="mori1994multivariate">Móri et al. (<a href="#ref-mori1994multivariate" role="doc-biblioref">1994</a>)</span>) which are provided in a number of packages, for example <a href="https://cran.r-project.org/package=MaxSkew">MaxSkew</a> (<span class="citation" data-cites="LoperfidoMax">Franceschini and Loperfido (<a href="#ref-LoperfidoMax" role="doc-biblioref">2017a</a>)</span>), <a href="https://cran.r-project.org/package=MultiSkew">MultiSkew</a> (<span class="citation" data-cites="LoperfidoMus">Franceschini and Loperfido (<a href="#ref-LoperfidoMus" role="doc-biblioref">2017b</a>)</span>) and <a href="https://cran.r-project.org/package=Kurt">Kurt</a> (<span class="citation" data-cites="loperfido21">Franceschini and Loperfido (<a href="#ref-loperfido21" role="doc-biblioref">2021</a>)</span>). Indeed the vectorial approach provides a unifying framework for several cumulant-based skewness and kurtosis indexes, as discussed in <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span> where, beyond the above mentioned ones, indexes proposed by <span class="citation" data-cites="malkovich1973">Malkovich and Afifi (<a href="#ref-malkovich1973" role="doc-biblioref">1973</a>)</span>, <span class="citation" data-cites="kollo2008multivariate">Kollo (<a href="#ref-kollo2008multivariate" role="doc-biblioref">2008</a>)</span>, <span class="citation" data-cites="koziol1987">Koziol (<a href="#ref-koziol1987" role="doc-biblioref">1987</a>)</span>, <span class="citation" data-cites="koziol1989">Koziol (<a href="#ref-koziol1989" role="doc-biblioref">1989</a>)</span> and others are discussed. When going higher than the fourth order, the vectorial approach shows it full power; see <span class="citation" data-cites="jamma2021SJS">Jammalamadaka et al. (<a href="#ref-jamma2021SJS" role="doc-biblioref">2021a</a>)</span> for an application in deriving the asymptotic variances of skewness and kurtosis vectors and indexes which require cumulants up to the <span class="math inline">\(8\)</span>-th order. Below, exploiting <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> applications to the construction of new measures of multivariate skewness and kurtosis and derivation of Gram-Charlier approximation to densities will be presented.</p>
<p>As far as non R-universe is concerned, the proprietary software Mathematica (<span class="citation" data-cites="Mathematica">Inc.</span>) provides partial overlapping of the multivariate methods discussed in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a>. There, functions to compute, numerically and symbolically, multivariate moments and cumulants of common distributions and general conversion functions from moments to cumulants and viceversa are available. Most of the multivariate distributions discussed in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> however are not available there. Mathematica also provides several functions for univariate Hermite polynomials which however need to be adapted for the multivariate case based on the <span class="math inline">\(\operatorname{T}\)</span>-derivative approach.</p>
<h2 data-number="2" id="package-features"><span class="header-section-number">2</span> Package features</h2>
<p><a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> imports <a href="https://cran.r-project.org/package=arrangements">arrangements</a>, <a href="https://cran.r-project.org/package=MASS">MASS</a> (<span class="citation" data-cites="Mass02">Venables and Ripley (<a href="#ref-Mass02" role="doc-biblioref">2002</a>)</span>), <a href="https://cran.r-project.org/package=Matrix">Matrix</a> (<span class="citation" data-cites="Matrix24">Bates et al. (<a href="#ref-Matrix24" role="doc-biblioref">2024</a>)</span>), <a href="https://cran.r-project.org/package=mvtnorm">mvtnorm</a> (<span class="citation" data-cites="MVT09">Genz and Bretz (<a href="#ref-MVT09" role="doc-biblioref">2009</a>)</span>) and <a href="https://cran.r-project.org/package=stats">stats</a>. We discuss here some examples on the use of the functions; considerations about timing, objects size and algorithms will be collected in Section 4.</p>
<h3 data-number="2.1" id="set-partitions"><span class="header-section-number">2.1</span> Set partitions</h3>
<p><a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> provides several functions dealing with set partitions. Such functions provide some basic tools used to build the multivariate formulae for moments and cumulants in the following sections.</p>
<p>Generally a set of <span class="math inline">\(N\)</span> elements can be split into a set of disjoint subsets, i.e. it can be partitioned. The set of <span class="math inline">\(N\)</span> elements will correspond to set <span class="math inline">\(1 : N = \{1, 2, \dots ,N\}\)</span>. If <span class="math inline">\({\cal{K}} = \{b_1, b_2, \dots , b_r \}\)</span> where each <span class="math inline">\(b_j \subset 1 : N\)</span>, then <span class="math inline">\({\cal{K}}\)</span> is a partition provided
<span class="math inline">\(\cup b_j = 1 : N\)</span>, each <span class="math inline">\(b_j\)</span> is non-empty and <span class="math inline">\(b_j \cap b_i = \emptyset\)</span> (the empty set) is disjoint
whenever <span class="math inline">\(j \neq i\)</span>. The subsets <span class="math inline">\(b_j\)</span>, <span class="math inline">\(j = 1, 2, \dots, r\)</span> are called the blocks of <span class="math inline">\(\cal{K}\)</span>. We
will call <span class="math inline">\(r\)</span> (the number of the blocks in partition <span class="math inline">\(\cal{K}\)</span>), the size of <span class="math inline">\(\cal{K}\)</span>, and denote it by <span class="math inline">\(|{\cal{K}}| = r\)</span>, and a partition with size <span class="math inline">\(r\)</span> will be denoted by <span class="math inline">\({\cal{K}}_{\{r\}}\)</span>. Let us denote the set
of all partitions of the numbers <span class="math inline">\(1 : N\)</span> by <span class="math inline">\({\cal{P}}_N\)</span>.</p>
<p>Consider next a partition <span class="math inline">\({\mathcal{K}}_{\{r\}}=\{b_{1},b_{2},\dots,b_{r}\}\in {\mathcal{P}}_{N}\)</span>, with size <span class="math inline">\(r\)</span>. Denote the cardinality <span class="math inline">\(k_{j}\)</span>
of a block in the partition <span class="math inline">\({\mathcal{K}}_{\{r\}}\)</span>, i.e. <span class="math inline">\(k_{j}=|b_{j}|\)</span>.
The type of a partition <span class="math inline">\({\mathcal{K}}_{\{r\}}\)</span> is <span class="math inline">\(l=[l_{1},\dots ,l_{N}]\)</span>,
if <span class="math inline">\({\mathcal{K}}_{\{r\}}\)</span> contains exactly <span class="math inline">\(l_{j}\)</span> blocks with cardinality <span class="math inline">\(j\)</span>. The type <span class="math inline">\(l\)</span> is with length <span class="math inline">\(N\)</span> always. A partition with size <span class="math inline">\(r\)</span> and
type <span class="math inline">\(l\)</span> will be denoted by <span class="math inline">\({\mathcal{K}}_{\{r|l\}}\)</span>. It is clear that
<span class="math inline">\(l_{j}\geq 0\)</span>, and <span class="math inline">\(\sum_{j}jl_{j}=N\)</span>, and <span class="math inline">\(\sum_{j}l_{j}=r\)</span>. Naturally, some
<span class="math inline">\(l_{j}\)</span>’s are zero. A block constitutes a row vector of entries <span class="math inline">\(0\)</span>’s and <span class="math inline">\(1\)</span>’s with length <span class="math inline">\(N\)</span>. The places of <span class="math inline">\(1\)</span>’s correspond to the elements of the block. A partition matrix collects the rows of its blocks, it is an <span class="math inline">\(r\times N\)</span> matrix with column-sums <span class="math inline">\(1\)</span>.</p>
<p>The basic function is <code>PartitionTypeAll</code> which provides complete information on the partition of a set of <code>N</code> elements, namely:</p>
<ul>
<li><p><code>S_N_r</code>: a vector with the number of partitions of size <code>r=1</code>, <code>r=2</code>, etc. (Stirling numbers of the second kind); <code>S_N_r[r]</code> denotes the number of partition matrices
of size <code>r</code>.</p></li>
<li><p><code>Part.class</code>: the list of all possible partitions given as partition matrices. This list is enumerated according to <code>S_N_r[r]</code>, <span class="math inline">\(r=1,2,\ldots N\)</span>, such that the partition matrices with
size <code>R</code> are listed from <span class="math inline">\(\sum_{r&lt;R}\)</span><span class="math inline">\(\left[ r\right] +1\)</span> up to <span class="math inline">\(\sum_{r\leq R}\)</span><span class="math inline">\(\left[ r\right]\)</span>. The order of the
partition matrices within a fixed size is called canonical.</p></li>
<li><p><code>S_r_j</code>: a list of vectors of number of partitions with given types grouped by partitions of size <code>r=1</code>, <code>r=2</code>, etc.; an entry is the number of partitions with that type.</p></li>
<li><p><code>eL_r</code>: a list of partition types with respect to partitions of size <code>r=1</code>, <code>r=2</code>, etc. ; since a partition type is a row
vector with length <code>N</code> this list includes matrices of types (row vectors), the number of rows are the length of vectors of <code>S_r_j</code> of a given size <code>r</code>.</p></li>
</ul>
<p><strong>Example 1</strong>. Consider the case where <code>N=4</code> and run the following</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PTA</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/PartitionTypeAll.html'>PartitionTypeAll</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><code>S_N_r</code> provides the number of partitions with <code>r=1</code> to <code>r=4</code> blocks:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PTA</span><span class='op'>$</span><span class='va'>S_N_r</span></span></code></pre>
</div>
<pre><code>[1] 1 7 6 1</code></pre>
</div>
<p>From the results above we see that there are: 1 partition of 1 block (<code>r=1</code>); 7 partitions of two blocks (<code>r=2</code>); 6 partitions of 3 blocks and 1 partition of 4 blocks.
All the partition matrices are listed in <code>Part.class</code>, for example the first partition matrix of size 2 among 7 is</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PTA</span><span class='op'>$</span><span class='va'>Part.class</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    1    1    0
[2,]    0    0    0    1</code></pre>
</div>
<p>The second partition matrix of size 3 is</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PTA</span><span class='op'>$</span><span class='va'>Part.class</span><span class='op'>[[</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>]</span> </span></code></pre>
</div>
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    0    1    0
[2,]    0    1    0    0
[3,]    0    0    0    1</code></pre>
</div>
<p>etc.. If one interested in the number of partitions with different types for <code>r=2</code> then consider the list <code>S_r_j</code>, i.e.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PTA</span><span class='op'>$</span><span class='va'>S_r_j</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> </span></code></pre>
</div>
<pre><code>[1] 4 3</code></pre>
</div>
<p>That is, for partitions with <code>r=2</code> blocks, there are 2 possible types with 4 and 3 partitions each. These types will show up in the list <code>eL_r</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>PTA</span><span class='op'>$</span><span class='va'>eL_r</span></span></code></pre>
</div>
<pre><code>[[1]]
[1] 0 0 0 1

[[2]]
     [,1] [,2] [,3] [,4]
[1,]    1    0    1    0
[2,]    0    2    0    0

[[3]]
[1] 2 1 0 0

[[4]]
[1] 4 0 0 0</code></pre>
</div>
<p>From <code>PTA$eL_r[[2]]</code>
we see that there are two types of partition with <code>r=2</code>: the first is
of type <span class="math inline">\(\left[ 1,0,1,0\right] ={(l_{1}=1,l_{2}=0,l_{3}=1,l_{4}=0)}\)</span> with 4 partitions and the second is of type <span class="math inline">\(\left[ 0,2,0,0\right] ={(l_{1}=0,l_{2}=2,l_{3}=0,l_{4}=0)}\)</span> with 3 partitions.</p>
<p>Another general function in this class is <code>Partitions</code> which has a <code>Type</code> argument in order to specify the type of partition to compute: <code>2Perm</code> which provides the permutation of <code>N</code> elements according to a partition matrix <code>L</code>; <code>Diagram</code> which provides the list of partition matrices indecomposable with respect to L, representing diagrams without loops;
<code>Indecomp</code>, which provides the list of all indecomposable partitions with respect to a partition matrix <code>L</code>; <code>Pairs</code>, which provides the list of partitions dividing into pairs the set of <code>N</code> elements.</p>
<h3 data-number="2.2" id="commutators-symmetrizer-and-selection-matrices"><span class="header-section-number">2.2</span> Commutators, symmetrizer and selection matrices</h3>
<p>The <code>Commutators</code> family of functions produce commutators and selection matrices. The use of matrices allows to use linear combinations to represent problems such as the permutation of powers of <span class="math inline">\(\operatorname{T}\)</span>-products or the selection of certain elements in a vector. On the other hand, the size of these matrices can quickly become quite important. To deal with this issues an option for sparse matrices is always provided; also, a corresponding <code>Indx</code> group of functions which give equivalent results to the corresponding functions in the group <code>Matr</code> is provided.</p>
<p>Two general functions in this family are <code>CommutatorMatr</code> and <code>CommutatorIndx</code>, both with a <code>Type</code> argument selected from: <code>Kmn</code>, <code>Kperm</code>, <code>Mixing</code>, <code>Moment</code>. <code>Kmn</code> produces a commutation matrix, with usual notation <span class="math inline">\(\mathbf{K}_{m \cdot n}\)</span>, of dimension <span class="math inline">\(mn \times mn\)</span> such that, given a matrix <span class="math inline">\(\mathbf{A}\)</span> <span class="math inline">\(m\times n\)</span>, <span class="math inline">\(\mathbf{K}_{m \cdot n} \operatorname{vec}\mathbf{A}=\operatorname{vec}\mathbf{A}&#39;\)</span> (see <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, p.8) while <code>Kperm</code> produce any permutation of Kronecker products of vectors of any length.</p>
<p><strong>Example 2</strong>. Consider the product of vectors <span class="math inline">\(\mathbf{a}_1 \otimes \mathbf{a}_2 \otimes\mathbf{a}_3\)</span> of dimensions <span class="math inline">\(d_1\)</span> to <span class="math inline">\(d_3\)</span> respectively.</p>
<p><code>CommutatorMatr(Type="Kperm",c(3,1,2),c(d1,d2,d3))</code> produces <span class="math inline">\(\mathbf{a}_3 \otimes \mathbf{a}_1 \otimes\mathbf{a}_2\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>a1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='va'>a2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span></span>
<span><span class='va'>a3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>a1</span> <span class='op'><a href='https://rdrr.io/r/base/kronecker.html'>%x%</a></span> <span class='va'>a2</span> <span class='op'><a href='https://rdrr.io/r/base/kronecker.html'>%x%</a></span> <span class='va'>a3</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/CommutatorMatr.html'>CommutatorMatr</a></span><span class='op'>(</span>Type <span class='op'>=</span> <span class='st'>"Kperm"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>x</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> [1]  2  3  4  4  6  8  6  9 12 12 18 24</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>a3</span> <span class='op'><a href='https://rdrr.io/r/base/kronecker.html'>%x%</a></span> <span class='va'>a1</span> <span class='op'><a href='https://rdrr.io/r/base/kronecker.html'>%x%</a></span> <span class='va'>a2</span></span></code></pre>
</div>
<pre><code> [1]  2  3  4  4  6  8  6  9 12 12 18 24</code></pre>
</div>
<p>The same result can be obtained by using <code>CommutatorIndx</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/CommutatorIndx.html'>CommutatorIndx</a></span><span class='op'>(</span>Type <span class='op'>=</span> <span class='st'>"Kperm"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code> [1]  2  3  4  4  6  8  6  9 12 12 18 24</code></pre>
</div>
<p>Note that in the example above <code>CommutatorMatr</code> produces the matrix <span class="math inline">\(\mathbf{K}_{{p}}\)</span> of dimension 12 <span class="math inline">\(\times\)</span> 12 by which <span class="math inline">\(\mathbf{y}=\mathbf{K}_{{p}} \mathbf{x}\)</span>, while <code>CommutatorIndx</code> produces the permutation <span class="math inline">\({p}_{\mathbf{y}}\)</span> of 1:12 such that <span class="math inline">\(\mathbf{y}=\mathbf{x}[{p}_{\mathbf{y}}]\)</span>.
Recall that from computational point of view <code>CommutatorIndx</code> is always preferable however, if working with linear combinations of matrices, like in Example 3 and in Section 3.1 and the discussion leading to formulae <a href="#eq:LTA">(5)</a> and <a href="#eq:LTB">(6)</a>, the use of <code>CommutatorMatr</code> is unavoidable. For this reason <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> offers both possibilities. The idea of avoiding the use of commutator, selection (and symmetrizer) matrices can be traced back to <span class="citation" data-cites="Chacon2014">Chacón and Duong (<a href="#ref-Chacon2014" role="doc-biblioref">2015</a>)</span>.</p>
<p>The Elimination and Qplication matrices- related functions respectively eliminate and restore duplicated or q-plicated elements in powers of T-products. For examples of applications of these functions we defer to Section 2.4.</p>
<p>The symmetrizer matrix, a <span class="math inline">\(d^n \times d^n\)</span> matrix for the symmetrization of a <span class="math inline">\(\operatorname{T}\)</span>-product of <span class="math inline">\(n\)</span> vectors with the same dimension <span class="math inline">\(d\)</span> which overcomes the difficulties arising from the non commutative property of the Kronecker product, and simplifies considerably the computation formulae for multivariate polynomials and their derivatives (see Holmquist (1996) for details). The symmetrizer for a <span class="math inline">\(\operatorname{T}\)</span>-product of <span class="math inline">\(q\)</span> vectors of dimension <span class="math inline">\(d\)</span> is defined as
<span class="math display" id="eq:DefSym">\[\begin{equation}
\mathbf{S}_{d \mathbf{1}q}=\frac{1}{q!} \sum_{p \in {\cal{P}}_q} \mathbf{K}_p
\tag{1}
\end{equation}\]</span>
where <span class="math inline">\({\cal{P}}_q\)</span> is the set of all permutations of the numbers <span class="math inline">\(1:q\)</span> and <span class="math inline">\(\mathbf{K}_p\)</span> is the commutator matrix for the permutation <span class="math inline">\(p \in \cal{P}_q\)</span>, (i.e. the <code>CommutatorMatr</code> with <code>Type="Kperm"</code> of the package). For an application of the symmetrizer via <code>SymMatr</code> with <span class="math inline">\(d\)</span>-variate Hermite polynomials, see formula <a href="#eq:RecFHP">(2)</a> and Example 3. We defer to Section 4 for a discussion about computational time and memory allocation of these matrices.</p>
<h3 data-number="2.3" id="multivariate-t-hermite-polynomials"><span class="header-section-number">2.3</span> Multivariate T-Hermite polynomials</h3>
<p>Consider a Gaussian vector <span class="math inline">\(\mathbf{X}\)</span> of dimension <span class="math inline">\(d\)</span> with <span class="math inline">\(\operatorname{E}\mathbf{X}=0\)</span> and <span class="math inline">\(\mathbf{\Sigma}=\operatorname{Cov}(\mathbf{X})=\operatorname{E}\mathbf{X X}&#39;\)</span> and define the generator function
<span class="math display">\[\begin{equation}
\begin{split}
\psi(\mathbf{X}; \mathbf{a})&amp;=\exp \left(\mathbf{a}&#39;\mathbf{X} - \frac{1}{2} \mathbf{a}&#39; \mathbf{\Sigma} \mathbf{a}\right) \\
&amp;=\exp \left(\mathbf{a}&#39;\mathbf{X}  - \frac{1}{2} \boldsymbol{\kappa}_2^{\otimes\prime}  \mathbf{a}^{\otimes 2} \right) \\
\end{split}
\end{equation}\]</span>
where <span class="math inline">\(\mathbf{a}\)</span> is a <span class="math inline">\(d\)</span>-vector of constants and <span class="math inline">\(\boldsymbol{\kappa}_2^{\otimes}=\operatorname{vec}\mathbf{\Sigma}\)</span>. The vector Hermite polynomials is defined via the <span class="math inline">\(\operatorname{T}\)</span>-derivative of the generator function, viz.
<span class="math display">\[
\mathbf{H}_n(\mathbf{X}) = D_\mathbf{a}^{\otimes n}\psi(\mathbf{X};\mathbf{a})\big|_{\mathbf{a}=0}.
\]</span>
For example one has
<span class="math display">\[
\mathbf{H}_1(\mathbf{X})=\mathbf{X},    \quad \mathbf{H}_2(\mathbf{X})=\mathbf{X}^{\otimes 2} - \boldsymbol{\kappa}_2^{\otimes}.
\]</span>
Note that the multivariate <span class="math inline">\(\operatorname{T}\)</span>-Hermite polynomial <span class="math inline">\(\mathbf{H}_n(\mathbf{X})\)</span> is a vector of dimension <span class="math inline">\(d^n\)</span> which contains the <span class="math inline">\(n\)</span>-th order polynomials of the vector <span class="math inline">\(\mathbf{X}^{\otimes n}\)</span>. For example the entries of <span class="math inline">\(\mathbf{H}_2(\mathbf{X})\)</span> are the second order Hermite polynomials <span class="math inline">\(H_2(X_i,X_j)\)</span>, <span class="math inline">\(i,j=1,2, \dots d\)</span>; for <span class="math inline">\(d=2\)</span>
<span class="math display">\[
\mathbf{H}_2(\mathbf{X}) = \left( (X_1^2 - \sigma_{11}), (X_1 X_2 - \sigma_{12}), (X_2 X_1 - \sigma_{21}), (X_2^2 - \sigma_{22})\right)^\prime.
\]</span>
Note that <span class="math inline">\(\mathbf{H}_n(\mathbf{X})\)</span> is <span class="math inline">\(n\)</span>-symmetric, i.e. <span class="math inline">\(\mathbf{H}_2(\mathbf{X}) = \mathbf{S}_{d \mathbf{1}_n} \mathbf{H}_2(\mathbf{X})\)</span>
where <span class="math inline">\(\mathbf{S}_{d \mathbf{1}_n}\)</span> is the symmetrizer defined in <a href="#eq:DefSym">(1)</a>. From this one can get useful recursion formulae
<span class="math display" id="eq:RecFHP">\[\begin{equation}
\mathbf{H}_n(\mathbf{X})=\mathbf{S}_{d \mathbf{1}_n}\left(  \mathbf{H}_{n-1}(\mathbf{X}) \otimes \mathbf{X}- (n-1) \mathbf{H}_{n-2}(\mathbf{X}) \otimes \boldsymbol{\kappa}_2^{\otimes} \right).
\tag{2}
\end{equation}\]</span>
For further details, consult <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, Section 4.5.</p>
<p>The definition of the <span class="math inline">\(d\)</span>-variate Hermite polynomial requires the variance-covariance matrix <span class="math inline">\(\mathbf{\Sigma}\)</span> of the vector <span class="math inline">\(\mathbf{X}\)</span>. <code>HermiteN</code> and <code>HermiteN2X</code> with <code>Type=c("Univariate","Multivariate")</code> compute respectively the univariate and <span class="math inline">\(d\)</span>-variate Hermite polynomials and their inverses up to a given order <code>N</code> evaluated at <code>x</code> for a given covariance matrix <code>Sig2</code>. By default <code>Sig2</code>=<span class="math inline">\(I_\mathbf{d}\)</span>.</p>
<p><strong>Example 3</strong>. Consider a vector <span class="math inline">\(x\)</span> of dimension <span class="math inline">\(d=2\)</span> and compute the Hermite polynomials up to order <code>N</code>=<span class="math inline">\(3\)</span> with identity variance matrix <span class="math inline">\(\mathbf{I}_2\)</span>; <code>HermiteN(x,3,Type="Multivariate")</code> will contain the list of <span class="math inline">\(d\)</span>-variate Hermite polynomials up to order <span class="math inline">\(3\)</span> at value <span class="math inline">\(x\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='va'>HN</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/HermiteN.html'>HermiteN</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>3</span>, Type <span class='op'>=</span> <span class='st'>"Multivariate"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Retrieve the third Hermite polynomial</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>HN</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] -2  0  0  3  0  3  3  2</code></pre>
</div>
<p>Use now the symmetrizer in matrix form to verify formula <a href="#eq:RecFHP">(2)</a> with <span class="math inline">\(n=2\)</span>. Note that in this case <span class="math inline">\(\boldsymbol{\kappa}_2^{\otimes}=\operatorname{vec}\mathbf{I}_2\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>k2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SymMatr.html'>SymMatr</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/kronecker.html'>kronecker</a></span><span class='op'>(</span><span class='va'>HN</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>x</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>3</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/kronecker.html'>kronecker</a></span><span class='op'>(</span><span class='va'>HN</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>k2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] -2  0  0  3  0  3  3  2</code></pre>
</div>
<h3 data-number="2.4" id="multivariate-t-moments-and-t-cumulants"><span class="header-section-number">2.4</span> Multivariate T-moments and T-cumulants</h3>
<p>Multivariate moments and cumulants of all orders of a random vector <span class="math inline">\(\mathbf{X}\)</span> in <span class="math inline">\(d\)</span>-dimensions, with mean vector <span class="math inline">\(\boldsymbol{\mu}\)</span> and covariance matrix <span class="math inline">\(\mathbf{\Sigma}\)</span> can be obtained by applying the <span class="math inline">\(\operatorname{T}\)</span>-derivative respectively to the characteristic function and the log of the CF. More formally, let <span class="math inline">\(\boldsymbol{\lambda}\)</span> a <span class="math inline">\(d\)</span>-vector of real constants; <span class="math inline">\(\phi_{\mathbf{X}}(\boldsymbol{\lambda})\)</span> and <span class="math inline">\(\psi_{\mathbf{X}}(\boldsymbol{\lambda})=\log\phi_{\mathbf{X}}(\boldsymbol{\lambda})\)</span> denote, respectively, the characteristic function and the cumulant function of <span class="math inline">\(\mathbf{X}\)</span>. Then the <span class="math inline">\(k\)</span>-th order moments and cumulants of the vector <span class="math inline">\(\mathbf{X}\)</span> are obtained as
<span class="math display">\[
\boldsymbol{\mu}^\otimes_{\mathbf{X},k} =   (-\mathbf{i})^k D_{\boldsymbol{\lambda}}^{\otimes k}{{\phi}%
}_{\mathbf{X}}(\boldsymbol{\lambda}) \big|_{\boldsymbol{\lambda}=0}.
\]</span>
<span class="math display">\[
\boldsymbol{\kappa}^\otimes_{\mathbf{X},k} =   \underline{\operatorname{Cum}}_k(\mathbf{X})= (-\mathbf{i})^k D_{\boldsymbol{\lambda}}^{\otimes k}{{\psi}%
}_{\mathbf{X}}(\boldsymbol{\lambda}) \big|_{\boldsymbol{\lambda}=0}.
\]</span>
Note that <span class="math inline">\(\boldsymbol{\mu}_{\mathbf{X},k} = \operatorname{E}\mathbf{X}^{\otimes k}\)</span> is a vector of dimension <span class="math inline">\(d^k\)</span> that contains all possible moments of order <span class="math inline">\(k\)</span> formed by <span class="math inline">\(X_1, \dots, X_d\)</span>. This approach has the advantage of being straightforwardly extendable to any <span class="math inline">\(k\)</span>-th order moment. An analogous discussion can be done for cumulants. Note that one has <span class="math inline">\(\boldsymbol{\kappa}_{\mathbf{X},2} =\operatorname{vec} \mathbf{\Sigma}\)</span>. <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> contains functions which obtains moments from cumulants and vice-versa as well as functions which provide theoretical moments and cumulants for some important multivariate distributions.</p>
<p>The <code>Cum2Mom</code> and <code>Mom2Cum</code> either for the univariate or multivariate cases provide conversion formulae for cumulants from moments and viceversa given any list of moments (or cumulants).</p>
<p><strong>Example 4</strong>. Consider the case of the 2-variate standard normal distribution with unit mean vector and covariance matrix with unit elements on the main diagonal and off-diagonal elements equal to 0.5; in this case the first four moments are given in the vector <code>mu</code> below</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>1.5</span>, <span class='fl'>1.5</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>7</span>, <span class='fl'>7</span>, <span class='fl'>6.5</span>, <span class='fl'>7</span>, <span class='fl'>6.5</span>, <span class='fl'>6.5</span>, <span class='fl'>7</span>, <span class='fl'>7</span>, <span class='fl'>6.5</span>, <span class='fl'>6.5</span>, <span class='fl'>7</span>, <span class='fl'>6.5</span>, <span class='fl'>7</span>, <span class='fl'>7</span>, <span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>cum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/Mom2Cum.html'>Mom2Cum</a></span><span class='op'>(</span><span class='va'>mu</span>, Type <span class='op'>=</span> <span class='st'>"Multivariate"</span><span class='op'>)</span></span>
<span><span class='va'>cum</span></span></code></pre>
</div>
<pre><code>[[1]]
[1] 1 1

[[2]]
[1] 1.0 0.5 0.5 1.0

[[3]]
[1] 0 0 0 0 0 0 0 0

[[4]]
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
<p>Getting back to moments</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/Cum2Mom.html'>Cum2Mom</a></span><span class='op'>(</span><span class='va'>cum</span>, Type <span class='op'>=</span> <span class='st'>"Multivariate"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[[1]]
[1] 1 1

[[2]]
[1] 2.0 1.5 1.5 2.0

[[3]]
[1] 4 3 3 3 3 3 3 4

[[4]]
 [1] 10.0  7.0  7.0  6.5  7.0  6.5  6.5  7.0  7.0  6.5  6.5  7.0  6.5
[14]  7.0  7.0 10.0</code></pre>
</div>
<p>If one wishes to select only the distinct moments from the vector of third moments, then</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>r.mu</span> <span class='op'>&lt;-</span> <span class='va'>mu</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='va'>r.mu</span></span></code></pre>
</div>
<pre><code>[1] 4 3 3 4</code></pre>
</div>
<p>Note that <code>EliminIndx</code> (and <code>EliminMatr</code>) does not correspond to the function <code>unique</code>, rather it individuates the distinct elements from the symmetry of the Kronecker product. Here the values 4 and 3 could appear to be duplicates however in general they could be different. This allows to recover the whole vector when needed by using <code>QplicIndx</code> (or <code>QplicMatr</code>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mu3</span> <span class='op'>&lt;-</span> <span class='va'>r.mu</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/QplicIndx.html'>QplicIndx</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='va'>mu3</span></span></code></pre>
</div>
<pre><code>[1] 4 3 3 3 3 3 3 4</code></pre>
</div>
<p>The <code>MomCum</code> functions provide theoretical moments and cumulants for some common multivariate distributions: Skew-normal, Canonical Fundamental Skew-normal (CFUSN), Uniform distribution on the sphere, central folded Normal distribution (univariate and multivariate); for detail on the multivariate formulae used see <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span>. Some more details on the multivariate distributions considered are reported in the list below.</p>
<ul>
<li><p>A <span class="math inline">\(d\)</span>-vector <span class="math inline">\(\mathbf{U}\)</span> having uniform distribution on the sphere <span class="math inline">\(\mathbb{S}_{d-1}\)</span>. Moments and cumulants of all orders are provided for <span class="math inline">\(\mathbf{U}\)</span> by the function <code>MomCumUniS</code>; the function <code>EVSKUniS</code> can compute moments and cumulants (up to the 4th order), skewness, and kurtosis of <span class="math inline">\(\mathbf{U}\)</span> (<code>Type="Standard"</code>) and its modulus (<code>Type="Modulus"</code>).
Recall that any <span class="math inline">\(d\)</span>-vector, say <span class="math inline">\(\mathbf{W}\)</span>, has a spherically symmetric distribution
if that distribution is invariant under the group of rotations in
<span class="math inline">\(\mathbb{R}^{d}\)</span>. This is equivalent to saying that <span class="math inline">\(\mathbf{W}\)</span> has the
stochastic representation <span class="math inline">\(\mathbf{W}=R\mathbf{U}\)</span>
where <span class="math inline">\(R\)</span> is a non negative random variable. Moments and cumulants of <span class="math inline">\(\mathbf{W}\)</span> can be obtained by its stochastic representation as discussed in <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span>, Theorem 1 and Lemma 1. Furthermore a <span class="math inline">\(d\)</span>-vector <span class="math inline">\(\mathbf{X}\)</span> has an elliptically symmetric distribution if it has the representation
<span class="math display">\[
\mathbf{X}=\boldsymbol{\mu}+\boldsymbol{\Sigma}^{1/2}\mathbf{W},%
\]</span>
where <span class="math inline">\(\boldsymbol{\mu}\in\mathbb{R}^{d}\)</span>, <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is a
variance-covariance matrix and <span class="math inline">\(\mathbf{W}\)</span> is spherically distributed.
Hence the cumulants of <span class="math inline">\(\mathbf{X}\)</span> are just constant times the cumulants
of <span class="math inline">\(\mathbf{W}\)</span> except for the mean i.e.
<span class="math display">\[
\underline{\operatorname*{Cum}}_{m}\left(  \mathbf{X}\right)  =\left(
\boldsymbol{\Sigma}^{1/2}\right)  ^{\otimes m}\underline{\operatorname*{Cum}%
}_{m}\left(  \mathbf{W}\right)  .
\]</span></p></li>
<li><p>If <span class="math inline">\(\mathbf{Z}\)</span> denotes a <span class="math inline">\(d\)</span>-vector with <span class="math inline">\(d\)</span>-variate standard normal distribution, the function <code>MomCumZabs</code> provides the moments and cumulants of <span class="math inline">\(|\mathbf{Z}|\)</span> respectively in the univariate (<code>Type="univariate"</code>) and multivariate case (<code>Type="Multivariate"</code>).</p></li>
<li><p>The multivariate skew-normal distribution introduced by <span class="citation" data-cites="azzalini1996multivariate">Azzalini and Dalla Valle (<a href="#ref-azzalini1996multivariate" role="doc-biblioref">1996</a>)</span>, whose marginal densities
are scalar skew-normals. A <span class="math inline">\(d\)</span>-dimensional random vector <span class="math inline">\(\mathbf{X}\)</span> is
said to have a multivariate skew-normal distribution, <span class="math inline">\(\text{SN}_{d}\left(\boldsymbol{\mu},\boldsymbol{\Omega},\boldsymbol{\alpha}\right)\)</span> with shape
parameter <span class="math inline">\(\boldsymbol{\alpha}\)</span> if it has the density function
<span class="math display">\[
2\varphi\left(  \mathbf{X};\boldsymbol{\mu},\boldsymbol{\Omega}\right)
\Phi\left(  \boldsymbol{\alpha}&#39; \left(  \mathbf{X}-\boldsymbol{\mu
}\right)  \right)  , \quad\mathbf{X} \in\mathbb{R}^{d},
\]</span>
where <span class="math inline">\(\varphi\left(\mathbf{X};\boldsymbol{\mu},\boldsymbol{\Omega}\right)\)</span> is the <span class="math inline">\(d\)</span>-dimensional normal density with mean <span class="math inline">\(\boldsymbol{\mu}\)</span>
and correlation matrix <span class="math inline">\(\boldsymbol{\Omega}\)</span>; here <span class="math inline">\(\varphi\)</span> and <span class="math inline">\(\Phi\)</span> denote
the univariate standard normal density and the cdf. For a general formula for cumulants, see <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span>, Lemma 4. For this distribution are available the functions <code>MomCumSkewNorm</code>, which computes the theoretical values of moments and cumulants up to the r-th order and <code>EVSKSkewNorm</code> which gives mean vector, covariance, skewness and kurtosis vectors and other features.</p></li>
<li><p><span class="citation" data-cites="arellano2005fundamental">Arellano-Valle and Genton (<a href="#ref-arellano2005fundamental" role="doc-biblioref">2005</a>)</span> introduced the
CFUSN distribution (cf. their Proposition 2.3), to include all
existing definitions of skew-normal distributions. The marginal stochastic
representation of <span class="math inline">\(\mathbf{X}\)</span> with distribution <span class="math inline">\(\text{CFUSN}_{d,m}\left(\boldsymbol{\Delta}\right)\)</span> is given by
<span class="math display">\[
  \mathbf{X}=\boldsymbol{\Delta}\left\vert \mathbf{Z}_{1}\right\vert
  +\left(  \mathbf{I}_{d}-\boldsymbol{\Delta\Delta}&#39;\right)
  ^{1/2}\mathbf{Z}_{2},
\]</span>
where <span class="math inline">\(\boldsymbol{\Delta}\)</span>, is the <span class="math inline">\(d\times m\)</span> skewness matrix such that
<span class="math inline">\(\left\Vert \boldsymbol{\Delta}\mathbf{a}\right\Vert &lt;1\)</span>, for all
<span class="math inline">\(\left\Vert \mathbf{a}\right\Vert =1\)</span>, and <span class="math inline">\(\mathbf{Z}_{1}\in\mathcal{N}\left( 0,\mathbf{I}_{m}\right)\)</span> and <span class="math inline">\(\mathbf{Z}_{2}\in\mathcal{N}\left( 0,\mathbf{I}_{d}\right)\)</span> are independent (Proposition 2.2. Arellano-Valle and Genton (2005)). A simple construction of
<span class="math inline">\(\boldsymbol{\Delta}\)</span> is <span class="math inline">\(\boldsymbol{\Delta}=\boldsymbol{\Lambda}\left(\mathbf{I}_{m}\mathbf{+}\boldsymbol{\Lambda}&#39; \boldsymbol{\Lambda}\right)^{-1/2}\)</span> with some real matrix <span class="math inline">\(\boldsymbol{\Lambda}\)</span> with dimensions <span class="math inline">\(d\times m\)</span>. The <span class="math inline">\(\text{CFUSN}_{d,m}\left(\boldsymbol{\mu},\boldsymbol{\Sigma},\boldsymbol{\Delta}\right)\)</span> can be defined via the linear transformation
<span class="math inline">\(\boldsymbol{\mu}+\boldsymbol{\Sigma}^{1/2}\mathbf{X}\)</span>. For a general formula for cumulants, see <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span>, Lemma 5. For this distributions <code>MomCumCFUSN</code> provides moments and cumulants up to the <span class="math inline">\(r\)</span>-th order.</p></li>
</ul>
<p><strong>Example 5</strong>. For a skew-normal distribution with <span class="math inline">\(\alpha=(10,5,0)\)</span> and correlation function <span class="math inline">\(\Omega= \text{diag} (1,1,1)\)</span> the third moments and cumulants are</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>omega</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='va'>MSN</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/MomCumSkewNorm.html'>MomCumSkewNorm</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>3</span>, <span class='va'>omega</span>, <span class='va'>alpha</span>, nMu <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>MSN</span><span class='op'>$</span><span class='va'>Mu</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> [1] 1.568 0.073 0.000 0.073 0.570 0.000 0.000 0.000 0.711 0.073 0.570
[12] 0.000 0.570 0.996 0.000 0.000 0.000 0.355 0.000 0.000 0.711 0.000
[23] 0.000 0.355 0.711 0.355 0.000</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>MSN</span><span class='op'>$</span><span class='va'>CumX</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> [1] 0.154 0.077 0.000 0.077 0.039 0.000 0.000 0.000 0.000 0.077 0.039
[12] 0.000 0.039 0.019 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
[23] 0.000 0.000 0.000 0.000 0.000</code></pre>
</div>
<p>As another example, for the uniform distribution on the sphere, the kurtosis vector is:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EVSKUniS.html'>EVSKUniS</a></span><span class='op'>(</span><span class='fl'>3</span>, Type <span class='op'>=</span> <span class='st'>"Standard"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Kurt.U</span></span></code></pre>
</div>
<pre><code> [1] -1.2  0.0  0.0  0.0 -0.4  0.0  0.0  0.0 -0.4  0.0 -0.4  0.0 -0.4
[14]  0.0  0.0  0.0  0.0  0.0  0.0  0.0 -0.4  0.0  0.0  0.0 -0.4  0.0
[27]  0.0  0.0 -0.4  0.0 -0.4  0.0  0.0  0.0  0.0  0.0 -0.4  0.0  0.0
[40]  0.0 -1.2  0.0  0.0  0.0 -0.4  0.0  0.0  0.0  0.0  0.0 -0.4  0.0
[53] -0.4  0.0  0.0  0.0 -0.4  0.0  0.0  0.0 -0.4  0.0  0.0  0.0  0.0
[66]  0.0  0.0  0.0 -0.4  0.0 -0.4  0.0 -0.4  0.0  0.0  0.0 -0.4  0.0
[79]  0.0  0.0 -1.2</code></pre>
</div>
<h3 data-number="2.5" id="analyzing-multivariate-skewness-and-kurtosis"><span class="header-section-number">2.5</span> Analyzing multivariate skewness and kurtosis</h3>
<p>A complete picture of multivariate skewness is provided by the third-order <span class="math inline">\(\operatorname{T}\)</span>-cumulant (skewness vector) of a standardized <span class="math inline">\(\mathbf{X}\)</span>; set <span class="math inline">\(\mathbf{Y}=\boldsymbol{\Sigma}^{-1/2}(\mathbf{X}-\boldsymbol{\mu})\)</span>, then the skewness vector is
<span class="math display">\[\begin{equation}\label{SkewV}
\boldsymbol{\kappa}_{\mathbf{Y},3}^\otimes= \underline{\operatorname{Cum}}_3 \left( \mathbf{Y}\right)=\left(\mathbf{\Sigma}^{-1/2}\right)^{\otimes 3} \boldsymbol{\kappa}_{\mathbf{X},3}^\otimes.
\end{equation}\]</span></p>
<p>A definition of skewness which is invariant under shifting and orthogonal transformations or, in other words affine invariant, is provided by the total skewness of <span class="math inline">\(\mathbf{X}\)</span>, i.e. the square norm of the skewness vector:
<span class="math display">\[\begin{equation}
\gamma_{1,d}=\|\boldsymbol{\kappa}_{\mathbf{Y},3}^\otimes\|^2 = \beta_{1,d}
\end{equation}\]</span>
where <span class="math inline">\(\beta_{1,d}\)</span> is Mardia’s multivariate skewness index <span class="citation" data-cites="Mardia70">(<a href="#ref-Mardia70" role="doc-biblioref">Mardia 1970</a>)</span> which coincides with the total skewness <span class="math inline">\(\gamma_{1,d}\)</span> since the third-order central moments and third-order cumulants are equal. <span class="citation" data-cites="mori1994multivariate">Móri et al. (<a href="#ref-mori1994multivariate" role="doc-biblioref">1994</a>)</span> (MRSz’s) skewness vector can also be recovered from the skewness vector as
<span class="math display" id="eq:MoriSkew">\[\begin{equation}
\mathbf{b}(\mathbf{Y})= \left( \operatorname{vec}&#39; \mathbf{I}_d \otimes  \mathbf{I}_d \right)\boldsymbol{\kappa}_{\mathbf{Y},3}^\otimes.
\tag{3}
\end{equation}\]</span>
Note that <span class="math inline">\(\operatorname{vec}&#39; \mathbf{I}_d \otimes \mathbf{I}_d\)</span> is a matrix of dimensions <span class="math inline">\(d \times d^3\)</span>, which contains <span class="math inline">\(d\)</span> unit values per-row,
whereas all the others are 0; as a consequence, <span class="math inline">\(\mathbf{b}(\mathbf{Y})\)</span> does not take into account the contribution of cumulants of the type <span class="math inline">\(\operatorname{Cum}_3 (X_j,X_k,X_l)\)</span>, where all the
three indices <span class="math inline">\(j\)</span>, <span class="math inline">\(k\)</span>, <span class="math inline">\(l\)</span> are different from each other. The corresponding scalar measure of multivariate skewness is <span class="math inline">\(b(\mathbf{Y}) = \| \mathbf{b}(\mathbf{Y}) \|^2\)</span>.</p>
<p>The fourth-order T-cumulant of the standardized <span class="math inline">\(\mathbf{X}\)</span>, i.e. <span class="math inline">\(\boldsymbol{\kappa}_{\mathbf{Y},4}^\otimes =\mathbf{H}_4(\mathbf{Y})\)</span>, will be called kurtosis vector of <span class="math inline">\(\mathbf{X}\)</span>; its square norm will be called the total kurtosis of <span class="math inline">\(\mathbf{X}\)</span>,
<span class="math display">\[\begin{equation}
\gamma_{2,d}=\| \boldsymbol{\kappa}_{\mathbf{Y},4}^\otimes \|^2.
\end{equation}\]</span>
Mardia’s kurtosis index <span class="math inline">\(\beta_{2,d}= \operatorname{E}\left( \mathbf{Y}&#39;\mathbf{Y} \right)^2\)</span> ( <span class="citation" data-cites="Mardia70">Mardia (<a href="#ref-Mardia70" role="doc-biblioref">1970</a>)</span>) is related to the kurtosis vector by the formula
<span class="math display">\[
\beta_{2,d}= \left( \operatorname{vec}&#39; \mathbf{I}_{d^2} \right)\boldsymbol{\kappa}_{\mathbf{Y},4}^\otimes +d(d+2).
\]</span>
A consequence of this is that Mardia’s measure does not depend on all the entries of <span class="math inline">\(\boldsymbol{\kappa}_{\mathbf{Y},4}^\otimes\)</span>
which has <span class="math inline">\(d(d +1)(d +2)(d +3)/24\)</span> distinct elements, while <span class="math inline">\(\beta_{2,d}\)</span> includes only <span class="math inline">\(d^2\)</span> elements among them. We note that if <span class="math inline">\(\mathbf{X}\)</span> is Gaussian, then <span class="math inline">\(\boldsymbol{\kappa}_{\mathbf{Y},4}^\otimes=\mathbf{0}\)</span>. Note that <span class="citation" data-cites="koziol1989">Koziol (<a href="#ref-koziol1989" role="doc-biblioref">1989</a>)</span>, for <span class="math inline">\(\mathbf{Y}\)</span> and an independent copy <span class="math inline">\(\tilde{\mathbf{Y}}\)</span>, considered <span class="math inline">\(\operatorname{E}(\mathbf{Y}&#39;\tilde{\mathbf{Y}})^4\)</span> as an index of kurtosis which is the next higher degree analogue of Mardia’s skewness index <span class="math inline">\(\beta_{1,d}\)</span>. Note that (see <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span>)
<span class="math display">\[
\operatorname{E}(\mathbf{Y}&#39;\tilde{\mathbf{Y}})^4 = \gamma_{2,d}+6 \beta_{2,d}-d^2.
\]</span></p>
<p><span class="citation" data-cites="mori1994multivariate">Móri et al. (<a href="#ref-mori1994multivariate" role="doc-biblioref">1994</a>)</span> define what we will call the MRS kurtosis matrix
<span class="math display">\[
\mathbf{B}(Y) =\operatorname{E}\left( \mathbf{Y}\mathbf{Y}&#39; \mathbf{Y}\mathbf{Y}&#39; \right) -(d+2)\mathbf{I}_d,
\]</span>
which can be expressed in terms of the kurtosis vector as (note also that <span class="math inline">\(\operatorname{tr} \mathbf{B}(Y) = \beta_{2,d}\)</span>),
<span class="math display">\[
\operatorname{vec}\mathbf{B}(Y) = \left( \mathbf{I}_{d^2}\otimes \operatorname{vec}&#39; \mathbf{I}_d   \right)\boldsymbol{\kappa}_{\mathbf{Y},4}^\otimes.
\]</span>
<span class="math inline">\(\mathbf{B}(Y)\)</span> got a prominent role in multivariate statistics due to invariant coordinate selection (<span class="citation" data-cites="tyler2009">Tyler et al. (<a href="#ref-tyler2009" role="doc-biblioref">2009</a>)</span>), model-based clustering (<span class="citation" data-cites="pena2010">Peña et al. (<a href="#ref-pena2010" role="doc-biblioref">2010</a>)</span>), and multivariate outlier detection (<span class="citation" data-cites="ARCHIMBAUD18">Archimbaud et al. (<a href="#ref-ARCHIMBAUD18" role="doc-biblioref">2018</a>)</span>). For further connections between <span class="math inline">\(\boldsymbol{\kappa}_{\mathbf{Y},3}^\otimes\)</span>, <span class="math inline">\(\boldsymbol{\kappa}_{\mathbf{Y},4}^\otimes\)</span> and other measures of skewness and kurtosis, see <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, Section 6 and <span class="citation" data-cites="jamma2021San">Jammalamadaka et al. (<a href="#ref-jamma2021San" role="doc-biblioref">2021b</a>)</span>. For <span class="citation" data-cites="malkovich1973">Malkovich and Afifi (<a href="#ref-malkovich1973" role="doc-biblioref">1973</a>)</span>, where directional measures of multivariate skewness and kurtosis measures are proposed, one can refer to <a href="https://cran.r-project.org/package=MaxSkew">MaxSkew</a>, <a href="https://cran.r-project.org/package=Kurt">Kurt</a> and <span class="citation" data-cites="Loperfido15">Loperfido (<a href="#ref-Loperfido15" role="doc-biblioref">2015</a>)</span> for discussions and applications; see also <span class="citation" data-cites="arevalillo20">Arevalillo and Navarro (<a href="#ref-arevalillo20" role="doc-biblioref">2020</a>)</span> and <span class="citation" data-cites="arevalillo21">Arevalillo and Navarro (<a href="#ref-arevalillo21" role="doc-biblioref">2021</a>)</span>.</p>
<p>For examples on computing skewness and kurtosis measures with <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> and relate tests see the following sections.</p>
<h3 data-number="2.6" id="estimation"><span class="header-section-number">2.6</span> Estimation</h3>
<p>Estimating functions starting from a vector of multivariate data are available: multivariate Hermite polynomials, moments, cumulants, skewness and kurtosis vectors, Mardia’s skewness and kurtosis indexes, MRSz’s skewness vector and kurtosis matrices. The <code>Estimation</code> family of functions include <code>SampleEVSK</code>, <code>SampleGC</code>, <code>SampleHermiteN</code>, <code>SampleKurt</code>, <code>SampleSkew</code>, <code>SampleMomCum</code>, see the examples in this and the next section for their application.</p>
<p>The basic estimation method relies on sample averages: given a random sample of <span class="math inline">\(d\)</span>-vectors <span class="math inline">\(\mathbf{X}_1, \dots, \mathbf{X}_n\)</span>, for any function <span class="math inline">\(g\)</span> let
<span class="math display" id="eq:MomEst">\[\begin{equation}
\widehat{g(\mathbf{X})}= \frac{1}{n}\sum_{i=1}^n g(\mathbf{X}_i).
\tag{4}
\end{equation}\]</span>
To estimate moments of any order <span class="math inline">\(k=1, \dots, r\)</span> the function <code>SampleMomCum</code> sets <span class="math inline">\(g(\mathbf{X}_i)=\mathbf{X}_i^{\otimes k}\)</span> in <a href="#eq:MomEst">(4)</a>, while cumulants are obtained from moments via the function <code>Mom2Cum</code>. Options for centering, i.e. <span class="math inline">\((\mathbf{X_i}-\bar{\mathbf{X}})\)</span> or scaling (default), i.e. <span class="math inline">\(\mathbf{S}^{-1/2}(\mathbf{X_i}-\bar{\mathbf{X}})\)</span>, where <span class="math inline">\(\bar{\mathbf{X}}\)</span> and <span class="math inline">\(\mathbf{S}\)</span> are the usual sample estimates of mean and variance, are provided. For any sample <span class="math inline">\(\mathbf{X}_1, \dots, \mathbf{X}_n\)</span> the mean zero and identity covariance matrix data <span class="math inline">\(\mathbf{Z}_i= \mathbf{S}^{-1/2}(\mathbf{X_i}-\bar{\mathbf{X}})\)</span> can always be obtained using <code>MultiStatM::MVStandardize</code>.</p>
<p><span class="math inline">\(d\)</span>-variate Hermite polynomials of any order <span class="math inline">\(k=1, \dots, N\)</span> are evaluated at standardized data points setting <span class="math inline">\(g(\mathbf{X}_i)=\mathbf{H}_k(\mathbf{X}_i)\)</span> in <a href="#eq:MomEst">(4)</a>. The estimators in terms of standard Hermite polynomials proved to be useful for finding the asymptotic distribution of skewness and kurtosis estimates, see <span class="citation" data-cites="jamma2021SJS">Jammalamadaka et al. (<a href="#ref-jamma2021SJS" role="doc-biblioref">2021a</a>)</span>. For estimation of skewness and kurtosis vectors, see <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span> (6.20), p. 331 and (6.28), p. 340. Formulae for evaluating the variance of estimators are also available. For example <code>SampleVarianceSkewKurt</code> provides estimates of the covariance matrix of the data-estimated skewness and kurtosis vectors; see (<span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, (6.13) and (6.22)).</p>
<p><a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> does not make use of multivariate k-statistics in estimation. For these one can use <a href="https://cran.r-project.org/package=kStatistics">kStatistics</a>; for tutorials see <span class="citation" data-cites="dinardo22b">Di Nardo and Guarino (<a href="#ref-dinardo22b" role="doc-biblioref">2022a</a>)</span> and <span class="citation" data-cites="smith2020tutorial">Smith (<a href="#ref-smith2020tutorial" role="doc-biblioref">2020</a>)</span>.</p>
<p><strong>Example 6</strong>. Consider a multivariate data vector of dimension <span class="math inline">\(d=3\)</span> and <span class="math inline">\(n=1000\)</span> from the multivariate skew-normal distribution of Example 5. The estimated first four cumulants are listed in the object <code>EsMSN</code> obtained by <code>SampleEVSK</code>; the corresponding theoretical values are in the object <code>ThMSN</code> obtained by <code>MomCumSkewNorm</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/rSkewNorm.html'>rSkewNorm</a></span><span class='op'>(</span><span class='fl'>1000</span>, <span class='va'>omega</span>, <span class='va'>alpha</span><span class='op'>)</span></span>
<span><span class='va'>EsMSN</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SampleEVSK.html'>SampleEVSK</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span></span>
<span><span class='va'>ThMSN</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EVSKSkewNorm.html'>EVSKSkewNorm</a></span><span class='op'>(</span><span class='va'>omega</span>, <span class='va'>alpha</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Compare the distinct elements of the estimated skewness vector and the theoretical ones using <code>EliminIndx</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EsMSN</span><span class='op'>$</span><span class='va'>estSkew</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code> [1]  0.76940142  0.47184039  0.04925248  0.15716591 -0.01156566
 [6] -0.05348582  0.03368264 -0.02044778  0.02705410  0.07981336</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ThMSN</span><span class='op'>$</span><span class='va'>SkewX</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code> [1] 0.68927167 0.34463583 0.00000000 0.17231792 0.00000000 0.00000000
 [7] 0.08615896 0.00000000 0.00000000 0.00000000</code></pre>
</div>
<p>If one wishes to recover the estimated univariate skewness and kurtosis of the univariate components <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span> of <span class="math inline">\(X\)</span>, then, using <code>UnivMomCum</code>,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EsMSN</span><span class='op'>$</span><span class='va'>estSkew</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/UnivMomCum.html'>UnivMomCum</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] 0.76940142 0.03368264 0.07981336</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EsMSN</span><span class='op'>$</span><span class='va'>estKurt</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/UnivMomCum.html'>UnivMomCum</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>]</span> </span></code></pre>
</div>
<pre><code>[1]  1.08099145 -0.17306496 -0.07748111</code></pre>
</div>
<p>An estimate of Mardia’s skewness index is provided together with the p-value under the null hypothesis of normality. The theoretical value of Mardia’s skewness can be recovered from the element <code>SkewX.tot</code> in the object <code>ThMSN</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SampleSkew.html'>SampleSkew</a></span><span class='op'>(</span><span class='va'>data</span>, Type <span class='op'>=</span> <span class='st'>"Mardia"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>$Mardia.Skewness
[1] 1.361599

$p.value
[1] 3.773938e-43</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ThMSN</span><span class='op'>$</span><span class='va'>SkewX.tot</span></span></code></pre>
</div>
<pre><code>[1] 0.9279208</code></pre>
</div>
<p>The MRSz skewness vector and index are provided together with the p-value for the skewness index under the null hypothesis of normality. The theoretical value, for the distribution at hand, can be computed using formula <a href="#eq:MoriSkew">(3)</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SampleSkew.html'>SampleSkew</a></span><span class='op'>(</span><span class='va'>data</span>, Type <span class='op'>=</span> <span class='st'>"MRSz"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>$MRSz.Skewness.Vector
[1] 0.8730815 0.5325771 0.1086181

$MRSz.Skewness.Index
[1] 1.057708

$p.value
[1] 8.919564e-23</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/kronecker.html'>%x%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>ThMSN</span><span class='op'>$</span><span class='va'>SkewX</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.8615896 0.4307948 0.0000000</code></pre>
</div>
<h2 data-number="3" id="applications"><span class="header-section-number">3</span> Applications</h2>
<h3 data-number="3.1" id="weighted-measures-of-multivariate-skewness-and-kurtosis"><span class="header-section-number">3.1</span> Weighted measures of multivariate skewness and kurtosis</h3>
<p>The skewness and kurtosis vectors, respectively <span class="math inline">\(\mathbf{H}_{q}(\mathbf{Y})\)</span>, <span class="math inline">\(q=3,4\)</span>, contain <span class="math inline">\(d^{q}\)</span> elements, which are not all distinct. Just as the covariance matrix of a
<span class="math inline">\(d\)</span>-dimensional vector contains only <span class="math inline">\(d(d+1)/2\)</span> distinct elements, a simple computation shows that <span class="math inline">\(\mathbf{H}_q (\underline{Y})\)</span> contains <span class="math inline">\(d+q-1 \choose q\)</span> distinct elements. To avoid duplicated information, it makes sense to work only with these elements of the cumulant vector. The selection of distinct elements can be accomplished via linear transformations and through the so-called elimination matrix which we denote here as <span class="math inline">\(\mathbf{E}_{d,q}^{+}\)</span>. The linear transformation
<span class="math display" id="eq:LTA">\[\begin{equation}
\mathbf{H}_{q,D}\left({\mathbf{Y}}\right)={\mathbf{E}%
}_{d,q}^{+}\mathbf{H}_{q}\left(  \mathbf{Y}\right)
\tag{5}
\end{equation}\]</span>
contains only the distinct values of <span class="math inline">\(\mathbf{H}_{q}(\mathbf{Y})\)</span> and has covariance matrix
<span class="math display" id="eq:LTB">\[\begin{equation}
\mathbf{C}_{\mathbf{H}_{q,D} } =  {\mathbf{E}_{d,q}^{+}}
\mathbf{C}_{\mathbf{H}_q}{\mathbf{E}_{d,q}^{+\top}}.
\tag{6}
\end{equation}\]</span>
Given the availability of explicit formulae for the covariance matrices, it is natural to consider the weighted skewness and kurtosis measures based on
<span class="math inline">\(\boldsymbol{\kappa}_{\mathbf{Y}^\otimes,q,D}={\mathbf{E}}_{d,q}^{+}\boldsymbol{\kappa}_{\mathbf{Y}^\otimes,q}\)</span>, <span class="math inline">\(q=3,4\)</span> the third and fourth order cumulant vectors with distinct elements, respectively; denote these as <span class="math inline">\(\beta_{1,T,d}\)</span> (skewness) and <span class="math inline">\(\beta_{2,T,d}\)</span> (kurtosis); then
<span class="math display" id="eq:WSK">\[\begin{equation}
\beta_{q-2,T,d}=\left\Vert \mathbf{C}_{\mathbf{H}_{q,D}}^{-1/2} \, \boldsymbol{\kappa}_{\mathbf{Y}^\otimes,q,D} \right\Vert^2, \quad q=3,4.
\tag{7}
\end{equation}\]</span>
The corresponding sample versions, <span class="math inline">\(b_{q-2,T,d}\)</span>, <span class="math inline">\(q=3,4\)</span>, are simply obtained by replacing the cumulant vectors and the covariance with their estimated versions. See <span class="citation" data-cites="jamma2021SJS">Jammalamadaka et al. (<a href="#ref-jamma2021SJS" role="doc-biblioref">2021a</a>)</span> for detailed results about their asymptotic distributions which, under mild conditions are non-central <span class="math inline">\(\chi^2\)</span> distributions with <span class="math inline">\(d+q-1 \choose q\)</span> degrees of freedom and non-centrality parameter <span class="math inline">\(\beta_{q-2,T,d}\)</span>, <span class="math inline">\(q=3,4\)</span>.</p>
<p>Since the distribution of <span class="math inline">\(b_{1,T,d}\)</span> with estimated covariance matrix is asymptotically a <span class="math inline">\(\chi^2\)</span> with <span class="math inline">\(d+2 \choose 3\)</span> degrees of freedom either in the Gaussian or in the more general case of elliptically symmetric multivariate distributions, a consistent test for elliptical symmetry can be based on <span class="math inline">\(b_{1,T,d}\)</span> with the estimated covariance <span class="math inline">\(\mathbf{C}_{\mathbf{H}_{3,D}}\)</span>. Under the alternative hypothesis of asymmetry, the asymptotic distribution will involve a non-centrality parameter <span class="math inline">\(\beta_{1,T,d}\)</span>.</p>
<p><strong>Example 7</strong>. Suppose we have <span class="math inline">\(3\)</span>-variate data from a normal distribution with unknown mean and covariance matrix. We want to estimate <span class="math inline">\(b_{1,T,d}\)</span> from formula <a href="#eq:WSK">(7)</a>. Since we are considering the skewness vector <span class="math inline">\(\mathbf{H}_3(\mathbf{Y})\)</span>, without loss of generality we can consider a null mean vector and <span class="math inline">\(\boldsymbol{\Sigma}= \mathbf{I}_d\)</span>. Hence, in order to compute the covariance matrix of <span class="math inline">\(\mathbf{H}_3(\mathbf{Y})\)</span> we use <code>HermiteCov12</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fl'>3</span></span>
<span><span class='va'>Cov</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span></span>
<span><span class='va'>CovH3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/HermiteCov12.html'>HermiteCov12</a></span><span class='op'>(</span><span class='va'>Cov</span>, <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>From formula <a href="#eq:LTB">(6)</a> one can use <code>EliminMatr</code> to compute the covariance (and its inverse) of the distinct vectors elements of <span class="math inline">\(\mathbf{Y}\)</span> as</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ME</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminMatr.html'>EliminMatr</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='va'>CovH3D</span> <span class='op'>&lt;-</span> <span class='va'>ME</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>CovH3</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>ME</span><span class='op'>)</span></span>
<span><span class='va'>InvCovH3D</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>CovH3D</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Given a sample of data, compute <span class="math inline">\(b_{1,T,3}\)</span>. First estimate the skewness vector,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>d</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>EH3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SampleHermiteN.html'>SampleHermiteN</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>As a second step obtain the skewness vector with only distinct elements</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EH3D</span> <span class='op'>&lt;-</span> <span class='va'>EH3</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
</div>
<p>In the third step we estimate <span class="math inline">\(b_{1,T,3}\)</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>b1T</span> <span class='op'>&lt;-</span> <span class='va'>EH3D</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>InvCovH3D</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>EH3D</span></span>
<span><span class='va'>b1T</span></span></code></pre>
</div>
<pre><code>           [,1]
[1,] 0.05332677</code></pre>
</div>
<p>If we compare <span class="math inline">\(b_{1,T,3}\)</span> with Mardia’s skewness index <span class="math inline">\(b_{1,3}\)</span>,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>b1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SampleSkew.html'>SampleSkew</a></span><span class='op'>(</span><span class='va'>x</span>, Type <span class='op'>=</span> <span class='st'>"Mardia"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Mardia.Skewness</span></span>
<span><span class='va'>b1</span></span></code></pre>
</div>
<pre><code>[1] 0.3199606</code></pre>
</div>
<p>We note that <span class="math inline">\(b_{1,3}=6 \cdot b_{1,T,3}\)</span>. This fact was already noted and formalized in <span class="citation" data-cites="jamma2021SJS">Jammalamadaka et al. (<a href="#ref-jamma2021SJS" role="doc-biblioref">2021a</a>)</span>, i.e. Mardia’s index can also be seen to be equivalent, up to a constant, to the weighted index <span class="math inline">\(b_{1,T,d}\)</span> for the Gaussian case.</p>
<p>One can also build a weighted indexes for more general cases, e.g.
for an elliptically symmetric distribution, by computing the covariance
matrices for <span class="math inline">\(\mathbf{H}_3(\mathbf{Y})\)</span> and <span class="math inline">\(\mathbf{H}_4(\mathbf{Y})\)</span> using the results of Theorem 1 in <span class="citation" data-cites="jamma2021SJS">Jammalamadaka et al. (<a href="#ref-jamma2021SJS" role="doc-biblioref">2021a</a>)</span> and the functions provided in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a>.</p>
<h3 data-number="3.2" id="a-multivariate-gram-charlier-density"><span class="header-section-number">3.2</span> A multivariate Gram-Charlier density</h3>
<p>The Gram-Charlier expansion expresses the density function of a random variable in terms of its cumulants (see e.g. <span class="citation" data-cites="brenn2017revisit">Brenn and Anfinsen (<a href="#ref-brenn2017revisit" role="doc-biblioref">2017</a>)</span> and Section 4.7 in <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>).</p>
<p>Given a <span class="math inline">\(d\)</span>-vector from some distribution with density <span class="math inline">\(f_{\mathbf{X}}\left( \mathbf{x}\right)\)</span> having mean <span class="math inline">\(\mathbf{0}\)</span> and covariance matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span>, under appropriate moment conditions, the density can be expanded into a Gram-Charlier series as follows
<span class="math display" id="eq:GCdensity">\[\begin{equation}
f_{\mathbf{X}}\left(  \mathbf{x}\right)  = \left(  1 +\sum_{k=3}^{\infty }
  \frac{1}{k!}\left( \mathbf{B}_{k} \left(  0,0,\boldsymbol{\kappa}_{\mathbf{Y},3}%
  ,\ldots\boldsymbol{\kappa}_{\mathbf{Y},k}\right)  \right)  ^{\top}
  \mathbf{H}_{k}\left(    \boldsymbol{\Sigma}^{-1/2}  \left(\mathbf{x}-\boldsymbol{\mu} \right)%
    \right)   \right)   \varphi\left(  \mathbf{x}%
  ;\mathbf{0},\boldsymbol{\Sigma}\right)
  \tag{8}
\end{equation}\]</span>
with <span class="math inline">\(\varphi\)</span> denoting the <span class="math inline">\(d\)</span>-variate standard normal density function and <span class="math inline">\(\mathbf{B}_k\)</span> indicating the (complete) T-Bell polynomial of <span class="math inline">\(k\)</span>-th order (see, e.g. <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, Section 1.4.2 and Section 4.7). The
polynomials <span class="math inline">\(\mathbf{B}_{3}\)</span>, <span class="math inline">\(\mathbf{B}_{4}\)</span>, and <span class="math inline">\(\mathbf{B}_{5}\)</span> have
the following simple forms
<span class="math display">\[\begin{align*}
\mathbf{B}_{3}\left( 0,0,\boldsymbol{\kappa }_{\mathbf{Y},3}^{\otimes
}\right) &amp; =\boldsymbol{\kappa }_{\mathbf{Y},3}^{\otimes }, \\
\mathbf{B}_{4}\left( 0,0,\boldsymbol{\kappa }_{\mathbf{Y},3}^{\otimes },%
\boldsymbol{\kappa }_{\mathbf{Y},4}^{\otimes }\right) &amp; =\boldsymbol{\kappa }%
_{\mathbf{Y},4}^{\otimes }, \\
\mathbf{B}_{5}\left( 0,0,\boldsymbol{\kappa }_{\mathbf{Y},3}^{\otimes },%
\boldsymbol{\kappa }_{\mathbf{Y},4}^{\otimes },\boldsymbol{\kappa }_{\mathbf{%
        Y},5}^{\otimes }\right) &amp; =\boldsymbol{\kappa }_{\mathbf{Y},5}^{\otimes }.
\end{align*}\]</span>
Using the above results and considering only the first few order terms in the expansion <a href="#eq:GCdensity">(8)</a>, one can provide an approximation to <span class="math inline">\(f_{\mathbf{X}}\left( \mathbf{x}\right)\)</span>:
<span class="math display" id="eq:SGCE0">\[\begin{equation}
f_{\mathbf{X}}\left(  \mathbf{x}\right)  =\left(  1+\sum_{k=3}^{4}%
\frac{1}{k!}\boldsymbol{\kappa}_{\mathbf{Y},k}^{\top}\mathbf{H}%
_{k}\left(   \boldsymbol{\Sigma }^{-1/2}%
(\mathbf{x}-\boldsymbol{\mu})\right)   \right)  \varphi\left(  \mathbf{x}, \mathbf{0},  \boldsymbol{\Sigma}\right)  +\mathcal{O}
\tag{9}
\end{equation}\]</span>
where <span class="math inline">\(\mathcal{O}\)</span> includes the remaining terms. Starting from <span class="math inline">\(d\)</span>-variate data, a Gram-Charlier approximation to an unkonw multivariate density can be constructed using the multivariate function for cumulants and Hermite polynomials provided in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a>. In the package, the function <code>SampleGC</code> is available in order to estimate the truncated Gram-Charlier density for <span class="math inline">\(k\)</span> from <span class="math inline">\(3\)</span> to <span class="math inline">\(8\)</span>. For higher order generalized multivariate Bell polynomials see <a href="https://cran.r-project.org/package=kstatistics">kstatistics</a>. <code>SampleGC</code> can estimate directly the needed cumulants from the data or use a given list of cumulants to evaluate the Gram-Charlier density at the given data. If large data is used it will be more efficient to estimate the needed cumulants using <code>SampleMomCum</code> and then evaluate the density at the points needed for analysis; note that in <a href="#eq:SGCE0">(9)</a> <span class="math inline">\(\boldsymbol{\Sigma}\)</span> refers to <span class="math inline">\(\mathbf{X}\)</span> while the higher order cumulants are computed for the standardized data <span class="math inline">\(\mathbf{Y}\)</span>. These aspects can be handled efficiently with <code>SampleMomCum</code> which provides options for centering and scaling of the data.</p>
<p><strong>Example 8</strong>. For <span class="math inline">\(n=500\)</span> randomly generated data from a bivariate skew-normal distribution with <span class="math inline">\(\alpha=(4,12)\)</span> and correlation function <span class="math inline">\(\Omega= \text{diag} (1,1)\)</span>, the Gram-Charlier approximation (for <span class="math inline">\(k=4\)</span> and <span class="math inline">\(k=6\)</span>) is evaluated: a) using the cumulants estimated from data; b) using the true cumulants of the given skew-normal. For this distribution the mean can be computed as <span class="math inline">\(\sqrt{2/\pi} \, \Omega \alpha \, (1+\alpha&#39; \Omega \alpha)^{-1/2}\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='va'>omega</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span></span>
<span><span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/rSkewNorm.html'>rSkewNorm</a></span><span class='op'>(</span><span class='fl'>500</span>, <span class='va'>omega</span>, <span class='va'>alpha</span><span class='op'>)</span> </span>
<span><span class='va'>X</span> <span class='op'>&lt;-</span> <span class='va'>X</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>/</span> <span class='va'>pi</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>omega</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>alpha</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>alpha</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>omega</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>For <span class="math inline">\(k\)</span> all the needed cumulants (in proper form as argument for <code>SampleGC</code>) can be efficiently estimated using (e.g. <span class="math inline">\(k=4\)</span>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SampleMomCum.html'>SampleMomCum</a></span><span class='op'>(</span><span class='va'>X</span>, r <span class='op'>=</span> <span class='fl'>4</span>, centering <span class='op'>=</span> <span class='cn'>TRUE</span>, scaling <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The theoretical cumulants (up to any order) can be obtained using <code>MomCumSkewNorm</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>TC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/MomCumSkewNorm.html'>MomCumSkewNorm</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>4</span>, <span class='va'>omega</span>, <span class='va'>alpha</span>, nMu <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Compare directly the theoretical and data-estimated skewness and kurtosis vectors (use only the distinct values) in the code below</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EC</span><span class='op'>$</span><span class='va'>estCum.r</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1]  0.215266065 -0.007213623  0.032072834  0.207076236</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>TC</span><span class='op'>$</span><span class='va'>CumX</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] 0.006830064 0.020490192 0.061470576 0.184411729</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EC</span><span class='op'>$</span><span class='va'>estCum.r</span><span class='op'>[[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] -0.028502396  0.047460791  0.010992685  0.001601845  0.010988540</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>TC</span><span class='op'>$</span><span class='va'>CumX</span><span class='op'>[[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/EliminIndx.html'>EliminIndx</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] 0.001133494 0.003400482 0.010201445 0.030604334 0.091813003</code></pre>
</div>
<p>In order to produce the plots in Figure <a href="#fig:Gram-Charlier">1</a>, the Gram-Charlier approximation with <span class="math inline">\(k=4\)</span> (and <span class="math inline">\(k=6\)</span>) are evaluated using the estimated cumulants and the true ones; for example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fy4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/SampleGC.html'>SampleGC</a></span><span class='op'>(</span><span class='va'>X</span>, cum <span class='op'>=</span> <span class='va'>EC</span><span class='op'>$</span><span class='va'>estCum.r</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Figure <a href="#fig:Gram-Charlier">1</a> shows the contours of true skew-normal density and the Gram-Charlier densities based on the estimated and true cumulants for the cases <span class="math inline">\(k=4\)</span> and <span class="math inline">\(k=6\)</span>. The approximation, as expected, appears to improve when true cumulants are used and <span class="math inline">\(k\)</span> is larger.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:Gram-Charlier"></span>
<img src="figures/GCALL.png" alt="Contour plots of the skew-normal true density (left), the Gram-Charlier approximation with estimated cumulants (center) and the Gram-Charlier approximation with true cumulants (right). Case with $k=4$ (first row) and $k=6$ (second row)." width="100%" height="50%" />
<p class="caption">
Figure 1: Contour plots of the skew-normal true density (left), the Gram-Charlier approximation with estimated cumulants (center) and the Gram-Charlier approximation with true cumulants (right). Case with <span class="math inline">\(k=4\)</span> (first row) and <span class="math inline">\(k=6\)</span> (second row).
</p>
</div>
</div>
<h2 data-number="4" id="computational-details"><span class="header-section-number">4</span> Computational details</h2>
<p>One of the basic functions of <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> is <code>PartitionTypeAll</code> (Section 2.1) whose algorithm to generate all partitions of the set <span class="math inline">\(1:N\)</span> is based on the recursive generation of inclusive and exclusive partition matrices as described in <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, section 1.4. For example, the number of partitions of a given type <code>S_r_j</code> and <code>eL_r</code> - see Section 2.1 produced by <code>PartitionTypeAll</code> are exploited in conversion formulae from moments to cumulants and viceversa. Recall that the conversion formula from moments to cumulants (<span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, Section 3.4)) is given by
<span class="math display" id="eq:mtc">\[\begin{equation}
\begin{split}
\boldsymbol{\mu}_{n}^\otimes &amp;= \sum_{{\cal{K}} \in {\cal{P}}_n} \mathbf{K}^{-1}_{p({\cal{K}})} \prod^\otimes_{b_j \in {\cal{K}}} \kappa^\otimes_{|b_j|}\\
  &amp;= \mathbf{S}_{d \mathbf{1}_n}\left( \sum_{r=1}^n \sum_{\sum l_j =r, \sum j l_j = n} \frac{n!}{\prod_{j=1}^n l_j! (j!)^{l_j}} \prod_{j=1:n-r+1}^\otimes \kappa^{\otimes l_j}_j\right)
\end{split}
\tag{10}
\end{equation}\]</span>
where the summation is over all partitions <span class="math inline">\({\cal{K}} = \{b_1, b_2,\dots, b_k\}\)</span> of <span class="math inline">\(1 : n\)</span>; <span class="math inline">\(|b_j|\)</span> denotes the cardinality of block <span class="math inline">\(b_j\)</span>. The simpler second formula, exploiting the symmetrizer matrix, derives from symmetry of <span class="math inline">\(\boldsymbol{\mu}_{n}^\otimes\)</span>.</p>
<p>As far as the formula from cumulants to moments (<span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>, Section 3.4) is concerned,
<span class="math display" id="eq:ctm">\[\begin{equation}
\boldsymbol{\kappa}_{n}^\otimes  
  = \mathbf{S}_{d \mathbf{1}_n}\left( \sum_{r=1}^n (-1)^{r-1} (r-1)!\sum_{\sum l_j =r, \sum j l_j = n}  \prod_{j=1:n-r+1}^\otimes \frac{1}{{l_j}!}\left( \frac{1}{j!}\boldsymbol{\mu}^{\otimes}_j\right)^{l_j}\right).
\tag{11}
\end{equation}\]</span>
One can also use T-Bell polynomials <span class="math inline">\(\mathbf{B}_{n}\)</span>, and incomplete T-Bell polynomial <span class="math inline">\(\mathbf{B}_{n,r}\)</span> (see, e.g. Section 1.4.2 and Section 4.7 in <span class="citation" data-cites="terdik2021multivariate">Terdik (<a href="#ref-terdik2021multivariate" role="doc-biblioref">2021</a>)</span>)
to show the structure of partitions in <a href="#eq:mtc">(10)</a> as
<span class="math display">\[\begin{equation}
\boldsymbol{\mu }_{n}^{\otimes }=\mathbf{S}_{d \mathbf{1}_n} \mathbf{B}_{n}\left( \boldsymbol{%
\kappa }_{1}^{\otimes },\boldsymbol{\kappa }_{2}^{\otimes },\boldsymbol{\ldots },\boldsymbol{\kappa }_{n}^{\otimes }\right)
\end{equation}\]</span>
and in <a href="#eq:ctm">(11)</a>,
<span class="math display">\[\begin{equation}
\boldsymbol{\kappa }_{n}^{\otimes }= \mathbf{S}_{d \mathbf{1}_n} \sum_{r=1}^{n}\left(
-1\right) ^{r-1}(r-1)!\mathbf{B}_{n,r}\left( \boldsymbol{\mu }_{1}^{\otimes },\boldsymbol{\ldots },\boldsymbol{\mu }_{n}^{\otimes }\right).
\end{equation}\]</span>
Consider now the symmetrizer matrix (Section 2.2), note that, by definition, its computation requires <span class="math inline">\(q!\)</span> operations; in the package, the computational complexity is overcome by exploiting the <span class="citation" data-cites="Chacon2014">Chacón and Duong (<a href="#ref-Chacon2014" role="doc-biblioref">2015</a>)</span> efficient recursive algorithms for functionals based on higher order derivatives and the prime factorization theorem. Note however that even though the computational requirements are greatly reduced, the symmetrizer is a square matrix of dimension <span class="math inline">\(d^n\)</span> where <span class="math inline">\(d\)</span> is the vector dimension and <span class="math inline">\(n\)</span> the power of the Kronecker products. Since <code>SymMatr</code> produces essentially sparse matrices, the option <code>useSparse=T,F</code> can be selected (<code>F</code> is the default). Overall however, if the use of matrices is not strictly necessary, the function <code>SymIndx</code> will directly produce a symmetrized version of the T-product of vectors. Table <a href="#tab:Symmetr">1</a> reports the computational times as well as memory allocation of the objects created. Computation times are approximate and obtained on a desktop computer with an Intel-Core-i7-7700 CPU at 3.60GHz and 16GB RAM. From the table it can be noted that using sparse matrices can be much faster and more efficient in terms of memory allocation. The use of <code>SymIndx</code> should be the standard way however, as it much less demanding in terms of memory allocation. Recall Example 3 for an instance where the use of <code>SymMatr</code> is preferable. The numerical results are in line with those of <span class="citation" data-cites="Chacon2014">Chacón and Duong (<a href="#ref-Chacon2014" role="doc-biblioref">2015</a>)</span>.</p>
<p>In general the functions of the group <code>Indx</code> should be used wherever possible, as they are typically much faster than the corresponding <code>Matr</code> group since the former avoids constructing possibly large matrices. All code in <a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a> wherever possible, exploits the <code>Indx</code> group of functions.</p>
<table>
<caption><span id="tab:Symmetr">Table 1: </span> Approximate memory allocation (in Kb or Mb) and computational times in secs (s) or mins (m) of <code>SymMatr</code> and <code>SymIndx</code> under different settings. For <span class="math inline">\(d=3\)</span>, <span class="math inline">\(n\)</span> indicates the power of the Kronecker products.</caption>
<thead>
<tr class="header">
<th><strong>Function</strong></th>
<th><strong>n</strong></th>
<th style="text-align: right;"><strong>Time</strong></th>
<th style="text-align: right;"><strong>Object size</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SymMatr()</td>
<td>4</td>
<td style="text-align: right;">0.003s</td>
<td style="text-align: right;">55Kb</td>
</tr>
<tr class="even">
<td>useSparse=F</td>
<td>6</td>
<td style="text-align: right;">0.720s</td>
<td style="text-align: right;">4Mb</td>
</tr>
<tr class="odd">
<td></td>
<td>8</td>
<td style="text-align: right;">9.2m</td>
<td style="text-align: right;">344Mb</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>SymMatr()</td>
<td>4</td>
<td style="text-align: right;">0.03s</td>
<td style="text-align: right;">9Kb</td>
</tr>
<tr class="even">
<td>useSparse=T</td>
<td>6</td>
<td style="text-align: right;">0.12s</td>
<td style="text-align: right;">0.4Mb</td>
</tr>
<tr class="odd">
<td></td>
<td>8</td>
<td style="text-align: right;">0.46s</td>
<td style="text-align: right;">25Mb</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Symindx()</td>
<td>4</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.6Kb</td>
</tr>
<tr class="even">
<td></td>
<td>6</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.6Kb</td>
</tr>
<tr class="odd">
<td></td>
<td>8</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">52Kb</td>
</tr>
</tbody>
</table>
<p>A further discussion is needed for <code>CommutatorMatr</code> with <code>Type="Kperm"</code> (Section 2.2) which produces permutations of any <span class="math inline">\(\operatorname{T}\)</span>-products of vectors of any dimensions: beyond the considerations concerning using <code>useSparse=T</code> or not, when using <code>CommutatorMatr</code> with <code>Type="Kperm"</code>, the dimensions of the vectors in the argument may have a large impact on computing time.</p>
<p>Recall that <code>CommutatorMatr</code> with <code>Type="Kperm"</code> produces a permutation <code>perm</code> of vectors of dimensions specified in <code>dims</code>. As an example consider the case of the product of <span class="math inline">\(n=8\)</span> vectors all with the same dimension <span class="math inline">\(d\)</span>; using <code>dims &lt;- d</code> instead of <code>dims &lt;- c(d,d,d,d,d,d,d,d)</code> will require much less computing time. In the evaluation below</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/CommutatorMatr.html'>CommutatorMatr</a></span><span class='op'>(</span>Type <span class='op'>=</span> <span class='st'>"Kperm"</span>, perm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>8</span>, <span class='fl'>5</span>, <span class='fl'>7</span><span class='op'>)</span>, dims <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>requires approximately 2.11 seconds while</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/MultiStatM/man/CommutatorMatr.html'>CommutatorMatr</a></span><span class='op'>(</span>Type <span class='op'>=</span> <span class='st'>"Kperm"</span>, perm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>8</span>, <span class='fl'>5</span>, <span class='fl'>7</span><span class='op'>)</span>, </span>
<span>               dims <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>requires approximately 1326.47 seconds.</p>
<p><strong>Acknowledgement</strong>. The work of Gy. H. Terdik has been supported by the project TKP2021-NKTA of the University of Debrecen, Hungary.
Project no. TKP2021-NKTA-34 has been implemented with the support provided by the Ministry of Culture and Innovation of Hungary from the National Research, Development and Innovation Fund, financed under the TKP2021-NKTA funding scheme.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="4.1" id="supplementary-materials"><span class="header-section-number">4.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2024-039.zip">RJ-2024-039.zip</a></p>
<h3 class="appendix" data-number="4.2" id="cran-packages-used"><span class="header-section-number">4.2</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=MultiStatM">MultiStatM</a>, <a href="https://cran.r-project.org/package=R">R</a>, <a href="https://cran.r-project.org/package=arrangements">arrangements</a>, <a href="https://cran.r-project.org/package=matrixcalc">matrixcalc</a>, <a href="https://cran.r-project.org/package=calculus">calculus</a>, <a href="https://cran.r-project.org/package=kStatistics">kStatistics</a>, <a href="https://cran.r-project.org/package=sn">sn</a>, <a href="https://cran.r-project.org/package=moments">moments</a>, <a href="https://cran.r-project.org/package=mpoly">mpoly</a>, <a href="https://cran.r-project.org/package=orthopolynom">orthopolynom</a>, <a href="https://cran.r-project.org/package=MaxSkew">MaxSkew</a>, <a href="https://cran.r-project.org/package=MultiSkew">MultiSkew</a>, <a href="https://cran.r-project.org/package=Kurt">Kurt</a>, <a href="https://cran.r-project.org/package=MASS">MASS</a>, <a href="https://cran.r-project.org/package=Matrix">Matrix</a>, <a href="https://cran.r-project.org/package=mvtnorm">mvtnorm</a>, <a href="https://cran.r-project.org/package=stats">stats</a>, <a href="https://cran.r-project.org/package=kstatistics">kstatistics</a></p>
<h3 class="appendix" data-number="4.3" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">4.3</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Distributions">Distributions</a>, <a href="https://cran.r-project.org/view=Econometrics">Econometrics</a>, <a href="https://cran.r-project.org/view=Environmetrics">Environmetrics</a>, <a href="https://cran.r-project.org/view=Finance">Finance</a>, <a href="https://cran.r-project.org/view=MixedModels">MixedModels</a>, <a href="https://cran.r-project.org/view=NetworkAnalysis">NetworkAnalysis</a>, <a href="https://cran.r-project.org/view=NumericalMathematics">NumericalMathematics</a>, <a href="https://cran.r-project.org/view=Psychometrics">Psychometrics</a>, <a href="https://cran.r-project.org/view=Robust">Robust</a>, <a href="https://cran.r-project.org/view=TeachingStatistics">TeachingStatistics</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-ARCHIMBAUD18" class="csl-entry" role="listitem">
A. Archimbaud, K. Nordhausen and A. Ruiz-Gazen. ICS for multivariate outlier detection with application to quality control. <em>Computational Statistics &amp; Data Analysis</em>, 128: 184–199, 2018. DOI <a href="https://doi.org/10.1016/j.csda.2018.06.011">https://doi.org/10.1016/j.csda.2018.06.011</a>.
</div>
<div id="ref-arellano2005fundamental" class="csl-entry" role="listitem">
R. B. Arellano-Valle and M. G. Genton. On fundamental skew distributions. <em>Journal of Multivariate Analysis</em>, 96(1): 93–116, 2005.
</div>
<div id="ref-arevalillo20" class="csl-entry" role="listitem">
J. M. Arevalillo and H. Navarro. Data projections by skewness maximization under scale mixtures of skew-normal vectors. <em>Advances in Data Analysis and Classification</em>, 14(2): 435–461, 2020.
</div>
<div id="ref-arevalillo21" class="csl-entry" role="listitem">
J. M. Arevalillo and H. Navarro. Skewness-based projection pursuit as an eigenvector problem in scale mixtures of skew-normal distributions. <em>Symmetry</em>, 13(6): 1056, 2021.
</div>
<div id="ref-Azza22" class="csl-entry" role="listitem">
A. Azzalini. <em>The <span>R</span> package <code>sn</code>: The skew-normal and related distributions such as the skew-<span class="math inline">\(t\)</span> and the <span>SUN</span> (version 2.1.0).</em> Università degli Studi di Padova, Italia, 2022. URL <a href="https://cran.r-project.org/package=sn">https://cran.r-project.org/package=sn</a>. Home page: <a href="http://azzalini.stat.unipd.it/SN/" class="uri">http://azzalini.stat.unipd.it/SN/</a>.
</div>
<div id="ref-azzalini1996multivariate" class="csl-entry" role="listitem">
A. Azzalini and A. Dalla Valle. The multivariate skew-normal distribution. <em>Biometrika</em>, 83(4): 715–726, 1996.
</div>
<div id="ref-Matrix24" class="csl-entry" role="listitem">
D. Bates, M. Maechler and M. Jagan. <em>Matrix: Sparse and dense matrix classes and methods.</em> 2024. URL <a href="https://CRAN.R-project.org/package=Matrix">https://CRAN.R-project.org/package=Matrix</a>. R package version 1.6-5.
</div>
<div id="ref-brenn2017revisit" class="csl-entry" role="listitem">
T. Brenn and S. N. Anfinsen. A revisit of the <span>G</span>ram-<span>C</span>harlier and <span>E</span>dgeworth series expansions. Department of Physics; Technology, University of Tromsø, The Arctic University of Norway,. 2017.
</div>
<div id="ref-Chacon2014" class="csl-entry" role="listitem">
J. E. Chacón and T. Duong. Efficient recursive algorithms for functionals based on higher order derivatives of the multivariate gaussian density. <em>Statistics and Computing</em>, 25(5): 959–974, 2015.
</div>
<div id="ref-dinardo22b" class="csl-entry" role="listitem">
E. Di Nardo and G. Guarino. kStatistics: Unbiased estimates of joint cumulant products from the multivariate faà di bruno’s formula. <em>The R Journal</em>, 14: 208–228, 2022a. DOI <a href="https://doi.org/10.32614/RJ-2022-033">10.32614/RJ-2022-033</a>. https://doi.org/10.32614/RJ-2022-033.
</div>
<div id="ref-dinardo22a" class="csl-entry" role="listitem">
E. Di Nardo and G. Guarino. <em>kStatistics: Unbiased estimators for cumulant products and faa di bruno’s formula.</em> 2022b. URL <a href="https://CRAN.R-project.org/package=kStatistics">https://CRAN.R-project.org/package=kStatistics</a>. R package version 2.1.1.
</div>
<div id="ref-loperfido21" class="csl-entry" role="listitem">
C. Franceschini and N. Loperfido. <em>Kurt: Performs kurtosis-based statistical analyses.</em> 2021. URL <a href="https://CRAN.R-project.org/package=Kurt">https://CRAN.R-project.org/package=Kurt</a>. R package version 1.1.
</div>
<div id="ref-LoperfidoMax" class="csl-entry" role="listitem">
C. Franceschini and N. Loperfido. <em>MaxSkew: Orthogonal data projections with maximal skewness.</em> 2017a. URL <a href="https://CRAN.R-project.org/package=MaxSkew">https://CRAN.R-project.org/package=MaxSkew</a>. R package version 1.1.
</div>
<div id="ref-LoperfidoMus" class="csl-entry" role="listitem">
C. Franceschini and N. Loperfido. <em>MultiSkew: Measures, tests and removes multivariate skewness.</em> 2017b. URL <a href="https://CRAN.R-project.org/package=MultiSkew">https://CRAN.R-project.org/package=MultiSkew</a>. R package version 1.1.1.
</div>
<div id="ref-MVT09" class="csl-entry" role="listitem">
A. Genz and F. Bretz. <em>Computation of multivariate normal and t probabilities.</em> Heidelberg: Springer-Verlag, 2009.
</div>
<div id="ref-guidotti22" class="csl-entry" role="listitem">
E. Guidotti. <span class="nocase">calculus</span>: High-dimensional numerical and symbolic calculus in <span>R</span>. <em>Journal of Statistical Software</em>, 104(5): 1–37, 2022. DOI <a href="https://doi.org/10.18637/jss.v104.i05">10.18637/jss.v104.i05</a>.
</div>
<div id="ref-Holmquist96" class="csl-entry" role="listitem">
B. Holmquist. The d-variate vector <span>H</span>ermite polynomial of order. <em>Linear Alg. and its Appl.</em>, 237/238: 155–190, 1996.
</div>
<div id="ref-Mathematica" class="csl-entry" role="listitem">
W. R. Inc. Mathematica, <span>V</span>ersion 14.0.URL <a href="https://www.wolfram.com/mathematica">https://www.wolfram.com/mathematica</a>. Champaign, IL, 2024.
</div>
<div id="ref-TerdikRaosSankhya06" class="csl-entry" role="listitem">
S. R. Jammalamadaka, T. Subba Rao and G. H. Terdik. Higher order cumulants of random vectors and applications to statistical inference and time series. <em>Sankhya (Ser. A, Methodology)</em>, 68: 326–356, 2006.
</div>
<div id="ref-jamma2021SJS" class="csl-entry" role="listitem">
S. R. Jammalamadaka, E. Taufer and G. H. Terdik. Asymptotic theory for statistics based on cumulant vectors with applications. <em>Scandinavian Journal of Statistics</em>, 48(2): 708–728, 2021a.
</div>
<div id="ref-jamma2021San" class="csl-entry" role="listitem">
S. R. Jammalamadaka, E. Taufer and G. H. Terdik. On multivariate skewness and kurtosis. <em>Sankhya A</em>, 83-A: 607–644, 2021b.
</div>
<div id="ref-khale13" class="csl-entry" role="listitem">
D. Kahle. Mpoly: Multivariate polynomials in <span>R</span>. <em>The R Journal</em>, 5(1): 162–170, 2013. URL <a href="https://journal.r-project.org/archive/2013-1/kahle.pdf">https://journal.r-project.org/archive/2013-1/kahle.pdf</a>.
</div>
<div id="ref-kolda2009tensor" class="csl-entry" role="listitem">
T. G. Kolda and B. W. Bader. Tensor decompositions and applications. <em>SIAM review</em>, 51(3): 455–500, 2009.
</div>
<div id="ref-kollo2008multivariate" class="csl-entry" role="listitem">
T. Kollo. Multivariate skewness and kurtosis measures with an application in <span>ICA</span>. <em>Journal of Multivariate Analysis</em>, 99(10): 2328–2338, 2008.
</div>
<div id="ref-Komsta22" class="csl-entry" role="listitem">
L. Komsta and F. Novomestky. <em>Moments: Moments, cumulants, skewness, kurtosis and related tests.</em> 2022. URL <a href="https://CRAN.R-project.org/package=moments">https://CRAN.R-project.org/package=moments</a>. R package version 0.14.1.
</div>
<div id="ref-koziol1989" class="csl-entry" role="listitem">
J. A. Koziol. A note on measures of multivariate kurtosis. <em>Biometrical journal</em>, 31(5): 619–624, 1989.
</div>
<div id="ref-koziol1987" class="csl-entry" role="listitem">
J. A. Koziol. An alternative formulation of neyman’s smooth goodness of fit tests under composite alternatives. <em>Metrika</em>, 34(1): 17–24, 1987.
</div>
<div id="ref-Lai20" class="csl-entry" role="listitem">
R. Lai. <em>Arrangements: Fast generators and iterators for permutations, combinations, integer partitions and compositions.</em> 2020. URL <a href="https://CRAN.R-project.org/package=arrangements">https://CRAN.R-project.org/package=arrangements</a>. R package version 1.1.9.
</div>
<div id="ref-Loperfido17" class="csl-entry" role="listitem">
N. Loperfido. A new kurtosis matrix, with statistical applications. <em>Linear Algebra and its Applications</em>, 512: 1–17, 2017. DOI <a href="https://doi.org/10.1016/j.laa.2016.09.033">https://doi.org/10.1016/j.laa.2016.09.033</a>.
</div>
<div id="ref-Loperfido15" class="csl-entry" role="listitem">
N. Loperfido. Singular value decomposition of the third multivariate moment. <em>Linear Algebra and its Applications</em>, 473: 202–216, 2015. DOI <a href="https://doi.org/10.1016/j.laa.2014.05.043">https://doi.org/10.1016/j.laa.2014.05.043</a>. Special issue on Statistics.
</div>
<div id="ref-malkovich1973" class="csl-entry" role="listitem">
J. F. Malkovich and A. A. Afifi. On tests for multivariate normality. <em>Journal of the american statistical association</em>, 68(341): 176–179, 1973.
</div>
<div id="ref-Mardia70" class="csl-entry" role="listitem">
K. V. Mardia. Measures of multivariate skewness and kurtosis with applications. <em>Biometrika</em>, 57: 519–530, 1970.
</div>
<div id="ref-mccullagh2018tensor" class="csl-entry" role="listitem">
P. McCullagh. <em>Tensor methods in statistics.</em> Chapman; Hall/CRC, 2018.
</div>
<div id="ref-mori1994multivariate" class="csl-entry" role="listitem">
T. F. Móri, V. K. Rohatgi and G. J. Székely. On multivariate skewness and kurtosis. <em>Theory of Probability &amp; Its Applications</em>, 38(3): 547–551, 1994.
</div>
<div id="ref-Novom21" class="csl-entry" role="listitem">
F. Novomestky. <em>Matrixcalc: Collection of functions for matrix calculations.</em> 2021. URL <a href="https://CRAN.R-project.org/package=matrixcalc">https://CRAN.R-project.org/package=matrixcalc</a>. R package version 1.0-5.
</div>
<div id="ref-Novom22" class="csl-entry" role="listitem">
F. Novomestky. <em>Orthopolynom: Collection of functions for orthogonal and orthonormal polynomials.</em> 2022. URL <a href="https://CRAN.R-project.org/package=orthopolynom">https://CRAN.R-project.org/package=orthopolynom</a>. R package version 1.0-6.1.
</div>
<div id="ref-ould2015concise" class="csl-entry" role="listitem">
H. Ould-Baba, V. Robin and J. Antoni. Concise formulae for the cumulant matrices of a random vector. <em>Linear Algebra and its Applications</em>, 485: 392–416, 2015.
</div>
<div id="ref-pena2010" class="csl-entry" role="listitem">
D. Peña, F. J. Prieto and J. Viladomat. Eigenvectors of a kurtosis matrix as interesting directions to reveal cluster structure. <em>Journal of Multivariate Analysis</em>, 101(9): 1995–2007, 2010.
</div>
<div id="ref-qi2006rank" class="csl-entry" role="listitem">
L. Qi. Rank and eigenvalues of a supersymmetric tensor, the multivariate homogeneous polynomial and the algebraic hypersurface it defines. <em>Journal of Symbolic Computation</em>, 41(12): 1309–1327, 2006.
</div>
<div id="ref-RRR" class="csl-entry" role="listitem">
R Core Team. <em>R: A language and environment for statistical computing.</em> Vienna, Austria: R Foundation for Statistical Computing, 2023. URL <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-smith2020tutorial" class="csl-entry" role="listitem">
K. D. Smith. A tutorial on multivariate <span class="math inline">\(k\)</span>-statistics and their computation. <em>arXiv preprint arXiv:2005.08373</em>, 2020.
</div>
<div id="ref-terdik2003higher" class="csl-entry" role="listitem">
G. H. Terdik. Higher order statistics and multivariate vector <span>H</span>ermite polynomials for nonlinear analysis of multidimensional time series. <em>Theory of Probability and Mathematical Statistics</em>, (66): 165–186, 2003.
</div>
<div id="ref-terdik2021multivariate" class="csl-entry" role="listitem">
G. H. Terdik. <em>Multivariate statistical methods: Going beyond the linear.</em> Springer Nature, 2021.
</div>
<div id="ref-Taufer22" class="csl-entry" role="listitem">
G. H. Terdik and E. Taufer. <em>MultiStatM: Multivariate statistical methods.</em> 2024. URL <a href="https://CRAN.R-project.org/package=MultiStatM">https://CRAN.R-project.org/package=MultiStatM</a>. R package version 2.0.0.
</div>
<div id="ref-tyler2009" class="csl-entry" role="listitem">
D. E. Tyler, F. Critchley, L. Dümbgen and H. Oja. Invariant co-ordinate selection. <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>, 71(3): 549–592, 2009.
</div>
<div id="ref-Mass02" class="csl-entry" role="listitem">
W. N. Venables and B. D. Ripley. <em>Modern applied statistics with s.</em> Fourth New York: Springer, 2002. URL <a href="https://www.stats.ox.ac.uk/pub/MASS4/">https://www.stats.ox.ac.uk/pub/MASS4/</a>. ISBN 0-387-95457-0.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Terdik &amp; Taufer, "MultiStatM: Multivariate Statistical Methods in R", The R Journal, 2025</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2024-039,
  author = {Terdik, György and Taufer, Emanuele},
  title = {MultiStatM: Multivariate Statistical Methods in R},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2024-039},
  doi = {10.32614/RJ-2024-039},
  volume = {16},
  issue = {4},
  issn = {2073-4859},
  pages = {1}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
