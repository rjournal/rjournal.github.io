<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>AcceptReject: An R Package for Acceptance-Rejection Method</title>

<meta property="description" itemprop="description" content="The AcceptReject package, available for the R programming language on the Comprehensive R Archive Network (CRAN), versioned and maintained on GitHub, offers a simple and efficient solution for generating pseudo-random observations of discrete or continuous random variables using the acceptance-rejection method. This method provides a viable alternative for generating pseudo-random observations in univariate distributions when the inverse of the cumulative distribution function is not in closed form or when suitable transformations involving random variables that we know how to generate are unknown, thereby facilitating the generation of observations for the variable of interest. The package is designed to be simple, intuitive, and efficient, allowing for the rapid generation of observations and supporting multicore parallelism on Unix-based operating systems. Some components are written using C++, and the package maximizes the acceptance probability of the generated observations, resulting in even more efficient execution. The package also allows users to explore the generated pseudo-random observations by comparing them with the theoretical probability mass function or probability density function and to inspect the underlying probability density functions that can be used in the method for generating observations of continuous random variables. This article explores the package in detail, discussing its functionalities, benefits, and practical applications, and provides various benchmarks in several scenarios."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2025-037/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2026-02-04"/>
<meta property="article:created" itemprop="dateCreated" content="2026-02-04"/>
<meta name="article:author" content="Pedro Rafael Diniz Marinho"/>
<meta name="article:author" content="Vera L. D. Tomazella"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="AcceptReject: An R Package for Acceptance-Rejection Method"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="The AcceptReject package, available for the R programming language on the Comprehensive R Archive Network (CRAN), versioned and maintained on GitHub, offers a simple and efficient solution for generating pseudo-random observations of discrete or continuous random variables using the acceptance-rejection method. This method provides a viable alternative for generating pseudo-random observations in univariate distributions when the inverse of the cumulative distribution function is not in closed form or when suitable transformations involving random variables that we know how to generate are unknown, thereby facilitating the generation of observations for the variable of interest. The package is designed to be simple, intuitive, and efficient, allowing for the rapid generation of observations and supporting multicore parallelism on Unix-based operating systems. Some components are written using C++, and the package maximizes the acceptance probability of the generated observations, resulting in even more efficient execution. The package also allows users to explore the generated pseudo-random observations by comparing them with the theoretical probability mass function or probability density function and to inspect the underlying probability density functions that can be used in the method for generating observations of continuous random variables. This article explores the package in detail, discussing its functionalities, benefits, and practical applications, and provides various benchmarks in several scenarios."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2025-037/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2025-037/RJ-2025-037_files/figure-html5/fig-inspect-1-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="AcceptReject: An R Package for Acceptance-Rejection Method"/>
<meta property="twitter:description" content="The AcceptReject package, available for the R programming language on the Comprehensive R Archive Network (CRAN), versioned and maintained on GitHub, offers a simple and efficient solution for generating pseudo-random observations of discrete or continuous random variables using the acceptance-rejection method. This method provides a viable alternative for generating pseudo-random observations in univariate distributions when the inverse of the cumulative distribution function is not in closed form or when suitable transformations involving random variables that we know how to generate are unknown, thereby facilitating the generation of observations for the variable of interest. The package is designed to be simple, intuitive, and efficient, allowing for the rapid generation of observations and supporting multicore parallelism on Unix-based operating systems. Some components are written using C++, and the package maximizes the acceptance probability of the generated observations, resulting in even more efficient execution. The package also allows users to explore the generated pseudo-random observations by comparing them with the theoretical probability mass function or probability density function and to inspect the underlying probability density functions that can be used in the method for generating observations of continuous random variables. This article explores the package in detail, discussing its functionalities, benefits, and practical applications, and provides various benchmarks in several scenarios."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2025-037/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2025-037/RJ-2025-037_files/figure-html5/fig-inspect-1-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="AcceptReject: An R Package for Acceptance-Rejection Method"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-037"/>
<meta name="citation_pdf_url" content="RJ-2025-037.pdf"/>
<meta name="citation_volume" content="17"/>
<meta name="citation_issue" content="4"/>
<meta name="citation_doi" content="10.32614/RJ-2025-037"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="1"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2026/02/04"/>
<meta name="citation_publication_date" content="2026/02/04"/>
<meta name="citation_author" content="Pedro Rafael Diniz Marinho"/>
<meta name="citation_author_institution" content="Federal University of Paraíba"/>
<meta name="citation_author" content="Vera L. D. Tomazella"/>
<meta name="citation_author_institution" content="Federal University of São Carlos"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Various techniques used in connection with random digits;citation_author=John Neumann"/>
  <meta name="citation_reference" content="citation_title=AcceptReject: Acceptance-rejection method for generating pseudo-random observations;citation_author=Pedro Rafael D. Marinho;citation_author=Vera Lucia Damasceno Tomazella"/>
  <meta name="citation_reference" content="citation_title=Modified beta distributions;citation_publisher=Springer;citation_volume=76;citation_author=Saralees Nadarajah;citation_author=Mahdi Teimouri;citation_author=Shou Hsing Shih"/>
  <meta name="citation_reference" content="citation_title=AR: Another look at the acceptance-rejection method;citation_author=Abbas Parchami"/>
  <meta name="citation_reference" content="citation_title=Writing effective and reliable Monte Carlo simulations with the SimDesign package;citation_volume=16;citation_doi=10.20982/tqmp.16.4.p248;citation_author=R. Philip Chalmers;citation_author=Mark C. Adkins"/>
  <meta name="citation_reference" content="citation_title=Package “Rcpp”;citation_author=Dirk Eddelbuettel;citation_author=Romain Francois;citation_author=JJ Allaire;citation_author=Kevin Ushey;citation_author=Qiang Kou;citation_author=Nathan Russell;citation_author=Douglas Bates;citation_author=John Chambers;citation_author=Maintainer Dirk Eddelbuettel"/>
  <meta name="citation_reference" content="citation_title=RcppArmadillo: Accelerating R with high-performance C++ linear algebra;citation_publisher=Elsevier;citation_volume=71;citation_author=Dirk Eddelbuettel;citation_author=Conrad Sanderson"/>
  <meta name="citation_reference" content="citation_title=DISTRIB: Four essential functions for statistical distributions analysis: A new functional approach;citation_author=Abbas Parchami"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","description","draft","author","type","output","header-includes","bibliography","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["AcceptReject: An R Package for Acceptance-Rejection Method"]},{"type":"character","attributes":{},"value":["2026-02-04"]},{"type":"character","attributes":{},"value":["The AcceptReject package, available for the R programming language on the Comprehensive R Archive Network (CRAN), versioned and maintained on GitHub, offers a simple and efficient solution for generating pseudo-random observations of discrete or continuous random variables using the acceptance-rejection method. This method provides a viable alternative for generating pseudo-random observations in univariate distributions when the inverse of the cumulative distribution function is not in closed form or when suitable transformations involving random variables that we know how to generate are unknown, thereby facilitating the generation of observations for the variable of interest. The package is designed to be simple, intuitive, and efficient, allowing for the rapid generation of observations and supporting multicore parallelism on Unix-based operating systems. Some components are written using C++, and the package maximizes the acceptance probability of the generated observations, resulting in even more efficient execution. The package also allows users to explore the generated pseudo-random observations by comparing them with the theoretical probability mass function or probability density function and to inspect the underlying probability density functions that can be used in the method for generating observations of continuous random variables. This article explores the package in detail, discussing its functionalities, benefits, and practical applications, and provides various benchmarks in several scenarios."]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email","url"]}},"value":[{"type":"character","attributes":{},"value":["Pedro Rafael Diniz Marinho"]},{"type":"character","attributes":{},"value":["Federal University of Paraíba"]},{"type":"character","attributes":{},"value":["Department of Statistics","Cidade Universitária, s/n, Departamento de Estatística - UFPB"]},{"type":"character","attributes":{},"value":["0000-0003-1591-8300"]},{"type":"character","attributes":{},"value":["pedro.rafael.mariho@gmail.com"]},{"type":"character","attributes":{},"value":["https://github.com/prdm0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email","url"]}},"value":[{"type":"character","attributes":{},"value":["Vera L. D. Tomazella"]},{"type":"character","attributes":{},"value":["Federal University of São Carlos"]},{"type":"character","attributes":{},"value":["Department of Statistics","Rodovia Washington Luiz, Km 235, Monjolinho"]},{"type":"character","attributes":{},"value":["0000-0002-6780-2089"]},{"type":"character","attributes":{},"value":["vera@ufscar.br"]},{"type":"character","attributes":{},"value":["https://www.servidores.ufscar.br/vera/"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["rjtools::rjournal_pdf_article","distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["\\usepackage{subfig}","\\usepackage{float}"]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"character","attributes":{},"value":["2024-07-16"]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[4]},{"type":"character","attributes":{},"value":["RJ-2025-037"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"double","attributes":{},"value":[1]},{"type":"NULL"}]},{"type":"character","attributes":{},"value":["RJ-2025-037.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-037"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-037"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["AcceptReject","Rcpp","RcppArmadillo","assertthat","cli","ggplot2","glue","numDeriv","purrr","rlang","scales","scattermore","knitr","rmarkdown","cowplot","testthat","magrittr","parallel","AR","DISTRIB","SimDesign"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["ChemPhys","HighPerformanceComputing","NetworkAnalysis","NumericalMathematics","Phylogenetics","ReproducibleResearch","Spatial","TeachingStatistics"]},{"type":"character","attributes":{},"value":["/home/hyndman/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-037/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["AcceptReject_files/figure-html5/fig-bench-1.png","AcceptReject_files/figure-html5/fig-bench-2.png","AcceptReject_files/figure-html5/fig-benchmarking-1.png","AcceptReject_files/figure-html5/fig-benchmarking-2.png","AcceptReject_files/figure-html5/fig-inspect-1-1.png","AcceptReject_files/figure-html5/fig-inspect-1-2.png","AcceptReject_files/figure-html5/fig-nadarajah-1.png","AcceptReject_files/figure-html5/fig-nadarajah-2.png","AcceptReject_files/figure-html5/fig-normal-1.png","AcceptReject_files/figure-html5/fig-normal-2.png","AcceptReject_files/figure-html5/fig-plotfunc-1-1.png","AcceptReject_files/figure-html5/fig-plotfunc-1-2.png","AcceptReject_files/figure-html5/fig-poisson-1-1.png","AcceptReject_files/figure-html5/fig-poisson-1-2.png","AcceptReject_files/figure-latex/fig-bench-1.pdf","AcceptReject_files/figure-latex/fig-bench-2.pdf","AcceptReject_files/figure-latex/fig-benchmarking-1.pdf","AcceptReject_files/figure-latex/fig-benchmarking-2.pdf","AcceptReject_files/figure-latex/fig-inspect-1-1.pdf","AcceptReject_files/figure-latex/fig-inspect-1-2.pdf","AcceptReject_files/figure-latex/fig-nadarajah-1.pdf","AcceptReject_files/figure-latex/fig-nadarajah-2.pdf","AcceptReject_files/figure-latex/fig-normal-1.pdf","AcceptReject_files/figure-latex/fig-normal-2.pdf","AcceptReject_files/figure-latex/fig-plotfunc-1-1.pdf","AcceptReject_files/figure-latex/fig-plotfunc-1-2.pdf","AcceptReject_files/figure-latex/fig-poisson-1-1.pdf","AcceptReject_files/figure-latex/fig-poisson-1-2.pdf","AcceptReject.tex","bibliography.bib","figures/logo.png","RJ-2025-037_files/figure-html5/fig-bench-1.png","RJ-2025-037_files/figure-html5/fig-bench-2.png","RJ-2025-037_files/figure-html5/fig-benchmarking-1.png","RJ-2025-037_files/figure-html5/fig-benchmarking-2.png","RJ-2025-037_files/figure-html5/fig-inspect-1-1.png","RJ-2025-037_files/figure-html5/fig-inspect-1-2.png","RJ-2025-037_files/figure-html5/fig-nadarajah-1.png","RJ-2025-037_files/figure-html5/fig-nadarajah-2.png","RJ-2025-037_files/figure-html5/fig-normal-1.png","RJ-2025-037_files/figure-html5/fig-normal-2.png","RJ-2025-037_files/figure-html5/fig-plotfunc-1-1.png","RJ-2025-037_files/figure-html5/fig-plotfunc-1-2.png","RJ-2025-037_files/figure-html5/fig-poisson-1-1.png","RJ-2025-037_files/figure-html5/fig-poisson-1-2.png","RJ-2025-037_files/figure-latex/fig-bench-1.pdf","RJ-2025-037_files/figure-latex/fig-bench-2.pdf","RJ-2025-037_files/figure-latex/fig-benchmarking-1.pdf","RJ-2025-037_files/figure-latex/fig-benchmarking-2.pdf","RJ-2025-037_files/figure-latex/fig-inspect-1-1.pdf","RJ-2025-037_files/figure-latex/fig-inspect-1-2.pdf","RJ-2025-037_files/figure-latex/fig-nadarajah-1.pdf","RJ-2025-037_files/figure-latex/fig-nadarajah-2.pdf","RJ-2025-037_files/figure-latex/fig-normal-1.pdf","RJ-2025-037_files/figure-latex/fig-normal-2.pdf","RJ-2025-037_files/figure-latex/fig-plotfunc-1-1.pdf","RJ-2025-037_files/figure-latex/fig-plotfunc-1-2.pdf","RJ-2025-037_files/figure-latex/fig-poisson-1-1.pdf","RJ-2025-037_files/figure-latex/fig-poisson-1-2.pdf","RJ-2025-037.pdf","RJ-2025-037.tex","RJ-2025-037.zip","RJournal.sty","RJreferences.bib","RJwrapper.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.30/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      
      // Conditionally add supplementary files button
      if (document.getElementById('supplementary-materials')) {
        // create element safely
        const btn_suppl = document.createElement('a');
        btn_suppl.href = slug + '.zip';
        btn_suppl.className = 'dt-tag';
        btn_suppl.innerHTML = '<i class="fas fa-file-zipper"></i> Supplement';
        buttons.append(btn_suppl);
      }

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"AcceptReject: An R Package for Acceptance-Rejection Method","description":"The AcceptReject package, available for the R programming language on the Comprehensive R Archive Network (CRAN), versioned and maintained on GitHub, offers a simple and efficient solution for generating pseudo-random observations of discrete or continuous random variables using the acceptance-rejection method. This method provides a viable alternative for generating pseudo-random observations in univariate distributions when the inverse of the cumulative distribution function is not in closed form or when suitable transformations involving random variables that we know how to generate are unknown, thereby facilitating the generation of observations for the variable of interest. The package is designed to be simple, intuitive, and efficient, allowing for the rapid generation of observations and supporting multicore parallelism on Unix-based operating systems. Some components are written using C++, and the package maximizes the acceptance probability of the generated observations, resulting in even more efficient execution. The package also allows users to explore the generated pseudo-random observations by comparing them with the theoretical probability mass function or probability density function and to inspect the underlying probability density functions that can be used in the method for generating observations of continuous random variables. This article explores the package in detail, discussing its functionalities, benefits, and practical applications, and provides various benchmarks in several scenarios.","doi":"10.32614/RJ-2025-037","authors":[{"author":"Pedro Rafael Diniz Marinho","authorURL":"https://github.com/prdm0","affiliation":"Federal University of Paraíba","affiliationURL":"#","orcidID":"0000-0003-1591-8300"},{"author":"Vera L. D. Tomazella","authorURL":"https://www.servidores.ufscar.br/vera/","affiliation":"Federal University of São Carlos","affiliationURL":"#","orcidID":"0000-0002-6780-2089"}],"publishedDate":"2026-02-04T00:00:00.000+00:00","citationText":"Marinho & Tomazella, 2026"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-4">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>AcceptReject: An R Package for Acceptance-Rejection Method</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>The AcceptReject package, available for the R programming language on the Comprehensive R Archive Network (CRAN), versioned and maintained on GitHub, offers a simple and efficient solution for generating pseudo-random observations of discrete or continuous random variables using the acceptance-rejection method. This method provides a viable alternative for generating pseudo-random observations in univariate distributions when the inverse of the cumulative distribution function is not in closed form or when suitable transformations involving random variables that we know how to generate are unknown, thereby facilitating the generation of observations for the variable of interest. The package is designed to be simple, intuitive, and efficient, allowing for the rapid generation of observations and supporting multicore parallelism on Unix-based operating systems. Some components are written using C++, and the package maximizes the acceptance probability of the generated observations, resulting in even more efficient execution. The package also allows users to explore the generated pseudo-random observations by comparing them with the theoretical probability mass function or probability density function and to inspect the underlying probability density functions that can be used in the method for generating observations of continuous random variables. This article explores the package in detail, discussing its functionalities, benefits, and practical applications, and provides various benchmarks in several scenarios.</p></p>
</div>

<div class="d-byline">
  Pedro Rafael Diniz Marinho <a href="https://github.com/prdm0" class="uri">https://github.com/prdm0</a> (Federal University of Paraíba)
  
,   Vera L. D. Tomazella <a href="https://www.servidores.ufscar.br/vera/" class="uri">https://www.servidores.ufscar.br/vera/</a> (Federal University of São Carlos)
  
<br/>2026-02-04
</div>

<div class="d-article">
<!-- pandoc::pandoc_activate(version = '3.1.6') -->
<!-- rmarkdown::render('AcceptReject.Rmd', output_format = "all") -->
<!-- pandoc::with_pandoc_version( -->
<!--     version = '3.1.6.2', -->
<!--     rmarkdown::render('AcceptReject.Rmd', output_format = "all") -->
<!-- ) -->
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>The class of Monte Carlo methods and algorithms is a powerful and versatile computational technique that has been widely used in a variety of fields, from physics, statistics, and economics to biology and areas such as social sciences. Through the modeling of complex systems and the performance of stochastic experiments, Monte Carlo simulation allows researchers to explore scenarios that would be impractical or impossible to investigate through traditional experimental methods.</p>
<p>A critical component of any Monte Carlo simulation is the ability to generate pseudo-random observations of a sequence of random variables that follow a given probability distribution. In many cases, these variables can be discrete or continuous, and the ability to generate observations from a sequence of random variables efficiently and accurately is fundamental in simulation studies.</p>
<p>There are several techniques to generate observations from a sequence of random variables, many of which depend on the availability of a closed-form quantile function of the distribution of interest or knowledge of some transformation involving random variables that we know how to generate observations from. Depending on the distribution one wishes to generate observations from, the inverse of the cumulative distribution function (quantile function) does not have a closed form, and in many cases, we do not know transformations involving random variables that we know how to generate observations from, and thus, we can generate observations from the random variable of interest. In this sense, computational methods, such as the Acceptance-Rejection Method (ARM), proposed by John von Neumann in 1951, see <span class="citation" data-cites="neumann1951various"><span class="nocase">von Neumann</span> (<a href="#ref-neumann1951various" role="doc-biblioref">1951</a>)</span>, are a viable alternative for generating observations in the univariate context. For example, in the current scenario, where various distributions and probability distribution generators are being proposed, with these generators being functions that, from the knowledge of a probability distribution, can generate a new probability distribution, the ARM is widely used because it proves to be useful for generating pseudo-random observations of random variables of a discrete or continuous nature.</p>
<p>In the case of univariate distributions, the ARM is an effective technique for generating pseudo-random observations of random variables and has several advantages over other methods such as the Metropolis-Hastings (MH) algorithm, for example. The ARM, often also called the Rejection Method, is an algorithm that can be easily parallelized. Moreover, this method is not sensitive to initial parameters, as in the case of the MH algorithm, and leads to observations that are not dependent. Additionally, in the ARM, it is not necessary to perform a “burn-in,” and it is not required to wait for the algorithm to reach a stationary level, as in the case of MH. The ARM, when well implemented, can be a great alternative for generating observations of random variables in the univariate case and can be considered in many situations before opting for computationally more expensive methods such as MH or Gibbs sampling.</p>
<p>The <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package <span class="citation" data-cites="AcceptReject">(<a href="#ref-AcceptReject" role="doc-biblioref">Marinho and Tomazella 2024</a>)</span> for the R programming language, also available and maintained at <a href="https://github.com/prdm0/AcceptReject/" class="uri">https://github.com/prdm0/AcceptReject/</a>, was specifically developed to handle these challenges. It offers a simple and efficient solution for generating pseudo-random observations of discrete or continuous random variables in univariate distributions, using the ARM to generate pseudo-random observations of a sequence of random variables whose probability mass function (discrete case) or probability density function (continuous case) are complex or poorly explored. The library has detailed documentation and vignettes to assist user understanding. On the package’s website, you can find usage examples and the complete documentation of the package <a href="https://prdm0.github.io/AcceptReject/" class="uri">https://prdm0.github.io/AcceptReject/</a>, in addition to the vignettes.</p>
<p>The design of the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package is simple and intuitive, allowing users to generate observations of random variables quickly and efficiently, and in a parallelized manner, using multicore parallelism on Unix-based operating systems. The package also performs excellently on Windows, as much of the library’s performance comes from optimizing the probability of accepting observations of an auxiliary random variable as observations of the random variable of interest. Additionally, some points have been further optimized using the <a href="https://cran.r-project.org/package=Rcpp">Rcpp</a> <span class="citation" data-cites="eddelbuettel2024package">(<a href="#ref-eddelbuettel2024package" role="doc-biblioref">Eddelbuettel et al. 2024</a>)</span> and <a href="https://cran.r-project.org/package=RcppArmadillo">RcppArmadillo</a> <span class="citation" data-cites="eddelbuettel2014rcpparmadillo">(<a href="#ref-eddelbuettel2014rcpparmadillo" role="doc-biblioref">Eddelbuettel and Sanderson 2014</a>)</span> libraries.</p>
<p>The library, through the <code>accept_reject()</code> function <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html" class="uri">https://prdm0.github.io/AcceptReject/reference/accept_reject.html</a>, only requires the user to provide the probability mass function (for discrete variables) or the probability density function (for continuous variables) they wish to generate observations from, in addition to the list of arguments of the distribution of interest. Other arguments can be passed and are optional, such as the normalization constant value, which by default is obtained automatically, arguments involving the optimization method, a probability mass function (discrete case), or probability density function (continuous case), if the user wishes to specify a base distribution, which can be useful in cases of more complex distributions.</p>
<p>With the use of simple functions such as <a href="https://prdm0.github.io/AcceptReject/reference/"><code>inspect()</code></a> and <a href="https://prdm0.github.io/AcceptReject/reference/plot.accept_reject.html"><code>plot()</code></a> the user can inspect the base probability density function and the quality of generating pseudo-random observations quickly, without spending much time on plotting, making the analysis process faster, which is as important as computational efficiency.</p>
<p>In this article, we will explore the <a href="#">AcceptReject</a> package in detail. We will discuss how it can be used, the functionalities it offers, and the benefits it brings to users. Through examples and discussions, we hope to demonstrate the value of the <a href="#">AcceptReject</a> package as a useful addition to the toolbox of any researcher or professional working with Monte Carlo simulations.</p>
<p>Initially, in Section 2, the article will discuss the ARM and how it can be used to generate pseudo-random observations of random variables. In Section 3, the dependencies used in the current version of the package will be listed and referenced, and some computational details considered in the examples and simulations will be presented. In Section 4, it shows how to install and load the package from CRAN and GitHub. In Section 5, each of the functions exported by the <a href="#">AcceptReject</a> package is discussed, and some examples are presented to help expose the details. In Section 6, more examples of the package’s use are presented, showing the package for generating pseudo-random observations of discrete and continuous random variables, and Section 7 is dedicated to presenting a more complex problem, in a more realistic scenario, where a probability distribution generator, proposed by <span class="citation" data-cites="nadarajah2014modified">Nadarajah et al. (<a href="#ref-nadarajah2014modified" role="doc-biblioref">2014</a>)</span>, is used to generate the Modified Beta Weibull (MBW) probability density function, where we do not know its quantile function, and thus, the ARM applied using the <a href="#">AcceptReject</a> package can solve the problem of generating observations of a random variable with MBW distribution. In Section 8, benchmarks are presented in different scenarios to demonstrate the computational efficiency of the package. In Section 9, similar works are compared with the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package, and layout and performance advantages are presented. Finally, in Section 10, a conclusion is presented with suggestions for future improvements to enhance the package.</p>
<h2 data-number="2" id="acceptance-rejection-method---arm"><span class="header-section-number">2</span> Acceptance-Rejection Method - ARM</h2>
<p>The acceptance-rejection method - ARM, proposed by <span class="citation" data-cites="neumann1951various">(<a href="#ref-neumann1951various" role="doc-biblioref"><span class="nocase">von Neumann</span> 1951</a>)</span> and often simply called the rejection method, is a useful method for generating pseudo-random observations of discrete or continuous random variables, mainly in the context of univariate distributions, to which the <span class="pkg">AcceptReject</span> package is intended. The method is based on the idea that, if we can find a probability distribution <span class="math inline">\(G_Y\)</span> of a random variable <span class="math inline">\(Y\)</span> that envelops (bounds) the probability distribution <span class="math inline">\(F_X\)</span> of the random variable <span class="math inline">\(X\)</span> of interest, and <span class="math inline">\(G\)</span> and <span class="math inline">\(F\)</span> share the same support, then we can generate observations of <span class="math inline">\(X\)</span>. In addition to sharing the same support and having <span class="math inline">\(G_Y\)</span> bounding <span class="math inline">\(f_X\)</span>, it is necessary that we can generate observations of <span class="math inline">\(Y\)</span>, that is, in practice, we will have a function that generates observations of this random variable. Through the generator of <span class="math inline">\(Y\)</span>, we can then generate observations of the random variable of interest <span class="math inline">\(X\)</span>, accepting or rejecting the observations generated by the observation generator of <span class="math inline">\(Y\)</span>, based on the probability density functions or probability mass functions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, in the continuous or discrete case, respectively.</p>
<p>Consider a hypothetical example, with <span class="math inline">\(x,y \in [0, 5]\)</span>, where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are observations of the random variables <span class="math inline">\(X\)</span> (variable of interest) and <span class="math inline">\(Y\)</span> (variable from which we can generate observations), respectively, and assuming we do not know how to generate observations of <span class="math inline">\(X\)</span>, for example, from the Weibull distribution (in practice, this is not true), where <span class="math inline">\(X \sim Weibull(\alpha = 2, \beta = 1)\)</span>, with <span class="math inline">\(c \times Y \sim \mathcal{U}(a = 0, b = 5)\)</span>, where <span class="math inline">\(c \geq 1\)</span>. In this example, given a density function used as a basis (density function of <span class="math inline">\(Y\)</span>), the initial idea of ARM is to make the base density, denoted by <span class="math inline">\(g_Y\)</span>, envelop (bound) the probability density function of interest, that is, envelop <span class="math inline">\(f_X\)</span>. The Figure <a href="#fig:fig-inspect-1">1</a> (a) and Figure <a href="#fig:fig-inspect-1">1</a> (b) illustrate the procedure for choosing the constant <span class="math inline">\(c\)</span> for ARM, with <span class="math inline">\(c = 1\)</span> and <span class="math inline">\(c = 4.3\)</span>, respectively.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-inspect-1"></span>
<img src="RJ-2025-037_files/figure-html5/fig-inspect-1-1.png" alt="Inspection of the probability density function of the random variable of interest with the base probability density function, with $c = 1$ (default) (a) and $c = 4.3$ (b)." width="50%" /><img src="RJ-2025-037_files/figure-html5/fig-inspect-1-2.png" alt="Inspection of the probability density function of the random variable of interest with the base probability density function, with $c = 1$ (default) (a) and $c = 4.3$ (b)." width="50%" />
<p class="caption">
Figure 1: Inspection of the probability density function of the random variable of interest with the base probability density function, with <span class="math inline">\(c = 1\)</span> (default) (a) and <span class="math inline">\(c = 4.3\)</span> (b).
</p>
</div>
</div>
<p>Notice that the support of the base probability density function <span class="math inline">\(g_Y\)</span> must be the same as <span class="math inline">\(f_X\)</span>, since the observations generated from <span class="math inline">\(Y\)</span> are accepted or rejected as observations of <span class="math inline">\(X\)</span> (the random variable of interest). The interval <span class="math inline">\(x,y \in [0, 5]\)</span> was chosen because the density near the upper limit of this interval quickly drops to values close to zero, eliminating the need to consider a broader interval, although it could be considered. It is possible to see, with the help of Figure <a href="#fig:fig-inspect-1">1</a> (a), that <span class="math inline">\(c = 1\)</span> is not a good choice, as much of the density <span class="math inline">\(f_X\)</span> would be left out and not captured by <span class="math inline">\(g_Y\)</span>, i.e., it would not be bounded by <span class="math inline">\(g_Y\)</span>. Therefore, increasing the value of <span class="math inline">\(c\)</span> in this hypothetical example is necessary for good generation of observations of <span class="math inline">\(X\)</span>. Note in Figure <a href="#fig:fig-inspect-1">1</a> (a) that the intersection area is approximately 0.39, and in the optimal case, we should have <span class="math inline">\(c \geq 1\)</span>, such that the intersection area between <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span> is 1, and <span class="math inline">\(c\)</span> is the smallest possible value. A small value of <span class="math inline">\(c\)</span> will always imply a higher probability of accepting observations of <span class="math inline">\(Y\)</span> as observations of <span class="math inline">\(X\)</span>. Thus, the choice of <span class="math inline">\(c\)</span> will be a trade-off between computational efficiency (higher acceptance probability) and ensuring that the base density bounds the density of interest.</p>
<p>Note now that for <span class="math inline">\(c = 4.3\)</span>, in Figure <a href="#fig:fig-inspect-1">1</a> (b), the intersection area is equal to <span class="math inline">\(1\)</span> and <span class="math inline">\(g_Y\)</span> does not excessively bound <span class="math inline">\(f_X\)</span>, thus becoming a convenient value. In this way, <span class="math inline">\(c = 4.3\)</span> could be an appropriate value for the given example. However, a larger value of <span class="math inline">\(c\)</span> could be used, which would decrease the computational efficiency of ARM, for reasons that will be presented later.</p>
<p>What makes the method interesting is that the iterations of ARM are not mathematically dependent, making it easily parallelizable. Although it can be extended to the bivariate or multivariate case, the method is most commonly used to generate univariate observations. Moreover, if the distribution of the random variable from which pseudo-random observations are to be generated is indexed by many parameters, ARM can be applied without major impacts, as the number of parameters usually does not affect the efficiency of the method.</p>
<p>Considering the discrete case, suppose <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are random variables with probability density function (pdf) or probability function (pf) <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>, respectively. Furthermore, suppose there exists a constant <span class="math inline">\(c\)</span> such that</p>
<p><span class="math display">\[\frac{f(x)}{g(y)} \leq c,\]</span> for every value of <span class="math inline">\(x\)</span>, with <span class="math inline">\(f(x) &gt; 0\)</span>. To use the acceptance-rejection method to generate observations of the random variable <span class="math inline">\(X\)</span>, using the algorithm below, first find a random variable <span class="math inline">\(Y\)</span> with pdf or pf <span class="math inline">\(g\)</span>, such that it satisfies the above condition.</p>
<p>It is important that the chosen random variable <span class="math inline">\(Y\)</span> is such that you can easily generate its observations. This is because the acceptance-rejection method is computationally more intensive than more direct methods such as the transformation method or the inversion method, which only requires the generation of pseudo-random numbers with a uniform distribution.</p>
<p><strong>Algorithm of the Acceptance-Rejection Method</strong>:</p>
<p>1 - Generate an observation <span class="math inline">\(y\)</span> from a random variable <span class="math inline">\(Y\)</span> with pdf/pf <span class="math inline">\(g\)</span>;</p>
<p>2 - Generate an observation <span class="math inline">\(u\)</span> from a random variable <span class="math inline">\(U\sim \mathcal{U} (0, 1)\)</span>;</p>
<p>3 - If <span class="math inline">\(u &lt; \frac{f(y)}{cg(y)}\)</span> accept <span class="math inline">\(x = y\)</span>; otherwise, reject <span class="math inline">\(y\)</span> as an observation of the random variable <span class="math inline">\(X\)</span> and go back to step 1.</p>
<p><strong>Proof</strong>: Consider the discrete case, that is, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are random variables with pfs <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>, respectively. By step 3 of the algorithm above, we have <span class="math inline">\(\{accept\} =  \{x = y\} = u &lt; \frac{f(y)}{cg(y)}\)</span>. That is,</p>
<p><span class="math display">\[P(accept | Y = y) = \frac{P(accept \cap \{Y = y\})}{g(y)} = \frac{P(U \leq f(y)/cg(y)) \times g(y)}{g(y)} = \frac{f(y)}{cg(y)}.\]</span> Hence, by the <a href="https://en.wikipedia.org/wiki/Law_of_total_probability"><strong>Law of Total Probability</strong></a>, we have:</p>
<p><span class="math display">\[P(accept) = \sum_y P(accept|Y=y)\times P(Y=y) = \sum_y \frac{f(y)}{cg(y)}\times g(y) = \frac{1}{c}.\]</span> Therefore, by the acceptance-rejection method, we accept the occurrence of <span class="math inline">\(Y\)</span> as an occurrence of <span class="math inline">\(X\)</span> with probability <span class="math inline">\(1/c\)</span>. Moreover, by Bayes’ Theorem, we have</p>
<p><span class="math display">\[P(Y = y | accept) = \frac{P(accept|Y = y)\times g(y)}{P(accept)} = \frac{[f(y)/cg(y)] \times g(y)}{1/c} = f(y).\]</span> The result above shows that accepting <span class="math inline">\(x = y\)</span> by the algorithm’s procedure is equivalent to accepting a value from <span class="math inline">\(X\)</span> that has pf <span class="math inline">\(f\)</span>. For the continuous case, the proof is similar.</p>
<p>Notice that to reduce the computational cost of the method, we should choose <span class="math inline">\(c\)</span> in such a way that we can maximize <span class="math inline">\(P(accept)\)</span>. Therefore, choosing an excessively large value of the constant <span class="math inline">\(c\)</span> will reduce the probability of accepting an observation from <span class="math inline">\(Y\)</span> as an observation of the random variable <span class="math inline">\(X\)</span>.</p>
<p>Computationally, it is convenient to consider <span class="math inline">\(Y\)</span> as a random variable with a uniform distribution on the support of <span class="math inline">\(f\)</span>, since generating observations from a uniform distribution is straightforward on any computer. For the discrete case, considering <span class="math inline">\(Y\)</span> with a discrete uniform distribution might be a good alternative.</p>
<p>Choosing an excessively large value for <span class="math inline">\(c\)</span> will increase the chances of generating good observations of <span class="math inline">\(X\)</span>, as an excessive value for <span class="math inline">\(c\)</span>, in many situations, will allow the base distribution <span class="math inline">\(g\)</span> to bound <span class="math inline">\(f\)</span>. The problem, however, will be the computational cost. Thus, the problem of choosing an appropriate value for <span class="math inline">\(c\)</span> is an optimization problem, where selecting an appropriate value for <span class="math inline">\(c\)</span> is a task that can be automated. Additionally, it is important to note that choosing an excessively large value for the constant <span class="math inline">\(c\)</span>, although it will lead to excessively slow code, is not as significant a problem as choosing an excessively small value for <span class="math inline">\(c\)</span>, which will lead to the generation of poor observations of <span class="math inline">\(X\)</span>. Since it is an optimization problem, it is possible to choose a convenient value for <span class="math inline">\(c\)</span> that is neither too large nor too small, generating good observations for <span class="math inline">\(X\)</span> with a very acceptable computational cost.</p>
<p>Therefore, the <a href="#">AcceptReject</a> package aims to automate some tasks, including the optimization of the value of <span class="math inline">\(c\)</span>. Thus, it becomes clear that, given a probability density function (continuous case) or probability mass function (discrete case) <span class="math inline">\(g\)</span>, obtaining the smallest value of <span class="math inline">\(c\)</span>, such that <span class="math inline">\(c \geq 1\)</span>, combined with the possibility of code parallelism, are excellent ways to reduce the computational cost of ARM. This is, among other things, what the <a href="#">AcceptReject</a> package does through its <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html"><code>accept_reject()</code></a> function and other available functions. In the following sections, we will discuss each of them in detail.</p>
<p>The first article describing the acceptance-rejection method is by von Neumann, titled “Various techniques used in connection with random digits” from 1951 <span class="citation" data-cites="neumann1951various">(<a href="#ref-neumann1951various" role="doc-biblioref"><span class="nocase">von Neumann</span> 1951</a>)</span>. Several common books in the field of stochastic simulations and Monte Carlo methods also detail the method, such as <span class="citation" data-cites="kroese2013handbook">(<a href="#ref-kroese2013handbook" role="doc-biblioref">Kroese et al. 2013</a>)</span>, <span class="citation" data-cites="asmussen2007stochastic">(<a href="#ref-asmussen2007stochastic" role="doc-biblioref">Asmussen and Glynn 2007</a>)</span>, <span class="citation" data-cites="kemp2003discrete">(<a href="#ref-kemp2003discrete" role="doc-biblioref">Kemp 2003</a>)</span>, and <span class="citation" data-cites="gentle2003random">(<a href="#ref-gentle2003random" role="doc-biblioref">Gentle 2003</a>)</span>.</p>
<h2 data-number="3" id="dependencies-and-some-computational-details"><span class="header-section-number">3</span> Dependencies and Some Computational Details</h2>
<p>The <a href="#">AcceptReject</a> package <span class="citation" data-cites="AcceptReject">(<a href="#ref-AcceptReject" role="doc-biblioref">Marinho and Tomazella 2024</a>)</span> has several dependencies, which, in its most current version, can be observed in the <a href="https://github.com/prdm0/AcceptReject/blob/main/DESCRIPTION">DESCRIPTION</a> file. In the current version on GitHub, version 0.1.2, the dependencies are <a href="https://cran.r-project.org/package=assertthat">assertthat</a> <span class="citation" data-cites="assertthat">(<a href="#ref-assertthat" role="doc-biblioref">Wickham 2019</a>)</span>, <a href="https://cran.r-project.org/package=cli">cli</a> <span class="citation" data-cites="cli">(<a href="#ref-cli" role="doc-biblioref">Csárdi 2023</a>)</span>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span>, <a href="https://cran.r-project.org/package=glue">glue</a> <span class="citation" data-cites="glue">(<a href="#ref-glue" role="doc-biblioref">Hester and Bryan 2024</a>)</span>, <a href="https://cran.r-project.org/package=numDeriv">numDeriv</a> <span class="citation" data-cites="numDeriv">(<a href="#ref-numDeriv" role="doc-biblioref">Gilbert and Varadhan 2019</a>)</span>, <a href="https://cran.r-project.org/package=purrr">purrr</a> <span class="citation" data-cites="purrr">(<a href="#ref-purrr" role="doc-biblioref">Wickham and Henry 2023</a>)</span>, <a href="https://cran.r-project.org/package=Rcpp">Rcpp</a> <span class="citation" data-cites="eddelbuettel2024package">(<a href="#ref-eddelbuettel2024package" role="doc-biblioref">Eddelbuettel et al. 2024</a>)</span>, <a href="https://cran.r-project.org/package=RcppArmadillo">RcppArmadillo</a> <span class="citation" data-cites="eddelbuettel2014rcpparmadillo">(<a href="#ref-eddelbuettel2014rcpparmadillo" role="doc-biblioref">Eddelbuettel and Sanderson 2014</a>)</span>, <a href="https://cran.r-project.org/package=rlang">rlang</a> <span class="citation" data-cites="rlang">(<a href="#ref-rlang" role="doc-biblioref">Henry and Wickham 2024</a>)</span>, <a href="https://cran.r-project.org/package=scales">scales</a> <span class="citation" data-cites="scales">(<a href="#ref-scales" role="doc-biblioref">Wickham et al. 2023</a>)</span>, and <a href="https://cran.r-project.org/package=scattermore">scattermore</a> <span class="citation" data-cites="scattermore">(<a href="#ref-scattermore" role="doc-biblioref">Kulichova and Kratochvil 2023</a>)</span>. Suggested libraries include <a href="https://cran.r-project.org/package=knitr">knitr</a> <span class="citation" data-cites="knitr">(<a href="#ref-knitr" role="doc-biblioref">Xie 2024</a>)</span>, <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a> <span class="citation" data-cites="rmarkdown">(<a href="#ref-rmarkdown" role="doc-biblioref">Allaire et al. 2024</a>)</span>, <a href="https://cran.r-project.org/package=cowplot">cowplot</a> <span class="citation" data-cites="cowplot">(<a href="#ref-cowplot" role="doc-biblioref">Wilke 2024</a>)</span>, and <a href="https://cran.r-project.org/package=testthat">testthat</a> <span class="citation" data-cites="testthat">(<a href="#ref-testthat" role="doc-biblioref">Wickham 2011</a>)</span>.</p>
<p>In some examples that use the pipe operator <code>|&gt;</code>, internal to the R language, it is necessary to have version 4.1.0 or higher of the language. However, this operator is not essential in the examples and can be easily omitted. The <code>%&gt;%</code> operator from the <a href="https://cran.r-project.org/package=magrittr">magrittr</a> package <span class="citation" data-cites="magrittr">(<a href="#ref-magrittr" role="doc-biblioref">Bache and Wickham 2022</a>)</span> can also be used, as the <a href="#">purrr</a> package exports it. In fact, the <code>|&gt;</code> operator has not been used internally in any function of the <a href="#">AcceptReject</a> package, in the current version on GitHub, so that it can pass the automatic checks of GitHub Actions, whose tests also consider older versions of the R language.</p>
<p>Additionally, some examples load the <a href="https://cran.r-project.org/package=parallel">parallel</a> library, included in the R language since version 2.14 in 2011. In these examples, where ARM executions are performed in parallel, to ensure the reproducibility of the results, it is necessary to call the instructions <code>RNGkind("L'Ecuyer-CMRG")</code> and <code>mc.reset.stream()</code>. The <code>RNGkind("L'Ecuyer-CMRG")</code> instruction sets the L’Ecuyer-CMRG pseudo-random number generator <span class="citation" data-cites="l1999good">(<a href="#ref-l1999good" role="doc-biblioref">L’ecuyer 1999</a>)</span> and <span class="citation" data-cites="l2002object">(<a href="#ref-l2002object" role="doc-biblioref">L’ecuyer et al. 2002</a>)</span>, which is a safe type of generator to use in parallel calculations, as it is a generator of multiple independent streams. The <code>mc.reset.stream()</code> function resets the stream of random numbers, ensuring that in a subsequent execution, the same sequence is generated again.</p>
<p>To take advantage of parallelism in ARM implemented in the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package, which works on Unix-based operating systems, it is not necessary to load the <a href="https://cran.r-project.org/package=parallel">parallel</a> library, as the <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html"><code>accept_reject()</code></a> function of the <a href="#">AcceptReject</a> package already makes use of parallelism. Loading the <a href="#">parallel</a> library is only interesting if reproducibility is desired when execution is done in parallel using multiple processes, meaning when there is interest in executing the instructions <code>RNGkind("L'Ecuyer-CMRG")</code> and <code>mc.reset.stream()</code>.</p>
<p>Simulations for benchmarking in parallel and non-parallel scenarios were performed on a computer with the Arch Linux operating system, an Intel Core(TM) i7-1260P processor with 16 threads, a maximum processor frequency of 4.70 GHz, and 16 GB of RAM. The version of the R language was 4.4.0, and the computational times considered are in logarithmic scale, base 10.</p>
<p>The <a href="#">AcceptReject</a> package makes use of the S3 object-oriented system in R. Simple functions like <code>plot()</code>, <code>qqplot()</code>, and <code>print()</code> were exported to dispatch for the <code>accept_reject</code> class of the <a href="#">AcceptReject</a> package, making it easier to use. Other object-oriented systems, such as the R6 system <span class="citation" data-cites="r6">(<a href="#ref-r6" role="doc-biblioref">Chang 2021</a>)</span>, were not considered, as this would make the use of the package non-idiomatic, and some users might feel discouraged from using the library. Historical details about the programming paradigms of the R language can be found in <span class="citation" data-cites="chambers2014object">(<a href="#ref-chambers2014object" role="doc-biblioref">Chambers 2014</a>)</span>.</p>
<h2 data-number="4" id="installation-and-loading-the-package"><span class="header-section-number">4</span> Installation and loading the package</h2>
<p>The <a href="#">AcceptReject</a> package is available on CRAN and GitHub and can be installed using the following command:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Install CRAN version</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"remotes"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Installing the development version from GitHub</span></span>
<span><span class='co'># or install.packages("remotes")</span></span>
<span><span class='fu'>remotes</span><span class='fu'>::</span><span class='fu'><a href='https://remotes.r-lib.org/reference/install_github.html'>install_github</a></span><span class='op'>(</span><span class='st'>"prdm0/AcceptReject"</span>, force <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Load the package</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://prdm0.github.io/AcceptReject/'>AcceptReject</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:logo"></span>
<img src="figures/logo.png" alt="Logo of the package." width="25%" />
<p class="caption">
Figure 2: Logo of the package.
</p>
</div>
</div>
<p>To access the latest updates of the <a href="#">AcceptReject</a> package versions, check the <a href="https://prdm0.github.io/AcceptReject/news/">changelog</a>. For suggestions, questions, or to report issues and bugs, please open an <a href="https://github.com/prdm0/AcceptReject/issues">issue</a>. For a more general and quick overview of the package, read the <a href="https://github.com/prdm0/AcceptReject">README.md</a> file or visit the package’s website at <a href="https://prdm0.github.io/AcceptReject/" class="uri">https://prdm0.github.io/AcceptReject/</a> to explore usage examples.</p>
<h2 data-number="5" id="function-details-and-package-usage"><span class="header-section-number">5</span> Function details and package usage</h2>
<p>The <a href="#">AcceptReject</a> package provides functions not only to generate observations using ARM in an optimized manner, but it also exports auxiliary functions that allow inspecting the base density function <span class="math inline">\(g_Y\)</span>, as well as the generation of pseudo-random observations after the creation, making the generation and inspection work efficient, easy, and intuitive. Efficient from a computational point of view by automatically optimizing the constant <span class="math inline">\(c\)</span> and, therefore, maximizing the acceptance probability <span class="math inline">\(1/c\)</span> of accepting observations of <span class="math inline">\(Y\)</span> as observations of <span class="math inline">\(X\)</span>, in addition to allowing multicore parallelism in Unix-based operating systems. The computational efficiency combined with the ease of inspecting <span class="math inline">\(g_Y\)</span> and the generated observations makes the package pleasant to use. The <a href="#">AcceptReject</a> library provides the following functions:</p>
<ul>
<li><p><a href="https://prdm0.github.io/AcceptReject/reference/inspect.html"><code>inspect()</code></a>: a useful function for inspecting the probability density function <span class="math inline">\(f_X\)</span> with the base probability density function <span class="math inline">\(g_Y\)</span>, highlighting the intersection between the two functions and the value of the areas, allowing experimentation with different values of <span class="math inline">\(c\)</span>. This function does not perform any optimization; it simply facilitates the inspection of the proposed <span class="math inline">\(g_Y\)</span> as a base probability density function, returning an object of the secondary class <code>gg</code> and the primary class <code>ggplot</code> for graphs created with the <a href="#">ggplot2</a> library, as shown in Figure <a href="#fig:fig-inspect-1">1</a> (a) and Figure <a href="#fig:fig-inspect-1">1</a> (b);</p></li>
<li><p><a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html"><code>accept_reject()</code></a>: implements ARM, optimizes the constant <span class="math inline">\(c\)</span>, and performs parallelism if specified by the user. The user can also specify details in the optimization process or define a value for <span class="math inline">\(c\)</span> and thus assume this value of <span class="math inline">\(c\)</span>, omitting the optimization process. Additionally, it is possible to specify or not a base probability mass function or probability density function <span class="math inline">\(g_Y\)</span>, depending on whether <span class="math inline">\(X\)</span> is a discrete or continuous random variable, respectively. If omitted, <span class="math inline">\(Y \sim \mathcal{U}\)</span> discrete or continuous will be considered, depending on the nature of <span class="math inline">\(X\)</span>. Moreover, the user can specify, in the case of not specifying the value of the constant <span class="math inline">\(c\)</span>, an initial guess used in the optimization process of the constant <span class="math inline">\(c\)</span>. A good guess can be given by graphically inspecting the relationship between <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span>. In most cases, the <code>accept_reject()</code> function will provide good acceptances without specifying <span class="math inline">\(g_Y\)</span> different from the default discrete or continuous uniform distribution and will make a good estimation of <span class="math inline">\(c\)</span>;</p></li>
<li><p><a href="https://prdm0.github.io/AcceptReject/reference/print.accept_reject.html"><code>print.accept_reject()</code></a>: a function responsible for printing useful information on the screen about objects of the <code>accept_reject</code> class returned by the <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html"><code>accept_reject()</code></a> function, such as the number of generated observations, the estimated constant <span class="math inline">\(c\)</span>, and the estimated acceptance probability of accepting observations of <span class="math inline">\(Y\)</span> as observations of <span class="math inline">\(X\)</span>;</p></li>
<li><p><a href="https://prdm0.github.io/AcceptReject/reference/plot.accept_reject.html"><code>plot.accept_reject()</code></a>: operates on objects of the <code>accept_reject</code> class returned by the <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html"><code>accept_reject()</code></a> function. The <a href="https://prdm0.github.io/AcceptReject/reference/plot.accept_reject.html"><code>plot.accept_reject()</code></a> function returns an object of the secondary class <code>gg</code> and the primary class <code>ggplot</code> from the <a href="#">ggplot2</a> package, allowing easy graphical comparison of the probability density function or probability mass function <span class="math inline">\(f_X\)</span> with the observed probability density function or mass function from the generated data;</p></li>
<li><p><a href="https://prdm0.github.io/AcceptReject/reference/qqplot.html"><code>qqplot()</code></a>: constructs a Quantile-Quantile plot (QQ-plot) to compare the distribution of data generated by ARM (observed distribution) with the distribution of the random variable <span class="math inline">\(X\)</span> (theoretical distribution, denoted by <span class="math inline">\(f_X\)</span>). In a very simple way, the QQ-plot is produced by passing an object of the <code>accept_reject</code> class, returned by the <code>accept_reject()</code> function, to the <code>qqplot()</code> function.</p></li>
</ul>
<p>In the following subsections, more details about the functions exported by the <a href="#">AcceptReject</a> package will be presented. Examples are provided to facilitate understanding. Additional details about the functions can be found in the function documentation, which can be accessed using <code>help(package = "AcceptReject")</code> or on the package’s website, hosted in the GitHub repository that versions the development of the library at <a href="https://prdm0.github.io/AcceptReject/" class="uri">https://prdm0.github.io/AcceptReject/</a>.</p>
<h3 data-number="5.1" id="inspecting-density-functions"><span class="header-section-number">5.1</span> Inspecting Density Functions</h3>
<p>The <a href="https://prdm0.github.io/AcceptReject/reference/inspect.html"><code>inspect()</code></a> function of the <a href="#">AcceptReject</a> package is useful when we want to generate pseudo-random observations of a continuous random variable using ARM. It is possible to skip this inspection since the <code>accept_reject()</code> function already automatically considers the continuous uniform distribution as the base density and optimizes, based on this base distribution, the best value for the constant <span class="math inline">\(c\)</span>. Additionally, other base densities <span class="math inline">\(g_Y\)</span> can be specified to the <code>accept_reject()</code> function, where the search for the constant <span class="math inline">\(c\)</span> will be done automatically, optimizing the value of <span class="math inline">\(c\)</span> and its relationship with <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span>, given <span class="math inline">\(g_Y\)</span>.</p>
<p>To specify other base density functions <span class="math inline">\(g_Y\)</span>, it is prudent to perform a graphical inspection of the relationship between <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span> to get an idea of the reasonableness of the candidate base probability density function <span class="math inline">\(g_Y\)</span>. Thus, the <code>inspect()</code> function will automatically plot a graph with some useful information, as well as the functions <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span>. The <code>inspect()</code> function will return an object with the secondary class <code>gg</code> and the primary class <code>ggplot</code> (a graph made with the <a href="#">ggplot2</a> library) highlighting the intersection area between <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span> and the value of this area for a given <span class="math inline">\(c\)</span>, specified in the <code>c</code> argument of the <code>inspect()</code> function.</p>
<p>Theoretically, you can use any function <span class="math inline">\(g_Y\)</span> that has support equivalent to that of the function <span class="math inline">\(f_X\)</span>, finding the appropriate value of <span class="math inline">\(c\)</span> that will make <span class="math inline">\(g_Y\)</span> envelop <span class="math inline">\(f_X\)</span>, that is, so that the value of the intersection area integrates to 1. The <code>inspect()</code> function has the following form:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/inspect.html'>inspect</a></span><span class='op'>(</span></span>
<span>  <span class='va'>f</span>,</span>
<span>  <span class='va'>args_f</span>,</span>
<span>  <span class='va'>f_base</span>,</span>
<span>  <span class='va'>args_f_base</span>,</span>
<span>  <span class='va'>xlim</span>,</span>
<span>  c <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  alpha <span class='op'>=</span> <span class='fl'>0.4</span>,</span>
<span>  color_intersection <span class='op'>=</span> <span class='st'>"#BB9FC9"</span>,</span>
<span>  color_f <span class='op'>=</span> <span class='st'>"#FE4F0E"</span>,</span>
<span>  color_f_base <span class='op'>=</span> <span class='st'>"#7BBDB3"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>where:</p>
<ol type="1">
<li><code>f</code> is the probability density function <span class="math inline">\(f_X\)</span> of the random variable <span class="math inline">\(X\)</span> of interest;</li>
<li><code>args_f</code>: is a list of arguments that will be passed to the probability density function <span class="math inline">\(f_X\)</span> and that specify the parameters of the density of <span class="math inline">\(X\)</span>;</li>
<li><code>f_base</code>: is the probability density function that will supposedly be used as the base density <span class="math inline">\(g_Y\)</span>;</li>
<li><code>args_f_base</code>: is a list of arguments that will be passed to the base probability density function <span class="math inline">\(g_Y\)</span> and that specify the parameters of the density of <span class="math inline">\(Y\)</span>;</li>
<li><code>xlim</code>: is a vector of size two that specifies the support of the functions <span class="math inline">\(f_Y\)</span> and <span class="math inline">\(g_Y\)</span> (they must be equivalent);</li>
<li><code>c</code>: is the constant <span class="math inline">\(c\)</span> that will be used to multiply the base probability density function <span class="math inline">\(g_Y\)</span>, so it envelops (bounds) <span class="math inline">\(f_X\)</span>. The default is <code>c = 1</code>;</li>
<li><code>alpha</code>: is the transparency of the intersection area (default is <code>alpha = 0.4</code>);</li>
<li><code>color_intersection</code>: is the color of the intersection area between <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span>, where the default is <code>color_intersection = #BB9FC9</code>;</li>
<li><code>color_f</code>: is the color of the curve of the probability density function <span class="math inline">\(f_X\)</span> (default is <code>color_f = #FE4F0E</code>);</li>
<li><code>color_f_base</code>: is the color of the curve of the base probability density function <span class="math inline">\(g_Y\)</span>, where the default is <code>color_f_base = #7BBDB3</code>.</li>
</ol>
<p>The Figure <a href="#fig:fig-inspect-1">1</a> (a) and Figure <a href="#fig:fig-inspect-1">1</a> (b), presented at the beginning of this paper, were automatically created with the <a href="https://prdm0.github.io/AcceptReject/reference/inspect.html"><code>inspect()</code></a> function. As an example, in addition to those available in the package documentation and vignettes, here is the code that generated the graph shown in Figure <a href="#fig:fig-inspect-1">1</a> (a):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://prdm0.github.io/AcceptReject/'>AcceptReject</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Considering c = 1 (default)</span></span>
<span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/inspect.html'>inspect</a></span><span class='op'>(</span></span>
<span>  f <span class='op'>=</span> <span class='va'>dweibull</span>,</span>
<span>  f_base <span class='op'>=</span> <span class='va'>dunif</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>2</span>, scale <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>  args_f_base <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>min <span class='op'>=</span> <span class='fl'>0</span>, max <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>  c <span class='op'>=</span> <span class='fl'>1</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="5.2" id="generating-observations-with-arm"><span class="header-section-number">5.2</span> Generating Observations with ARM</h3>
<p>The most important function of the <a href="#">AcceptReject</a> package is the <code>accept_reject()</code> function, as it is the function that implements ARM and all the optimizations to obtain a good generation of <span class="math inline">\(X\)</span>. The <code>accept_reject()</code> function has the following signature:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>  n <span class='op'>=</span> <span class='fl'>1L</span>,</span>
<span>  continuous <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  f <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  f_base <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  random_base <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  args_f_base <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  c <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  cores <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  warning <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  <span class='va'>...</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>where:</p>
<ol type="1">
<li><code>n</code>: is the number of observations to be generated (default <code>n = 1L</code>);</li>
<li><code>continuous</code>: is a logical value that indicates whether the probability density function <span class="math inline">\(f_X\)</span> is continuous (default <code>continuous = TRUE</code>) or discrete, if <code>continuous = FALSE</code>;</li>
<li><code>f</code>: is the probability density function <span class="math inline">\(f_X\)</span> of the random variable <span class="math inline">\(X\)</span> of interest;</li>
<li><code>args_f</code>: is a list of arguments that will be passed to the probability density function <span class="math inline">\(f_X\)</span> and that specify the parameters of the density of <span class="math inline">\(X\)</span>. No matter how many parameters there are in <code>f</code>, they should be passed as a list to <code>args_f</code>;</li>
<li><code>f_base</code>: is the probability density function that will supposedly be used as the base density <span class="math inline">\(g_Y\)</span>. It is important to note that this argument is only useful in this package when <code>continuous = TRUE</code>, as for the discrete case the package already has quite satisfactory computational performance. Additionally, visualizing a probability mass function that bounds <code>f_X</code> is more complicated than for the continuous case. In the discrete case, when <code>continuous = FALSE</code>, <code>f_base = NULL</code> will be considered the discrete uniform distribution;</li>
<li><code>random_base</code>: is a function that generates observations from the base distribution <span class="math inline">\(Y\)</span> (default <code>random_base = NULL</code>). If <code>random_base = NULL</code>, the base distribution <span class="math inline">\(Y\)</span> will be considered uniform over the interval specified in the <code>xlim</code> argument;</li>
<li><code>args_f_base</code>: is a list of arguments that will be passed to the base probability density function <span class="math inline">\(g_Y\)</span> and that specify the parameters of the density of <span class="math inline">\(Y\)</span>. No matter how many parameters there are in <code>f_base</code>, they should be passed as a list to <code>args_f_base</code>;</li>
<li><code>xlim</code>: is a vector of size two that specifies the support of the functions <span class="math inline">\(f_Y\)</span> and <span class="math inline">\(g_Y\)</span>. It is important to remember that the support of <span class="math inline">\(f_Y\)</span> and <span class="math inline">\(g_Y\)</span> must be equivalent and will be informed by a single vector of size two passed as an argument to <code>xlim</code>;</li>
<li><code>c</code>: is the constant <span class="math inline">\(c\)</span> that will be used to multiply the base probability density function <span class="math inline">\(g_Y\)</span>, so it envelops (bounds) <span class="math inline">\(f_X\)</span>. The default is <code>c = 1</code>. Unless there is a very strong reason, considering <code>c = NULL</code> as the default will be a good choice because the <code>accept_reject()</code> function will attempt to find an optimal value for the constant <span class="math inline">\(c\)</span>;</li>
<li><code>parallel</code>: is a logical value that indicates whether the generation of observations will be done in parallel (default <code>parallel = FALSE</code>). If <code>parallel = TRUE</code>, the generation of observations will be done in parallel on Unix-based systems, using the total number of cores available on the system. If <code>parallel = TRUE</code> and the operating system is Windows, the code will run serially, and no error will be returned even if <code>parallel = TRUE</code>;</li>
<li><code>cores</code>: is the number of cores that will be used for parallel observation generation. If <code>parallel = TRUE</code> and <code>cores = NULL</code>, the number of cores used will be the total number of cores available on the system. If the user wishes to use a smaller number of cores, they can define it in the <code>cores</code> argument;</li>
<li><code>warning</code>: is a logical value that indicates whether warning messages will be printed during the execution of the function (default <code>warning = TRUE</code>). If the user specifies a very small domain in <code>xlim</code>, the <code>accept_reject()</code> function will issue a warning informing that the specified domain is too small and that the generation of observations may be compromised;</li>
<li><code>...</code>: additional arguments that the user might want to pass to the <code>optimize</code> function used to optimize the value of <code>c</code>.</li>
</ol>
<p>In a simpler use case, where the user does not wish to specify the base density function <span class="math inline">\(g_Y\)</span> passed as an argument to <code>f_base</code>, useful for generating observations of a sequence of continuous random variables (<span class="math inline">\(x_1, \cdots, x_n\)</span>), the use of the <code>accept_reject()</code> function is quite straightforward. For example, to generate 100 observations of a random variable <span class="math inline">\(X\)</span> with a probability density function <span class="math inline">\(f_X(x) = 2x\)</span>, <span class="math inline">\(0 \leq x \leq 1\)</span>, the user could do:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Generate 100 observations from a random variable X with</span></span>
<span><span class='co'># f_X(x) = 2x, 0 &lt;= x &lt;= 1.</span></span>
<span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>  n <span class='op'>=</span> <span class='fl'>100L</span>,</span>
<span>  f <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>x</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>  warning <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>1L</span><span class='op'>:</span><span class='fl'>8L</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.8966972 0.3721239 0.5728534 0.8983897 0.9446753 0.6607978
[7] 0.6870228 0.7698414</code></pre>
</div>
<p>Note that in this case, if <code>warning = TRUE</code> (default), the <code>accept_reject()</code> function cannot know that <code>xlim = c(0, 1)</code> specifies the entire support of the probability density function <span class="math inline">\(f_X(x) = 2x\)</span>, <span class="math inline">\(0 \leq x \leq 1\)</span>, and that is why it issues a warning. Typically, one chooses a support that is passed to the <code>xlim</code> argument in which below the lower limit (first element of <code>xlim</code>) and above the upper limit (second element of the vector <code>xlim</code>), the probability mass (in the discrete case) or density (in the continuous case) is close to zero or not defined. In this case, we have deliberately set <code>warning = FALSE</code>.</p>
<h3 data-number="5.3" id="printing-the-object-with-generated-observations"><span class="header-section-number">5.3</span> Printing the Object with Generated Observations</h3>
<p>The <code>accept_reject()</code> function returns an object of class <code>accept_reject</code>. An object of the <code>accept_reject</code> class is essentially an atomic vector with observations generated by ARM, carrying attributes and marked with a specific class from the <a href="#">AcceptReject</a> package, i.e., marked with the <code>accept_reject</code> class. These attributes are useful for the package and carry information used by the <code>plot.accept_reject()</code> function.</p>
<p>Using the S3 object-oriented system in R, the <code>print()</code> function will dispatch for objects of the <code>accept_reject()</code> class, invoking the <code>print.accept_reject()</code> method from the <a href="#">AcceptReject</a> package. For an object of the <code>accept_reject</code> class returned by the <code>accept_reject()</code> function, it is possible to pass methods that operate on atomic vectors, such as <code>summary()</code>, <code>mean()</code>, <code>var()</code>, among others. The <code>print()</code> function will print useful information about the <code>accept_reject()</code> class object, such as the number of observations generated, the value of <code>c</code> used, the acceptance probability, the first generated observations, and the considered <code>xlim</code> interval. The <code>summary()</code> function will work by returning some descriptive statistics about the generated observations, such as the mean, median, variance, standard deviation, minimum, maximum, first quartile, and third quartile.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># setting a seed for reproducibility</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>   n <span class='op'>=</span> <span class='fl'>2000L</span>,</span>
<span>   f <span class='op'>=</span> <span class='va'>dbinom</span>,</span>
<span>   continuous <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>   args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span>, prob <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>   xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Printing the first 10 (default) observations</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></span></code></pre>
</div>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Printing the first 20 observations</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, n_min <span class='op'>=</span> <span class='fl'>20L</span><span class='op'>)</span></span></code></pre>
</div>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Summary</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>       V1       
 Min.   :0.000  
 1st Qu.:2.000  
 Median :3.000  
 Mean   :2.538  
 3rd Qu.:3.000  
 Max.   :5.000  </code></pre>
</div>
<h3 data-number="5.4" id="plotting-data-generated-by-arm"><span class="header-section-number">5.4</span> Plotting Data Generated by ARM</h3>
<p>Often, when generating observations using ARM, we are interested in visualizing the generated observations and graphically comparing them with the probability mass function (discrete case) or probability density function (continuous case) to get an idea of the quality of the data generation. Constructing a graph with your favorite library for each generation can be time-consuming. The idea of the <code>plot.accept_reject()</code> method is to facilitate this task, allowing you to easily and quickly generate this type of graph. In fact, since the S3 object-oriented system is used, you only need to use the <code>plot()</code> function on an <code>accept_reject</code> class object.</p>
<p>The <code>plot()</code> function applied to an <code>accept_reject</code> class object will return an object with the secondary class <code>gg</code> and the primary class <code>ggplot</code> (returns a graph). The returned object is a graph constructed with the <a href="#">ggplot2</a> library and can be modified to your preferred <a href="#">ggplot2</a> standards, such as its theme. However, the <code>plot</code> function has some specific arguments that allow you to modify some elements. The general usage form is:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>## S3 method for class 'accept_reject'</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span></span>
<span>  <span class='va'>x</span>,</span>
<span>  color_observed_density <span class='op'>=</span> <span class='st'>"#BB9FC9"</span>,</span>
<span>  color_true_density <span class='op'>=</span> <span class='st'>"#FE4F0E"</span>,</span>
<span>  color_bar <span class='op'>=</span> <span class='st'>"#BB9FC9"</span>,</span>
<span>  color_observable_point <span class='op'>=</span> <span class='st'>"#7BBDB3"</span>,</span>
<span>  color_real_point <span class='op'>=</span> <span class='st'>"#FE4F0E"</span>,</span>
<span>  alpha <span class='op'>=</span> <span class='fl'>0.3</span>,</span>
<span>  hist <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  <span class='va'>...</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<ol type="1">
<li><code>x</code>: An object of the <code>accept_reject</code> class;</li>
<li><code>color_observed_density</code>: observed density color (continuous case);</li>
<li><code>color_true_density</code>: theoretical density color (continuous case);</li>
<li><code>color_bar</code>: bar chart fill color (discrete case);</li>
<li><code>color_observable_point</code>: color of generated points (discrete case);</li>
<li><code>color_real_point</code>: color of the real points (discrete case);</li>
<li><code>alpha</code>: transparency of the bars (discrete case);</li>
<li><code>hist</code>: if <code>TRUE</code>, a histogram will be plotted in the continuous case, comparing the theoretical density with the observed one. If <code>FALSE</code>, <code>ggplot2::geom_density()</code> will be used instead of the histogram;</li>
<li><code>...</code>: additional arguments.</li>
</ol>
<p>The following code demonstrates the use of the <code>plot()</code> function. In Figure <a href="#fig:fig-plotfunc-1">3</a> (a), an example of a graph is presented with the histogram replaced by the observed density, if this type of representation is more useful to the user. To do this, simply pass the argument <code>hist = FALSE</code>. To illustrate the use of the arguments, the parameters <code>color_true_density</code>, <code>color_observed_density</code>, and <code>alpha</code> were also changed. In Figure <a href="#fig:fig-plotfunc-1">3</a> (b), an example of generating a graph for the discrete case is presented. The simple use of the <code>plot()</code> function without passing arguments should be sufficient to meet the needs of most users.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://prdm0.github.io/AcceptReject/'>AcceptReject</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Generating and plotting the theoretical density with the</span></span>
<span><span class='co'># observed density.</span></span>
<span></span>
<span><span class='co'># setting a seed for reproducibility</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Continuous case</span></span>
<span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>  n <span class='op'>=</span> <span class='fl'>2000L</span>,</span>
<span>  continuous <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  f <span class='op'>=</span> <span class='va'>dweibull</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>2.1</span>, scale <span class='op'>=</span> <span class='fl'>2.2</span><span class='op'>)</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span></span>
<span>    hist <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color_true_density <span class='op'>=</span> <span class='st'>"#2B8b99"</span>,</span>
<span>    color_observed_density <span class='op'>=</span> <span class='st'>"#F4DDB3"</span>,</span>
<span>    alpha <span class='op'>=</span> <span class='fl'>0.6</span></span>
<span>  <span class='op'>)</span> <span class='co'># Changing some arguments in plot()</span></span>
<span></span>
<span><span class='co'># Discrete case</span></span>
<span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>  n <span class='op'>=</span> <span class='fl'>1000L</span>,</span>
<span>  f <span class='op'>=</span> <span class='va'>dbinom</span>,</span>
<span>  continuous <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span>, prob <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-plotfunc-1"></span>
<img src="RJ-2025-037_files/figure-html5/fig-plotfunc-1-1.png" alt="Plotting the theoretical density function (a) and the probability mass function (b), with details of the respective parameters in the code." width="50%" /><img src="RJ-2025-037_files/figure-html5/fig-plotfunc-1-2.png" alt="Plotting the theoretical density function (a) and the probability mass function (b), with details of the respective parameters in the code." width="50%" />
<p class="caption">
Figure 3: Plotting the theoretical density function (a) and the probability mass function (b), with details of the respective parameters in the code.
</p>
</div>
</div>
<h2 data-number="6" id="examples"><span class="header-section-number">6</span> Examples</h2>
<p>Below are some examples of using the <code>accept_reject()</code> function to generate pseudo-random observations of discrete and continuous random variables. It should be noted that in the case of <span class="math inline">\(X\)</span> being a discrete random variable, it is necessary to provide the argument <code>continuous = FALSE</code>, whereas in the case of <span class="math inline">\(X\)</span> being continuous (the default), you must consider <code>continuous = TRUE</code>.</p>
<h3 data-number="6.1" id="generating-discrete-observations"><span class="header-section-number">6.1</span> Generating discrete observations</h3>
<p>As an example, let <span class="math inline">\(X \sim Poisson(\lambda = 0.7)\)</span>. We will generate <span class="math inline">\(n = 1000\)</span> observations of <span class="math inline">\(X\)</span> using the acceptance-rejection method, using the <code>accept_reject()</code> function. Note that it is necessary to provide the <code>xlim</code> argument. Try to set an upper limit value for which the probability of <span class="math inline">\(X\)</span> assuming that value is zero or very close to zero. In this case, we choose <code>xlim = c(0, 20)</code>, where <code>dpois(x = 20, lambda = 0.7)</code> is very close to zero (1.6286586^{-22}). Note Figure <a href="#fig:fig-poisson-1">4</a> (a) and Figure <a href="#fig:fig-poisson-1">4</a> (b), respectively, and note that in Figure <a href="#fig:fig-poisson-1">4</a> (b), there is a proximity of the observed probabilities to the theoretical probabilities, indicating that ARM is generating observations that approximate the true probability mass function as the sample size increases.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://prdm0.github.io/AcceptReject/'>AcceptReject</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>parallel</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span> <span class='co'># install.packages("cowplot")</span></span>
<span></span>
<span><span class='co'># Ensuring reproducibility in parallel computing</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>RNGkind</a></span><span class='op'>(</span><span class='st'>"L'Ecuyer-CMRG"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/parallel/RngStream.html'>mc.reset.stream</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Simulation</span></span>
<span><span class='va'>simulation</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>lambda</span> <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>    n <span class='op'>=</span> <span class='va'>n</span>,</span>
<span>    f <span class='op'>=</span> <span class='va'>dpois</span>,</span>
<span>    continuous <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># discrete case</span></span>
<span>    args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambda <span class='op'>=</span> <span class='va'>lambda</span><span class='op'>)</span>,</span>
<span>    xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span>    parallel <span class='op'>=</span> <span class='cn'>TRUE</span> <span class='co'># Parallelizing the code in Unix-based systems</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Generating observations</span></span>
<span><span class='co'># n = 25 observations</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='op'>{</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>simulation</span><span class='op'>(</span><span class='fl'>25L</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   user  system elapsed 
  0.003   0.042   0.043 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># n = 2500 observations</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='op'>{</span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'>simulation</span><span class='op'>(</span><span class='fl'>2500L</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   user  system elapsed 
  0.002   0.035   0.037 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-poisson-1"></span>
<img src="RJ-2025-037_files/figure-html5/fig-poisson-1-1.png" alt="Generating observations from a Poisson distribution using the acceptance-rejection method, with $n = 25$ (a) and $n = 2500$ (b), respectively." width="50%" /><img src="RJ-2025-037_files/figure-html5/fig-poisson-1-2.png" alt="Generating observations from a Poisson distribution using the acceptance-rejection method, with $n = 25$ (a) and $n = 2500$ (b), respectively." width="50%" />
<p class="caption">
Figure 4: Generating observations from a Poisson distribution using the acceptance-rejection method, with <span class="math inline">\(n = 25\)</span> (a) and <span class="math inline">\(n = 2500\)</span> (b), respectively.
</p>
</div>
</div>
<p>Note that it is necessary to specify the nature of the random variable from which observations are desired to be generated. In the case of discrete variables, the argument <code>continuous = FALSE</code> must be passed. In Section 6, examples of how to generate continuous observations will be presented.</p>
<h3 data-number="6.2" id="generating-continuous-observations"><span class="header-section-number">6.2</span> Generating continuous observations</h3>
<p>Considering the default base function, which is the uniform distribution, where it is not necessary to specify it, the code below exemplifies the continuous case, where <span class="math inline">\(X \sim \mathcal{N}(\mu = 0, \sigma^2 = 1)\)</span>. Not specifying a base probability density function implies <code>f_base = NULL</code>, <code>random_base = NULL</code>, and <code>args_base = NULL</code>, which are the defaults for the <code>accept_reject()</code> function. If at least one of them is specified as <code>NULL</code> and, by mistake, another is specified, no error will occur. In this situation, the <code>accept_reject()</code> function will assume the base probability density function is the density function of a uniform distribution over <code>xlim</code>. Note also the use of the <code>plot()</code> function, which generates a graph with the theoretical density function and the histogram of the generated observations, allowing a quick visual check of the quality of the observations generated by ARM.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://prdm0.github.io/AcceptReject/'>AcceptReject</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>parallel</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Ensuring reproducibility in parallel computing</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>RNGkind</a></span><span class='op'>(</span><span class='st'>"L'Ecuyer-CMRG"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/parallel/RngStream.html'>mc.reset.stream</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Generating observations</span></span>
<span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>  n <span class='op'>=</span> <span class='fl'>50L</span>,</span>
<span>  f <span class='op'>=</span> <span class='va'>dnorm</span>,</span>
<span>  continuous <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>  parallel <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/accept_reject.html'>accept_reject</a></span><span class='op'>(</span></span>
<span>  n <span class='op'>=</span> <span class='fl'>500L</span>,</span>
<span>  f <span class='op'>=</span> <span class='va'>dnorm</span>,</span>
<span>  continuous <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>  parallel <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-normal"></span>
<img src="RJ-2025-037_files/figure-html5/fig-normal-1.png" alt="Generating observations from a continuous random variable with a Standard Normal distribution, with $n = 50$ and $n = 500$ observations, respectively." width="50%" /><img src="RJ-2025-037_files/figure-html5/fig-normal-2.png" alt="Generating observations from a continuous random variable with a Standard Normal distribution, with $n = 50$ and $n = 500$ observations, respectively." width="50%" />
<p class="caption">
Figure 5: Generating observations from a continuous random variable with a Standard Normal distribution, with <span class="math inline">\(n = 50\)</span> and <span class="math inline">\(n = 500\)</span> observations, respectively.
</p>
</div>
</div>
<h2 data-number="7" id="a-practical-scenario-for-the-use-of-the-package"><span class="header-section-number">7</span> A practical scenario for the use of the package</h2>
<p>So far, the use of the package to generate distributions that are relatively simple and involve few parameters has been demonstrated. In this section, the idea is to demonstrate the use of the <a href="#">AcceptReject</a> package in a practical situation where the use of ARM becomes necessary. Let’s consider the generator of Modified Beta Distributions, proposed by <span class="citation" data-cites="nadarajah2014modified">(<a href="#ref-nadarajah2014modified" role="doc-biblioref">Nadarajah et al. 2014</a>)</span>. It is a family of probability distributions since it is possible to generate various probability density functions through the proposed density generator, whose general density function is defined by:</p>
<p><span class="math display">\[f_X(x) = \frac{\beta^a}{B(a,b)} \times \frac{g(x)G(x)^{a - 1}(1 - G(x))^{b - 1}}{[1 - (1 - \beta)G(x)]^{a + b}},\]</span> with <span class="math inline">\(x \geq 0\)</span> and <span class="math inline">\(\beta, a, b &gt; 0\)</span>, where <span class="math inline">\(g(x)\)</span> is a probability density function, <span class="math inline">\(G(x)\)</span> is the cumulative distribution function of <span class="math inline">\(g(x)\)</span>, and <span class="math inline">\(B(a,b)\)</span> is the beta function.</p>
<p>Notice that <span class="math inline">\(f_{X}(x)\)</span> has a certain complexity since it depends on another probability density function <span class="math inline">\(g(x)\)</span> and its cumulative distribution function <span class="math inline">\(G(x)\)</span>. Thus, <span class="math inline">\(f_X(x)\)</span> has three parameters, <span class="math inline">\(c, a, b\)</span>, plus additional parameters inherited from <span class="math inline">\(g(x)\)</span>. Here, we will consider <span class="math inline">\(g(x)\)</span> as the Weibull probability density function. Therefore, <span class="math inline">\(f_X(x)\)</span> is the modified Weibull beta density function with five parameters. The implementation of the Modified Beta Distributions generator is presented below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#|</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://optimizer.r-forge.r-project.org/'>numDeriv</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>pdf</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>G</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='fu'>numDeriv</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/numDeriv/man/grad.html'>grad</a></span><span class='op'>(</span></span>
<span>    func <span class='op'>=</span> \<span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'>G</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='va'>x</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># Modified Beta Distributions</span></span>
<span><span class='co'># Link: https://link.springer.com/article/10.1007/s13571-013-0077-0</span></span>
<span><span class='va'>generator</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>G</span>, <span class='va'>a</span>, <span class='va'>b</span>, <span class='va'>beta</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, G <span class='op'>=</span> <span class='va'>G</span>, <span class='va'>...</span><span class='op'>)</span></span>
<span>  <span class='va'>numerator</span> <span class='op'>&lt;-</span> <span class='va'>beta</span><span class='op'>^</span><span class='va'>a</span> <span class='op'>*</span> <span class='va'>g</span> <span class='op'>*</span> <span class='fu'>G</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>a</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='fu'>G</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>b</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span>  <span class='va'>denominator</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Special.html'>beta</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>b</span><span class='op'>)</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>beta</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'>G</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span><span class='op'>)</span></span>
<span>  <span class='va'>numerator</span><span class='op'>/</span><span class='va'>denominator</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># Probability density function - Modified Beta Weibull</span></span>
<span><span class='va'>pdf_mbw</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>a</span>, <span class='va'>b</span>, <span class='va'>beta</span>, <span class='va'>shape</span>, <span class='va'>scale</span><span class='op'>)</span></span>
<span>  <span class='fu'>generator</span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>    G <span class='op'>=</span> <span class='va'>pweibull</span>,</span>
<span>    a <span class='op'>=</span> <span class='va'>a</span>,</span>
<span>    b <span class='op'>=</span> <span class='va'>b</span>,</span>
<span>    beta <span class='op'>=</span> <span class='va'>beta</span>,</span>
<span>    shape <span class='op'>=</span> <span class='va'>shape</span>,</span>
<span>    scale <span class='op'>=</span> <span class='va'>scale</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Checking the value of the integral</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/stats/integrate.html'>integrate</a></span><span class='op'>(</span></span>
<span>  f <span class='op'>=</span> \<span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'>pdf_mbw</span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>  lower <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>  upper <span class='op'>=</span> <span class='cn'>Inf</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>1 with absolute error &lt; 5.7e-05</code></pre>
</div>
<p>Notice that the value <code>pdf_mbw()</code> integrates to 1, being a probability density function. Thus, the <code>generator()</code> function generates probability density functions based on another distribution <span class="math inline">\(G_X(x)\)</span>. In the case of the code above, the cumulative distribution function of the Weibull distribution is passed to the <code>generator()</code> function, but it could be any other.</p>
<p>In the following code, we will adopt the strategy of investigating (inspecting) a coherent proposal for a base density function to be passed as an argument to <code>f_base</code> in the <code>accept_reject()</code> function. The investigation could be skipped, in which case the <code>accept_reject()</code> function would assume the uniform distribution as the base.</p>
<p>We will consider the Weibull distribution since it is a particular case of the Modified Beta Weibull distribution. As we know how to generate observations from the Weibull distribution using the <code>rweibull()</code> function, the Weibull distribution is a viable candidate for the base density <span class="math inline">\(g_Y(y)\)</span>. Consider the true parameters <code>a = 10.5</code>, <code>b = 4.2</code>, <code>beta = 5.9</code>, <code>shape = 1.5</code>, and <code>scale = 1.7</code>. Thus, using the <code>inspect()</code> function, we can quickly inspect by doing:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://prdm0.github.io/AcceptReject/'>AcceptReject</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># True parameters</span></span>
<span><span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fl'>10.5</span></span>
<span><span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fl'>4.2</span></span>
<span><span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='fl'>5.9</span></span>
<span><span class='va'>shape</span> <span class='op'>&lt;-</span> <span class='fl'>1.5</span></span>
<span><span class='va'>scale</span> <span class='op'>&lt;-</span> <span class='fl'>1.7</span></span>
<span></span>
<span><span class='co'># c = 1 (default)</span></span>
<span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/inspect.html'>inspect</a></span><span class='op'>(</span></span>
<span>  f <span class='op'>=</span> <span class='va'>pdf_mbw</span>,</span>
<span>  f_base <span class='op'>=</span> <span class='va'>dweibull</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    a <span class='op'>=</span> <span class='va'>a</span>,</span>
<span>    b <span class='op'>=</span> <span class='va'>b</span>,</span>
<span>    beta <span class='op'>=</span> <span class='va'>beta</span>,</span>
<span>    shape <span class='op'>=</span> <span class='va'>shape</span>,</span>
<span>    scale <span class='op'>=</span> <span class='va'>scale</span></span>
<span>  <span class='op'>)</span>,</span>
<span>  args_f_base <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>2</span>, scale <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span>,</span>
<span>  c <span class='op'>=</span> <span class='fl'>1</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># c = 2.2</span></span>
<span><span class='fu'><a href='https://prdm0.github.io/AcceptReject/reference/inspect.html'>inspect</a></span><span class='op'>(</span></span>
<span>  f <span class='op'>=</span> <span class='va'>pdf_mbw</span>,</span>
<span>  f_base <span class='op'>=</span> <span class='va'>dweibull</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>  args_f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    a <span class='op'>=</span> <span class='va'>a</span>,</span>
<span>    b <span class='op'>=</span> <span class='va'>b</span>,</span>
<span>    beta <span class='op'>=</span> <span class='va'>beta</span>,</span>
<span>    shape <span class='op'>=</span> <span class='va'>shape</span>,</span>
<span>    scale <span class='op'>=</span> <span class='va'>scale</span></span>
<span>  <span class='op'>)</span>,</span>
<span>  args_f_base <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>2</span>, scale <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span>,</span>
<span>  c <span class='op'>=</span> <span class='fl'>2.2</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-nadarajah"></span>
<img src="RJ-2025-037_files/figure-html5/fig-nadarajah-1.png" alt="Inspecting the Weibull distribution with shape = 2, scale = 1.2, with the support xlim = c(0, 4) and c = 1 (default) (a) and c = 2.2 (b), respectively." width="50%" /><img src="RJ-2025-037_files/figure-html5/fig-nadarajah-2.png" alt="Inspecting the Weibull distribution with shape = 2, scale = 1.2, with the support xlim = c(0, 4) and c = 1 (default) (a) and c = 2.2 (b), respectively." width="50%" />
<p class="caption">
Figure 6: Inspecting the Weibull distribution with shape = 2, scale = 1.2, with the support xlim = c(0, 4) and c = 1 (default) (a) and c = 2.2 (b), respectively.
</p>
</div>
</div>
<p>Notice that in Figure <a href="#fig:fig-nadarajah">6</a> (b), when <span class="math inline">\(c = 2.2\)</span>, the density <span class="math inline">\(g_Y\)</span> bounds the density <span class="math inline">\(f_X\)</span>, which is the Modified Beta Weibull density of <span class="math inline">\(X\)</span> from which we want to generate observations. Thus, the density <span class="math inline">\(g_Y\)</span> used as a base is a viable candidate to be passed to the <code>f_base</code> argument of the <code>accept_reject()</code> function in the <a href="#">AcceptReject</a> package. Also, note that the area between <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g_Y\)</span> is smaller than it would be if <span class="math inline">\(g_Y\)</span> were considered the uniform probability density function in the <code>xlim</code> support. In the following section, we will discuss the computational cost for different sample sizes, considering the base density <span class="math inline">\(g_Y\)</span> as the Weibull density or the default (uniform density).</p>
<h2 data-number="8" id="benchmarking"><span class="header-section-number">8</span> Benchmarking</h2>
<p>The benchmarks considered in this section were performed on a computer with Arch Linux operating system, Intel Core(TM) i7-1260P processor with 16 threads, maximum frequency of 4.70 GHz, with computational times in logarithmic scale, base ten. More specifications were presented in Section 3.</p>
<p>Considering the case of the Modified Beta Weibull probability density function (a probability density function with five parameters) implemented in the <code>pdf_mbw()</code> function presented in Section 7, several benchmarks were conducted to evaluate the computational cost of the <code>accept_reject()</code> function for various sample sizes, considering both the parallelized and non-parallelized scenarios. Additionally, the benchmarks took into account the specification of <span class="math inline">\(g_Y\)</span> considering the continuous uniform distribution in the <code>xlim</code> interval (default of the <code>accept_reject()</code> function) and the Weibull distribution with parameters <code>shape = 2</code> and <code>scale = 1.2</code>, which bounds the probability density function of a random variable with Modified Beta Weibull with true parameters as in Figure <a href="#fig:fig-nadarajah">6</a>. The sample sizes considered were <span class="math inline">\(n = 50\)</span>, <span class="math inline">\(250\)</span>, <span class="math inline">\(500\)</span>, <span class="math inline">\(1000\)</span>, <span class="math inline">\(5000\)</span>, <span class="math inline">\(10000\)</span>, <span class="math inline">\(15000\)</span>, <span class="math inline">\(25000\)</span>, <span class="math inline">\(50000\)</span>, <span class="math inline">\(100000\)</span>, <span class="math inline">\(150000\)</span>, <span class="math inline">\(250000\)</span>, <span class="math inline">\(500000\)</span>, and <span class="math inline">\(1000000\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-benchmarking"></span>
<img src="RJ-2025-037_files/figure-html5/fig-benchmarking-1.png" alt="Benchmarking for different sample sizes, considering the Weibull distribution and the uniform distribution as the base density, with Weibull distribution and Uniform distribution (default), respectively." width="50%" /><img src="RJ-2025-037_files/figure-html5/fig-benchmarking-2.png" alt="Benchmarking for different sample sizes, considering the Weibull distribution and the uniform distribution as the base density, with Weibull distribution and Uniform distribution (default), respectively." width="50%" />
<p class="caption">
Figure 7: Benchmarking for different sample sizes, considering the Weibull distribution and the uniform distribution as the base density, with Weibull distribution and Uniform distribution (default), respectively.
</p>
</div>
</div>
<p>Observing the Figures in <a href="#fig:fig-benchmarking">7</a>, it is possible to see that the serial code, which is the default for the <code>accept_reject()</code> function, already performs excellently even with large samples, both when considering the specification of a base function <span class="math inline">\(g_Y\)</span> or using the uniform distribution as the base. Only with very large samples does the parallelized code perform better, as the parallel code may impose an overhead in thread creation that might not be justified with very small samples. For sample sizes above 10,000, the parallelized code shows better performance. However, depending on the complexity of the probability distributions involved, there may be situations where parallelizing with moderate samples could be a good alternative. The package user should, in practice, conduct tests and decide whether to consider <code>parallel = TRUE</code> or <code>parallel = FALSE</code>.</p>
<p>It can be observed Figure <a href="#fig:fig-benchmarking">7</a> that the choice of the base distribution, for the simulated case, did not significantly influence the computational performance of the <code>accept_reject()</code> function. Often, depending on the complexity of <span class="math inline">\(f_X\)</span>, the user might not need to worry about choosing a <span class="math inline">\(g_Y\)</span> to pass to the <code>f_base</code> argument of the <code>accept_reject()</code> function. Additionally, it is not very common in Monte-Carlo simulation studies to consider sample sizes much larger than those considered here. Therefore, users of non-Unix-based systems will not experience significant issues regarding the computational cost of the <code>accept_reject()</code> function.</p>
<h2 data-number="9" id="related-works"><span class="header-section-number">9</span> Related works</h2>
<p>An implementation of ARM is provided by the <a href="https://cran.r-project.org/package=AR">AR</a> library <span class="citation" data-cites="AR">(<a href="#ref-AR" role="doc-biblioref">Parchami 2018</a>)</span>. This library exports the <code>AR.Sim()</code> function, which has an educational utility to demonstrate the functioning of ARM. Additionally, the design of the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package allows, in the continuous case, the use of base probability density functions that do not necessarily need to be implemented in the R language or in specific packages like in the case of the <a href="https://cran.r-project.org/package=AR">AR</a> library, which is a significant advantage. The specifications of the base densities in the <a href="https://cran.r-project.org/package=AR">AR</a> package are made considering only the densities implemented in the <a href="https://cran.r-project.org/package=DISTRIB">DISTRIB</a> package <span class="citation" data-cites="DISTRIB">(<a href="#ref-DISTRIB" role="doc-biblioref">Parchami 2016</a>)</span>.</p>
<p>Another library that implements ARM is <a href="https://cran.r-project.org/package=SimDesign">SimDesign</a> <span class="citation" data-cites="SimDesign">(<a href="#ref-SimDesign" role="doc-biblioref">Chalmers and Adkins 2020</a>)</span>, through the <code>rejectionSampling()</code> function. The <code>rejectionSampling()</code> function is more efficient than the <code>AR.Sim()</code> function from the <a href="https://cran.r-project.org/package=AR">AR</a> library, but its efficiency still does not surpass that of the <code>accept_reject()</code> function from the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package. The <code>rejectionSampling()</code> function from the <a href="https://cran.r-project.org/package=SimDesign">SimDesign</a> library also does not support parallelism, which is a disadvantage compared to the <code>accept_reject()</code> function from the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package. Furthermore, the design of the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package uses the S3 object-oriented system, with exports of simple functions that allow the inspection and analysis of the generated data.</p>
<p>The <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> library presents several advantages over the mentioned libraries, particularly in the way the package is designed, facilitating the use of functions. The library, for example, provides functions that allow the inspection of <span class="math inline">\(f_X\)</span> with <span class="math inline">\(g_Y\)</span> when <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are continuous random variables, making it easy to create highly informative graphs for the user, visually informing about the quality of the generated observations. It is a common interest for those using ARM to observe the generated data and check if they conform to the desired probability distribution.</p>
<p>Figure <a href="#fig:fig-bench">8</a> (a) presents a simulation study comparing the <code>accept_reject()</code> function from the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package with the <code>rejectionSampling()</code> function from the <a href="https://cran.r-project.org/package=SimDesign">SimDesign</a> package, considering small to moderate sample sizes. In this scenario, the <code>accept_reject()</code> function was executed serially, just like the <code>rejectionSampling()</code> function, which does not support parallelism. Equivalent performance was observed between the functions. In Figure <a href="#fig:fig-bench">8</a> (b), it is observed that the performance of the <code>accept_reject()</code> function on large samples, considering the parallel execution of the <code>accept_reject()</code> function, surpasses the performance of the <code>rejectionSampling()</code> function from the <a href="https://cran.r-project.org/package=SimDesign">SimDesign</a> package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-bench"></span>
<img src="RJ-2025-037_files/figure-html5/fig-bench-1.png" alt="Comparison between the AcceptReject and SimDesign package for different sample sizes, considering the generation of observations from a random variable with a Modified Beta Weibull distribution, serial processing with AcceptReject (a) and parallel processing with AcceptReject package (b), respectively." width="50%" /><img src="RJ-2025-037_files/figure-html5/fig-bench-2.png" alt="Comparison between the AcceptReject and SimDesign package for different sample sizes, considering the generation of observations from a random variable with a Modified Beta Weibull distribution, serial processing with AcceptReject (a) and parallel processing with AcceptReject package (b), respectively." width="50%" />
<p class="caption">
Figure 8: Comparison between the AcceptReject and SimDesign package for different sample sizes, considering the generation of observations from a random variable with a Modified Beta Weibull distribution, serial processing with AcceptReject (a) and parallel processing with AcceptReject package (b), respectively.
</p>
</div>
</div>
<h2 data-number="10" id="conclusion-and-future-developments"><span class="header-section-number">10</span> Conclusion and future developments</h2>
<p>The <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> package is an efficient tool for generating pseudo-random numbers in univariate distributions of discrete and continuous random variables using the acceptance-rejection method (ARM). The library is built with the aim of delivering ease of use and computational efficiency. The <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> library can generate pseudo-random numbers both serially and in parallel, with computational efficiency in both cases, in addition to allowing easy inspection and analysis of the generated data.</p>
<p>For future developments, the <a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a> library can be extended with functions that allow the visualization of ARM in an iterative application using Shiny for educational purposes. The most important development step for future versions will be to seek even more performance. Additionally, the project is also open to contributions from the community.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="10.1" id="supplementary-materials"><span class="header-section-number">10.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-037.zip">RJ-2025-037.zip</a></p>
<h3 class="appendix" data-number="10.2" id="cran-packages-used"><span class="header-section-number">10.2</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=AcceptReject">AcceptReject</a>, <a href="https://cran.r-project.org/package=Rcpp">Rcpp</a>, <a href="https://cran.r-project.org/package=RcppArmadillo">RcppArmadillo</a>, <a href="https://cran.r-project.org/package=assertthat">assertthat</a>, <a href="https://cran.r-project.org/package=cli">cli</a>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=glue">glue</a>, <a href="https://cran.r-project.org/package=numDeriv">numDeriv</a>, <a href="https://cran.r-project.org/package=purrr">purrr</a>, <a href="https://cran.r-project.org/package=rlang">rlang</a>, <a href="https://cran.r-project.org/package=scales">scales</a>, <a href="https://cran.r-project.org/package=scattermore">scattermore</a>, <a href="https://cran.r-project.org/package=knitr">knitr</a>, <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a>, <a href="https://cran.r-project.org/package=cowplot">cowplot</a>, <a href="https://cran.r-project.org/package=testthat">testthat</a>, <a href="https://cran.r-project.org/package=magrittr">magrittr</a>, <a href="https://cran.r-project.org/package=parallel">parallel</a>, <a href="https://cran.r-project.org/package=AR">AR</a>, <a href="https://cran.r-project.org/package=DISTRIB">DISTRIB</a>, <a href="https://cran.r-project.org/package=SimDesign">SimDesign</a></p>
<h3 class="appendix" data-number="10.3" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">10.3</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=ChemPhys">ChemPhys</a>, <a href="https://cran.r-project.org/view=HighPerformanceComputing">HighPerformanceComputing</a>, <a href="https://cran.r-project.org/view=NetworkAnalysis">NetworkAnalysis</a>, <a href="https://cran.r-project.org/view=NumericalMathematics">NumericalMathematics</a>, <a href="https://cran.r-project.org/view=Phylogenetics">Phylogenetics</a>, <a href="https://cran.r-project.org/view=ReproducibleResearch">ReproducibleResearch</a>, <a href="https://cran.r-project.org/view=Spatial">Spatial</a>, <a href="https://cran.r-project.org/view=TeachingStatistics">TeachingStatistics</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-rmarkdown" class="csl-entry" role="listitem">
J. Allaire, Y. Xie, C. Dervieux, J. McPherson, J. Luraschi, K. Ushey, A. Atkins, H. Wickham, J. Cheng, W. Chang, et al. <em><span class="nocase">rmarkdown</span>: Dynamic documents for <span>R</span>.</em> 2024. URL <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>. R package version 2.26.
</div>
<div id="ref-asmussen2007stochastic" class="csl-entry" role="listitem">
S. Asmussen and P. W. Glynn. <em><span class="nocase">Stochastic simulation</span>: Algorithms and analysis.</em> Springer, 2007.
</div>
<div id="ref-magrittr" class="csl-entry" role="listitem">
S. M. Bache and H. Wickham. <em><span class="nocase">magrittr</span>: A forward-pipe operator for <span>R</span>.</em> 2022. URL <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a>. R package version 2.0.3.
</div>
<div id="ref-SimDesign" class="csl-entry" role="listitem">
R. P. Chalmers and M. C. Adkins. <span class="nocase">Writing effective and reliable <span>Monte Carlo</span> simulations with the <span>SimDesign</span> package</span>. <em>The Quantitative Methods for Psychology</em>, 16(4): 248–280, 2020. DOI <a href="https://doi.org/10.20982/tqmp.16.4.p248">10.20982/tqmp.16.4.p248</a>.
</div>
<div id="ref-chambers2014object" class="csl-entry" role="listitem">
J. M. Chambers. <span class="nocase">Object-oriented programming, functional programming and <span>R</span></span>. 2014.
</div>
<div id="ref-r6" class="csl-entry" role="listitem">
W. Chang. <em><span>R6</span>: Encapsulated classes with reference semantics.</em> 2021. URL <a href="https://CRAN.R-project.org/package=R6">https://CRAN.R-project.org/package=R6</a>. R package version 2.5.1.
</div>
<div id="ref-cli" class="csl-entry" role="listitem">
G. Csárdi. <em><span class="nocase">cli</span>: Helpers for developing command line interfaces.</em> 2023. URL <a href="https://CRAN.R-project.org/package=cli">https://CRAN.R-project.org/package=cli</a>. R package version 3.6.2.
</div>
<div id="ref-eddelbuettel2024package" class="csl-entry" role="listitem">
D. Eddelbuettel, R. Francois, J. Allaire, K. Ushey, Q. Kou, N. Russell, D. Bates, J. Chambers and M. D. Eddelbuettel. <span>Package <span>“Rcpp”</span></span>. 2024.
</div>
<div id="ref-eddelbuettel2014rcpparmadillo" class="csl-entry" role="listitem">
D. Eddelbuettel and C. Sanderson. <span>RcppArmadillo</span>: Accelerating <span>R</span> with high-performance <span>C++</span> linear algebra. <em>Computational statistics &amp; data analysis</em>, 71: 1054–1063, 2014.
</div>
<div id="ref-gentle2003random" class="csl-entry" role="listitem">
J. E. Gentle. <em><span class="nocase">Random number generation and <span>Monte Carlo</span> methods</span>.</em> Springer, 2003.
</div>
<div id="ref-numDeriv" class="csl-entry" role="listitem">
P. Gilbert and R. Varadhan. <em><span class="nocase">numDeriv</span>: Accurate numerical derivatives.</em> 2019. URL <a href="https://CRAN.R-project.org/package=numDeriv">https://CRAN.R-project.org/package=numDeriv</a>. R package version 2016.8-1.1.
</div>
<div id="ref-rlang" class="csl-entry" role="listitem">
L. Henry and H. Wickham. <em><span class="nocase">rlang</span>: Functions for base types and core <span>R</span> and ’<span>Tidyverse</span>’ features.</em> 2024. URL <a href="https://CRAN.R-project.org/package=rlang">https://CRAN.R-project.org/package=rlang</a>. R package version 1.1.3.
</div>
<div id="ref-glue" class="csl-entry" role="listitem">
J. Hester and J. Bryan. <em><span class="nocase">glue</span>: Interpreted string literals.</em> 2024. URL <a href="https://CRAN.R-project.org/package=glue">https://CRAN.R-project.org/package=glue</a>. R package version 1.7.0.
</div>
<div id="ref-kemp2003discrete" class="csl-entry" role="listitem">
D. Kemp. <span class="nocase">Discrete-event simulation</span>: Modeling, programming, and analysis. 2003.
</div>
<div id="ref-kroese2013handbook" class="csl-entry" role="listitem">
D. P. Kroese, T. Taimre and Z. I. Botev. <em><span class="nocase">Handbook of monte carlo methods</span>.</em> John Wiley &amp; Sons, 2013.
</div>
<div id="ref-scattermore" class="csl-entry" role="listitem">
T. Kulichova and M. Kratochvil. <em><span class="nocase">scattermore</span>: Scatterplots with more points.</em> 2023. URL <a href="https://CRAN.R-project.org/package=scattermore">https://CRAN.R-project.org/package=scattermore</a>. R package version 1.2.
</div>
<div id="ref-l1999good" class="csl-entry" role="listitem">
P. L’ecuyer. <span class="nocase">Good parameters and implementations for combined multiple recursive random number generators</span>. <em>Operations Research</em>, 47(1): 159–164, 1999.
</div>
<div id="ref-l2002object" class="csl-entry" role="listitem">
P. L’ecuyer, R. Simard, E. J. Chen and W. D. Kelton. <span class="nocase">An object-oriented random-number package with many long streams and substreams</span>. <em>Operations research</em>, 50(6): 1073–1075, 2002.
</div>
<div id="ref-AcceptReject" class="csl-entry" role="listitem">
P. R. D. Marinho and V. L. D. Tomazella. <em><span>AcceptReject</span>: Acceptance-rejection method for generating pseudo-random observations.</em> 2024. URL <a href="https://prdm0.github.io/AcceptReject/">https://prdm0.github.io/AcceptReject/</a>. R package version 0.1.1.
</div>
<div id="ref-nadarajah2014modified" class="csl-entry" role="listitem">
S. Nadarajah, M. Teimouri and S. H. Shih. <span class="nocase">Modified beta distributions</span>. <em>Sankhya B</em>, 76: 19–48, 2014.
</div>
<div id="ref-AR" class="csl-entry" role="listitem">
A. Parchami. <em><span>AR</span>: Another look at the acceptance-rejection method.</em> 2018. URL <a href="https://CRAN.R-project.org/package=AR">https://CRAN.R-project.org/package=AR</a>. R package version 1.1.
</div>
<div id="ref-DISTRIB" class="csl-entry" role="listitem">
A. Parchami. <em><span>DISTRIB</span>: Four essential functions for statistical distributions analysis: A new functional approach.</em> 2016. URL <a href="https://CRAN.R-project.org/package=DISTRIB">https://CRAN.R-project.org/package=DISTRIB</a>. R package version 1.0.
</div>
<div id="ref-neumann1951various" class="csl-entry" role="listitem">
<span class="nocase">J. von Neumann</span>. <span class="nocase">Various techniques used in connection with random digits</span>. <em>Notes by GE Forsythe</em>, 36–38, 1951.
</div>
<div id="ref-assertthat" class="csl-entry" role="listitem">
H. Wickham. <em><span class="nocase">assertthat</span>: Easy pre and post assertions.</em> 2019. URL <a href="https://CRAN.R-project.org/package=assertthat">https://CRAN.R-project.org/package=assertthat</a>. R package version 0.2.1.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
H. Wickham. <em><span class="nocase">ggplot2</span>: Elegant graphics for data analysis.</em> Springer-Verlag New York, 2016. URL <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-testthat" class="csl-entry" role="listitem">
H. Wickham. <span class="nocase">testthat</span>: Get started with testing. <em>The R Journal</em>, 3: 5–10, 2011. URL <a href="https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf">https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf</a>.
</div>
<div id="ref-purrr" class="csl-entry" role="listitem">
H. Wickham and L. Henry. <em><span class="nocase">purrr</span>: Functional programming tools.</em> 2023. URL <a href="https://CRAN.R-project.org/package=purrr">https://CRAN.R-project.org/package=purrr</a>. R package version 1.0.2.
</div>
<div id="ref-scales" class="csl-entry" role="listitem">
H. Wickham, T. L. Pedersen and D. Seidel. <em><span class="nocase">scales</span>: Scale functions for visualization.</em> 2023. URL <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>. R package version 1.3.0.
</div>
<div id="ref-cowplot" class="csl-entry" role="listitem">
C. O. Wilke. <em><span class="nocase">cowplot</span>: Streamlined plot theme and plot annotations for ’<span class="nocase">ggplot2</span>’.</em> 2024. URL <a href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</a>. R package version 1.1.3.
</div>
<div id="ref-knitr" class="csl-entry" role="listitem">
Y. Xie. <em><span class="nocase">knitr</span>: A general-purpose package for dynamic report generation in <span>R</span>.</em> 2024. URL <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>. R package version 1.46.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Marinho &amp; Tomazella, "AcceptReject: An R Package for Acceptance-Rejection Method", The R Journal, 2026</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2025-037,
  author = {Marinho, Pedro Rafael Diniz and Tomazella, Vera L. D.},
  title = {AcceptReject: An R Package for Acceptance-Rejection Method},
  journal = {The R Journal},
  year = {2026},
  note = {https://doi.org/10.32614/RJ-2025-037},
  doi = {10.32614/RJ-2025-037},
  volume = {17},
  issue = {4},
  issn = {2073-4859},
  pages = {1}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
