<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Student t-Lévy regression model in yuima</title>

<meta property="description" itemprop="description" content="This paper presents an estimation and simulation method in the R package yuima  for a linear regression model driven by a Student-t Lévy process with constant scale and arbitrary degrees of freedom. This process finds applications in several fields, for example finance, physics, biology, etc. The first challenge involves simulating sample paths at high-frequency levels, as only unit-time increments are Student-t distributed. In yuima, we solve this problem by means of the inverse Fourier transform for simulating the increments of a Student-t Lévy defined on an interval with any length. The second challenge is the joint estimation of trend, scale, and degrees of freedom, a problem not previously explored in the literature. In yuima, we develop a two-step estimation procedure that efficiently deals with this issue. Numerical examples are given in order to explain methods and classes used in the yuima package."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2025-014/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-09-08"/>
<meta property="article:created" itemprop="dateCreated" content="2025-09-08"/>
<meta name="article:author" content="Hiroki Masuda"/>
<meta name="article:author" content="Lorenzo Mercuri"/>
<meta name="article:author" content="Yuma Uehara"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Student t-Lévy regression model in yuima"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This paper presents an estimation and simulation method in the R package yuima  for a linear regression model driven by a Student-t Lévy process with constant scale and arbitrary degrees of freedom. This process finds applications in several fields, for example finance, physics, biology, etc. The first challenge involves simulating sample paths at high-frequency levels, as only unit-time increments are Student-t distributed. In yuima, we solve this problem by means of the inverse Fourier transform for simulating the increments of a Student-t Lévy defined on an interval with any length. The second challenge is the joint estimation of trend, scale, and degrees of freedom, a problem not previously explored in the literature. In yuima, we develop a two-step estimation procedure that efficiently deals with this issue. Numerical examples are given in order to explain methods and classes used in the yuima package."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2025-014/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2025-014/figures/Tikz_standalone.png"/>
<meta property="og:image:width" content="2519"/>
<meta property="og:image:height" content="1560"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Student t-Lévy regression model in yuima"/>
<meta property="twitter:description" content="This paper presents an estimation and simulation method in the R package yuima  for a linear regression model driven by a Student-t Lévy process with constant scale and arbitrary degrees of freedom. This process finds applications in several fields, for example finance, physics, biology, etc. The first challenge involves simulating sample paths at high-frequency levels, as only unit-time increments are Student-t distributed. In yuima, we solve this problem by means of the inverse Fourier transform for simulating the increments of a Student-t Lévy defined on an interval with any length. The second challenge is the joint estimation of trend, scale, and degrees of freedom, a problem not previously explored in the literature. In yuima, we develop a two-step estimation procedure that efficiently deals with this issue. Numerical examples are given in order to explain methods and classes used in the yuima package."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2025-014/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2025-014/figures/Tikz_standalone.png"/>
<meta property="twitter:image:width" content="2519"/>
<meta property="twitter:image:height" content="1560"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Student t-Lévy regression model in yuima"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-014"/>
<meta name="citation_pdf_url" content="RJ-2025-014.pdf"/>
<meta name="citation_volume" content="17"/>
<meta name="citation_issue" content="2"/>
<meta name="citation_doi" content="10.32614/RJ-2025-014"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="56"/>
<meta name="citation_lastpage" content="83"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/09/08"/>
<meta name="citation_publication_date" content="2025/09/08"/>
<meta name="citation_author" content="Hiroki Masuda"/>
<meta name="citation_author_institution" content="The University of Tokyo"/>
<meta name="citation_author" content="Lorenzo Mercuri"/>
<meta name="citation_author_institution" content="University of Milan"/>
<meta name="citation_author" content="Yuma Uehara"/>
<meta name="citation_author_institution" content="Kansai University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=The YUIMA project: A computational framework for simulation and inference of stochastic differential equations;citation_volume=57;citation_doi=10.18637/jss.v057.i04;citation_author=Alexandre Brouste;citation_author=Masaaki Fukasawa;citation_author=Hideitsu Hino;citation_author=Stefano Iacus;citation_author=Kengo Kamatani;citation_author=Yuta Koike;citation_author=Hiroki Masuda;citation_author=Ryosuke Nomura;citation_author=Teppei Ogihara;citation_author=Yasutaka Shimuzu;citation_author=Masayuki Uchida;citation_author=Nakahiro Yoshida"/>
  <meta name="citation_reference" content="citation_title=yuima: The YUIMA project package for SDEs;citation_author=yuima: The YUIMA project package for SDEs"/>
  <meta name="citation_reference" content="citation_title=Statmod: Probability calculations for the inverse Gaussian distribution;citation_volume=8;citation_doi=10.32614/RJ-2016-024;citation_author=Goknur Giner;citation_author=Gordon K. Smyth"/>
  <meta name="citation_reference" content="citation_title=statmod: Statistical modeling;citation_author=Gordon Smyth;citation_author=Lizhong Chen;citation_author=Yifang Hu;citation_author=Peter Dunn;citation_author=Belinda Phipson;citation_author=Yunshun Chen"/>
  <meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;citation_publisher=R Foundation for Statistical Computing;citation_author=R: A language and environment for statistical computing"/>
  <meta name="citation_reference" content="citation_title=Pak: Another approach to package installation;citation_author=Gábor Csárdi;citation_author=Jim Hester"/>
  <meta name="citation_reference" content="citation_title=Modeling seasonality in agricultural commodity futures;citation_publisher=Wiley Online Library;citation_volume=22;citation_author=Carsten Sørensen"/>
  <meta name="citation_reference" content="citation_title=On age-period-cohort parametric mortality rate projections;citation_volume=45;citation_doi=https://doi.org/10.1016/j.insmatheco.2009.07.006;citation_issn=0167-6687;citation_author=Steven Haberman;citation_author=Arthur Renshaw"/>
  <meta name="citation_reference" content="citation_title=Simulation and inference for stochastic processes with YUIMA;citation_publisher=Springer;citation_author=Stefano M Iacus;citation_author=Nakahiro Yoshida"/>
  <meta name="citation_reference" content="citation_title=Trends and age-period-cohort effects on hypertension mortality rates from 1998 to 2018 in Mexico;citation_publisher=Nature Publishing Group UK London;citation_volume=11;citation_author=Lilia V Castro-Porras;citation_author=Rosalba Rojas-Martı́nez;citation_author=Carlos A Aguilar-Salinas;citation_author=Omar Yaxmehen Bello-Chavolla;citation_author=Carlos Becerril-Gutierrez;citation_author=Consuelo Escamilla-Nuñez"/>
  <meta name="citation_reference" content="citation_title=Noise inference for ergodic Lévy driven SDE;citation_publisher=Institute of Mathematical Statistics; Bernoulli Society;citation_volume=16;citation_doi=10.1214/22-EJS2006;citation_author=Hiroki Masuda;citation_author=Lorenzo Mercuri;citation_author=Yuma Uehara"/>
  <meta name="citation_reference" content="citation_title=Approximation of the variance gamma model with a finite mixture of normals;citation_publisher=Elsevier;citation_volume=82;citation_doi=https://doi.org/10.1016/j.spl.2011.10.004;citation_author=Angela Loregian;citation_author=Lorenzo Mercuri;citation_author=Edit Rroji"/>
  <meta name="citation_reference" content="citation_title=Finite mixture approximation of CARMA (p, q) models;citation_publisher=SIAM;citation_volume=12;citation_doi=https://doi.org/10.1137/20M1363248;citation_author=Lorenzo Mercuri;citation_author=Andrea Perchiazzo;citation_author=Edit Rroji"/>
  <meta name="citation_reference" content="citation_title=A novel pricing method for European options based on Fourier-cosine series expansions;citation_publisher=SIAM;citation_volume=31;citation_doi=https://doi.org/10.1137/080718061;citation_author=Fang Fang;citation_author=Cornelis W Oosterlee"/>
  <meta name="citation_reference" content="citation_title=A Fourier-based valuation method for Bermudan and barrier options under Heston’s model;citation_publisher=SIAM;citation_volume=2;citation_doi=https://doi.org/10.1137/100794158;citation_author=Fang Fang;citation_author=Cornelis W Oosterlee"/>
  <meta name="citation_reference" content="citation_title=An algorithm for computing the mixed radix fast Fourier transform;citation_publisher=IEEE;citation_volume=17;citation_author=RC Singleton"/>
  <meta name="citation_reference" content="citation_title=Quasi-Likelihood Analysis for Student-Lévy Regression;citation_publisher=Springer;citation_doi=https://doi.org/10.1007/s11203-024-09317-2;citation_author=Hiroki Masuda;citation_author=Lorenzo Mercuri;citation_author=Yuma Uehara"/>
  <meta name="citation_reference" content="citation_title=On simulation from the marginal distribution of a Student t and generalized hyperbolic lévy process;citation_author=Friedrich Hubalek"/>
  <meta name="citation_reference" content="citation_title=An algorithm for the machine calculation of complex Fourier series;citation_volume=19;citation_doi=https://doi.org/10.2307/2003354;citation_author=James W Cooley;citation_author=John W Tukey"/>
  <meta name="citation_reference" content="citation_title=Approximations of small jumps of lévy processes with a view towards simulation;citation_publisher=Cambridge University Press;citation_volume=38;citation_author=Søren Asmussen;citation_author=Jan Rosiński"/>
  <meta name="citation_reference" content="citation_title=Simulation of Student–lévy processes using series representations;citation_publisher=Springer;citation_volume=33;citation_doi=10.1007/s00180-018-0814-y;citation_author=Till Massing"/>
  <meta name="citation_reference" content="citation_title=On some results of Cufaro Petroni about Student t-processes;citation_publisher=IOP Publishing;citation_volume=41;citation_doi=10.1088/1751-8113/41/26/265004;citation_author=C Berg;citation_author=C Vignat"/>
  <meta name="citation_reference" content="citation_title=Mixtures in nonstable Lévy processes;citation_volume=40;citation_doi=10.1088/1751-8113/40/10/001;citation_issn=1751-8113;citation_author=N. Cufaro Petroni"/>
  <meta name="citation_reference" content="citation_title=On the computer generation of random variables with a given characteristic function;citation_volume=7;citation_doi=10.1016/0898-1221(81)90038-9;citation_issn=0097-4943;citation_author=Luc Devroye"/>
  <meta name="citation_reference" content="citation_title=Student processes;citation_volume=37;citation_doi=10.1239/aap/1118858629;citation_issn=0001-8678;citation_author=C. C. Heyde;citation_author=N. N. Leonenko"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","description","draft","author","type","output","bibliography","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Student t-Lévy regression model in yuima"]},{"type":"character","attributes":{},"value":["2025-09-08"]},{"type":"character","attributes":{},"value":["This paper presents an estimation and simulation method in the R package yuima  for a linear regression model driven by a Student-t Lévy process with constant scale and arbitrary degrees of freedom. This process finds applications in several fields, for example finance, physics, biology, etc. The first challenge involves simulating sample paths at high-frequency levels, as only unit-time increments are Student-t distributed. In yuima, we solve this problem by means of the inverse Fourier transform for simulating the increments of a Student-t Lévy defined on an interval with any length. The second challenge is the joint estimation of trend, scale, and degrees of freedom, a problem not previously explored in the literature. In yuima, we develop a two-step estimation procedure that efficiently deals with this issue. Numerical examples are given in order to explain methods and classes used in the yuima package."]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Hiroki Masuda"]},{"type":"character","attributes":{},"value":["The University of Tokyo"]},{"type":"character","attributes":{},"value":["Graduate School of Mathematical Sciences,","3-8-1 Komaba Meguro-ku Tokyo 153-8914, Japan"]},{"type":"character","attributes":{},"value":["https://www.ms.u-tokyo.ac.jp/teacher_e/masuda_e.html"]},{"type":"character","attributes":{},"value":["0000-0002-5553-9201"]},{"type":"character","attributes":{},"value":["hmasuda@ms.u-tokyo.ac.jp"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Lorenzo Mercuri"]},{"type":"character","attributes":{},"value":["University of Milan"]},{"type":"character","attributes":{},"value":["Department of Economics, Management and Quantitative Methods","Via Del Conservatorio Milano 7, Italy."]},{"type":"character","attributes":{},"value":["https://www.unimi.it/en/ugov/person/lorenzo-mercuri"]},{"type":"character","attributes":{},"value":["lorenzo.mercuri@unimi.it"]},{"type":"character","attributes":{},"value":["0000-0003-0490-2952"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Yuma Uehara"]},{"type":"character","attributes":{},"value":["Kansai University"]},{"type":"character","attributes":{},"value":["Department of Mathematics, Faculty of Engineering Science, 3-3-35 Yamate-cho Suita-shi Osaka 564-8680, Japan"]},{"type":"character","attributes":{},"value":["https://kugakujo.kansai-u.ac.jp/html/100000728_en.html"]},{"type":"character","attributes":{},"value":["y-uehara@kansai-u.ac.j"]},{"type":"character","attributes":{},"value":["0000-0002-7084-0457"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article","rjtools::rjournal_pdf_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","header-includes"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["\\usepackage[utf8]{inputenc}","\\usepackage[T1]{fontenc}","\\usepackage{RJournal}","\\usepackage{amsmath,amssymb,array}","\\usepackage{booktabs}","\\usepackage{longtable}","\\usepackage{bbm}","\\newtheorem{thm}{Theorem}[section]","\\newtheorem{rem}[thm]{Remark}","\\newcommand{\\mca}{\\mathcal{A}}","\\newcommand{\\mcb}{\\mathcal{B}}","\\newcommand{\\mcc}{\\mathcal{C}}","\\newcommand{\\mcd}{\\mathcal{D}}","\\newcommand{\\mce}{\\mathcal{E}}","\\newcommand{\\mcf}{\\mathcal{F}}","\\newcommand{\\mci}{\\mathcal{I}}","\\newcommand{\\mcl}{\\mathcal{L}}","\\newcommand{\\mcn}{\\mathcal{N}}","\\newcommand{\\mcs}{\\mathcal{S}}","\\newcommand{\\mfa}{\\mathfrak{a}}","\\newcommand{\\mfb}{\\mathfrak{b}}","\\newcommand{\\mfc}{\\mathfrak{c}}","\\newcommand{\\mfp}{\\mathfrak{p}}","\\newcommand{\\mfw}{\\mathfrak{w}}","\\newcommand{\\mbbd}{\\mathbb{D}}","\\newcommand{\\mbbg}{\\mathbb{G}}","\\newcommand{\\mbbh}{\\mathbb{H}}","\\newcommand{\\mbbn}{\\mathbb{N}}","\\newcommand{\\mbbq}{\\mathbb{Q}}","\\newcommand{\\mbbr}{\\mathbb{R}}","\\newcommand{\\mbbx}{\\mathbb{X}}","\\newcommand{\\mbby}{\\mathbb{Y}}","\\newcommand{\\mbbz}{\\mathbb{Z}}","\\newcommand{\\mbbrp}{\\mathbb{R}_{+}}","\\newcommand{\\mbbzp}{\\mathbb{Z}_{+}}","\\newcommand{\\al}{\\alpha} \\newcommand{\\lam}{\\lambda} \\newcommand{\\ep}{\\epsilon}","\\newcommand{\\vp}{\\varphi} \\newcommand{\\del}{\\delta} \\newcommand{\\sig}{\\sigma}","\\newcommand{\\D}{\\Delta} \\newcommand{\\Sig}{\\Sigma} \\newcommand{\\gam}{\\gamma}","\\newcommand{\\Lam}{\\Lambda} \\newcommand{\\Gam}{\\Gamma}","\\newcommand{\\p}{\\partial}","\\newcommand{\\ra}{\\rangle} \\newcommand{\\la}{\\langle}","\\newcommand{\\wc}{\\Rightarrow}","\\newcommand{\\cil}{\\xrightarrow{\\mcl}}","\\newcommand{\\scl}{\\xrightarrow{\\mcl_{s}}}","\\newcommand{\\cip}{\\xrightarrow{p}}","\\newcommand{\\asc}{\\xrightarrow{a.s.}}","\\newcommand{\\eil}{\\stackrel{d}{=}}","\\newcommand{\\ind}{\\perp\\!\\!\\!\\perp}","\\newcommand{\\argmin}{\\mathop{\\rm argmin}}","\\newcommand{\\argmax}{\\mathop{\\rm argmax}}","\\newcommand{\\md}{\\mathrm{d}}","\\def\\Vec#1{\\mbox{\\boldmath $#1$}}","\\def\\ds#1{\\displaystyle{#1}}","\\def\\nn{\\nonumber}","\\def\\tc{\\textcolor}","\\def\\tcr{#1}{\\textcolor{{red}}{{#1}}}","\\def\\tcb#1{\\textcolor{blue}{#1}}","\\def\\tcg#1{\\textcolor{green}{#1}}","\\def\\tcm#1{\\textcolor{magenta}{#1}}","\\def\\cby#1{\\colorbox{yellow}{#1}}","\\def\\cbg#1{\\colorbox{green}{#1}}","\\def\\cbsb#1{\\colorbox{-red}{#1}}","\\def\\hmnote#1{\\footnote{\\tcr{(HM)","\\def\\hmrev#1{\\textcolor{red}{#1}}","\\newcommand{\\pr}{P} \\newcommand{\\E}{E}","\\def\\var{{\\rm var}}","\\def\\cov{{\\rm cov}}","\\def\\diag{{\\rm diag}}","\\def\\supp{{\\rm supp}}","\\def\\id{infinitely divisible}","\\def\\idl{infinitely divisible distribution}","\\def{\\cadlag}{{c\\`adl\\`ag}}","\\newcommand{\\X}{\\bm{X}}","\\newcommand{\\sumj}{\\sum_{j=1}^{n}}","\\newcommand{\\sumjj}{\\sum_{j=1}^{N_n}}","\\newcommand{\\tz}{\\theta_{0}}","\\newcommand{\\tes}{\\hat{\\theta}_{n}}","\\newcommand{\\nes}{\\hat{\\nu}_{n}}","\\newcommand{\\ntes}{\\tilde{\\nu}_{n}}","\\newcommand{\\mes}{\\hat{\\mu}_{n}}","\\newcommand{\\ses}{\\hat{\\sig}_{n}}","\\newcommand{\\hep}{\\hat{\\epsilon}}","\\newcommand{\\sumi}{\\sum_{i=1}^{[T_n]}}","\\newcommand{\\yuima}{\\CRANpkg{yuima}}","\\DefineVerbatimEnvironment{Sinput}{Verbatim}{fontshape=n}","\\DefineVerbatimEnvironment{Soutput}{Verbatim}{}","\\DefineVerbatimEnvironment{Scode}{Verbatim}{fontshape=n}","\\DefineVerbatimEnvironment{Code}{Verbatim}{}","\\DefineVerbatimEnvironment{CodeInput}{Verbatim}{fontshape=n}","\\DefineVerbatimEnvironment{CodeOutput}{Verbatim}{}","\\newenvironment{CodeChunk}{}{}","\\setkeys{Gin}{width=0.8\\textwidth}","\\let\\proglang=\\textsf","\\let\\code=\\texttt","\\providecommand{\\tightlist}{\\setlength{\\itemsep}{0pt}\\setlength{\\parskip}{0pt}}"]}]}]},{"type":"character","attributes":{},"value":["article.bib"]},{"type":"character","attributes":{},"value":["2024-03-08"]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[2]},{"type":"character","attributes":{},"value":["RJ-2025-014"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[56]},{"type":"integer","attributes":{},"value":[83]}]},{"type":"character","attributes":{},"value":["RJ-2025-014.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-014"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-014"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["yuima","statmod","pak"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["Distributions","NumericalMathematics","TimeSeries"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-014/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["article.bib","article.tex","figures/CDF_Comparison_nu3_h001.pdf","figures/CDF_Comparison_nu3_h001.png","figures/CDF_Comparison_nu3_h1.pdf","figures/CDF_Comparison_nu3_h1.png","figures/RealDataset.pdf","figures/RealDataset.png","figures/Simulation_Mod1.pdf","figures/Simulation_Mod1.png","figures/Simulation_Mod2.pdf","figures/Simulation_Mod2.png","figures/Simulation_Mod3.pdf","figures/Simulation_Mod3.png","figures/Tikz_standalone.png","RJ-2025-014.log","RJ-2025-014.pdf","RJ-2025-014.tex","RJournal.sty","RJwrapper.log","RJwrapper.out","RJwrapper.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.29/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Student t-Lévy regression model in yuima","description":"This paper presents an estimation and simulation method in the R package yuima  for a linear regression model driven by a Student-t Lévy process with constant scale and arbitrary degrees of freedom. This process finds applications in several fields, for example finance, physics, biology, etc. The first challenge involves simulating sample paths at high-frequency levels, as only unit-time increments are Student-t distributed. In yuima, we solve this problem by means of the inverse Fourier transform for simulating the increments of a Student-t Lévy defined on an interval with any length. The second challenge is the joint estimation of trend, scale, and degrees of freedom, a problem not previously explored in the literature. In yuima, we develop a two-step estimation procedure that efficiently deals with this issue. Numerical examples are given in order to explain methods and classes used in the yuima package.","doi":"10.32614/RJ-2025-014","authors":[{"author":"Hiroki Masuda","authorURL":"https://www.ms.u-tokyo.ac.jp/teacher_e/masuda_e.html","affiliation":"The University of Tokyo","affiliationURL":"#","orcidID":"0000-0002-5553-9201"},{"author":"Lorenzo Mercuri","authorURL":"https://www.unimi.it/en/ugov/person/lorenzo-mercuri","affiliation":"University of Milan","affiliationURL":"#","orcidID":"0000-0003-0490-2952"},{"author":"Yuma Uehara","authorURL":"https://kugakujo.kansai-u.ac.jp/html/100000728_en.html","affiliation":"Kansai University","affiliationURL":"#","orcidID":"0000-0002-7084-0457"}],"publishedDate":"2025-09-08T00:00:00.000+00:00","citationText":"Masuda, et al., 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-2">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Student t-Lévy regression model in yuima</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>This paper presents an estimation and simulation method in the R package yuima for a linear regression model driven by a Student-t Lévy process with constant scale and arbitrary degrees of freedom. This process finds applications in several fields, for example finance, physics, biology, etc. The first challenge involves simulating sample paths at high-frequency levels, as only unit-time increments are Student-t distributed. In yuima, we solve this problem by means of the inverse Fourier transform for simulating the increments of a Student-t Lévy defined on an interval with any length. The second challenge is the joint estimation of trend, scale, and degrees of freedom, a problem not previously explored in the literature. In yuima, we develop a two-step estimation procedure that efficiently deals with this issue. Numerical examples are given in order to explain methods and classes used in the yuima package.</p>
</div>

<div class="d-byline">
  Hiroki Masuda <a href="https://www.ms.u-tokyo.ac.jp/teacher_e/masuda_e.html" class="uri">https://www.ms.u-tokyo.ac.jp/teacher_e/masuda_e.html</a> (The University of Tokyo)
  
,   Lorenzo Mercuri <a href="https://www.unimi.it/en/ugov/person/lorenzo-mercuri" class="uri">https://www.unimi.it/en/ugov/person/lorenzo-mercuri</a> (University of Milan)
  
,   Yuma Uehara <a href="https://kugakujo.kansai-u.ac.jp/html/100000728_en.html" class="uri">https://kugakujo.kansai-u.ac.jp/html/100000728_en.html</a> (Kansai University)
  
<br/>2025-09-08
</div>

<div class="d-article">
<h2 data-number="1" id="Intro"><span class="header-section-number">1</span> Introduction</h2>
<p>The <a href="https://cran.r-project.org/package=yuima">yuima</a> package in R provides several simulation and estimation methods for stochastic processes <span class="citation" data-cites="YUIMA JSSv057i04 iacus2018simulation">(<a href="#ref-JSSv057i04" role="doc-biblioref">Brouste et al. 2014</a>; <a href="#ref-iacus2018simulation" role="doc-biblioref">Iacus and Yoshida 2018</a>; <a href="#ref-YUIMA" role="doc-biblioref">YUIMA Project Team 2024</a>)</span>.
This paper introduces new classes and methods in <a href="https://cran.r-project.org/package=yuima">yuima</a> for simulating and estimating a <span class="math inline">\(t\)</span>-Lévy regression model based on high-frequency observations. This model can be seen as a generalization of a <span class="math inline">\(t\)</span>-Lévy process <span class="citation" data-cites="HeyLeo05 Cuf07">(<a href="#ref-HeyLeo05" role="doc-biblioref">Heyde and Leonenko 2005</a>; <a href="#ref-Cuf07" role="doc-biblioref">Cufaro Petroni 2007</a>)</span> by adding covariates, which can be either deterministic or stochastic processes.
Adding covariates to a continuous-time stochastic process is a widely used approach for constructing new processes in various fields. For example, in finance, periodic deterministic covariates can be employed to capture the seasonality observed in commodity markets <span class="citation" data-cites="sorensen2002modeling">(<a href="#ref-sorensen2002modeling" role="doc-biblioref">Sørensen 2002</a>)</span>. Alternatively, in insurance and medicine, covariates are often incorporated into mortality rate dynamics to account for age and cohort effects <span class="citation" data-cites="HABERMAN2009255 castro2021trends">(see <a href="#ref-HABERMAN2009255" role="doc-biblioref">Haberman and Renshaw 2009</a>; <a href="#ref-castro2021trends" role="doc-biblioref">Castro-Porras et al. 2021</a> and references therein)</span>.</p>
<p>In such fields, data often exhibit heavy-tailed behavior in the margins and thus, the inclusion of a <span class="math inline">\(t\)</span>-Lévy process as a driving noise would be useful.
However, despite the simple mathematical definition of a <span class="math inline">\(t\)</span>-Lévy regression model, it poses significant challenges both in deriving its mathematical properties and in implementing numerical methods. A key difficulty arises from the fact that the <span class="math inline">\(t\)</span>-Lévy driving noise is not closed under convolution. Consequently, the distribution of its increments follows a <span class="math inline">\(t\)</span>-distribution only over a unit-time interval.</p>
<p>Motivated by this fact, in <a href="https://cran.r-project.org/package=yuima">yuima</a>, we propose three simulation methods for a <span class="math inline">\(t\)</span>-Lévy regression model.
The key element is the construction of a random number generator for the noise increments, which is essential for several discretized simulation methods and involves the numerical inversion of the characteristic function.
More specifically, our method is based on the approximation of the cumulative distribution function, and our method can relieve numerical instability compared with directly using the density function especially for simulating small time increments.
Additionally, <a href="https://cran.r-project.org/package=yuima">yuima</a> provides a two-stage estimation procedure and the corresponding estimator has consistency and asymptotic normality as shown in <span class="citation" data-cites="masuda2023quasilikelihood">Masuda et al. (<a href="#ref-masuda2023quasilikelihood" role="doc-biblioref">2024</a>)</span>.</p>
<p>The rest of this paper is organized as follows. We briefly summarize the <span class="math inline">\(t\)</span>-Lévy regression model in Section 2. We introduce the new <a href="https://cran.r-project.org/package=yuima">yuima</a> classes and methods in Section 3 and we show some examples with simulated and real data that highlight their usage in Section 4. Finally, Section 5 concludes the paper.</p>
<h2 data-number="2" id="Math:Model"><span class="header-section-number">2</span> Student <span class="math inline">\(t\)</span>-Lévy regression model</h2>
<p>In this section, we review the main characteristics of the <span class="math inline">\(t\)</span>-Lévy regression model and the <span class="math inline">\(t\)</span>-Lévy process used as its driving noise. We highlight the main issues that arise in the simulation and estimation procedures for these models. For a complete discussion on all mathematical aspects and the properties of these procedures in both cases, we refer to <span class="citation" data-cites="masuda2023quasilikelihood">Masuda et al. (<a href="#ref-masuda2023quasilikelihood" role="doc-biblioref">2024</a>)</span>.</p>
<p>The proposed <span class="math inline">\(t\)</span>-Lévy regression model is a continuous-time stochastic process of the form:
<span class="math display" id="eq:hm-model">\[\begin{equation}
Y_t = X_t \cdot \mu + \sigma J_t, \qquad t\in[0,T_n],
\tag{1}
\end{equation}\]</span>
where the <span class="math inline">\(q\)</span>-dimensional vector process <span class="math inline">\(X=(X_t)\)</span> with càdlàg paths contains the covariates; the dot denotes the inner product in <span class="math inline">\(\mathbb{R}^q\)</span> and <span class="math inline">\(J=(J_t)\)</span> is a scaled <span class="math inline">\(t\)</span>-Lévy process such that its unit-time distribution <span class="math inline">\(\mathcal{L}(J_1)\)</span> is given by:
<span class="math display" id="eq:hm-tnu">\[\begin{equation}
\mathcal{L}(J_1) = t_\nu:=t_\nu(0,1),
\tag{2}
\end{equation}\]</span>
where <span class="math inline">\(t_\nu(\mu_1,\sigma_1)\)</span> denotes the scaled Student-<span class="math inline">\(t\)</span> distribution with density:
The parameters <span class="math inline">\(\nu&gt;0\)</span>, <span class="math inline">\(\)</span> and <span class="math inline">\(\sigma&gt;0\)</span> represent the degree of freedom, location, and scale parameters, respectively <span class="citation" data-cites="HeyLeo05 Cuf07">(see <a href="#ref-HeyLeo05" role="doc-biblioref">Heyde and Leonenko 2005</a>; <a href="#ref-Cuf07" role="doc-biblioref">Cufaro Petroni 2007</a> for more details on a <span class="math inline">\(t\)</span>-Lévy process)</span>.
For this model, we consider the situation where we estimate these three unknown parameters based on a discrete-time sample <span class="math inline">\(\{(X_{t_j},Y_{t_j})\}_{j=0}^{[nT_n]}\)</span> with <span class="math inline">\(t_j=t_j^n:=\frac{j}{n}\)</span> and <span class="math inline">\(T_n\to \infty\)</span> as <span class="math inline">\(n\to\infty\)</span>.</p>
<p>To develop the <a href="https://cran.r-project.org/package=yuima">yuima</a> simulation and estimation algorithms for the model in <a href="#eq:hm-model">(1)</a>, we need to address two problems: first, the simulation of the sample path of <span class="math inline">\(J=(J_t)\)</span> on a small time grid with <span class="math inline">\(\Delta t \neq1\)</span> which is essential for handling the increments:
<span class="math display">\[\Delta_j Y = \Delta_j X \cdot \mu +\sigma\Delta_j J, \quad j=0,1,\dots, [nT_n]\]</span>
where <span class="math inline">\(\Delta_j Z\)</span> denotes <span class="math inline">\(Z_{t_j}-Z_{t_{j-1}}\)</span> for any stochastic process <span class="math inline">\(Z=(Z_t)\)</span>.
Second, the identification of an efficient procedure for estimating the model parameters <span class="math inline">\(\left(\mu, \sigma\right)\)</span> in <a href="#eq:hm-model">(1)</a> and the degree of freedom <span class="math inline">\(\nu\)</span> in <a href="#eq:hm-tnu">(2)</a>.
We will introduce both the simulation and estimation methods below.</p>
<p>Due to the stationary behavior of the L'evy increments, i.e. <span class="math inline">\(\mathcal{L}(\Delta_i J) = \mathcal{L}(J_h)\)</span>
and <span class="math inline">\(h:=t_i-t_{i-1}=\frac{1}{n}\)</span> for <span class="math inline">\(i = 1,\ldots, [nT_n]\)</span>, <span class="math inline">\(\mathcal{L}(J_h)\)</span> admits the Lebesgue density:
<span class="math display" id="eq:hmffdefpre">\[\begin{align}
x &amp;\mapsto
\frac{1}{\pi}\int_0^\infty \cos(ux)\{\varphi_{J_1,\nu}(u)\}^h du
\nonumber\\
&amp;= \left(\frac{2^{1-\nu/2}}{\Gamma(\nu/2)} \right)^h
\frac{1}{\pi}\int_0^\infty \cos(ux) u^{\nu h/2} \left(K_{\nu/2}(u)\right)^h du,
\tag{3}
\end{align}\]</span>
where <span class="math inline">\(\varphi_{J_1,\nu}(u)\)</span>, the characteristic function of <span class="math inline">\(\mathcal{L}(J_1)=t_\nu\)</span> is given by
<span class="math display" id="eq:hmtnuCF">\[\begin{equation}
\varphi_{J_1,\nu}(u) := \frac{2^{1-\nu/2}}{\Gamma(\nu/2)} |u|^{\nu/2} K_{\nu/2}(|u|), \qquad u\in\mathbb{R}
\tag{4}
\end{equation}\]</span>
and <span class="math inline">\(K_\nu(t)\)</span> denotes the modified Bessel function of the second kind (<span class="math inline">\(\nu\in\mathbb{R}\)</span>, <span class="math inline">\(t&gt;0\)</span>):
<span class="math display">\[\begin{equation*}
K_{\nu}(t)=\frac{1}{2}\int_0^{\infty}s^{\nu-1}\exp\left\{-\frac{t}{2}\left(s+\frac{1}{s}\right)\right\}ds.
\end{equation*}\]</span>
We here remark that although the explicit expression of <a href="#eq:hmffdefpre">(3)</a> cannot be obtained for general <span class="math inline">\(h\)</span>, the tail index of <span class="math inline">\(\mathcal{L}(J_h)\)</span> is the same as that of <span class="math inline">\(\mathcal{L}(J_1)\)</span> <span class="citation" data-cites="BerVig08">(<a href="#ref-BerVig08" role="doc-biblioref">Berg and Vignat 2008</a> Theorem 2)</span>, and hence, modeling tail index via student <span class="math inline">\(t\)</span>-Lévy process makes sense.
A classical method for simulating <span class="math inline">\(t\)</span>-Lévy increments based on this Fourier inversion representation is through the rejection method, as discussed in <span class="citation" data-cites="Hubalek2005OnSF">Hubalek (<a href="#ref-Hubalek2005OnSF" role="doc-biblioref">2005</a>)</span> and <span class="citation" data-cites="Dev81">Devroye (<a href="#ref-Dev81" role="doc-biblioref">1981</a>)</span>. However, this method can become time-consuming and unstable when dealing with very small values of <span class="math inline">\(h\)</span>, primarily due to the oscillatory behavior encountered during the numerical evaluation of the density.
Such a problem often arises since to express the high-frequency observed situation from a continuous process, we should take a finer mesh of simulating the underlying process than that of simulating the discrete observations.
For this issue, in <a href="https://cran.r-project.org/package=yuima">yuima</a>, the Random Number Generator for the increments is developed using the inverse quantile method. The first step involves integrating the density in <a href="#eq:hmffdefpre">(3)</a> to obtain the cumulative distribution function (CDF). This approach leads to a more stable behavior in the tails of the CDF compared to the density tails, owing to a mitigation effect observed during the numerical evaluation of the following double integral:
<span class="math display">\[\begin{equation*}
F(y) =\int_{-\infty}^{y} \frac{1}{\pi}\int_0^\infty \cos(ux)\{\varphi_{J_1,\nu}(u)\}^h du dx.
\end{equation*}\]</span>
Further details on our approach are provided in the next section.
Another way to simulate <span class="math inline">\(t\)</span>-Lévy process is using series representation. Numerically, for each time <span class="math inline">\(t\)</span>, we need ad-hoc truncation of the infinite sum.
The Gaussian approximation of a small-jump part is also valid <span class="citation" data-cites="AsmRos01">(<a href="#ref-AsmRos01" role="doc-biblioref">Asmussen and Rosiński 2001</a>)</span>, but the associated error may not be easy to control in a practical manner.
For more details, see <span class="citation" data-cites="Mass18">Massing (<a href="#ref-Mass18" role="doc-biblioref">2018</a>)</span>.</p>
<p>Following <span class="citation" data-cites="masuda2023quasilikelihood">Masuda et al. (<a href="#ref-masuda2023quasilikelihood" role="doc-biblioref">2024</a>)</span>, <a href="https://cran.r-project.org/package=yuima">yuima</a> provides a two-stage estimation algorithm for <span class="math inline">\(\left(\mu, \sigma, \nu\right)\in \Theta_\mu\times\Theta_\sigma\times \Theta_\nu\)</span>.
Denote by <span class="math inline">\((\mu_0,\sigma_0,\nu_0)\)</span> the true parameter values of the model in <a href="#eq:hm-model">(1)</a>;
the two-step algorithm can be summarized as follows:</p>
<ol type="1">
<li><p>An estimator <span class="math inline">\(\hat{a}:=(\hat{\mu}_{n},\hat{\sigma}_{n})\)</span> of <span class="math inline">\(a_0=(\mu_0,\sigma_0)\)</span> is obtained by maximizing the :
<span class="math display">\[\begin{equation}
\hat{a}_n:=(\hat{\mu}_{n},\hat{\sigma}_{n})\in\mathop{\rm argmax}_{a\in \overline{\Theta_\mu\times\Theta_\sigma}}\mathbb{H}_{1,n}(a).
\label{hm:def_CQMLE}
\end{equation}\]</span>
The Cauchy quasi-(log-)likelihood <span class="math inline">\(\mathbb{H}_{1,n}(a)\)</span> conditional on <span class="math inline">\(X\)</span> has the following form:
<span class="math display">\[\begin{align}
\mathbb{H}_{1,n}(a)
&amp;:= \sum_{j=1}^{N_n} \log\left\{\frac{1}{h\sigma}\phi_1\left( \frac{\Delta_j Y - \mu\cdot \Delta_j X}{h\sigma} \right)\right\}
\nonumber\\
&amp;= C_n - \sum_{j=1}^{N_n} \left\{ \log\sigma+ \log\left(1+\epsilon_j(a)^2\right)\right\},
\nonumber
\end{align}\]</span>
where <span class="math inline">\(\phi_1\)</span> denotes the density function of the standard Cauchy distribution and the term <span class="math inline">\(C_n\)</span> does not depend on <span class="math inline">\(a=\left(\mu,\sigma\right)\)</span>. <span class="math inline">\(N_n:=[n B_n]\)</span> is the number of observations in the part <span class="math inline">\([0,B_n]\)</span> of the entire period <span class="math inline">\([0, T_n]\)</span> where <span class="math inline">\((B_n)\)</span> is a positive sequence satisfying <span class="math inline">\(B_n\le T_n\)</span> and <span class="math inline">\(\qquad n^{\epsilon&#39;&#39;} \lesssim B_n \lesssim n^{1-\epsilon&#39;}\)</span> for some <span class="math inline">\(\epsilon&#39;,\epsilon&#39;&#39;\in(0,1)\)</span>.</p></li>
<li><p>Then, we construct an estimator <span class="math inline">\(\hat{\nu}_{n}\)</span> of <span class="math inline">\(\nu_0\)</span> using the on the ``unit-time’’ residual sequence <span class="math inline">\(\hat{\epsilon}_i\)</span>:
<span class="math display">\[\begin{equation*}
\hat{\epsilon}_i := \hat{\sigma}_{n}^{-1}\left(Y_i - Y_{i-1} - \hat{\mu}_{n}\cdot(X_i - X_{i-1})\right),
\end{equation*}\]</span>
for <span class="math inline">\(i=1,\dots,[T_n]\)</span>, which is expected to be approximately i.i.d. <span class="math inline">\(t_\nu\)</span>-distributed. Therefore <span class="math inline">\(\hat{\nu}_{n}\)</span> solves:
<span class="math display">\[\begin{equation*}
\hat{\nu}_{n}\in\mathop{\rm argmax}_{\nu\in\overline{\Theta}_\nu}\mathbb{H}_{2,n}(\nu),
\end{equation*}\]</span>
where
<span class="math display">\[\begin{equation*}
\mathbb{H}_{2,n}(\nu) :=  \sum_{i=1}^{[T_n]}\left( -\frac12 \log\pi + \log\Gamma\left(\frac{\nu+1}{2}\right) - \log\Gamma\left(\frac{\nu}{2}\right) - \frac{\nu+1}{2}\log\left( 1+ \hat{\epsilon}_i^2\right) \right).
\end{equation*}\]</span></p></li>
</ol>
<p>We note that the first estimation scheme is based on the locally Cauchy property of <span class="math inline">\(J\)</span>: <span class="math inline">\(h^{-1}J_h\xrightarrow{\mathcal{L}}t_1\)</span> (standard Cauchy) as <span class="math inline">\(h \to 0\)</span>.
Let <span class="math inline">\(\hat{u}_{a,n}:=\sqrt{N_n}(\hat{a}_n-a_0)\)</span> and <span class="math inline">\(\hat{u}_{\nu,n}:=\sqrt{T_n}(\hat{\nu}_n-\nu_0)\)</span>.
Under some regularity conditions on the covariate process <span class="math inline">\(X=\left(X_t\right)\)</span> <span class="citation" data-cites="masuda2023quasilikelihood">(see <a href="#ref-masuda2023quasilikelihood" role="doc-biblioref">Masuda et al. 2024</a> Assumption 2.1 in for all requirements on <span class="math inline">\(X\)</span>)</span>, the estimators have the following joint asymptotic normality:
<span class="math display">\[(\hat{\Gamma}_{a,n}^{1/2}\hat{u}_{a,n}, \hat{\Gamma}_{\nu,n}^{1/2}\hat{u}_{\nu,n})\xrightarrow{\mathcal{L}}N_{q+2}(0,I_{q+2}),\]</span>
where <span class="math inline">\(\psi_1\)</span> denotes the trigamma function and
<span class="math display">\[\begin{align*}
&amp;\hat{\Gamma}_{a,n}={\rm diag}\left(\frac{1}{2\hat{\sigma}_n^2N_n}\sum_{j=1}^{N_n} \left(\frac{1}{h}\Delta_j X\right)^{\otimes2}, \frac{1}{2\hat{\sigma}_n^2}\right),\\
&amp; \hat{\Gamma}_{\nu,n}=\frac{1}{4}\Bigg(\psi_1\Bigg(\frac{\hat{\nu}_n}{2}\Bigg)-\psi_1\Bigg(\frac{\hat{\nu}_n+1}{2}\Bigg)\Bigg),
\end{align*}\]</span>
Since <span class="math inline">\(\hat{\Gamma}_{a,n}^{1/2}\)</span> and <span class="math inline">\(\hat{\Gamma}_{\nu,n}\)</span> can be constructed only by the observations, we can easily obtain the confidence intervals of each parameter.
We conclude this section by noting that the function <span class="math inline">\(\mathbb{H}_{2,n}(\nu)\)</span> is concave with respect to <span class="math inline">\(\nu\)</span>, as demonstrated in <span class="citation" data-cites="masuda2023quasilikelihood">Masuda et al. (<a href="#ref-masuda2023quasilikelihood" role="doc-biblioref">2024</a>)</span>. This result follows directly from the fact that the driving noise in the <span class="math inline">\(t\)</span>-Lévy regression model is a scaled <span class="math inline">\(t\)</span>-Lévy process with a unit-time distribution as defined in <a href="#eq:hm-tnu">(2)</a>.</p>
<h2 data-number="3" id="SectN1"><span class="header-section-number">3</span> Classes and methods for <span class="math inline">\(t\)</span>-lévy regression models</h2>
<p>This section provides an overview of the new classes and methods introduced in <a href="https://cran.r-project.org/package=yuima">yuima</a> for the mathematical definition, trajectory simulation, and estimation of a Student Lévy Regression model. To handle this model, the first step involves constructing an object of the <code>yuima.LevyRM-class</code>. As an extension of the <code>yuima-class</code> refer to <span class="citation" data-cites="JSSv057i04">Brouste et al. (<a href="#ref-JSSv057i04" role="doc-biblioref">2014</a>)</span> for more details, <code>yuima.LevyRM-class</code> inherits slots such as <code>@data</code>, <code>@model</code>, <code>@sampling</code>, and <code>@functional</code> from its parent class. The remaining slots store specific information related to the Student-<span class="math inline">\(t\)</span>-Lévy regression model.</p>
<p>Notably, the slot <code>@unit_Levy</code> contains an object of the <code>yuima.th</code> class, which represents the mathematical description of the Student-<span class="math inline">\(t\)</span> Lévy process <span class="math inline">\(J_t\)</span> (see the subsequent section for detailed explanations). The labels of the regressors are saved in the slot <code>@regressors</code>, while slots <code>@LevyRM</code> and <code>@paramRM</code> respectively cache the names of the output process <span class="math inline">\(Y_t\)</span> and a <code>string</code> vector reporting the regressors’ coefficients, the scale parameter, and the degree of freedom. The <code>yuima.th-class</code> is obtained by the new <code>setLaw_th</code> constructor. This function requires the arguments used for the numerical inversion of the characteristic function, and its usage is discussed in the next section.</p>
<p>Once the <code>yuima.th-object</code> is created, we define the system of stochastic differential equations (SDEs) that describes the behavior of the regressors, with their mathematical definitions stored in an object of the <code>yuima.model-class</code>. Both <code>yuima.th</code> and <code>yuima.model</code> objects are used as inputs for the <code>setLRM</code> constructor, which returns an object of the <code>yuima.LevyRM-class</code>. The following chunk code reports the input for this new function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/yuima/man/setLRM.html'>setLRM</a></span><span class='op'>(</span><span class='va'>unit_Levy</span>, <span class='va'>yuima_regressors</span>, LevyRM <span class='op'>=</span> <span class='st'>"Y"</span>, coeff <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mu"</span>, <span class='st'>"sigma0"</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  sampling <span class='op'>=</span> <span class='cn'>NULL</span>, characteristic <span class='op'>=</span> <span class='cn'>NULL</span>, functional <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>As is customary for any class extending the <code>yuima-class</code>, the <code>simulate</code> method enables the generation of sample paths for the Student Lévy Regression model. To simulate trajectories, an object of the <code>yuima.sampling-class</code> is constructed to represent an equally spaced grid-time used in trajectory simulation. The regressors’ paths are obtained using the Euler scheme, while the increments of the Student-<span class="math inline">\(t\)</span> Lévy process are simulated using the random number generator available in the slot <code>@rng</code> of the <code>yuima.th-object</code>.</p>
<p>The last method available in <a href="https://cran.r-project.org/package=yuima">yuima</a> is <code>estimation_LRM</code>. This method allows the users to estimate the model using either real or simulated data. The estimation follows a two-step procedure, introduced in <span class="citation" data-cites="masuda2023quasilikelihood">Masuda et al. (<a href="#ref-masuda2023quasilikelihood" role="doc-biblioref">2024</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/yuima/man/estimation_LRM.html'>estimation_LRM</a></span><span class='op'>(</span><span class='va'>start</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>upper</span>, <span class='va'>lower</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>For this function, the minimal inputs are <code>@start</code>, <code>@model</code>, <code>@data</code>, <code>@upper</code> and <code>@lower</code>. The arguments <code>@start</code> are the initial points for the optimization routine while <code>@upper</code> and <code>@lower</code> correspond to the box constraints. The <code>@yuima.LevyRM-object</code> is passed to the function through the input <code>@model</code> while the input <code>@data</code> is used to pass the dataset to the internal optimization routine. Figure <a href="#fig:tLRm">1</a> describes these new classes and methods, along with their respective usage.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tLRm"></span>
<img src="figures/Tikz_standalone.png" alt="Scheme of classes and methods in \texttt{yuima} for the t-Lévy Regression model." width="100%" />
<p class="caption">
Figure 1: Scheme of classes and methods in for the t-Lévy Regression model.
</p>
</div>
</div>
<h3 data-number="3.1" id="yuimath"><span class="header-section-number">3.1</span> yuima.th: A new class for mathematical description of a Student-t Lévy process</h3>
<p>In this section, the steps for the construction of an <code>yuima.th-object</code> are presented. As remarked in Section 3, this object contains all information on the scaled Student-<span class="math inline">\(t\)</span> Lévy process. Moreover, detailed information is provided regarding the numerical algorithms utilized for evaluating the density function <a href="#eq:hmffdefpre">(3)</a>. The construction of this object is accomplished using the <code>setLaw_th</code> constructor, and the subsequent code snippet displays its corresponding arguments.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/yuima/man/setLaw_th.html'>setLaw_th</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>1</span>, method <span class='op'>=</span> <span class='st'>"LAG"</span>, up <span class='op'>=</span> <span class='fl'>7</span>, low <span class='op'>=</span> <span class='op'>-</span><span class='fl'>7</span>, N <span class='op'>=</span> <span class='fl'>180</span>, N_grid <span class='op'>=</span> <span class='fl'>1000</span>,</span>
<span>  regular_par <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The input <code>h</code> is the length of the step-size of each time interval for the Student-<span class="math inline">\(t\)</span> Lévy increment <span class="math inline">\(\Delta J_h=J_h-J_0\)</span>. Its default value, <code>h=1</code>, indicates that the <code>yuima.th-object</code> describes completely the process <span class="math inline">\(J_t\)</span> at time 1. The argument <code>method</code> refers to the type of quadrature used for the computation of the integral in <a href="#eq:hmffdefpre">(3)</a> while the remaining arguments govern the precision of the integration routine.</p>
<p>The <code>yuima.th-class</code> inherits the slots <code>@rng</code>, <code>@density</code>, <code>@cdf</code> and <code>@quantile</code> from its parent class <code>yuima-law</code> <span class="citation" data-cites="Masuda2022">Masuda et al. (<a href="#ref-Masuda2022" role="doc-biblioref">2022</a>)</span>. These slots store respectively the random number generator, the density function, the cumulative distribution function and the quantile function of <span class="math inline">\(J_h\)</span>. As mentioned in Section 1, the density function with <span class="math inline">\(h\neq1\)</span> does not have a closed-form formula and, therefore, the inversion of the characteristic function is necessary. <a href="https://cran.r-project.org/package=yuima">yuima</a> provides three methods for this purpose: the Laguerre quadrature, the COS method and the Fast Fourier Transform.
The Gauss-Laguerre quadrature is a numerical integration method employed for evaluating integrals in the following form:
<span class="math display">\[
\mathcal{I}=\int_0^{+\infty} f\left(x\right) e^{-x}\mbox{d}x.
\]</span>
This procedure has been recently used for the computation of the density of the variance gamma and the transition density of a CARMA model driven by a time-changed Brownian motion <span class="citation" data-cites="loregian2012approximation mercuri2021finite">(<a href="#ref-loregian2012approximation" role="doc-biblioref">Loregian et al. 2012</a>; <a href="#ref-mercuri2021finite" role="doc-biblioref">Mercuri et al. 2021</a>)</span>, this motivates its application in this paper.</p>
<p>Let <span class="math inline">\(f\left(x\right)\)</span> be a continuous function defined on <span class="math inline">\(\left[0, +\infty\right)\)</span> such that:
<span class="math display">\[\begin{equation*}
\mathcal{I}=\int_0^{+\infty} f\left(x\right) e^{-x}\mbox{d}x&lt;+\infty;
\end{equation*}\]</span>
the integral <span class="math inline">\(\mathcal{I}\)</span> can be approximated as follows:
<span class="math display" id="eq:Laguerre">\[\begin{equation}
\mathcal{I}\approx \sum_{j=1}^{N}\omega\left(k_j\right)f\left(k_{j}\right),
\tag{5}
\end{equation}\]</span>
where <span class="math inline">\(k_j\)</span> is the <span class="math inline">\(j\)</span>th-root of the <span class="math inline">\(N\)</span>-order Laguerre polynomial<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <span class="math inline">\(L_N\left(x\right)\)</span> and the weights <span class="math inline">\(\omega\left(k_j\right), j=1,\ldots, N\)</span> are defined as:
<span class="math display">\[\begin{equation}
\omega\left(k_{j}\right) = \frac{k_{j}}{\left(N+1\right)^2 L_{N+1}^2\left(k_j\right)}.
\end{equation}\]</span>
To apply the approximation in <a href="#eq:Laguerre">(5)</a>, we rewrite the inversion formula in <a href="#eq:hmffdefpre">(3)</a> as follows:
<span class="math display" id="eq:InvForLM">\[\begin{eqnarray}
f\left(x\right)&amp;=&amp;\frac{1}{\pi}\left(\frac{2^{1-\frac{\nu}{2}}}{\Gamma\left(\nu/2\right)}\right)^h\int_{0}^{+\infty}\cos\left(ux\right)u^{\nu h/2}\left(K_{\nu/2}\left(u\right)\right)^h\mbox{d}u\nonumber\\
&amp;=&amp;\frac{1}{\pi}\left(\frac{2^{1-\frac{\nu}{2}}}{\Gamma\left(\nu/2\right)}\right)^h\int_{0}^{+\infty}\cos\left(ux\right)u^{\nu h/2}\left(K_{\nu/2}\left(u\right)\right)^he^{u}e^{-u}\mbox{d}u.
\tag{6}
\end{eqnarray}\]</span>
Applying the result in <a href="#eq:Laguerre">(5)</a>, the density function of <span class="math inline">\(J_h\)</span> can be approximated with the formula reported below:
<span class="math display" id="eq:FinalLaguerre">\[\begin{equation}
\hat{f}_{N}\left(x_j\right) = \frac{1}{\pi}\left(\frac{2^{1-\frac{\nu}{2}}}{\Gamma\left(\nu/2\right)}\right)^h \sum_{j=1}^{N}\cos\left(k_j x\right)k_j^{\nu h/2}\left(K_{\nu/2}\left(k_j\right)\right)^he^{k_j}\omega\left(k_j\right).
\tag{7}
\end{equation}\]</span>
Notably, the approximation formula’s precision in equation <a href="#eq:FinalLaguerre">(7)</a> can be enhanced through the argument <code>N</code> in the <code>setLaw_th</code> constructor. The roots <span class="math inline">\(k_j\)</span> and the weights <span class="math inline">\(\omega\left(k_j\right)\)</span> are internally computed using the <code>gauss.quad</code> function from the R package <a href="https://cran.r-project.org/package=statmod">statmod</a> <span class="citation" data-cites="statmod Goknur2016">(<a href="#ref-Goknur2016" role="doc-biblioref">Giner and Smyth 2016</a>; <a href="#ref-statmod" role="doc-biblioref">Smyth et al. 2023</a>)</span>, with a maximum allowed order of 180 for the Laguerre polynomial.</p>
<p>The COS method is based on the Fourier Cosine expansion employed for an even function with the compact domain <span class="math inline">\(\left[-\pi, \pi \right]\)</span>. This method has been widely applied in the finance literature for the computation of the exercise probability of an option and its no-arbitrage price, we refer to <span class="citation" data-cites="fang2009novel">Fang and Oosterlee (<a href="#ref-fang2009novel" role="doc-biblioref">2009</a>)</span>, <span class="citation" data-cites="fang2011fourier">Fang and Oosterlee (<a href="#ref-fang2011fourier" role="doc-biblioref">2011</a>)</span> and references therein for details. Let <span class="math inline">\(g\left(\theta\right):\left[-\pi, \pi \right] \rightarrow \mathbb{R}\)</span> be an even function, its Fourier Cosine expansion reads:
<span class="math display" id="eq:ExpCosF">\[\begin{equation}
g\left(\theta\right)=\frac12 a_0 +\sum_{k=1}^{\infty} a_k \cos\left(k\theta\right)
\tag{8}
\end{equation}\]</span>
with
<span class="math display">\[\begin{equation*}
a_k = \frac{2}{\pi}\int_0^{\pi}g\left(\theta\right)\cos\left(k\theta\right)\mbox{d}\theta.
\end{equation*}\]</span>
Denoting with <span class="math inline">\(f\left(x\right)\)</span> the density function of <span class="math inline">\(J_h\)</span>, the new function <span class="math inline">\(\bar{g}\left(\theta\right)\)</span> is defined as:
<span class="math display" id="eq:newg">\[\begin{equation}
\bar{g}\left(\theta\right):=f\left(\frac{L}{\pi}\theta\right)\frac{L}{\pi} \mathbb{1}_{\left\{-\pi \leq \theta \leq \pi\right\} },
\tag{9}
\end{equation}\]</span>
can be applied. The coefficient <span class="math inline">\(a_k\)</span> is determined as follows:
<span class="math display">\[\begin{eqnarray*}
a_k &amp;=&amp; \frac{2}{\pi}\int_0^{\pi}\bar{g}\left(\theta\right) \cos\left(k\theta\right)\mbox{d}\theta\nonumber\\
&amp;=&amp;\frac{2}{\pi}\int_0^{\pi} f\left(\frac{L}{\pi}\theta\right)\cos\left(k\theta\right)\frac{L}{\pi}\mbox{d}\theta.\nonumber
\end{eqnarray*}\]</span>
Setting <span class="math inline">\(\theta = \frac{\pi}{L}x\)</span>, we have:
<span class="math display">\[\begin{equation}
a_k = \frac{2}{\pi}\int_0^{L}f\left(x\right) \cos\left(k\frac{\pi}{L}x\right)\mbox{d}x.
\end{equation}\]</span>
The coefficient <span class="math inline">\(a_k\)</span> can be rewritten using the characteristic function of <span class="math inline">\(J_h\)</span> at <span class="math inline">\(k\frac{\pi}{L}\)</span>, i.e.:
<span class="math display">\[\begin{equation}
a_k = \frac{2}{\pi}\left[\varphi\left(k\frac{\pi}{L}\right)-\int_{L}^{+\infty}f\left(x\right) \cos\left(k\frac{\pi}{L}x\right)\mbox{d}x\right].
\end{equation}\]</span>
For a sufficiently large <span class="math inline">\(L\)</span>, the coefficient <span class="math inline">\(a_k\)</span> can be approximated as follows:
<span class="math display">\[\begin{equation}
a_k \approx \frac{2}{\pi} \varphi\left(k\frac{\pi}{L}\right).
\end{equation}\]</span>
The following series expansion is achieved:
<span class="math display" id="eq:CosMethodInYuima">\[\begin{equation}
f\left(x\right)=\frac12 \bar{a}_0 + \sum_{k=1}^{+\infty} \bar{a}_k\cos\left(k\frac{\pi}{L}x\right)
\tag{10}
\end{equation}\]</span>
with
<span class="math display">\[
\bar{a}_k = a_k \frac{\pi}{L} \approx \frac{2}{L}\varphi\left(k\frac{\pi}{L}\right).
\]</span>
Finally, <a href="#eq:CosMethodInYuima">(10)</a> can be approximated by truncating the series as follows:
<span class="math display" id="eq:ApproxCosMethodInYuima">\[\begin{equation}
\hat{f}_{N}\left(x\right)=\frac12 \hat{a}_{0,L} + \sum_{k=1}^{N} \hat{a}_{k,L}\cos\left(k\frac{\pi}{L}x\right)
\tag{11}
\end{equation}\]</span>
with
<span class="math display">\[
\hat{a}_{k,L}=\frac{2}{L}\varphi\left(k\frac{\pi}{L}\right).
\]</span>
The precision of <span class="math inline">\(\hat{f}_{N,L}\left(x\right)\)</span> in <a href="#eq:ApproxCosMethodInYuima">(11)</a> depends on <span class="math inline">\(N\)</span> and <span class="math inline">\(L\)</span>. Users can select these two quantities using <code>N</code> and the couple <span class="math inline">\(\texttt{(up, low)}\)</span> respectively. <span class="math inline">\(L\)</span> is computed internally in the <code>setLaw_th</code> constructor as <span class="math inline">\(\texttt{L = max(|low|,up)}\)</span>.
The last method available in <a href="https://cran.r-project.org/package=yuima">yuima</a> for the computation of the density of <span class="math inline">\(t\)</span>-Lévy increments over a time interval with length <span class="math inline">\(h\)</span> is based on the inversion of the characteristic function by means of the Fast Fourier Transform <code>FFT</code> <span class="citation" data-cites="singleton1969algorithm">Singleton (<a href="#ref-singleton1969algorithm" role="doc-biblioref">1969</a>)</span>, <span class="citation" data-cites="cooley1965algorithm">Cooley and Tukey (<a href="#ref-cooley1965algorithm" role="doc-biblioref">1965</a>)</span> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Denoting the density function as <span class="math inline">\(f\left(x\right)\)</span> and the characteristic function as <span class="math inline">\(\varphi\left(u\right):=\mathbb{E}\left[e^{iu J_h}\right]\)</span> for the scaled <span class="math inline">\(t\)</span>-Lévy <span class="math inline">\(J_h\)</span>, the density <span class="math inline">\(f\left(x\right)\)</span> can be obtained as follows:</p>
<p><span class="math display" id="eq:INVCharLM">\[\begin{eqnarray}
f\left(x\right) &amp;=&amp; \frac{1}{2\pi}\int_{-\infty}^{+\infty} e^{-iux}\mathbb{E}\left[e^{iu J_h}\right] \mbox{d}u \nonumber \\
&amp;=&amp; \frac{1}{2\pi}\int_{-\infty}^{+\infty} e^{-iux}\varphi\left(u\right) \mbox{d}u.
\tag{12}
\end{eqnarray}\]</span>
As first step, we apply to the integral in <a href="#eq:INVCharLM">(12)</a> the change variable <span class="math inline">\(u = 2\pi \omega\)</span> and we have:
<span class="math display">\[\begin{equation}
f\left(x\right) = \int_{-\infty}^{+\infty} e^{-i 2\pi\omega x}\varphi\left(2\pi\omega\right) \mbox{d}\omega.
\end{equation}\]</span>
We consider discrete support for <span class="math inline">\(x\)</span> and <span class="math inline">\(\omega\)</span>. The <span class="math inline">\(x\)</span> grid has the following structure:
<span class="math display" id="eq:gridx">\[\begin{equation}
x_0 =a, \ldots, x_j=a+ j \Delta x, \ldots, x_N=b
\tag{13}
\end{equation}\]</span>
with <span class="math inline">\(\Delta x =\frac{b-a}{N}\)</span> where <span class="math inline">\(N+1\)</span> is the number of the points in the grid in <a href="#eq:gridx">(13)</a>.
Similarly, we define a <span class="math inline">\(\omega\)</span> grid:
<span class="math display" id="eq:omegagrid">\[\begin{equation}
\omega_0= -\frac{N}{2} \Delta \omega, \ldots,  \omega_n = -\frac{N}{2} + n \Delta \omega  \ldots, \omega_N = \frac{N}{2}\Delta \omega
\tag{14}
\end{equation}\]</span>
where <span class="math inline">\(\Delta \omega = \frac{1}{N \Delta x} = \frac{1}{b-a}\)</span>. Both grids have the same dimension <span class="math inline">\(N+1\)</span>, <span class="math inline">\(\Delta x\)</span> shrinks as <span class="math inline">\(N \rightarrow +\infty\)</span> while <span class="math inline">\(\Delta \omega\)</span> reduces for large values of <span class="math inline">\(b-a\)</span>.
For any <span class="math inline">\(x_j\)</span> in the grid we can approximate the integral in <a href="#eq:INVCharLM">(12)</a> using the left Riemann summation, therefore, we have the approximation <span class="math inline">\(\hat{f}_{N}\left(x_j\right)\)</span>:
<span class="math display" id="eq:FFTDens">\[\begin{align}
\hat{f}_{N}\left(x_j\right) &amp;= \Delta \omega \sum_{n=1}^{N}e^{2 i\pi \left(-\frac{N}{2}\Delta \omega +\left(n-1\right) \Delta u\right)x_j}\varphi\left(-\pi N\Delta u + 2\pi \left(n-1\right)\right)\nonumber\\
&amp;= \Delta \omega e^{i\pi N \Delta \omega} \sum_{n=1}^{N}e^{- 2 i \pi \left(n-1\right)\Delta u \left(a+\left(j-1\right) \Delta x\right)}\varphi\left(-\pi N\Delta \omega + 2\pi \left(n-1\right)\right)\nonumber\\
&amp;= \Delta \omega e^{i\pi N \Delta \omega}\sum_{n=1}^{N}e^{\frac{- 2 i \pi\left(n-1\right)\left(j-1\right)}{N}}\varphi\left(-\pi N\Delta \omega + 2\pi \left(n-1\right)\right)e^{\frac{-2i\pi \left(n-1\right)a}{N}}.
\tag{15}
\end{align}\]</span>
The last equality in <a href="#eq:FFTDens">(15)</a> is due to the identity <span class="math inline">\(\Delta \omega \Delta x = \frac{1}{N}\)</span>. To evaluate the summation in <a href="#eq:FFTDens">(15)</a>, we use the <span class="math inline">\(\texttt{FFT}\)</span> algorithm and
<span class="math display">\[\begin{equation}
\hat{f}_{N}\left(x_j\right) = \Delta \omega e^{i\pi N \Delta \omega}\texttt{FFT}\left[\varphi\left(-\pi N\Delta \omega + 2\pi \left(n-1\right)\right)e^{ \frac{-2 i \pi \left(n-1\right)a}{N}}\right].
\end{equation}\]</span>
In this case, we have two sources of approximation errors that we can control using the arguments <code>up</code>, <code>low</code> and <code>N</code> in the <code>setLaw_th</code> constructor. <code>N</code> denotes the number of intervals in the grid used for the Left-Riemann summation while <code>up</code>, <code>low</code> are used to compute the step size of this grid.</p>
<p>Once the density function has been obtained using one of the three methods described above, it is possible to approximate the cumulative distribution function using the Left-Riemann summation computed on the grid in <a href="#eq:gridx">(13)</a>, therefore the cumulative distribution function <span class="math inline">\(F\left(\cdot\right)\)</span> for each <span class="math inline">\(x_j\)</span> on the grid is determined as follows:
<span class="math display">\[\begin{equation}
\hat{F}\left(x_j\right) = \sum_{x_k&lt;x_j}\hat{f}_{N}\left(x_k\right)\Delta x.
\end{equation}\]</span>
In this way, we can construct a table that we can use internally in the <code>cdf</code> and <code>quantile</code> functions. Moreover, to evaluate the cumulative distribution function at any <span class="math inline">\(x\in \left( x_{j-1}, x_j \right)\)</span>, we interpolate linearly its value using the couples <span class="math inline">\(\left(x_{j-1}, \hat{F}\left(x_{j-1}\right)\right)\)</span> and <span class="math inline">\(\left(x_{j}, \hat{F}\left(x_{j}\right)\right)\)</span>. The random numbers can be obtained using the inversion sampling method.</p>
<p>We conclude this section with a numerical comparison among the three methods implemented in <a href="https://cran.r-project.org/package=yuima">yuima</a>. To assess the precision of our code we use as a target the cumulative distribution function of a Student-<span class="math inline">\(t\)</span> with <span class="math inline">\(\nu = 3\)</span> computed through the function <code>pt</code> <span class="citation" data-cites="Man">(<a href="#ref-Man" role="doc-biblioref">R Core Team 2024</a>)</span>. To conduct this comparison, we construct three <code>yuima.th-objects</code> as displayed in the code snippet reported below<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># To instal YUIMA from Github repository</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://pak.r-lib.org/'>pak</a></span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'>pak</span><span class='fu'>::</span><span class='fu'><a href='https://pak.r-lib.org/reference/pkg_install.html'>pkg_install</a></span><span class='op'>(</span><span class='st'>"yuimaproject/yuima"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>##########</span></span>
<span><span class='co'># Inputs #</span></span>
<span><span class='co'>##########</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yuimaproject.com'>yuima</a></span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>nu</span> <span class='op'>&lt;-</span> <span class='fl'>3</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>h</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='co'># step size for the interval time</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>up</span> <span class='op'>&lt;-</span> <span class='fl'>10</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>low</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>10</span></span>
<span></span>
<span><span class='co'># Support definition for variable x</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>low</span>,<span class='va'>up</span>,length.out<span class='op'>=</span><span class='fl'>100001</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Definition of yuima.th-object</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>law_LAG</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/yuima/man/setLaw_th.html'>setLaw_th</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>h</span>, method <span class='op'>=</span> <span class='st'>"LAG"</span>, up <span class='op'>=</span> <span class='va'>up</span>, low <span class='op'>=</span> <span class='va'>low</span>, N <span class='op'>=</span> <span class='fl'>180</span><span class='op'>)</span> <span class='co'># Laguerre</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>law_COS</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/yuima/man/setLaw_th.html'>setLaw_th</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>h</span>, method <span class='op'>=</span> <span class='st'>"COS"</span>, up <span class='op'>=</span> <span class='va'>up</span>, low <span class='op'>=</span> <span class='va'>low</span>, N <span class='op'>=</span> <span class='fl'>180</span><span class='op'>)</span> <span class='co'># COS</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>law_FFT</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/yuima/man/setLaw_th.html'>setLaw_th</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>h</span>, method <span class='op'>=</span> <span class='st'>"FFT"</span>, up <span class='op'>=</span> <span class='va'>up</span>, low <span class='op'>=</span> <span class='va'>low</span>, N <span class='op'>=</span> <span class='fl'>180</span><span class='op'>)</span> <span class='co'># FFT</span></span>
<span></span>
<span><span class='co'># Cumulative Distribution Function: we apply the cdf method to the yuima.th-object</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Lag_time</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ycdf_LAG</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/yuima/man/LawMethods.html'>cdf</a></span><span class='op'>(</span><span class='va'>law_LAG</span>, <span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>nu<span class='op'>=</span><span class='va'>nu</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Laguerre</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>COS_time</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ycdf_COS</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/yuima/man/LawMethods.html'>cdf</a></span><span class='op'>(</span><span class='va'>law_COS</span>, <span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>nu<span class='op'>=</span><span class='va'>nu</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># COS</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>FFT_time</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ycdf_FFT</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/yuima/man/LawMethods.html'>cdf</a></span><span class='op'>(</span><span class='va'>law_FFT</span>, <span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>nu<span class='op'>=</span><span class='va'>nu</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># FFT</span></span></code></pre>
</div>
</div>
<p>User can specify the numerical methods of the inversion of the characteristic function using the input <code>method</code>. This argument assumes three values: <code>"LAG"</code> for the Gauss-Laguerre quadrature, <code>"COS"</code> for the Cosine Series Expansion and <code>"FFT"</code> for the Fast Fourier Transform. Once the <code>yuima.th-object</code> has been constructed, its cumulative distribution function is computed by applying the <a href="https://cran.r-project.org/package=yuima">yuima</a> method<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <code>cdf</code> that returns the cumulative distribution function for the <code>numeric</code> vector <code>x</code>. To enable a direct comparison with the outputs of the R functions <code>dt</code>, <code>pt</code>, <code>rt</code>, and <code>qt</code>, the <a href="https://cran.r-project.org/package=yuima">yuima</a> methods <code>dens</code>, <code>cdf</code>, <code>quantile</code>, and <code>rand</code> refer to the increments of a <span class="math inline">\(t\)</span>-Lévy process <span class="math inline">\(Z_t\)</span>, rather than the corresponding scaled <span class="math inline">\(t\)</span>-Lévy process <span class="math inline">\(J_t\)</span>. Specifically, when <span class="math inline">\(t = 1\)</span>, the functions <code>pt</code> and <code>cdf</code> compute the same cumulative distribution function, as illustrated in Figure <a href="#fig:CDComparisonnu3h1">2</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CDComparisonnu3h1"></span>
<img src="figures/CDF_Comparison_nu3_h1.png" alt="Cumulative distribution function comparison for a Student-$t$ random variable with $\nu=3$." width="100%" />
<p class="caption">
Figure 2: Cumulative distribution function comparison for a Student-<span class="math inline">\(t\)</span> random variable with <span class="math inline">\(\nu=3\)</span>.
</p>
</div>
</div>
<p>For all numerical approaches available for <code>cdf</code>, we have a good level of precision that is also confirmed by Table <a href="#tab:Table2Example1">1</a>. As expected the fastest method is the <code>FFT</code> which seems to be also the most precise.</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption><span id="tab:Table2Example1">Table 1: </span>Summary comparison of the distance between each method available in yuima and the cumulative distribution function obtained using the R function <code>pt</code>.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: center;">COS</th>
<th style="text-align: center;">FFT</th>
<th style="text-align: center;">LAG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: center;">2.10e-02</td>
<td style="text-align: center;">2.10e-02</td>
<td style="text-align: center;">0.064000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Max</td>
<td style="text-align: center;">3.20e-02</td>
<td style="text-align: center;">3.20e-02</td>
<td style="text-align: center;">0.085000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Min</td>
<td style="text-align: center;">7.88e-05</td>
<td style="text-align: center;">2.18e-05</td>
<td style="text-align: center;">0.000497</td>
</tr>
<tr class="even">
<td style="text-align: left;">sec.</td>
<td style="text-align: center;">1.47e+00</td>
<td style="text-align: center;">4.00e-02</td>
<td style="text-align: center;">1.200000</td>
</tr>
</tbody>
</table>
</div>
<p>To further investigate this fact, we study the behaviour of the cumulative distribution function when <span class="math inline">\(h\)</span> varies. For <span class="math inline">\(h= 0.01\)</span>, we observe an oscillatory behaviour on tails for the <code>FFT</code> and <code>COS</code> while the Laguerre method seems to be more stable as shown in Figure <a href="#fig:CDFComparisonnu3h001">3</a>. To have a fair comparison, we set <code>N = 180</code>, however we notice that the precision of <code>FFT</code> can be drastically improved by tuning the inputs <code>N</code>, <code>up</code> and <code>low</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CDFComparisonnu3h001"></span>
<img src="figures/CDF_Comparison_nu3_h001.png" alt="Cumulative distribution function comparison for a Student-$t$ Lévy increment with $\nu=3$ and $h=0.01$." width="100%" />
<p class="caption">
Figure 3: Cumulative distribution function comparison for a Student-<span class="math inline">\(t\)</span> Lévy increment with <span class="math inline">\(\nu=3\)</span> and <span class="math inline">\(h=0.01\)</span>.
</p>
</div>
</div>
<h2 data-number="4" id="sec-NE"><span class="header-section-number">4</span> Numerical examples</h2>
<p>This section presents a series of numerical examples demonstrating the practical application of newly developed classes and methods within the Student-<span class="math inline">\(t\)</span> Regression model. Specifically, we showcase the simulation and estimation of models where the regressors are determined by deterministic functions of time in the first example. The second example introduces integrated stochastic regressors. Lastly, we perform an analysis using real data in the final example.</p>
<h3 data-number="4.1" id="sec-deterministic"><span class="header-section-number">4.1</span> Model with Deterministic Regressors</h3>
<p>In this example, we consider two deterministic regressors and the dynamics of the model have the following form:
<span class="math display" id="eq:Regr1">\[\begin{equation}
Y_t =\mu_1 \cos\left(5t\right)+\mu_2 \sin\left(t\right) +\sigma J_t
\tag{16}
\end{equation}\]</span>
with the true values <span class="math inline">\(\left(\mu_1, \mu_2, \sigma_0, \nu_0\right)=\left(5,-1,3,3\right)\)</span>. The estimation of the model <a href="#eq:Regr1">(16)</a> has been investigated in where the empirical distribution of the studentized estimates has been discussed.
To use the simulation method in <a href="https://cran.r-project.org/package=yuima">yuima</a> we have to write the dynamics of the regressors <span class="math inline">\(X_{1,t}:=\cos\left(5t\right)\)</span> and <span class="math inline">\(X_{2,t}=:\)</span>, that is:
<span class="math display" id="eq:reg1">\[\begin{equation}
\mbox{d}\left[\begin{array}{c}
X_{1,t}\\
X_{2,t}
\end{array}
\right]=\left[\begin{array}{c}-5\sin\left(5t\right)\\
\cos\left(t\right)\end{array}\right]\mbox{d}t
\tag{17}
\end{equation}\]</span>
with the initial condition:
<span class="math display">\[
X_{1,0}=1, \ X_{2,0}=0.
\]</span>
In the following, we show how to implement this model in <a href="https://cran.r-project.org/package=yuima">yuima</a>.
In this example, we set <span class="math inline">\(h_n=1/50\)</span>, and thus the number of the observations <span class="math inline">\(n\)</span> over unit time is <span class="math inline">\(50\)</span>. We also set the terminal time of the whole observations <span class="math inline">\(T_n=50\)</span> and that of the partial observations <span class="math inline">\(B_n=15\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>R</span><span class='op'>&gt;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yuimaproject.com'>yuima</a></span><span class='op'>)</span></span>
<span><span class='co'>##########</span></span>
<span><span class='co'># Inputs #</span></span>
<span><span class='co'>##########</span></span>
<span><span class='co'># Inputs for Fourier Inversion</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>method_Fourier</span> <span class='op'>&lt;-</span> <span class='st'>"FFT"</span>; <span class='va'>up</span> <span class='op'>&lt;-</span> <span class='fl'>6</span>; <span class='va'>low</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>6</span>; <span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>^</span><span class='fl'>17</span>; <span class='va'>N_grid</span> <span class='op'>&lt;-</span> <span class='fl'>60000</span></span>
<span></span>
<span><span class='co'># Inputs for the sample grid time</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Factor</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Factor1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>initial</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>; <span class='va'>Final_Time</span> <span class='op'>&lt;-</span> <span class='fl'>50</span> <span class='op'>*</span> <span class='va'>Factor</span>; <span class='va'>h</span> <span class='op'>&lt;-</span> <span class='fl'>0.02</span><span class='op'>/</span><span class='va'>Factor1</span></span></code></pre>
</div>
</div>
<p>We notice that the variable <code>Factor1</code> controls the step size of the time grid. Indeed for different values of this quantity, we have a different value for <span class="math inline">\(h\)</span> for example <code>Factor1 = 1, 2, 4, 7.2</code> corresponds <code>h = 0.02, 0.01, 0.005, 1/365</code>.</p>
<p>The first step is the definition of an object of <code>yuima.th-class</code> using the constructor <code>setLaw_th</code>.
This object contains the random number generator, the density function, the cumulative distribution function and the quantile function for constructing the increments of a Student-<span class="math inline">\(t\)</span> Lévy process.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: Deterministic Regressors #</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> mu1 <span class="ot">&lt;-</span> <span class="dv">5</span>; mu2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span>; scale <span class="ot">&lt;-</span> <span class="dv">3</span>; nu <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Model Parameters</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Definition</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> law1 <span class="ot">&lt;-</span> <span class="fu">setLaw_th</span>(<span class="at">method =</span> method_Fourier, <span class="at">up =</span> up, <span class="at">low =</span> low,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> N, <span class="at">N_grid =</span> N_grid) <span class="co"># yuima.th</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">class</span>(yuima_law)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;yuima.th&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;package&quot;</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;yuima&quot;</span></span></code></pre></div>
</div>
<p>The next step is to define the dynamics of the regressors described in <a href="#eq:reg1">(17)</a>. This set of differential equations is defined in <a href="https://cran.r-project.org/package=yuima">yuima</a> using the standard constructor <code>setModel</code>. Once an object containing the mathematical description of the regressors has been defined, we use <code>setLRM</code> to obtain the <code>yuima.LevyRM</code>. In the following, we report the command lines for the definition of the Student Lévy Regression Model in <a href="#eq:Regr1">(16)</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> regr1 <span class="ot">&lt;-</span> <span class="fu">setModel</span>(<span class="at">drift =</span> <span class="fu">c</span>(<span class="st">&quot;-5*sin(5*t)&quot;</span>, <span class="st">&quot;cos(t)&quot;</span>), <span class="at">diffusion =</span> <span class="fu">matrix</span>(<span class="st">&quot;0&quot;</span>,<span class="dv">2</span>,<span class="dv">1</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">solve.variable =</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>), <span class="at">xinit =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)) <span class="co"># Regressors definition</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Mod1 <span class="ot">&lt;-</span> <span class="fu">setLRM</span>(<span class="at">unit_Levy =</span> law1, <span class="at">yuima_regressors =</span> regr1) <span class="co"># t-Regression Model</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">class</span>(Mod1)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;yuima.LevyRM&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;package&quot;</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;yuima&quot;</span></span></code></pre></div>
</div>
<p>Using the object <code>Mod1</code> we simulate a trajectory of the model in <a href="#eq:Regr1">(16)</a> using the <a href="https://cran.r-project.org/package=yuima">yuima</a> method <code>simulate</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Simulation</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>samp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/yuima/man/setSampling.html'>setSampling</a></span><span class='op'>(</span><span class='va'>initial</span>, <span class='va'>Final_Time</span>, n <span class='op'>=</span> <span class='va'>Final_Time</span><span class='op'>/</span><span class='va'>h</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>true.par</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu1 <span class='op'>=</span> <span class='va'>mu1</span>, mu2 <span class='op'>=</span> <span class='va'>mu2</span>, sigma0 <span class='op'>=</span> <span class='va'>scale</span>, nu <span class='op'>=</span> <span class='va'>nu</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>sim1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/yuima/man/simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>Mod1</span>, true.parameter <span class='op'>=</span> <span class='va'>true.par</span>, sampling <span class='op'>=</span> <span class='va'>samp</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Figure <a href="#fig:SimulationMod1">4</a> reports the simulated sample paths for the regressors <span class="math inline">\(X_{1,t}\)</span>, <span class="math inline">\(X_{2,t}\)</span> and the Student Lévy Regression model <span class="math inline">\(Y_{t}\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SimulationMod1"></span>
<img src="figures/Simulation_Mod1.png" alt="Simulated Trajectory of the Student Lévy Regression model defined in \@ref(eq:Regr1)." width="100%" />
<p class="caption">
Figure 4: Simulated Trajectory of the Student Lévy Regression model defined in <a href="#eq:Regr1">(16)</a>.
</p>
</div>
</div>
<p>The next step is to study the behaviour of the two-step estimation procedure described in Section 2. To run this procedure, we use the method <code>estimation_LRM</code> and then we initialize randomly the optimization routine as shown in the following command lines.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> lower <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">mu2 =</span> <span class="sc">-</span><span class="dv">10</span>,  <span class="at">sigma0 =</span> <span class="fl">0.1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> upper <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="dv">10</span>, <span class="at">mu2 =</span> <span class="dv">10</span>, <span class="at">sigma0 =</span> <span class="fl">10.01</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> start <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">mu2 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">sigma0 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.01</span>, <span class="dv">4</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Bn <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">*</span>Factor</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> est1 <span class="ot">&lt;-</span> <span class="fu">estimation_LRM</span>(<span class="at">start =</span> start, <span class="at">model =</span> sim1, <span class="at">data =</span> sim1<span class="sc">@</span>data,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">upper =</span> upper, <span class="at">lower =</span> lower, <span class="at">PT =</span> Bn)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">class</span>(est1)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;yuima.qmle&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;package&quot;</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;yuima&quot;</span></span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">summary</span>(est1)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Quasi<span class="sc">-</span>Maximum likelihood estimation</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">estimation_LRM</span>(<span class="at">start =</span> start, <span class="at">model =</span> sim1, <span class="at">data =</span> sim1<span class="sc">@</span>data,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> upper, <span class="at">lower =</span> lower, <span class="at">PT =</span> Bn)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        Estimate Std. Error</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>mu1     <span class="fl">5.029555</span> <span class="fl">0.03538355</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>mu2    <span class="sc">-</span><span class="fl">1.128905</span> <span class="fl">0.18026088</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">2.425147</span> <span class="fl">0.12523404</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>nu      <span class="fl">2.735344</span> <span class="fl">0.47457435</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> log L<span class="sc">:</span> <span class="fl">3236.535</span> <span class="fl">73.3833</span></span></code></pre></div>
</div>
<p>It is also possible to construct the dataset without the method <code>simulate</code>. This result can be achieved by constructing an object of <code>yuima.th-class</code> that represents the increment of the Student-<span class="math inline">\(t\)</span> Lévy process on the time interval with length <span class="math inline">\(h\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset construction without YUIMA</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> time_t <span class="ot">&lt;-</span> <span class="fu">index</span>(<span class="fu">get.zoo.data</span>(sim1<span class="sc">@</span>data)[[<span class="dv">1</span>]])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> X1 <span class="ot">&lt;-</span> <span class="fu">zoo</span>(<span class="fu">cos</span>(<span class="dv">5</span><span class="sc">*</span>time_t), <span class="at">order.by =</span> time_t)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> X2 <span class="ot">&lt;-</span> <span class="fu">zoo</span>(<span class="fu">sin</span>(time_t), <span class="at">order.by =</span> time_t)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> law1_h <span class="ot">&lt;-</span> <span class="fu">setLaw_th</span>(<span class="at">h =</span> h, <span class="at">method =</span> method_Fourier, <span class="at">up =</span> up, <span class="at">low =</span> low,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">N =</span> N, <span class="at">N_grid =</span> N_grid)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">c</span>(law1_h<span class="sc">@</span>h,law1<span class="sc">@</span>h))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.02</span> <span class="fl">1.00</span></span></code></pre></div>
</div>
<p>The object <code>law1_h</code> refers to the Student-<span class="math inline">\(t\)</span> Lévy increment over an interval with length <span class="math inline">\(0.02\)</span> as it can be seen looking at the slot <code>...@h</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>nu</span><span class='op'>)</span><span class='op'>&lt;-</span> <span class='st'>"nu"</span></span>
<span><span class='co'># Simulation a t-Levy process Z_t.</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Z_t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/zoo.html'>zoo</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/pkg/yuima/man/LawMethods.html'>rand</a></span><span class='op'>(</span><span class='va'>law1_h</span>, <span class='va'>Final_Time</span><span class='op'>/</span><span class='va'>h</span>,<span class='va'>nu</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, order.by <span class='op'>=</span> <span class='va'>time_t</span><span class='op'>)</span></span>
<span><span class='co'># Sample path a scaled t-Levy process J_t</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>J_t</span> <span class='op'>&lt;-</span> <span class='va'>Z_t</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>nu</span><span class='op'>)</span></span>
<span><span class='co'># Sample path of a t-Levy regression model</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='va'>mu1</span> <span class='op'>*</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>mu2</span> <span class='op'>*</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>scale</span> <span class='op'>*</span> <span class='va'>J_t</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>data1_a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>X1</span>, <span class='va'>X2</span>, <span class='va'>Y</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We observe that, as highlighted in Section 3.1, the <a href="https://cran.r-project.org/package=yuima">yuima</a> method <code>rand</code> returns the increments of a <span class="math inline">\(t\)</span>-Lévy process <span class="math inline">\(Z_t\)</span>. To obtain the trajectory of the scaled <span class="math inline">\(t\)</span>-Lévy process <span class="math inline">\(J_t\)</span> in <a href="#eq:Regr1">(16)</a>, the process <span class="math inline">\(Z_t\)</span> needs to be rescaled by the factor <span class="math inline">\(\sqrt{\nu}\)</span>.
The estimation is performed by means of the method <code>estimation_LRM</code> as in the previous example.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> est1_a <span class="ot">&lt;-</span> <span class="fu">estimation_LRM</span>(<span class="at">start =</span> start, <span class="at">model =</span> Mod1, <span class="at">data =</span> <span class="fu">setData</span>(data1_a),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">upper =</span> upper, <span class="at">lower =</span> lower, <span class="at">PT =</span> Bn)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">summary</span>(est1_a)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Quasi<span class="sc">-</span>Maximum likelihood estimation</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">estimation_LRM</span>(<span class="at">start =</span> start, <span class="at">model =</span> Mod1, <span class="at">data =</span> <span class="fu">setData</span>(data1_a),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> upper, <span class="at">lower =</span> lower, <span class="at">PT =</span> Bn)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        Estimate Std. Error</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>mu1     <span class="fl">4.987778</span> <span class="fl">0.03642823</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>mu2    <span class="sc">-</span><span class="fl">1.164138</span> <span class="fl">0.18558422</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">2.495930</span> <span class="fl">0.12888927</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>nu      <span class="fl">2.407683</span> <span class="fl">0.41221590</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> log L<span class="sc">:</span> <span class="fl">3232.784</span> <span class="fl">85.32438</span></span></code></pre></div>
</div>
<p>Using the result stored in the <code>summary</code> we can construct a confidence interval using the command lines reported below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> info_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(est1_a)<span class="sc">@</span>coef</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> alpha <span class="ot">&lt;-</span> <span class="fl">0.025</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Confidence_Int_95 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(info_sum[,<span class="dv">1</span>]<span class="sc">+</span>info_sum[,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">qnorm</span>(alpha),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     info_sum[,<span class="dv">1</span>]<span class="sc">+</span>info_sum[,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha),<span class="fu">unlist</span>(true.par),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     info_sum[,<span class="dv">1</span>])</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">rownames</span>(Confidence_Int_95) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;LB&quot;</span>,<span class="st">&quot;UB&quot;</span>,<span class="st">&quot;True_par&quot;</span>,<span class="st">&quot;Est_par&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">print</span>(Confidence_Int_95, <span class="at">digit =</span> <span class="dv">4</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>           mu1      mu2  sigma0     nu</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>LB       <span class="fl">4.916</span>  <span class="sc">-</span><span class="fl">1.5279</span>   <span class="fl">2.243</span>  <span class="fl">1.600</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>UB       <span class="fl">5.059</span>  <span class="sc">-</span><span class="fl">0.8004</span>   <span class="fl">2.749</span>  <span class="fl">3.216</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>True_par <span class="fl">5.000</span>  <span class="sc">-</span><span class="fl">1.0000</span>   <span class="fl">3.000</span>  <span class="fl">3.000</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>Est_par  <span class="fl">4.988</span>  <span class="sc">-</span><span class="fl">1.1641</span>   <span class="fl">2.496</span>  <span class="fl">2.408</span></span></code></pre></div>
</div>
<p>Based on the aforementioned examples, the estimated value for the <span class="math inline">\(\sigma\)</span> parameter deviates from its true value. To further investigate this observation, we conducted a comparative analysis using the three integration methods discussed in Section 3.1. This exercise was repeated for three different values of <span class="math inline">\(h= 0.01, 0.005\)</span> and <span class="math inline">\(\frac{1}{365}\)</span>. To ensure a fair comparison among the Laguerre, Cosine Series expansion, and Fast Fourier Transform methods, we set the argument <code>N = 180</code>. The obtained results are presented in Table <a href="#tab:CompN180">2</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:CompN180">Table 2: </span>Estimated parameters for <span class="math inline">\(h = 0.01, 0.005, 1/365\)</span> and different integration methods. The number of points for the inversion of the characteristic function is <span class="math inline">\(N=180\)</span>. The parenthesis shows the asymptotic standard error. The last row reports the seconds necessary for the simulation of a sample path.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Laguerre Method
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
COS Method
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FFT Method
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:center;">
Lag_0.01
</th>
<th style="text-align:center;">
Lag_0.005
</th>
<th style="text-align:center;">
Lag_1_365
</th>
<th style="text-align:center;">
COS_0.01
</th>
<th style="text-align:center;">
COS_0.005
</th>
<th style="text-align:center;">
COS_1_365
</th>
<th style="text-align:center;">
FFT_0.01
</th>
<th style="text-align:center;">
FFT_0.005
</th>
<th style="text-align:center;">
FFT_1_365
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\hat{\mu_1}\)</span>
</td>
<td style="text-align:center;">
4.968
</td>
<td style="text-align:center;">
5.019
</td>
<td style="text-align:center;">
4.976
</td>
<td style="text-align:center;">
4.939
</td>
<td style="text-align:center;">
5.065
</td>
<td style="text-align:center;">
4.875
</td>
<td style="text-align:center;">
4.934
</td>
<td style="text-align:center;">
5.069
</td>
<td style="text-align:center;">
4.876
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.029)
</td>
<td style="text-align:center;">
(0.020)
</td>
<td style="text-align:center;">
(0.014)
</td>
<td style="text-align:center;">
(0.041)
</td>
<td style="text-align:center;">
(0.049)
</td>
<td style="text-align:center;">
(0.054)
</td>
<td style="text-align:center;">
(0.042)
</td>
<td style="text-align:center;">
(0.049)
</td>
<td style="text-align:center;">
(0.054)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\hat{\mu_2}\)</span>
</td>
<td style="text-align:center;">
-1.065
</td>
<td style="text-align:center;">
-1.044
</td>
<td style="text-align:center;">
-0.914
</td>
<td style="text-align:center;">
-1.192
</td>
<td style="text-align:center;">
-1.195
</td>
<td style="text-align:center;">
-0.555
</td>
<td style="text-align:center;">
-1.179
</td>
<td style="text-align:center;">
-1.178
</td>
<td style="text-align:center;">
-0.528
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.146)
</td>
<td style="text-align:center;">
(0.104)
</td>
<td style="text-align:center;">
(0.074)
</td>
<td style="text-align:center;">
(0.210)
</td>
<td style="text-align:center;">
(0.247)
</td>
<td style="text-align:center;">
(0.277)
</td>
<td style="text-align:center;">
(0.213)
</td>
<td style="text-align:center;">
(0.248)
</td>
<td style="text-align:center;">
(0.277)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\hat{\sigma_0}\)</span>
</td>
<td style="text-align:center;">
2.770
</td>
<td style="text-align:center;">
2.794
</td>
<td style="text-align:center;">
2.657
</td>
<td style="text-align:center;">
3.993
</td>
<td style="text-align:center;">
6.654
</td>
<td style="text-align:center;">
10.010
</td>
<td style="text-align:center;">
4.055
</td>
<td style="text-align:center;">
6.674
</td>
<td style="text-align:center;">
10.010
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.101)
</td>
<td style="text-align:center;">
(0.072)
</td>
<td style="text-align:center;">
(0.051)
</td>
<td style="text-align:center;">
(0.145)
</td>
<td style="text-align:center;">
(0.172)
</td>
<td style="text-align:center;">
(0.192)
</td>
<td style="text-align:center;">
(0.148)
</td>
<td style="text-align:center;">
(0.172)
</td>
<td style="text-align:center;">
(0.193)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\hat{\nu}\)</span>
</td>
<td style="text-align:center;">
3.462
</td>
<td style="text-align:center;">
3.281
</td>
<td style="text-align:center;">
3.067
</td>
<td style="text-align:center;">
2.827
</td>
<td style="text-align:center;">
2.223
</td>
<td style="text-align:center;">
2.227
</td>
<td style="text-align:center;">
5.749
</td>
<td style="text-align:center;">
8.310
</td>
<td style="text-align:center;">
15.175
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.615)
</td>
<td style="text-align:center;">
(0.580)
</td>
<td style="text-align:center;">
(0.538)
</td>
<td style="text-align:center;">
(0.492)
</td>
<td style="text-align:center;">
(0.377)
</td>
<td style="text-align:center;">
(0.378)
</td>
<td style="text-align:center;">
(1.063)
</td>
<td style="text-align:center;">
(1.571)
</td>
<td style="text-align:center;">
(2.940)
</td>
</tr>
<tr>
<td style="text-align:left;">
sec. 
</td>
<td style="text-align:center;">
2.07
</td>
<td style="text-align:center;">
2.02
</td>
<td style="text-align:center;">
2.07
</td>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
1.24
</td>
<td style="text-align:center;">
1.34
</td>
<td style="text-align:center;">
0.15
</td>
<td style="text-align:center;">
0.24
</td>
<td style="text-align:center;">
0.39
</td>
</tr>
</tbody>
</table>
</div>
<p>In the Laguerre method, we observe that reducing the step size <span class="math inline">\(h\)</span> leads to improved estimates of <span class="math inline">\(\nu\)</span>, however looking at the asymptotic standard error, the estimates for <span class="math inline">\(\sigma_0\)</span> seem to maintain the bias. As for the remaining methods, the estimates exhibit unsatisfactory performance due to the imposed restriction of <code>N = 180</code> (that is the maximum value allowed for the Laguerre quadrature in the evaluation of the density in <a href="#eq:InvForLM">(6)</a>). This outcome is not unexpected, given the Laguerre method’s ability to yield a valid distribution even with a relatively small value of <code>N</code>, as demonstrated in Figure <a href="#fig:CDFComparisonnu3h001">3</a>. Nevertheless for the <code>COS</code> and the <code>FFT</code>, it is possible to enhance the results by increasing the value of the argument <code>N</code> that yields a more accurate result in the simulation of the sample path for the model described in <a href="#eq:Regr1">(16)</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:Comph365">Table 3: </span>Estimated parameters for <span class="math inline">\(N = 1000, 5000, 10^4\)</span> in the and the methods. The step size <span class="math inline">\(h\)</span> is <span class="math inline">\(1/365\)</span>. The parenthesis shows the asymptotic standard error. The last row reports the seconds necessary for the simulation of a sample path.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
COS Method
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
FFT Method
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:center;">
COS_1000
</th>
<th style="text-align:center;">
COS_5000
</th>
<th style="text-align:center;">
COS_10000
</th>
<th style="text-align:center;">
FFT_1000
</th>
<th style="text-align:center;">
FFT_5000
</th>
<th style="text-align:center;">
FFT_10000
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mu_1\)</span>
</td>
<td style="text-align:center;">
4.968
</td>
<td style="text-align:center;">
4.975
</td>
<td style="text-align:center;">
4.975
</td>
<td style="text-align:center;">
4.968
</td>
<td style="text-align:center;">
4.975
</td>
<td style="text-align:center;">
4.975
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.034)
</td>
<td style="text-align:center;">
(0.016)
</td>
<td style="text-align:center;">
(0.016)
</td>
<td style="text-align:center;">
(0.035)
</td>
<td style="text-align:center;">
(0.306)
</td>
<td style="text-align:center;">
(0.016)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mu_2\)</span>
</td>
<td style="text-align:center;">
-0.887
</td>
<td style="text-align:center;">
-0.909
</td>
<td style="text-align:center;">
-0.909
</td>
<td style="text-align:center;">
-0.886
</td>
<td style="text-align:center;">
-0.908
</td>
<td style="text-align:center;">
-0.908
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.174)
</td>
<td style="text-align:center;">
(0.082)
</td>
<td style="text-align:center;">
(0.082)
</td>
<td style="text-align:center;">
(0.177)
</td>
<td style="text-align:center;">
(0.022)
</td>
<td style="text-align:center;">
(0.082)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma_0\)</span>
</td>
<td style="text-align:center;">
3.300
</td>
<td style="text-align:center;">
2.964
</td>
<td style="text-align:center;">
2.964
</td>
<td style="text-align:center;">
3.363
</td>
<td style="text-align:center;">
2.963
</td>
<td style="text-align:center;">
2.964
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.064)
</td>
<td style="text-align:center;">
(0.057)
</td>
<td style="text-align:center;">
(0.057)
</td>
<td style="text-align:center;">
(0.065)
</td>
<td style="text-align:center;">
(0.057)
</td>
<td style="text-align:center;">
(0.057)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\nu\)</span>
</td>
<td style="text-align:center;">
2.713
</td>
<td style="text-align:center;">
2.765
</td>
<td style="text-align:center;">
2.765
</td>
<td style="text-align:center;">
3.279
</td>
<td style="text-align:center;">
2.760
</td>
<td style="text-align:center;">
2.702
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.470)
</td>
<td style="text-align:center;">
(0.480)
</td>
<td style="text-align:center;">
(0.480)
</td>
<td style="text-align:center;">
(0.579)
</td>
<td style="text-align:center;">
(0.479)
</td>
<td style="text-align:center;">
(0.468)
</td>
</tr>
<tr>
<td style="text-align:left;">
sec. 
</td>
<td style="text-align:center;">
3.49
</td>
<td style="text-align:center;">
14.83
</td>
<td style="text-align:center;">
33.70
</td>
<td style="text-align:center;">
0.38
</td>
<td style="text-align:center;">
0.44
</td>
<td style="text-align:center;">
0.45
</td>
</tr>
</tbody>
</table>
</div>
<p>Table <a href="#tab:Comph365">3</a> shows the estimated parameters for the varying value of <code>N</code> and <span class="math inline">\(h=1/365\)</span>. As expected increasing the precision in the quadrature improved estimates for both methods. Notably for <code>N</code> <span class="math inline">\(\geq\)</span> 5000, all estimates fall within the asymptotic confidence interval at the <span class="math inline">\(95\%\)</span> level.</p>
<p>This example suggests a possible strategy for selecting the optimal <span class="math inline">\(N\)</span> for the grid defined in <a href="#eq:omegagrid">(14)</a>, particularly when
<span class="math inline">\(h=\frac{1}{365}\)</span> (commonly used for daily data). The strategy consists of the following steps:</p>
<ul>
<li>Estimate the model using Laguerre quadrature with the maximum allowable polynomial order (180).</li>
<li>Using the estimates from the previous step as an initial guess, re-estimate the model using the <code>FFT</code> method with <span class="math inline">\(N=500\)</span>. If the resulting estimates are sufficiently close to those obtained in the previous step, stop.</li>
<li>Otherwise, using the Laguerre estimates as the initial guess, double the number of intervals in the grid in <a href="#eq:omegagrid">(14)</a> and re-estimate the model using the <code>FFT</code>. Repeat this process until two successive estimates are sufficiently close. The Euclidean norm can be used to determine whether the estimates are sufficiently close.</li>
</ul>
<h3 data-number="4.2" id="aa"><span class="header-section-number">4.2</span> Model with integrated stochastic regressors</h3>
<p>In this section, we consider two examples whose regressors are stochastic.
Moreover, to satisfy the regularity conditions, the regressors are supposed to be an integrated version of stochastic processes.</p>
<h5 class="unnumbered" data-number="4.2.0.1" id="example-1">Example 1</h5>
<p>In this example, we consider the following continuous time regression model with a single regressor:
<span class="math display" id="eq:yuex1">\[\begin{equation}
Y_t=\mu \int_0^t X_{u}du+\sigma J_t, \quad J_1\sim t_\nu,
\tag{18}
\end{equation}\]</span>
with the true values <span class="math inline">\((\mu_0,\sigma_0,\nu_0)=(-3,3,2.5)\)</span>, and the process <span class="math inline">\(X\)</span> is supposed to be the Lévy driven Ornstein-Uhlenbeck process defined as:
<span class="math display">\[\begin{equation}
\nonumber dX_t= -X_tdt+ 2dZ_t,
\end{equation}\]</span>
where the driving noise <span class="math inline">\(Z\)</span> is the Lévy process with <span class="math inline">\(Z_1\sim\text{NIG}(1,0,1,0)\)</span>.
The normal inverse Gaussian (NIG) random variable is defined as the normal-mean variance mixture of the inverse Gaussian random variable, and the probability density function of <span class="math inline">\(Z_t\sim \text{NIG}(\alpha,\beta,\delta t,\mu t)\)</span> is given by
<span class="math display">\[\begin{equation*}
x\mapsto
\frac{\alpha\delta t\exp\{\delta t\sqrt{\alpha^{2}-\beta^{2}}+\beta(x-\mu t)\} K_{1}(\alpha \psi(x;\delta t,\mu t))}{\pi \psi(x;\delta t,\mu t)}
\end{equation*}\]</span>
where <span class="math inline">\(\alpha^2:=\gamma^2+\beta^2\)</span> and <span class="math inline">\(\psi(x;\delta t,\mu t):=\sqrt{(\delta t)^{2}+(x-\mu t)^{2}}\)</span>.
More detailed theoretical properties of the NIG-Lévy process are given for example in .</p>
<p>For the simulation by <a href="https://cran.r-project.org/package=yuima">yuima</a>, we formally introduce the following system:
<span class="math display">\[\begin{equation}
d\Bigg[\begin{array}{c} X_{1,t}\\ X_{2,t}\end{array}\Bigg]=\Bigg[\begin{array}{c} X_{2,t}\\ -X_{2,t}\end{array}\Bigg]dt+\Bigg[\begin{array}{c} 0\\ 2\end{array}\Bigg]dZ_t,
\end{equation}\]</span>
with the initial condition:
<span class="math display">\[
X_{1,0}=0, \ X_{2,0}=0.
\]</span>
The process <span class="math inline">\(X_{1,t}\)</span> corresponds to the regressor <span class="math inline">\(\int_0^{t}X_{u}du\)</span> in the regression model <a href="#eq:yuex1">(18)</a>.
Due to the specification of the new <a href="https://cran.r-project.org/package=yuima">yuima</a> function, we will additionally construct the ``full” model:
<span class="math display" id="eq:yuex1f">\[\begin{equation}
Y_t=\mu_1 X_{1,t}+\mu_2 X_{2,t}+\sigma J_t, \quad J_1\sim t_\nu,
\tag{19}
\end{equation}\]</span>
and simulate the trajectory of <span class="math inline">\(Y\)</span> with <span class="math inline">\(\mu_2=0\)</span>.
After that, we will estimate the parameters <span class="math inline">\((\mu_1,\sigma,\nu)\)</span> by the original model <a href="#eq:yuex1">(18)</a>.
From now on, we show the implementation of this model in <a href="https://cran.r-project.org/package=yuima">yuima</a>.
The sampling setting is unchanged from the previous example code:
<span class="math inline">\(h_n=1/50,  n=1/h_n=50,  T_n=50,  B_n=15\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>R</span><span class='op'>&gt;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yuimaproject.com'>yuima</a></span><span class='op'>)</span></span>
<span><span class='co'>##########</span></span>
<span><span class='co'># Inputs #</span></span>
<span><span class='co'>##########</span></span>
<span><span class='co'># Inputs for Fourier Inversion</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>method_Fourier</span> <span class='op'>=</span> <span class='st'>"FFT"</span>; <span class='va'>up</span> <span class='op'>=</span> <span class='fl'>6</span>; <span class='va'>low</span> <span class='op'>=</span> <span class='op'>-</span><span class='fl'>6</span>; <span class='va'>N</span> <span class='op'>=</span> <span class='fl'>2</span><span class='op'>^</span><span class='fl'>17</span>; <span class='va'>N_grid</span> <span class='op'>=</span> <span class='fl'>60000</span></span>
<span></span>
<span><span class='co'># Inputs for the sample grid time</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Factor</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Factor1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>initial</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>; <span class='va'>Final_Time</span> <span class='op'>&lt;-</span> <span class='fl'>50</span> <span class='op'>*</span> <span class='va'>Factor</span>; <span class='va'>h</span> <span class='op'>&lt;-</span> <span class='fl'>0.02</span><span class='op'>/</span><span class='va'>Factor1</span></span></code></pre>
</div>
</div>
<p>The role of the variable <code>Factor1</code> is the same as in the previous section.
By using the constructor <code>setLaw_th</code>, we define <code>yuima.th-class</code> in a similar manner.
After that, we construct the ``full” model <a href="#eq:yuex1f">(19)</a> by the constructors <code>setModel</code> and <code>setLRM</code>.
A trajectory of <span class="math inline">\(Y\)</span> and its regressors can be simulated by the YUIMA method <code>simulate</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Regressor: Integrated NIG-Levy driven OU process #</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> mu1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span>; mu2 <span class="ot">&lt;-</span> <span class="dv">0</span>;  scale <span class="ot">&lt;-</span> <span class="dv">3</span>; nu <span class="ot">&lt;-</span> <span class="fl">2.5</span> <span class="co"># Model Parameters</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Definition</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> lawILOU <span class="ot">&lt;-</span> <span class="fu">setLaw_th</span>(<span class="at">method =</span> method_Fourier, <span class="at">up =</span> up, <span class="at">low =</span> low, <span class="at">N =</span> N,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">N_grid =</span> N_grid) <span class="co"># yuima.th</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> regrILOU <span class="ot">&lt;-</span> <span class="fu">setModel</span>(<span class="at">drift =</span> <span class="fu">c</span>(<span class="st">&quot;X2&quot;</span>, <span class="st">&quot;-X2&quot;</span>), <span class="at">jump.coeff =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;2&quot;</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">solve.variable =</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>), <span class="at">xinit =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">measure.type =</span> <span class="st">&quot;code&quot;</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">measure =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="st">&quot;rNIG(z, 1, 0, 1, 0)&quot;</span>)) <span class="co"># Regressors definition</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># t-Regression model</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> ModILOU <span class="ot">&lt;-</span> <span class="fu">setLRM</span>(<span class="at">unit_Levy =</span> lawILOU, <span class="at">yuima_regressors =</span> regrILOU)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> sampILOU <span class="ot">&lt;-</span> <span class="fu">setSampling</span>(initial, Final_Time, <span class="at">n =</span> Final_Time<span class="sc">/</span>h)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> true.parILOU <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">list</span>(<span class="at">mu1 =</span> mu1, <span class="at">mu2 =</span> mu2, <span class="at">sigma0 =</span> scale, <span class="at">nu =</span> nu))</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> simILOU <span class="ot">&lt;-</span> <span class="fu">simulate</span>(ModILOU, <span class="at">true.parameter =</span> true.parILOU, <span class="at">sampling =</span> sampILOU)</span></code></pre></div>
</div>
<p>Next we extract the trajectories of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_{1}\)</span> from the <code>yuima.LevyRM-class</code>: <code>simILOU</code> and construct the new model for the estimation of the parameters.
Figure <a href="#fig:SimulationMod2">5</a> shows the simulated sample paths for the regressor and the response process <span class="math inline">\(Y\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SimulationMod2"></span>
<img src="figures/Simulation_Mod2.png" alt="Simulated Trajectory of the Student Lévy Regression model defined in \@ref(eq:yuex1)" width="100%" />
<p class="caption">
Figure 5: Simulated Trajectory of the Student Lévy Regression model defined in <a href="#eq:yuex1">(18)</a>
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data extraction</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Dataset <span class="ot">&lt;-</span> <span class="fu">get.zoo.data</span>(simILOU)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> newData <span class="ot">&lt;-</span> Dataset[<span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> newData <span class="ot">&lt;-</span> <span class="fu">merge</span>(newData<span class="sc">$</span>X1, newData<span class="sc">$</span>Y)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">colnames</span>(newData) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">plot</span>(newData)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the model for estimation</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> regrILOU1 <span class="ot">&lt;-</span> <span class="fu">setModel</span>(<span class="at">drift =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>), <span class="at">diffusion =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;0&quot;</span>),<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">solve.variable =</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>), <span class="at">xinit =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="co"># Regressors definition</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># t-Regression model</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> ModILOU1 <span class="ot">&lt;-</span> <span class="fu">setLRM</span>(<span class="at">unit_Levy =</span> lawILOU, <span class="at">yuima_regressors =</span> regrILOU1)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> lower1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="sc">-</span><span class="dv">10</span>,  <span class="at">sigma0 =</span> <span class="fl">0.1</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> upper1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="dv">10</span>, <span class="at">sigma0 =</span> <span class="fl">10.01</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> startILOU1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">sigma0 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.01</span>, <span class="dv">4</span>))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Bn <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">*</span>Factor</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Data1 <span class="ot">&lt;-</span> <span class="fu">setData</span>(newData)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> estILOU1 <span class="ot">&lt;-</span> <span class="fu">estimation_LRM</span>(<span class="at">start =</span> startILOU1, <span class="at">model =</span> ModILOU1, <span class="at">data =</span> Data1,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">upper =</span> upper1, <span class="at">lower =</span> lower1, <span class="at">PT =</span> Bn)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">summary</span>(estILOU1)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>Quasi<span class="sc">-</span>Maximum likelihood estimation</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="fu">estimation_LRM</span>(<span class="at">start =</span> startILOU1, <span class="at">model =</span> ModILOU1, <span class="at">data =</span> Data1,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> upper1, <span class="at">lower =</span> lower1, <span class="at">PT =</span> Bn)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        Estimate Std. Error</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>mu1    <span class="sc">-</span><span class="fl">2.959621</span> <span class="fl">0.02112734</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">2.778659</span> <span class="fl">0.03208519</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>nu      <span class="fl">2.404843</span> <span class="fl">0.13018410</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> log L<span class="sc">:</span> <span class="fl">69711.32</span> <span class="fl">854.3838</span></span></code></pre></div>
</div>
<h5 class="unnumbered" data-number="4.2.0.2" id="example-2">Example 2</h5>
<p>In this example, we consider the following regression model:
<span class="math display" id="eq:yuex2">\[\begin{equation}
Y_t= \mu_1\int_0^t V_{1,u}du+\mu_2\int_0^t V_{2,u}du+\sigma J_t, \ \quad J_1\sim
\tag{20}
t_\nu\end{equation}\]</span>
where the process <span class="math inline">\(X=(V_{1},V_{2})\)</span> satisfy
<span class="math display">\[\begin{align}
&amp;dV_{1,t}=\frac{1}{\epsilon}(V_{1,t}-V_{1,t}^3-V_{2,t}+s)dt,\\
&amp;dV_{2,t}=(\gamma V_{1,t}-V_{2,t}+\alpha)dt+\sigma&#39; dw_t,
\end{align}\]</span>
with
<span class="math display">\[(\epsilon, s, \gamma, \alpha,\sigma&#39;)=(1/3, 0, 3/2, 1/2,2),\]</span>
and standard Wiener process <span class="math inline">\(w\)</span>.
We set the true values
<span class="math display">\[(\mu_{1,0},\mu_{2,0},\sigma_0,\nu_0)=(8,-4,8,3).\]</span>
The process <span class="math inline">\(V\)</span> is the so-called stochastic FitzHugh-Nagumo process which is a classical model for describing a neuron; <span class="math inline">\(V_{1}\)</span> expresses the membrane potential of the neuron and <span class="math inline">\(V_{2}\)</span> represents a recovery variable.
Its theoretical properties such as hypoellipticity, and Feller and mixing properties are well summarized in <span class="citation" data-cites="LeoSam18">León and Samson (<a href="#ref-LeoSam18" role="doc-biblioref">2018</a>)</span>.
The paper also provides a nonparametric estimator of the invariant density and spike rate.
Similarly, other integrated degenerate diffusion can be considered as regressors.
Its ergodicity for the regularity conditions is studied for example in <span class="citation" data-cites="Wu01">Wu (<a href="#ref-Wu01" role="doc-biblioref">2001</a>)</span>.
For the statistical inference for degenerate diffusion processes, we refer to <span class="citation" data-cites="DitSam19">Ditlevsen and Samson (<a href="#ref-DitSam19" role="doc-biblioref">2019</a>)</span> and <span class="citation" data-cites="GloYos21">Gloter and Yoshida (<a href="#ref-GloYos21" role="doc-biblioref">2021</a>)</span>.</p>
<p>For the implementation of the regression model <a href="#eq:yuex2">(20)</a> on YUIMA, we formally consider the following dynamics:
<span class="math display">\[\begin{equation}
d\left[\begin{array}{c} V_{1,t}\\ V_{2,t}\\ V_{3,t}\\ V_{4,t}\end{array}\right]=\left[\begin{array}{c} V_{3,t}\\ V_{4,t}\\ 3(V_{3,t}-V_{3,t}^3-V_{4,t})\\ \frac{3}{2}V_{3,t}-V_{4,t}+\frac{1}{2}\end{array}\right]dt+\left[\begin{array}{c} 0\\ 0\\0\\2\end{array}\right]dw_t,
\end{equation}\]</span>
with the initial condition:
<span class="math display">\[
V_{1,0}=0, \ V_{2,0}=0, \ V_{3,0}=0, \ V_{4,0}=0.
\]</span>
The first and second elements correspond to the regressor in <a href="#eq:yuex2">(20)</a>.
As in the previous example, we first simulate data by the ``full” model defined as:
<span class="math display">\[\begin{equation}
Y_t=\mu_1 V_{1,t}+\mu_2V_{2,t}+\mu_3V_{3,t}+\mu_4V_{4,t}+\sigma J_t,\quad J_1\sim t_\nu,
\end{equation}\]</span>
with <span class="math inline">\(\mu_3=\mu_4=0\)</span>, and after that, we extract the simulated data and estimate the parameters based on the original regression model <a href="#eq:yuex2">(20)</a>.
Below we show how to implement on <a href="https://cran.r-project.org/package=yuima">yuima</a>.
In this example, we set <span class="math inline">\(h_n=1/200, n=1/h_n=200, T_n=1000, B_n=300\)</span>.
The values of them are controlled by the variables <code>Factor</code> and <code>Factor1</code> in the example code.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">library</span>(yuima)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="do">##########</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs #</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">##########</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs for Fourier Inversion</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> method_Fourier <span class="ot">=</span> <span class="st">&quot;FFT&quot;</span>; up <span class="ot">=</span> <span class="dv">6</span>; low <span class="ot">=</span> <span class="sc">-</span><span class="dv">6</span>; N <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">17</span>; N_grid <span class="ot">=</span> <span class="dv">60000</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs for the sample grid time</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Factor <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Factor1 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> initial <span class="ot">&lt;-</span> <span class="dv">0</span>; Final_Time <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">*</span> Factor; h <span class="ot">&lt;-</span> <span class="fl">0.02</span><span class="sc">/</span>Factor1</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Regressor: Integrated stochastic FitzHugh-Nagumo process #</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> mu1 <span class="ot">&lt;-</span> <span class="dv">8</span>; mu2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span>; mu3 <span class="ot">&lt;-</span> <span class="dv">0</span>; mu4 <span class="ot">&lt;-</span> <span class="dv">0</span>;  scale <span class="ot">&lt;-</span> <span class="dv">8</span>; nu <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Model Parameters</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Definition</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> lawFN <span class="ot">&lt;-</span> <span class="fu">setLaw_th</span>(<span class="at">method =</span> method_Fourier, <span class="at">up =</span> up, <span class="at">low =</span> low,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">N =</span> N, <span class="at">N_grid =</span> N_grid) <span class="co"># yuima.th</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> regrFN <span class="ot">&lt;-</span> <span class="fu">setModel</span>(<span class="at">drift =</span> <span class="fu">c</span>(<span class="st">&quot;V3&quot;</span>, <span class="st">&quot;V4&quot;</span>, <span class="st">&quot;3*(V3-V3^3-V4)&quot;</span>, <span class="st">&quot;1.5*V3-V4+0.5&quot;</span>),</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">diffusion =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;2&quot;</span>),<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">solve.variable =</span> <span class="fu">c</span>(<span class="st">&quot;V1&quot;</span>,<span class="st">&quot;V2&quot;</span>, <span class="st">&quot;V3&quot;</span>, <span class="st">&quot;V4&quot;</span>),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">xinit =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) <span class="co"># Regressors definition</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> ModFN <span class="ot">&lt;-</span> <span class="fu">setLRM</span>(<span class="at">unit_Levy =</span> lawFN, <span class="at">yuima_regressors =</span> regrFN) <span class="co">#  t-regression model</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> sampFN <span class="ot">&lt;-</span> <span class="fu">setSampling</span>(initial, Final_Time, <span class="at">n =</span> Final_Time<span class="sc">/</span>h)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> true.parFN <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">list</span>(<span class="at">mu1 =</span> mu1, <span class="at">mu2 =</span> mu2, <span class="at">mu3 =</span> mu3, <span class="at">mu4 =</span> mu4,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">sigma0 =</span> scale, <span class="at">nu =</span> nu))</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> simFN <span class="ot">&lt;-</span> <span class="fu">simulate</span>(ModFN, <span class="at">true.parameter =</span> true.parFN, <span class="at">sampling =</span> sampFN)</span></code></pre></div>
</div>
<p>In this example, both <code>Factor</code> and <code>Factor1</code> are larger than the previous example, and hence it takes a higher computational load than the previous one.
Figure <a href="#fig:SimulationMod3">6</a> shows the simulated sample paths for the regressor and the Student Lévy Regression model <span class="math inline">\(Y\)</span>.
Now we move on to the estimation phase.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:SimulationMod3"></span>
<img src="figures/Simulation_Mod3.png" alt="Simulated Trajectory of the Student Lévy Regression model defined in \@ref(eq:yuex2)." width="100%" />
<p class="caption">
Figure 6: Simulated Trajectory of the Student Lévy Regression model defined in <a href="#eq:yuex2">(20)</a>.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Dataset <span class="ot">&lt;-</span> <span class="fu">get.zoo.data</span>(simFN)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> newData <span class="ot">&lt;-</span> Dataset[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> newData <span class="ot">&lt;-</span> <span class="fu">merge</span>(newData<span class="sc">$</span>X1,newData<span class="sc">$</span>X2, newData<span class="sc">$</span>Y)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">colnames</span>(newData) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">plot</span>(newData)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the model for estimation</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> regrFN1 <span class="ot">&lt;-</span> <span class="fu">setModel</span>(<span class="at">drift =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;0&quot;</span>), <span class="at">diffusion =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;0&quot;</span>),<span class="dv">2</span>,<span class="dv">1</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">solve.variable =</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>), <span class="at">xinit =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="co"># Regressors definition</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> ModFN1 <span class="ot">&lt;-</span> <span class="fu">setLRM</span>(<span class="at">unit_Levy =</span> lawFN, <span class="at">yuima_regressors =</span> regrFN1) <span class="co"># t-Regression model.</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> lower1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">mu2 =</span> <span class="sc">-</span><span class="dv">10</span>,  <span class="at">sigma0 =</span> <span class="fl">0.1</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> upper1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="dv">10</span>, <span class="at">mu2 =</span><span class="dv">10</span>, <span class="at">sigma0 =</span> <span class="fl">10.01</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> startFN1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">mu2 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">sigma0 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.01</span>, <span class="dv">4</span>))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Bn <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">*</span>Factor</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> Data1 <span class="ot">&lt;-</span> <span class="fu">setData</span>(newData)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> estFN1 <span class="ot">&lt;-</span> <span class="fu">estimation_LRM</span>(<span class="at">start =</span> startFN1, <span class="at">model =</span> ModFN1, <span class="at">data =</span> Data1,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">upper =</span> upper1, <span class="at">lower =</span> lower1, <span class="at">PT =</span> Bn)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">summary</span>(estFN1)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>Quasi<span class="sc">-</span>Maximum likelihood estimation</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="fu">estimation_LRM</span>(<span class="at">start =</span> startFN1, <span class="at">model =</span> ModFN1, <span class="at">data =</span> Data1,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> upper1, <span class="at">lower =</span> lower1, <span class="at">PT =</span> Bn)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        Estimate Std. Error</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>mu1     <span class="fl">8.041838</span> <span class="fl">0.04895791</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>mu2    <span class="sc">-</span><span class="fl">4.041518</span> <span class="fl">0.04495255</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">7.712157</span> <span class="fl">0.04452616</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>nu      <span class="fl">3.020972</span> <span class="fl">0.11837331</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> log L<span class="sc">:</span> <span class="fl">403960.9</span> <span class="fl">1291.516</span></span></code></pre></div>
</div>
<h3 data-number="4.3" id="real-data-regressors"><span class="header-section-number">4.3</span> Real data regressors</h3>
<p>In this section, we show how to use the <a href="https://cran.r-project.org/package=yuima">yuima</a> package for the estimation of a Student Lévy Regression model in a real dataset. We consider a model where the daily price of the Standard and Poor 500 Index is explained by the VIX index and two currency rates: the YEN-USD and the Euro Usd rates. The dataset was provided by <code>Yahoo.finance</code> and ranges from
December 14th 2014 to May 12th 2023. We downloaded the data using the function <code>getSymbol</code> available in <code>quantmod</code> library. To consider a small value for the step size <span class="math inline">\(h\)</span> we estimate our model every month <span class="math inline">\(h=1/30\)</span>. We report below the code for storing the market data in an object of <code>yuima.data-class</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>R</span><span class='op'>&gt;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yuimaproject.com'>yuima</a></span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.quantmod.com/'>quantmod</a></span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/pkg/quantmod/man/getSymbols.html'>getSymbols</a></span><span class='op'>(</span><span class='st'>"^SPX"</span>, from <span class='op'>=</span> <span class='st'>"2014-12-04"</span>, to <span class='op'>=</span> <span class='st'>"2023-05-12"</span><span class='op'>)</span></span>
<span><span class='co'># Regressors</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/pkg/quantmod/man/getSymbols.html'>getSymbols</a></span><span class='op'>(</span><span class='st'>"EURUSD=X"</span>, from <span class='op'>=</span> <span class='st'>"2014-12-04"</span>, to <span class='op'>=</span> <span class='st'>"2023-05-12"</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/pkg/quantmod/man/getSymbols.html'>getSymbols</a></span><span class='op'>(</span><span class='st'>"VIX"</span>, from <span class='op'>=</span> <span class='st'>"2014-12-04"</span>, to <span class='op'>=</span> <span class='st'>"2023-05-12"</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/pkg/quantmod/man/getSymbols.html'>getSymbols</a></span><span class='op'>(</span><span class='st'>"JPYUSD=X"</span>, from <span class='op'>=</span> <span class='st'>"2014-12-04"</span>, to <span class='op'>=</span> <span class='st'>"2023-05-12"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>SP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/zoo.html'>zoo</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>SPX</span><span class='op'>$</span><span class='va'>SPX.Close</span>, order.by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>SPX</span><span class='op'>$</span><span class='va'>SPX.Close</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Vix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/zoo.html'>zoo</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>VIX</span><span class='op'>$</span><span class='va'>VIX.Close</span><span class='op'>/</span><span class='fl'>1000</span>, order.by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>VIX</span><span class='op'>$</span><span class='va'>VIX.Close</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>EURUSD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/zoo.html'>zoo</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>`EURUSD=X`</span><span class='op'>[</span>,<span class='fl'>4</span><span class='op'>]</span>, order.by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>`EURUSD=X`</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>JPYUSD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/zoo.html'>zoo</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>`JPYUSD=X`</span><span class='op'>[</span>,<span class='fl'>4</span><span class='op'>]</span>, order.by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>`JPYUSD=X`</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/na.approx.html'>na.approx</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>Vix</span>, <span class='va'>EURUSD</span>, <span class='va'>JPYUSD</span>, <span class='va'>SP</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"VIX"</span>, <span class='st'>"EURUSD"</span>, <span class='st'>"JPYUSD"</span>, <span class='st'>"SP"</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>days</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span></span>
<span><span class='co'># equally spaced grid time data</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/zoo.html'>zoo</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span>, order.by <span class='op'>=</span> <span class='va'>days</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>Data_eq</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/na.approx.html'>na.approx</a></span><span class='op'>(</span><span class='va'>Data</span>, xout <span class='op'>=</span> <span class='va'>days</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>:</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>days</span>,<span class='fl'>1L</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>R</span><span class='op'>&gt;</span> <span class='va'>yData</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/yuima/man/setData.html'>setData</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/zoo.html'>zoo</a></span><span class='op'>(</span><span class='va'>Data_eq</span>, order.by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/zoo/man/index.html'>index</a></span><span class='op'>(</span><span class='va'>Data_eq</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Data on monthly basis</span></span></code></pre>
</div>
</div>
<p>We decided to work with log-price (see <code>Data</code> variable in the above code) to have quantities defined on the same support of a Student-<span class="math inline">\(t\)</span> Lévy process, i.e.: the real line. Since the estimation method in <a href="https://cran.r-project.org/package=yuima">yuima</a> requires that the data are observed on an equally spaced grid time, we interpolate linearly to estimate possible missing data to get a log price for each day. Figure <a href="#fig:RealDataset">7</a> shows the trajectory for each financial series.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:RealDataset"></span>
<img src="figures/RealDataset.png" alt="Financial data observed on a monthly equally grid time ranging from December 14th 2014 to May 12th 2023." width="100%" />
<p class="caption">
Figure 7: Financial data observed on a monthly equally grid time ranging from December 14th 2014 to May 12th 2023.
</p>
</div>
</div>
<p>To estimate the model we perform the same steps discussed in the previous examples and we report below the code for reproducing our result.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs for integration in the inversion formula</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> method_Fourier <span class="ot">&lt;-</span> <span class="st">&quot;FFT&quot;</span>; up <span class="ot">&lt;-</span> <span class="dv">6</span>; low <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">6</span>; N <span class="ot">&lt;-</span> <span class="dv">10000</span>; N_grid <span class="ot">&lt;-</span> <span class="dv">60000</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Definition</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> law <span class="ot">&lt;-</span> <span class="fu">setLaw_th</span>(<span class="at">method =</span> method_Fourier, <span class="at">up =</span> up, <span class="at">low =</span> low, <span class="at">N =</span> N,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">N_grid =</span> N_grid)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> regr <span class="ot">&lt;-</span> <span class="fu">setModel</span>(<span class="at">drift =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;0&quot;</span>), <span class="at">diffusion =</span> <span class="fu">matrix</span>(<span class="st">&quot;0&quot;</span>,<span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">solve.variable =</span> <span class="fu">c</span>(<span class="st">&quot;VIX&quot;</span>, <span class="st">&quot;EURUSD&quot;</span>, <span class="st">&quot;JPYUSD&quot;</span>), <span class="at">xinit =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>Mod <span class="ot">&lt;-</span> <span class="fu">setLRM</span>(<span class="at">unit_Levy =</span> law, <span class="at">yuima_regressors =</span> regr, <span class="at">LevyRM =</span> <span class="st">&quot;SP&quot;</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> lower <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="sc">-</span><span class="dv">100</span>, <span class="at">mu2 =</span> <span class="sc">-</span><span class="dv">200</span>, <span class="at">mu3 =</span> <span class="sc">-</span><span class="dv">100</span>,  <span class="at">sigma0 =</span> <span class="fl">0.01</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> upper <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="dv">100</span>, <span class="at">mu2 =</span> <span class="dv">100</span>, <span class="at">mu3 =</span> <span class="dv">100</span>, <span class="at">sigma0 =</span> <span class="fl">200.01</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> start <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>), <span class="at">mu2 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">mu3 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>), <span class="at">sigma0 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.01</span>, <span class="dv">100</span>))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> est <span class="ot">&lt;-</span> <span class="fu">estimation_LRM</span>(<span class="at">start =</span> start, <span class="at">model =</span> Mod, <span class="at">data =</span> yData, <span class="at">upper =</span> upper,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    <span class="at">lower =</span> lower, <span class="at">PT =</span> <span class="fu">floor</span>(<span class="fu">tail</span>(<span class="fu">index</span>(Data_eq)<span class="sc">/</span><span class="dv">30</span>,<span class="dv">1</span><span class="dt">L</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">summary</span>(est)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>Quasi<span class="sc">-</span>Maximum likelihood estimation</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="fu">estimation_LRM</span>(<span class="at">start =</span> start, <span class="at">model =</span> Mod, <span class="at">data =</span> yData, <span class="at">upper =</span> upper,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> lower, <span class="at">PT =</span> <span class="fu">floor</span>(<span class="fu">tail</span>(<span class="fu">index</span>(Data_eq)<span class="sc">/</span><span class="dv">30</span>, <span class="dv">1</span><span class="dt">L</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>           Estimate  Std. Error</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>mu1     <span class="fl">0.000335328</span> <span class="fl">0.004901559</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>mu2    <span class="sc">-</span><span class="fl">0.062235188</span> <span class="fl">0.033027232</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>mu3     <span class="fl">0.016291220</span> <span class="fl">0.039382559</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">0.082031691</span> <span class="fl">0.004859138</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>nu      <span class="fl">3.062728822</span> <span class="fl">0.616466913</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> log L<span class="sc">:</span> <span class="sc">-</span><span class="fl">1506.067</span> <span class="fl">48.17592</span></span></code></pre></div>
</div>
<h2 data-number="5" id="concl"><span class="header-section-number">5</span> Conclusion</h2>
<p>In this paper, we have presented classes and methods for a <span class="math inline">\(t\)</span>-Lévy regression model. In particular, the simulation and the estimation algorithm have been introduced from a computational point of view. Moreover three different algorithms have been developed for computing the density, the cumulative distribution and the quantile functions and the random number generator of the <span class="math inline">\(t\)</span>-Lévy increments defined over a non-unitary interval. These latter methods can be also used in any stochastic model available in <a href="https://cran.r-project.org/package=yuima">yuima</a> for the definition of the underlying noise.</p>
<p>Based on our simulated data, for the estimation of the degrees of freedom the Laguerre method seems to be more accurate. However, due to the restriction on the number of roots used in the evaluation of the integral, we notice a bias on the estimation of the scale parameter. Such bias seems to be observable also in the other implemented methods when the same number of points is used in the evaluation of the integral for the inversion of the characteristic function. However for the COS and the FFT methods, the numerical precision can be improved. In particular, it is possible to ensure that the estimates fall in the asymptotic confidence interval at 95<span class="math inline">\(\%\)</span> level even if the estimates of the degrees of freedom in the simplest model (first example) seem to underestimate the true value. As concerns computational time, the FFT methods with a sufficiently large computational precision <span class="math inline">\((N\geq 5000)\)</span> and <span class="math inline">\(h\)</span> sufficiently small seems to be an acceptable compromise.</p>
<h2 class="unnumbered" id="acknowledgment">Acknowledgment</h2>
<p>This work is supported by JST CREST Grant Number JPMJCR2115, Japan and by the MUR-PRIN2022 Grant Number 20225PC98R, Italy CUP codes: H53D23002200006 and G53D23001960006.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="5.1" id="cran-packages-used"><span class="header-section-number">5.1</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=yuima">yuima</a>, <a href="https://cran.r-project.org/package=statmod">statmod</a>, <a href="https://cran.r-project.org/package=pak">pak</a></p>
<h3 class="appendix" data-number="5.2" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">5.2</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Distributions">Distributions</a>, <a href="https://cran.r-project.org/view=NumericalMathematics">NumericalMathematics</a>, <a href="https://cran.r-project.org/view=TimeSeries">TimeSeries</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-AsmRos01" class="csl-entry" role="listitem">
S. Asmussen and J. Rosiński. Approximations of small jumps of l<span>é</span>vy processes with a view towards simulation. <em>Journal of Applied Probability</em>, 38(2): 482–493, 2001. URL <a href="http://www.jstor.org/stable/3215901">http://www.jstor.org/stable/3215901</a>.
</div>
<div id="ref-BerVig08" class="csl-entry" role="listitem">
C. Berg and C. Vignat. On some results of <span>Cufaro Petroni</span> about <span>Student</span> t-processes. <em>Journal of Physics A: Mathematical and Theoretical</em>, 41(26): 265004, 2008. DOI <a href="https://doi.org/10.1088/1751-8113/41/26/265004">10.1088/1751-8113/41/26/265004</a>.
</div>
<div id="ref-JSSv057i04" class="csl-entry" role="listitem">
A. Brouste, M. Fukasawa, H. Hino, S. Iacus, K. Kamatani, Y. Koike, H. Masuda, R. Nomura, T. Ogihara, Y. Shimuzu, et al. The YUIMA project: A computational framework for simulation and inference of stochastic differential equations. <em>Journal of Statistical Software</em>, 57(4): 1–51, 2014. URL <a href="https://www.jstatsoft.org/index.php/jss/article/view/v057i04">https://www.jstatsoft.org/index.php/jss/article/view/v057i04</a>.
</div>
<div id="ref-castro2021trends" class="csl-entry" role="listitem">
L. V. Castro-Porras, R. Rojas-Martı́nez, C. A. Aguilar-Salinas, O. Y. Bello-Chavolla, C. Becerril-Gutierrez and C. Escamilla-Nuñez. Trends and age-period-cohort effects on hypertension mortality rates from 1998 to 2018 in <span>Mexico</span>. <em>Scientific Reports</em>, 11(1): 17553, 2021. URL <a href="https://pubmed.ncbi.nlm.nih.gov/34475436/">https://pubmed.ncbi.nlm.nih.gov/34475436/</a>.
</div>
<div id="ref-cooley1965algorithm" class="csl-entry" role="listitem">
J. W. Cooley and J. W. Tukey. An algorithm for the machine calculation of complex <span>Fourier</span> series. <em>Mathematics of computation</em>, 19(90): 297–301, 1965. DOI <a href="https://doi.org/10.2307/2003354">https://doi.org/10.2307/2003354</a>.
</div>
<div id="ref-pak" class="csl-entry" role="listitem">
G. Csárdi and J. Hester. <em>Pak: Another approach to package installation.</em> 2024. URL <a href="https://CRAN.R-project.org/package=pak">https://CRAN.R-project.org/package=pak</a>. R package version 0.8.0.
</div>
<div id="ref-Cuf07" class="csl-entry" role="listitem">
N. Cufaro Petroni. Mixtures in nonstable <span class="nocase">L<span class="nocase">é</span>vy</span> processes. <em>J. Phys. A</em>, 40(10): 2227–2250, 2007. URL <a href="http://dx.doi.org/10.1088/1751-8113/40/10/001">http://dx.doi.org/10.1088/1751-8113/40/10/001</a>.
</div>
<div id="ref-Dev81" class="csl-entry" role="listitem">
L. Devroye. On the computer generation of random variables with a given characteristic function. <em>Comput. Math. Appl.</em>, 7(6): 547–552, 1981. URL <a href="http://dx.doi.org/10.1016/0898-1221(81)90038-9">http://dx.doi.org/10.1016/0898-1221(81)90038-9</a>.
</div>
<div id="ref-DitSam19" class="csl-entry" role="listitem">
S. Ditlevsen and A. Samson. Hypoelliptic diffusions: Filtering and inference from complete and partial observations. <em>J. R. Stat. Soc. Ser. B. Stat. Methodol.</em>, 81(2): 361–384, 2019. DOI <a href="https://doi.org/10.1111/rssb.12307">https://doi.org/10.1111/rssb.12307</a>.
</div>
<div id="ref-fang2011fourier" class="csl-entry" role="listitem">
F. Fang and C. W. Oosterlee. A <span>Fourier</span>-based valuation method for <span>Bermudan</span> and barrier options under <span>Heston</span>’s model. <em>SIAM Journal on Financial Mathematics</em>, 2(1): 439–463, 2011. DOI <a href="https://doi.org/10.1137/100794158">https://doi.org/10.1137/100794158</a>.
</div>
<div id="ref-fang2009novel" class="csl-entry" role="listitem">
F. Fang and C. W. Oosterlee. A novel pricing method for <span>European</span> options based on <span>Fourier</span>-cosine series expansions. <em>SIAM Journal on Scientific Computing</em>, 31(2): 826–848, 2009. DOI <a href="https://doi.org/10.1137/080718061">https://doi.org/10.1137/080718061</a>.
</div>
<div id="ref-Goknur2016" class="csl-entry" role="listitem">
G. Giner and G. K. Smyth. Statmod: Probability calculations for the inverse <span>Gaussian</span> distribution. <em>R Journal</em>, 8(1): 339–351, 2016. URL <a href="https://doi.org/10.32614/RJ-2016-024">https://doi.org/10.32614/RJ-2016-024</a>.
</div>
<div id="ref-GloYos21" class="csl-entry" role="listitem">
A. Gloter and N. Yoshida. Adaptive estimation for degenerate diffusion processes. <em>Electron. J. Stat.</em>, 15(1): 1424–1472, 2021. URL <a href="https://doi.org/10.1214/20-ejs1777">https://doi.org/10.1214/20-ejs1777</a>.
</div>
<div id="ref-HABERMAN2009255" class="csl-entry" role="listitem">
S. Haberman and A. Renshaw. On age-period-cohort parametric mortality rate projections. <em>Insurance: Mathematics and Economics</em>, 45(2): 255–270, 2009. URL <a href="https://www.sciencedirect.com/science/article/pii/S016766870900081X">https://www.sciencedirect.com/science/article/pii/S016766870900081X</a>.
</div>
<div id="ref-HeyLeo05" class="csl-entry" role="listitem">
C. C. Heyde and N. N. Leonenko. Student processes. <em>Adv. in Appl. Probab.</em>, 37(2): 342–365, 2005. URL <a href="http://dx.doi.org/10.1239/aap/1118858629">http://dx.doi.org/10.1239/aap/1118858629</a>.
</div>
<div id="ref-Hubalek2005OnSF" class="csl-entry" role="listitem">
F. Hubalek. On simulation from the marginal distribution of a <span>Student</span> t and generalized hyperbolic l<span>é</span>vy process. 2005. URL <a href="https://api.semanticscholar.org/CorpusID:19037661">https://api.semanticscholar.org/CorpusID:19037661</a>.
</div>
<div id="ref-iacus2018simulation" class="csl-entry" role="listitem">
S. M. Iacus and N. Yoshida. Simulation and inference for stochastic processes with YUIMA. <em>A comprehensive <span>R</span> framework for <span>SDEs</span> and other stochastic processes. Use <span>R</span></em>, 2018. URL <a href="https://link.springer.com/book/10.1007/978-3-319-55569-0">https://link.springer.com/book/10.1007/978-3-319-55569-0</a>.
</div>
<div id="ref-LeoSam18" class="csl-entry" role="listitem">
J. R. León and A. Samson. Hypoelliptic stochastic <span>FitzHugh</span>-<span>Nagumo</span> neuronal model: Mixing, up-crossing and estimation of the spike rate. <em>Ann. Appl. Probab.</em>, 28(4): 2243–2274, 2018. URL <a href="https://doi.org/10.1214/17-AAP1355">https://doi.org/10.1214/17-AAP1355</a>.
</div>
<div id="ref-loregian2012approximation" class="csl-entry" role="listitem">
A. Loregian, L. Mercuri and E. Rroji. Approximation of the variance gamma model with a finite mixture of normals. <em>Statistics &amp; Probability Letters</em>, 82(2): 217–224, 2012. URL <a href="https://www.sciencedirect.com/science/article/pii/S0167715211003257">https://www.sciencedirect.com/science/article/pii/S0167715211003257</a>.
</div>
<div id="ref-Mass18" class="csl-entry" role="listitem">
T. Massing. Simulation of <span>Student</span>–l<span>é</span>vy processes using series representations. <em>Computational Statistics</em>, 33(4): 1649–1685, 2018. DOI <a href="https://doi.org/10.1007/s00180-018-0814-y">10.1007/s00180-018-0814-y</a>.
</div>
<div id="ref-Masuda2022" class="csl-entry" role="listitem">
H. Masuda, L. Mercuri and Y. Uehara. <span class="nocase">Noise inference for ergodic L<span class="nocase">é</span>vy driven <span>SDE</span></span>. <em>Electronic Journal of Statistics</em>, 16(1): 2432–2474, 2022. URL <a href="https://doi.org/10.1214/22-EJS2006">https://doi.org/10.1214/22-EJS2006</a>.
</div>
<div id="ref-masuda2023quasilikelihood" class="csl-entry" role="listitem">
H. Masuda, L. Mercuri and Y. Uehara. <span class="nocase">Quasi-Likelihood Analysis for Student-L<span class="nocase">é</span>vy Regression</span>. <em>Statistical Inference for Stochastic Processes</em>, 1–34, 2024. DOI <a href="https://doi.org/10.1007/s11203-024-09317-2">https://doi.org/10.1007/s11203-024-09317-2</a>.
</div>
<div id="ref-mercuri2021finite" class="csl-entry" role="listitem">
L. Mercuri, A. Perchiazzo and E. Rroji. Finite mixture approximation of <span>CARMA</span> (p, q) models. <em>SIAM Journal on Financial Mathematics</em>, 12(4): 1416–1458, 2021. DOI <a href="https://doi.org/10.1137/20M1363248">https://doi.org/10.1137/20M1363248</a>.
</div>
<div id="ref-Man" class="csl-entry" role="listitem">
R Core Team. <em><span>R</span>: A language and environment for statistical computing.</em> Vienna, Austria: R Foundation for Statistical Computing, 2024. URL <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-singleton1969algorithm" class="csl-entry" role="listitem">
R. Singleton. An algorithm for computing the mixed radix fast <span>Fourier</span> transform. <em>IEEE Transactions on audio and electroacoustics</em>, 17(2): 93–103, 1969. URL <a href="https://ieeexplore.ieee.org/document/1162042">https://ieeexplore.ieee.org/document/1162042</a>.
</div>
<div id="ref-statmod" class="csl-entry" role="listitem">
G. Smyth, L. Chen, Y. Hu, P. Dunn, B. Phipson and Y. Chen. <em><span class="nocase">statmod</span>: Statistical modeling.</em> 2023. URL <a href="https://cran.r-project.org/web/packages/statmod/index.html">https://cran.r-project.org/web/packages/statmod/index.html</a>. R package version 1.5.0.
</div>
<div id="ref-sorensen2002modeling" class="csl-entry" role="listitem">
C. Sørensen. Modeling seasonality in agricultural commodity futures. <em>Journal of Futures Markets: Futures, Options, and Other Derivative Products</em>, 22(5): 393–426, 2002. URL <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/fut.10017">https://onlinelibrary.wiley.com/doi/abs/10.1002/fut.10017</a>.
</div>
<div id="ref-Wu01" class="csl-entry" role="listitem">
L. Wu. Large and moderate deviations and exponential convergence for stochastic damping <span>Hamiltonian</span> systems. <em>Stochastic Process. Appl.</em>, 91(2): 205–238, 2001. URL <a href="https://doi.org/10.1016/S0304-4149(00)00061-2">https://doi.org/10.1016/S0304-4149(00)00061-2</a>.
</div>
<div id="ref-YUIMA" class="csl-entry" role="listitem">
YUIMA Project Team. <em><span class="nocase">yuima</span>: The YUIMA project package for SDEs.</em> 2024. URL <a href="https://cran.r-project.org/web/packages/yuima/index.html">https://cran.r-project.org/web/packages/yuima/index.html</a>. R package version 1.15.27.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>The Laguerre polynomial can be defined recursively as follows: <span class="math inline">\(L_0\left(x\right), L_1(x)=1-x, \ldots, L_{N}\left(x\right)=\frac{\left(2N-x\right)L_{N-1}\left(x\right)-\left(N-1\right)L_{N-2}\left(x\right)}{N}\)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Since <a href="https://cran.r-project.org/package=yuima">yuima</a> manages SDEs driven by a Lévy process. For a user-defined noise, the random number generator in the simulation algorithm and the density function for the estimation procedure are constructed using the <a href="https://cran.r-project.org/package=yuima">yuima</a> function <code>FromCF2yuima_law</code> see the documentation <span class="citation" data-cites="YUIMA">YUIMA Project Team (<a href="#ref-YUIMA" role="doc-biblioref">2024</a>)</span> for more details. This function internally implements the same <code>FFT</code> algorthim described in this paper.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We recommend to download the latest <a href="https://cran.r-project.org/package=yuima">yuima</a> version using the function <code>pk_install</code> available in <a href="https://cran.r-project.org/package=pak">pak</a> <span class="citation" data-cites="pak">Csárdi and Hester (<a href="#ref-pak" role="doc-biblioref">2024</a>)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>An object of <code>yuima.th-class</code> inherits the <code>dens</code> method for the density computation, <code>cdf</code> for the evaluation of the cumulative distribution function, <code>quantile</code> for the quantile function and <code>rand</code> for the generation of the random sample. We refer to <span class="citation" data-cites="Masuda2022">Masuda et al. (<a href="#ref-Masuda2022" role="doc-biblioref">2022</a>)</span> for the usage of these methods.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Masuda, et al., "Student t-Lévy regression model in yuima", The R Journal, 2025</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2025-014,
  author = {Masuda, Hiroki and Mercuri, Lorenzo and Uehara, Yuma},
  title = {Student t-Lévy regression model in yuima},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2025-014},
  doi = {10.32614/RJ-2025-014},
  volume = {17},
  issue = {2},
  issn = {2073-4859},
  pages = {56-83}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
