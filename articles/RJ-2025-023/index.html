<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Feature-Based Time-Series Analysis in R using the Theft Ecosystem</title>

<meta property="description" itemprop="description" content="Time series are measured and analyzed across the sciences. One method of quantifying the structure of time series is by calculating a set of summary statistics or &#39;features&#39;, and then representing a time series in terms of its properties as a feature vector. The resulting feature space is interpretable and informative, and enables conventional statistical learning approaches, including clustering, regression, and classification, to be applied to time-series datasets. Many open-source software packages for computing sets of time-series features exist across multiple programming languages, including &#39;catch22&#39; (22 features: Matlab, R, Python, Julia), &#39;feasts&#39; (43 features: R), &#39;tsfeatures&#39; (62 features: R), &#39;Kats&#39; (40 features: Python), &#39;tsfresh&#39; (783 features: Python), and &#39;TSFEL&#39; (156 features: Python). However, there are several issues: (i) a singular access point to these packages is not currently available; (ii) to access all feature sets, users must be fluent in multiple languages; and (iii) these feature-extraction packages lack extensive accompanying methodological pipelines for performing feature-based time-series analysis, such as applications to time-series classification. Here we introduce a solution to these issues in the form of two complementary statistical software packages for R called &#39;theft&#39;: Tools for Handling Extraction of Features from Time series and &#39;theftdlc&#39;: theft &#39;downloadable content&#39;. &#39;theft&#39; is a unified and extendable framework for computing features from the six open-source time-series feature sets listed above as well as custom user-specified features. &#39;theftdlc&#39; is an extension package to &#39;theft&#39; which includes a suite of functions for processing and interpreting the performance of extracted features, including extensive data-visualization templates, low-dimensional projections, and time-series classification. With an increasing volume and complexity of large time-series datasets in the sciences and industry, &#39;theft&#39; and &#39;theftdlc&#39; provide a standardized framework for comprehensively quantifying and interpreting informative structure in time series."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2025-023/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-10-21"/>
<meta property="article:created" itemprop="dateCreated" content="2025-10-21"/>
<meta name="article:author" content="Trent Henderson"/>
<meta name="article:author" content="Ben D. Fulcher"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Feature-Based Time-Series Analysis in R using the Theft Ecosystem"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Time series are measured and analyzed across the sciences. One method of quantifying the structure of time series is by calculating a set of summary statistics or &#39;features&#39;, and then representing a time series in terms of its properties as a feature vector. The resulting feature space is interpretable and informative, and enables conventional statistical learning approaches, including clustering, regression, and classification, to be applied to time-series datasets. Many open-source software packages for computing sets of time-series features exist across multiple programming languages, including &#39;catch22&#39; (22 features: Matlab, R, Python, Julia), &#39;feasts&#39; (43 features: R), &#39;tsfeatures&#39; (62 features: R), &#39;Kats&#39; (40 features: Python), &#39;tsfresh&#39; (783 features: Python), and &#39;TSFEL&#39; (156 features: Python). However, there are several issues: (i) a singular access point to these packages is not currently available; (ii) to access all feature sets, users must be fluent in multiple languages; and (iii) these feature-extraction packages lack extensive accompanying methodological pipelines for performing feature-based time-series analysis, such as applications to time-series classification. Here we introduce a solution to these issues in the form of two complementary statistical software packages for R called &#39;theft&#39;: Tools for Handling Extraction of Features from Time series and &#39;theftdlc&#39;: theft &#39;downloadable content&#39;. &#39;theft&#39; is a unified and extendable framework for computing features from the six open-source time-series feature sets listed above as well as custom user-specified features. &#39;theftdlc&#39; is an extension package to &#39;theft&#39; which includes a suite of functions for processing and interpreting the performance of extracted features, including extensive data-visualization templates, low-dimensional projections, and time-series classification. With an increasing volume and complexity of large time-series datasets in the sciences and industry, &#39;theft&#39; and &#39;theftdlc&#39; provide a standardized framework for comprehensively quantifying and interpreting informative structure in time series."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2025-023/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2025-023/figures/workflow-graphic_ecosystem-final.png"/>
<meta property="og:image:width" content="824"/>
<meta property="og:image:height" content="907"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Feature-Based Time-Series Analysis in R using the Theft Ecosystem"/>
<meta property="twitter:description" content="Time series are measured and analyzed across the sciences. One method of quantifying the structure of time series is by calculating a set of summary statistics or &#39;features&#39;, and then representing a time series in terms of its properties as a feature vector. The resulting feature space is interpretable and informative, and enables conventional statistical learning approaches, including clustering, regression, and classification, to be applied to time-series datasets. Many open-source software packages for computing sets of time-series features exist across multiple programming languages, including &#39;catch22&#39; (22 features: Matlab, R, Python, Julia), &#39;feasts&#39; (43 features: R), &#39;tsfeatures&#39; (62 features: R), &#39;Kats&#39; (40 features: Python), &#39;tsfresh&#39; (783 features: Python), and &#39;TSFEL&#39; (156 features: Python). However, there are several issues: (i) a singular access point to these packages is not currently available; (ii) to access all feature sets, users must be fluent in multiple languages; and (iii) these feature-extraction packages lack extensive accompanying methodological pipelines for performing feature-based time-series analysis, such as applications to time-series classification. Here we introduce a solution to these issues in the form of two complementary statistical software packages for R called &#39;theft&#39;: Tools for Handling Extraction of Features from Time series and &#39;theftdlc&#39;: theft &#39;downloadable content&#39;. &#39;theft&#39; is a unified and extendable framework for computing features from the six open-source time-series feature sets listed above as well as custom user-specified features. &#39;theftdlc&#39; is an extension package to &#39;theft&#39; which includes a suite of functions for processing and interpreting the performance of extracted features, including extensive data-visualization templates, low-dimensional projections, and time-series classification. With an increasing volume and complexity of large time-series datasets in the sciences and industry, &#39;theft&#39; and &#39;theftdlc&#39; provide a standardized framework for comprehensively quantifying and interpreting informative structure in time series."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2025-023/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2025-023/figures/workflow-graphic_ecosystem-final.png"/>
<meta property="twitter:image:width" content="824"/>
<meta property="twitter:image:height" content="907"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Feature-Based Time-Series Analysis in R using the Theft Ecosystem"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-023"/>
<meta name="citation_pdf_url" content="RJ-2025-023.pdf"/>
<meta name="citation_volume" content="17"/>
<meta name="citation_issue" content="3"/>
<meta name="citation_doi" content="10.32614/RJ-2025-023"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="43"/>
<meta name="citation_lastpage" content="68"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/10/21"/>
<meta name="citation_publication_date" content="2025/10/21"/>
<meta name="citation_author" content="Trent Henderson"/>
<meta name="citation_author_institution" content="The University of Sydney"/>
<meta name="citation_author" content="Ben D. Fulcher"/>
<meta name="citation_author_institution" content="The University of Sydney"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Indications of nonlinear deterministic and finite-dimensional structures in time series of brain electrical activity: Dependence on recording region and brain state;citation_volume=64;citation_doi=10.1103/PhysRevE.64.061907;citation_issn=1539-3755;citation_author=R. G. Andrzejak;citation_author=K. Lehnertz;citation_author=F. Mormann;citation_author=C. Rieke;citation_author=P. David;citation_author=C. E. Elger"/>
  <meta name="citation_reference" content="citation_title=TSFEL: Time Series Feature Extraction Library;citation_volume=11;citation_doi=10.1016/j.softx.2020.100456;citation_issn=2352-7110;citation_author=Marília Barandas;citation_author=Duarte Folgado;citation_author=Letícia Fernandes;citation_author=Sara Santos;citation_author=Mariana Abreu;citation_author=Patrícia Bota;citation_author=Hui Liu;citation_author=Tanja Schultz;citation_author=Hugo Gamboa"/>
  <meta name="citation_reference" content="citation_title=Classifying Kepler light curves for 12,000 A and F stars using supervised feature-based machine learning;citation_doi=10.1093/mnras/stac1515;citation_issn=0035-8711;citation_author=Nicholas H Barbara;citation_author=Timothy R Bedding;citation_author=Ben D Fulcher;citation_author=Simon J Murphy;citation_author=Timothy Van Reeth"/>
  <meta name="citation_reference" content="citation_title=Distributed and parallel time series feature extraction for industrial big data applications;citation_publisher=arXiv;citation_number=arXiv:1610.07717;citation_doi=10.48550/arXiv.1610.07717;citation_author=Maximilian Christ;citation_author=Andreas W. Kempa-Liehr;citation_author=Michael Feindt"/>
  <meta name="citation_reference" content="citation_title=Time Series FeatuRe Extraction on basis of Scalable Hypothesis tests (tsfresh  a Python package);citation_volume=307;citation_doi=10.1016/j.neucom.2018.03.067;citation_issn=0925-2312;citation_author=Maximilian Christ;citation_author=Nils Braun;citation_author=Julius Neuffer;citation_author=Andreas W. Kempa-Liehr"/>
  <meta name="citation_reference" content="citation_title=Efficient algorithms for agglomerative hierarchical clustering methods;citation_volume=1;citation_doi=10.1007/BF01890115;citation_issn=1432-1343;citation_author=William H. E. Day;citation_author=Herbert Edelsbrunner"/>
  <meta name="citation_reference" content="citation_title=Beyond traditional sleep scoring: Massive feature extraction and data-driven clustering of sleep time series;citation_volume=98;citation_doi=10.1016/j.sleep.2022.06.013;citation_issn=1389-9457;citation_author=Nicolas Decat;citation_author=Jasmine Walter;citation_author=Zhao H. Koh;citation_author=Piengkwan Sribanditmongkol;citation_author=Ben D. Fulcher;citation_author=Jennifer M. Windt;citation_author=Thomas Andrillon;citation_author=Naotsugu Tsuchiya"/>
  <meta name="citation_reference" content="citation_title=Feature-based time-series analysis;citation_publisher=CRC Press;citation_author=Ben D. Fulcher"/>
  <meta name="citation_reference" content="citation_title=hctsa: A computational framework for automated time-series phenotyping using massive feature extraction;citation_volume=5;citation_doi=10.1016/j.cels.2017.10.001;citation_issn=2405-4712;citation_author=Ben D. Fulcher;citation_author=Nick S. Jones"/>
  <meta name="citation_reference" content="citation_title=Highly comparative feature-based time-series classification;citation_volume=26;citation_doi=10.1109/TKDE.2014.2316504;citation_issn=1041-4347, 1558-2191, 2326-3865;citation_author=Ben D. Fulcher;citation_author=Nick S. Jones"/>
  <meta name="citation_reference" content="citation_title=Highly comparative fetal heart rate analysis;citation_doi=10.1109/EMBC.2012.6346629;citation_issn=1558-4615;citation_author=B. D. Fulcher;citation_author=A. E. Georgieva;citation_author=C. W. G. Redman;citation_author=N. S. Jones"/>
  <meta name="citation_reference" content="citation_title=Highly comparative time-series analysis: The empirical structure of time series and their methods;citation_publisher=Royal Society;citation_volume=10;citation_doi=10.1098/rsif.2013.0048;citation_author=Ben D. Fulcher;citation_author=Max A. Little;citation_author=Nick S. Jones"/>
  <meta name="citation_reference" content="citation_title=A self-organizing, living library of time-series data;citation_publisher=Nature Publishing Group;citation_volume=7;citation_doi=10.1038/s41597-020-0553-0;citation_issn=2052-4463;citation_author=Ben D. Fulcher;citation_author=Carl H. Lubba;citation_author=Sarab S. Sethi;citation_author=Nick S. Jones"/>
  <meta name="citation_reference" content="citation_title=An Empirical Evaluation of Time-Series Feature Sets;citation_doi=10.1109/ICDMW53433.2021.00134;citation_issn=2375-9259;citation_author=Trent Henderson;citation_author=Ben D. Fulcher"/>
  <meta name="citation_reference" content="citation_title=Prediction of remaining time on site for e-commerce users: A SOM and long short-term memory study;citation_volume=40;citation_doi=https://doi.org/10.1002/for.2771;citation_author=Ling-Jing Kao;citation_author=Chih-Chou Chiu;citation_author=Hung-Jui Wang;citation_author=Chang Yu Ko"/>
  <meta name="citation_reference" content="citation_title=Exploring Granger causality between global average observed time series of carbon dioxide and temperature;citation_volume=104;citation_doi=10.1007/s00704-010-0342-3;citation_issn=1434-4483;citation_author=Evan Kodra;citation_author=Snigdhansu Chatterjee;citation_author=Auroop R. Ganguly"/>
  <meta name="citation_reference" content="citation_title=Sensor faults classification for SHM systems using deep learning-based method with Tsfresh features;citation_publisher=IOP Publishing;citation_volume=29;citation_doi=10.1088/1361-665X/ab85a6;citation_issn=0964-1726;citation_author=Gang Liu;citation_author=Lili Li;citation_author=Liangliang Zhang;citation_author=Qing Li;citation_author=S. S. Law"/>
  <meta name="citation_reference" content="citation_title=Catch22: CAnonical Time-series CHaracteristics;citation_volume=33;citation_doi=10.1007/s10618-019-00647-x;citation_issn=1573-756X;citation_author=Carl H. Lubba;citation_author=Sarab S. Sethi;citation_author=Philip Knaute;citation_author=Simon R. Schultz;citation_author=Ben D. Fulcher;citation_author=Nick S. Jones"/>
  <meta name="citation_reference" content="citation_title=Cortical Excitation:Inhibition Imbalance Causes Abnormal Brain Network Dynamics as Observed in Neurodevelopmental Disorders;citation_volume=30;citation_doi=10.1093/cercor/bhaa084;citation_issn=1047-3211;citation_author=Marija Markicevic;citation_author=Ben D Fulcher;citation_author=Christopher Lewis;citation_author=Fritjof Helmchen;citation_author=Markus Rudin;citation_author=Valerio Zerbi;citation_author=Nicole Wenderoth"/>
  <meta name="citation_reference" content="citation_title=FFORMA: Feature-based forecast model averaging;citation_volume=36;citation_doi=10.1016/j.ijforecast.2019.02.011;citation_issn=0169-2070;citation_author=Pablo Montero-Manso;citation_author=George Athanasopoulos;citation_author=Rob J. Hyndman;citation_author=Thiyanga S. Talagala"/>
  <meta name="citation_reference" content="citation_title=Behavioral discrimination and time-series phenotyping of birdsong performance;citation_publisher=Public Library of Science;citation_volume=17;citation_doi=10.1371/journal.pcbi.1008820;citation_issn=1553-7358;citation_author=Avishek Paul;citation_author=Helen McLendon;citation_author=Veronica Rally;citation_author=Jon T. Sakata;citation_author=Sarah C. Woolley"/>
  <meta name="citation_reference" content="citation_title=Principal Component Analysis;citation_publisher=Springer-Verlag;citation_doi=10.1007/b98835;citation_author=Ian T. Jolliffe"/>
  <meta name="citation_reference" content="citation_title=Time series extrinsic regression;citation_volume=35;citation_doi=10.1007/s10618-021-00745-9;citation_issn=1573-756X;citation_author=Chang Wei Tan;citation_author=Christoph Bergmeir;citation_author=François Petitjean;citation_author=Geoffrey I. Webb"/>
  <meta name="citation_reference" content="citation_title=tsflex: Flexible time series processing &amp; feature extraction;citation_volume=17;citation_doi=10.1016/j.softx.2021.100971;citation_issn=2352-7110;citation_author=Jonas Van Der Donckt;citation_author=Jeroen Van Der Donckt;citation_author=Emiel Deprost;citation_author=Sofie Van Hoecke"/>
  <meta name="citation_reference" content="citation_title=Evaluation and Comparison of EEG Traces: Latent Structure in Nonstationary Time Series;citation_publisher=Taylor &amp; Francis;citation_volume=94;citation_doi=10.1080/01621459.1999.10474128;citation_issn=0162-1459;citation_author=Mike West;citation_author=Raquel Prado;citation_author=Andrew D. Krystal"/>
  <meta name="citation_reference" content="citation_title=Tidy data;citation_volume=59;citation_doi=10.18637/jss.v059.i10;citation_issn=1548-7660;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Welcome to the Tidyverse;citation_volume=4;citation_doi=10.21105/joss.01686;citation_issn=2475-9066;citation_author=Hadley Wickham;citation_author=Mara Averick;citation_author=Jennifer Bryan;citation_author=Winston Chang;citation_author=Lucy D’Agostino McGowan;citation_author=Romain François;citation_author=Garrett Grolemund;citation_author=Alex Hayes;citation_author=Lionel Henry;citation_author=Jim Hester;citation_author=Max Kuhn;citation_author=Thomas Lin Pedersen;citation_author=Evan Miller;citation_author=Stephan Milton Bache;citation_author=Kirill Müller;citation_author=Jeroen Ooms;citation_author=David Robinson;citation_author=Dana Paige Seidel;citation_author=Vitalie Spinu;citation_author=Kohske Takahashi;citation_author=Davis Vaughan;citation_author=Claus Wilke;citation_author=Kara Woo;citation_author=Hiroaki Yutani"/>
  <meta name="citation_reference" content="citation_title=An anomaly detection algorithm selection service for IoT stream data based on tsfresh tool and genetic algorithm;citation_publisher=Hindawi;citation_volume=2021;citation_doi=10.1155/2021/6677027;citation_issn=1939-0114;citation_author=Zhongguo Yang;citation_author=Irshad Ahmed Abbasi;citation_author=Elfatih Elmubarak Mustafa;citation_author=Sikandar Ali;citation_author=Mingzhu Zhang"/>
  <meta name="citation_reference" content="citation_title=feasts: Feature extraction and statistics for time series;citation_author=Mitchell O’Hara-Wild;citation_author=Rob Hyndman;citation_author=Earo Wang"/>
  <meta name="citation_reference" content="citation_title=tsfeatures: Time series feature extraction;citation_author=Rob Hyndman;citation_author=Yanfei Kang;citation_author=Pablo Montero-Manso;citation_author=Thiyanga Talagala;citation_author=Earo Wang;citation_author=Yangzhuoran Yang;citation_author=Mitchell O’Hara-Wild"/>
  <meta name="citation_reference" content="citation_title=Rcatch22: Calculation of 22 CAnonical time-series CHaracteristics;citation_author=Trent Henderson"/>
  <meta name="citation_reference" content="citation_title=Catch22.jl;citation_doi=https://doi.org/10.5281/zenodo.5030712;citation_author=Brendan J. Harris"/>
  <meta name="citation_reference" content="citation_title=STL: A seasonal-trend decomposition procedure based on loess (with discussion);citation_volume=6;citation_author=Robert B. Cleveland;citation_author=William S. Cleveland;citation_author=Jean E. McRae;citation_author=Irma Terpenning"/>
  <meta name="citation_reference" content="citation_title=Never a dull moment: Distributional properties as a baseline for time-series classification;citation_author=Trent Henderson;citation_author=Annie G. Bryant;citation_author=Ben D. Fulcher"/>
  <meta name="citation_reference" content="citation_title=Inference for the generalization error;citation_volume=52;citation_author=Claude Nadeau;citation_author=Yoshua Bengio"/>
  <meta name="citation_reference" content="citation_title=Kats;citation_author=Xiaodong Jiang;citation_author=Sudeep Srivastava;citation_author=Sourav Chatterjee;citation_author=Yang Yu;citation_author=Jeffrey Handler;citation_author=Peiyi Zhang;citation_author=Rohan Bopardikar;citation_author=Dawei Li;citation_author=Yanjun Lin;citation_author=Uttam Thakore;citation_author=Michael Brundage;citation_author=Ginger Holt;citation_author=Caner Komurlu;citation_author=Rakshita Nagalla;citation_author=Zhichao Wang;citation_author=Hechao Sun;citation_author=Peng Gao;citation_author=Wei Cheung;citation_author=Jun Gao;citation_author=Qi Wang;citation_author=Marius Guerard;citation_author=Morteza Kazemi;citation_author=Yulin Chen;citation_author=Chong Zhou;citation_author=Sean Lee;citation_author=Nikolay Laptev;citation_author=Tihamér Levendovszky;citation_author=Jake Taylor;citation_author=Huijun Qian;citation_author=Jian Zhang;citation_author=Aida Shoydokova;citation_author=Trisha Singh;citation_author=Chengjun Zhu;citation_author=Zeynep Baz;citation_author=Christoph Bergmeir;citation_author=Di Yu;citation_author=Ahmet Koylan;citation_author=Kun Jiang;citation_author=Ploy Temiyasathit;citation_author=Emre Yurtbay"/>
  <meta name="citation_reference" content="citation_title=sktime: A unified interface for machine learning with time series;citation_author=Markus Löning;citation_author=Anthony Bagnall;citation_author=Sajaysurya Ganesh;citation_author=Viktor Kazakov;citation_author=Jason Lines;citation_author=Franz J Király"/>
  <meta name="citation_reference" content="citation_title=theft: Tools for handling extraction of features from time series;citation_author=Trent Henderson"/>
  <meta name="citation_reference" content="citation_title=theftdlc: Analyse and interpret time series features;citation_author=Trent Henderson"/>
  <meta name="citation_reference" content="citation_title=A new tidy data structure to support exploration and modeling of temporal data;citation_publisher=Taylor &amp; Francis;citation_volume=29;citation_doi=10.1080/10618600.2019.1695624;citation_author=Earo Wang;citation_author=Dianne Cook;citation_author=Rob J Hyndman"/>
  <meta name="citation_reference" content="citation_title=correctR: Corrected test statistics for comparing machine learning models on correlated samples;citation_author=Trent Henderson"/>
  <meta name="citation_reference" content="citation_title=dplyr: A grammar of data manipulation;citation_author=Hadley Wickham;citation_author=Romain François;citation_author=Lionel Henry;citation_author=Kirill Müller;citation_author=Davis Vaughan"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","description","draft","author","type","tables","output","bibliography","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Feature-Based Time-Series Analysis in R using the Theft Ecosystem"]},{"type":"character","attributes":{},"value":["2025-10-21"]},{"type":"character","attributes":{},"value":["Time series are measured and analyzed across the sciences. One method of quantifying the structure of time series is by calculating a set of summary statistics or 'features', and then representing a time series in terms of its properties as a feature vector. The resulting feature space is interpretable and informative, and enables conventional statistical learning approaches, including clustering, regression, and classification, to be applied to time-series datasets. Many open-source software packages for computing sets of time-series features exist across multiple programming languages, including 'catch22' (22 features: Matlab, R, Python, Julia), 'feasts' (43 features: R), 'tsfeatures' (62 features: R), 'Kats' (40 features: Python), 'tsfresh' (783 features: Python), and 'TSFEL' (156 features: Python). However, there are several issues: (i) a singular access point to these packages is not currently available; (ii) to access all feature sets, users must be fluent in multiple languages; and (iii) these feature-extraction packages lack extensive accompanying methodological pipelines for performing feature-based time-series analysis, such as applications to time-series classification. Here we introduce a solution to these issues in the form of two complementary statistical software packages for R called 'theft': Tools for Handling Extraction of Features from Time series and 'theftdlc': theft 'downloadable content'. 'theft' is a unified and extendable framework for computing features from the six open-source time-series feature sets listed above as well as custom user-specified features. 'theftdlc' is an extension package to 'theft' which includes a suite of functions for processing and interpreting the performance of extracted features, including extensive data-visualization templates, low-dimensional projections, and time-series classification. With an increasing volume and complexity of large time-series datasets in the sciences and industry, 'theft' and 'theftdlc' provide a standardized framework for comprehensively quantifying and interpreting informative structure in time series."]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Trent Henderson"]},{"type":"character","attributes":{},"value":["The University of Sydney"]},{"type":"character","attributes":{},"value":["School of Physics","Sydney, Australia"]},{"type":"character","attributes":{},"value":["0009-0005-5467-9914"]},{"type":"character","attributes":{},"value":["then6675@uni.sydney.edu.au"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Ben D. Fulcher"]},{"type":"character","attributes":{},"value":["The University of Sydney"]},{"type":"character","attributes":{},"value":["School of Physics","Sydney, Australia"]},{"type":"character","attributes":{},"value":["0000-0002-3003-4055"]},{"type":"character","attributes":{},"value":["ben.fulcher@sydney.edu.au"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["rjtools::rjournal_pdf_article","distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"character","attributes":{},"value":["2023-11-20"]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[3]},{"type":"character","attributes":{},"value":["RJ-2025-023"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[43]},{"type":"integer","attributes":{},"value":[68]}]},{"type":"character","attributes":{},"value":["RJ-2025-023.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-023"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-023"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["Rcatch22","tsfeatures","feasts","theft","theftdlc","glmnet","tsibble","normaliseR","correctR","dplyr"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["Databases","MachineLearning","MissingData","ModelDeployment","Survival","TimeSeries"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-023/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["figures/workflow-graphic_ecosystem-final.png","RJ-2025-023_files/anchor-4.2.2/anchor.min.js","RJ-2025-023_files/bowser-1.9.3/bowser.min.js","RJ-2025-023_files/distill-2.2.21/template.v2.js","RJ-2025-023_files/figure-html5/featureMatrix-1.png","RJ-2025-023_files/figure-html5/featureSetComparisons-1.png","RJ-2025-023_files/figure-html5/topFeatureCorrelations-1.png","RJ-2025-023_files/figure-html5/topFeatureViolins-1.png","RJ-2025-023_files/figure-html5/tsne-1.png","RJ-2025-023_files/header-attrs-2.30/header-attrs.js","RJ-2025-023_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2025-023_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2025-023_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2025-023_files/popper-2.6.0/popper.min.js","RJ-2025-023_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2025-023_files/tippy-6.2.7/tippy-light-border.css","RJ-2025-023_files/tippy-6.2.7/tippy.css","RJ-2025-023_files/tippy-6.2.7/tippy.umd.min.js","RJ-2025-023_files/webcomponents-2.0.0/webcomponents.js","RJ-2025-023.log","RJ-2025-023.tex","RJ-2025-023.zip","RJournal.sty","RJreferences.bib","RJwrapper.log","RJwrapper.tex","theftpaper.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.30/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      
      // Conditionally add supplementary files button
      if (document.getElementById('supplementary-materials')) {
        // create element safely
        const btn_suppl = document.createElement('a');
        btn_suppl.href = slug + '.zip';
        btn_suppl.className = 'dt-tag';
        btn_suppl.innerHTML = '<i class="fas fa-file-zipper"></i> Supplement';
        buttons.append(btn_suppl);
      }

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Feature-Based Time-Series Analysis in R using the Theft Ecosystem","description":"Time series are measured and analyzed across the sciences. One method of quantifying the structure of time series is by calculating a set of summary statistics or 'features', and then representing a time series in terms of its properties as a feature vector. The resulting feature space is interpretable and informative, and enables conventional statistical learning approaches, including clustering, regression, and classification, to be applied to time-series datasets. Many open-source software packages for computing sets of time-series features exist across multiple programming languages, including 'catch22' (22 features: Matlab, R, Python, Julia), 'feasts' (43 features: R), 'tsfeatures' (62 features: R), 'Kats' (40 features: Python), 'tsfresh' (783 features: Python), and 'TSFEL' (156 features: Python). However, there are several issues: (i) a singular access point to these packages is not currently available; (ii) to access all feature sets, users must be fluent in multiple languages; and (iii) these feature-extraction packages lack extensive accompanying methodological pipelines for performing feature-based time-series analysis, such as applications to time-series classification. Here we introduce a solution to these issues in the form of two complementary statistical software packages for R called 'theft': Tools for Handling Extraction of Features from Time series and 'theftdlc': theft 'downloadable content'. 'theft' is a unified and extendable framework for computing features from the six open-source time-series feature sets listed above as well as custom user-specified features. 'theftdlc' is an extension package to 'theft' which includes a suite of functions for processing and interpreting the performance of extracted features, including extensive data-visualization templates, low-dimensional projections, and time-series classification. With an increasing volume and complexity of large time-series datasets in the sciences and industry, 'theft' and 'theftdlc' provide a standardized framework for comprehensively quantifying and interpreting informative structure in time series.","doi":"10.32614/RJ-2025-023","authors":[{"author":"Trent Henderson","authorURL":"#","affiliation":"The University of Sydney","affiliationURL":"#","orcidID":"0009-0005-5467-9914"},{"author":"Ben D. Fulcher","authorURL":"#","affiliation":"The University of Sydney","affiliationURL":"#","orcidID":"0000-0002-3003-4055"}],"publishedDate":"2025-10-21T00:00:00.000+00:00","citationText":"Henderson & Fulcher, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-3">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Feature-Based Time-Series Analysis in R using the Theft Ecosystem</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Time series are measured and analyzed across the sciences. One method of quantifying the structure of time series is by calculating a set of summary statistics or ‘features’, and then representing a time series in terms of its properties as a feature vector. The resulting feature space is interpretable and informative, and enables conventional statistical learning approaches, including clustering, regression, and classification, to be applied to time-series datasets. Many open-source software packages for computing sets of time-series features exist across multiple programming languages, including ‘catch22’ (22 features: Matlab, R, Python, Julia), ‘feasts’ (43 features: R), ‘tsfeatures’ (62 features: R), ‘Kats’ (40 features: Python), ‘tsfresh’ (783 features: Python), and ‘TSFEL’ (156 features: Python). However, there are several issues: (i) a singular access point to these packages is not currently available; (ii) to access all feature sets, users must be fluent in multiple languages; and (iii) these feature-extraction packages lack extensive accompanying methodological pipelines for performing feature-based time-series analysis, such as applications to time-series classification. Here we introduce a solution to these issues in the form of two complementary statistical software packages for R called ‘theft’: Tools for Handling Extraction of Features from Time series and ‘theftdlc’: theft ‘downloadable content’. ‘theft’ is a unified and extendable framework for computing features from the six open-source time-series feature sets listed above as well as custom user-specified features. ‘theftdlc’ is an extension package to ‘theft’ which includes a suite of functions for processing and interpreting the performance of extracted features, including extensive data-visualization templates, low-dimensional projections, and time-series classification. With an increasing volume and complexity of large time-series datasets in the sciences and industry, ‘theft’ and ‘theftdlc’ provide a standardized framework for comprehensively quantifying and interpreting informative structure in time series.</p></p>
</div>

<div class="d-byline">
  Trent Henderson  (The University of Sydney)
  
,   Ben D. Fulcher  (The University of Sydney)
  
<br/>2025-10-21
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Taking repeated measurements of some quantity through time, forming a time series, is common across the sciences and industry.
The types of time series commonly analyzed are diverse, ranging from time-varying signals of an electroencephalogram <span class="citation" data-cites="westEvaluationComparisonEEG1999">(<a href="#ref-westEvaluationComparisonEEG1999" role="doc-biblioref">West et al. 1999</a>)</span>, CO<span class="math inline">\(_2\)</span> concentration in the atmosphere <span class="citation" data-cites="kodraExploringGrangerCausality2011">(<a href="#ref-kodraExploringGrangerCausality2011" role="doc-biblioref">Kodra et al. 2011</a>)</span>, light-curves from distant stars <span class="citation" data-cites="barbaraClassifyingKeplerLight2022">(<a href="#ref-barbaraClassifyingKeplerLight2022" role="doc-biblioref">Barbara et al. 2022</a>)</span>, and the daily number of clicks on a webpage <span class="citation" data-cites="kaoPredictionRemainingTime">(<a href="#ref-kaoPredictionRemainingTime" role="doc-biblioref">Kao et al. 2021</a>)</span>.
We can ask many different questions about such data, for example: (i) “can we distinguish the dynamics of brain disorders from neurotypical brain function?”; (ii) “can we classify different geospatial regions based on their temporal CO<span class="math inline">\(_2\)</span> concentration?”; or (iii) “can we classify new stars based on their light curves?”.
One approach to answering such questions is to capture properties of each time series and use that information to train a classification algorithm.
This can be achieved by extracting from each time series a set of interpretable summary statistics or ‘features’.
Using this procedure, a collection of univariate time series can be represented as a time series <span class="math inline">\(\times\)</span> feature matrix which can be used as the basis for a range of conventional statistical learning procedures <span class="citation" data-cites="fulcherHctsaComputationalFramework2017 fulcherFeatureBasedTimeSeriesAnalysis2018">(<a href="#ref-fulcherHctsaComputationalFramework2017" role="doc-biblioref">Fulcher and Jones 2017</a>; <a href="#ref-fulcherFeatureBasedTimeSeriesAnalysis2018" role="doc-biblioref">Fulcher 2018</a>)</span>.</p>
<p>The range of time-series analysis methods that can be used to define time-series features is vast, including properties of the distribution, autocorrelation function, stationarity, entropy, methods from the physics nonlinear time-series analysis literature <span class="citation" data-cites="fulcherHighlyComparativeTimeseries2013">(<a href="#ref-fulcherHighlyComparativeTimeseries2013" role="doc-biblioref">Fulcher et al. 2013</a>)</span>.
Because features are real-valued scalar outputs of a mathematical operation, and are often tightly linked to underlying theory (e.g., Fourier analysis or information theory), they can yield interpretable understanding of patterns in time series and the processes that produce them—information that can guide further investigation.
The first work to organize these methods from across the interdisciplinary literature encoded thousands of diverse time-series analysis methods as features and compared their behavior on a wide range of time series <span class="citation" data-cites="fulcherHighlyComparativeTimeseries2013">(<a href="#ref-fulcherHighlyComparativeTimeseries2013" role="doc-biblioref">Fulcher et al. 2013</a>)</span>.
The resulting interdisciplinary library of thousands of time-series features has enabled new ways of doing time-series analysis, including the ability to discover high-performing methods for a given problem in a systematic, data-driven way through large-scale comparison (overcoming the subjective and time-consuming task of selecting methods manually) <span class="citation" data-cites="fulcherHighlyComparativeFeaturebased2014">(<a href="#ref-fulcherHighlyComparativeFeaturebased2014" role="doc-biblioref">Fulcher and Jones 2014</a>)</span>.
This approach has been termed ‘highly comparative time-series analysis’ and has been implemented in the Matlab software <code>hctsa</code>, which computes <span class="math inline">\(&gt;7700\)</span> time-series features <span class="citation" data-cites="fulcherHctsaComputationalFramework2017">(<a href="#ref-fulcherHctsaComputationalFramework2017" role="doc-biblioref">Fulcher and Jones 2017</a>)</span>.
The approach of automated discovery provided by <code>hctsa</code> has been applied successfully to many scientific problems, such as classifying zebra finch motifs across different social contexts <span class="citation" data-cites="paulBehavioralDiscriminationTimeseries2021">(<a href="#ref-paulBehavioralDiscriminationTimeseries2021" role="doc-biblioref">Paul et al. 2021</a>)</span>, classifying cord pH from fetal heart-rate dynamics <span class="citation" data-cites="fulcherHighlyComparativeFetal2012">(<a href="#ref-fulcherHighlyComparativeFetal2012" role="doc-biblioref">Fulcher et al. 2012</a>)</span>, and classifying changes in cortical dynamics from manipulating the firing of excitatory and inhibitory neurons <span class="citation" data-cites="markicevicCorticalExcitationInhibition2020">(<a href="#ref-markicevicCorticalExcitationInhibition2020" role="doc-biblioref">Markicevic et al. 2020</a>)</span>.
While <code>hctsa</code> is comprehensive in its coverage of time-series analysis methods, calculating all of its features on a given dataset is computationally expensive and it requires access to the proprietary Matlab software, limiting its broader use.</p>
<p>The past decade has seen the development of multiple software libraries that implement different sets of time-series features across a range of open-source programming languages.
Here, we focus on the following six libraries:</p>
<ul>
<li><p><code>catch22</code> (C, Matlab, R, Python, Julia) computes a representative subset of 22 features from <code>hctsa</code> <span class="citation" data-cites="lubbaCatch22CAnonicalTimeseries2019">(<a href="#ref-lubbaCatch22CAnonicalTimeseries2019" role="doc-biblioref">Lubba et al. 2019</a>)</span>.
The <span class="math inline">\(&gt;7700\)</span> features in <code>hctsa</code> were applied to 93 time-series classification tasks to retain the smallest number of features that maintained high performance on these tasks while also being minimally redundant with each other, yielding the <code>catch22</code> set.
<code>catch22</code> was coded in C for computational efficiency, with wrappers for Matlab, and packages for: R, as <a href="https://cran.r-project.org/package=Rcatch22">Rcatch22</a> <span class="citation" data-cites="Rcatch22_pkg">(<a href="#ref-Rcatch22_pkg" role="doc-biblioref">Henderson 2021</a>)</span>; Julia, as <code>Catch22.jl</code> <span class="citation" data-cites="catch22jl_pkg">(<a href="#ref-catch22jl_pkg" role="doc-biblioref">Harris 2021</a>)</span>; and Python, as <code>pycatch22</code>. <code>catch22</code> is also commonly extended to include mean and variance to form <code>"catch24"</code> in order to achieve competitive performance on tasks where the dataset has not been standardized <span class="citation" data-cites="henderson2023dullmomentdistributionalproperties">(<a href="#ref-henderson2023dullmomentdistributionalproperties" role="doc-biblioref">Henderson et al. 2023</a>)</span>.</p></li>
<li><p><a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a> (R) is the most prominent package for computing time-series features in R <span class="citation" data-cites="tsfeatures_pkg">(<a href="#ref-tsfeatures_pkg" role="doc-biblioref">Hyndman et al. 2020</a>)</span>.
The 62 features in <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a> include techniques commonly used by econometricians and forecasters, such as crossing points, seasonal and trend decomposition using Loess <span class="citation" data-cites="clevelandSeasonalTrend1990">(<a href="#ref-clevelandSeasonalTrend1990" role="doc-biblioref">Cleveland et al. 1990</a>)</span>, autoregressive conditional heteroscedasticity (ARCH) models, unit-root tests, and sliding windows.
<a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a> also includes sixteen features from <code>hctsa</code> that were previously used to organize tens of thousands of time series in the <em>CompEngine</em> time-series database <span class="citation" data-cites="fulcherSelforganizingLivingLibrary2020">(<a href="#ref-fulcherSelforganizingLivingLibrary2020" role="doc-biblioref">Fulcher et al. 2020</a>)</span>.</p></li>
<li><p><a href="https://cran.r-project.org/package=feasts">feasts</a> (R) shares a subset of the same features as <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a>, computing a total of 43 features <span class="citation" data-cites="feasts_pkg">(<a href="#ref-feasts_pkg" role="doc-biblioref">O’Hara-Wild et al. 2021</a>)</span>.
However, the scope of <a href="https://cran.r-project.org/package=feasts">feasts</a> as a software package is larger: it is a vehicle to incorporate time-series features into the software ecosystem known as the <a href="#">tidyverts</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>—a collection of packages for time series that follow tidy data principles <span class="citation" data-cites="wickhamTidyData2014">(<a href="#ref-wickhamTidyData2014" role="doc-biblioref">Wickham 2014</a>)</span>.
This ensures alignment with the broader and popular <a href="#">tidyverse</a> collection of packages for data wrangling, summarization, and statistical graphics <span class="citation" data-cites="wickhamWelcomeTidyverse2019">(<a href="#ref-wickhamWelcomeTidyverse2019" role="doc-biblioref">Wickham et al. 2019</a>)</span>.
<a href="https://cran.r-project.org/package=feasts">feasts</a> also includes functions for producing graphics, but these are largely focused on exploring quantities of interest in econometrics, such as autocorrelation, seasonality, and Seasonal and Trend decomposition using Loess (STL).</p></li>
<li><p><code>tsfresh</code> (Python) includes 783 features that measure properties of the autocorrelation function, entropy, quantiles, fast Fourier transforms, and distributional characteristics <span class="citation" data-cites="christTimeSeriesFeatuRe2018">(<a href="#ref-christTimeSeriesFeatuRe2018" role="doc-biblioref">Christ et al. 2018</a>)</span>.
<code>tsfresh</code> also includes a built-in feature filtering procedure, FeatuRe Extraction based on Scalable Hypothesis tests (FRESH), that uses a hypothesis-testing process to control the percentage of irrelevant extracted features <span class="citation" data-cites="christDistributedParallelTime2017">(<a href="#ref-christDistributedParallelTime2017" role="doc-biblioref">Christ et al. 2017</a>)</span>.
<code>tsfresh</code> has been used widely to solve time-series problems, such as anomaly detection in Internet-of-Things streaming data <span class="citation" data-cites="yangAnomalyDetectionAlgorithm2021">(<a href="#ref-yangAnomalyDetectionAlgorithm2021" role="doc-biblioref">Yang et al. 2021</a>)</span> and sensor-fault classification <span class="citation" data-cites="liuSensorFaultsClassification2020">(<a href="#ref-liuSensorFaultsClassification2020" role="doc-biblioref">Liu et al. 2020</a>)</span>.
<code>tsfresh</code> is also commonly accessed through the <code>FreshPRINCE</code> functionality within the popular <code>sktime</code> Python library <span class="citation" data-cites="loning2019sktime">(<a href="#ref-loning2019sktime" role="doc-biblioref">Löning et al. 2019</a>)</span>.</p></li>
<li><p><code>TSFEL</code> (Python) contains 156 features that measure properties associated with distributional characteristics, the autocorrelation function, spectral quantities, and wavelets <span class="citation" data-cites="barandasTSFELTimeSeries2020">(<a href="#ref-barandasTSFELTimeSeries2020" role="doc-biblioref">Barandas et al. 2020</a>)</span>.
<code>TSFEL</code> was initially designed to support feature extraction of inertial data—such as data produced by human wearables—for the purpose of activity detection and rehabilitation.</p></li>
<li><p><code>Kats</code> (Python), developed by Facebook Research, contains a broad range of time-series functionality, including operations for forecasting, outlier and property detection, and feature calculation <span class="citation" data-cites="Jiang_KATS_2022">(<a href="#ref-Jiang_KATS_2022" role="doc-biblioref">Jiang et al. 2022</a>)</span>.
The feature-calculation module of <code>Kats</code> is called <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a> and includes 40 features (30 of which mirror R’s <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a> package).
<code>Kats</code> includes features associated with crossing points, STL decomposition, sliding windows, autocorrelation and partial autocorrelation, and Holt–Winters methods for detecting linear trends.</p></li>
</ul>
<p>The six feature sets vary over several orders of magnitude in their computation time, and exhibit large differences in both within-set feature redundancy—how correlated features are within a given set—and between-set feature redundancy—how correlated, on average, features are between different pairwise comparisons of sets <span class="citation" data-cites="hendersonEmpiricalEvaluationTimeSeries2021">(<a href="#ref-hendersonEmpiricalEvaluationTimeSeries2021" role="doc-biblioref">Henderson and Fulcher 2021</a>)</span>.
While each set contains a range of features that could be used to tackle time-series analysis problems, there are currently no guidelines for selecting an appropriate feature set for a given problem, nor methods for combining the different strengths of all sets.
Performance on a given time-series analysis task depends on the choice of the features that are used to represent the time series, highlighting the importance of being able to easily compute many different features from across different feature sets.
Furthermore, following feature extraction, there exists no set of visualization and analysis templates for common feature-based problem classes, such as feature-based time-series classification—like the tools provided in <code>hctsa</code> <span class="citation" data-cites="fulcherHctsaComputationalFramework2017">(<a href="#ref-fulcherHctsaComputationalFramework2017" role="doc-biblioref">Fulcher and Jones 2017</a>)</span>.
Here we present a solution for these challenges in the form of two connected open-source packages for R called <a href="https://cran.r-project.org/package=theft">theft</a>: Tools for Handling Extraction of Features from Time series (which unifies the six disparate feature sets and provides a consistent interface for general feature extraction) <span class="citation" data-cites="theft_pkg">(<a href="#ref-theft_pkg" role="doc-biblioref">Henderson 2025b</a>)</span>; and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>: theft downloadable content (which handles the subsequent processing, analysis, and visualization of time-series features) <span class="citation" data-cites="theftdlc_pkg">(<a href="#ref-theftdlc_pkg" role="doc-biblioref">Henderson 2025c</a>)</span>.
Together, we refer to these packages as the <a href="https://cran.r-project.org/package=theft">theft</a> ‘ecosystem’.</p>
<h2 data-number="2" id="the-theft-ecosystem-for-r"><span class="header-section-number">2</span> The theft ecosystem for R</h2>
<p><a href="https://cran.r-project.org/package=theft">theft</a> unifies the six free and open-source feature sets described in Section 1, thus overcoming barriers in using diverse feature sets developed in different software environments and the differences in their syntax and input-output structures.
The package also enables users to manually specify the functions for any number of features they wish to extract on top of the six pre-existing sets.
<a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> builds upon the foundation of <a href="https://cran.r-project.org/package=theft">theft</a> by providing an extensive analytical pipeline as well as statistical data visualization templates for understanding feature behavior and performance.
To our knowledge, such pipelines and templates do not currently exist in the free and open-source setting, making <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> a useful tool for both computing and understanding features.
While there is some software support for computing features in a consistent setting (such as in <code>tsflex</code> <span class="citation" data-cites="vanderdoncktTsflexFlexibleTime2022">(<a href="#ref-vanderdoncktTsflexFlexibleTime2022" role="doc-biblioref">Van Der Donckt et al. 2022</a>)</span>, which also provides sliding window extraction capability), such software is limited to only specifying the functional form of individual time-series features rather than automatically accessing features contained in existing feature sets.
We partition the analytical capabilities of <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> into two separate packages for two reasons: (i) it reduces dependencies if users wish only to extract features and conduct analysis themselves; and (ii) having a separate analysis package means additional functionality can be continuously added without exhausting R package dependency limits.</p>
<p>An overview of the broad functionality of the <a href="https://cran.r-project.org/package=theft">theft</a> ecosystem is presented in Figure <a href="#fig:workflow">1</a>.
The workflow begins in <a href="https://cran.r-project.org/package=theft">theft</a> with automated installation of Python libraries (if the three Python-based feature sets are required) through the function <code>install_python_pkgs</code> which takes the name of the virtual environment to create (<code>venv</code>) and the path to the Python interpreter to use (<code>python</code>) as arguments (Fig.<a href="#fig:workflow">1</a>A).
The Python environment containing the installed software is then instantiated within the R session using <code>init_theft</code> (Fig.<a href="#fig:workflow">1</a>B).
Time-series data (Fig.<a href="#fig:workflow">1</a>C) is loaded into the environment and converted to a <code>tsibble::tbl_ts</code> data structure if required (Fig.<a href="#fig:workflow">1</a>D) <span class="citation" data-cites="tsibble_pkg">(<a href="#ref-tsibble_pkg" role="doc-biblioref">Wang et al. 2020</a>)</span>.
Time-series features are then extracted in <a href="https://cran.r-project.org/package=theft">theft</a> using the desired pre-existing sets or user-supplied features (Fig.<a href="#fig:workflow">1</a>E).
The workflow transitions to <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> where the user can pass the extracted features into a range of statistical and visualization functions to derive interpretable understanding of the patterns in their dataset (Fig.<a href="#fig:workflow">1</a>F–M).
A variety of plot types are readily available, including heatmaps of the time-series <span class="math inline">\(\times\)</span> feature matrix (Fig.<a href="#fig:workflow">1</a>F) and feature <span class="math inline">\(\times\)</span> feature matrix (Fig.<a href="#fig:workflow">1</a>G), and violin plots of feature distributions (Fig.<a href="#fig:workflow">1</a>H).
Basic feature selection functionality is available through the <code>shrink</code> function (Fig.<a href="#fig:workflow">1</a>I) which implements penalized maximum likelihood generalized linear models using a backend to the R package <a href="https://cran.r-project.org/package=glmnet">glmnet</a>.
Low-dimensional projection functionality is provided by the <code>project</code> function (Fig.<a href="#fig:workflow">1</a>J).
Time-series classification operations are accessible via the <code>classify</code> function (Fig.<a href="#fig:workflow">1</a>K).
Distributional summaries of time-series feature and time-series classification values are available through the <code>interval</code> function (Fig.<a href="#fig:workflow">1</a>L).
Finally, basic cluster analysis is possible through the <code>cluster</code> function (Fig.<a href="#fig:workflow">1</a>M).
Importantly, <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> use R’s <code>S3</code> object-oriented programming system, meaning classes and their methods are defined to ensure easy usage with R generic functions, such as <code>plot</code>.
Classes are defined for feature-calculation objects (Fig.<a href="#fig:workflow">1</a>E; <code>feature_calculations</code>), low dimensional projection objects (Fig.<a href="#fig:workflow">1</a>I; <code>feature_projection</code>), interval calculation objects (Fig.<a href="#fig:workflow">1</a>K; <code>interval_calculations</code>), and cluster objects (Fig.<a href="#fig:workflow">1</a>L; <code>feature_clusters</code>).
The individual functions of both <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> are discussed in detail in the following sections.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:workflow"></span>
<img src="figures/workflow-graphic_ecosystem-final.png" alt="Workflow of the theft and theftdlc packages for R which takes the user from tidy time-series data through to feature extraction through to visualization and statistical analysis of features." width="400px" height="450px" />
<p class="caption">
Figure 1: theft and theftdlc together implement a workflow for extracting features from univariate time series and processing and analyzing the results. First, the user can install the relevant Python libraries (A) within R and point it to the correctly installed versions (B). Next, a time-series dataset (C) is converted into a tsibble (D) with key variables, a time index variable, and a measured variable. One or more feature sets or custom user-supplied features are then computed on the dataset (E). A range of statistical analysis and data visualization functionality is available in theftdlc on the resulting feature data, including: (F) normalized time series x feature matrix visualization; (G) normalized feature x feature correlation matrix visualization; (H) violin plots of feature distributions (including by group/class where applicable); (I) basic feature selection using penalized maximum likelihood generalized linear models; (J) low-dimensional projections of the feature space; (K) time-series classification procedures (a common application of feature-based time-series analysis); (L) evaluating the uncertainty intervals of the resulting performance metrics through a range of distributional summary methods; and uncovering hidden structure in time-series data through cluster analysis in the feature space.
</p>
</div>
</div>
<p>In this paper, we demonstrate how the <a href="https://cran.r-project.org/package=theft">theft</a> ecosystem can be used to tackle a time-series classification problem, using the Bonn University electroencephalogram (EEG) dataset as a case study <span class="citation" data-cites="andrzejakIndicationsNonlinearDeterministic2001">(<a href="#ref-andrzejakIndicationsNonlinearDeterministic2001" role="doc-biblioref">Andrzejak et al. 2001</a>)</span>.
The dataset contains 500 time series, each of length <span class="math inline">\(T = 4097\)</span>, with 100 time series each from five labeled classes: (i) awake with eyes open (labeled <code>eyesOpen</code>); (ii) awake with eyes closed (<code>eyesClosed</code>); (iii) epileptogenic zone (<code>epileptogenic</code>); (iv) hippocampal formation of the opposite hemisphere of the brain (<code>hippocampus</code>); and (v) seizure activity (<code>seizure</code>).
Note that classes (i) and (ii) are from healthy volunteers, while classes (iii), (iv), and (v) are from a presurgical diagnosis archive.
The time series are comprised of EEG segments 23.6 seconds in duration that were cut out of continuous multichannel recordings, converted from analog to digital using 12-bit conversion, and then written onto a computer at a sampling rate of 173.614Hz.
Further trimming of start and end discontinuities from the original 4396 samples was then performed, resulting in a final time series of length T = 4097 samples.
This dataset was chosen as a demonstrative example because it has been widely studied as a time-series classification problem, and prior studies have focused on properties of the dynamics that accurately distinguish the classes—which is well-suited to the feature-based approach.
For example, prior analysis (using <code>hctsa</code>) revealed that seizure recordings are characterized most notably by higher variance, as well as lower entropy, lower long-range scaling exponents, and many other differences <span class="citation" data-cites="fulcherHighlyComparativeTimeseries2013">(<a href="#ref-fulcherHighlyComparativeTimeseries2013" role="doc-biblioref">Fulcher et al. 2013</a>)</span>.
We can easily read the data file in from its zipper format online and convert to a <code>tsibble</code> ready for use:</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 data-number="2.1" id="system-requirements"><span class="header-section-number">2.1</span> System requirements</h3>
<p>In order to access the features from <code>tsfresh</code>, <code>TSFEL</code>, and <code>Kats</code> in <a href="https://cran.r-project.org/package=theft">theft</a>, Python &gt;=3.10 is required (Python 3.10 is recommended).
To use all other functionality across both <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>, only R &gt;=3.5.0 is required.</p>
<h3 data-number="2.2" id="installing-python-libraries"><span class="header-section-number">2.2</span> Installing Python libraries</h3>
<p>Prior to calculating features, the requisite Python feature sets need to be installed.
The <code>install_python_pkgs</code> function in <a href="https://cran.r-project.org/package=theft">theft</a> handles this operation entirely within R—all that needs to be supplied is <code>venv</code> (a string specifying the name of the new virtual environment to create) and <code>python</code> (a string specifying the filepath to the Python interpreter to use).
Note that the filepath to the Python interpreter will differ depending on the user’s operating system and will require correct specification.
For example, on Windows it might be a path similar to <code>"C:/Users/YourName/AppData/Local/Programs/Python/Python310/python.exe"</code>, whereas on Linux or MacOS (which was used for the present work) it could be a path similar to <code>"/usr/local/bin/python3.10"</code> or <code>"/usr/bin/python3"</code>.</p>
<p>An example call which installs the Python libraries into a new virtual environment and initiates the virtual environment within R is shown in the code below.
Note that <code>init_theft</code> only needs to be run once per session.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://hendersontrent.github.io/theft/reference/install_python_pkgs.html'>install_python_pkgs</a></span><span class='op'>(</span>venv <span class='op'>=</span> <span class='st'>"theft-eco-py"</span>, python <span class='op'>=</span> <span class='st'>"/usr/local/bin/python3.10"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://hendersontrent.github.io/theft/reference/init_theft.html'>init_theft</a></span><span class='op'>(</span><span class='st'>"theft-eco-py"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="2.3" id="extracting-features"><span class="header-section-number">2.3</span> Extracting features</h3>
<p>In feature-based time-series analysis, each univariate time series in a dataset is represented as a feature vector, such that the dataset can be represented as a time series <span class="math inline">\(\times\)</span> feature data matrix.
Any single feature set, or combination of multiple feature sets, can be computed for a given time-series dataset with the <a href="https://cran.r-project.org/package=theft">theft</a> function <code>calculate_features</code>.
<code>calculate_features</code> takes a <code>tbl_ts</code> as input, using the data structure defined by the <a href="https://cran.r-project.org/package=tsibble">tsibble</a> package for R <span class="citation" data-cites="tsibble_pkg">(<a href="#ref-tsibble_pkg" role="doc-biblioref">Wang et al. 2020</a>)</span>.
This ensures consistency with the broader <code>tidyverts</code> collection of R packages for conducting time-series analysis.
A <code>tbl_ts</code> is a temporal data structure which is defined by a <code>key</code> which identifies each unique time series and an <code>index</code> which identifies the time indices.
Other columns are treated as measured variables.
Since <code>theft</code> is a univariate tool, <code>calculate_features</code> only accepts inputs that have one measured variable.
Since much of the functionality in <code>theftdlc</code> is associated with time-series classification problems, if multiple keys are defined, the first is treated as an “ID” variable, while the second is treated as the “grouping” variable for classification.</p>
<p>Users can control various aspects of the feature extraction process through modification of optional arguments.
The <code>catch22</code> feature set can be expanded to form ‘catch24’ with included mean and standard deviation by setting <code>catch24 = TRUE</code>.
Features from the <code>"compengine"</code> subset of <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a> can be calculated by setting <code>use_compengine = TRUE</code> which substantially increases computation time for the addition of <span class="math inline">\(16\)</span> features.
The in-built algorithm in <code>tsfresh</code> for selecting relevant features can be used for that set by specifying <code>tsfresh_cleanup = TRUE</code> <span class="citation" data-cites="christDistributedParallelTime2017">(<a href="#ref-christDistributedParallelTime2017" role="doc-biblioref">Christ et al. 2017</a>)</span>.
In addition, it is a common practice in feature-based time-series analysis to quantify the relative performance of features.
For situations where differences in mean and variance are not of interest, <em>z</em>-scoring can be used to standardize each time series prior to the calculation of time-series features.
The argument <code>z_score</code> enables automatic normalization of each time series within <code>calculate_features</code> prior to computing features.
Further, users may always wish to disable package warnings when computing features.
This can be achieved by setting <code>warn = FALSE</code>.
Last, parallel processing can be engaged by setting the <code>n_jobs</code> argument to a value <span class="math inline">\(\geq 2\)</span> (<code>calculate_features</code> defaults to serial processing).
Currently, parallelization has only been implemented for <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a>, <code>tsfresh</code>, and <code>tsfel</code>.</p>
<p>The output of <code>calculate_features</code> is an S3 object of class <code>feature_calculations</code>, which in this example is stored in the R environment as <code>all_features</code>.
Within this object is a data frame which contains five columns if the dataset is labeled (as in time-series classification), and four otherwise: <code>id</code> (unique identifier for each time series), <code>names</code> (feature name), <code>values</code> (feature value), <code>feature_set</code> (feature set name), and <code>group</code> (class label, if applicable).
This output structure ensures that, regardless of the feature set selected, the resulting object is always of the same format and can be used with the rest of the <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> functions without manual data reshaping.</p>
<p>For the Bonn EEG dataset of 500 time series, each of length <span class="math inline">\(T = 4097\)</span> samples, calculating features for all sets in <a href="https://cran.r-project.org/package=theft">theft</a> took <span class="math inline">\(\approx 5.7\)</span> hours on a 2019 MacBook Pro with an Intel Core i7 2.6 GHz 6-Core CPU. The extensive computation time was largely driven by <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a>, noting that the other five sets ranged from just seconds (<code>catch22</code>) to several minutes. With the sixteen <code>"compengine"</code> features enabled, computation time increased to <span class="math inline">\(\approx 11.8\)</span> hours. Previous work provides a comprehensive discussion of computation speed between the sets and the scalability with time-series length <span class="citation" data-cites="hendersonEmpiricalEvaluationTimeSeries2021">(<a href="#ref-hendersonEmpiricalEvaluationTimeSeries2021" role="doc-biblioref">Henderson and Fulcher 2021</a>)</span>. An example call which extracts features from all six sets for the Bonn EEG dataset is shown in the code below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>all_features</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://hendersontrent.github.io/theft/reference/calculate_features.html'>calculate_features</a></span><span class='op'>(</span></span>
<span>  data <span class='op'>=</span> <span class='va'>bonn_eeg</span>, </span>
<span>  feature_set <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"catch22"</span>, <span class='st'>"feasts"</span>, <span class='st'>"tsfeatures"</span>, </span>
<span>                  <span class='st'>"tsfresh"</span>, <span class='st'>"tsfel"</span>, <span class='st'>"kats"</span><span class='op'>)</span>,</span>
<span>  use_compengine <span class='op'>=</span> <span class='cn'>FALSE</span>, catch24 <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><a href="https://cran.r-project.org/package=theft">theft</a> is also set up to enable users to calculate their own custom features. For example, we could specify two new features such as the mean and standard deviation by adding the requisite functions and the names for those features in a list to the additional <code>features</code> argument, as demonstrated in the code below.
User-supplied functions must take a vector input and return a numeric scalar value to be a valid time-series feature.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>all_features_msd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://hendersontrent.github.io/theft/reference/calculate_features.html'>calculate_features</a></span><span class='op'>(</span></span>
<span>                        data <span class='op'>=</span> <span class='va'>bonn_eeg</span>, </span>
<span>                        feature_set <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"catch22"</span>, <span class='st'>"feasts"</span>, <span class='st'>"tsfeatures"</span>, </span>
<span>                                        <span class='st'>"tsfresh"</span>, <span class='st'>"tsfel"</span>, <span class='st'>"kats"</span><span class='op'>)</span>,</span>
<span>                        features <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"mean"</span> <span class='op'>=</span> <span class='va'>mean</span>, <span class='st'>"sd"</span> <span class='op'>=</span> <span class='va'>sd</span><span class='op'>)</span>,</span>
<span>                        use_compengine <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In addition, previous work highlighted that it can be helpful to provide a simple benchmark of performance for the more comprehensive feature sets <span class="citation" data-cites="henderson2023dullmomentdistributionalproperties">(<a href="#ref-henderson2023dullmomentdistributionalproperties" role="doc-biblioref">Henderson et al. 2023</a>)</span>.
As such, two simple feature sets—<code>“quantiles”</code> and <code>“moments”</code>—are also available in <code>calculate_features</code> to enable the quick computation of a set of quantiles and the first four moments of the distribution to serve as a baseline for more sophisticated feature sets.
<code>“quantiles”</code> and <code>“moments”</code> are both able to be specified directly as values to the <code>feature_set</code> argument of <code>calculate_features</code>.
By default, the <code>"quantiles"</code> feature set includes a collection of <span class="math inline">\(100\)</span> quantiles from the range <span class="math inline">\(0.01\)</span> to <span class="math inline">\(1\)</span>.</p>
<p>Users who wish to explore the computed results efficiently can also download the pre-computed features and classifiers used in this paper:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>files</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"all_features"</span>, <span class='st'>"mf_results"</span>, <span class='st'>"feature_classifiers"</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>f</span> <span class='kw'>in</span> <span class='va'>files</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/download.file.html'>download.file</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"https://github.com/hendersontrent/bonn-eeg-data/raw/refs/heads/main/"</span>, </span>
<span>                       <span class='va'>f</span>, <span class='st'>".Rda"</span><span class='op'>)</span>, <span class='va'>temp</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<h3 data-number="2.4" id="normalizing-features"><span class="header-section-number">2.4</span> Normalizing features</h3>
<p>Different features vary over very different ranges; e.g., features that estimate <span class="math inline">\(p\)</span>-values from a hypothesis test vary over the unit interval, whereas a feature that computes the length of a time series takes (often large) positive integer values.
These differences in scale can complicate the visualization of feature behavior and the construction of statistical learning algorithms involving diverse features.
To overcome these limitations, a common pre-processing step involves scaling all features.
Several of <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>’s internal functions utilize rescaling functionality—specifically, providing the user the choice of five methods for converting a set of raw feature values, <span class="math inline">\(\mathbf{x}\)</span>, to a normalized version, <span class="math inline">\(\mathbf{z}\)</span>:</p>
<ol type="1">
<li><span class="math inline">\(z\)</span>-score (<code>"zScore"</code>): <span class="math inline">\(z_i = \frac{x_i - \mu}{\sigma}\)</span>,</li>
<li>linear scaling to unit interval (<code>"MinMax"</code>): <span class="math inline">\(z_i = \frac{x_i - \min(\mathbf{x})}{\max(\mathbf{x}) - \min(\mathbf{x})}\)</span>,</li>
<li>maximum absolute scaling (<code>"MaxAbs"</code>): <span class="math inline">\(z_{i} = \frac{x_{i}}{|\text{max}(\mathbf{x})|}\)</span></li>
<li>sigmoid (<code>"Sigmoid"</code>): <span class="math inline">\(z_i = \left[1 + \exp(-\frac{x_i - \mu}{\sigma})\right]^{-1}\)</span>,</li>
<li>and outlier-robust sigmoid (<code>"RobustSigmoid"</code>): <span class="math inline">\(z_i = \left[1 + \exp\left(-\frac{x_i - \mathrm{median}(\mathbf{x})}{\mathrm{IQR}(\mathbf{x})/{1.35}}\right)\right]^{-1}\)</span>,</li>
</ol>
<p>where <span class="math inline">\(\mu\)</span> is the mean, <span class="math inline">\(\sigma\)</span> is the standard deviation, and <span class="math inline">\(\mathrm{IQR}(\mathbf{x})\)</span> is the interquartile range of <span class="math inline">\(\mathbf{x}\)</span>.
All four transformations end with a linear rescaling to the unit interval.
The outlier-robust sigmoid transformation, introduced in <span class="citation" data-cites="fulcherHighlyComparativeTimeseries2013">(<a href="#ref-fulcherHighlyComparativeTimeseries2013" role="doc-biblioref">Fulcher et al. 2013</a>)</span>, can be helpful in normalizing feature-value distributions with large outliers.
Feature normalization is implemented in the R package <a href="https://cran.r-project.org/package=normaliseR">normaliseR</a> which is a key dependency for <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> <span class="citation" data-cites="normaliseR_pkg">(<a href="#ref-normaliseR_pkg" role="doc-biblioref">Henderson 2024</a>)</span>.</p>
<h3 data-number="2.5" id="visualizing-the-feature-matrix"><span class="header-section-number">2.5</span> Visualizing the feature matrix</h3>
<p>A hallmark of large-scale feature extraction is the ability to visualize the intricate patterns of how different time-series analysis algorithms behave across a time-series dataset.
This can be achieved in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> by specifying <code>type = "matrix"</code> when calling <code>plot</code> on a <code>feature_calculations</code> object to produce a heatmap of the time series (rows) <span class="math inline">\(\times\)</span> feature matrix (columns) which organizes the rows and columns to help reveal interesting patterns in the data.
The plot of the combination of all six open feature sets for the Bonn EEG dataset is shown in Figure <a href="#fig:featureMatrix">2</a>.
We can see some informative structure in this graphic, including many groups of features with similar behavior on this dataset (i.e., columns with similar patterns), indicating substantial redundancy across the joint set of features <span class="citation" data-cites="hendersonEmpiricalEvaluationTimeSeries2021">(<a href="#ref-hendersonEmpiricalEvaluationTimeSeries2021" role="doc-biblioref">Henderson and Fulcher 2021</a>)</span>.
The bottom block of 100 rows, which visually have the most distinctive properties, was found to correspond to time series from the <code>seizure</code> class, indicating the ability of this large combination of time-series features to meaningfully structure the dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>all_features</span>, </span>
<span>     type <span class='op'>=</span> <span class='st'>"matrix"</span>, </span>
<span>     norm_method <span class='op'>=</span> <span class='st'>"RobustSigmoid"</span>, </span>
<span>     clust_method <span class='op'>=</span> <span class='st'>"average"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure"><span style="display:block;" id="fig:featureMatrix"></span>
<img src="RJ-2025-023_files/figure-html5/featureMatrix-1.png" alt="A time series by feature matrix heatmap produced by generating a matrix plot on the feature calculations object. Extracted feature vectors for each time series (500) in the Bonn EEG dataset using all six feature sets in theft (1005 features in total, after filtering out 85 features with NaN values) are represented as a heatmap. Similar features (columns) and time series (rows) are positioned close to each other using (average) hierarchical clustering. Each tile is a normalized value for a given time series and feature." width="480" />
<p class="caption">
Figure 2: A time series by feature matrix heatmap produced by generating a matrix plot on the feature calculations object. Extracted feature vectors for each time series (500) in the Bonn EEG dataset using all six feature sets in theft (1005 features in total, after filtering out 85 features with NaN values) are represented as a heatmap. Similar features (columns) and time series (rows) are positioned close to each other using (average) hierarchical clustering. Each tile is a normalized value for a given time series and feature.
</p>
</div>
</div>
<p>In matrix plots in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>, hierarchical clustering is used to reorder rows and columns so that time series (rows) with similar properties are placed close to each other and features (columns) with similar behavior across the dataset are placed close to each other—where similarity in behavior is quantified using Euclidean distance in both cases <span class="citation" data-cites="dayEfficientAlgorithmsAgglomerative1984">(<a href="#ref-dayEfficientAlgorithmsAgglomerative1984" role="doc-biblioref">Day and Edelsbrunner 1984</a>)</span>.
In Figure <a href="#fig:featureMatrix">2</a>, we specify the usage of average (i.e., unweighted pair group method with arithmetic mean) agglomeration.
Default settings within <code>plot</code> enable users to easily generate outputs in a single line of code, but more advanced users may seek to tweak the optional arguments.
For example, different linkage algorithms for hierarchical clustering can be controlled by supplying the argument to <code>clust_method</code>, which uses average agglomeration as a default, and the different rescaling methods defined earlier can be supplied to the <code>norm_method</code> argument, which defaults to <code>"zScore"</code>.</p>
<h3 data-number="2.6" id="projecting-low-dimensional-feature-spaces"><span class="header-section-number">2.6</span> Projecting low-dimensional feature-spaces</h3>
<p>Low-dimensional projections are a useful tool for visualizing the structure of high-dimensional datasets in low-dimensional spaces.
Here we are interested in representing a time-series dataset in a two-dimensional projection of the feature space, which can reveal structure in the dataset, including how different labeled classes are organized.
For linear dimensionality reduction techniques, such as principal components analysis (PCA) <span class="citation" data-cites="PrincipalComponentAnalysis2002">(<a href="#ref-PrincipalComponentAnalysis2002" role="doc-biblioref">Jolliffe 2002</a>)</span>, the results can be visualized in two dimensions as a scatterplot, where the principal component (PC) that explains the most variance in the data is positioned on the horizontal axis and the second PC on the vertical axis, and each time series is represented as a point (colored by its group label in the case of a labeled dataset).
When the structure of a dataset in the low-dimensional feature space matches known aspects of the dataset (such as class labels), it suggests that the combination of diverse time-series features can capture relevant dynamical properties that differ between the classes.
It can also reveal new types of structure in the dataset, like clear sub-clusters within a labeled class, that can guide new understanding of the dataset.
Low-dimensional projections of time-series features have been shown to meaningfully structure time-series datasets: revealing sex and day/night differences in <em>Drosophila</em> <span class="citation" data-cites="fulcherHctsaComputationalFramework2017">(<a href="#ref-fulcherHctsaComputationalFramework2017" role="doc-biblioref">Fulcher and Jones 2017</a>)</span>, distinguishing types of stars based on their light curves <span class="citation" data-cites="barbaraClassifyingKeplerLight2022">(<a href="#ref-barbaraClassifyingKeplerLight2022" role="doc-biblioref">Barbara et al. 2022</a>)</span>, and categorizing sleep epochs <span class="citation" data-cites="decatTraditionalSleepScoring2022">(<a href="#ref-decatTraditionalSleepScoring2022" role="doc-biblioref">Decat et al. 2022</a>)</span>.</p>
<p>Several algorithms for projecting feature spaces are available in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>:</p>
<ul>
<li>Principal components analysis (PCA)—<code>"PCA"</code></li>
<li><span class="math inline">\(t\)</span>-Stochastic Neighbor Embedding (<span class="math inline">\(t\)</span>-SNE)—<code>"tSNE"</code></li>
<li>Classical multidimensional scaling (MDS)—<code>"ClassicalMDS"</code></li>
<li>Kruskal’s non-metric multidimensional scaling—<code>"KruskalMDS"</code></li>
<li>Sammon’s non-linear mapping non-metric multidimensional scaling—<code>"SammonMDS"</code></li>
<li>Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP)—<code>"UMAP"</code></li>
</ul>
<p>Time-series datasets can be projected in low-dimensional feature spaces in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> using the <code>project</code> function.
Users can control algorithm hyperparameters by supplying additional arguments to the <code>...</code> argument of <code>project</code>—the function then passes these arguments to the requisite dimension reduction algorithm internally.
The <code>project</code> function returns an <code>S3</code> object of class <code>feature_projection</code>, which can then be passed to <code>plot</code> which will automatically draw the appropriate two-dimensional scatterplot.
The <code>feature_projection</code> class is a list object which contains elements representing the user-supplied feature data frame, the model data, the two-dimensional projected data frame, and the model fit object itself.
The plot method for this object contains only one other argument (<code>show_covariance</code>) which specifies whether to draw covariance ellipses for each group in the scatterplot (if a grouping variable is detected).</p>
<p>The low-dimensional projection plot for the Bonn EEG dataset (using <span class="math inline">\(t\)</span>-SNE and all <span class="math inline">\(&gt;1000\)</span> non-<code>NaN</code> features across the six feature sets included in <a href="https://cran.r-project.org/package=theft">theft</a>) is shown in Figure <a href="#fig:tsne">3</a> with perplexity <span class="math inline">\(15\)</span>, as produced by the code below.
The low-dimensional projection meaningfully structures the labeled classes of the dataset.
Specifically, two of the presurgical diagnosis classes—<code>epileptogenic</code> (epileptogenic zone) and <code>hippocampus</code> (hippocampal formation of the opposite hemisphere of the brain)—appear to exhibit considerable overlap in the projected space, while the two healthy volunteer classes <code>eyesOpen</code> (awake state with eyes open) and <code>eyesClosed</code> (awake state with eyes closed) occupy space further away from the other classes but closer to each other.
The <code>seizure</code> class occupies a space largely separate from the other four classes in the projection, consistent with its distinctive periodic dynamics <span class="citation" data-cites="fulcherHighlyComparativeTimeseries2013">(<a href="#ref-fulcherHighlyComparativeTimeseries2013" role="doc-biblioref">Fulcher et al. 2013</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>low_dim_calc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/project.html'>project</a></span><span class='op'>(</span><span class='va'>all_features</span>, </span>
<span>                        method <span class='op'>=</span> <span class='st'>"MinMax"</span>, </span>
<span>                        low_dim_method <span class='op'>=</span> <span class='st'>"tSNE"</span>, </span>
<span>                        perplexity <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>low_dim_calc</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:tsne"></span>
<img src="RJ-2025-023_files/figure-html5/tsne-1.png" alt="Low-dimensional projection of the Bonn EEG dataset using theft. Using t-SNE with perplexity 15, the high-dimensional feature space of &gt;1000 features is projected into two dimensions. Each point represents a time series which is colored according to its class label. Time series that are located close in this space have similar properties, as measured by the six feature sets in theft." width="576" />
<p class="caption">
Figure 3: Low-dimensional projection of the Bonn EEG dataset using theft. Using t-SNE with perplexity 15, the high-dimensional feature space of &gt;1000 features is projected into two dimensions. Each point represents a time series which is colored according to its class label. Time series that are located close in this space have similar properties, as measured by the six feature sets in theft.
</p>
</div>
</div>
<h3 data-number="2.7" id="constructing-classifiers-with-multiple-features"><span class="header-section-number">2.7</span> Constructing classifiers with multiple features</h3>
<p>Combinations of complementary, discriminative features can often be used to construct accurate time-series classifiers <span class="citation" data-cites="fulcherHighlyComparativeFeaturebased2014">(<a href="#ref-fulcherHighlyComparativeFeaturebased2014" role="doc-biblioref">Fulcher and Jones 2014</a>)</span>.
Drawing on computed time-series features (that may derive from one or more existing feature sets), <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> can fit and evaluate classifiers using the <code>classify</code> function.
This allows users to evaluate the relative performance of each feature set, of the combination of all sets, or any other combination of features.
Providing easy access to a range of classification algorithms and accompanying inferential tools (such as null permutation testing to obtain <span class="math inline">\(p\)</span>-values and performance distributions through the resampling-based algorithm) through <code>classify</code> allows users to compare sets of features to better understand the most accurate feature sets for a given time-series classification problem.
The code presented below provides an example usage for the Bonn EEG dataset with a linear support vector machine (SVM) classifier (which is the default and so does not require explicit specification).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mf_results</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/classify.html'>classify</a></span><span class='op'>(</span></span>
<span>                data <span class='op'>=</span> <span class='va'>all_features</span>, </span>
<span>                by_set <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>                train_size <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>                n_resamples <span class='op'>=</span> <span class='fl'>100</span>,</span>
<span>                use_null <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The <code>classify</code> function is flexible in that users can supply any function that can be used with R’s native <code>stats::predict</code> generic.
For example, a user could easily use a radial basis function SVM instead:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>rbfClassifier</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'>e1071</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/e1071/man/svm.html'>svm</a></span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='va'>data</span>, kernel <span class='op'>=</span> <span class='st'>"radial"</span>, scale <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                    probability <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>mf_results_rbf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/classify.html'>classify</a></span><span class='op'>(</span></span>
<span>                    data <span class='op'>=</span> <span class='va'>all_features</span>, </span>
<span>                    classifier <span class='op'>=</span> <span class='va'>rbfClassifier</span>,</span>
<span>                    by_set <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>                    train_size <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>                    n_resamples <span class='op'>=</span> <span class='fl'>100</span>,</span>
<span>                    use_null <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In the above code, we specified that we want <code>classify</code> to fit separate classifiers for each feature set, using a training set size that is <span class="math inline">\(80\%\)</span> of the input data size, with <span class="math inline">\(100\)</span> resamples for each feature set as a way to incorporate uncertainty.
We also enabled null model fitting for permutation testing.
In applications involving small datasets, or when small effects are expected, it is useful to quantify how different the observed classification performance is from a null setting in which data are classified randomly (i.e., could the same results have been obtained by chance?).
One method for inferring test statistics is to use permutation testing—a procedure that samples a null process many times to form a distribution against which a value of importance (i.e., the classification accuracy result from a model) can be compared to estimate a <span class="math inline">\(p\)</span>-value <span class="citation" data-cites="ojalaPermutationTestsStudying2009">(<a href="#ref-ojalaPermutationTestsStudying2009" role="doc-biblioref">Ojala and Garriga 2009</a>)</span>.
In <a href="https://cran.r-project.org/package=theft">theft</a>, permutation testing is implemented for evaluating classification performance in <code>classify</code> through the <code>use_null</code> argument.
When set to <code>TRUE</code>, <code>classify</code> will compute results for <code>n_resamples</code> models where the class labels match the data, but also <code>n_resamples</code> models where the class labels are shuffled, thus severing the input-output relationship.
In the absence of any data errors, we would expect the mean classification accuracy for the empirical null distribution to approximate chance for the problem.
This provides a useful comparison point for the main (non-shuffled) models—if the main models statistically outperform the empirical null models, then the result, quantified by the <span class="math inline">\(p\)</span>-value, is likely not due to chance, thus indicating that the set of time-series features represent quantities that can meaningfully capture differences between classes.</p>
<p>The resampling procedure begins by partitioning the input data into <code>n_samples</code> number of seeded train-test splits for reproducibility, using <code>train_size</code> to govern the size of the training set for each split.
Importantly, the procedure tracks the class representation in the first resample and preserves these proportions for all subsequent resamples.
The feature data for each resample is then normalized as a <span class="math inline">\(z\)</span>-score by computing the mean and standard deviation of each feature in the training set, and using these values to rescale both the training and test sets.
This ensures that test data are completely unseen.
The procedure then iterates over each resample and fits the classification algorithm for each.
By default, <code>classify</code> calculates the following accuracy metrics, where <span class="math inline">\(C\)</span> is the number of classes, <span class="math inline">\(TP\)</span> is the number of true positives, <span class="math inline">\(FP\)</span> is the number of false positives, and <span class="math inline">\(FN\)</span> is the number of false negatives:</p>
<ul>
<li>Accuracy (<code>"accuracy"</code>): <span class="math inline">\(\frac{\sum^{C}_{i=1}TP_{i}}{\sum^{C}_{i=1} (TP_{i} + FP_{i} + FN_{i})}\)</span></li>
<li>Mean precision (<code>"precision"</code>): <span class="math inline">\(\frac{1}{C}\sum^{C}_{i=1}\frac{\text{TP}_{i}}{\text{TP}_{i} + \text{FP}_{i}}\)</span></li>
<li>Mean recall (<code>"recall"</code>): <span class="math inline">\(\frac{1}{C}\sum^{C}_{i=1}\frac{\text{TP}_{i}}{\text{TP}_{i} + \text{FN}_{i}}\)</span></li>
<li>F1 score (<code>"f1"</code>): <span class="math inline">\(2 \frac{\text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}\)</span></li>
</ul>
<p><code>classify</code> returns a list with two elements: (i) the train and test sizes; and (ii) a data frame of classification results.
While the raw results are useful, <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> enables automated analysis of them.
The <code>theftdlc::interval</code> and <code>compare_features</code> functions were designed to enable fast and intuitive comparisons between individual features and entire sets.
<code>theftdlc::interval</code> produces summaries of classification results with uncertainty using three distinct methods: (i) standard deviation—<code>"sd"</code>; (ii) confidence interval based off the <span class="math inline">\(t\)</span>-distribution—<code>"se"</code>; and (iii) quantile summary—<code>"quantile"</code>.</p>
<p>Users can compute different interval summaries by modifying the additional arguments:</p>
<ul>
<li><code>metric</code>—the classification performance metric to calculate intervals for. Can be one of <code>"accuracy"</code>, <code>"precision"</code>, <code>"recall"</code>, or <code>"f1"</code></li>
<li><code>by_set</code>—whether to compute intervals for each feature set. If <code>FALSE</code>, the function will instead calculate intervals for each individual feature</li>
<li><code>type</code>—whether to calculate a <span class="math inline">\(\pm SD\)</span> interval with <code>"sd"</code>, confidence interval based off the <span class="math inline">\(t\)</span>-distribution with <code>"se"</code>, or a quantile with <code>"quantile"</code></li>
<li><code>interval</code>—the width of the interval to calculate. Defaults to <span class="math inline">\(1\)</span> if <code>type = "sd"</code> to produce a <span class="math inline">\(\pm 1SD\)</span> interval. Defaults to <code>0.95</code> if <code>type = "se"</code> or <code>type = "quantile"</code> for a <span class="math inline">\(95\%\)</span> interval</li>
<li><code>model_type</code>—whether to calculate intervals for main models with <code>"main"</code> or null models with <code>"null"</code> if the <code>use_null</code> argument of <code>classify</code> was <code>use_null = TRUE</code></li>
</ul>
<p>Below we calculate the mean <span class="math inline">\(\pm 1SD\)</span> for each feature set.
For the Bonn EEG dataset, we find that the set of all features (<code>All features</code>) produced the highest mean classification accuracy (<span class="math inline">\(91.2\%\)</span>) and <code>catch22</code> (the smallest feature set) produced the lowest mean accuracy (<span class="math inline">\(80.1\%\)</span>).
The best performing individual feature set was the largest—<code>tsfresh</code>—with a mean classification accuracy of <span class="math inline">\(90.8\%\)</span> which was marginally below the set of all features.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>set_intervals</span> <span class='op'>&lt;-</span> <span class='fu'>theftdlc</span><span class='fu'>::</span><span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/interval.html'>interval</a></span><span class='op'>(</span></span>
<span>  <span class='va'>mf_results</span>, </span>
<span>  metric <span class='op'>=</span> <span class='st'>"accuracy"</span>,</span>
<span>  by_set <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  type <span class='op'>=</span> <span class='st'>"sd"</span>,</span>
<span>  model_type <span class='op'>=</span> <span class='st'>"main"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>set_intervals</span></span></code></pre>
</div>
<pre><code>   feature_set  .mean    .lower    .upper
1 All features 0.9115 0.8827069 0.9402931
2         Kats 0.8274 0.7908680 0.8639320
3        TSFEL 0.8353 0.8019226 0.8686774
4      catch22 0.8005 0.7691217 0.8318783
5       feasts 0.8525 0.8172126 0.8877874
6   tsfeatures 0.8363 0.8061940 0.8664060
7      tsfresh 0.9079 0.8783138 0.9374862</code></pre>
</div>
<p><code>theftdlc::interval</code> returns an <code>S3</code> object of class <code>interval_calculations</code> which is a data frame that can be used with the <code>plot</code> generic through <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>.
The resulting plot is presented in Figure <a href="#fig:featureSetComparisons">4</a> where we see the considerable overlap in mean <span class="math inline">\(\pm 1SD\)</span> classification accuracy between the feature sets.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>set_intervals</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure"><span style="display:block;" id="fig:featureSetComparisons"></span>
<img src="RJ-2025-023_files/figure-html5/featureSetComparisons-1.png" alt="Comparison of mean classification accuracy between feature sets in theft for the five-class Bonn EEG classification task. Classification accuracy using a linear SVM is presented for each of the six feature sets in theft as well as the combination of all their features. The number of features retained for analysis after filtering is displayed in parentheses after the feature set name on the horizontal axis which has been sorted from highest to lowest mean accuracy. Mean classification accuracy across the same 100 resamples is displayed as colored points for each set with one standard deviation error bars." width="480" />
<p class="caption">
Figure 4: Comparison of mean classification accuracy between feature sets in theft for the five-class Bonn EEG classification task. Classification accuracy using a linear SVM is presented for each of the six feature sets in theft as well as the combination of all their features. The number of features retained for analysis after filtering is displayed in parentheses after the feature set name on the horizontal axis which has been sorted from highest to lowest mean accuracy. Mean classification accuracy across the same 100 resamples is displayed as colored points for each set with one standard deviation error bars.
</p>
</div>
</div>
<p>While the visual aid is useful, we often want to understand if a given feature set has performed better than we might expect due to chance.
Or can we determine if a given feature set has statistically outperformed another (such as the set of all features compared to <code>tsfresh</code>), therefore providing guidance on which features to retain for subsequent analysis?
How can we estimate if the performance of the smallest and fastest-to-compute set – <code>catch22</code> – is meaningfully different from the larger feature sets with close average classification accuracy values (i.e., <code>Kats</code>, <code>TSFEL</code>, and <code>tsfeatures</code>)?
The <code>compare_features</code> function in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> enables pairwise comparisons between either individual features or entire feature sets, or to their own respective empirical null distributions (i.e., the ‘chance’ distribution).
It does so through usage of the resampled <span class="math inline">\(t\)</span>-test which accounts for the correlation between samples in the calculation of the test statistic <span class="citation" data-cites="nadeauInferenceGeneralizationError2003">(<a href="#ref-nadeauInferenceGeneralizationError2003" role="doc-biblioref">Nadeau and Bengio 2003</a>)</span>.
The resampled <span class="math inline">\(t\)</span>-test is implemented through the <a href="https://cran.r-project.org/package=correctR">correctR</a> R package <span class="citation" data-cites="correctR_pkg">(<a href="#ref-correctR_pkg" role="doc-biblioref">Henderson 2025a</a>)</span>.
<code>compare_features</code> returns a data frame with columns for the hypothesis that was tested, the test statistic, <span class="math inline">\(p\)</span>-value, adjusted <span class="math inline">\(p\)</span>-value (if specified), and the means of each group for each hypothesis test.
<code>compare_features</code> can operate on any of the metrics computed in <code>classify</code>.
The function only takes a small number of arguments in addition to the output of <code>classify</code>:</p>
<ul>
<li><code>metric</code>—the classification performance metric to calculate intervals for. Can be one of <code>"accuracy"</code>, <code>"precision"</code>, <code>"recall"</code>, or <code>"f1"</code></li>
<li><code>by_set</code>—whether to compare entire feature sets (<code>TRUE</code>) or individual features (<code>FALSE</code>)</li>
<li><code>hypothesis</code>—whether to compare each entire feature set or individual feature to its own empirical null distribution (<code>"null"</code>, if permutation testing was used in <code>classify</code>) or to each other (<code>"pairwise"</code>)</li>
<li><code>p_adj</code>—method for adjusting <span class="math inline">\(p\)</span>-values for multiple comparisons. Defaults to <code>"none"</code> for no adjustments, but can take any valid option received by <code>stats::p.adjust</code></li>
</ul>
<p>For example, we can statistically compare the performance of each feature set against their empirical null distributions (formed by the distribution of performance on shuffled class label data) using the code presented below.
When specifying <code>hypothesis = "null"</code>, <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> automatically applies a one-tailed test, since the hypothesis is that the main models should outperform their null counterparts.
We find that, for the full Bonn EEG dataset with 100 time series per class and strong differences between signals, mean classification accuracy for each feature set is far higher than chance level (<span class="math inline">\(20\%\)</span>) over 100 resamples.
Further, we obtain extremely small <span class="math inline">\(p\)</span>-values close to zero (displayed in the table below as zero due to rounding for visual clarity), providing support for the low probability of obtaining classification accuracy results at least as extreme as what we observed under the null hypothesis.
This confirms that time-series features can effectively distinguish between classes in the dataset.
Note that we drop some of the columns reported by <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> here for spatial reasons.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/compare_features.html'>compare_features</a></span><span class='op'>(</span><span class='va'>mf_results</span>,</span>
<span>                 metric <span class='op'>=</span> <span class='st'>"accuracy"</span>,</span>
<span>                 by_set <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                 hypothesis <span class='op'>=</span> <span class='st'>"null"</span>,</span>
<span>                 p_adj <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">hypothesis</th>
<th style="text-align: right;">set_mean</th>
<th style="text-align: right;">null_mean</th>
<th style="text-align: right;">t_statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">All features != own null</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">12.496</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kats != own null</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.188</td>
<td style="text-align: right;">9.701</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSFEL != own null</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">0.197</td>
<td style="text-align: right;">10.638</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">catch22 != own null</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">8.699</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">feasts != own null</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">10.003</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfeatures != own null</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">0.197</td>
<td style="text-align: right;">11.157</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tsfresh != own null</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">13.787</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p>We can then compare the feature sets to one another to provide statistical evidence for any differences in the performance ranges visualized in Figure <a href="#fig:featureSetComparisons">4</a> using the code below.
For <code>hypothesis = "pairwise"</code>, <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> applies a two-tailed test.
We find that the set of all features outperforms all individual sets at <span class="math inline">\(\alpha&lt;0.05\)</span> except for <code>tsfresh</code> (<span class="math inline">\(p = 0.820\)</span>), <code>feasts</code> (<span class="math inline">\(p = 0.094\)</span>), and <code>tsfeatures</code> (<span class="math inline">\(p = 0.077\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/compare_features.html'>compare_features</a></span><span class='op'>(</span><span class='va'>mf_results</span>,</span>
<span>                 metric <span class='op'>=</span> <span class='st'>"accuracy"</span>,</span>
<span>                 by_set <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                 hypothesis <span class='op'>=</span> <span class='st'>"pairwise"</span>,</span>
<span>                 p_adj <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<table>
<colgroup>
<col style="width: 39%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 17%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">hypothesis</th>
<th style="text-align: right;">set_a_mean</th>
<th style="text-align: right;">set_b_mean</th>
<th style="text-align: right;">t_statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">All features != catch22</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">3.026</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;">All features != feasts</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">1.713</td>
<td style="text-align: right;">0.090</td>
</tr>
<tr class="odd">
<td style="text-align: left;">All features != Kats</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">2.306</td>
<td style="text-align: right;">0.023</td>
</tr>
<tr class="even">
<td style="text-align: left;">All features != tsfeatures</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">2.066</td>
<td style="text-align: right;">0.041</td>
</tr>
<tr class="odd">
<td style="text-align: left;">All features != TSFEL</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">2.058</td>
<td style="text-align: right;">0.042</td>
</tr>
<tr class="even">
<td style="text-align: left;">All features != tsfresh</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">0.198</td>
<td style="text-align: right;">0.843</td>
</tr>
<tr class="odd">
<td style="text-align: left;">catch22 != feasts</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">-1.249</td>
<td style="text-align: right;">0.215</td>
</tr>
<tr class="even">
<td style="text-align: left;">catch22 != Kats</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">-0.634</td>
<td style="text-align: right;">0.527</td>
</tr>
<tr class="odd">
<td style="text-align: left;">catch22 != tsfeatures</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">-0.871</td>
<td style="text-align: right;">0.386</td>
</tr>
<tr class="even">
<td style="text-align: left;">catch22 != TSFEL</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">-0.873</td>
<td style="text-align: right;">0.385</td>
</tr>
<tr class="odd">
<td style="text-align: left;">catch22 != tsfresh</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">-2.776</td>
<td style="text-align: right;">0.007</td>
</tr>
<tr class="even">
<td style="text-align: left;">feasts != Kats</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.564</td>
</tr>
<tr class="odd">
<td style="text-align: left;">feasts != tsfeatures</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">0.414</td>
<td style="text-align: right;">0.680</td>
</tr>
<tr class="even">
<td style="text-align: left;">feasts != TSFEL</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.676</td>
</tr>
<tr class="odd">
<td style="text-align: left;">feasts != tsfresh</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">-1.436</td>
<td style="text-align: right;">0.154</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kats != tsfeatures</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">-0.198</td>
<td style="text-align: right;">0.843</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kats != TSFEL</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">-0.183</td>
<td style="text-align: right;">0.855</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kats != tsfresh</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">-2.006</td>
<td style="text-align: right;">0.048</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tsfeatures != TSFEL</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.980</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfeatures != tsfresh</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">-1.796</td>
<td style="text-align: right;">0.076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSFEL != tsfresh</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">-1.913</td>
<td style="text-align: right;">0.059</td>
</tr>
</tbody>
</table>
</div>
<h3 data-number="2.8" id="finding-and-understanding-informative-individual-features"><span class="header-section-number">2.8</span> Finding and understanding informative individual features</h3>
<p>Fitting models which use multiple features as inputs is often useful for predicting class labels.
However, users are also typically interested in understanding patterns in their dataset, such as interpreting the types of time-series analysis methods that best separate different classes, and the relationships between these top-performing features.
This can be achieved using mass univariate statistical testing of individual features, quantifying their performance either relative to an empirical null distribution or each other.
<a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> implements the ability to identify top-performing features in the <code>compare_features</code> function by setting <code>by_set = FALSE</code>, with an example usage for the Bonn EEG dataset (using features from all six packages) shown in the code below.
We implement parallel processing to speed up computation time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>feature_classifiers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/classify.html'>classify</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>all_features</span>, </span>
<span>                               by_set <span class='op'>=</span> <span class='cn'>FALSE</span>, </span>
<span>                               train_size <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>                               n_resamples <span class='op'>=</span> <span class='fl'>100</span>,</span>
<span>                               use_null <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>feature_vs_null</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://hendersontrent.github.io/theftdlc/reference/compare_features.html'>compare_features</a></span><span class='op'>(</span><span class='va'>feature_classifiers</span>,</span>
<span>                                    by_set <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                                    hypothesis <span class='op'>=</span> <span class='st'>"null"</span>,</span>
<span>                                    n_workers <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Straightforward <a href="https://cran.r-project.org/package=dplyr">dplyr</a> syntax can then be used to identify the top <span class="math inline">\(n\)</span> features <span class="citation" data-cites="dplyr_pkg">(<a href="#ref-dplyr_pkg" role="doc-biblioref">Wickham et al. 2023</a>)</span>.
We have the choice of either mean classification accuracy or <span class="math inline">\(p\)</span>-values relative to the empirical null to determine informative features.
For illustrative purposes, here we have used mean classification accuracy to find the top <span class="math inline">\(n = 40\)</span> features.
We show the top 20 features below for spatial reasons.
We see that the <span class="math inline">\(17\)</span> best-performing individual features achieve <span class="math inline">\(&gt;50\%\)</span> accuracy (which far exceeds the chance probability for a five-class problem of <span class="math inline">\(20\%\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>top_40</span> <span class='op'>&lt;-</span> <span class='va'>feature_vs_null</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_max</a></span><span class='op'>(</span><span class='va'>feature_mean</span>, n <span class='op'>=</span> <span class='fl'>40</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>top_40</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span><span class='va'>feature_mean</span>, n <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<table style="width:100%;">
<colgroup>
<col style="width: 66%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 9%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">hypothesis</th>
<th style="text-align: right;">feature_mean</th>
<th style="text-align: right;">null_mean</th>
<th style="text-align: right;">t_statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">tsfresh_values__autocorrelation__lag_6 != own null</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">4.054</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__autocorrelation__lag_7 != own null</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.136</td>
<td style="text-align: right;">4.244</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tsfresh_values__autocorrelation__lag_8 != own null</td>
<td style="text-align: right;">0.527</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">4.513</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__change_quantiles__f_agg_“mean”__isabs_True__qh_1.0__ql_0.4 != own null</td>
<td style="text-align: right;">0.524</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">7.373</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tsfresh_values__change_quantiles__f_agg_“mean”__isabs_True__qh_1.0__ql_0.2 != own null</td>
<td style="text-align: right;">0.521</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">6.819</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__change_quantiles__f_agg_“mean”__isabs_True__qh_0.8__ql_0.4 != own null</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">7.016</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSFEL_0_Wavelet energy_25.0Hz != own null</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">7.903</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">TSFEL_0_Wavelet standard deviation_25.0Hz != own null</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">7.903</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tsfresh_values__change_quantiles__f_agg_“mean”__isabs_True__qh_0.8__ql_0.2 != own null</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">6.362</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__change_quantiles__f_agg_“mean”__isabs_True__qh_0.6__ql_0.2 != own null</td>
<td style="text-align: right;">0.511</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">7.350</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSFEL_0_Median absolute diff != own null</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">6.645</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">TSFEL_0_Mean absolute diff != own null</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">6.298</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSFEL_0_Sum absolute diff != own null</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">6.298</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__absolute_sum_of_changes != own null</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">6.298</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tsfresh_values__change_quantiles__f_agg_“mean”__isabs_True__qh_1.0__ql_0.0 != own null</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">6.298</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__mean_abs_change != own null</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">6.298</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSFEL_0_Signal distance != own null</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">6.136</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__change_quantiles__f_agg_“mean”__isabs_True__qh_0.8__ql_0.0 != own null</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">7.167</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tsfresh_values__autocorrelation__lag_5 != own null</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">3.280</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">tsfresh_values__augmented_dickey_fuller__attr_“teststat”__autolag_“AIC” != own null</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">5.100</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
<p>Understanding what each feature within the table measures can provide insight into the types of features relevant for the classification problem.
For example, we see features that measure properties associated with autocorrelation (e.g., <code>tsfresh_values__autocorrelation_lag_6</code> which measures the value of the autocorrelation function at lag 6) and signal peaks (e.g., <code>TSFEL_0_Median absolute diff</code> which measures the median value of all absolute differences along the signal), among others.
However, interpreting this table is challenging as the relationships between the features are unknown—are all the 40 features behaving differently, or are they all highly correlated to each other and essentially proxy metrics for the same underlying time-series property?
We can better understand these relationships by visualizing the pairwise feature <span class="math inline">\(\times\)</span> feature correlation matrix.</p>
<p>To achieve this, we can filter the original feature data to only include the top features, assign it to a <code>feature_calculations</code> object type, and make use of the <code>plot</code> function in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> to visualize pairwise absolute correlations between the top performing features.
This is presented visually in Figure <a href="#fig:topFeatureCorrelations">5</a>.
The plot reveals two main groups of highly correlated (<span class="math inline">\(|\rho| \gtrapprox 0.8\)</span>) features: in the bottom left and upper right of the plot.
The cluster in the bottom left contains features that capture different types of autocorrelation structure in the time series, including linear autocorrelation coefficients (e.g., <code>tsfresh_values__autocorrelation_lag_6</code>) and the variance of means over sliding windows (e.g., <code>tsfeatures_stability</code>).
The large cluster in the top right (containing features from <code>tsfresh</code> and <code>TSFEL</code> exclusively) contains features sensitive to variance—including change quantiles (e.g., <code>tsfresh_values__change_quantiles__f_agg_"mean"__isabs_True__qh_1.0__ql_0.4</code> which measures the mean of the absolute change of the time series values inside quantiles <span class="math inline">\(0.4-1.0\)</span>), wavelet variance (e.g., <code>TSFEL_0_Wavelet standard deviation_25.0Hz</code> which measures the variance of coefficients from Ricker wavelets with widths <span class="math inline">\(1-10\)</span> at the lower quarter of the assumed sampling frequency of <span class="math inline">\(100\)</span>Hz), and the ‘distance traveled’ by the signal (e.g., <code>TSFEL_0_Signal distance</code> which measures the sum of square root squared differences).
While the differences between classes—as identified through the list of top features—in this case were simple (i.e., autocorrelation and variance), other, more complex features may perform the strongest on other problems, or even different pairs of classes within the five-class dataset investigated here.
Identifying when simple features perform well is important as it can provide interpretable benchmarks for assessing relative performance gains achieved by more complex and/or less interpretable alternative classifiers <span class="citation" data-cites="henderson2023dullmomentdistributionalproperties">(<a href="#ref-henderson2023dullmomentdistributionalproperties" role="doc-biblioref">Henderson et al. 2023</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>feature_matrix_filt</span> <span class='op'>&lt;-</span> <span class='va'>all_features</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>feature_set</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>top_40</span><span class='op'>$</span><span class='va'>feature_set</span> <span class='op'>&amp;</span> </span>
<span>                  <span class='va'>names</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>top_40</span><span class='op'>$</span><span class='va'>original_names</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span>class <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"feature_calculations"</span>, <span class='st'>"data.frame"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>feature_matrix_filt</span>, type <span class='op'>=</span> <span class='st'>"cor"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:topFeatureCorrelations"></span>
<img src="RJ-2025-023_files/figure-html5/topFeatureCorrelations-1.png" alt="A group of change quantile and difference-associated features and a group of autocorrelation-sensitive features perform the best at distinguishing between the five classes in the Bonn EEG dataset using the absolute Spearman correlation coefficient to capture feature-feature similarity. To aid the identification of similarly performing features, the matrix of correlation coefficients between features were then organized using hierarchical clustering (on Euclidean distances with average linkage) along rows and columns to order the heatmap graphic." width="480" />
<p class="caption">
Figure 5: A group of change quantile and difference-associated features and a group of autocorrelation-sensitive features perform the best at distinguishing between the five classes in the Bonn EEG dataset using the absolute Spearman correlation coefficient to capture feature-feature similarity. To aid the identification of similarly performing features, the matrix of correlation coefficients between features were then organized using hierarchical clustering (on Euclidean distances with average linkage) along rows and columns to order the heatmap graphic.
</p>
</div>
</div>
<p>Having identified the discriminative features, it can be important to understand how they differ amongst the labeled classes of a dataset.
This can be achieved by visualizing the distribution of values for each class for each of the features.
In <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>, a violin plot can be produced in <code>plot</code> by setting <code>type = "violin"</code>, where each time series is represented as a point organized and colored by its class label.
Note that a boxplot alternative (which highlights univariate outliers as points) is also possible through specifying <code>type = "box"</code>.
Here, for visual clarity, we show violin plots for a selected feature from the variance cluster of features from Figure <a href="#fig:topFeatureCorrelations">5</a>: <code>0_Signal distance</code> from <code>TSFEL</code> (mean classification accuracy <span class="math inline">\(50.1\%\)</span> over 100 resamples); and a selected feature from the autocorrelation-sensitive cluster of features: <code>values_autocorrelation_lag_6</code> from <code>tsfresh</code> (mean classification accuracy <span class="math inline">\(53.7\%\)</span> over 100 resamples).
The outputs are shown in Figure <a href="#fig:topFeatureViolins">6</a>.
Consistent with their high classification scores relative to chance (<span class="math inline">\(20\%\)</span>), both features are individually informative of class differences.
The plot shows that with regard to autocorrelation structure, we see that <code>eyesClosed</code> exhibits typically weak to moderate negative coefficient values at lag 6, while <code>hippocampus</code> and <code>epileptogenic</code> exhibit typically moderate positive coefficients.
<code>eyesClosed</code> is characterized by weak to moderate coefficient values largely within the <span class="math inline">\(0-0.5\)</span> range, while <code>seizure</code> exhibits a substantially wider distribution of values than the other classes—a distribution which almost spans the entire range of coefficients exhibited by the others.
This defining lack of temporal predictability in short-range autocorrelation coefficients for <code>seizure</code> time series is consistent with prior work and is characteristic of the more erratic nature of seizure state brain activity <span class="citation" data-cites="fulcherHighlyComparativeTimeseries2013">(<a href="#ref-fulcherHighlyComparativeTimeseries2013" role="doc-biblioref">Fulcher et al. 2013</a>)</span>.</p>
<p>The plot also shows that with regard to signal distance (i.e., <span class="math inline">\(\sum_{t=1}^{T-1} \sqrt{1 + (x_{t+1} - x_{t})}\)</span> where <span class="math inline">\(T\)</span> is the length of the time series and <span class="math inline">\(x\)</span> is the vector of values), all classes except <code>seizure</code> exhibit similar values with subtle differences in the mean and variance of their feature value distributions.
This is consistent with the lower classification performance of this feature compared to <code>values_autocorrelation_lag_6</code>.
For <code>seizure</code>, we again see a wide distribution of feature values definitive of this class.
Practically, since signal distance measures the total distance traveled by the signal between time points, it can be inferred that <code>seizure</code> state brain activity (as measured by an EEG) fluctuates far more than healthy brain activity and measurements from the epileptogenic zone (i.e., the difference between values at any two consecutive time points is, on average, larger), consistent with known dynamics of seizure states <span class="citation" data-cites="andrzejakIndicationsNonlinearDeterministic2001">(<a href="#ref-andrzejakIndicationsNonlinearDeterministic2001" role="doc-biblioref">Andrzejak et al. 2001</a>)</span>.</p>
<p>Together, these two feature case studies reinforce the interpretative benefits to a feature-based approach to time-series analysis.
Features can not only organize time-series data, reveal structure, and predict class membership, but they can also provide insight into the underlying generative properties that distinguish different time series—such as the difference in brain activity between seizure state and regular brain function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>feature_matrix_filt</span>,</span>
<span>     type <span class='op'>=</span> <span class='st'>"violin"</span>, </span>
<span>     feature_names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"values__autocorrelation__lag_6"</span>, </span>
<span>                       <span class='st'>"0_Signal distance"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>strip.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure"><span style="display:block;" id="fig:topFeatureViolins"></span>
<img src="RJ-2025-023_files/figure-html5/topFeatureViolins-1.png" alt="Violin plots (on original feature value scale) of a sample of two of the top 40 features of all six feature sets in theft for classifying Bonn EEG groups. Classes differ in their variance and autocorrelation properties." width="480" />
<p class="caption">
Figure 6: Violin plots (on original feature value scale) of a sample of two of the top 40 features of all six feature sets in theft for classifying Bonn EEG groups. Classes differ in their variance and autocorrelation properties.
</p>
</div>
</div>
<h3 data-number="2.9" id="additional-functionality"><span class="header-section-number">2.9</span> Additional functionality</h3>
<p>In addition to the functionality demonstrated here, <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> include a collection of other functions, not demonstrated in this article for brevity, including cluster analysis (through the <code>cluster</code> function in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>), simple feature selection using penalized maximum likelihood generalized linear models (through the <code>shrink</code> function in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>), and the processing of <code>hctsa</code>-formatted Matlab files in <a href="https://cran.r-project.org/package=theft">theft</a>. Readers are encouraged to explore this additional functionality in the detailed vignettes included with the packages.</p>
<h2 data-number="3" id="discussion"><span class="header-section-number">3</span> Discussion</h2>
<p>Feature-based time-series analysis is a powerful computational tool for tackling statistical learning problems using sequential (typically time-ordered) data.
We have introduced the <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> packages for R which implement the extraction, processing, visualization, and statistical analysis of time-series features.
The value of time-series features stems from their interpretability and strong connection to theory that can be used to understand the empirical properties of their dynamics.
<a href="https://cran.r-project.org/package=theft">theft</a> provides a unified interface to extracting features from six open-source packages—<code>catch22</code>, <a href="https://cran.r-project.org/package=feasts">feasts</a>, <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a>, <code>Kats</code>, <code>tsfresh</code>, and <code>TSFEL</code>—while <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> provides a comprehensive range of analyses to leverage the combined contributions from all of these packages.
For the first time in the free and open-source software setting, the <a href="https://cran.r-project.org/package=theft">theft</a> ecosystem provides a full workflow for conducting feature-based time-series analysis, taking the analyst from feature extraction through to generating interpretable insights about their data.
<a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> introduces a set of simply named functions that make analysis of time-series features calculated in <a href="https://cran.r-project.org/package=theft">theft</a> intuitive and streamlined: <code>classify</code>, <code>project</code>, <code>cluster</code>, <code>interval</code>, <code>plot</code>, and <code>compare_features</code>.
<a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> reduce the need to construct complex, bespoke workflows with multiple software libraries that were not designed to work together—the <a href="https://cran.r-project.org/package=theft">theft</a> ecosystem provides an extensive suite of functions, but also presents a set of templates for advanced users to alter and adapt as their research requires.</p>
<p>We demonstrated the <a href="https://cran.r-project.org/package=theft">theft</a> ecosystem on the five-class Bonn EEG time-series classification problem <span class="citation" data-cites="andrzejakIndicationsNonlinearDeterministic2001">(<a href="#ref-andrzejakIndicationsNonlinearDeterministic2001" role="doc-biblioref">Andrzejak et al. 2001</a>)</span>, in which the full feature-based classification analysis pipeline—from feature extraction to normalization, classification, and interpretation of individual features—was achieved using a small number of key functions in <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>.
We showed that this intuitive pipeline could be used to derive insights about the temporal patterns which distinguish different classes of EEG time series and produce high-performing results in a simple statistical learning classification context.
In other settings, emphasis may be placed on the classification procedure, where more complex classifiers—such as Gaussian processes or generalized additive models—may yield strong results.
In others, users may not have a labeled dataset and instead seek to uncover structure in their data.
For such cases, the <code>cluster</code> functionality of <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> may prove valuable in deriving scientific understanding.
Regardless of the feature-based time-series analysis context, <a href="https://cran.r-project.org/package=theft">theft</a> and <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a> enable consistent, end-to-end analytical pipelines.</p>
<p>As new and more powerful features (and feature sets) are developed in the future, they can be incorporated into <a href="https://cran.r-project.org/package=theft">theft</a> to enable ongoing assessments of the types of problems they are best placed to solve.
In addition to the analysis templates provided through functions in <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>, there is much flexibility for users to adapt them or build new functionality for their own use-cases, such as applying different types of statistical learning algorithms on extracted feature matrices (e.g., feature selection), or to adapt the results to different applications such as extrinsic regression <span class="citation" data-cites="tanTimeSeriesExtrinsic2021">(<a href="#ref-tanTimeSeriesExtrinsic2021" role="doc-biblioref">Tan et al. 2021</a>)</span> or forecasting <span class="citation" data-cites="montero-mansoFFORMAFeaturebasedForecast2020">(<a href="#ref-montero-mansoFFORMAFeaturebasedForecast2020" role="doc-biblioref">Montero-Manso et al. 2020</a>)</span>.
Future work could also aim to reduce redundancy from across the combined features towards a new reduced feature set that combines the most generically informative and unique features from across the available feature-extraction packages (following the aims of the <code>catch22</code> feature set, selected from a library of <span class="math inline">\(&gt;7700\)</span> candidate features in <code>hctsa</code> <span class="citation" data-cites="lubbaCatch22CAnonicalTimeseries2019">(<a href="#ref-lubbaCatch22CAnonicalTimeseries2019" role="doc-biblioref">Lubba et al. 2019</a>)</span>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="3.1" id="supplementary-materials"><span class="header-section-number">3.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-023.zip">RJ-2025-023.zip</a></p>
<h3 class="appendix" data-number="3.2" id="cran-packages-used"><span class="header-section-number">3.2</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=Rcatch22">Rcatch22</a>, <a href="https://cran.r-project.org/package=tsfeatures">tsfeatures</a>, <a href="https://cran.r-project.org/package=feasts">feasts</a>, <a href="https://cran.r-project.org/package=theft">theft</a>, <a href="https://cran.r-project.org/package=theftdlc">theftdlc</a>, <a href="https://cran.r-project.org/package=glmnet">glmnet</a>, <a href="https://cran.r-project.org/package=tsibble">tsibble</a>, <a href="https://cran.r-project.org/package=normaliseR">normaliseR</a>, <a href="https://cran.r-project.org/package=correctR">correctR</a>, <a href="https://cran.r-project.org/package=dplyr">dplyr</a></p>
<h3 class="appendix" data-number="3.3" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">3.3</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Databases">Databases</a>, <a href="https://cran.r-project.org/view=MachineLearning">MachineLearning</a>, <a href="https://cran.r-project.org/view=MissingData">MissingData</a>, <a href="https://cran.r-project.org/view=ModelDeployment">ModelDeployment</a>, <a href="https://cran.r-project.org/view=Survival">Survival</a>, <a href="https://cran.r-project.org/view=TimeSeries">TimeSeries</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-andrzejakIndicationsNonlinearDeterministic2001" class="csl-entry" role="listitem">
R. G. Andrzejak, K. Lehnertz, F. Mormann, C. Rieke, P. David and C. E. Elger. Indications of nonlinear deterministic and finite-dimensional structures in time series of brain electrical activity: Dependence on recording region and brain state. <em>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</em>, 64(6 Pt 1): 061907, 2001. DOI <a href="https://doi.org/10.1103/PhysRevE.64.061907">10.1103/PhysRevE.64.061907</a>.
</div>
<div id="ref-barandasTSFELTimeSeries2020" class="csl-entry" role="listitem">
M. Barandas, D. Folgado, L. Fernandes, S. Santos, M. Abreu, P. Bota, H. Liu, T. Schultz and H. Gamboa. <span>TSFEL</span>: <span>Time Series Feature Extraction Library</span>. <em>SoftwareX</em>, 11: 100456, 2020. DOI <a href="https://doi.org/10.1016/j.softx.2020.100456">10.1016/j.softx.2020.100456</a>.
</div>
<div id="ref-barbaraClassifyingKeplerLight2022" class="csl-entry" role="listitem">
N. H. Barbara, T. R. Bedding, B. D. Fulcher, S. J. Murphy and T. Van Reeth. Classifying <span>Kepler</span> light curves for 12,000 <span>A</span> and <span>F</span> stars using supervised feature-based machine learning. <em>Monthly Notices of the Royal Astronomical Society</em>, stac1515, 2022. DOI <a href="https://doi.org/10.1093/mnras/stac1515">10.1093/mnras/stac1515</a>.
</div>
<div id="ref-christTimeSeriesFeatuRe2018" class="csl-entry" role="listitem">
M. Christ, N. Braun, J. Neuffer and A. W. Kempa-Liehr. <span>Time Series FeatuRe Extraction</span> on basis of <span>Scalable Hypothesis</span> tests (<span class="nocase">tsfresh</span> a <span>Python</span> package). <em>Neurocomputing</em>, 307: 72–77, 2018. DOI <a href="https://doi.org/10.1016/j.neucom.2018.03.067">10.1016/j.neucom.2018.03.067</a>.
</div>
<div id="ref-christDistributedParallelTime2017" class="csl-entry" role="listitem">
M. Christ, A. W. Kempa-Liehr and M. Feindt. Distributed and parallel time series feature extraction for industrial big data applications. 2017. URL <a href="https://arxiv.org/abs/1610.07717">https://arxiv.org/abs/1610.07717</a>.
</div>
<div id="ref-clevelandSeasonalTrend1990" class="csl-entry" role="listitem">
R. B. Cleveland, W. S. Cleveland, J. E. McRae and I. Terpenning. <span>STL</span>: A seasonal-trend decomposition procedure based on loess (with discussion). <em>Journal of Official Statistics</em>, 6: 3–73, 1990.
</div>
<div id="ref-dayEfficientAlgorithmsAgglomerative1984" class="csl-entry" role="listitem">
W. H. E. Day and H. Edelsbrunner. Efficient algorithms for agglomerative hierarchical clustering methods. <em>Journal of Classification</em>, 1(1): 7–24, 1984. DOI <a href="https://doi.org/10.1007/BF01890115">10.1007/BF01890115</a>.
</div>
<div id="ref-decatTraditionalSleepScoring2022" class="csl-entry" role="listitem">
N. Decat, J. Walter, Z. H. Koh, P. Sribanditmongkol, B. D. Fulcher, J. M. Windt, T. Andrillon and N. Tsuchiya. Beyond traditional sleep scoring: <span>Massive</span> feature extraction and data-driven clustering of sleep time series. <em>Sleep Medicine</em>, 98: 39–52, 2022. DOI <a href="https://doi.org/10.1016/j.sleep.2022.06.013">10.1016/j.sleep.2022.06.013</a>.
</div>
<div id="ref-fulcherFeatureBasedTimeSeriesAnalysis2018" class="csl-entry" role="listitem">
B. D. Fulcher. Feature-based time-series analysis. In <em>Feature engineering for machine learning and data analytics</em>, 2018. <span>CRC Press</span>. ISBN 978-1-315-18108-0.
</div>
<div id="ref-fulcherHighlyComparativeFetal2012" class="csl-entry" role="listitem">
B. D. Fulcher, A. E. Georgieva, C. W. G. Redman and N. S. Jones. Highly comparative fetal heart rate analysis. In <em>2012 <span>Annual International Conference</span> of the <span>IEEE Engineering</span> in <span>Medicine</span> and <span>Biology Society</span></em>, pages. 3135–3138 2012. DOI <a href="https://doi.org/10.1109/EMBC.2012.6346629">10.1109/EMBC.2012.6346629</a>.
</div>
<div id="ref-fulcherHctsaComputationalFramework2017" class="csl-entry" role="listitem">
B. D. Fulcher and N. S. Jones. <span class="nocase">hctsa</span>: A computational framework for automated time-series phenotyping using massive feature extraction. <em>Cell Systems</em>, 5(5): 527–531.e3, 2017. DOI <a href="https://doi.org/10.1016/j.cels.2017.10.001">10.1016/j.cels.2017.10.001</a>.
</div>
<div id="ref-fulcherHighlyComparativeFeaturebased2014" class="csl-entry" role="listitem">
B. D. Fulcher and N. S. Jones. Highly comparative feature-based time-series classification. <em>IEEE Transactions on Knowledge and Data Engineering</em>, 26(12): 3026–3037, 2014. URL <a href="https://arxiv.org/abs/1401.3531">https://arxiv.org/abs/1401.3531</a>.
</div>
<div id="ref-fulcherHighlyComparativeTimeseries2013" class="csl-entry" role="listitem">
B. D. Fulcher, M. A. Little and N. S. Jones. Highly comparative time-series analysis: The empirical structure of time series and their methods. <em>Journal of The Royal Society Interface</em>, 10(83): 20130048, 2013. DOI <a href="https://doi.org/10.1098/rsif.2013.0048">10.1098/rsif.2013.0048</a>.
</div>
<div id="ref-fulcherSelforganizingLivingLibrary2020" class="csl-entry" role="listitem">
B. D. Fulcher, C. H. Lubba, S. S. Sethi and N. S. Jones. A self-organizing, living library of time-series data. <em>Scientific Data</em>, 7(1): 213, 2020. DOI <a href="https://doi.org/10.1038/s41597-020-0553-0">10.1038/s41597-020-0553-0</a>.
</div>
<div id="ref-catch22jl_pkg" class="csl-entry" role="listitem">
B. J. Harris. <em>Catch22.jl.</em> 2021. DOI <a href="https://doi.org/10.5281/zenodo.5030712">https://doi.org/10.5281/zenodo.5030712</a>. v0.2.1.
</div>
<div id="ref-correctR_pkg" class="csl-entry" role="listitem">
T. Henderson. <em><span class="nocase">correctR</span>: Corrected test statistics for comparing machine learning models on correlated samples.</em> 2025a. URL <a href="https://CRAN.R-project.org/package=correctR">https://CRAN.R-project.org/package=correctR</a>. R package version 0.3.1.
</div>
<div id="ref-normaliseR_pkg" class="csl-entry" role="listitem">
T. Henderson. <em><span class="nocase">normaliseR</span>: Re-scale vectors and time-series features.</em> 2024. URL <a href="https://CRAN.R-project.org/package=normaliseR">https://CRAN.R-project.org/package=normaliseR</a>. R package version 0.1.2.
</div>
<div id="ref-Rcatch22_pkg" class="csl-entry" role="listitem">
T. Henderson. <em>Rcatch22: Calculation of 22 CAnonical time-series CHaracteristics.</em> 2021. URL <a href="https://CRAN.R-project.org/package=Rcatch22">https://CRAN.R-project.org/package=Rcatch22</a>. R package version 0.2.3.
</div>
<div id="ref-theft_pkg" class="csl-entry" role="listitem">
T. Henderson. <em><span class="nocase">theft</span>: Tools for handling extraction of features from time series.</em> 2025b. URL <a href="https://CRAN.R-project.org/package=theft">https://CRAN.R-project.org/package=theft</a>. R package version 0.8.2.
</div>
<div id="ref-theftdlc_pkg" class="csl-entry" role="listitem">
T. Henderson. <em><span class="nocase">theftdlc</span>: Analyse and interpret time series features.</em> 2025c. URL <a href="https://CRAN.R-project.org/package=theftdlc">https://CRAN.R-project.org/package=theftdlc</a>. R package version 0.2.1.
</div>
<div id="ref-henderson2023dullmomentdistributionalproperties" class="csl-entry" role="listitem">
T. Henderson, A. G. Bryant and B. D. Fulcher. Never a dull moment: Distributional properties as a baseline for time-series classification. 2023. URL <a href="https://arxiv.org/abs/2303.17809">https://arxiv.org/abs/2303.17809</a>.
</div>
<div id="ref-hendersonEmpiricalEvaluationTimeSeries2021" class="csl-entry" role="listitem">
T. Henderson and B. D. Fulcher. An <span>Empirical Evaluation</span> of <span>Time-Series Feature Sets</span>. In <em>2021 <span>International Conference</span> on <span>Data Mining Workshops</span> (<span>ICDMW</span>)</em>, pages. 1032–1038 2021. DOI <a href="https://doi.org/10.1109/ICDMW53433.2021.00134">10.1109/ICDMW53433.2021.00134</a>.
</div>
<div id="ref-tsfeatures_pkg" class="csl-entry" role="listitem">
R. Hyndman, Y. Kang, P. Montero-Manso, T. Talagala, E. Wang, Y. Yang and M. O’Hara-Wild. <em><span class="nocase">tsfeatures</span>: Time series feature extraction.</em> 2020. URL <a href="https://CRAN.R-project.org/package=tsfeatures">https://CRAN.R-project.org/package=tsfeatures</a>. R package version 1.1.1.
</div>
<div id="ref-Jiang_KATS_2022" class="csl-entry" role="listitem">
X. Jiang, S. Srivastava, S. Chatterjee, Y. Yu, J. Handler, P. Zhang, R. Bopardikar, D. Li, Y. Lin, U. Thakore, et al. <span>Kats</span>. 2022. URL <a href="https://github.com/facebookresearch/Kats">https://github.com/facebookresearch/Kats</a>.
</div>
<div id="ref-PrincipalComponentAnalysis2002" class="csl-entry" role="listitem">
I. T. Jolliffe. <em>Principal <span>Component Analysis</span>.</em> <span>New York</span>: <span>Springer-Verlag</span>, 2002. DOI <a href="https://doi.org/10.1007/b98835">10.1007/b98835</a>.
</div>
<div id="ref-kaoPredictionRemainingTime" class="csl-entry" role="listitem">
L.-J. Kao, C.-C. Chiu, H.-J. Wang and C. Y. Ko. Prediction of remaining time on site for e-commerce users: A <span>SOM</span> and long short-term memory study. <em>Journal of Forecasting</em>, 40(7): 1274–1290, 2021. URL <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/for.2771">https://onlinelibrary.wiley.com/doi/abs/10.1002/for.2771</a>.
</div>
<div id="ref-kodraExploringGrangerCausality2011" class="csl-entry" role="listitem">
E. Kodra, S. Chatterjee and A. R. Ganguly. Exploring <span>Granger</span> causality between global average observed time series of carbon dioxide and temperature. <em>Theoretical and Applied Climatology</em>, 104(3): 325–335, 2011. DOI <a href="https://doi.org/10.1007/s00704-010-0342-3">10.1007/s00704-010-0342-3</a>.
</div>
<div id="ref-liuSensorFaultsClassification2020" class="csl-entry" role="listitem">
G. Liu, L. Li, L. Zhang, Q. Li and S. S. Law. Sensor faults classification for <span>SHM</span> systems using deep learning-based method with <span>Tsfresh</span> features. <em>Smart Materials and Structures</em>, 29(7): 075005, 2020. DOI <a href="https://doi.org/10.1088/1361-665X/ab85a6">10.1088/1361-665X/ab85a6</a>.
</div>
<div id="ref-loning2019sktime" class="csl-entry" role="listitem">
M. Löning, A. Bagnall, S. Ganesh, V. Kazakov, J. Lines and F. J. Király. <span class="nocase">sktime</span>: A unified interface for machine learning with time series. <em>arXiv preprint arXiv:1909.07872</em>, 2019.
</div>
<div id="ref-lubbaCatch22CAnonicalTimeseries2019" class="csl-entry" role="listitem">
C. H. Lubba, S. S. Sethi, P. Knaute, S. R. Schultz, B. D. Fulcher and N. S. Jones. Catch22: <span class="nocase">CAnonical Time-series CHaracteristics</span>. <em>Data Mining and Knowledge Discovery</em>, 33(6): 1821–1852, 2019. DOI <a href="https://doi.org/10.1007/s10618-019-00647-x">10.1007/s10618-019-00647-x</a>.
</div>
<div id="ref-markicevicCorticalExcitationInhibition2020" class="csl-entry" role="listitem">
M. Markicevic, B. D. Fulcher, C. Lewis, F. Helmchen, M. Rudin, V. Zerbi and N. Wenderoth. Cortical <span>Excitation</span>:<span>Inhibition Imbalance Causes Abnormal Brain Network Dynamics</span> as <span>Observed</span> in <span>Neurodevelopmental Disorders</span>. <em>Cerebral Cortex</em>, 30(9): 4922–4937, 2020. DOI <a href="https://doi.org/10.1093/cercor/bhaa084">10.1093/cercor/bhaa084</a>.
</div>
<div id="ref-montero-mansoFFORMAFeaturebasedForecast2020" class="csl-entry" role="listitem">
P. Montero-Manso, G. Athanasopoulos, R. J. Hyndman and T. S. Talagala. <span>FFORMA</span>: <span class="nocase">Feature-based</span> forecast model averaging. <em>International Journal of Forecasting</em>, 36(1): 86–92, 2020. DOI <a href="https://doi.org/10.1016/j.ijforecast.2019.02.011">10.1016/j.ijforecast.2019.02.011</a>.
</div>
<div id="ref-nadeauInferenceGeneralizationError2003" class="csl-entry" role="listitem">
C. Nadeau and Y. Bengio. Inference for the generalization error. <em>Machine Learning</em>, 52: 239, 2003.
</div>
<div id="ref-feasts_pkg" class="csl-entry" role="listitem">
M. O’Hara-Wild, R. Hyndman and E. Wang. <em><span class="nocase">feasts</span>: Feature extraction and statistics for time series.</em> 2021. URL <a href="https://CRAN.R-project.org/package=feasts">https://CRAN.R-project.org/package=feasts</a>. R package version 0.4.1.
</div>
<div id="ref-ojalaPermutationTestsStudying2009" class="csl-entry" role="listitem">
M. Ojala and G. C. Garriga. Permutation <span>Tests</span> for <span>Studying Classifier Performance</span>. In <em>2009 <span>Ninth IEEE International Conference</span> on <span>Data Mining</span></em>, pages. 908–913 2009. <span>Miami Beach, FL, USA</span>: <span>IEEE</span>. ISBN 978-1-4244-5242-2. DOI <a href="https://doi.org/10.1109/ICDM.2009.108">10.1109/ICDM.2009.108</a>.
</div>
<div id="ref-paulBehavioralDiscriminationTimeseries2021" class="csl-entry" role="listitem">
A. Paul, H. McLendon, V. Rally, J. T. Sakata and S. C. Woolley. Behavioral discrimination and time-series phenotyping of birdsong performance. <em>PLOS Computational Biology</em>, 17(4): e1008820, 2021. DOI <a href="https://doi.org/10.1371/journal.pcbi.1008820">10.1371/journal.pcbi.1008820</a>.
</div>
<div id="ref-tanTimeSeriesExtrinsic2021" class="csl-entry" role="listitem">
C. W. Tan, C. Bergmeir, F. Petitjean and G. I. Webb. Time series extrinsic regression. <em>Data Mining and Knowledge Discovery</em>, 35(3): 1032–1060, 2021. DOI <a href="https://doi.org/10.1007/s10618-021-00745-9">10.1007/s10618-021-00745-9</a>.
</div>
<div id="ref-vanderdoncktTsflexFlexibleTime2022" class="csl-entry" role="listitem">
J. Van Der Donckt, J. Van Der Donckt, E. Deprost and S. Van Hoecke. <span class="nocase">tsflex</span>: Flexible time series processing &amp; feature extraction. <em>SoftwareX</em>, 17: 100971, 2022. DOI <a href="https://doi.org/10.1016/j.softx.2021.100971">10.1016/j.softx.2021.100971</a>.
</div>
<div id="ref-tsibble_pkg" class="csl-entry" role="listitem">
E. Wang, D. Cook and R. J. Hyndman. A new tidy data structure to support exploration and modeling of temporal data. <em>Journal of Computational and Graphical Statistics</em>, 29(3): 466–478, 2020. URL <a href="https://doi.org/10.1080/10618600.2019.1695624">https://doi.org/10.1080/10618600.2019.1695624</a>.
</div>
<div id="ref-westEvaluationComparisonEEG1999" class="csl-entry" role="listitem">
M. West, R. Prado and A. D. Krystal. Evaluation and <span>Comparison</span> of <span>EEG Traces</span>: <span>Latent Structure</span> in <span>Nonstationary Time Series</span>. <em>Journal of the American Statistical Association</em>, 94(446): 375–387, 1999. DOI <a href="https://doi.org/10.1080/01621459.1999.10474128">10.1080/01621459.1999.10474128</a>.
</div>
<div id="ref-wickhamTidyData2014" class="csl-entry" role="listitem">
H. Wickham. Tidy data. <em>Journal of Statistical Software</em>, 59(1): 1–23, 2014. DOI <a href="https://doi.org/10.18637/jss.v059.i10">10.18637/jss.v059.i10</a>.
</div>
<div id="ref-wickhamWelcomeTidyverse2019" class="csl-entry" role="listitem">
H. Wickham, M. Averick, J. Bryan, W. Chang, L. D. McGowan, R. François, G. Grolemund, A. Hayes, L. Henry, J. Hester, et al. Welcome to the <span>Tidyverse</span>. <em>Journal of Open Source Software</em>, 4(43): 1686, 2019. DOI <a href="https://doi.org/10.21105/joss.01686">10.21105/joss.01686</a>.
</div>
<div id="ref-dplyr_pkg" class="csl-entry" role="listitem">
H. Wickham, R. François, L. Henry, K. Müller and D. Vaughan. <em><span class="nocase">dplyr</span>: A grammar of data manipulation.</em> 2023. URL <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>. R package version 1.1.4.
</div>
<div id="ref-yangAnomalyDetectionAlgorithm2021" class="csl-entry" role="listitem">
Z. Yang, I. A. Abbasi, E. E. Mustafa, S. Ali and M. Zhang. An anomaly detection algorithm selection service for <span>IoT</span> stream data based on <span class="nocase">tsfresh</span> tool and genetic algorithm. <em>Security and Communication Networks</em>, 2021: 6677027, 2021. DOI <a href="https://doi.org/10.1155/2021/6677027">10.1155/2021/6677027</a>.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://tidyverts.org" class="uri">https://tidyverts.org</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Henderson &amp; Fulcher, "Feature-Based Time-Series Analysis in R using the Theft Ecosystem", The R Journal, 2025</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2025-023,
  author = {Henderson, Trent and Fulcher, Ben D.},
  title = {Feature-Based Time-Series Analysis in R using the Theft Ecosystem},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2025-023},
  doi = {10.32614/RJ-2025-023},
  volume = {17},
  issue = {3},
  issn = {2073-4859},
  pages = {43-68}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
