<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package</title>

<meta property="description" itemprop="description" content="The R package DynForest implements random forests for predicting a continuous, a categorical, or a (multiple causes) time-to-event outcome based on time-fixed and time-dependent predictors. The main originality of DynForest is that it handles time-dependent predictors that can be endogenous (i.e., impacted by the outcome process), measured with error, and measured at subject-specific times. At each recursive step of the tree building process, the time-dependent predictors are internally summarized into individual features on which the split can be done. This is achieved using flexible linear mixed models (thanks to the R package lcmm), whose specification is pre-specified by the user. DynForest returns the mean for a continuous outcome, the category with a majority vote for a categorical outcome, or the cumulative incidence function over time for a survival outcome. DynForest also computes variable importance and minimal depth to inform on the most predictive variables or groups of variables. This paper aims to guide the user with step-by-step examples for fitting random forests using DynForest."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2025-002/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-08-07"/>
<meta property="article:created" itemprop="dateCreated" content="2025-08-07"/>
<meta name="article:author" content="Anthony Devaux"/>
<meta name="article:author" content="Cécile Proust-Lima"/>
<meta name="article:author" content="Robin Genuer"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="The R package DynForest implements random forests for predicting a continuous, a categorical, or a (multiple causes) time-to-event outcome based on time-fixed and time-dependent predictors. The main originality of DynForest is that it handles time-dependent predictors that can be endogenous (i.e., impacted by the outcome process), measured with error, and measured at subject-specific times. At each recursive step of the tree building process, the time-dependent predictors are internally summarized into individual features on which the split can be done. This is achieved using flexible linear mixed models (thanks to the R package lcmm), whose specification is pre-specified by the user. DynForest returns the mean for a continuous outcome, the category with a majority vote for a categorical outcome, or the cumulative incidence function over time for a survival outcome. DynForest also computes variable importance and minimal depth to inform on the most predictive variables or groups of variables. This paper aims to guide the user with step-by-step examples for fitting random forests using DynForest."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2025-002/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2025-002/figures/dynforestR_graph.png"/>
<meta property="og:image:width" content="8000"/>
<meta property="og:image:height" content="4500"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package"/>
<meta property="twitter:description" content="The R package DynForest implements random forests for predicting a continuous, a categorical, or a (multiple causes) time-to-event outcome based on time-fixed and time-dependent predictors. The main originality of DynForest is that it handles time-dependent predictors that can be endogenous (i.e., impacted by the outcome process), measured with error, and measured at subject-specific times. At each recursive step of the tree building process, the time-dependent predictors are internally summarized into individual features on which the split can be done. This is achieved using flexible linear mixed models (thanks to the R package lcmm), whose specification is pre-specified by the user. DynForest returns the mean for a continuous outcome, the category with a majority vote for a categorical outcome, or the cumulative incidence function over time for a survival outcome. DynForest also computes variable importance and minimal depth to inform on the most predictive variables or groups of variables. This paper aims to guide the user with step-by-step examples for fitting random forests using DynForest."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2025-002/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2025-002/figures/dynforestR_graph.png"/>
<meta property="twitter:image:width" content="8000"/>
<meta property="twitter:image:height" content="4500"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-002"/>
<meta name="citation_pdf_url" content="RJ-2025-002.pdf"/>
<meta name="citation_volume" content="17"/>
<meta name="citation_issue" content="1"/>
<meta name="citation_doi" content="10.32614/RJ-2025-002"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="24"/>
<meta name="citation_lastpage" content="46"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/08/07"/>
<meta name="citation_publication_date" content="2025/08/07"/>
<meta name="citation_author" content="Anthony Devaux"/>
<meta name="citation_author_institution" content="Inserm U1219 - Bordeaux Population Health - Université de Bordeaux - The George Institute for Global Health - UNSW Sydney - School of Population Health - UNSW Sydney"/>
<meta name="citation_author" content="Cécile Proust-Lima"/>
<meta name="citation_author_institution" content="Inserm U1219 - Bordeaux Population Health - Université de Bordeaux"/>
<meta name="citation_author" content="Robin Genuer"/>
<meta name="citation_author_institution" content="Inserm U1219 - Bordeaux Population Health - Université de Bordeaux"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Random forests;citation_volume=45;citation_doi=10.1023/A:1010933404324;citation_issn=0885-6125;citation_author=Leo Breiman"/>
  <meta name="citation_reference" content="citation_title=Random survival forests;citation_volume=2;citation_doi=10.1214/08-AOAS169;citation_issn=1932-6157;citation_author=Hemant Ishwaran;citation_author=Udaya B. Kogalur;citation_author=Eugene H. Blackstone;citation_author=Michael S. Lauer"/>
  <meta name="citation_reference" content="citation_title=Random survival forests for competing risks;citation_volume=15;citation_doi=10.1093/biostatistics/kxu010;citation_issn=1468-4357, 1465-4644;citation_author=Hemant Ishwaran;citation_author=Thomas A. Gerds;citation_author=Udaya B. Kogalur;citation_author=Richard D. Moore;citation_author=Stephen J. Gange;citation_author=Bryan M. Lau"/>
  <meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;citation_publisher=R Foundation for Statistical Computing;citation_author=R: A language and environment for statistical computing"/>
  <meta name="citation_reference" content="citation_title=ranger: A fast implementation of random forests for high dimensional data in C++ and R;citation_volume=77;citation_doi=10.18637/jss.v077.i01;citation_issn=1548-7660;citation_author=Marvin N. Wright;citation_author=Andreas Ziegler"/>
  <meta name="citation_reference" content="citation_title=XGBoost: A scalable tree boosting system;citation_doi=10.1145/2939672.2939785;citation_author=Tianqi Chen;citation_author=Carlos Guestrin"/>
  <meta name="citation_reference" content="citation_title=Random survival forests with multivariate longitudinal endogenous covariates;citation_volume=32;citation_doi=10.1177/09622802231206477;citation_author=Anthony Devaux;citation_author=Catherine Helmer;citation_author=Robin Genuer;citation_author=Cécile Proust-Lima"/>
  <meta name="citation_reference" content="citation_title=A mathematical theory of communication;citation_volume=27;citation_doi=10.1002/j.1538-7305.1948.tb01338.x;citation_author=Claude Elwood Shannon"/>
  <meta name="citation_reference" content="citation_title=Asymptotically efficient rank invariant test procedures;citation_volume=135;citation_doi=10.2307/2344317;citation_author=Richard Peto;citation_author=Julian Peto"/>
  <meta name="citation_reference" content="citation_title=A class of $k$-sample tests for comparing the cumulative incidence of a competing risk;citation_volume=16;citation_issn=0090-5364;citation_author=Robert J. Gray"/>
  <meta name="citation_reference" content="citation_title=Hazard plotting for incomplete failure data;citation_volume=1;citation_doi=10.1080/00224065.1969.11980344;citation_issn=0022-4065;citation_author=Wayne Nelson"/>
  <meta name="citation_reference" content="citation_title=Nonparametric inference in connection with multiple decrement models;citation_volume=3;citation_issn=0303-6898;citation_author=Odd Aalen"/>
  <meta name="citation_reference" content="citation_title=An empirical transition matrix for non-homogeneous markov chains based on censored observations;citation_volume=5;citation_issn=0303-6898;citation_author=Odd O. Aalen;citation_author=Søren Johansen"/>
  <meta name="citation_reference" content="citation_title=Individualized dynamic prediction of prostate cancer recurrence with and without the initiation of a second treatment: Development and validation;citation_volume=25;citation_doi=10.1177/0962280214535763;citation_author=Mbéry Sène;citation_author=Jeremy M. G. Taylor;citation_author=James J. Dignam;citation_author=Hélène Jacqmin-Gadda;citation_author=Cécile Proust-Lima"/>
  <meta name="citation_reference" content="citation_title=Correlation and variable importance in random forests;citation_volume=27;citation_doi=10.1007/s11222-016-9646-1;citation_author=Baptiste Gregorutti;citation_author=Bertrand Michel;citation_author=Philippe Saint-Pierre"/>
  <meta name="citation_reference" content="citation_title=DynForest: Random forest with multivariate longitudinal predictors;citation_author=Anthony Devaux"/>
  <meta name="citation_reference" content="citation_title=Estimation of extended mixed models using latent classes and latent processes: The R package lcmm;citation_volume=78;citation_doi=10.18637/jss.v078.i02;citation_author=Cécile Proust-Lima;citation_author=Viviane Philipps;citation_author=Benoit Liquet"/>
  <meta name="citation_reference" content="citation_title=A package for survival analysis in R;citation_author=Terry M. Therneau"/>
  <meta name="citation_reference" content="citation_title=cmprsk: Subdistribution analysis of competing risks;citation_author=Bob Gray"/>
  <meta name="citation_reference" content="citation_title=Primary biliary cirrhosis: Prediction of short-term survival based on repeated patient visits;citation_volume=20;citation_doi=10.1002/hep.1840200120;citation_issn=0270-9139, 1527-3350;citation_author=Paul A. Murtaugh;citation_author=E. Rolland Dickson;citation_author=Gooitzen M. Van Dam;citation_author=Michael Malinchoc;citation_author=Patricia M. Grambsch;citation_author=Alice L. Langworthy;citation_author=Chris H. Gips"/>
  <meta name="citation_reference" content="citation_title=Consistent estimation of the expected brier score in general survival models with right-censored event times;citation_volume=48;citation_doi=10.1002/bimj.200610301;citation_issn=1521-4036;citation_author=Thomas A. Gerds;citation_author=Martin Schumacher"/>
  <meta name="citation_reference" content="citation_title=Influence of hyperparameters on random forest accuracy;citation_publisher=Springer;citation_doi=10.1007/978-3-642-02326-2_18;citation_author=Simon Bernard;citation_author=Laurent Heutte;citation_author=Sébastien Adam"/>
  <meta name="citation_reference" content="citation_title=Functional data analysis for sparse longitudinal data;citation_volume=100;citation_doi=10.1198/016214504000001745;citation_issn=0162-1459, 1537-274X;citation_author=Fang Yao;citation_author=Hans-Georg Müller;citation_author=Jane-Ling Wang"/>
  <meta name="citation_reference" content="citation_title=Random-effects models for longitudinal data;citation_volume=38;citation_doi=10.2307/2529876;citation_issn=0006-341X;citation_author=Nan M. Laird;citation_author=James H. Ware"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","description","draft","author","type","output","bibliography","preamble","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package"]},{"type":"character","attributes":{},"value":["2025-08-07"]},{"type":"character","attributes":{},"value":["The R package DynForest implements random forests for predicting a continuous, a categorical, or a (multiple causes) time-to-event outcome based on time-fixed and time-dependent predictors. The main originality of DynForest is that it handles time-dependent predictors that can be endogenous (i.e., impacted by the outcome process), measured with error, and measured at subject-specific times. At each recursive step of the tree building process, the time-dependent predictors are internally summarized into individual features on which the split can be done. This is achieved using flexible linear mixed models (thanks to the R package lcmm), whose specification is pre-specified by the user. DynForest returns the mean for a continuous outcome, the category with a majority vote for a categorical outcome, or the cumulative incidence function over time for a survival outcome. DynForest also computes variable importance and minimal depth to inform on the most predictive variables or groups of variables. This paper aims to guide the user with step-by-step examples for fitting random forests using DynForest."]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Anthony Devaux"]},{"type":"character","attributes":{},"value":["Inserm U1219 - Bordeaux Population Health - Université de Bordeaux - The George Institute for Global Health - UNSW Sydney - School of Population Health - UNSW Sydney"]},{"type":"character","attributes":{},"value":["Bordeaux (France) - Sydney (Australia)"]},{"type":"character","attributes":{},"value":["0000-0002-8862-4218"]},{"type":"character","attributes":{},"value":["anthony.devauxbarault@gmail.com"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Cécile Proust-Lima"]},{"type":"character","attributes":{},"value":["Inserm U1219 - Bordeaux Population Health - Université de Bordeaux"]},{"type":"character","attributes":{},"value":["Bordeaux (France)"]},{"type":"character","attributes":{},"value":["0000-0002-9884-955X"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Robin Genuer"]},{"type":"character","attributes":{},"value":["Inserm U1219 - Bordeaux Population Health - Université de Bordeaux"]},{"type":"character","attributes":{},"value":["Bordeaux (France)"]},{"type":"character","attributes":{},"value":["0000-0002-0981-3943"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["rjtools::rjournal_pdf_article","distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"character","attributes":{},"value":["\\usepackage{amsmath} \\usepackage{graphicx} \\usepackage{tabularx}"]},{"type":"character","attributes":{},"value":["2024-04-12"]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[1]},{"type":"character","attributes":{},"value":["RJ-2025-002"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[24]},{"type":"integer","attributes":{},"value":[46]}]},{"type":"character","attributes":{},"value":["RJ-2025-002.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-002"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-002"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["randomForestSRC","ranger","xgboost","DynForest","lcmm","survival","cmprsk"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["ClinicalTrials","Cluster","Econometrics","Epidemiology","HighPerformanceComputing","MachineLearning","ModelDeployment","Survival"]},{"type":"character","attributes":{},"value":["/home/hyndman/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-002/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/DynForest_fit_factor_all.RData","data/DynForest_fit_surv_all.RData","DynForest.zip","figures/dynforestR_graph.png","main.tex","RJ-2025-002_files/anchor-4.2.2/anchor.min.js","RJ-2025-002_files/bowser-1.9.3/bowser.min.js","RJ-2025-002_files/distill-2.2.21/template.v2.js","RJ-2025-002_files/figure-html5/DynForestRCIF-1.png","RJ-2025-002_files/figure-html5/DynForestRfactormindepth-1.png","RJ-2025-002_files/figure-html5/DynForestRmindepth-1.png","RJ-2025-002_files/figure-html5/DynForestRmtrytuned-1.png","RJ-2025-002_files/figure-html5/DynForestRpredCIF-1.png","RJ-2025-002_files/figure-html5/DynForestRVIMPgVIMP-1.png","RJ-2025-002_files/figure-html5/unnamed-chunk-18-1.png","RJ-2025-002_files/figure-html5/unnamed-chunk-20-1.png","RJ-2025-002_files/figure-html5/unnamed-chunk-22-1.png","RJ-2025-002_files/figure-html5/unnamed-chunk-22-2.png","RJ-2025-002_files/figure-html5/unnamed-chunk-33-1.png","RJ-2025-002_files/figure-html5/unnamed-chunk-33-2.png","RJ-2025-002_files/header-attrs-2.29/header-attrs.js","RJ-2025-002_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2025-002_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2025-002_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2025-002_files/popper-2.6.0/popper.min.js","RJ-2025-002_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2025-002_files/tippy-6.2.7/tippy-light-border.css","RJ-2025-002_files/tippy-6.2.7/tippy.css","RJ-2025-002_files/tippy-6.2.7/tippy.umd.min.js","RJ-2025-002_files/webcomponents-2.0.0/webcomponents.js","RJ-2025-002.pdf","RJ-2025-002.tex","RJ-2025-002.zip","RJournal.sty","RJreferences.bib","RJwrapper.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.29/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package","description":"The R package DynForest implements random forests for predicting a continuous, a categorical, or a (multiple causes) time-to-event outcome based on time-fixed and time-dependent predictors. The main originality of DynForest is that it handles time-dependent predictors that can be endogenous (i.e., impacted by the outcome process), measured with error, and measured at subject-specific times. At each recursive step of the tree building process, the time-dependent predictors are internally summarized into individual features on which the split can be done. This is achieved using flexible linear mixed models (thanks to the R package lcmm), whose specification is pre-specified by the user. DynForest returns the mean for a continuous outcome, the category with a majority vote for a categorical outcome, or the cumulative incidence function over time for a survival outcome. DynForest also computes variable importance and minimal depth to inform on the most predictive variables or groups of variables. This paper aims to guide the user with step-by-step examples for fitting random forests using DynForest.","doi":"10.32614/RJ-2025-002","authors":[{"author":"Anthony Devaux","authorURL":"#","affiliation":"Inserm U1219 - Bordeaux Population Health - Université de Bordeaux - The George Institute for Global Health - UNSW Sydney - School of Population Health - UNSW Sydney","affiliationURL":"#","orcidID":"0000-0002-8862-4218"},{"author":"Cécile Proust-Lima","authorURL":"#","affiliation":"Inserm U1219 - Bordeaux Population Health - Université de Bordeaux","affiliationURL":"#","orcidID":"0000-0002-9884-955X"},{"author":"Robin Genuer","authorURL":"#","affiliation":"Inserm U1219 - Bordeaux Population Health - Université de Bordeaux","affiliationURL":"#","orcidID":"0000-0002-0981-3943"}],"publishedDate":"2025-08-07T00:00:00.000+00:00","citationText":"Devaux, et al., 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2024-4">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>The R package DynForest implements random forests for predicting a continuous, a categorical, or a (multiple causes) time-to-event outcome based on time-fixed and time-dependent predictors. The main originality of DynForest is that it handles time-dependent predictors that can be endogenous (i.e., impacted by the outcome process), measured with error, and measured at subject-specific times. At each recursive step of the tree building process, the time-dependent predictors are internally summarized into individual features on which the split can be done. This is achieved using flexible linear mixed models (thanks to the R package lcmm), whose specification is pre-specified by the user. DynForest returns the mean for a continuous outcome, the category with a majority vote for a categorical outcome, or the cumulative incidence function over time for a survival outcome. DynForest also computes variable importance and minimal depth to inform on the most predictive variables or groups of variables. This paper aims to guide the user with step-by-step examples for fitting random forests using DynForest.</p></p>
</div>

<div class="d-byline">
  Anthony Devaux  (Inserm U1219 - Bordeaux Population Health - Université de Bordeaux - The George Institute for Global Health - UNSW Sydney - School of Population Health - UNSW Sydney)
  
,   Cécile Proust-Lima  (Inserm U1219 - Bordeaux Population Health - Université de Bordeaux)
  
,   Robin Genuer  (Inserm U1219 - Bordeaux Population Health - Université de Bordeaux)
  
<br/>2025-08-07
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Random forests are a non-parametric, powerful method for prediction purposes. Introduced by Breiman <span class="citation" data-cites="breiman_random_2001">(<a href="#ref-breiman_random_2001" role="doc-biblioref">Breiman 2001</a>)</span> for classification (categorical outcome) and regression (continuous outcome) frameworks, random forests are particularly designed to tackle modeling issues in high-dimensional contexts (<span class="math inline">\(n &lt;&lt; p\)</span>). They can also easily take into account complex associations between the outcome and the predictors without any pre-specification, where regression models are rapidly limited.</p>
<p>Recently, this methodology was extended to survival data <span class="citation" data-cites="ishwaran_random_2008">(<a href="#ref-ishwaran_random_2008" role="doc-biblioref">Ishwaran et al. 2008</a>)</span> and competing events <span class="citation" data-cites="ishwaran_random_2014">(<a href="#ref-ishwaran_random_2014" role="doc-biblioref">Ishwaran et al. 2014</a>)</span>. Random forests were implemented in several R <span class="citation" data-cites="R_2019">(<a href="#ref-R_2019" role="doc-biblioref">R Core Team 2019</a>)</span> packages such as <a href="https://cran.r-project.org/package=randomForestSRC">randomForestSRC</a> <span class="citation" data-cites="ishawaran_fast_2022">(<a href="#ref-ishawaran_fast_2022" role="doc-biblioref"><strong>ishawaran_fast_2022?</strong></a>)</span>, <a href="https://cran.r-project.org/package=ranger">ranger</a> <span class="citation" data-cites="wright_ranger_2017">(<a href="#ref-wright_ranger_2017" role="doc-biblioref">Wright and Ziegler 2017</a>)</span> or <a href="https://cran.r-project.org/package=xgboost">xgboost</a> <span class="citation" data-cites="chen_xgboost_2016">(<a href="#ref-chen_xgboost_2016" role="doc-biblioref">Chen and Guestrin 2016</a>)</span>, among others. However, these packages are all limited to time-fixed predictors. Yet, in many applications, it may be relevant to include predictors that are repeatedly measured at multiple occasions (regular or irregular times) with measurement errors to more accurately predict the outcome. This is the case, in particular, in health research where a health outcome is to be predicted according to the history of individual information.</p>
<p>We developed an original random forests methodology to tackle this issue and incorporate longitudinal predictors that may be prone to error and possibly intermittently measured <span class="citation" data-cites="devaux_random_2023">(<a href="#ref-devaux_random_2023" role="doc-biblioref">Devaux et al. 2023</a>)</span>. The present paper aims to describe the <a href="https://cran.r-project.org/package=DynForest">DynForest</a> R package associated with this methodology, allowing the prediction of a continuous, categorical, or survival outcome using multivariate time-dependent predictors.</p>
<p>In section 2, we briefly present <a href="https://cran.r-project.org/package=DynForest">DynForest</a> methodology through its algorithm. In section 3, we present the different functions of <a href="https://cran.r-project.org/package=DynForest">DynForest</a>, and we illustrate them in section 4 for a survival outcome and in section 5 for a categorical outcome. An illustration for a continuous outcome can be found in the <a href="https://cran.r-project.org/package=DynForest">DynForest</a> vignette. To conclude, we discuss in section 6 the limitations and future improvements.</p>
<h2 data-number="2" id="dynforest-principle"><span class="header-section-number">2</span> DynForest principle</h2>
<p><a href="https://cran.r-project.org/package=DynForest">DynForest</a> is a random forest methodology which can include both time-fixed predictors of any nature and time-dependent predictors possibly measured at irregular times. The purpose of <a href="https://cran.r-project.org/package=DynForest">DynForest</a> is to predict an outcome which can be categorical, continuous or survival (with possibly competing events).</p>
<p>The random forest should first be built on a learning dataset of <span class="math inline">\(N\)</span> subjects including: <span class="math inline">\(Y\)</span> the outcome; <span class="math inline">\(\mathcal{M}_x\)</span> an ensemble of <span class="math inline">\(P\)</span> time-fixed predictors; <span class="math inline">\(\mathcal{M}_z\)</span> an ensemble of <span class="math inline">\(Q\)</span> time-dependent predictors. The random forest consists of an ensemble of <span class="math inline">\(B\)</span> trees which are grown as detailed below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dynforestRgraph"></span>
<img src="figures/dynforestR_graph.png" alt="Overall scheme of the tree building in DynForest with (A) the tree structure, (B) the node-specific treatment of time-dependent predictors to obtain time-fixed features, (C) the dichotomization of the time-fixed features, (D) the splitting rule." width="100%" height="30%" />
<p class="caption">
Figure 1: Overall scheme of the tree building in DynForest with (A) the tree structure, (B) the node-specific treatment of time-dependent predictors to obtain time-fixed features, (C) the dichotomization of the time-fixed features, (D) the splitting rule.
</p>
</div>
</div>
<h3 data-number="2.1" id="the-tree-building"><span class="header-section-number">2.1</span> The tree building</h3>
<p>The tree building process, summarized in figure <a href="#fig:dynforestRgraph">1</a>, aims to recursively partition the subjects into groups/nodes that are the most homogeneous regarding the outcome <span class="math inline">\(Y\)</span>.</p>
<p>For each tree <span class="math inline">\(b\)</span> <span class="math inline">\((b = 1, ..., B)\)</span>, we first draw a bootstrap sample from the original dataset of <span class="math inline">\(N\)</span> subjects (<span class="math inline">\(N\)</span> draws among the <span class="math inline">\(N\)</span> subjects with replacement). The subjects excluded by the bootstrap constitute the out-of-bag (OOB) sample, noted <span class="math inline">\(OOB^b\)</span> for tree <span class="math inline">\(b\)</span>. At each node <span class="math inline">\(d \in \mathcal{D}^b\)</span> of the tree, we recursively repeat the following steps using the <span class="math inline">\(N^{(d)}\)</span> subjects located at node <span class="math inline">\(d\)</span>:</p>
<ol type="1">
<li><p>An ensemble of <span class="math inline">\(\mathcal{M}^{(d)}=\{\mathcal{M}_x^{(d)},\mathcal{M}_z^{(d)}\}\)</span> candidate predictors is randomly selected among <span class="math inline">\(\{\mathcal{M}_x,\mathcal{M}_z\}\)</span> (see figure <a href="#fig:dynforestRgraph">1</a>B). The size of <span class="math inline">\(\mathcal{M}^{(d)}\)</span> is defined by the hyperparameter <span class="math inline">\(mtry\)</span>.</p></li>
<li><p>For each time-dependent predictor in <span class="math inline">\(\mathcal{M}_z^{(d)}\)</span>:</p>
<ol type="a">
<li>We independently model the trajectory of the predictor using a flexible linear mixed model <span class="citation" data-cites="laird_random_effects_1982">(<a href="#ref-laird_random_effects_1982" role="doc-biblioref">Laird and Ware 1982</a>)</span> according to time (the specification of the model is defined by the user). It is defined as: <span class="math inline">\(Z_{ij} = X1_{ij}(t_{ij})\beta + X2_{ij}(t_{ij})b_i + \epsilon_{ij}\)</span> where <span class="math inline">\(Z_{ij}\)</span> is the value of predictor <span class="math inline">\(Z\)</span> for subject <span class="math inline">\(i\)</span> at occasion <span class="math inline">\(j\)</span>, <span class="math inline">\(X1_{ij}\)</span> and <span class="math inline">\(X2_{ij}\)</span> are vectors of time functions and covariates to be specified by the user and <span class="math inline">\(t_{ij}\)</span> is the time at occasion <span class="math inline">\(j\)</span> for subject <span class="math inline">\(i\)</span>. <span class="math inline">\(\beta\)</span> are population effects, and <span class="math inline">\(b_i\)</span> individual random effects which follow a multivariate normal distribution. <span class="math inline">\(\epsilon_{ij}\)</span> are the zero-mean independent Gaussian errors of measurement.</li>
<li>We predict the vector of random-effects <span class="math inline">\(\hat{b}_i\)</span> using the available information of individual <span class="math inline">\(i = 1, ..., N^{(d)}\)</span>. Predictions <span class="math inline">\(\hat{b}_i\)</span> constitute time-independent features summarizing each time-dependent predictor. We thus derive the ensemble <span class="math inline">\(\mathcal{M}_{z \star}^{(d)}\)</span> for all the variables in <span class="math inline">\(\mathcal{M}_z^{(d)}\)</span>.</li>
</ol></li>
<li><p>We define <span class="math inline">\(\mathcal{M}_\star^{(d)}=\{\mathcal{M}_x^{(d)},\mathcal{M}_{z \star}^{(d)}\}\)</span> as our new ensemble of time-independent candidate features.</p></li>
<li><p>For each candidate feature <span class="math inline">\(W \in \mathcal{M}_\star^{(d)}\)</span>:</p>
<ol type="a">
<li>We build a series of splits <span class="math inline">\(c_W^{(d)}\)</span> according to the feature values if continuous, or subsets of categories otherwise (see figure <a href="#fig:dynforestRgraph">1</a>C), leading each time to two groups.</li>
<li>We quantify the distance between the two groups according to the nature of <span class="math inline">\(Y\)</span>:
<ul>
<li>If <span class="math inline">\(Y\)</span> continuous: we compute the weighted within-group variance with the proportion of subjects in each group as weights</li>
<li>If <span class="math inline">\(Y\)</span> categorical: we compute the weighted within-group Shannon entropy <span class="citation" data-cites="shannon_mathematical_1948">(<a href="#ref-shannon_mathematical_1948" role="doc-biblioref">Shannon 1948</a>)</span> (i.e., the amount of uncertainty) with the proportion of subjects in each group as weights</li>
<li>If <span class="math inline">\(Y\)</span> survival competing events: we compute the log-rank statistic test <span class="citation" data-cites="peto_asymptotically_1972">(<a href="#ref-peto_asymptotically_1972" role="doc-biblioref">Peto and Peto 1972</a>)</span></li>
<li>If <span class="math inline">\(Y\)</span> survival competing events: we compute the Fine &amp; Gray statistic test <span class="citation" data-cites="gray_class_1988">(<a href="#ref-gray_class_1988" role="doc-biblioref">Gray 1988</a>)</span></li>
</ul></li>
</ol></li>
<li><p>We split the subjects into the two groups that minimize (for continuous and categorical outcome) or maximize (for survival outcome) the quantity defined previously. We denote <span class="math inline">\(\{W_0^d,c_0^d\}\)</span> as the optimal couple used to split the subjects and assign them to the left and right daughter nodes <span class="math inline">\(2d\)</span> and <span class="math inline">\(2d + 1\)</span>, respectively (see figure <a href="#fig:dynforestRgraph">1</a>D and A).</p></li>
<li><p>Step 1 to 5 are iterated on the daughter nodes until stopping criteria are met.</p></li>
</ol>
<p>We define two stopping criteria: <code>nodesize</code>, the minimal number of subjects in a node required to reiterate the split, and <code>minsplit</code>, the minimal number of events required to split the node. <code>minsplit</code> is only defined with a survival outcome. In the following, we call leaves the terminal nodes.</p>
<p>In each leaf <span class="math inline">\(h \in \mathcal{H}^b\)</span> of tree <span class="math inline">\(b\)</span>, a summary <span class="math inline">\(\pi^{h^b}\)</span> is computed using the individuals belonging to the leaf. The leaf summary is defined according to the outcome:</p>
<ul>
<li>the mean, for <span class="math inline">\(Y\)</span> continuous</li>
<li>the category with the highest probability, for <span class="math inline">\(Y\)</span> categorical</li>
<li>the cumulative incidence function over time computed using the Nelson-Aalen cumulative hazard function estimator <span class="citation" data-cites="nelson_hazard_1969 aalen_nonparametric_1976">(<a href="#ref-nelson_hazard_1969" role="doc-biblioref">Nelson 1969</a>; <a href="#ref-aalen_nonparametric_1976" role="doc-biblioref">Aalen 1976</a>)</span>, for <span class="math inline">\(Y\)</span> single cause time-to-event</li>
<li>the cumulative incidence function over time computed using the non-parametric Aalen-Johansen estimator <span class="citation" data-cites="aalen_empirical_1978">(<a href="#ref-aalen_empirical_1978" role="doc-biblioref">Aalen and Johansen 1978</a>)</span>, for <span class="math inline">\(Y\)</span> time-to-event with multiple causes</li>
</ul>
<p>NOTE: Step 2 involves the estimation of a parametric mixed model for each time-dependent predictor. The specification of this model should be carefully determined in preliminary analyses by the user, keeping in mind that there should be a trade-off between goodness-of-fit and parameter parsimony. The critical point is to adequately specify the trajectory shape over time at the population and individual levels. Different bases of time functions can be considered (e.g., fractional polynomials, splines, adhoc) and compared in terms of fit.</p>
<h3 data-number="2.2" id="individual-prediction-of-the-outcome"><span class="header-section-number">2.2</span> Individual prediction of the outcome</h3>
<h4 class="unnumbered" data-number="2.2.1" id="out-of-bag-individual-prediction">Out-Of-Bag individual prediction</h4>
<p>The overall OOB prediction <span class="math inline">\(\hat{\pi}_{ \star}\)</span> for a subject <span class="math inline">\(\star\)</span> can be computed by averaging the tree-based predictions of <span class="math inline">\(\star\)</span> over the random forest as follows:
<span class="math display">\[\begin{equation}
  \hat{\pi}_{ \star} = \frac{1}{|\mathcal{O}_\star|} \sum_{b \in \mathcal{O}_\star} \hat{\pi}^{h_\star^b}
\end{equation}\]</span>
where <span class="math inline">\(\mathcal{O}_\star\)</span> is the ensemble of trees where <span class="math inline">\(\star\)</span> is <span class="math inline">\(OOB\)</span> and <span class="math inline">\(|\mathcal{O}_\star|\)</span> denotes its cardinality. The prediction <span class="math inline">\(\hat{\pi}^{h_\star^b}\)</span> is obtained by dropping down subject <span class="math inline">\(\star\)</span> along tree <span class="math inline">\(b\)</span>. At each node <span class="math inline">\(d \in \mathcal{D}^b\)</span>, the subject <span class="math inline">\(\star\)</span> is assigned to the left or right node according to his/her data and the optimal couple <span class="math inline">\(\{W_0^d,c_0^d\}\)</span>. <span class="math inline">\(W_0^d\)</span> is a random-effect feature, its value for <span class="math inline">\(\star\)</span> is predicted from the individual repeated measures using the estimated parameters from the linear mixed model.</p>
<h4 class="unnumbered" data-number="2.2.2" id="individual-dynamic-prediction-from-a-landmark-time">Individual dynamic prediction from a landmark time</h4>
<p>With a survival outcome, the OOB prediction described in the previous paragraph can be extended to compute the individual probability of event from a landmark time <span class="math inline">\(s\)</span> by exploiting the repeated measures of subject <span class="math inline">\(\star\)</span> only until <span class="math inline">\(s\)</span>. For a new subject <span class="math inline">\(\star\)</span>, we thus define the individual probability of event, noted <span class="math inline">\(\hat{\pi}_{\star}(s,s+t)\)</span>, as the probability of experiencing the event by time <span class="math inline">\(s+t\)</span> given the information prior to landmark time <span class="math inline">\(s\)</span>:
<span class="math display">\[\begin{equation}
  \hat{\pi}_{\star}(s,s+t) = \frac{1}{B} \sum_{b=1}^B \hat{\pi}^{h_\star^b}(s,s+t)
\end{equation}\]</span>
where <span class="math inline">\(\hat{\pi}^{h_\star^b}(s,s+t)\)</span> is the tree-based probability of event at time <span class="math inline">\(s+t\)</span> computed by dropping down <span class="math inline">\(\star\)</span> along the tree by considering longitudinal predictors collected until <span class="math inline">\(s\)</span> and time-fixed predictors. Note that any horizon <span class="math inline">\(t\)</span> can be considered provided <span class="math inline">\(s+t\)</span> remains in the time window on which the random forest was trained. In the <a href="https://cran.r-project.org/package=DynForest">DynForest</a> package, by default, the probability is computed at all the observed event times after the landmark time.</p>
<h3 data-number="2.3" id="out-of-bag-prediction-error"><span class="header-section-number">2.3</span> Out-Of-Bag prediction error</h3>
<p>Using the OOB individual predictions, an OOB prediction error can be internally assessed. The OOB prediction error quantifies the difference between the observed and the predicted values. It is defined according to the nature of <span class="math inline">\(Y\)</span> as:</p>
<ul>
<li>for <span class="math inline">\(Y\)</span> continuous, the mean square error (MSE) defined by:</li>
</ul>
<p><span class="math display">\[\begin{equation}
  errOOB = \frac{1}{N} \sum_{i=1}^N ( \hat{\pi}_i - \pi_i^0 )^2
\end{equation}\]</span></p>
<ul>
<li>for <span class="math inline">\(Y\)</span> categorical, the misclassification error defined by:</li>
</ul>
<p><span class="math display">\[\begin{equation}
  errOOB = \frac{1}{N} \sum_{i=1}^N {1}_{( \hat{\pi}_i \neq \pi_i^0 )}
\end{equation}\]</span></p>
<ul>
<li>for <span class="math inline">\(Y\)</span> survival, the Integrated Brier Score (IBS) <span class="citation" data-cites="sene_individualized_2016">(<a href="#ref-sene_individualized_2016" role="doc-biblioref">Sène et al. 2016</a>)</span> between <span class="math inline">\(\tau_1\)</span> and <span class="math inline">\(\tau_2\)</span> defined by:</li>
</ul>
<p><span class="math display">\[\begin{equation}
  errOOB = \int_{\tau_1}^{\tau_2} \frac{1}{N} \sum_{i=1}^{N}  \hat{\omega}_i(t) \Big\{ I(T_i \leq t, \delta_i = k) -
  \hat{\pi}_{ik}(t) \Big) \Big\}^2 dt
\end{equation}\]</span>
with <span class="math inline">\(T\)</span> the time-to-event, <span class="math inline">\(k\)</span> the cause of interest and <span class="math inline">\(\hat{\omega}(t)\)</span> the estimated weights using Inverse Probability of Censoring Weights (IPCW) technique that accounts for censoring <span class="citation" data-cites="gerds_consistent_2006">(<a href="#ref-gerds_consistent_2006" role="doc-biblioref">Gerds and Schumacher 2006</a>)</span>.</p>
<p>The OOB error of prediction is used, in particular, to tune the random forest by determining the hyperparameters (i.e., <code>mtry</code>, <code>nodesize</code> and <code>minsplit</code>) which give the smallest OOB prediction error.</p>
<h3 data-number="2.4" id="explore-the-most-predictive-variables"><span class="header-section-number">2.4</span> Explore the most predictive variables</h3>
<h4 class="unnumbered" data-number="2.4.1" id="variable-importance">Variable importance</h4>
<p>The variable importance (VIMP) measures the loss of predictive performance <span class="citation" data-cites="ishwaran_random_2008">(<a href="#ref-ishwaran_random_2008" role="doc-biblioref">Ishwaran et al. 2008</a>)</span> when removing the link between a predictor and the outcome. The link is removed by permuting the predictor values at the subject level for time-fixed predictors or at the observation level for time-dependent predictors. A large VIMP value indicates a good predictive ability for the predictor.</p>
<p>However, in the case of correlated predictors, the VIMP may not properly quantify the variable importance <span class="citation" data-cites="gregorutti_correlation_2017">(<a href="#ref-gregorutti_correlation_2017" role="doc-biblioref">Gregorutti et al. 2017</a>)</span> as the information of the predictor may still be present. To better handle situations with highly correlated predictors, the grouped variable importance (gVIMP) can be computed indirectly. It consists of simultaneously evaluating the importance of a group of predictors defined by the user. The computation is the same as for the VIMP except the permutation is performed simultaneously on all the predictors of the group. A large gVIMP value indicates a good predictive ability for the group of predictors.</p>
<h4 class="unnumbered" data-number="2.4.2" id="minimal-depth">Minimal depth</h4>
<p>The minimal depth is another statistic to quantify the importance of a variable. It assesses the distance between the root node and the first node for which the predictor is used to split the subjects (1 for first level, 2 for second level, 3 for third level, …). This statistic can be computed at the predictor level or at the feature level, allowing us to fully understand the tree building process.</p>
<p>We strongly advise computing the minimal depth with the <code>mtry</code> hyperparameter chosen at its maximum to ensure that all predictors are systematically among candidate predictors for splitting the subjects.</p>
<h2 data-number="3" id="the-r-package"><span class="header-section-number">3</span> The <a href="https://cran.r-project.org/package=DynForest">DynForest</a> R package</h2>
<p><a href="https://cran.r-project.org/package=DynForest">DynForest</a> methodology was implemented in the R package <a href="https://cran.r-project.org/package=DynForest">DynForest</a> <span class="citation" data-cites="devaux_dynforest_2024">(<a href="#ref-devaux_dynforest_2024" role="doc-biblioref">Devaux 2024</a>)</span> freely available on The Comprehensive R Archive Network (CRAN) to users.</p>
<p>The package includes two main functions: <code>dynforest()</code> and <code>predict()</code> for the learning and the prediction steps. These functions are fully described in section 3.1 and 3.2. Other functions available are briefly described in the table below. These functions are illustrated in examples, one for a survival outcome and one for a categorical outcome.</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Learning and prediction steps</em></td>
<td></td>
</tr>
<tr class="even">
<td><code>dynforest()</code></td>
<td>Function that builds the random forest</td>
</tr>
<tr class="odd">
<td><code>predict()</code></td>
<td>Function for S3 class <code>dynforest</code> predicting the outcome on new subjects using the individual-specific information</td>
</tr>
<tr class="even">
<td><em>Assessment function</em></td>
<td></td>
</tr>
<tr class="odd">
<td><code>compute_ooberror()</code></td>
<td>Function that computes the Out-Of-Bag error to be minimized to tune the random forest</td>
</tr>
<tr class="even">
<td><em>Exploring functions</em></td>
<td></td>
</tr>
<tr class="odd">
<td><code>compute_vimp()</code></td>
<td>Function that computes the importance of variables</td>
</tr>
<tr class="even">
<td><code>compute_gvimp()</code></td>
<td>Function that computes the importance of a group of variables</td>
</tr>
<tr class="odd">
<td><code>compute_vardepth()</code></td>
<td>Function that extracts information about the tree building process</td>
</tr>
<tr class="even">
<td><em>plot() functions for S3 class:</em></td>
<td></td>
</tr>
<tr class="odd">
<td><code>dynforest</code></td>
<td>Plot the estimated CIF for given tree nodes or subjects</td>
</tr>
<tr class="even">
<td><code>dynforestpred</code></td>
<td>Plot the predicted CIF for the cause of interest for given subjects</td>
</tr>
<tr class="odd">
<td><code>dynforestvimp</code></td>
<td>Plot the importance of variables by value or percentage</td>
</tr>
<tr class="even">
<td><code>dynforestgvimp</code></td>
<td>Plot the importance of a group of variables by value or percentage</td>
</tr>
<tr class="odd">
<td><code>dynforestvardepth</code></td>
<td>Plot the minimal depth by predictors or features</td>
</tr>
<tr class="even">
<td><em>Other functions</em></td>
<td></td>
</tr>
<tr class="odd">
<td><code>summary()</code></td>
<td>Function for class S3 <code>dynforest</code> or <code>dynforestoob</code> displaying information about the type of random forest, predictors included, parameters used, Out-Of-Bag error (only for <code>dynforestoob</code> class) and brief summaries about the leaves</td>
</tr>
<tr class="even">
<td><code>print()</code></td>
<td>Function to print object of class <code>dynforest</code>, <code>dynforestoob</code>, <code>dynforestvimp</code>, <code>dynforestgvimp</code>, <code>dynforestvardepth</code> and <code>dynforestpred</code></td>
</tr>
<tr class="odd">
<td><code>get_tree()</code></td>
<td>Function that extracts the tree structure for a given tree</td>
</tr>
<tr class="even">
<td><code>get_treenode()</code></td>
<td>Function that extracts the terminal node identifiers for a given tree</td>
</tr>
</tbody>
</table>
<h3 data-number="3.1" id="dynforest-function"><span class="header-section-number">3.1</span> <code>dynforest()</code> function</h3>
<p><code>dynforest()</code> is the function to build the random forest. The call of this function is:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>dynforest</span><span class='op'>(</span></span>
<span>  timeData <span class='op'>=</span> <span class='cn'>NULL</span>, fixedData <span class='op'>=</span> <span class='cn'>NULL</span>, idVar <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  timeVar <span class='op'>=</span> <span class='cn'>NULL</span>, timeVarModel <span class='op'>=</span> <span class='cn'>NULL</span>, Y <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  ntree <span class='op'>=</span> <span class='fl'>200</span>, mtry <span class='op'>=</span> <span class='cn'>NULL</span>, nodesize <span class='op'>=</span> <span class='fl'>1</span>, minsplit <span class='op'>=</span> <span class='fl'>2</span>, cause <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  nsplit_option <span class='op'>=</span> <span class='st'>"quantile"</span>, ncores <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  seed <span class='op'>=</span> <span class='fl'>1234</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="3.1.1" id="arguments">Arguments</h4>
<p><code>timeData</code> is an optional argument that contains the dataframe in longitudinal format (i.e., one observation per row) for the time-dependent predictors. In addition to time-dependent predictors, this dataframe should include a unique identifier and the measurement times. This argument is set to <code>NULL</code> if no time-dependent predictor is included. Argument <code>fixedData</code> contains the dataframe in wide format (i.e., one subject per row) for the time-fixed predictors. In addition to time-fixed predictors, this dataframe should also include the same identifier as used in <code>timeData.</code> This argument is set to <code>NULL</code> if no time-fixed predictor is included. Argument <code>idVar</code> provides the name of the identifier variable included in <code>timeData</code> and <code>fixedData</code> dataframes. Argument <code>timeVar</code> provides the name of the time variable included in <code>timeData</code> dataframe. Argument <code>timeVarModel</code> contains as many lists as time-dependent predictors defined in <code>timeData</code> to specify the structure of the mixed models assumed for each predictor. For each time-dependent predictor, the list should contain a <code>fixed</code> and a <code>random</code> argument to define the formula of a mixed model to be estimated with <a href="https://cran.r-project.org/package=lcmm">lcmm</a> R package <span class="citation" data-cites="proust_lima_estimation_2017">(<a href="#ref-proust_lima_estimation_2017" role="doc-biblioref">Proust-Lima et al. 2017</a>)</span>. <code>fixed</code> defines the formula for the fixed-effects and <code>random</code> for the random-effects (e.g., <code>list(Y1 = list(fixed = Y1 ~ time, random = ~ time))</code>. Argument <code>Y</code> contains a list of two elements <code>type</code> and <code>Y</code>. Element <code>type</code> defines the nature of the outcome (<code>surv</code> for survival outcome with possibly competing causes, <code>numeric</code> for continuous outcome and <code>factor</code> for categorical outcome) and element <code>Y</code> defines the dataframe which includes the identifier (same as in <code>timeData</code> and <code>fixedData</code> dataframes) and outcome variables.</p>
<p>Arguments <code>ntree</code>, <code>mtry</code>, <code>nodesize</code> and <code>minsplit</code> are the hyperparameters of the random forest. Argument <code>ntree</code> controls the number of trees in the random forest (200 by default). Argument <code>mtry</code> indicates the number of variables randomly drawn at each node (square root of the total number of predictors by default). Argument <code>nodesize</code> indicates the minimal number of subjects allowed in the leaves (1 by default). Argument <code>minsplit</code> controls the minimal number of events required to split the node (2 by default).</p>
<p>For a survival outcome, argument <code>cause</code> indicates the event of interest. Argument <code>nsplit_option</code> indicates the method to build the two groups of individuals at each node. By default, we build the groups according to deciles (<code>quantile</code> option) but they could be built according to random values (<code>sample</code> option).</p>
<p>Argument <code>ncores</code> indicates the number of cores used to grow the trees in parallel mode. By default, we set the number of cores of the computer minus 1. Argument <code>seed</code> specifies the random seed. It can be fixed to replicate the results. Argument <code>verbose</code> allows to display a progression bar during the execution of the function.</p>
<h4 class="unnumbered" data-number="3.1.2" id="values">Values</h4>
<p><code>dynforest()</code> function returns an object of class <code>dynforest</code> containing several elements:</p>
<ul>
<li><code>data</code> a list with longitudinal predictors (<code>Longitudinal</code> element), continuous predictors (<code>Numeric</code> element) and categorical predictors (<code>Factor</code> element)</li>
<li><code>rf</code> is a dataframe with one column per tree containing a list with several elements, which includes:
<ul>
<li><code>leaves</code> the leaf identifier for each subject used to grow the tree</li>
<li><code>idY</code> the identifiers for each subject used to grow the tree</li>
<li><code>V_split</code> the split summary (more detailed below)</li>
<li><code>Y_pred</code> the estimated outcome in each leaf</li>
<li><code>model_param</code> the estimated parameters of the mixed model for the longitudinal predictors used to split the subjects at each node</li>
<li><code>Ytype</code>, <code>hist_nodes</code>, <code>Y</code>, <code>boot</code> and <code>Ylevels</code> internal information used in other functions</li>
</ul></li>
<li><code>type</code> the nature of the outcome</li>
<li><code>times</code> the event times (only for survival outcome)</li>
<li><code>cause</code> the cause of interest (only for survival outcome)</li>
<li><code>causes</code> the unique causes (only for survival outcome)</li>
<li><code>Inputs</code> the list of predictors names for <code>Longitudinal</code> (longitudinal predictor), <code>Continuous</code> (continuous predictor) and <code>Factor</code> (categorical predictor)</li>
<li><code>Longitudinal.model</code> the mixed model specification for each longitudinal predictor</li>
<li><code>param</code> a list of hyperparameters used to grow the random forest</li>
<li><code>comput.time</code> the computation time</li>
</ul>
<p>The main information returned by <code>rf</code> is the <code>V_split</code> element which can also be extracted using the <code>get_tree()</code> function. This element contains a table sorted by the node/leaf identifier (<code>id_node</code> column) with each row representing a node/leaf. Each column provides information about the splits:</p>
<ul>
<li><code>type</code>: the nature of the predictor (<code>Longitudinal</code> for longitudinal predictor, <code>Numeric</code> for continuous predictor or <code>Factor</code> for categorical predictor) if the node was split, <code>Leaf</code> otherwise;</li>
<li><code>var_split</code>: the predictor used for the split defined by its order in <code>timeData</code> and <code>fixedData</code>;</li>
<li><code>feature</code>: the feature used for the split defined by its position in random statistic;</li>
<li><code>threshold</code>: the threshold used for the split (only with <code>Longitudinal</code> and <code>Numeric</code>). No information is returned for <code>Factor</code>;</li>
<li><code>N</code>: the number of subjects in the node/leaf;</li>
<li><code>Nevent</code>: the number of events of interest in the node/leaf (only with survival outcome);</li>
<li><code>depth</code>: the depth level of the node/leaf.</li>
</ul>
<h4 class="unnumbered" data-number="3.1.3" id="additional-information-about-the-dependencies">Additional information about the dependencies</h4>
<p><code>dynforest()</code> function internally calls other functions from related packages to build the random forest:</p>
<ul>
<li><code>hlme()</code> function (from <a href="https://cran.r-project.org/package=lcmm">lcmm</a> package <span class="citation" data-cites="proust_lima_estimation_2017">(<a href="#ref-proust_lima_estimation_2017" role="doc-biblioref">Proust-Lima et al. 2017</a>)</span>) to fit the mixed models for the time-dependent predictors defined in <code>timeData</code> and <code>timeVarModel</code> arguments</li>
<li><code>Entropy()</code> function (from base package) to compute the Shannon entropy</li>
<li><code>survdiff()</code> function (from <a href="https://cran.r-project.org/package=survival">survival</a> package <span class="citation" data-cites="therneau_2022_survival">(<a href="#ref-therneau_2022_survival" role="doc-biblioref">Therneau 2022</a>)</span>) to compute the log-rank statistic test</li>
<li><code>crr()</code> function (from <a href="https://cran.r-project.org/package=cmprsk">cmprsk</a> package <span class="citation" data-cites="gray_cmprsk_2020">(<a href="#ref-gray_cmprsk_2020" role="doc-biblioref">Gray 2020</a>)</span>) to compute the Fine &amp; Gray statistic test</li>
</ul>
<h3 data-number="3.2" id="predict-function"><span class="header-section-number">3.2</span> <code>predict()</code> function</h3>
<p><code>predict()</code> is the S3 function for class <code>dynforest</code> to predict the outcome on new subjects. Landmark time can be specified to consider only longitudinal data collected up to this time to compute the prediction. The call of this function is:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>object</span>, timeData <span class='op'>=</span> <span class='cn'>NULL</span>, fixedData <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>idVar</span>, <span class='va'>timeVar</span>, t0 <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="3.2.1" id="arguments-1">Arguments</h4>
<p>Argument <code>object</code> contains a <code>dynforest</code> object resulting from the <code>dynforest()</code> function. Argument <code>timeData</code> contains the dataframe in longitudinal format (i.e., one observation per row) for the time-dependent predictors of new subjects. In addition to time-dependent predictors, this dataframe should also include a unique identifier and the time measurements. This argument can be set to <code>NULL</code> if no time-dependent predictor is included. Argument <code>fixedData</code> contains the dataframe in wide format (i.e., one subject per row) for the time-fixed predictors of new subjects. In addition to time-fixed predictors, this dataframe should also include a unique identifier. This argument can be set to <code>NULL</code> if no time-fixed predictor is included. Argument <code>idVar</code> provides the name of the identifier variable included in <code>timeData</code> and <code>fixedData</code> dataframes. Argument <code>timeVar</code> provides the name of the time-measurement variable included in <code>timeData</code> dataframe. Argument <code>t0</code> defines the landmark time; only the longitudinal data collected up to this time are to be considered. This argument should be set to <code>NULL</code> to include all longitudinal data.</p>
<h4 class="unnumbered" data-number="3.2.2" id="values-1">Values</h4>
<p><code>predict()</code> function returns several elements:</p>
<ul>
<li><code>t0</code> the landmark time defined in the argument (<code>NULL</code> by default)</li>
<li><code>times</code> times used to compute the individual predictions (only with survival outcome). The times are defined according to the time-to-event subjects used to build the random forest.</li>
<li><code>pred_indiv</code> the predicted outcome for the new subject. With survival outcome, predictions are provided for each time defined in the <code>times</code> element.</li>
<li><code>pred_leaf</code> a table giving for each tree (in column) the leaf in which each subject is assigned (in row)</li>
<li><code>pred_indiv_proba</code> the proportion of the trees leading to the category prediction for each subject (only with categorical outcome)</li>
</ul>
<h2 data-number="4" data-short-title="How to use DynForest R package with a survival outcome?" id="sec:dynforestR_surv"><span class="header-section-number">4</span> How to use <a href="https://cran.r-project.org/package=DynForest">DynForest</a> R package with a survival outcome?</h2>
<h3 data-number="4.1" id="illustrative-dataset-pbc2-dataset"><span class="header-section-number">4.1</span> Illustrative dataset: <code>pbc2</code> dataset</h3>
<p>The <code>pbc2</code> dataset <span class="citation" data-cites="murtaugh_primary_1994">(<a href="#ref-murtaugh_primary_1994" role="doc-biblioref">Murtaugh et al. 1994</a>)</span> is loaded with the package <a href="https://cran.r-project.org/package=DynForest">DynForest</a> to illustrate its functionalities. <code>pbc2</code> data come from a clinical trial conducted by the Mayo Clinic between 1974 and 1984 to treat primary biliary cholangitis (PBC), a chronic liver disease. A total of 312 patients were enrolled in a clinical trial to evaluate the effectiveness of D-penicillamine compared to a placebo to treat PBC and were followed until the clinical trial ended, leading to a total of 1945 observations. During the follow-up, several clinical continuous markers were collected over time such as: the level of serum bilirubin (<code>serBilir</code>), the level of serum cholesterol (<code>serChol</code>), the level of albumin (<code>albumin</code>), the level of alkaline (<code>alkaline</code>), the level of aspartate aminotransferase (<code>SGOT</code>), platelets count (<code>platelets</code>), and the prothrombin time (<code>prothrombin</code>). Four non-continuous time-dependent predictors were also collected: the presence of ascites (<code>ascites</code>), the presence of hepatomegaly (<code>hepatomegaly</code>), the presence of blood vessel malformations in the skin (<code>spiders</code>), and the edema levels (<code>edema</code>). These time-dependent predictors were recorded according to the <code>time</code> variable. In addition to these time-dependent predictors, a few predictors were collected at enrollment: sex (<code>sex</code>), age (<code>age</code>), and the drug treatment (<code>drug</code>). During the follow-up, 140 patients died before transplantation, 29 patients were transplanted, and 143 patients were censored alive (<code>event</code>). The time of the first event (censored alive or any event) was considered as the event time (<code>years</code>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/anthonydevaux/DynForest'>"DynForest"</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>)</span></span>
<span><span class='va'>pbc2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"id"</span>, <span class='st'>"time"</span>, <span class='st'>"serBilir"</span>, <span class='st'>"SGOT"</span>, <span class='st'>"albumin"</span>, <span class='st'>"alkaline"</span>,</span>
<span>  <span class='st'>"age"</span>, <span class='st'>"drug"</span>, <span class='st'>"sex"</span>, <span class='st'>"years"</span>, <span class='st'>"event"</span></span>
<span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>   id      time serBilir  SGOT albumin alkaline      age      drug
1   1 0.0000000     14.5 138.0    2.60     1718 58.76684 D-penicil
2   1 0.5256817     21.3   6.2    2.94     1612 58.76684 D-penicil
3  10 0.0000000     12.6 147.3    2.74      918 70.56182   placebo
4 100 0.0000000      2.3 178.3    3.00      746 51.47027   placebo
5 100 0.4681853      2.5 189.1    2.94      836 51.47027   placebo
     sex     years event
1 female 1.0951703     2
2 female 1.0951703     2
3 female 0.1396342     2
4   male 1.5113350     2
5   male 1.5113350     2</code></pre>
</div>
<p>For the illustration, 4 time-dependent predictors (<code>serBilir</code>, <code>SGOT</code>, <code>albumin</code> and <code>alkaline</code>) and 3 predictors measured at enrollment (<code>sex</code>, <code>age</code> and <code>drug</code>) were considered. We aim to predict death without transplantation in patients suffering from primary biliary cholangitis (PBC) using clinical and socio-demographic predictors, considering transplantation as a competing event.</p>
<h3 data-number="4.2" id="data-management"><span class="header-section-number">4.2</span> Data management</h3>
<p>To begin, we split the subjects into two datasets: (i) one dataset to train the random forest using <span class="math inline">\(2/3\)</span> of patients; (ii) one dataset to predict on the other <span class="math inline">\(1/3\)</span> of patients. The random seed is set to 1234 for replication purposes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span></span>
<span><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span></span>
<span><span class='va'>id_sample</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>/</span> <span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='va'>id_row</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>id</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>id_sample</span><span class='op'>)</span></span>
<span><span class='va'>pbc2_train</span> <span class='op'>&lt;-</span> <span class='va'>pbc2</span><span class='op'>[</span><span class='va'>id_row</span>, <span class='op'>]</span></span>
<span><span class='va'>pbc2_pred</span> <span class='op'>&lt;-</span> <span class='va'>pbc2</span><span class='op'>[</span><span class='op'>-</span><span class='va'>id_row</span>, <span class='op'>]</span></span></code></pre>
</div>
</div>
<p>Then, we build the dataframe <code>timeData_train</code> in the longitudinal format (i.e., one observation per row) for the longitudinal predictors including: <code>id</code> the unique patient identifier; <code>time</code> the observed time measurements; <code>serBilir</code>, <code>SGOT</code>, <code>albumin</code> and <code>alkaline</code> the longitudinal predictors. We also build the dataframe <code>fixedData_train</code> with the time-fixed predictors including: <code>id</code> the unique patient identifier; <code>age</code>, <code>drug</code> and <code>sex</code> predictors measured at enrollment. The nature of each predictor needs to be properly defined with the <code>as.factor()</code> function for categorical predictors (e.g., <code>drug</code> and <code>sex</code>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>timeData_train</span> <span class='op'>&lt;-</span> <span class='va'>pbc2_train</span><span class='op'>[</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"time"</span>, <span class='st'>"serBilir"</span>, <span class='st'>"SGOT"</span>, <span class='st'>"albumin"</span>, <span class='st'>"alkaline"</span><span class='op'>)</span></span>
<span><span class='op'>]</span></span>
<span><span class='va'>fixedData_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2_train</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"age"</span>, <span class='st'>"drug"</span>, <span class='st'>"sex"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="4.3" id="specification-of-the-models-for-the-time-dependent-predictors"><span class="header-section-number">4.3</span> Specification of the models for the time-dependent predictors</h3>
<p>The first step of the random forest building consists of specifying the mixed model of each longitudinal predictor through a list containing the fixed and random formula for the fixed effect and random effects of the mixed models, respectively. Here, we assume a linear trajectory for <code>serBilir</code>, <code>albumin</code> and <code>alkaline</code>, and a quadratic trajectory for <code>SGOT.</code> Although we restricted this example to linear and quadratic functions of time, we note that any function can be considered, including splines.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>timeVarModel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  serBilir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>serBilir</span> <span class='op'>~</span> <span class='va'>time</span>, random <span class='op'>=</span> <span class='op'>~</span><span class='va'>time</span><span class='op'>)</span>,</span>
<span>  SGOT <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>SGOT</span> <span class='op'>~</span> <span class='va'>time</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>time</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  albumin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>albumin</span> <span class='op'>~</span> <span class='va'>time</span>, random <span class='op'>=</span> <span class='op'>~</span><span class='va'>time</span><span class='op'>)</span>,</span>
<span>  alkaline <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>alkaline</span> <span class='op'>~</span> <span class='va'>time</span>, random <span class='op'>=</span> <span class='op'>~</span><span class='va'>time</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>For this illustration, the outcome object contains a list with <code>type</code> set to <code>surv</code> (for survival data) and <code>Y</code> contains a dataframe in wide format (one subject per row) with: <code>id</code> the unique patient identifier; <code>years</code> the time-to-event data; <code>event</code> the event indicator.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='st'>"surv"</span>, Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2_train</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"years"</span>, <span class='st'>"event"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="4.4" id="random-forest-building"><span class="header-section-number">4.4</span> Random forest building</h3>
<p>We build the random forest using <code>dynforest()</code> function with the following code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/dynforest.html'>dynforest</a></span><span class='op'>(</span></span>
<span>  timeData <span class='op'>=</span> <span class='va'>timeData_train</span>,</span>
<span>  fixedData <span class='op'>=</span> <span class='va'>fixedData_train</span>,</span>
<span>  timeVar <span class='op'>=</span> <span class='st'>"time"</span>, idVar <span class='op'>=</span> <span class='st'>"id"</span>,</span>
<span>  timeVarModel <span class='op'>=</span> <span class='va'>timeVarModel</span>, Y <span class='op'>=</span> <span class='va'>Y</span>,</span>
<span>  ntree <span class='op'>=</span> <span class='fl'>200</span>, mtry <span class='op'>=</span> <span class='fl'>3</span>, nodesize <span class='op'>=</span> <span class='fl'>2</span>, minsplit <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>  cause <span class='op'>=</span> <span class='fl'>2</span>, ncores <span class='op'>=</span> <span class='fl'>7</span>, seed <span class='op'>=</span> <span class='fl'>1234</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In a survival context with multiple events, it is necessary to specify the event of interest with the argument <code>cause.</code> We thus fix <code>cause</code> = 2 to specify the event of interest (i.e., the death event). For the hyperparameters, we arbitrarily chose <code>mtry</code> = 3, <code>nodesize</code> = 2, and <code>minsplit</code> = 3, and we will discuss this point in section 4.8.</p>
<p>Overall information about the random forest can be output with the <code>summary()</code> function as displayed below for our example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res_dyn</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>dynforest executed for survival (competing risk) outcome 
    Splitting rule: Fine &amp; Gray statistic test 
    Out-of-bag error type: Integrated Brier Score 
    Leaf statistic: Cumulative incidence function 
---------------- 
Input 
    Number of subjects: 208 
    Longitudinal: 4 predictor(s) 
    Numeric: 1 predictor(s) 
    Factor: 2 predictor(s) 
---------------- 
Tuning parameters 
    mtry: 3 
    nodesize: 2 
    minsplit: 3 
    ntree: 200 
---------------- 
---------------- 
dynforest summary 
    Average depth per tree: 6.62 
    Average number of leaves per tree: 27.68 
    Average number of subjects per leaf: 4.78 
    Average number of events of interest per leaf: 1.95 
---------------- 
Computation time 
    Number of cores used: 7 
    Time difference of 3.18191 mins
---------------- </code></pre>
</div>
<p>We executed the <code>dynforest()</code> function for a survival outcome with competing events. In this mode, we use the Fine &amp; Gray statistic test as the splitting rule and the cumulative incidence function (CIF) as the leaf statistic. To build the random forest, we included 208 subjects with 4 longitudinal (<code>Longitudinal</code>), 1 continuous (<code>Numeric</code>) and 2 categorical (<code>Factor</code>) predictors. The <code>summary()</code> function returns some statistics about the trees. For instance, we have on average 4.8 subjects and 1.9 death events per leaf. The number of subjects per leaf should always be higher than the <code>nodesize</code> hyperparameter. OOB error should first be computed using the <code>compute_ooberror()</code> function (see section 4.5) to be displayed on summary output.</p>
<p>To further investigate the tree structure, the split details can be output using the <code>get_tree()</code> function with the following code (for tree 1):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/get_tree.html'>get_tree</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn</span>, tree <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>          type id_node var_split feature     threshold   N Nevent
1 Longitudinal       1         3       1 -1.272629e-01 129     51
2      Numeric       2         1      NA  4.138210e+01  39     27
3 Longitudinal       3         4       1  1.459346e+02  90     24
4 Longitudinal       4         3       1  3.608271e-11   8      3
5 Longitudinal       5         2       1  5.924123e+01  31     24
6 Longitudinal       6         1       1  2.786575e-01  63     12
  depth
1     1
2     2
3     2
4     3
5     3
6     3</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/get_tree.html'>get_tree</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn</span>, tree <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>           type id_node var_split feature     threshold N Nevent
50         Leaf     174        NA      NA            NA 2      2
51 Longitudinal     175         2       1 -1.850322e-10 4      4
52         Leaf     250        NA      NA            NA 5      1
53         Leaf     251        NA      NA            NA 4      2
54         Leaf     350        NA      NA            NA 2      2
55         Leaf     351        NA      NA            NA 2      2
   depth
50     8
51     8
52     8
53     8
54     9
55     9</code></pre>
</div>
<p>Looking at the head of the <code>get_tree()</code> function output, we see that subjects were split at node 1 (<code>id_node</code>) using the first random-effect (<code>feature</code> = 1) of the third <code>Longitudinal</code> predictor (<code>var_split</code> = 3) with <code>threshold</code> = -0.1273. <code>var_split</code> = 3 corresponds to <code>albumin</code>, so subjects at node 1 with <code>albumin</code> values below -0.1273 are assigned to node 2, otherwise to node 3. The last rows of the random forest given by the tail of <code>get_tree()</code> function output provide the leaves descriptions. For instance, in row 53, 4 subjects are included in leaf 251, and 2 subjects have the event of interest.</p>
<p>Estimated cumulative incidence function (CIF) within each leaf of a tree can be displayed using the <code>plot()</code> function. For instance, the CIF of the cause of interest for leaf 251 in tree 1 can be displayed using the following code:</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>CIF of a single tree is not meant to be interpreted alone. The CIF should be averaged over all trees of the random forest. For a subject, the estimated CIF over the random forest is obtained by averaging all the tree-specific CIFs of the tree-leaf where the subject belongs. This can be done with the <code>plot()</code> function such as:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res_dyn</span>, id <span class='op'>=</span> <span class='fl'>104</span>, max_tree <span class='op'>=</span> <span class='fl'>9</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DynForestRCIF"></span>
<img src="RJ-2025-002_files/figure-html5/DynForestRCIF-1.png" alt="Estimated cumulative incidence functions for subject 104 over 9 trees." width="80%" height="30%" />
<p class="caption">
Figure 2: Estimated cumulative incidence functions for subject 104 over 9 trees.
</p>
</div>
</div>
<p>In this example, we display in figure <a href="#fig:DynForestRCIF">2</a> for subject 104 the tree-specific CIFs for the first 9 trees where this subject is used to grow the trees. This figure shows how the estimated CIF can differ across the trees and requires to be averaged as each is calculated from information of the few subjects belonging to a leaf.</p>
<h3 data-number="4.5" id="out-of-bag-error"><span class="header-section-number">4.5</span> Out-Of-Bag error</h3>
<p>The Out-Of-Bag error (OOB) aims at assessing the predictive abilities of the random forest. With a survival outcome, the OOB error is evaluated using the Integrated Brier Score (IBS) <span class="citation" data-cites="gerds_consistent_2006">(<a href="#ref-gerds_consistent_2006" role="doc-biblioref">Gerds and Schumacher 2006</a>)</span>. It is computed using the <code>compute_ooberror()</code> function with an object of class <code>dynforest</code> as the main argument, such as:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn_OOB</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/compute_ooberror.html'>compute_ooberror</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><code>compute_ooberror()</code> returns the OOB errors by individual. The overall OOB error for the random forest is obtained by averaging the individual specific OOB errors, and can be displayed using <code>print()</code> or directly by calling the object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn_OOB</span></span></code></pre>
</div>
<pre><code>[1] 0.1265053</code></pre>
</div>
<p>We obtain an IBS of 0.127 computed from time 0 to the maximum event time. The time range can be modified using <code>IBS.min</code> and <code>IBS.max</code> arguments to define the minimum and maximum, respectively. To maximize the predictive ability of the random forest, the hyperparameters can be tuned, that is, chosen as those that minimize the OOB error (see section 4.8).</p>
<h3 data-number="4.6" id="individual-prediction-of-the-outcome-1"><span class="header-section-number">4.6</span> Individual prediction of the outcome</h3>
<p>The <code>predict()</code> function allows prediction of the outcome for a new subject using the trained random forest. The function requires the individual data: time-dependent predictors in <code>timeData</code> and time-fixed predictors in <code>fixedData.</code> For a survival outcome, dynamic predictions can be computed by fixing a prediction time (called landmark time, argument <code>t0</code>) from which the prediction is made. In this case, only the history of the individual up to this landmark time (including the longitudinal and time-fixed predictors) will be used. In particular, if the landmark time is fixed to 0, only the information at time 0 will be considered for predicting the outcome.</p>
<p>For the illustration, we only select the subjects still at risk at the landmark time of 4 years. We build the dataframe for those subjects and we predict the individual-specific CIF using the <code>predict()</code> function as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>id_pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2_pred</span><span class='op'>$</span><span class='va'>id</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>pbc2_pred</span><span class='op'>$</span><span class='va'>years</span> <span class='op'>&gt;</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>pbc2_pred_tLM</span> <span class='op'>&lt;-</span> <span class='va'>pbc2_pred</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>pbc2_pred</span><span class='op'>$</span><span class='va'>id</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>id_pred</span><span class='op'>)</span>, <span class='op'>]</span></span>
<span><span class='va'>timeData_pred</span> <span class='op'>&lt;-</span> <span class='va'>pbc2_pred_tLM</span><span class='op'>[</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"time"</span>, <span class='st'>"serBilir"</span>, <span class='st'>"SGOT"</span>, <span class='st'>"albumin"</span>, <span class='st'>"alkaline"</span><span class='op'>)</span></span>
<span><span class='op'>]</span></span>
<span><span class='va'>fixedData_pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2_pred_tLM</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"age"</span>, <span class='st'>"drug"</span>, <span class='st'>"sex"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>pred_dyn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span></span>
<span>  object <span class='op'>=</span> <span class='va'>res_dyn</span>,</span>
<span>  timeData <span class='op'>=</span> <span class='va'>timeData_pred</span>,</span>
<span>  fixedData <span class='op'>=</span> <span class='va'>fixedData_pred</span>,</span>
<span>  idVar <span class='op'>=</span> <span class='st'>"id"</span>,</span>
<span>  timeVar <span class='op'>=</span> <span class='st'>"time"</span>,</span>
<span>  t0 <span class='op'>=</span> <span class='fl'>4</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The <code>predict()</code> function provides several elements as described in section 3.2. In addition, the <code>plot()</code> function can be used to display the CIF of the outcome (here death before transplantation) for subjects indicated with argument <code>id</code>. For instance, we compute the CIF for subjects 102 and 260 with the following code and display them in figure <a href="#fig:DynForestRpredCIF">3</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DynForestRpredCIF"></span>
<img src="RJ-2025-002_files/figure-html5/DynForestRpredCIF-1.png" alt="Predicted cumulative incidence function for subjects 102 and 260 from landmark time of 4 years (represented by the dashed vertical line)" width="80%" height="30%" />
<p class="caption">
Figure 3: Predicted cumulative incidence function for subjects 102 and 260 from landmark time of 4 years (represented by the dashed vertical line)
</p>
</div>
</div>
<p>In the first year after the landmark time (at 4 years), we observe a rapid increase in the risk of death for subject 260 compared to subject 102. We also notice that after 10 years from the landmark time, subject 260 has a probability of death almost three times higher than that of subject 102.</p>
<h3 data-number="4.7" id="predictiveness-of-the-variables"><span class="header-section-number">4.7</span> Predictiveness of the variables</h3>
<h4 class="unnumbered" data-number="4.7.1" id="variable-importance-1">Variable importance</h4>
<p>The main objective of the random forest is to predict an outcome. But usually, we are interested in identifying which predictors are the most predictive. The VIMP statistic <span class="citation" data-cites="ishwaran_random_2008">(<a href="#ref-ishwaran_random_2008" role="doc-biblioref">Ishwaran et al. 2008</a>)</span> can be computed using the <code>compute_vimp()</code> function. This function returns the VIMP statistic for each predictor with the <code>$Importance</code> element. These results can also be displayed using the <code>plot()</code> function, either in absolute value by default or in percentage with the <code>PCT</code> argument set to <code>TRUE</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn_VIMP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/compute_vimp.html'>compute_vimp</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn</span>, seed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res_dyn_VIMP</span>, PCT <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The VIMP results are displayed in figure <a href="#fig:DynForestRVIMPgVIMP">4</a>A. The most predictive variables are <code>serBilir</code>, <code>albumin</code> and <code>age</code> with the largest VIMP percentage. By removing the association between <code>serBilir</code> and the event, the OOB error was increased by 30%.</p>
<p>In the case of correlated predictors, the predictors can be regrouped into dimensions and the VIMP can be computed at the dimension group level with the gVIMP statistic. Permutation is done for each variable of the group simultaneously. The gVIMP is computed with the <code>compute_gvimp()</code> function in which the <code>group</code> argument defines the group of predictors as a list. For instance, with two groups of predictors (named group1 and group2), the gVIMP statistic is computed using the following code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  group1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"serBilir"</span>, <span class='st'>"SGOT"</span><span class='op'>)</span>,</span>
<span>  group2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"albumin"</span>, <span class='st'>"alkaline"</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>res_dyn_gVIMP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/compute_gvimp.html'>compute_gvimp</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn</span>, group <span class='op'>=</span> <span class='va'>group</span>, seed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res_dyn_gVIMP</span>, PCT <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Similar to the VIMP statistic, the gVIMP results can be displayed using the <code>plot()</code> function. The figure <a href="#fig:DynForestRVIMPgVIMP">4</a>B shows that group1 has the highest gVIMP percentage with 34%.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='va'>p2</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DynForestRVIMPgVIMP"></span>
<img src="RJ-2025-002_files/figure-html5/DynForestRVIMPgVIMP-1.png" alt="(A) VIMP statistic and (B) grouped-VIMP statistic displayed as a percentage of loss in OOB error of prediction. group1 includes serBilir and SGOT; group2 includes albumin and alkaline." width="80%" height="30%" />
<p class="caption">
Figure 4: (A) VIMP statistic and (B) grouped-VIMP statistic displayed as a percentage of loss in OOB error of prediction. group1 includes serBilir and SGOT; group2 includes albumin and alkaline.
</p>
</div>
</div>
<p>To compute the gVIMP statistic, the groups can be defined regardless of the number of predictors. However, the comparison between the groups may be harder when group sizes are very different.</p>
<h4 class="unnumbered" data-number="4.7.2" id="minimal-depth-1">Minimal depth</h4>
<p>To go further into the understanding of the tree building process, the <code>compute_vardepth()</code> function extracts information about the average minimal depth by feature (<code>$min_depth</code>), the minimal depth for each feature and each tree (<code>$var_node_depth</code>), and the number of times that the feature is used for splitting for each feature and each tree (<code>$var_count</code>).</p>
<p>Using an object from the <code>compute_vardepth()</code> function, the <code>plot()</code> function allows us to plot the distribution of the average minimal depth across the trees. The <code>plot_level</code> argument defines how the average minimal depth is plotted, by predictor or feature.</p>
<p>The distribution of the minimal depth level is displayed in figure <a href="#fig:DynForestRmindepth">5</a> by predictor and feature. Note that the minimal depth level should always be interpreted with the number of trees where the predictor/feature is found. Indeed, to accurately appreciate the importance of a variable’s minimal depth, the variable has to be systematically part of the candidates at each node. This is why we strongly advise computing the minimal depth on a random forest with the <code>mtry</code> hyperparameter chosen at its maximum (as done below).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/dynforest.html'>dynforest</a></span><span class='op'>(</span></span>
<span>  timeData <span class='op'>=</span> <span class='va'>timeData_train</span>,</span>
<span>  fixedData <span class='op'>=</span> <span class='va'>fixedData_train</span>,</span>
<span>  timeVar <span class='op'>=</span> <span class='st'>"time"</span>, idVar <span class='op'>=</span> <span class='st'>"id"</span>,</span>
<span>  timeVarModel <span class='op'>=</span> <span class='va'>timeVarModel</span>, Y <span class='op'>=</span> <span class='va'>Y</span>,</span>
<span>  ntree <span class='op'>=</span> <span class='fl'>200</span>, mtry <span class='op'>=</span> <span class='fl'>7</span>, nodesize <span class='op'>=</span> <span class='fl'>2</span>, minsplit <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>  cause <span class='op'>=</span> <span class='fl'>2</span>, ncores <span class='op'>=</span> <span class='fl'>7</span>, seed <span class='op'>=</span> <span class='fl'>1234</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>depth_dyn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/compute_vardepth.html'>compute_vardepth</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn_max</span><span class='op'>)</span></span>
<span><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>depth_dyn</span>, plot_level <span class='op'>=</span> <span class='st'>"predictor"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>depth_dyn</span>, plot_level <span class='op'>=</span> <span class='st'>"feature"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='va'>p2</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DynForestRmindepth"></span>
<img src="RJ-2025-002_files/figure-html5/DynForestRmindepth-1.png" alt="Average minimal depth level by predictor (A) and feature (B)." width="80%" height="30%" />
<p class="caption">
Figure 5: Average minimal depth level by predictor (A) and feature (B).
</p>
</div>
</div>
<p>In our example, we ran a random forest with the mtry hyperparameter set to its maximum (i.e., <code>mtry</code> = 7) and we computed the minimal depth on this random forest. We observe that <code>serBilir</code>, <code>albumin</code> and <code>age</code> have the lowest minimal depth, indicating these predictors are used to split the subjects at early stages in 200 out of 200 trees, i.e., 100% for <code>serBilir</code>, <code>age</code> and in 199 out of 200 for <code>albumin</code> (figure <a href="#fig:DynForestRmindepth">5</a>A). The minimal depth level by feature (figure <a href="#fig:DynForestRmindepth">5</a>B) provides more advanced details about the tree building process. For instance, we can see that the random effects of <code>serBilir</code> (indicated by bi0 and bi1 in the graph) are the earliest features used on 199 and 197 out of 200 trees, respectively.</p>
<h3 data-number="4.8" id="guidelines-to-tune-the-hyperparameters"><span class="header-section-number">4.8</span> Guidelines to tune the hyperparameters</h3>
<p>The predictive performance of the random forest strongly depends on the hyperparameters <code>mtry</code>, <code>nodesize</code> and <code>minsplit.</code> They should therefore be chosen carefully. The <code>nodesize</code> and <code>minsplit</code> hyperparameters control the tree depth. The trees need to be deep enough to ensure that the predictions are accurate. By default, we fixed <code>nodesize</code> and <code>minsplit</code> at the minimum, that is <code>nodesize</code> = 1 and <code>minsplit</code> = 2. However, with a large number of individuals, the tree depth could be slightly decreased by increasing these hyperparameters in order to reduce the computation time.</p>
<p>The <code>mtry</code> hyperparameter defines the number of predictors randomly drawn at each node. By default, we chose <code>mtry</code> equal to the square root of the number of predictors as usually recommended <span class="citation" data-cites="bernard_influence_2009">(<a href="#ref-bernard_influence_2009" role="doc-biblioref">Bernard et al. 2009</a>)</span>. However, this hyperparameter should be carefully tuned with possible values between 1 and the number of predictors. Indeed, the predictive performance of the random forest is highly related to this hyperparameter.</p>
<p>In the illustration, we tuned <code>mtry</code> for every possible value (1 to 7). Figure <a href="#fig:DynForestRmtrytuned">6</a> displays the OOB error according to the <code>mtry</code> hyperparameter.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DynForestRmtrytuned"></span>
<img src="RJ-2025-002_files/figure-html5/DynForestRmtrytuned-1.png" alt="OOB error according to mtry hyperparameter. The optimal value was found for the maximum value mtry = 7." width="80%" height="30%" />
<p class="caption">
Figure 6: OOB error according to mtry hyperparameter. The optimal value was found for the maximum value mtry = 7.
</p>
</div>
</div>
<p>We can see in this figure large OOB error differences according to the <code>mtry</code> hyperparameter. In particular, we observe the worst predictive performance for <code>mtry</code> = 1. The minimum OOB error value is obtained for <code>mtry</code> = 7 although differences from <code>mtry</code> = 3 to <code>mtry</code> = 7 seem relatively minimal. Moreover, a larger <code>mtry</code> value has a significant impact on the computation time. Using 7 cores in this example, the <code>dynforest()</code> function has been executed in 1.7, 2.8, 3.8, 4.7, 5.4, 6.2 and 7.2 minutes, for <code>mtry</code> values ranging from 1 to 7, respectively. The number of subjects, time measurements, trees, and their depths may also contribute to longer computation time.</p>
<h2 data-number="5" data-short-title="How to use DynForest R package with a categorical outcome?" id="how-to-use-r-package-with-a-categorical-outcome"><span class="header-section-number">5</span> How to use <a href="https://cran.r-project.org/package=DynForest">DynForest</a> R package with a categorical outcome?</h2>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>In this section, we use <a href="https://cran.r-project.org/package=DynForest">DynForest</a> in a classification perspective using <code>pbc2</code> data. For illustration purposes, we want to predict death between 4 and 10 years on subjects still at risk at 4 years from the repeated data up to 4 years. Note that this is only for illustrative purposes as this technique does not handle the censoring of death times correctly.</p>
<h3 data-number="5.1" id="data-management-1"><span class="header-section-number">5.1</span> Data management</h3>
<p>For the illustration, we select patients still at risk at 4 years and we recode the <code>event</code> variable with <code>event</code> = 1 for subjects who died between 4 years and 10 years, whereas subjects with transplantation were recoded <code>event</code> = 0, as were the subjects still alive. We split the subjects into two datasets: (i) one dataset to train the random forest using <span class="math inline">\(2/3\)</span> of patients; (ii) one dataset to predict on the other <span class="math inline">\(1/3\)</span> of patients.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>pbc2</span> <span class='op'>&lt;-</span> <span class='va'>pbc2</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>years</span> <span class='op'>&gt;</span> <span class='fl'>4</span> <span class='op'>&amp;</span> <span class='va'>pbc2</span><span class='op'>$</span><span class='va'>time</span> <span class='op'>&lt;=</span> <span class='fl'>4</span><span class='op'>)</span>, <span class='op'>]</span></span>
<span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>event</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>event</span> <span class='op'>==</span> <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>event</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>years</span> <span class='op'>&gt;</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span></span>
<span><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span></span>
<span><span class='va'>id_sample</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>/</span> <span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='va'>id_row</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>pbc2</span><span class='op'>$</span><span class='va'>id</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>id_sample</span><span class='op'>)</span></span>
<span><span class='va'>pbc2_train</span> <span class='op'>&lt;-</span> <span class='va'>pbc2</span><span class='op'>[</span><span class='va'>id_row</span>, <span class='op'>]</span></span>
<span><span class='va'>pbc2_pred</span> <span class='op'>&lt;-</span> <span class='va'>pbc2</span><span class='op'>[</span><span class='op'>-</span><span class='va'>id_row</span>, <span class='op'>]</span></span></code></pre>
</div>
</div>
<p>We use the same strategy as in the survival context (section 4) to build the random forest, with the same predictors and the same association for time-dependent predictors.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>timeData_train</span> <span class='op'>&lt;-</span> <span class='va'>pbc2_train</span><span class='op'>[</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"time"</span>, <span class='st'>"serBilir"</span>, <span class='st'>"SGOT"</span>, <span class='st'>"albumin"</span>, <span class='st'>"alkaline"</span><span class='op'>)</span></span>
<span><span class='op'>]</span></span>
<span><span class='va'>timeVarModel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  serBilir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>serBilir</span> <span class='op'>~</span> <span class='va'>time</span>, random <span class='op'>=</span> <span class='op'>~</span><span class='va'>time</span><span class='op'>)</span>,</span>
<span>  SGOT <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>SGOT</span> <span class='op'>~</span> <span class='va'>time</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>time</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  albumin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>albumin</span> <span class='op'>~</span> <span class='va'>time</span>, random <span class='op'>=</span> <span class='op'>~</span><span class='va'>time</span><span class='op'>)</span>,</span>
<span>  alkaline <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='va'>alkaline</span> <span class='op'>~</span> <span class='va'>time</span>, random <span class='op'>=</span> <span class='op'>~</span><span class='va'>time</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>fixedData_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2_train</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"age"</span>, <span class='st'>"drug"</span>, <span class='st'>"sex"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>With a categorical outcome, the definition of the output object is slightly different. We should specify <code>type</code>=“factor” to define the outcome as categorical, and the dataframe in <code>Y</code> should contain only 2 columns, the variable identifier <code>id</code> and the outcome <code>event</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  type <span class='op'>=</span> <span class='st'>"factor"</span>,</span>
<span>  Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2_train</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"event"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="5.2" id="the-random-forest-building"><span class="header-section-number">5.2</span> The random forest building</h3>
<p>We executed the <code>dynforest()</code> function to build the random forest with hyperparameters <code>mtry</code> = 7 and <code>nodesize</code> = 2 as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/dynforest.html'>dynforest</a></span><span class='op'>(</span></span>
<span>  timeData <span class='op'>=</span> <span class='va'>timeData_train</span>,</span>
<span>  fixedData <span class='op'>=</span> <span class='va'>fixedData_train</span>,</span>
<span>  timeVar <span class='op'>=</span> <span class='st'>"time"</span>, idVar <span class='op'>=</span> <span class='st'>"id"</span>,</span>
<span>  timeVarModel <span class='op'>=</span> <span class='va'>timeVarModel</span>,</span>
<span>  mtry <span class='op'>=</span> <span class='fl'>7</span>, nodesize <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  Y <span class='op'>=</span> <span class='va'>Y</span>, ncores <span class='op'>=</span> <span class='fl'>7</span>, seed <span class='op'>=</span> <span class='fl'>1234</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="5.3" id="out-of-bag-error-1"><span class="header-section-number">5.3</span> Out-Of-Bag error</h3>
<p>With a categorical outcome, the OOB prediction error is evaluated using a misclassification criterion. This criterion can be computed with the <code>compute_ooberror()</code> function and the results of the random forest can be displayed using <code>summary()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn_OOB</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/compute_ooberror.html'>compute_ooberror</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res_dyn_OOB</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>dynforest executed for categorical outcome 
    Splitting rule: Minimize weighted within-group Shannon entropy 
    Out-of-bag error type: Missclassification 
    Leaf statistic: Majority vote 
---------------- 
Input 
    Number of subjects: 150 
    Longitudinal: 4 predictor(s) 
    Numeric: 1 predictor(s) 
    Factor: 2 predictor(s) 
---------------- 
Tuning parameters 
    mtry: 7 
    nodesize: 2 
    ntree: 200 
---------------- 
---------------- 
dynforest summary 
    Average depth per tree: 5.89 
    Average number of leaves per tree: 16.81 
    Average number of subjects per leaf: 5.72 
---------------- 
Out-of-bag error based on Missclassification 
    Out-of-bag error: 0.2333 
---------------- 
Computation time 
    Number of cores used: 7 
    Time difference of 2.87888 mins
---------------- </code></pre>
</div>
<p>In this illustration, we built the random forest using 150 subjects because we only kept the subjects still at risk at the landmark time at 4 years and split the dataset in <span class="math inline">\(2/3\)</span> for training and <span class="math inline">\(1/3\)</span> for testing. We have on average 5.7 subjects per leaf, and the average depth level per tree is 5.9. This random forest predicted the wrong outcome for 23% of the subjects. The random forest performance can be optimized by choosing the <code>mtry</code> and <code>nodesize</code> hyperparameters that minimize the OOB misclassification.</p>
<h3 data-number="5.4" id="prediction-of-the-outcome"><span class="header-section-number">5.4</span> Prediction of the outcome</h3>
<p>We can predict the probability of death between 4 and 10 years for subjects still at risk at the landmark time at 4 years. In classification mode, the predictions are performed using the majority vote. The prediction over the trees is thus a category of the outcome along with the proportion of the trees that lead to this category. Predictions are computed using the <code>predict()</code> function, then a dataframe can be easily built from the returning object to get the prediction and probability of the outcome for each subject:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>timeData_pred</span> <span class='op'>&lt;-</span> <span class='va'>pbc2_pred</span><span class='op'>[</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"time"</span>, <span class='st'>"serBilir"</span>, <span class='st'>"SGOT"</span>, <span class='st'>"albumin"</span>, <span class='st'>"alkaline"</span><span class='op'>)</span></span>
<span><span class='op'>]</span></span>
<span><span class='va'>fixedData_pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>pbc2_pred</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='st'>"age"</span>, <span class='st'>"drug"</span>, <span class='st'>"sex"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>pred_dyn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span></span>
<span>  object <span class='op'>=</span> <span class='va'>res_dyn</span>,</span>
<span>  timeData <span class='op'>=</span> <span class='va'>timeData_pred</span>,</span>
<span>  fixedData <span class='op'>=</span> <span class='va'>fixedData_pred</span>,</span>
<span>  idVar <span class='op'>=</span> <span class='st'>"id"</span>, timeVar <span class='op'>=</span> <span class='st'>"time"</span>,</span>
<span>  t0 <span class='op'>=</span> <span class='fl'>4</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  pred <span class='op'>=</span> <span class='va'>pred_dyn</span><span class='op'>$</span><span class='va'>pred_indiv</span>,</span>
<span>  proba <span class='op'>=</span> <span class='va'>pred_dyn</span><span class='op'>$</span><span class='va'>pred_indiv_proba</span></span>
<span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>    pred proba
101    0 0.945
104    0 0.790
106    1 0.600
108    0 0.945
112    1 0.575
114    0 0.650</code></pre>
</div>
<p>As shown in this example, some predictions are made with varying confidence from 57.5% for subject 112 to 94.5% for subject 101. We predict, for instance, no event for subject 101 with a probability of 94.5% and an event for subject 106 with a probability of 60.0%.</p>
<h3 data-number="5.5" id="predictiveness-variables"><span class="header-section-number">5.5</span> Predictiveness variables</h3>
<h4 class="unnumbered" data-number="5.5.1" id="variable-importance-2">Variable importance</h4>
<p>The most predictive variables can be identified using the <code>compute_vimp()</code> function and displayed using the <code>plot()</code> function as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>res_dyn_VIMP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/compute_vimp.html'>compute_vimp</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn_OOB</span>, seed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res_dyn_VIMP</span>, PCT <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Again, we found that the most predictive variable is <code>serBilir</code>. When perturbing <code>serBilir</code>, the OOB prediction error was increased by 15%.</p>
<h4 class="unnumbered" data-number="5.5.2" id="minimal-depth-2">Minimal depth</h4>
<p>The minimal depth is computed using the <code>compute_vardepth()</code> function and is displayed at predictor and feature levels using the <code>plot()</code> function. The results are displayed in figure <a href="#fig:DynForestRfactormindepth">7</a> using the random forest with maximal <code>mtry</code> hyperparameter value (i.e., <code>mtry</code> = 7) for a better understanding.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>depth_dyn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DynForest/man/compute_vardepth.html'>compute_vardepth</a></span><span class='op'>(</span>dynforest_obj <span class='op'>=</span> <span class='va'>res_dyn_OOB</span><span class='op'>)</span></span>
<span><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>depth_dyn</span>, plot_level <span class='op'>=</span> <span class='st'>"predictor"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>depth_dyn</span>, plot_level <span class='op'>=</span> <span class='st'>"feature"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='va'>p2</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DynForestRfactormindepth"></span>
<img src="RJ-2025-002_files/figure-html5/DynForestRfactormindepth-1.png" alt="Average minimal depth by predictor (A) and feature (B)." width="80%" height="30%" />
<p class="caption">
Figure 7: Average minimal depth by predictor (A) and feature (B).
</p>
</div>
</div>
<p>We observe that <code>serBilir</code> and <code>albumin</code> have the lowest minimal depth and are used to split the subjects in almost all the trees (199 and 196 out of 200 trees, respectively) (figure <a href="#fig:DynForestRfactormindepth">7</a>A). Figure <a href="#fig:DynForestRfactormindepth">7</a>B provides further results. In particular, this graph shows that the random intercept (indicated by bi0) of <code>serBilir</code> and <code>albumin</code> are the earliest predictors used to split the subjects and are present in 192 and 191 out of 200 trees, respectively.</p>
<h2 data-number="6" id="discussion"><span class="header-section-number">6</span> Discussion</h2>
<p>The <a href="https://cran.r-project.org/package=DynForest">DynForest</a> R package provides an easy-to-use random forests methodology for predictors that may contain longitudinal variables possibly measured irregularly with error. Note that the method can also be used without any longitudinal predictors, as in other random forests packages.</p>
<p>We implemented several statistics to identify the predictive ability of each variable with the VIMP, gVIMP and average minimal depth. For the survival outcome, compared to the <a href="https://cran.r-project.org/package=randomForestSRC">randomForestSRC</a> R package, we considered two different stopping criteria <code>nodesize</code> and <code>minsplit</code> to favor the deepest forests possible and avoid suboptimal splits. We designed <a href="https://cran.r-project.org/package=DynForest">DynForest</a> to be as user-friendly as possible. To achieve that, we implemented various functions to summarize and display the results, and provided a step-by-step analysis in survival and categorical modes. As <a href="https://cran.r-project.org/package=DynForest">DynForest</a> involves mixed models to be updated within each tree building, the program can be numerically demanding despite efforts to speed up computations (parallel computing, history of previous estimations). A substantial computational burden is especially expected when the sample is very large and/or a very large set of time-dependent predictors is considered.</p>
<p>Several improvements could be considered in the future. We used linear mixed models for longitudinal continuous outcomes, but alternative strategies could be considered such as the PACE algorithm <span class="citation" data-cites="yao_functional_2005">(<a href="#ref-yao_functional_2005" role="doc-biblioref">Yao et al. 2005</a>)</span> based on functional data analysis. We could also consider different natures of longitudinal predictors (e.g., binary) for which generalized linear mixed models could be used. <a href="https://cran.r-project.org/package=DynForest">DynForest</a> currently handles continuous, categorical and survival (with possibly competing events) outcomes. But other outcomes could be envisaged such as curves, recurrent events or interval-censored time-to-events. We leave these perspectives for future releases.</p>
<h2 class="unnumbered" id="computational-details">Computational details</h2>
<p>The results in this paper were obtained using R 4.4.1 with the <a href="https://cran.r-project.org/package=DynForest">DynForest</a> 1.2.0 package on a virtualized Windows Server 2016 Remote Desktop Server with 48GB RAM. R itself and all packages used are available from the Comprehensive R Archive Network (CRAN) at <a href="https://CRAN.R-project.org/">https://CRAN.R-project.org/</a>.</p>
<h2 class="unnumbered" id="acknowledgments">Acknowledgments</h2>
<p>We thank Dr. Louis Capitaine for FrechForest R code used in <a href="https://cran.r-project.org/package=DynForest">DynForest</a>.</p>
<p>This work was funded by the French National Research Agency (ANR-18-CE36-0004-01 for project DyMES), and the French government in the framework of the PIA3 (“Investment for the future”) (project reference 17-EURE-0019) and in the framework of the University of Bordeaux’s IdEx “Investments for the Future” program / RRI PHDS.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="6.1" id="supplementary-materials"><span class="header-section-number">6.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-002.zip">RJ-2025-002.zip</a></p>
<h3 class="appendix" data-number="6.2" id="cran-packages-used"><span class="header-section-number">6.2</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=randomForestSRC">randomForestSRC</a>, <a href="https://cran.r-project.org/package=ranger">ranger</a>, <a href="https://cran.r-project.org/package=xgboost">xgboost</a>, <a href="https://cran.r-project.org/package=DynForest">DynForest</a>, <a href="https://cran.r-project.org/package=lcmm">lcmm</a>, <a href="https://cran.r-project.org/package=survival">survival</a>, <a href="https://cran.r-project.org/package=cmprsk">cmprsk</a></p>
<h3 class="appendix" data-number="6.3" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">6.3</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=ClinicalTrials">ClinicalTrials</a>, <a href="https://cran.r-project.org/view=Cluster">Cluster</a>, <a href="https://cran.r-project.org/view=Econometrics">Econometrics</a>, <a href="https://cran.r-project.org/view=Epidemiology">Epidemiology</a>, <a href="https://cran.r-project.org/view=HighPerformanceComputing">HighPerformanceComputing</a>, <a href="https://cran.r-project.org/view=MachineLearning">MachineLearning</a>, <a href="https://cran.r-project.org/view=ModelDeployment">ModelDeployment</a>, <a href="https://cran.r-project.org/view=Survival">Survival</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-aalen_nonparametric_1976" class="csl-entry" role="listitem">
O. Aalen. Nonparametric inference in connection with multiple decrement models. <em>Scandinavian Journal of Statistics</em>, 3(1): 15–27, 1976. URL <a href="https://www.jstor.org/stable/4615603">https://www.jstor.org/stable/4615603</a>.
</div>
<div id="ref-aalen_empirical_1978" class="csl-entry" role="listitem">
O. O. Aalen and S. Johansen. An empirical transition matrix for non-homogeneous markov chains based on censored observations. <em>Scandinavian Journal of Statistics</em>, 5(3): 141–150, 1978. URL <a href="https://www.jstor.org/stable/4615704">https://www.jstor.org/stable/4615704</a>.
</div>
<div id="ref-bernard_influence_2009" class="csl-entry" role="listitem">
S. Bernard, L. Heutte and S. Adam. Influence of hyperparameters on random forest accuracy. In <em>International workshop on multiple classifier systems</em>, pages. 171–180 2009. Springer. DOI <a href="https://doi.org/10.1007/978-3-642-02326-2_18">10.1007/978-3-642-02326-2_18</a>.
</div>
<div id="ref-breiman_random_2001" class="csl-entry" role="listitem">
L. Breiman. Random forests. <em>Machine Learning</em>, 45(1): 5–32, 2001. DOI <a href="https://doi.org/10.1023/A:1010933404324">10.1023/A:1010933404324</a>.
</div>
<div id="ref-chen_xgboost_2016" class="csl-entry" role="listitem">
T. Chen and C. Guestrin. <span>XGBoost</span>: A scalable tree boosting system. In <em>Proceedings of the 22nd <span>ACM</span> <span>SIGKDD</span> international conference on knowledge discovery and data mining</em>, pages. 785–794 2016. DOI <a href="https://doi.org/10.1145/2939672.2939785">10.1145/2939672.2939785</a>.
</div>
<div id="ref-devaux_dynforest_2024" class="csl-entry" role="listitem">
A. Devaux. <em><span>DynForest</span>: Random forest with multivariate longitudinal predictors.</em> 2024. URL <a href="https://CRAN.R-project.org/package=DynForest">https://CRAN.R-project.org/package=DynForest</a>. <span>R</span> package version: 1.1.3.
</div>
<div id="ref-devaux_random_2023" class="csl-entry" role="listitem">
A. Devaux, C. Helmer, R. Genuer and C. Proust-Lima. Random survival forests with multivariate longitudinal endogenous covariates. <em>Statistical Methods in Medical Research</em>, 32(12): 2331–2346, 2023. DOI <a href="https://doi.org/10.1177/09622802231206477">10.1177/09622802231206477</a>.
</div>
<div id="ref-gerds_consistent_2006" class="csl-entry" role="listitem">
T. A. Gerds and M. Schumacher. Consistent estimation of the expected brier score in general survival models with right-censored event times. <em>Biometrical Journal</em>, 48(6): 1029–1040, 2006. DOI <a href="https://doi.org/10.1002/bimj.200610301">10.1002/bimj.200610301</a>.
</div>
<div id="ref-gray_cmprsk_2020" class="csl-entry" role="listitem">
B. Gray. <em><span class="nocase">cmprsk</span>: Subdistribution analysis of competing risks.</em> 2020. URL <a href="https://CRAN.R-project.org/package=cmprsk">https://CRAN.R-project.org/package=cmprsk</a>. <span>R</span> package version 2.2-10.
</div>
<div id="ref-gray_class_1988" class="csl-entry" role="listitem">
R. J. Gray. A class of $k$-sample tests for comparing the cumulative incidence of a competing risk. <em>The Annals of Statistics</em>, 16(3): 1141–1154, 1988. URL <a href="https://www.jstor.org/stable/2241622">https://www.jstor.org/stable/2241622</a>.
</div>
<div id="ref-gregorutti_correlation_2017" class="csl-entry" role="listitem">
B. Gregorutti, B. Michel and P. Saint-Pierre. Correlation and variable importance in random forests. <em>Statistics and Computing</em>, 27(3): 659–678, 2017. DOI <a href="https://doi.org/10.1007/s11222-016-9646-1">10.1007/s11222-016-9646-1</a>.
</div>
<div id="ref-ishwaran_random_2014" class="csl-entry" role="listitem">
H. Ishwaran, T. A. Gerds, U. B. Kogalur, R. D. Moore, S. J. Gange and B. M. Lau. Random survival forests for competing risks. <em>Biostatistics</em>, 15(4): 757–773, 2014. DOI <a href="https://doi.org/10.1093/biostatistics/kxu010">10.1093/biostatistics/kxu010</a>.
</div>
<div id="ref-ishwaran_random_2008" class="csl-entry" role="listitem">
H. Ishwaran, U. B. Kogalur, E. H. Blackstone and M. S. Lauer. Random survival forests. <em>The Annals of Applied Statistics</em>, 2(3): 841–860, 2008. DOI <a href="https://doi.org/10.1214/08-AOAS169">10.1214/08-AOAS169</a>.
</div>
<div id="ref-laird_random_effects_1982" class="csl-entry" role="listitem">
N. M. Laird and J. H. Ware. Random-effects models for longitudinal data. <em>Biometrics</em>, 38(4): 963–974, 1982. DOI <a href="https://doi.org/10.2307/2529876">10.2307/2529876</a>.
</div>
<div id="ref-murtaugh_primary_1994" class="csl-entry" role="listitem">
P. A. Murtaugh, E. R. Dickson, G. M. Van Dam, M. Malinchoc, P. M. Grambsch, A. L. Langworthy and C. H. Gips. Primary biliary cirrhosis: Prediction of short-term survival based on repeated patient visits. <em>Hepatology</em>, 20(1): 126–134, 1994. DOI <a href="https://doi.org/10.1002/hep.1840200120">10.1002/hep.1840200120</a>.
</div>
<div id="ref-nelson_hazard_1969" class="csl-entry" role="listitem">
W. Nelson. Hazard plotting for incomplete failure data. <em>Journal of Quality Technology</em>, 1(1): 27–52, 1969. DOI <a href="https://doi.org/10.1080/00224065.1969.11980344">10.1080/00224065.1969.11980344</a>.
</div>
<div id="ref-peto_asymptotically_1972" class="csl-entry" role="listitem">
R. Peto and J. Peto. Asymptotically efficient rank invariant test procedures. <em>Journal of the Royal Statistical Society: Series A (General)</em>, 135(2): 185–198, 1972. DOI <a href="https://doi.org/10.2307/2344317">10.2307/2344317</a>.
</div>
<div id="ref-proust_lima_estimation_2017" class="csl-entry" role="listitem">
C. Proust-Lima, V. Philipps and B. Liquet. Estimation of extended mixed models using latent classes and latent processes: The <span>R</span> package <span class="nocase">lcmm</span>. <em>Journal of Statistical Software</em>, 78(2): 1–56, 2017. DOI <a href="https://doi.org/10.18637/jss.v078.i02">10.18637/jss.v078.i02</a>.
</div>
<div id="ref-R_2019" class="csl-entry" role="listitem">
R Core Team. <em><span>R</span>: A language and environment for statistical computing.</em> Vienna, Austria: R Foundation for Statistical Computing, 2019. URL <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-sene_individualized_2016" class="csl-entry" role="listitem">
M. Sène, J. M. G. Taylor, J. J. Dignam, H. Jacqmin-Gadda and C. Proust-Lima. Individualized dynamic prediction of prostate cancer recurrence with and without the initiation of a second treatment: Development and validation. <em>Statistical Methods in Medical Research</em>, 25(6): 2972–2991, 2016. DOI <a href="https://doi.org/10.1177/0962280214535763">10.1177/0962280214535763</a>.
</div>
<div id="ref-shannon_mathematical_1948" class="csl-entry" role="listitem">
C. E. Shannon. A mathematical theory of communication. <em>The Bell System Technical Journal</em>, 27(3): 379–423, 1948. DOI <a href="https://doi.org/10.1002/j.1538-7305.1948.tb01338.x">10.1002/j.1538-7305.1948.tb01338.x</a>.
</div>
<div id="ref-therneau_2022_survival" class="csl-entry" role="listitem">
T. M. Therneau. <em>A package for survival analysis in <span>R</span>.</em> 2022. URL <a href="https://CRAN.R-project.org/package=survival">https://CRAN.R-project.org/package=survival</a>. <span>R</span> package version 3.4-0.
</div>
<div id="ref-wright_ranger_2017" class="csl-entry" role="listitem">
M. N. Wright and A. Ziegler. <span class="nocase">ranger</span>: A fast implementation of random forests for high dimensional data in <span>C++</span> and <span>R</span>. <em>Journal of Statistical Software</em>, 77(1): 2017. DOI <a href="https://doi.org/10.18637/jss.v077.i01">10.18637/jss.v077.i01</a>.
</div>
<div id="ref-yao_functional_2005" class="csl-entry" role="listitem">
F. Yao, H.-G. Müller and J.-L. Wang. Functional data analysis for sparse longitudinal data. <em>Journal of the American Statistical Association</em>, 100(470): 577–590, 2005. DOI <a href="https://doi.org/10.1198/016214504000001745">10.1198/016214504000001745</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Devaux, et al., "Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package", The R Journal, 2025</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2025-002,
  author = {Devaux, Anthony and Proust-Lima, Cécile and Genuer, Robin},
  title = {Random Forests for Time-Fixed and Time-Dependent Predictors: The DynForest R Package},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2025-002},
  doi = {10.32614/RJ-2025-002},
  volume = {17},
  issue = {1},
  issn = {2073-4859},
  pages = {24-46}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
