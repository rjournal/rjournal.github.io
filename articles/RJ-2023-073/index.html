<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>mathml: Translate R Expressions to MathML and LaTeX</title>

<meta property="description" itemprop="description" content="This R package translates R objects to suitable elements in MathML or LaTeX, thereby allowing for a pretty mathematical representation of R objects and functions in data analyses, scientific reports and interactive web content. In the R Markdown document rendering language, R code and mathematical content already exist side-by-side. The present package enables use of the same R objects for both data analysis and typesetting in documents or web content. This tightens the link between the statistical analysis and its verbal description or symbolic representation, which is another step towards reproducible science. User-defined hooks enable extension of the package by mapping specific variables or functions to new MathML and LaTeX entities. Throughout the paper, examples are given for the functions of the package, and a case study illustrates its use in a scientific report."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-073/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-12-18"/>
<meta property="article:created" itemprop="dateCreated" content="2023-12-18"/>
<meta name="article:author" content="Matthias Gondan"/>
<meta name="article:author" content="Irene Alfarone"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="mathml: Translate R Expressions to MathML and LaTeX"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This R package translates R objects to suitable elements in MathML or LaTeX, thereby allowing for a pretty mathematical representation of R objects and functions in data analyses, scientific reports and interactive web content. In the R Markdown document rendering language, R code and mathematical content already exist side-by-side. The present package enables use of the same R objects for both data analysis and typesetting in documents or web content. This tightens the link between the statistical analysis and its verbal description or symbolic representation, which is another step towards reproducible science. User-defined hooks enable extension of the package by mapping specific variables or functions to new MathML and LaTeX entities. Throughout the paper, examples are given for the functions of the package, and a case study illustrates its use in a scientific report."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-073/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="mathml: Translate R Expressions to MathML and LaTeX"/>
<meta property="twitter:description" content="This R package translates R objects to suitable elements in MathML or LaTeX, thereby allowing for a pretty mathematical representation of R objects and functions in data analyses, scientific reports and interactive web content. In the R Markdown document rendering language, R code and mathematical content already exist side-by-side. The present package enables use of the same R objects for both data analysis and typesetting in documents or web content. This tightens the link between the statistical analysis and its verbal description or symbolic representation, which is another step towards reproducible science. User-defined hooks enable extension of the package by mapping specific variables or functions to new MathML and LaTeX entities. Throughout the paper, examples are given for the functions of the package, and a case study illustrates its use in a scientific report."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-073/"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="mathml: Translate R Expressions to MathML and LaTeX"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-073"/>
<meta name="citation_pdf_url" content="RJ-2023-073.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="3"/>
<meta name="citation_doi" content="10.32614/RJ-2023-073"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="277"/>
<meta name="citation_lastpage" content="291"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/12/18"/>
<meta name="citation_publication_date" content="2023/12/18"/>
<meta name="citation_author" content="Matthias Gondan"/>
<meta name="citation_author_institution" content="Universität Innsbruck"/>
<meta name="citation_author" content="Irene Alfarone"/>
<meta name="citation_author_institution" content="Universität Innsbruck"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Pandoc: A universal document converter;citation_author=J. MacFarlane"/>
  <meta name="citation_reference" content="citation_title=Equatiomatic: Transform models into ’LaTeX’ equations;citation_author=D. Anderson;citation_author=A. Heiss;citation_author=J. Sumners"/>
  <meta name="citation_reference" content="citation_title=latex2r: Translate latex formulas to R code;citation_author=T. Capretto"/>
  <meta name="citation_reference" content="citation_title=pracma: Practical numerical math functions;citation_author=H. W. Borchers"/>
  <meta name="citation_reference" content="citation_title=SWI-Prolog;citation_volume=12;citation_issn=1471-0684;citation_author=J. Wielemaker;citation_author=T. Schrijvers;citation_author=M. Triska;citation_author=T. Lager"/>
  <meta name="citation_reference" content="citation_title=Breqn: Automatic line breaking of displayed equations;citation_author=W. Robertson;citation_author=J. Wright;citation_author=F. Mittelbach;citation_author=U. Fischer"/>
  <meta name="citation_reference" content="citation_title=mathjaxr: Using ’mathjax’ in rd files;citation_author=W. Viechtbauer"/>
  <meta name="citation_reference" content="citation_title=Shiny: Web application framework for R;citation_author=W. Chang;citation_author=J. Cheng;citation_author=J. J. Allaire;citation_author=C. Sievert;citation_author=B. Schloerke;citation_author=Y. Xie;citation_author=J. Allen;citation_author=J. McPherson;citation_author=A. Dipert;citation_author=B. Borges"/>
  <meta name="citation_reference" content="citation_title=rolog: Query SWI-Prolog from R;citation_author=M. Gondan"/>
  <meta name="citation_reference" content="citation_title=Conditional program statements and their comprehensibility to professional programmers;citation_volume=50;citation_author=T. R. G. Green"/>
  <meta name="citation_reference" content="citation_title=An approach to providing mathematical annotation in plots;citation_volume=9;citation_author=P. Murrell;citation_author=R. Ihaka"/>
  <meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;citation_publisher=R Foundation for Statistical Computing;citation_author=R: A language and environment for statistical computing"/>
  <meta name="citation_reference" content="citation_title=Diffusion decision model: Current issues and history;citation_volume=20;citation_author=R. Ratcliff;citation_author=P. L. Smith;citation_author=S. D. Brown;citation_author=G. McKoon"/>
  <meta name="citation_reference" content="citation_title=Enhancements to HTML Documentation;citation_author=D. Sarkar;citation_author=K. Hornik"/>
  <meta name="citation_reference" content="citation_title=Diffusion, superposition, and the redundant-targets effect;citation_volume=38;citation_author=W. Schwarz"/>
  <meta name="citation_reference" content="citation_title=Advanced R;citation_publisher=Chapman; Hall/CRC;citation_author=H. Wickham"/>
  <meta name="citation_reference" content="citation_title=knitr: A general-purpose package for dynamic report generation in R;citation_author=Y. Xie"/>
  <meta name="citation_reference" content="citation_title=R markdown: The definitive guide;citation_publisher=Chapman; Hall/CRC;citation_author=Y. Xie;citation_author=J. J. Allaire;citation_author=G. Grolemund"/>
  <meta name="citation_reference" content="citation_title=Rmarkdown: Dynamic documents for R;citation_author=J. J. Allaire;citation_author=Y. Xie;citation_author=C. Dervieux;citation_author=J. McPherson;citation_author=J. Luraschi;citation_author=K. Ushey;citation_author=A. Atkins;citation_author=H. Wickham;citation_author=J. Cheng;citation_author=W. Chang;citation_author=R. Iannone"/>
  <meta name="citation_reference" content="citation_title=R markdown cookbook;citation_publisher=Chapman; Hall/CRC;citation_author=Y. Xie;citation_author=C. Dervieux;citation_author=E. Riederer"/>
  <meta name="citation_reference" content="citation_title=rswipl: Embed SWI-Prolog;citation_author=M. Gondan"/>
  <meta name="citation_reference" content="citation_title=Timecourse of coactivation in bimodal divided attention;citation_volume=40;citation_author=J. O. Miller"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","subid","slug","packages","draft","preamble","preview","bibliography","CTV","output","pdf_url","citation_url","doi","creative_commons","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["mathml: Translate R Expressions to MathML and LaTeX"]},{"type":"character","attributes":{},"value":["This R package translates R objects to suitable elements in MathML or LaTeX, thereby allowing for a pretty mathematical representation of R objects and functions in data analyses, scientific reports and interactive web content. In the R Markdown document rendering language, R code and mathematical content already exist side-by-side. The present package enables use of the same R objects for both data analysis and typesetting in documents or web content. This tightens the link between the statistical analysis and its verbal description or symbolic representation, which is another step towards reproducible science. User-defined hooks enable extension of the package by mapping specific variables or functions to new MathML and LaTeX entities. Throughout the paper, examples are given for the functions of the package, and a case study illustrates its use in a scientific report."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Matthias Gondan"]},{"type":"character","attributes":{},"value":["Universität Innsbruck"]},{"type":"character","attributes":{},"value":["Department of Psychology","Innsbruck, Austria","<https://www.uibk.ac.at/psychologie/mitarbeiter/gondan-rochon/index.html.en>"]},{"type":"character","attributes":{},"value":["0000-0001-9974-0057"]},{"type":"character","attributes":{},"value":["Matthias.Gondan-Rochon@uibk.ac.at"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Irene Alfarone"]},{"type":"character","attributes":{},"value":["Universität Innsbruck"]},{"type":"character","attributes":{},"value":["Department of Psychology","Innsbruck, Austria","<https://www.uibk.ac.at/psychologie/mitarbeiter/alfarone/index.html.en>"]},{"type":"character","attributes":{},"value":["0000-0002-8409-8900"]},{"type":"character","attributes":{},"value":["Irene.Alfarone@uibk.ac.at"]}]}]},{"type":"character","attributes":{},"value":["2023-12-18"]},{"type":"character","attributes":{},"value":["2023-05-06"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[277]},{"type":"integer","attributes":{},"value":[291]}]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[3]},{"type":"character","attributes":{},"value":["2023-47"]},{"type":"character","attributes":{},"value":["RJ-2023-073"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"NULL"},{"type":"NULL"}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["\\usepackage{cancel}\n\\usepackage{amsmath}\n"]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["bibliography.bib"]},{"type":"list","attributes":{},"value":[]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","legacy_pdf"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["RJ-2023-073.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-073"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-073"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-073/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bibliography.bib","mathml.pdf","mathml.tex","preamble.tex","RJ-2023-073_files/anchor-4.2.2/anchor.min.js","RJ-2023-073_files/bowser-1.9.3/bowser.min.js","RJ-2023-073_files/distill-2.2.21/template.v2.js","RJ-2023-073_files/header-attrs-2.25/header-attrs.js","RJ-2023-073_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2023-073_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2023-073_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2023-073_files/popper-2.6.0/popper.min.js","RJ-2023-073_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2023-073_files/tippy-6.2.7/tippy-light-border.css","RJ-2023-073_files/tippy-6.2.7/tippy.css","RJ-2023-073_files/tippy-6.2.7/tippy.umd.min.js","RJ-2023-073_files/webcomponents-2.0.0/webcomponents.js","RJ-2023-073-meta-after.json","RJ-2023-073-meta-before.json","RJ-2023-073.log","RJ-2023-073.pdf","RJ-2023-073.tex","RJ-2023-073.zip","RJournal.sty","RJwrapper.aux","RJwrapper.bbl","RJwrapper.blg","RJwrapper.brf","RJwrapper.fdb_latexmk","RJwrapper.fls","RJwrapper.log","RJwrapper.out","RJwrapper.tex","Rlogo-5.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").first();
      if (tpar && ! tpar.hasClass("subtitle")) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"mathml: Translate R Expressions to MathML and LaTeX","description":"This R package translates R objects to suitable elements in MathML or LaTeX, thereby allowing for a pretty mathematical representation of R objects and functions in data analyses, scientific reports and interactive web content. In the R Markdown document rendering language, R code and mathematical content already exist side-by-side. The present package enables use of the same R objects for both data analysis and typesetting in documents or web content. This tightens the link between the statistical analysis and its verbal description or symbolic representation, which is another step towards reproducible science. User-defined hooks enable extension of the package by mapping specific variables or functions to new MathML and LaTeX entities. Throughout the paper, examples are given for the functions of the package, and a case study illustrates its use in a scientific report.","doi":"10.32614/RJ-2023-073","authors":[{"author":"Matthias Gondan","authorURL":"#","affiliation":"Universität Innsbruck","affiliationURL":"#","orcidID":"0000-0001-9974-0057"},{"author":"Irene Alfarone","authorURL":"#","affiliation":"Universität Innsbruck","affiliationURL":"#","orcidID":"0000-0002-8409-8900"}],"publishedDate":"2023-12-18T00:00:00.000+00:00","citationText":"Gondan & Alfarone, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../issues/2024-1">Current</a>
<a href="../../submissions.html">Submit</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>mathml: Translate R Expressions to MathML and LaTeX</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>This R package translates R objects to suitable elements in MathML or LaTeX, thereby allowing for a pretty mathematical representation of R objects and functions in data analyses, scientific reports and interactive web content. In the R Markdown document rendering language, R code and mathematical content already exist side-by-side. The present package enables use of the same R objects for both data analysis and typesetting in documents or web content. This tightens the link between the statistical analysis and its verbal description or symbolic representation, which is another step towards reproducible science. User-defined hooks enable extension of the package by mapping specific variables or functions to new MathML and LaTeX entities. Throughout the paper, examples are given for the functions of the package, and a case study illustrates its use in a scientific report.</p>
</div>

<div class="d-byline">
  Matthias Gondan  (Universität Innsbruck)
  
,   Irene Alfarone  (Universität Innsbruck)
  
<br/>2023-12-18
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">
<p><span class="math inline">\(\require{cancel}\)</span></p>
</div>
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>The R extension of the markdown language <span class="citation" data-cites="Xie2018 rmarkdown">(<a href="#ref-Xie2018" role="doc-biblioref">Xie et al. 2018</a>; <a href="#ref-rmarkdown" role="doc-biblioref">Allaire et al. 2023</a>)</span>
enables reproducible statistical reports with
nice typesetting in HTML, Microsoft Word, and LaTeX. Moreover, since
recently <span class="citation" data-cites="R">(<a href="#ref-R" role="doc-biblioref">R Core Team 2022</a>, version 4.2)</span>, Rs manual pages include
support for mathematical expressions <span class="citation" data-cites="Sarkar2022 Viechtbauer2022">(<a href="#ref-Sarkar2022" role="doc-biblioref">Sarkar and Hornik 2022</a>; <a href="#ref-Viechtbauer2022" role="doc-biblioref">Viechtbauer 2022</a>)</span>,
which is already a big improvement. However, except
for special cases such as regression models <span class="citation" data-cites="equatiomatic">(<a href="#ref-equatiomatic" role="doc-biblioref">Anderson et al. 2023</a>)</span>
and R’s own plotmath annotation, rules for the mapping of
built-in language elements to their mathematical representation are
still lacking. So far, R expressions such as <code>pbinom(k, N, p)</code> are
printed as they are and pretty mathematical formulae such as
<span class="math inline">\(P_{\mathrm{Bi}}(X \le k; N, p)\)</span> require explicit LaTeX commands like
<code>P_{\mathrm{Bi}}\left(X \le k; N, p\right)</code>. Except for very basic use
cases, these commands are tedious to type and their source code is hard
to read.</p>
<p>The present R package defines a set of rules for the automatic
translation of R expressions to mathematical output in R Markdown
documents <span class="citation" data-cites="Xie2020">(<a href="#ref-Xie2020" role="doc-biblioref">Xie et al. 2020</a>)</span> and Shiny Apps <span class="citation" data-cites="Chang2022">(<a href="#ref-Chang2022" role="doc-biblioref">Chang et al. 2022</a>)</span>.
The translation is done by an embedded Prolog interpreter
that maps nested expressions recursively to MathML and LaTeX/MathJax,
respectively. User-defined hooks enable extension of the set of rules,
for example, to represent specific R elements by custom mathematical
signs.</p>
<p>The main feature of the package is that the same R expressions and
equations can be used for both mathematical typesetting and
calculations. This saves time and potentially reduces mistakes, as will
be illustrated below. Readers should have basic knowledge of knitr and
R Markdown to be able to follow this article <span class="citation" data-cites="knitr rmarkdown">(<a href="#ref-rmarkdown" role="doc-biblioref">Allaire et al. 2023</a>; <a href="#ref-knitr" role="doc-biblioref">Xie 2023</a>)</span>,
while to extend and customize the package, some basic knowledge
of Prolog is needed.</p>
<p>The paper is organized as follows. We start with a description of the
technical background of the package, including the two main classes of
rules for translating R objects to mathematical expressions. The next
section illustrates the main features of the
<a href="https://CRAN.R-project.org/package=mathml">mathml</a> package, potential
issues and their workarounds using examples from the day-to-day
perspective of a user. A case study follows with a scientific report
written with the help of the package. The last section concludes with a
discussion and ideas for further development.</p>
<h2 data-number="2" id="background"><span class="header-section-number">2</span> Background</h2>
<p>Similar to other high-level programming languages, R is homoiconic, that
is, R commands (i.e., R “calls”) are, themselves, symbolic data
structures that can be created, parsed and modified. Because the default
response of the R interpreter is to evaluate a call and return its
result, this property is not transparent to the general user. There
exists, however, a number of built-in R functions (e.g., <code>quote()</code>,
<code>call()</code> etc.) that allow the user to create R calls which can be stored
in regular variables and then, for example, evaluated at a later stage
or in a specific environment <span class="citation" data-cites="Wickham2019">(<a href="#ref-Wickham2019" role="doc-biblioref">Wickham 2019</a>)</span>. The present package
includes a set of rules that translate such calls to a mathematical
representation in MathML and LaTeX. For a first illustration of the
mathml package, we consider the binomial probability.</p>
<pre><code>term &lt;- quote(pbinom(k, N, p))</code></pre>
<p>The term is quoted to avoid its immediate evaluation (which would raise
an error anyway since the variables <code>k</code>, <code>N</code>, <code>p</code> have not yet been
defined). Experienced R users will recognize that the expression is a
short form for</p>
<pre><code>term &lt;- call(&quot;pbinom&quot;, as.name(&quot;k&quot;), as.name(&quot;N&quot;), as.name(&quot;p&quot;))
term

#&gt; pbinom(k, N, p)</code></pre>
<p>As can be seen from the output, to the variable <code>term</code> is not assigned
the result of the calculation, but instead an R call <span class="citation" data-cites="Wickham2019">(see, e.g., <a href="#ref-Wickham2019" role="doc-biblioref">Wickham 2019</a>,
for details on “non-standard evaluation”)</span>, which can eventually be
evaluated with <code>eval()</code>,</p>
<pre><code>k &lt;- 10
N &lt;- 22
p &lt;- 0.4
eval(term)

#&gt; [1] 0.77195</code></pre>
<p>The R package mathml can now be used to render the call in MathML or in
MathJax/LaTeX. MathML is the dialect for mathematical elements on HTML
webpages, whereas LaTeX is typically used for typesetting printed
documents, as shown below.</p>
<pre><code>library(mathml)
substr(mathml(term), 1, 70)

#&gt; [1] &quot;&lt;math&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mtext&gt;Bi&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;&amp;af;&lt;/mo&gt;&lt;mrow&quot;

mathjax(term)

#&gt; [1] &quot;${P}_{\\mathrm{Bi}}{\\left({{X}{\\le}{k}}{{;}{{N}{{,}{p}}}}\\right)}$&quot;</code></pre>
<p>Some of the curly braces are not really needed in the LaTeX output, but
are necessary in edge cases. The package also includes a function
<code>mathout()</code> that wraps a call to <code>mathml()</code> for HTML output and
<code>mathjax()</code> for LaTeX output. Moreover, the function <code>math(x)</code> adds the
class <code>"math"</code> to its argument, such that a special knitr printing
function is invoked <span class="citation" data-cites="knitr">(see the vignette on custom print methods in <a href="#ref-knitr" role="doc-biblioref">Xie 2023</a>)</span>.
An R Markdown code chunk with <code>mathout(term)</code> thus produces:</p>
<p><span class="math inline">\({P}_{\mathrm{Bi}}{\left({{X}{\le}{k}}{{;}{{N}{{,}{p}}}}\right)}\)</span></p>
<p>Similarly, <code>inline()</code> produces inline output, <code>r inline(term)</code> yields
<span class="math inline">\({P}_{\mathrm{Bi}}{\left({{X}{\le}{k}}{{;}{{N}{{,}{p}}}}\right)}\)</span>.</p>
<h2 data-number="3" id="package-in-practice"><span class="header-section-number">3</span> Package mathml in practice</h2>
<p>The currently supported R objects are listed below, roughly following
the order proposed by Murrell and Ihaka <span class="citation" data-cites="murrell2000">(<a href="#ref-murrell2000" role="doc-biblioref">2000</a>)</span>.</p>
<h3 data-number="3.1" id="basic-elements"><span class="header-section-number">3.1</span> Basic elements</h3>
<p>mathml handles the basic elements of everyday mathematical expressions,
such as integers, floating-point numbers, Latin and Greek letters,
multi-letter identifiers, accents, subscripts, and superscripts.</p>
<pre><code>term &lt;- quote(1 + -2L + a + abc + &quot;a&quot; + phi + Phi + varphi + roof(b)[i, j]^2L)
math(term)</code></pre>
<p><span class="math inline">\({{{{{{{{1.00}{+}{{-}{2}}}{+}{a}}{+}{abc}}{+}{\mathrm{a}}}{+}{\phi}}{+}{\Phi}}{+}{\varphi}}{+}{{\hat{b}}_{{i}{{\mathrm{}}{j}}}^{2}}\)</span></p>
<pre><code>term &lt;- quote(round(3.1415, 3L) + NaN + NA + TRUE + FALSE + Inf + (-Inf))
math(term)</code></pre>
<p><span class="math inline">\({{{{{{3.142}{+}{nan}}{+}{na}}{+}{T}}{+}{F}}{+}{\infty}}{+}{\left({-}{\infty}\right)}\)</span></p>
<p>An expression such as <code>1 + -2</code> may be considered aesthetically
unsatisfactory. It is correct R syntax, though, and is reproduced
accordingly, without the parentheses. Parentheses around negative
numbers or symbols can be added as shown above for <code>+ (-Inf)</code>.</p>
<p>To avoid name clashes with package <code>stats</code>, <code>roof()</code> is used to put a
hat on a symbol (see next section for further decorations). Note that an
R function <code>roof()</code> does not exist in base R, it is provided by the
package for convenience and points to the identity function.</p>
<h3 data-number="3.2" id="decorations"><span class="header-section-number">3.2</span> Decorations</h3>
<p>The package offers some support for different fonts as well as accents
and boxes etc. Internally, these decorations are implemented as identity
functions, so that they can be introduced into R expressions without
side-effects.</p>
<pre><code>term &lt;- quote(bold(b[x, 5L]) + bold(b[italic(x)]) + italic(ab) + italic(42L))
math(term)</code></pre>
<p><span class="math inline">\({{{{\mathbf{b}}_{{\mathbf{x}}{{\mathrm{}}{5}}}}{+}{{\mathbf{b}}_{\mathit{x}}}}{+}{\mathit{ab}}}{+}{42}\)</span></p>
<pre><code>term &lt;- quote(tilde(a) + mean(X) + box(c) + cancel(d) + phantom(e) + prime(f))
math(term)</code></pre>
<p><span class="math inline">\({{{{{\tilde{a}}{+}{\overline{X}}}{+}{\boxed{c}}}{+}{\cancel{d}}}{+}{\phantom{e}}}{+}{{f^\prime}}\)</span></p>
<p>Note that the font styles only affect the display of identifiers,
whereas numbers, character strings etc. are left untouched.</p>
<h3 data-number="3.3" id="operators-and-parentheses"><span class="header-section-number">3.3</span> Operators and parentheses</h3>
<p>Arithmetic operators and parentheses are translated as they are, as
illustrated below.</p>
<pre><code>term &lt;- quote(a - ((b + c)) - d*e + f*(g + h) + i/j + k^(l + m) + (n*o)^{p + q})
math(term)</code></pre>
<p><span class="math inline">\({{{{{{a}{-}{\left[\left({b}{+}{c}\right)\right]}}{-}{{d}{{}}{e}}}{+}{{f}{\cdot}{\left({g}{+}{h}\right)}}}{+}{{i}{/}{j}}}{+}{{k}^{\left({l}{+}{m}\right)}}}{+}{{\left({n}{{}}{o}\right)}^{{p}{+}{q}}}\)</span></p>
<pre><code>term &lt;- quote(dot(a, b) + frac(1L, nodot(c, d + e)) + dfrac(1L, times(g, h)))
math(term)</code></pre>
<p><span class="math inline">\({{{a}{\cdot}{b}}{+}{\frac{1}{{c}{{}}{\left({d}{+}{e}\right)}}}}{+}{\displaystyle{\frac{1}{{g}{\times}{h}}}}\)</span></p>
<p>For multiplications involving only numbers and symbols, the
multiplication sign is omitted. This heuristic does not always produce
the desired result; therefore, mathml defines alternative R functions
<code>dot()</code>, <code>nodot()</code>, and <code>times()</code>. These functions calculate a product
and produce the respective multiplication signs. Similarly, <code>frac()</code> and
<code>dfrac()</code> can be used for small and large fractions.</p>
<p>For standard operators with known precedence, mathml is generally able
to detect if parentheses are needed; for example, parentheses are
automatically placed around <code>d + e</code> in the <code>nodot</code>-example. However, we
note unnecessary parentheses around <code>l + m</code> above. These parentheses are
a consequence of <code>quote(a^(b + c))</code> actually producing a nested R call
of the form <code>^(a, (b + c))</code> instead of <code>^(a, b + c)</code>:</p>
<pre><code>term &lt;- quote(a^(b + c))
paste(term)

#&gt; [1] &quot;^&quot;       &quot;a&quot;       &quot;(b + c)&quot;</code></pre>
<p>For the present purpose, this R feature is unfortunate because the extra
parentheses around <code>b + c</code> are not needed. The preferred result is
obtained by the functional form <code>quote(^(k, l + m))</code> of the power, or
curly braces as a workaround (see <code>p + q</code> above).</p>
<h3 data-number="3.4" id="custom-operators"><span class="header-section-number">3.4</span> Custom operators</h3>
<p>Whereas in standard infix operators, the parentheses typically follow
the rules for precedence, undesirable results may be obtained in custom
operators.</p>
<pre><code>term &lt;- quote(mean(X) %+-% 1.96 * s / sqrt(N))
math(term)</code></pre>
<p><span class="math inline">\({{\left({\overline{X}}{\pm}{1.96}\right)}{\cdot}{s}}{/}{\sqrt{N}}\)</span></p>
<pre><code>term &lt;- quote(&#39;%+-%&#39;(mean(X), 1.96 * s / sqrt(N))) # functional form of &#39;%+-%&#39;
term &lt;- quote(mean(X) %+-% {1.96 * s / sqrt(N)})   # the same
math(term)</code></pre>
<p><span class="math inline">\({\overline{X}}{\pm}{{{1.96}{{}}{s}}{/}{\sqrt{N}}}\)</span></p>
<p>The example is a reminder that it is not possible to define the
precedence of custom operators in R, and that expressions with such
operators are evaluated strictly from left to right. Again, the problem
can be worked around by the functional form of the operator or a curly
brace to hide the parenthesis, and, at the same time, enforce the
correct operator precedence.</p>
<p>More operators are shown in Table
<a href="#tab:custom-operators" data-reference-type="ref" data-reference="tab:custom-operators">1</a>, including the suggestions by Murrell
and Ihaka <span class="citation" data-cites="murrell2000">(<a href="#ref-murrell2000" role="doc-biblioref">2000</a>)</span> for graphical annotations and arrows in R figures.</p>
<div id="tab:custom-operators">
<table>
<caption>Custom operators in mathml</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Output</th>
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Output</th>
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Arrow</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A %*% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\times}{B}\)</span></td>
<td style="text-align: left;">A != B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\ne}{B}\)</span></td>
<td style="text-align: left;">A %% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\leftrightarrow}{B}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">A %.% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\cdot}{B}\)</span></td>
<td style="text-align: left;">A ~ B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\sim}{B}\)</span></td>
<td style="text-align: left;">A %-&gt;% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\rightarrow}{B}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A %x% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\otimes}{B}\)</span></td>
<td style="text-align: left;">A %~~% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\approx}{B}\)</span></td>
<td style="text-align: left;">A %&lt;-% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\leftarrow}{B}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">A %/% B</td>
<td style="text-align: left;"><span class="math inline">\(\lfloor{{A}{/}{B}}\rfloor\)</span></td>
<td style="text-align: left;">A %==% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\equiv}{B}\)</span></td>
<td style="text-align: left;">A %up% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\uparrow}{B}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A %% B</td>
<td style="text-align: left;"><span class="math inline">\(mod{\left({A}{{,}{B}}\right)}\)</span></td>
<td style="text-align: left;">A %=~% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\cong}{B}\)</span></td>
<td style="text-align: left;">A %down% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\downarrow}{B}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">A &amp; B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\land}{B}\)</span></td>
<td style="text-align: left;">A %prop% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\propto}{B}\)</span></td>
<td style="text-align: left;">A %&lt;=&gt;% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\iff}{B}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A | B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\lor}{B}\)</span></td>
<td style="text-align: left;">A %in% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\in}{B}\)</span></td>
<td style="text-align: left;">A %=&gt;% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\Rightarrow}{B}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">xor(A, B)</td>
<td style="text-align: left;"><span class="math inline">\({A}{\veebar}{B}\)</span></td>
<td style="text-align: left;">intersect(A, B)</td>
<td style="text-align: left;"><span class="math inline">\({A}{\cap}{B}\)</span></td>
<td style="text-align: left;">A %&lt;=% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\Leftarrow}{B}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">!A</td>
<td style="text-align: left;"><span class="math inline">\({\lnot}{A}\)</span></td>
<td style="text-align: left;">union(A, B)</td>
<td style="text-align: left;"><span class="math inline">\({A}{\cup}{B}\)</span></td>
<td style="text-align: left;">A %dblup% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\Uparrow}{B}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">A == B</td>
<td style="text-align: left;"><span class="math inline">\({A}{=}{B}\)</span></td>
<td style="text-align: left;">crossprod(A, B)</td>
<td style="text-align: left;"><span class="math inline">\({{A}^{\mathrm{T}}}{\times}{B}\)</span></td>
<td style="text-align: left;">A %dbldown% B</td>
<td style="text-align: left;"><span class="math inline">\({A}{\Downarrow}{B}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A &lt;- B</td>
<td style="text-align: left;"><span class="math inline">\({A}{=}{B}\)</span></td>
<td style="text-align: left;">is.null(A)</td>
<td style="text-align: left;"><span class="math inline">\({A}{=}{\emptyset}\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(\mathrm{}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="tab:base-stats">
<table>
<caption>R functions from base and stats</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Output</th>
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sin(x)</td>
<td style="text-align: left;"><span class="math inline">\(\sin{x}\)</span></td>
<td style="text-align: left;">dbinom(k, N, pi)</td>
<td style="text-align: left;"><span class="math inline">\({P}_{\mathrm{Bi}}{\left({{X}{=}{k}}{{;}{{N}{{,}{\pi}}}}\right)}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">cosh(x)</td>
<td style="text-align: left;"><span class="math inline">\(\cosh{x}\)</span></td>
<td style="text-align: left;">pbinom(k, N, pi)</td>
<td style="text-align: left;"><span class="math inline">\({P}_{\mathrm{Bi}}{\left({{X}{\le}{k}}{{;}{{N}{{,}{\pi}}}}\right)}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tanpi(alpha)</td>
<td style="text-align: left;"><span class="math inline">\(\tan{\left({\alpha}{{}}{\pi}\right)}\)</span></td>
<td style="text-align: left;">qbinom(p, N, pi)</td>
<td style="text-align: left;"><span class="math inline">\({\arg\min}_{k}{\left[{{P}_{\mathrm{Bi}}{\left({{X}{\le}{k}}{{;}{{N}{{,}{\pi}}}}\right)}}{&gt;}{p}\right]}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">asinh(x)</td>
<td style="text-align: left;"><span class="math inline">\({\sinh}^{{-}{1}}{x}\)</span></td>
<td style="text-align: left;">dpois(k, lambda)</td>
<td style="text-align: left;"><span class="math inline">\({P}_{\mathrm{Po}}{\left({{X}{=}{k}}{{;}{\lambda}}\right)}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(p)</td>
<td style="text-align: left;"><span class="math inline">\(\log{p}\)</span></td>
<td style="text-align: left;">ppois(k, lambda)</td>
<td style="text-align: left;"><span class="math inline">\({P}_{\mathrm{Po}}{\left({{X}{\le}{k}}{{;}{\lambda}}\right)}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">log1p(x)</td>
<td style="text-align: left;"><span class="math inline">\(\log{\left({1}{+}{x}\right)}\)</span></td>
<td style="text-align: left;">qpois(p, lambda)</td>
<td style="text-align: left;"><span class="math inline">\({{\arg\max}}_{k}{\left[{{P}_{\mathrm{Po}}{\left({{X}{\le}{k}}{{;}{\lambda}}\right)}}{&gt;}{p}\right]}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">logb(x, e)</td>
<td style="text-align: left;"><span class="math inline">\({\log}_{e}{x}\)</span></td>
<td style="text-align: left;">dexp(x, lambda)</td>
<td style="text-align: left;"><span class="math inline">\({f}_{\mathrm{Exp}}{\left({x}{{;}{\lambda}}\right)}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">exp(x)</td>
<td style="text-align: left;"><span class="math inline">\(\exp{x}\)</span></td>
<td style="text-align: left;">pexp(x, lambda)</td>
<td style="text-align: left;"><span class="math inline">\({F}_{\mathrm{Exp}}{\left({x}{{;}{\lambda}}\right)}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">expm1(x)</td>
<td style="text-align: left;"><span class="math inline">\({\exp{x}}{-}{1}\)</span></td>
<td style="text-align: left;">qexp(p, lambda)</td>
<td style="text-align: left;"><span class="math inline">\({F}_{\mathrm{Exp}}^{{-}{1}}{\left({p}{{;}{\lambda}}\right)}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">choose(n, k)</td>
<td style="text-align: left;"><span class="math inline">\(\binom{n}{k}\)</span></td>
<td style="text-align: left;">dnorm(x, mu, sigma)</td>
<td style="text-align: left;"><span class="math inline">\(\phi{\left({x}{{;}{{\mu}{{,}{\sigma}}}}\right)}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">lchoose(n, k)</td>
<td style="text-align: left;"><span class="math inline">\(\log{\binom{n}{k}}\)</span></td>
<td style="text-align: left;">pnorm(x, mu, sigma)</td>
<td style="text-align: left;"><span class="math inline">\(\Phi{\left({x}{{;}{{\mu}{{,}{\sigma}}}}\right)}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">factorial(n)</td>
<td style="text-align: left;"><span class="math inline">\({n}{!}\)</span></td>
<td style="text-align: left;">qnorm(alpha/2L)</td>
<td style="text-align: left;"><span class="math inline">\({\Phi}^{{-}{1}}{\left({\alpha}{/}{2}\right)}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">lfactorial(n)</td>
<td style="text-align: left;"><span class="math inline">\(\log{{n}{!}}\)</span></td>
<td style="text-align: left;">1L - pchisq(x, 1L)</td>
<td style="text-align: left;"><span class="math inline">\({1}{-}{{F}_{{\chi}^{2}{\left({1}{{\,}{\mathrm{df}}}\right)}}{\left(x\right)}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">sqrt(x)</td>
<td style="text-align: left;"><span class="math inline">\(\sqrt{x}\)</span></td>
<td style="text-align: left;">qchisq(1L - alpha, 1L)</td>
<td style="text-align: left;"><span class="math inline">\({F}_{{\chi}^{2}{\left({1}{{\,}{\mathrm{df}}}\right)}}^{{-}{1}}{\left({1}{-}{\alpha}\right)}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean(X)</td>
<td style="text-align: left;"><span class="math inline">\(\overline{X}\)</span></td>
<td style="text-align: left;">pt(t, N - 1L)</td>
<td style="text-align: left;"><span class="math inline">\(P{\left({{T}{\le}{t}}{{;}{{{N}{-}{1}}{{\,}{\mathrm{df}}}}}\right)}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">abs(x)</td>
<td style="text-align: left;"><span class="math inline">\({\left\vert{x}\right\vert}\)</span></td>
<td style="text-align: left;">qt(alpha/2L, N - 1L)</td>
<td style="text-align: left;"><span class="math inline">\({T}_{{\alpha}{/}{2}}{\left({{N}{-}{1}}{{\,}{\mathrm{df}}}\right)}\)</span></td>
</tr>
</tbody>
</table>
</div>
<h3 data-number="3.5" id="builtin-functions"><span class="header-section-number">3.5</span> Builtin functions</h3>
<p>There is support for most functions from package <code>base</code>, with adequate
use and omission of parentheses.</p>
<pre><code>term &lt;- quote(sin(x) + sin(x)^2L + cos(pi/2L) + tan(2L*pi) * expm1(x))
math(term)</code></pre>
<p><span class="math inline">\({{{\sin{x}}{+}{{\left(\sin{x}\right)}^{2}}}{+}{\cos{\left({\pi}{/}{2}\right)}}}{+}{{\tan{\left({2}{{}}{\pi}\right)}}{\cdot}{\left({\exp{x}}{-}{1}\right)}}\)</span></p>
<pre><code>term &lt;- quote(choose(N, k) + abs(x) + sqrt(x) + floor(x) + exp(frac(x, y)))
math(term)</code></pre>
<p><span class="math inline">\({{{{\binom{N}{k}}{+}{{\left\vert{x}\right\vert}}}{+}{\sqrt{x}}}{+}{\lfloor{x}\rfloor}}{+}{\exp{\left(\frac{x}{y}\right)}}\)</span></p>
<p>A few more examples are shown in Table
<a href="#tab:base-stats" data-reference-type="ref" data-reference="tab:base-stats">2</a>,
including functions from <code>stats</code>.</p>
<h3 data-number="3.6" id="custom-functions"><span class="header-section-number">3.6</span> Custom functions</h3>
<p>For self-written functions, the matter is somewhat more complicated. For
instance, if we consider a function such as <code>g &lt;- function(...) ...</code>,
the name <em>g</em> is not transparent to R, because only the function body
is represented. We can still display functions in the form <code>head(x) = body</code>
if we embed the object to be shown into a call <code>"&lt;-"(head, body)</code>.</p>
<pre><code>sgn &lt;- function(x)
{
  if(x == 0L) return(0L)
  if(x &lt; 0L) return(-1L)
  if(x &gt; 0L) return(1L)
}

math(sgn)</code></pre>
<p><span class="math inline">\(\left\{\begin{array}{l}{{0},\ \mathrm{if}\ {{x}{=}{0}}}\\ {{{-}{1}},\ \mathrm{if}\ {{x}{&lt;}{0}}}\\ {{1},\ \mathrm{if}\ {{x}{&gt;}{0}}}\end{array}\right.\)</span></p>
<pre><code>math(call(&quot;&lt;-&quot;, quote(sgn(x)), sgn))</code></pre>
<p><span class="math inline">\({\mathrm{sgn}\,{x}}{=}{\left\{\begin{array}{l}{{0},\ \mathrm{if}\ {{x}{=}{0}}}\\ {{{-}{1}},\ \mathrm{if}\ {{x}{&lt;}{0}}}\\ {{1},\ \mathrm{if}\ {{x}{&gt;}{0}}}\end{array}\right.}\)</span></p>
<p>The function body is generally a nested R call of the form <code>{(L)</code>, with
<code>L</code> being a list of commands (the semicolon, not necessary in R, is
translated to a newline). The example also illustrates that mathml
provides limited support for control structures such as <code>if</code> that is
internally represented as <code>if(condition, action)</code>.</p>
<h3 data-number="3.7" id="indices-and-powers"><span class="header-section-number">3.7</span> Indices and powers</h3>
<p>Indices in square brackets are rendered as subscripts, powers are
rendered as superscript. Moreover, mathml defines the functions
<code>sum_over(x, from, to)</code>, and <code>prod_over(x, from, to)</code> that simply return
their first argument. The other two arguments serve as decorations (<em>to</em>
is optional), for example, for summation and product signs.</p>
<pre><code>term &lt;- quote(S[Y]^2L &lt;- frac(1L, N) * sum(Y[i] - mean(Y))^2L)
math(term)</code></pre>
<p><span class="math inline">\({{S}_{Y}^{2}}{=}{{\frac{1}{N}}{\cdot}{{\sum{\left({{Y}_{i}}{-}{\overline{Y}}\right)}}^{2}}}\)</span></p>
<pre><code>term &lt;- quote(log(prod_over(L[i], i==1L, N)) &lt;- sum_over(log(L[i]), i==1L, N))
math(term)</code></pre>
<p><span class="math inline">\({\log{{\prod}_{{i}{=}{1}}^{N}{{L}_{i}}}}{=}{{\sum}_{{i}{=}{1}}^{N}{\log{{L}_{i}}}}\)</span></p>
<h3 data-number="3.8" id="ringing-back-to-r"><span class="header-section-number">3.8</span> Ringing back to R</h3>
<p>Rs <code>integrate</code> function takes a number of arguments, the most important
ones being the function to integrate, and the lower and the upper bound
of the integration.</p>
<pre><code>term &lt;- quote(integrate(sin, 0L, 2L*pi))
math(term)</code></pre>
<p><span class="math inline">\(\int_{0}^{{2}{{}}{\pi}}{\sin{x}}\,{d{x}}\)</span></p>
<pre><code>eval(term)

#&gt; 2.221482e-16 with absolute error &lt; 4.4e-14</code></pre>
<p>For mathematical typesetting in the form of <span class="math inline">\(\int f(x)\, dx\)</span>, mathml
needs to find out the name of the integration variable. For that
purpose, the underlying Prolog bridge provides a predicate <code>r_eval/2</code>
that calls R from Prolog. This predicate is used to evaluate
<code>formalArgs(args(sin))</code> and returns the names of the arguments of
<code>sin()</code>, namely, <em>x</em>.</p>
<p>Above, the quoted term is an abbreviation for <code>call("integrate", quote(sin), ...)</code>,
with <code>sin</code> being an R symbol, not a function. While the R function
<code>integrate()</code> can handle both symbols and functions, mathml needs the
symbol because it is unable to determine the function name of custom
functions.</p>
<h3 data-number="3.9" id="names-and-order-of-arguments"><span class="header-section-number">3.9</span> Names and order of arguments</h3>
<p>One of R’s great features is the possibility to refer to function
arguments by their names, not only by their position in the list of
arguments. At the other end, the Prolog handlers for R calls are rather
rigid, for example, <code>integrate/3</code> accepts exactly three arguments in a
particular order and without names, that is,
<code>integrate(lower=0L, upper=2L*pi, sin)</code>, would not print the desired
result.</p>
<p>To “canonicalize” function calls with named arguments and arguments in
unusual order, mathml provides an auxiliary R function
<code>canonical(f, drop)</code> that reorders the argument list of calls to known
R functions and, if <code>drop=TRUE</code> (which is the default), also removes the
names of the arguments.</p>
<pre><code>term &lt;- quote(integrate(lower=0L, upper=2L*pi, sin))
canonical(term)

#&gt; integrate(sin, 0L, 2L * pi)

math(canonical(term))</code></pre>
<p><span class="math inline">\(\int_{0}^{{2}{{}}{\pi}}{\sin{x}}\,{d{x}}\)</span></p>
<p>This function can be used to feed mixtures of partially named and
positional arguments into the renderer. For details, see the R function
<code>match.call()</code>.</p>
<h3 data-number="3.10" id="matrices-and-vectors"><span class="header-section-number">3.10</span> Matrices and Vectors</h3>
<p>Of course, mathml also supports matrices and vectors.</p>
<pre><code>v &lt;- 1:3
math(call(&quot;t&quot;, v))</code></pre>
<p><span class="math inline">\({\left({1}{{\,}{2}{{\,}{3}}}\right)}^{\mathrm{T}}\)</span></p>
<pre><code>A &lt;- matrix(data=11:16, nrow=2, ncol=3)
B &lt;- matrix(data=21:26, nrow=2, ncol=3)
term &lt;- call(&quot;+&quot;, A, B)
math(term)</code></pre>
<p><span class="math inline">\({\left(\begin{array}{ccc}11 &amp; 13 &amp; 15\\ 12 &amp; 14 &amp; 16\\ \end{array}\right)}{+}{\left(\begin{array}{ccc}21 &amp; 23 &amp; 25\\ 22 &amp; 24 &amp; 26\\ \end{array}\right)}\)</span></p>
<p>Note that the seemingly more convenient <code>term &lt;- quote(A + B)</code> yields
<span class="math inline">\(A + B\)</span> in the output—instead of the desired matrix representation.
This behavior is expected because quotation of R calls also quote the
components of the call (here, <em>A</em> and <em>B</em>).</p>
<h3 data-number="3.11" id="short-mathematical-names-for-r-symbols"><span class="header-section-number">3.11</span> Short mathematical names for R symbols</h3>
<p>In typical R functions, variable names are typically longer than just
single letters, which may yield unsatisfactory results in the
mathematical output.</p>
<pre><code>term &lt;- quote(pbinom(successes, Ntotal, prob))
math(term)</code></pre>
<p><span class="math inline">\({P}_{\mathrm{Bi}}{\left({{X}{\le}{successes}}{{;}{{Ntotal}{{,}{prob}}}}\right)}\)</span></p>
<pre><code>hook(successes, k)
hook(quote(Ntotal), quote(N), quote=FALSE)
hook(prob, pi)
math(term)</code></pre>
<p><span class="math inline">\({P}_{\mathrm{Bi}}{\left({{X}{\le}{k}}{{;}{{N}{{,}{\pi}}}}\right)}\)</span></p>
<p>To improve the situation, mathml provides a simple hook that can be used
to replace elements (e.g., verbose variable names) of the code by
concise mathematical symbols, as illustrated in the example. To simplify
notation, <code>hook()</code> uses non-standard evaluation of its arguments. If the
<code>quote</code> flag of <code>hook()</code> is set to <code>FALSE</code>, the user has to provide the
quoted expressions. Care should be taken to avoid recursive hooks such
as <code>hook(s, s["A"])</code> that endlessly replace the <span class="math inline">\(s\)</span> from
<span class="math inline">\(s_{\mathrm{A}}\)</span> as in <span class="math inline">\(s_{\mathrm{A}_{\mathrm{A}_{\mathrm{A}\cdots}}}\)</span>.</p>
<p>The hooks can also be used for more complex elements such as R calls,
with dotted symbols representing Prolog variables.</p>
<pre><code>hook(pbinom(.K, .N, .P), sum_over(dbinom(i, .N, .P), i=0L, .K))
math(term)</code></pre>
<p><span class="math inline">\({\sum}_{{i}{=}{0}}^{k}{{P}_{\mathrm{Bi}}{\left({{X}{=}{i}}{{;}{{N}{{,}{\pi}}}}\right)}}\)</span></p>
<p>Further customization requires the assertion of new Prolog rules
<code>math/2</code>, <code>ml/3</code>, <code>jax/3</code>, as shown in the Appendix.</p>
<h3 data-number="3.12" id="abbreviations"><span class="header-section-number">3.12</span> Abbreviations</h3>
<p>We consider the <span class="math inline">\(t\)</span>-statistic for independent samples with equal
variance. To avoid clutter in the equation, the pooled variance
<span class="math inline">\(s^2_{\mathrm{pool}}\)</span> is abbreviated, and a comment is given with the
expression for <span class="math inline">\(s^2_{\mathrm{pool}}\)</span>. For this purpose, mathml provides
a function <code>denote(abbr, expr, info)</code>, with <code>expr</code> actually being
evaluated, <code>abbr</code> being rendered, plus a comment of the form “with
<code>expr</code> denoting <code>info</code>”.</p>
<pre><code>hook(m_A, mean(X)[&quot;A&quot;]) ; hook(s2_A, s[&quot;A&quot;]^2L) ;
hook(n_A, n[&quot;A&quot;])
hook(m_B, mean(X)[&quot;B&quot;]) ; hook(s2_B, s[&quot;B&quot;]^2L)
hook(n_B, n[&quot;B&quot;]) ; hook(s2_p, s[&quot;pool&quot;]^2L)

term &lt;- quote(t &lt;- dfrac(m_A - m_B, 
    sqrt(denote(s2_p, frac((n_A - 1L)*s2_A + (n_B - 1L)*s2_B, n_A + n_B - 2L),
                &quot;the pooled variance.&quot;) * (frac(1L, n_A) + frac(1L, n_B)))))
math(term)</code></pre>
<p><span class="math inline">\({t}{=}{\displaystyle{\frac{{{\overline{X}}_{\mathrm{A}}}{-}{{\overline{X}}_{\mathrm{B}}}}{\sqrt{{{s}_{\mathrm{pool}}^{2}}{\cdot}{\left({\frac{1}{{n}_{\mathrm{A}}}}{+}{\frac{1}{{n}_{\mathrm{B}}}}\right)}}}}}\)</span>,
with
<span class="math inline">\({{s}_{\mathrm{pool}}^{2}}{=}{\frac{{{\left({{n}_{\mathrm{A}}}{-}{1}\right)}{\cdot}{{s}_{\mathrm{A}}^{2}}}{+}{{\left({{n}_{\mathrm{B}}}{-}{1}\right)}{\cdot}{{s}_{\mathrm{B}}^{2}}}}{{{{n}_{\mathrm{A}}}{+}{{n}_{\mathrm{B}}}}{-}{2}}}\)</span>
denoting the pooled variance.</p>
<p>The term is evaluated below. <code>print()</code> is needed because the return
value of an assignment of the form <code>t &lt;- dfrac(...)</code> is not visible in
R.</p>
<pre><code>m_A &lt;- 1.5; s2_A &lt;- 2.4^2; n_A &lt;- 27; m_B &lt;- 3.9; s2_B &lt;- 2.8^2; n_B &lt;- 20
print(eval(term))

#&gt; [1] -3.157427</code></pre>
<h3 data-number="3.13" id="context-dependent-rendering"><span class="header-section-number">3.13</span> Context-dependent rendering</h3>
<p>Consider an educational scenario in which we want to highlight a certain
element of a term, for example, that a student has forgotten to subtract
the null hypothesis in a <span class="math inline">\(t\)</span>-ratio:</p>
<pre><code>t &lt;- quote(dfrac(omit_right(mean(D) - mu[0L]), s / sqrt(N)))
math(t, flags=list(error=&quot;highlight&quot;))</code></pre>
<p><span class="math inline">\(\displaystyle{\frac{{\overline{D}}{{\,}{\cancel{{-}{{\,}{{\mu}_{0}}}}}}}{{s}{/}{\sqrt{N}}}}\)</span></p>
<pre><code>math(t, flags=list(error=&quot;fix&quot;))</code></pre>
<p><span class="math inline">\(\displaystyle{\frac{{\overline{D}}{{\,}{\boxed{{-}{{\,}{{\mu}_{0}}}}}}}{{s}{/}{\sqrt{N}}}}\)</span></p>
<p>The R function <code>omit_right(a + b)</code> uses non-standard evaluation
techniques <span class="citation" data-cites="Wickham2019">(e.g., <a href="#ref-Wickham2019" role="doc-biblioref">Wickham 2019</a>)</span> to return only the left part an
operation, and cancels the right part. This may not always be desired,
for example, when illustrating how to fix the mistake.</p>
<p>For this purpose, the functions <code>mathml()</code>, <code>mathjax()</code>, <code>mathout()</code> and
<code>math()</code> have an optional argument <code>flags</code> which is a list with named
elements. In this example, we use this argument to tell mathml how to
render such erroneous expressions using the flag <code>error</code> which can be
“asis”, “highlight”, “fix”, or “ignore”. For more examples, see Table
<a href="#tab:mistakes" data-reference-type="ref" data-reference="tab:mistakes">3</a>.</p>
<div id="tab:mistakes">
<table>
<caption>Highlighting elements of a term</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Operation</th>
<th style="text-align: left;">error = asis</th>
<th style="text-align: left;">highlight</th>
<th style="text-align: left;">fix</th>
<th style="text-align: left;">ignore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">omit_left(a + b)</td>
<td style="text-align: left;"><span class="math inline">\(b\)</span></td>
<td style="text-align: left;"><span class="math inline">\({\cancel{{a}{{\,}{+}}}}{{\,}{b}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({\boxed{{a}{{\,}{+}}}}{{\,}{b}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{+}{b}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">omit_right(a + b)</td>
<td style="text-align: left;"><span class="math inline">\(a\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\cancel{{+}{{\,}{b}}}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\boxed{{+}{{\,}{b}}}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{+}{b}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">list(quote(a), quote(omit(b)))</td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\mathrm{}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\cancel{b}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\boxed{b}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{b}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">add_left(a + b)</td>
<td style="text-align: left;"><span class="math inline">\({a}{+}{b}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({\boxed{{a}{{\,}{+}}}}{{\,}{b}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({\cancel{{a}{{\,}{+}}}}{{\,}{b}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(b\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">add_right(a + b)</td>
<td style="text-align: left;"><span class="math inline">\({a}{+}{b}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\boxed{{+}{{\,}{b}}}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\cancel{{+}{{\,}{b}}}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(a\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">list(quote(a), quote(add(b)))</td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{b}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\boxed{b}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\cancel{b}}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({a}{{\,}{\mathrm{}}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">instead(a, b) + c</td>
<td style="text-align: left;"><span class="math inline">\({a}{+}{c}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({\underbrace{a}_{{\mathrm{instead}}{{\,}{\mathrm{of}}{{\,}{b}}}}}{+}{c}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({\boxed{b}}{+}{c}\)</span></td>
<td style="text-align: left;"><span class="math inline">\({b}{+}{c}\)</span></td>
</tr>
</tbody>
</table>
</div>
<h2 data-number="4" id="a-case-study"><span class="header-section-number">4</span> A case study</h2>
<p>This case study describes a model by Schwarz <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">1994</a>)</span> from mathematical
psychology using the features of package mathml. Schwarz <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">1994</a>)</span> presents
a new explanation of redundancy gains that occur when observers respond
to stimuli of different sources, and the same information is presented
on two or more channels. In Schwarz’s <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">1994</a>)</span> model, decision-making
builds on a process of noisy accumulation of information over time
<span class="citation" data-cites="ratcliff2016">(e.g., <a href="#ref-ratcliff2016" role="doc-biblioref">Ratcliff et al. 2016</a>)</span>. In redundant stimuli, the model assumes a
superposition of channel-specific diffusion processes that eventually
reach an absorbing barrier to elicit the response. For a detailed
description the reader may refer to the original article.</p>
<p>Schwarz’s <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">1994</a>)</span> model refers to two stimuli A and B, presented either
alone or in combination (AB, redundant stimuli), with the redundant
stimuli being presented either simultaneously or with onset asynchrony
<span class="math inline">\(\tau\)</span>. The channel activation is described as a two-dimensional Wiener
process with drifts <span class="math inline">\(\mu_i\)</span>, variances <span class="math inline">\(\sigma^2_i\)</span>, and initial
conditions <span class="math inline">\(X_i(t = 0) = 0, i = \mathrm{A, B}\)</span>. The buildup of
channel-specific activation may be correlated with <span class="math inline">\(\rho_{\mathrm{AB}}\)</span>,
but we assume <span class="math inline">\(\rho_{\mathrm{AB}} = 0\)</span> for simplicity.</p>
<p>A response is elicited when the process reaches an absorbing barrier
<span class="math inline">\(c &gt; 0\)</span> for the first time. In single-target trials, the first passages
of <span class="math inline">\(c\)</span> are expected at</p>
<pre><code>ED_single &lt;- function(c, mu)
  dfrac(c, mu)

# display as E(D; mu), c is a scaling parameter
hook(ED_single(.C, .Mu), E(`;`(D, .Mu)))
math(call(&quot;=&quot;, quote(ED_single(c, mu)), ED_single))</code></pre>
<p><span class="math inline">\({E{\left({D}{;}{\mu}\right)}}{=}{\displaystyle{\frac{c}{\mu}}}\)</span></p>
<p>One would typically use chunk option <code>echo=FALSE</code> to suppress the R
code.</p>
<p>In redundant stimuli, the activation from the channel-specific diffusion
processes adds up,
<span class="math inline">\(X_{\mathrm{AB}}(t) = X_{\mathrm A}(t) + X_{\mathrm B}(t)\)</span>, hence the
name, superposition. <span class="math inline">\(X_{\mathrm{AB}}(t)\)</span> is again a Wiener process with
drift <span class="math inline">\(\mu_{\mathrm A} + \mu_{\mathrm B}\)</span> and variance
<span class="math inline">\(\sigma^2_{\mathrm A} + \sigma^2_{\mathrm B}\)</span>. For the expected
first-passage time, we have</p>
<pre><code>hook(mu_A, mu[&quot;A&quot;])
hook(mu_B, mu[&quot;B&quot;])
hook(sigma_A, sigma[&quot;A&quot;])
hook(sigma_B, sigma[&quot;B&quot;])
hook(mu_M, mu[&quot;M&quot;])
hook(M, overline(X))

math(call(&quot;=&quot;, quote(E(D[&quot;AB&quot;])), quote(ED_single(c, mu_A + mu_B))))</code></pre>
<p><span class="math inline">\({E{\left({D}_{\mathrm{AB}}\right)}}{=}{E{\left({D}{;}{{{\mu}_{\mathrm{A}}}{+}{{\mu}_{\mathrm{B}}}}\right)}}\)</span></p>
<p>For asynchronous stimuli, Schwarz <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">1994</a>)</span> derived the expected
first-passage time as a function of the stimulus onset asynchrony
<span class="math inline">\(\tau\)</span>,</p>
<pre><code>ED_async &lt;- function(tau, c, mu_A, sigma_A, mu_B)
{ dfrac(c, mu_A) + (dfrac(1L, mu_A) - dfrac(1L, mu_A + mu_B)) *
    ((mu_A*tau - c) * pnorm(dfrac(c - mu_A*tau, sqrt(sigma_A^2L*tau)))
      - (mu_A*tau + c) * exp(dfrac(2L*c*mu_A, sigma_A^2L))
        * pnorm(dfrac(-c - mu_A*tau, sqrt(sigma_A^2L*tau))))
}

hook(ED_async(.Tau, .C, .MA, .SA, .MB), E(`;`(D[.Tau], `,`(.MA, .SA, .MB))))
math(call(&quot;=&quot;, quote(E(D[tau])), ED_async))</code></pre>
<p><span class="math inline">\({E{\left({D}_{\tau}\right)}}{=}{{\displaystyle{\frac{c}{{\mu}_{\mathrm{A}}}}}{+}{{\left({\displaystyle{\frac{1}{{\mu}_{\mathrm{A}}}}}{-}{\displaystyle{\frac{1}{{{\mu}_{\mathrm{A}}}{+}{{\mu}_{\mathrm{B}}}}}}\right)}{\cdot}{\left[{{\left({{{\mu}_{\mathrm{A}}}{{}}{\tau}}{-}{c}\right)}{\cdot}{\Phi{\left(\displaystyle{\frac{{c}{-}{{{\mu}_{\mathrm{A}}}{{}}{\tau}}}{\sqrt{{{\sigma}_{\mathrm{A}}^{2}}{{}}{\tau}}}}\right)}}}{-}{{{\left({{{\mu}_{\mathrm{A}}}{{}}{\tau}}{+}{c}\right)}{\cdot}{\exp{\left(\displaystyle{\frac{{{2}{{}}{c}}{{}}{{\mu}_{\mathrm{A}}}}{{\sigma}_{\mathrm{A}}^{2}}}\right)}}}{\cdot}{\Phi{\left(\displaystyle{\frac{{{-}{c}}{-}{{{\mu}_{\mathrm{A}}}{{}}{\tau}}}{\sqrt{{{\sigma}_{\mathrm{A}}^{2}}{{}}{\tau}}}}\right)}}}\right]}}}\)</span></p>
<p>For negative onset asynchrony (i.e., B before A), the parameters are
simply switched.</p>
<pre><code>ED &lt;- function(tau, c, mu_A, sigma_A, mu_B, sigma_B)
{
  if(tau == Inf) return(ED_single(c, mu_A))
  if(tau == -Inf) return(ED_single(c, mu_B))
  if(tau == 0L) return(ED_single(c, mu_A + mu_B))
  if(tau &gt; 0L) return(ED_async(tau, c, mu_A, sigma_A, mu_B))
  if(tau &lt; 0L) return(ED_async(abs(tau), c, mu_B, sigma_B, mu_A))
}

hook(ED(.Tau, .C, .MA, .SA, .MB, .SB), E(`;`(D[.Tau], `,`(.MA, .SA, .MB, .SB))))
math(call(&quot;=&quot;, quote(ED(tau, c, mu_A, sigma_A, mu_B, sigma_B)), ED))</code></pre>
<p><span class="math inline">\({E{\left({{D}_{\tau}}{;}{{{\mu}_{\mathrm{A}}}{{,}{{\sigma}_{\mathrm{A}}}{{,}{{\mu}_{\mathrm{B}}}{{,}{{\sigma}_{\mathrm{B}}}}}}}\right)}}{=}{\left\{\begin{array}{l}{{E{\left({D}{;}{{\mu}_{\mathrm{A}}}\right)}},\ \mathrm{if}\ {{\tau}{=}{\infty}}}\\ {{E{\left({D}{;}{{\mu}_{\mathrm{B}}}\right)}},\ \mathrm{if}\ {{\tau}{=}{{-}{\infty}}}}\\ {{E{\left({D}{;}{{{\mu}_{\mathrm{A}}}{+}{{\mu}_{\mathrm{B}}}}\right)}},\ \mathrm{if}\ {{\tau}{=}{0}}}\\ {{E{\left({{D}_{\tau}}{;}{{{\mu}_{\mathrm{A}}}{{,}{{\sigma}_{\mathrm{A}}}{{,}{{\mu}_{\mathrm{B}}}}}}\right)}},\ \mathrm{if}\ {{\tau}{&gt;}{0}}}\\ {{E{\left({{D}_{{\left\vert{\tau}\right\vert}}}{;}{{{\mu}_{\mathrm{B}}}{{,}{{\sigma}_{\mathrm{B}}}{{,}{{\mu}_{\mathrm{A}}}}}}\right)}},\ \mathrm{if}\ {{\tau}{&lt;}{0}}}\end{array}\right.}\)</span></p>
<p>The observable response time is assumed to be the sum of <span class="math inline">\(D\)</span>, the time
employed to reach the threshold for the decision, and a residual <span class="math inline">\(M\)</span>
denoting other processes such as motor preparation and execution.
Correspondingly, the expected response time amounts to</p>
<pre><code>ET &lt;- function(tau, c, mu_A, sigma_A, mu_B, sigma_B, mu_M)
  ED(tau, c, mu_A, sigma_A, mu_B, sigma_B) + mu_M

hook(ET(.Tau, .C, .MA, .SA, .MB, .SB, .MM),
     E(`;`(T[.Tau], `,`(.MA, .SA, .MB, .SB, .MM))))
math(call(&quot;=&quot;, quote(E(T[tau])), ET))</code></pre>
<p><span class="math inline">\({E{\left({T}_{\tau}\right)}}{=}{{E{\left({{D}_{\tau}}{;}{{{\mu}_{\mathrm{A}}}{{,}{{\sigma}_{\mathrm{A}}}{{,}{{\mu}_{\mathrm{B}}}{{,}{{\sigma}_{\mathrm{B}}}}}}}\right)}}{+}{{\mu}_{\mathrm{M}}}}\)</span></p>
<p>Schwarz <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">1994</a>)</span> applied the model to data from a redundant signals task
<span class="citation" data-cites="miller">(<a href="#ref-miller" role="doc-biblioref">Miller 1986</a>)</span> with 13 onset asynchronies
<span class="math inline">\(0, \pm33, \pm67, \pm100, \pm133, \pm167, \pm\infty\)</span> ms, where
<span class="math inline">\(\tau = 0\)</span> refers to the synchronous condition, and <span class="math inline">\(\pm\infty\)</span> to the
single-target presentations. Each condition was replicated 400 times.
The observed mean response times and their standard deviations are given
in Table <a href="#tab:miller-data" data-reference-type="ref" data-reference="tab:miller-data">4</a>.</p>
<div id="tab:miller-data">
<table>
<caption>Miller (1986) data</caption>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\(\tau\)</span></th>
<th style="text-align: left;"><span class="math inline">\(m\)</span></th>
<th style="text-align: left;"><span class="math inline">\(s\)</span></th>
<th style="text-align: left;"><span class="math inline">\(n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({-}{\infty}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(231\)</span></td>
<td style="text-align: left;"><span class="math inline">\(56\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({-}{167}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(234\)</span></td>
<td style="text-align: left;"><span class="math inline">\(58\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({-}{133}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(230\)</span></td>
<td style="text-align: left;"><span class="math inline">\(40\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({-}{100}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(227\)</span></td>
<td style="text-align: left;"><span class="math inline">\(40\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({-}{67}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(228\)</span></td>
<td style="text-align: left;"><span class="math inline">\(32\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({-}{33}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(221\)</span></td>
<td style="text-align: left;"><span class="math inline">\(28\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span class="math inline">\(217\)</span></td>
<td style="text-align: left;"><span class="math inline">\(28\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(33\)</span></td>
<td style="text-align: left;"><span class="math inline">\(238\)</span></td>
<td style="text-align: left;"><span class="math inline">\(28\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(67\)</span></td>
<td style="text-align: left;"><span class="math inline">\(263\)</span></td>
<td style="text-align: left;"><span class="math inline">\(26\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(100\)</span></td>
<td style="text-align: left;"><span class="math inline">\(277\)</span></td>
<td style="text-align: left;"><span class="math inline">\(30\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(133\)</span></td>
<td style="text-align: left;"><span class="math inline">\(298\)</span></td>
<td style="text-align: left;"><span class="math inline">\(32\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(167\)</span></td>
<td style="text-align: left;"><span class="math inline">\(316\)</span></td>
<td style="text-align: left;"><span class="math inline">\(34\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\infty\)</span></td>
<td style="text-align: left;"><span class="math inline">\(348\)</span></td>
<td style="text-align: left;"><span class="math inline">\(92\)</span></td>
<td style="text-align: left;"><span class="math inline">\(400\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>Assuming that the model is correct, the observable mean reaction times
follow an approximate Normal distribution around the model prediction
<span class="math inline">\(E(T_\tau)\)</span> for each condition. We can, therefore, use a standard
goodness-of-fit measure by <span class="math inline">\(z\)</span>-standardization.</p>
<pre><code>z &lt;- function(m, s, n, tau, c, mu_A, sigma_A, mu_B, sigma_B, mu_M)
  dfrac(m - denote(mu[tau], ET(tau, c, mu_A, sigma_A, mu_B, sigma_B, mu_M),
              &quot;the expected mean response time&quot;),
    s / sqrt(n))

math(call(&quot;=&quot;, quote(z[tau]), z))</code></pre>
<p><span class="math inline">\({{z}_{\tau}}{=}{\displaystyle{\frac{{m}{-}{{\mu}_{\tau}}}{{s}{/}{\sqrt{n}}}}}\)</span>,
with
<span class="math inline">\({{\mu}_{\tau}}{=}{E{\left({{T}_{\tau}}{;}{{{\mu}_{\mathrm{A}}}{{,}{{\sigma}_{\mathrm{A}}}{{,}{{\mu}_{\mathrm{B}}}{{,}{{\sigma}_{\mathrm{B}}}{{,}{{\mu}_{\mathrm{M}}}}}}}}\right)}}\)</span>
denoting the expected mean response time</p>
<p>The overall goodness-of-fit is the sum of the squared <span class="math inline">\(z\)</span>-statistics for
each onset asynchrony. Assuming again that the architecture of the model
is correct, but the parameters are adjusted to the data, it follows a
<span class="math inline">\(\chi^2(8\ \mathrm{df})\)</span>-distribution.</p>
<pre><code>zv &lt;- Vectorize(z, vectorize.args = c(&#39;m&#39;, &#39;s&#39;, &#39;n&#39;, &#39;tau&#39;))
hook(zv(.M, .S, .N, .Tau, .C, .MA, .SA, .MB, .SB, .MM), z[.Tau])

gof &lt;- function(par, tau, m, s, n)
  sum(zv(m, s, n, tau, c=100L, mu_A=par[&quot;mu_A&quot;], sigma_A=par[&quot;sigma_A&quot;], 
         mu_B=par[&quot;mu_B&quot;], sigma_B=par[&quot;sigma_B&quot;], mu_M=par[&quot;mu_M&quot;])^2L)

math(call(&quot;=&quot;, quote(X[&quot;8 df&quot;]^2L), gof))</code></pre>
<p><span class="math inline">\({{X}_{\mathrm{8 df}}^{2}}{=}{\sum{{z}_{\tau}^{2}}}\)</span></p>
<p>with the degrees of freedom given by the difference between the number
of observations (13) and the number of free model parameters
<span class="math inline">\(\theta = \langle\mu_{\mathrm A}, \sigma_{\mathrm A}, \mu_{\mathrm B}, \sigma_{\mathrm B}, \mu_{\mathrm M}\rangle\)</span>;
the barrier <span class="math inline">\(c\)</span> is only a scaling parameter.</p>
<p><span class="math inline">\({\hat{\theta}}{=}{\arg\min{gof{\left(\theta\right)}}}\)</span></p>
<p>The best fitting parameter values and their confidence intervals are
given in Table <a href="#tab:params" data-reference-type="ref" data-reference="tab:params">5</a>.</p>
<p>The goodness-of-fit statistic indicates some lack of fit,
<span class="math inline">\(X^2(8\ \mathrm{df}) = 28.34, p = 0.0004\)</span>. Given the large trial
numbers in the original study, this is not an unexpected result. For
more detail, especially on fitting the observed standard deviations, the
reader is referred to the original paper <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">Schwarz 1994</a>)</span>.</p>
<div id="tab:params">
<table>
<caption>Model fit</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Estimate</th>
<th style="text-align: left;">CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({\mu}_{\mathrm{A}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(0.53\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left({0.51}{{,}{0.55}}\right)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({\sigma}_{\mathrm{A}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(4.55\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left({3.95}{{,}{5.16}}\right)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({\mu}_{\mathrm{B}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1.36\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left({1.23}{{,}{1.49}}\right)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({\sigma}_{\mathrm{B}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(13.46\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left({7.80}{{,}{19.11}}\right)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({\mu}_{\mathrm{M}}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(161.09\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left({156.91}{{,}{165.28}}\right)\)</span></td>
</tr>
</tbody>
</table>
</div>
<h2 data-number="5" id="conclusion"><span class="header-section-number">5</span> Conclusion</h2>
<p>This package allows R to render its terms in pretty mathematical
equations. It extends the current features of R and existing packages
for displaying mathematical formulas in R <span class="citation" data-cites="murrell2000">(<a href="#ref-murrell2000" role="doc-biblioref">Murrell and Ihaka 2000</a>)</span>, but
most importantly, mathml bridges the gap between computational needs,
presentation of results, and their reproducibility. The package supports
both MathML and LaTeX/MathJax for use in R Markdown documents,
presentations and Shiny App webpages.</p>
<p>Researchers or teachers can already use R Markdown to conduct analyses
and show results, and mathml smoothes this process and allows for
integrated calculations and output. As shown in the case study of the
previous section, mathml can help to improve data analyses and
statistical reports from an aesthetical perspective, as well as
regarding reproducibility of research.</p>
<p>Furthermore, the package may also allow for a better detection of
possible mistakes in R programs. Similar to most programming languages
<span class="citation" data-cites="green1977">(<a href="#ref-green1977" role="doc-biblioref">Green 1977</a>)</span>, R code is notoriously hard to read, and the poor
legibility of the language is one of the main sources of mistakes. For
illustration, we consider again Equation 10 in Schwarz <span class="citation" data-cites="schwarz1994">(<a href="#ref-schwarz1994" role="doc-biblioref">1994</a>)</span>.</p>
<pre><code>f1 &lt;- function(tau)
{ dfrac(c, mu_A) + (dfrac(1L, mu_A) - dfrac(1L, mu_A + mu_B) * 
    ((mu_A*tau - c) * pnorm(dfrac(c - mu_A*tau, sqrt(sigma_A^2L*tau)))
      - (mu_A*tau + c) * exp(dfrac(2L*mu_A*tau, sigma_A^2L))
        * pnorm(dfrac(-c - mu_A*tau, sqrt(sigma_A^2L*tau)))))
}

math(f1)</code></pre>
<p><span class="math inline">\({\displaystyle{\frac{c}{{\mu}_{\mathrm{A}}}}}{+}{\left\{{\displaystyle{\frac{1}{{\mu}_{\mathrm{A}}}}}{-}{{\displaystyle{\frac{1}{{{\mu}_{\mathrm{A}}}{+}{{\mu}_{\mathrm{B}}}}}}{\cdot}{\left[{{\left({{{\mu}_{\mathrm{A}}}{{}}{\tau}}{-}{c}\right)}{\cdot}{\Phi{\left(\displaystyle{\frac{{c}{-}{{{\mu}_{\mathrm{A}}}{{}}{\tau}}}{\sqrt{{{\sigma}_{\mathrm{A}}^{2}}{{}}{\tau}}}}\right)}}}{-}{{{\left({{{\mu}_{\mathrm{A}}}{{}}{\tau}}{+}{c}\right)}{\cdot}{\exp{\left(\displaystyle{\frac{{{2}{{}}{{\mu}_{\mathrm{A}}}}{{}}{\tau}}{{\sigma}_{\mathrm{A}}^{2}}}\right)}}}{\cdot}{\Phi{\left(\displaystyle{\frac{{{-}{c}}{-}{{{\mu}_{\mathrm{A}}}{{}}{\tau}}}{\sqrt{{{\sigma}_{\mathrm{A}}^{2}}{{}}{\tau}}}}\right)}}}\right]}}\right\}}\)</span></p>
<p>The first version has a wrong parenthesis, which is barely visible in
the code, whereas in the mathematical representation, the wrong curly
brace is immediately obvious (the correct version is shown below for
comparison).</p>
<pre><code>f2 &lt;- function(tau)
{ dfrac(c, mu_A) + (dfrac(1L, mu_A) - dfrac(1L, mu_A + mu_B)) * 
    ((mu_A*tau - c) * pnorm(dfrac(c - mu_A*tau, sqrt(sigma_A^2L*tau)))
      - (mu_A*tau + c) * exp(dfrac(2L*mu_A*tau, sigma_A^2L))
        * pnorm(dfrac(-c - mu_A*tau, sqrt(sigma_A^2L*tau))))
}

math(f2)</code></pre>
<p><span class="math inline">\({\displaystyle{\frac{c}{{\mu}_{\mathrm{A}}}}}{+}{{\left({\displaystyle{\frac{1}{{\mu}_{\mathrm{A}}}}}{-}{\displaystyle{\frac{1}{{{\mu}_{\mathrm{A}}}{+}{{\mu}_{\mathrm{B}}}}}}\right)}{\cdot}{\left[{{\left({{{\mu}_{\mathrm{A}}}{{}}{\tau}}{-}{c}\right)}{\cdot}{\Phi{\left(\displaystyle{\frac{{c}{-}{{{\mu}_{\mathrm{A}}}{{}}{\tau}}}{\sqrt{{{\sigma}_{\mathrm{A}}^{2}}{{}}{\tau}}}}\right)}}}{-}{{{\left({{{\mu}_{\mathrm{A}}}{{}}{\tau}}{+}{c}\right)}{\cdot}{\exp{\left(\displaystyle{\frac{{{2}{{}}{{\mu}_{\mathrm{A}}}}{{}}{\tau}}{{\sigma}_{\mathrm{A}}^{2}}}\right)}}}{\cdot}{\Phi{\left(\displaystyle{\frac{{{-}{c}}{-}{{{\mu}_{\mathrm{A}}}{{}}{\tau}}}{\sqrt{{{\sigma}_{\mathrm{A}}^{2}}{{}}{\tau}}}}\right)}}}\right]}}\)</span></p>
<p>As the reader may know from their own experience, missed parentheses are
frequent causes of wrong results and errors that are hard to locate in
programming code. This particular example shows that mathematical
rendering can help to substantially reduce the amount of careless errors
in programming.</p>
<p>One limitation of the package is the lack of a convenient way to insert
line breaks. This is mostly due to lacking support by MathML and LaTeX
renderers. For example, in its current stage, the LaTeX package breqn
<span class="citation" data-cites="breqn">(<a href="#ref-breqn" role="doc-biblioref">Robertson et al. 2021</a>)</span> is mostly a proof of concept. Moreover, mathml
only works in one direction, that is, it is not possible to translate
from LaTeX or HTML back to R <span class="citation" data-cites="latex2r">(see <a href="#ref-latex2r" role="doc-biblioref">Capretto 2023</a>, for an example)</span>.</p>
<p>The package mathml is available for R version 4.2 and later, and can be
easily installed using the usual <code>install.packages("mathml")</code>. At its
present stage, it supports output in HTML, LaTeX, and Microsoft Word
<span class="citation" data-cites="pandoc">(via pandoc, <a href="#ref-pandoc" role="doc-biblioref">MacFarlane 2022</a>)</span>. The source code of the package is found
at <a href="https://github.com/mgondan/mathml" class="uri">https://github.com/mgondan/mathml</a>.</p>
<h2 data-number="6" id="appendix-customizing-the-package"><span class="header-section-number">6</span> Appendix: Customizing the package</h2>
<h3 data-number="6.1" id="implementation-details"><span class="header-section-number">6.1</span> Implementation details</h3>
<p>For convenience, the translation of the R expressions is achieved
through a Prolog interpreter provided by another R package
<a href="https://CRAN.R-project.org/package=rolog">rolog</a> <span class="citation" data-cites="rolog">(<a href="#ref-rolog" role="doc-biblioref">Gondan 2022</a>)</span>. If a
version of SWI-Prolog <span class="citation" data-cites="swipl">(<a href="#ref-swipl" role="doc-biblioref">Wielemaker et al. 2012</a>)</span> is found on the system,
<a href="https://CRAN.R-project.org/package=rolog">rolog</a> connects to it.
Alternatively, the SWI-Prolog runtime libraries can be conveniently
accessed by installing the R package
<a href="https://CRAN.R-project.org/package=rswipl">rswipl</a> <span class="citation" data-cites="rswipl">(<a href="#ref-rswipl" role="doc-biblioref">Gondan 2023</a>)</span>.
Prolog is a classical logic programming language with many applications
in expert systems, computer linguistics and symbolic artificial
intelligence. The strength of Prolog lies in its concise representation
of facts and rules for knowledge and grammar, as well as its efficient
built-in search engine for closed world domains. Whereas Prolog is weak
in statistical computation, but strong in symbolic manipulation, the
converse may be said for the R language. rolog bridges this gap by
providing an interface to a SWI-Prolog distribution <span class="citation" data-cites="swipl">(<a href="#ref-swipl" role="doc-biblioref">Wielemaker et al. 2012</a>)</span>
in R. The communication between the two systems is mainly in the
form of queries from R to Prolog, but two Prolog functions allow ring
back and evaluation of terms in R.</p>
<p>The proper term for a Prolog “function” is predicate, and it is
typically written with name and arity (i.e., number of arguments),
separated by a forward slash. Thus, at the Prolog end, the predicate
<code>math/2</code> translates the representation of the R call <code>pbinom(K, N, Pi)</code>
into a more general representation of an R function <code>fn/2</code> with the name
<code>P_Bi</code>, one argument <code>X =&lt; K</code>, and the two parameters <code>N</code> and <code>Pi</code>, as
shown below.</p>
<pre><code>math(pbinom(K, N, Pi), M)
 =&gt; M = fn(subscript(&#39;P&#39;, &quot;Bi&quot;), ([&#39;X&#39; =&lt; K] ; [N, Pi])).</code></pre>
<p><code>math/2</code> operates like a macro that translates one mathematical element
(here, <code>pbinom(K, N, Pi)</code>) to another mathematical element, namely
<code>fn(Name, (Args ; Pars))</code>. The low-level predicate <code>ml/3</code> is used to
convert these basic elements to MathML.</p>
<pre><code>ml(fn(Name, (Args ; Pars)), M, Flags)
 =&gt; ml(Name, N, Flags),
    ml(paren(list(op(;), [list(op(&#39;,&#39;), Args), list(op(&#39;,&#39;), Pars)])), X, Flags),
    M = mrow([N, mo(&amp;(af)), X]).</code></pre>
<p>The relevant rule for <code>ml/3</code> builds the MathML entity
<code>mrow([N, mo(&amp;(af)), X])</code>, with <code>N</code> representing the name of the
function and <code>X</code> its arguments and parameters enclosed in parentheses. A
corresponding rule <code>jax/3</code> does the same for MathJax/LaTeX. A list of
flags can be used for context-sensitive translation (see, e.g., the
section on errors above).</p>
<p>Several ways exist for translating new R terms to their mathematical
representation. We have already seen above how to use “hooks” to
translate long variable names from R to compact mathematical signs, as
well as functions such as cumulative probabilities <span class="math inline">\(P(X \le k)\)</span> to
different representations like <span class="math inline">\(\sum_{i=0}^k P(X = i)\)</span>. Obviously, the
hooks require that there already exists a rule to translate the target
representation into MathML and MathJax.</p>
<p>In this appendix we describe a few more ways to extend the set of
translations according to a user’s needs. As stated in the background
section, the Prolog end provides two classes of rules for translation,
macros <code>math/2,3,4</code> mirroring the R hooks mentioned above, and the
low-level predicates <code>ml/3</code> and <code>jax/3</code> that create proper MathML and
LaTeX terms.</p>
<h3 data-number="6.2" id="linear-models"><span class="header-section-number">6.2</span> Linear models</h3>
<p>To render the model equation of a linear model such as
<code>lm(EOT ~ T0 + Therapy, data=d)</code> in mathematical form <span class="citation" data-cites="equatiomatic">(see also <a href="#ref-equatiomatic" role="doc-biblioref">Anderson et al. 2023</a>)</span>,
it is sufficient to map the
<code>Formula</code> in <code>lm(Formula, Data)</code> to its respective equation. This can be
done in two ways, using either the hooks described above, or a new
<code>math/2</code> macro at the Prolog end.</p>
<pre><code>hook(lm(.Formula, .Data), .Formula)</code></pre>
<p>The hook is simple, but is a bit limited because only R’s tilde-form of
linear models is shown, and it only works for a call with exactly two
arguments.</p>
<p>Below is an example of how to build a linear equation of the form
<span class="math inline">\(Y = b_0 + b_1X_1 + ...\)</span> using the Prolog macros from mathml.</p>
<pre><code>math_hook(LM, M) :-
    compound(LM),
    LM =.. [lm, ~(Y, Sum) | _Tail],
    summands(Sum, Predictors),
    findall(subscript(b, X) * X, member(X, Predictors), Terms),
    summands(Model, Terms),
    M = (Y == subscript(b, 0) + Model + epsilon).</code></pre>
<p>The predicate <code>summands/2</code> unpacks an expression <code>A + B + C</code> to a list
<code>[C, B, A]</code> and vice-versa (see the file <code>lm.pl</code> for details).</p>
<pre><code>rolog::consult(system.file(file.path(&quot;pl&quot;, &quot;lm.pl&quot;), package=&quot;mathml&quot;))

term &lt;- quote(lm(EOT ~ T0 + Therapy, data=d, na.action=na.fail))
math(term)</code></pre>
<p><span class="math inline">\({EOT}{=}{{{{b}_{0}}{+}{{{{b}_{T0}}{{}}{T0}}{+}{{{b}_{Therapy}}{{}}{Therapy}}}}{+}{\epsilon}}\)</span></p>
<p>See the section above on short mathematical names for replacing
lengthy R labels.</p>
<h3 data-number="6.3" id="n-th-root"><span class="header-section-number">6.3</span> <span class="math inline">\(n\)</span>-th root</h3>
<p>Base R does not provide a function like <code>cuberoot(x)</code> or
<code>nthroot(x, n)</code>, and the present package does not support the respective
representation. To obtain a cube root, a programmer would typically type
<code>x^(1/3)</code> or better <code>x^{1/3}</code> (see the practice section why the curly
brace is preferred in an exponent), resulting in <span class="math inline">\(x^{1/3}\)</span> which may
still not match everyone’s taste. Here we describe the steps needed to
represent the <span class="math inline">\(n\)</span>-th root as <span class="math inline">\(\sqrt[n]x\)</span>.</p>
<p>We assume that <code>nthroot(x, n)</code> is available in the current namespace
<span class="citation" data-cites="pracma">(manually defined, or from R package
<a href="https://CRAN.R-project.org/package=pracma" role="doc-biblioref">pracma</a>, <a href="#ref-pracma" role="doc-biblioref">Borchers 2022</a>)</span>, so
that the names of the arguments and their order are accessible to
<code>canonical()</code> if needed. As we can see below, mathml uses a default
representation <code>name(arguments)</code> for such unknown functions.</p>
<pre><code>nthroot &lt;- function(x, n)
  x^{1L/n}

term &lt;- canonical(quote(nthroot(n=3L, 2L)))
math(term)</code></pre>
<p><span class="math inline">\(nthroot{\left({2}{{,}{3}}\right)}\)</span></p>
<p>A proper MathML term is obtained by <code>mlx/3</code> (the x in mlx indicates that
it is an extension and is prioritized over the default ml/3 rules).
<code>mlx/3</code> recursively invokes <code>ml/3</code> for translating the function
arguments <em>X</em> and <em>N</em>, and then constructs the correct MathML entity
<code>&lt;mroot&gt;...&lt;/mroot&gt;</code>.</p>
<pre><code>mlx(nthroot(X, N), M, Flags) :-
    ml(X, X1, Flags),
    ml(N, N1, Flags),
    M = mroot([X1, N1]).</code></pre>
<p>The explicit unification <code>M = ...</code> in the last line serves to avoid
clutter in the head of <code>mlx/3</code>. The Prolog file <code>nthroot.pl</code> also
includes the respective rule for LaTeX and can be consulted from the
package folder via the underlying package rolog.</p>
<pre><code>rolog::consult(system.file(file.path(&quot;pl&quot;, &quot;nthroot.pl&quot;), package=&quot;mathml&quot;))

term &lt;- quote(nthroot(a * (b + c), 3L)^2L)
math(term)</code></pre>
<p><span class="math inline">\({\left[\sqrt[3]{{a}{\cdot}{\left({b}{+}{c}\right)}}\right]}^{2}\)</span></p>
<pre><code>term &lt;- quote(a^(1L/3L) + a^{1L/3L} + a^(1.0/3L))
math(term)</code></pre>
<p><span class="math inline">\({{\sqrt[3]{a}}{+}{{a}^{{1}{/}{3}}}}{+}{{a}^{\left({1.00}{/}{3}\right)}}\)</span></p>
<p>The file <code>nthroot.pl</code> includes three more statements <code>precx/3</code> and
<code>parenx/3</code>, as well as a <code>math_hook/2</code> macro. The first sets the
operator precedence of the cubic root above the power, thereby putting a
parentheses around nthroot in <span class="math inline">\((\sqrt[3]{\ldots})^2\)</span>. The second tells
the system to increase the counter of the parentheses below the root,
such that the outer parenthesis becomes a square bracket.</p>
<p>The last rule maps powers like <code>a^(1L/3L)</code> to <code>nthroot/3</code>, as shown in
the first summand. Of course, mathml is not a proper computer algebra
system. As is illustrated by the other terms in the sum, such macros are
limited to purely syntactical matching, and terms like <code>a^{1L/3L}</code> with
the curly brace or <code>a^(1.0/3L)</code> with a floating point number in the
numerator are not detected.</p>
<h2 data-number="7" id="acknowledgment"><span class="header-section-number">7</span> Acknowledgment</h2>
<p>Supported by the Erasmus+ program of the European Commission
(2019-1-EE01-KA203-051708).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="7.1" id="supplementary-materials"><span class="header-section-number">7.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-073.zip">RJ-2023-073.zip</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-rmarkdown" class="csl-entry" role="listitem">
J. J. Allaire, Y. Xie, C. Dervieux, J. McPherson, J. Luraschi, K. Ushey, A. Atkins, H. Wickham, J. Cheng, W. Chang, et al. <em>Rmarkdown: Dynamic documents for <span>R</span>.</em> 2023. URL <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>. R package version 2.22.
</div>
<div id="ref-equatiomatic" class="csl-entry" role="listitem">
D. Anderson, A. Heiss and J. Sumners. <em>Equatiomatic: Transform models into ’LaTeX’ equations.</em> 2023. https://github.com/datalorax/equatiomatic, https://datalorax.github.io/equatiomatic/.
</div>
<div id="ref-pracma" class="csl-entry" role="listitem">
H. W. Borchers. <em><span class="nocase">pracma</span>: Practical numerical math functions.</em> 2022. URL <a href="https://CRAN.R-project.org/package=pracma">https://CRAN.R-project.org/package=pracma</a>. R package version 2.4.2.
</div>
<div id="ref-latex2r" class="csl-entry" role="listitem">
T. Capretto. <em><span class="nocase">latex2r</span>: Translate latex formulas to <span>R</span> code.</em> 2023. URL <a href="https://github.com/tomicapretto/latex2r">https://github.com/tomicapretto/latex2r</a>. R package version 0.2.0.
</div>
<div id="ref-Chang2022" class="csl-entry" role="listitem">
W. Chang, J. Cheng, J. J. Allaire, C. Sievert, B. Schloerke, Y. Xie, J. Allen, J. McPherson, A. Dipert and B. Borges. <em>Shiny: Web application framework for <span>R</span>.</em> 2022. URL <a href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</a>. R package version 1.7.3.
</div>
<div id="ref-rolog" class="csl-entry" role="listitem">
M. Gondan. <em><span class="nocase">rolog</span>: Query <span>SWI</span>-<span>P</span>rolog from <span>R</span>.</em> 2022. URL <a href="https://github.com/mgondan/rolog">https://github.com/mgondan/rolog</a>. R package version 0.9.8.
</div>
<div id="ref-rswipl" class="csl-entry" role="listitem">
M. Gondan. <em><span class="nocase">rswipl</span>: Embed <span>SWI</span>-<span>P</span>rolog.</em> 2023. URL <a href="https://CRAN.R-project.org/package=rswipl">https://CRAN.R-project.org/package=rswipl</a>. R package version 9.1.9.
</div>
<div id="ref-green1977" class="csl-entry" role="listitem">
T. R. G. Green. Conditional program statements and their comprehensibility to professional programmers. <em>Journal of Occupational Psychology</em>, 50: 93–109, 1977.
</div>
<div id="ref-pandoc" class="csl-entry" role="listitem">
J. MacFarlane. <em>Pandoc: A universal document converter.</em> 2022. https://www.pandoc.org/.
</div>
<div id="ref-miller" class="csl-entry" role="listitem">
J. O. Miller. Timecourse of coactivation in bimodal divided attention. <em>Perception &amp; Psychophysics</em>, 40: 331–343, 1986.
</div>
<div id="ref-murrell2000" class="csl-entry" role="listitem">
P. Murrell and R. Ihaka. An approach to providing mathematical annotation in plots. <em>Journal of Computational and Graphical Statistics</em>, 9: 582–599, 2000.
</div>
<div id="ref-R" class="csl-entry" role="listitem">
R Core Team. <em>R: A language and environment for statistical computing.</em> Vienna, Austria: R Foundation for Statistical Computing, 2022. URL <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-ratcliff2016" class="csl-entry" role="listitem">
R. Ratcliff, P. L. Smith, S. D. Brown and G. McKoon. Diffusion decision model: Current issues and history. <em>Trends in Cognitive Sciences</em>, 20: 260–281, 2016.
</div>
<div id="ref-breqn" class="csl-entry" role="listitem">
W. Robertson, J. Wright, F. Mittelbach and U. Fischer. <em>Breqn: Automatic line breaking of displayed equations.</em> 2021. URL <a href="https://www.ctan.org/pkg/breqn">https://www.ctan.org/pkg/breqn</a>. LaTeX package version 0.98l.
</div>
<div id="ref-Sarkar2022" class="csl-entry" role="listitem">
D. Sarkar and K. Hornik. <em>Enhancements to <span>HTML</span> <span>D</span>ocumentation.</em> 2022. URL <a href="https://blog.r-project.org/2022/04/08/enhancements-to-html-documentation/index.html">https://blog.r-project.org/2022/04/08/enhancements-to-html-documentation/index.html</a>.
</div>
<div id="ref-schwarz1994" class="csl-entry" role="listitem">
W. Schwarz. Diffusion, superposition, and the redundant-targets effect. <em>Journal of Mathematical Psychology</em>, 38: 504–520, 1994.
</div>
<div id="ref-Viechtbauer2022" class="csl-entry" role="listitem">
W. Viechtbauer. <em><span class="nocase">mathjaxr</span>: Using ’mathjax’ in rd files.</em> 2022. URL <a href="https://CRAN.R-project.org/package=mathjaxr">https://CRAN.R-project.org/package=mathjaxr</a>. R package version 1.6-0.
</div>
<div id="ref-Wickham2019" class="csl-entry" role="listitem">
H. Wickham. <em>Advanced <span>R</span>.</em> Cambridge: Chapman; Hall/CRC, 2019.
</div>
<div id="ref-swipl" class="csl-entry" role="listitem">
J. Wielemaker, T. Schrijvers, M. Triska and T. Lager. <span>SWI-Prolog</span>. <em>Theory and Practice of Logic Programming</em>, 12(1-2): 67–96, 2012.
</div>
<div id="ref-knitr" class="csl-entry" role="listitem">
Y. Xie. <em><span class="nocase">knitr</span>: A general-purpose package for dynamic report generation in <span>R</span>.</em> 2023. URL <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>. R package version 1.43.
</div>
<div id="ref-Xie2018" class="csl-entry" role="listitem">
Y. Xie, J. J. Allaire and G. Grolemund. <em><span>R</span> markdown: The definitive guide.</em> Boca Raton, Florida: Chapman; Hall/CRC, 2018. URL <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>.
</div>
<div id="ref-Xie2020" class="csl-entry" role="listitem">
Y. Xie, C. Dervieux and E. Riederer. <em>R markdown cookbook.</em> Cambridge: Chapman; Hall/CRC, 2020.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Gondan &amp; Alfarone, "mathml: Translate R Expressions to MathML and LaTeX", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-073,
  author = {Gondan, Matthias and Alfarone, Irene},
  title = {mathml: Translate R Expressions to MathML and LaTeX},
  journal = {The R Journal},
  year = {2023},
  note = {https://doi.org/10.32614/RJ-2023-073},
  doi = {10.32614/RJ-2023-073},
  volume = {15},
  issue = {3},
  issn = {2073-4859},
  pages = {277-291}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
