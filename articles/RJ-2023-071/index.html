<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Coloring in R's Blind Spot</title>

<meta property="description" itemprop="description" content="Prior to version 4.0.0 R had a poor default color palette (using highly saturated red, green, blue, etc.) and provided very few alternative palettes, most of which also had poor perceptual properties (like the infamous rainbow palette). Starting with version 4.0.0 R gained a new and much improved default palette and, in addition, a selection of more than 100 well-established palettes are now available via the functions `palette.colors()` and `hcl.colors()`. The former provides a range of popular qualitative palettes for categorical data while the latter closely approximates many popular sequential and diverging palettes by systematically varying the perceptual hue, chroma, and luminance (HCL) properties in the palette.  This paper provides a mix of contributions including an overview of the new color functions and the palettes they provide along with advice about which palettes are appropriate for specific tasks, especially with regard to making them accessible to viewers with color vision deficiencies."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-071/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-12-18"/>
<meta property="article:created" itemprop="dateCreated" content="2023-12-18"/>
<meta name="article:author" content="Achim Zeileis"/>
<meta name="article:author" content="Paul Murrell"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Coloring in R&#39;s Blind Spot"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Prior to version 4.0.0 R had a poor default color palette (using highly saturated red, green, blue, etc.) and provided very few alternative palettes, most of which also had poor perceptual properties (like the infamous rainbow palette). Starting with version 4.0.0 R gained a new and much improved default palette and, in addition, a selection of more than 100 well-established palettes are now available via the functions `palette.colors()` and `hcl.colors()`. The former provides a range of popular qualitative palettes for categorical data while the latter closely approximates many popular sequential and diverging palettes by systematically varying the perceptual hue, chroma, and luminance (HCL) properties in the palette.  This paper provides a mix of contributions including an overview of the new color functions and the palettes they provide along with advice about which palettes are appropriate for specific tasks, especially with regard to making them accessible to viewers with color vision deficiencies."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-071/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2023-071/RJ-2023-071_files/figure-html5/colorcatcont-1.png"/>
<meta property="og:image:width" content="1536"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Coloring in R&#39;s Blind Spot"/>
<meta property="twitter:description" content="Prior to version 4.0.0 R had a poor default color palette (using highly saturated red, green, blue, etc.) and provided very few alternative palettes, most of which also had poor perceptual properties (like the infamous rainbow palette). Starting with version 4.0.0 R gained a new and much improved default palette and, in addition, a selection of more than 100 well-established palettes are now available via the functions `palette.colors()` and `hcl.colors()`. The former provides a range of popular qualitative palettes for categorical data while the latter closely approximates many popular sequential and diverging palettes by systematically varying the perceptual hue, chroma, and luminance (HCL) properties in the palette.  This paper provides a mix of contributions including an overview of the new color functions and the palettes they provide along with advice about which palettes are appropriate for specific tasks, especially with regard to making them accessible to viewers with color vision deficiencies."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-071/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2023-071/RJ-2023-071_files/figure-html5/colorcatcont-1.png"/>
<meta property="twitter:image:width" content="1536"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Coloring in R&#39;s Blind Spot"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-071"/>
<meta name="citation_pdf_url" content="RJ-2023-071.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="3"/>
<meta name="citation_doi" content="10.32614/RJ-2023-071"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="240"/>
<meta name="citation_lastpage" content="256"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/12/18"/>
<meta name="citation_publication_date" content="2023/12/18"/>
<meta name="citation_author" content="Achim Zeileis"/>
<meta name="citation_author_institution" content="Universität Innsbruck"/>
<meta name="citation_author" content="Paul Murrell"/>
<meta name="citation_author_institution" content="University of Auckland"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=HCL Color Space — Wikipedia, the free encyclopedia;citation_publisher=URL https://en.wikipedia.org/wiki/HCL_color_space, accessed 2023-11-20;citation_author= Wikipedia"/>
  <meta name="citation_reference" content="citation_title=A physiologically-based model for simulation of color vision deficiency;citation_volume=15;citation_doi=10.1109/TVCG.2009.113;citation_author=Gustavo M. Machado;citation_author=Manuel M. Oliveira;citation_author=Leandro A. F. Fernandes"/>
  <meta name="citation_reference" content="citation_title=Colour for presentation graphics;citation_author=Ross Ihaka"/>
  <meta name="citation_reference" content="citation_title=ColorBrewer.org: An online tool for selecting color schemes for maps;citation_volume=40;citation_author=Mark A. Harrower;citation_author=Cynthia A. Brewer"/>
  <meta name="citation_reference" content="citation_title=The misuse of colour in science communication;citation_volume=11;citation_doi=10.1038/s41467-020-19160-7;citation_author=Fabio Crameri;citation_author=Grace E. Shephard;citation_author=Philip J. Heron"/>
  <meta name="citation_reference" content="citation_title=A better default colormap for matplotlib;citation_author=Nathaniel Smith;citation_author=Stéfan Van der Walt"/>
  <meta name="citation_reference" content="citation_title=Color universal design (CUD): How to make figures and presentations that are friendly to colorblind people;citation_author=Masataka Okabe;citation_author=Kei Ito"/>
  <meta name="citation_reference" content="citation_title=colorspace: A toolbox for manipulating and assessing colors and palettes;citation_author=Ross Ihaka;citation_author=Paul Murrell;citation_author=Kurt Hornik;citation_author=Jason C. Fisher;citation_author=Reto Stauffer;citation_author=Claus O. Wilke;citation_author=Claire D. McWhite;citation_author=Achim Zeileis"/>
  <meta name="citation_reference" content="citation_title=colorspace: A toolbox for manipulating and assessing colors and palettes;citation_volume=96;citation_doi=10.18637/jss.v096.i01;citation_author=Achim Zeileis;citation_author=Jason C. Fisher;citation_author=Kurt Hornik;citation_author=Ross Ihaka;citation_author=Claire D. McWhite;citation_author=Paul Murrell;citation_author=Reto Stauffer;citation_author=Claus O. Wilke"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Elegant graphics for data analysis;citation_publisher=Springer-Verlag;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=lattice: Multivariate data visualization with R;citation_publisher=Springer-Verlag;citation_author=Deepayan Sarkar"/>
  <meta name="citation_reference" content="citation_title=RColorBrewer: ColorBrewer palettes;citation_author=Erich Neuwirth"/>
  <meta name="citation_reference" content="citation_title=CARTOColors: Data-driven color schemes;citation_author=CARTOColors: Data-driven color schemes"/>
  <meta name="citation_reference" content="citation_title=rcartocolor: CARTOColors palettes;citation_author=Jakub Nowosad"/>
  <meta name="citation_reference" content="citation_title=viridis: Default color maps from matplotlib;citation_author=Simon Garnier"/>
  <meta name="citation_reference" content="citation_title=scico: Colour palettes based on the scientific colour-maps;citation_author=Thomas Lin Pedersen;citation_author=Fabio Crameri"/>
  <meta name="citation_reference" content="citation_title=cols4all: Colors for all;citation_author=Martijn Tennekes"/>
  <meta name="citation_reference" content="citation_title=Polychrome: Creating and assessing qualitative palettes with many colors;citation_volume=90;citation_doi=10.18637/jss.v090.c01;citation_author=Kevin R. Coombes;citation_author=Guy Brock;citation_author=Zachary B. Abrams;citation_author=Lynne V. Abruzzo"/>
  <meta name="citation_reference" content="citation_title=HCL-based color palettes in grDevices;citation_author=Achim Zeileis;citation_author=Paul Murrell"/>
  <meta name="citation_reference" content="citation_title=A new palette() for R;citation_author=Achim Zeileis;citation_author=Paul Murrell;citation_author=Martin Maechler;citation_author=Deepayan Sarkar"/>
  <meta name="citation_reference" content="citation_title=Escaping RGBland: Selecting colors for statistical graphics;citation_volume=53;citation_doi=10.1016/j.csda.2008.11.033;citation_author=Achim Zeileis;citation_author=Kurt Hornik;citation_author=Paul Murrell"/>
  <meta name="citation_reference" content="citation_title=Tableau: Business intelligence and analytics software;citation_author=Tableau: Business intelligence and analytics software"/>
  <meta name="citation_reference" content="citation_title=How we designed the new color palettes in Tableau 10;citation_author=Maureen Stone"/>
  <meta name="citation_reference" content="citation_title=Was Trump confused by rainbow color map?;citation_author=Achim Zeileis;citation_author=Reto Stauffer"/>
  <meta name="citation_reference" content="citation_title=Information visualization: Perception for design;citation_publisher=Morgan Kaufmann;citation_doi=10.1016/C2009-0-62432-6;citation_author=Colin Ware"/>
  <meta name="citation_reference" content="citation_title=Graphical perception: Theory, experimentation, and application to the development of graphical methods;citation_volume=79;citation_doi=10.1080/01621459.1984.10478080;citation_author=William S. Cleveland;citation_author=Robert McGill"/>
  <meta name="citation_reference" content="citation_title=Design2Inform: Information visualisation;citation_publisher=The Office of the Chief Scientific Advisor, Gov UK;citation_author=Maria Dos Santos Lonsdale;citation_author=David Lonsdale"/>
  <meta name="citation_reference" content="citation_title=Affective color in visualization;citation_publisher=Association for Computing Machinery;citation_doi=10.1145/3025453.3026041;citation_author=Lyn Bartram;citation_author=Abhisekh Patra;citation_author=Maureen Stone"/>
  <meta name="citation_reference" content="citation_title=On the role of color in visual saliency;citation_volume=2017;citation_doi=10.2352/ISSN.2470-1173.2017.14.HVEI-119;citation_author=Sergio Etchebehere;citation_author=Elena Fedorovskaya"/>
  <meta name="citation_reference" content="citation_title=wesanderson: A Wes Anderson palette generator;citation_author=Karthik Ram;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=colorblindcheck: Check color palettes for problems with color vision deficiency;citation_author=Jakub Nowosad"/>
  <meta name="citation_reference" content="citation_title=Optimizing colormaps with consideration for color cision deficiency to enable accurate interpretation of scientific data;citation_volume=13;citation_doi=10.1371/journal.pone.0199239;citation_author=Jamie R. Nuñez;citation_author=Christopher R. Anderton;citation_author=Ryan S. Renslow"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","description","preamble","bibliography","date","date_received","journal","volume","issue","subid","slug","packages","draft","output","pdf_url","citation_url","doi","creative_commons","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Coloring in R's Blind Spot"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Achim Zeileis"]},{"type":"character","attributes":{},"value":["Universität Innsbruck"]},{"type":"character","attributes":{},"value":["Department of Statistics"]},{"type":"character","attributes":{},"value":["https://www.zeileis.org/"]},{"type":"character","attributes":{},"value":["0000-0003-0918-3766"]},{"type":"character","attributes":{},"value":["Achim.Zeileis@R-project.org"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Paul Murrell"]},{"type":"character","attributes":{},"value":["University of Auckland"]},{"type":"character","attributes":{},"value":["Department of Statistics"]},{"type":"character","attributes":{},"value":["https://www.stat.auckland.ac.nz/~paul/"]},{"type":"character","attributes":{},"value":["0000-0002-3224-8858"]},{"type":"character","attributes":{},"value":["paul@stat.auckland.ac.nz"]}]}]},{"type":"character","attributes":{},"value":["Prior to version 4.0.0 R had a poor default color palette (using highly saturated red, green, blue, etc.) and provided very few alternative palettes, most of which also had poor perceptual properties (like the infamous rainbow palette). Starting with version 4.0.0 R gained a new and much improved default palette and, in addition, a selection of more than 100 well-established palettes are now available via the functions `palette.colors()` and `hcl.colors()`. The former provides a range of popular qualitative palettes for categorical data while the latter closely approximates many popular sequential and diverging palettes by systematically varying the perceptual hue, chroma, and luminance (HCL) properties in the palette.  This paper provides a mix of contributions including an overview of the new color functions and the palettes they provide along with advice about which palettes are appropriate for specific tasks, especially with regard to making them accessible to viewers with color vision deficiencies."]},{"type":"character","attributes":{},"value":["\\newcommand{\\doi}[1]{\\href{https://doi.org/#1}{\\normalfont\\texttt{doi:\\discretionary{}{}{}{#1}}}}\n\\usepackage{longtable}\n"]},{"type":"character","attributes":{},"value":["color.bib"]},{"type":"character","attributes":{},"value":["2023-12-18"]},{"type":"character","attributes":{},"value":["2023-04-20"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[240]},{"type":"integer","attributes":{},"value":[256]}]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[3]},{"type":"character","attributes":{},"value":["2023-30"]},{"type":"character","attributes":{},"value":["RJ-2023-071"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"NULL"},{"type":"NULL"}]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["RJ-2023-071.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-071"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-071"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{},"value":[]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-071/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["color_files/anchor-4.2.2/anchor.min.js","color_files/bowser-1.9.3/bowser.min.js","color_files/distill-2.2.21/template.v2.js","color_files/figure-html5/Blues3-1.png","color_files/figure-html5/blues3hcl-1.png","color_files/figure-html5/colorcatcont-1.png","color_files/figure-html5/diverPalettes-1.png","color_files/figure-html5/diverxPalettes-1.png","color_files/figure-html5/dorian-1.png","color_files/figure-html5/dorian-2.png","color_files/figure-html5/dorian-3.png","color_files/figure-html5/graphics-1.png","color_files/figure-html5/multiSeqPalettes-1.png","color_files/figure-html5/multiSeqPalettes2-1.png","color_files/figure-html5/newPalettes-1.png","color_files/figure-html5/Okabe-Ito-1.png","color_files/figure-html5/oldPalettes-1.png","color_files/figure-html5/PurpleGreen-1.png","color_files/figure-html5/purplegreen-fall-1.png","color_files/figure-html5/purplegreen-fall-2.png","color_files/figure-html5/qualPalettes-1.png","color_files/figure-html5/R3-1.png","color_files/figure-html5/R4-1.png","color_files/figure-html5/recycle-1.png","color_files/figure-html5/short-1.png","color_files/figure-html5/singleSeqPalettes-1.png","color_files/figure-html5/tsplot-1.png","color_files/figure-html5/unnamed-chunk-7-1.png","color_files/figure-html5/YlGnBu-1.png","color_files/figure-html5/ylgnbu-viridis-1.png","color_files/figure-html5/ylgnbu-viridis-2.png","color_files/figure-latex/Blues3-1.pdf","color_files/figure-latex/blues3hcl-1.pdf","color_files/figure-latex/colorcatcont-1.pdf","color_files/figure-latex/diverPalettes-1.pdf","color_files/figure-latex/diverxPalettes-1.pdf","color_files/figure-latex/dorian-1.pdf","color_files/figure-latex/dorian-2.pdf","color_files/figure-latex/dorian-3.pdf","color_files/figure-latex/graphics-1.pdf","color_files/figure-latex/multiSeqPalettes-1.pdf","color_files/figure-latex/multiSeqPalettes2-1.pdf","color_files/figure-latex/newPalettes-1.pdf","color_files/figure-latex/Okabe-Ito-1.pdf","color_files/figure-latex/oldPalettes-1.pdf","color_files/figure-latex/PurpleGreen-1.pdf","color_files/figure-latex/purplegreen-fall-1.pdf","color_files/figure-latex/purplegreen-fall-2.pdf","color_files/figure-latex/qualPalettes-1.pdf","color_files/figure-latex/R3-1.pdf","color_files/figure-latex/R4-1.pdf","color_files/figure-latex/recycle-1.pdf","color_files/figure-latex/short-1.pdf","color_files/figure-latex/singleSeqPalettes-1.pdf","color_files/figure-latex/tsplot-1.pdf","color_files/figure-latex/unnamed-chunk-7-1.pdf","color_files/figure-latex/YlGnBu-1.pdf","color_files/figure-latex/ylgnbu-viridis-1.pdf","color_files/figure-latex/ylgnbu-viridis-2.pdf","color_files/header-attrs-2.25/header-attrs.js","color_files/jquery-3.6.0/jquery-3.6.0.js","color_files/jquery-3.6.0/jquery-3.6.0.min.js","color_files/jquery-3.6.0/jquery-3.6.0.min.map","color_files/popper-2.6.0/popper.min.js","color_files/tippy-6.2.7/tippy-bundle.umd.min.js","color_files/tippy-6.2.7/tippy-light-border.css","color_files/tippy-6.2.7/tippy.css","color_files/tippy-6.2.7/tippy.umd.min.js","color_files/webcomponents-2.0.0/webcomponents.js","color.bib","color.pdf","color.tex","distill-preview.png","images/dorian-orig-deutan.png","images/dorian-orig.png","images/dorian-reds-deutan.png","images/dorian-reds.png","images/dorian-ylgnbu-deutan.png","images/dorian-ylgnbu.png","preamble.tex","RJ-2023-071_files/figure-html5/Blues3-1.png","RJ-2023-071_files/figure-html5/blues3hcl-1.png","RJ-2023-071_files/figure-html5/colorcatcont-1.png","RJ-2023-071_files/figure-html5/diverPalettes-1.png","RJ-2023-071_files/figure-html5/diverxPalettes-1.png","RJ-2023-071_files/figure-html5/dorian-1.png","RJ-2023-071_files/figure-html5/dorian-2.png","RJ-2023-071_files/figure-html5/dorian-3.png","RJ-2023-071_files/figure-html5/graphics-1.png","RJ-2023-071_files/figure-html5/multiSeqPalettes-1.png","RJ-2023-071_files/figure-html5/multiSeqPalettes2-1.png","RJ-2023-071_files/figure-html5/newPalettes-1.png","RJ-2023-071_files/figure-html5/Okabe-Ito-1.png","RJ-2023-071_files/figure-html5/oldPalettes-1.png","RJ-2023-071_files/figure-html5/PurpleGreen-1.png","RJ-2023-071_files/figure-html5/purplegreen-fall-1.png","RJ-2023-071_files/figure-html5/purplegreen-fall-2.png","RJ-2023-071_files/figure-html5/qualPalettes-1.png","RJ-2023-071_files/figure-html5/R3-1.png","RJ-2023-071_files/figure-html5/R4-1.png","RJ-2023-071_files/figure-html5/recycle-1.png","RJ-2023-071_files/figure-html5/short-1.png","RJ-2023-071_files/figure-html5/singleSeqPalettes-1.png","RJ-2023-071_files/figure-html5/tsplot-1.png","RJ-2023-071_files/figure-html5/unnamed-chunk-7-1.png","RJ-2023-071_files/figure-html5/YlGnBu-1.png","RJ-2023-071_files/figure-html5/ylgnbu-viridis-1.png","RJ-2023-071_files/figure-html5/ylgnbu-viridis-2.png","RJ-2023-071.pdf","RJ-2023-071.Rmd-conv","RJ-2023-071.tex","RJ-2023-071.zip","RJournal.sty","RJwrapper.aux","RJwrapper.tex","Rlogo-5.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").first();
      if (tpar && ! tpar.hasClass("subtitle")) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Coloring in R's Blind Spot","description":"Prior to version 4.0.0 R had a poor default color palette (using highly saturated red, green, blue, etc.) and provided very few alternative palettes, most of which also had poor perceptual properties (like the infamous rainbow palette). Starting with version 4.0.0 R gained a new and much improved default palette and, in addition, a selection of more than 100 well-established palettes are now available via the functions `palette.colors()` and `hcl.colors()`. The former provides a range of popular qualitative palettes for categorical data while the latter closely approximates many popular sequential and diverging palettes by systematically varying the perceptual hue, chroma, and luminance (HCL) properties in the palette.  This paper provides a mix of contributions including an overview of the new color functions and the palettes they provide along with advice about which palettes are appropriate for specific tasks, especially with regard to making them accessible to viewers with color vision deficiencies.","doi":"10.32614/RJ-2023-071","authors":[{"author":"Achim Zeileis","authorURL":"https://www.zeileis.org/","affiliation":"Universität Innsbruck","affiliationURL":"#","orcidID":"0000-0003-0918-3766"},{"author":"Paul Murrell","authorURL":"https://www.stat.auckland.ac.nz/~paul/","affiliation":"University of Auckland","affiliationURL":"#","orcidID":"0000-0002-3224-8858"}],"publishedDate":"2023-12-18T00:00:00.000+00:00","citationText":"Zeileis & Murrell, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-2">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Coloring in R’s Blind Spot</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Prior to version 4.0.0 R had a poor default color palette (using highly saturated red, green, blue, etc.) and provided very few alternative palettes, most of which also had poor perceptual properties (like the infamous rainbow palette). Starting with version 4.0.0 R gained a new and much improved default palette and, in addition, a selection of more than 100 well-established palettes are now available via the functions <code>palette.colors()</code> and <code>hcl.colors()</code>. The former provides a range of popular qualitative palettes for categorical data while the latter closely approximates many popular sequential and diverging palettes by systematically varying the perceptual hue, chroma, and luminance (HCL) properties in the palette. This paper provides a mix of contributions including an overview of the new color functions and the palettes they provide along with advice about which palettes are appropriate for specific tasks, especially with regard to making them accessible to viewers with color vision deficiencies.</p></p>
</div>

<div class="d-byline">
  Achim Zeileis <a href="https://www.zeileis.org/" class="uri">https://www.zeileis.org/</a> (Universität Innsbruck)
  
,   Paul Murrell <a href="https://www.stat.auckland.ac.nz/~paul/" class="uri">https://www.stat.auckland.ac.nz/~paul/</a> (University of Auckland)
  
<br/>2023-12-18
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Color can be a very effective way to distinguish between different groups
within a data visualization. Color is a “preattentive” visual feature,
meaning that groups are identified rapidly and without conscious effort
<span class="citation" data-cites="Ware:2012">(<a href="#ref-Ware:2012" role="doc-biblioref">Ware 2012</a>)</span>. For example, it is trivial to identify the
two groups of points in the scatterplot in Figure <a href="#fig:colorcatcont">1</a>.</p>
<p>Employing color to represent values on a continuous numeric scale will be
less successful <span class="citation" data-cites="Cleveland+McGill:1984">(<a href="#ref-Cleveland+McGill:1984" role="doc-biblioref">Cleveland and McGill 1984</a>)</span>, but color can
still be useful to convey additional variables when more effective
visual features, such as location, have already been used. For example,
color might be used to fill in different regions on a map, as
demonstrated in the right hand plot of Figure <a href="#fig:colorcatcont">1</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:colorcatcont"></span>
<img src="RJ-2023-071_files/figure-html5/colorcatcont-1.png" alt="Typical usage of color for coding qualitative/categorical information (left) and quantitative/continuous information (right). Left: Scatter plot of weekly gas consumption by outside temperature before and after installing house insulation. Right: Choropleth map of median income in the 16 regions of New Zealand in 2018." width="100%" />
<p class="caption">
Figure 1: Typical usage of color for coding qualitative/categorical information (left) and quantitative/continuous information (right). Left: Scatter plot of weekly gas consumption by outside temperature before and after installing house insulation. Right: Choropleth map of median income in the 16 regions of New Zealand in 2018.
</p>
</div>
</div>
<p>R provides several ways to specify a color: by name (e.g., <code>"red"</code>);
by hexadecimal RGB code (e.g., <code>"#FF0000"</code>); or by integer (e.g., <code>2</code>).
When we specify an integer, that provides an index into a
default set of colors; the color <code>2</code>
means the second color in the default set of colors.</p>
<p>However, a more important task than specifying one particular color
is the task of specifying a set of colors to use in combination
with each other.
For example, in the left panel of Figure <a href="#fig:colorcatcont">1</a>,
we need two colors
that are very easily perceived as different from each other.
In the right panel of Figure <a href="#fig:colorcatcont">1</a>,
we require a set of colors
that appear to change monotonically, e.g., from darker to lighter.</p>
<p>We call this the problem of selecting a good <em>palette</em> of colors.
What we need to generate is a vector of R colors, e.g.,
<code>c("red", "blue")</code>, <code>c("#FF0000", "#0000FF")</code>, or <code>c(2, 4)</code>.</p>
<h2 data-number="2" id="a-brief-history-of-r-palettes"><span class="header-section-number">2</span> A brief history of R palettes</h2>
<p>Early versions of R provided very few functions for choosing colors from readily available palettes. The palettes
that were provided, although standard at the time they were implemented,
have meanwhile
been widely recognized as being rather poor.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:oldPalettes"></span>
<img src="RJ-2023-071_files/figure-html5/oldPalettes-1.png" alt="Old base R palettes.  At top left is the old default palette (prior to version 4.0.0), consisting largely of highly saturated primary colors or combinations thereof.  Below that is the rainbow palette of different highly saturated hues.  The middle column shows the old sequential palettes, with heat colors again being highly saturated.  The last column shows an old diverging palette plus two palettes motivated by shadings of geographic maps." width="100%" />
<p class="caption">
Figure 2: Old base R palettes. At top left is the old default palette (prior to version 4.0.0), consisting largely of highly saturated primary colors or combinations thereof. Below that is the rainbow palette of different highly saturated hues. The middle column shows the old sequential palettes, with heat colors again being highly saturated. The last column shows an old diverging palette plus two palettes motivated by shadings of geographic maps.
</p>
</div>
</div>
<p>The <code>palette()</code> function generates a vector of eight colors.
These provide the default set of colors that an integer color specification selects from
and can be used for coding <em>categorical</em> information.
The output below shows what R produced prior to version 4.0.0, along with a
<em>swatch</em> of color circles.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;black&quot;   &quot;red&quot;     &quot;green3&quot;  &quot;blue&quot;    &quot;cyan&quot;    &quot;magenta&quot;
[7] &quot;yellow&quot;  &quot;gray&quot;   </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/R3-1.png" width="100%" /></p>
</div>
<p>Figure <a href="#fig:oldPalettes">2</a>
depicts this old default <code>palette()</code> (top-left) along
with other old base R palettes using swatches of circles or
rectangles that are filled with the
corresponding colors. The other palette functions all take an argument <code>n</code> to generate
that number of colors (possibly along with further arguments that allow for
certain customizations):</p>
<ul>
<li><code>heat.colors()</code>, <code>terrain.colors()</code>, <code>topo.colors()</code>, and <code>gray.colors()</code>
can be used as <em>sequential</em> palettes for ordered or numeric information.</li>
<li><code>cm.colors()</code> can be used as a <em>diverging</em> palette for values that are
distributed around a “neutral” value, such as zero.</li>
<li><code>rainbow()</code> implements the infamous rainbow (or “jet”) palette
that was widely used (possibly with restrictions of the hue range)
for all types of variables: <em>categorical</em>, <em>sequential</em>, and <em>diverging</em>.</li>
</ul>
<p>All of these palettes – except <code>gray.colors()</code> – have poor perceptual properties.
The colors are highly saturated, which can be distracting and overly
stimulating, and the colors are unbalanced with respect to chroma and luminance,
which means that they have unequal visual impact
<span class="citation" data-cites="Lonsdale+Lonsdale:2019 Bartram+Patra+Stone:2017 Etchebehere+Fedorovskaya:2017">(<a href="#ref-Bartram+Patra+Stone:2017" role="doc-biblioref">Bartram et al. 2017</a>; <a href="#ref-Etchebehere+Fedorovskaya:2017" role="doc-biblioref">Etchebehere and Fedorovskaya 2017</a>; <a href="#ref-Lonsdale+Lonsdale:2019" role="doc-biblioref">Lonsdale and Lonsdale 2019</a>)</span>.
In addition, the palettes do not perform well for viewers with some form
of colorblindness <span class="citation" data-cites="Ware:2012">(about 10% of the male population, <a href="#ref-Ware:2012" role="doc-biblioref">Ware 2012</a>)</span>.
Most of the palettes also use sequences
of hues obtained in the RGB (red-green-blue) space or simple derivations thereof like HSV (hue-saturation-value) or HLS (hue-lightness-saturation),
which leads to clustering of colors at the red, green, and blue primaries.</p>
<p>Although these limitations have been well known for some time, no changes
were made to these palettes provided by the core R graphics system for
a number of years. There were various reasons for this including the following:</p>
<ul>
<li><p>In R version 2.1.0, Thomas Lumley added the <code>colorRampPalette()</code> function.
This made it easier to generate a palette, though the user is still required
to select, for example, start and end colors from which
a palette of colors can then be interpolated.</p></li>
<li><p>Better palettes became available via packages on CRAN
(Comprehensive R Archive Network)
starting with <a href="https://cran.r-project.org/package=RColorBrewer">RColorBrewer</a> <span class="citation" data-cites="RColorBrewer">(<a href="#ref-RColorBrewer" role="doc-biblioref">Neuwirth 2022</a>, first published on CRAN in 2002)</span>,
later
<a href="https://cran.r-project.org/package=colorspace">colorspace</a> <span class="citation" data-cites="Ihaka:2003 Zeileis+Hornik+Murrell:2009">(<a href="#ref-Ihaka:2003" role="doc-biblioref">Ihaka 2003</a>; <a href="#ref-Zeileis+Hornik+Murrell:2009" role="doc-biblioref">Zeileis et al. 2009</a>)</span>, and
more recently
<a href="https://cran.r-project.org/package=viridis">viridis</a> <span class="citation" data-cites="viridis">(<a href="#ref-viridis" role="doc-biblioref">Garnier 2023</a>)</span>, <a href="https://cran.r-project.org/package=rcartocolor">rcartocolor</a> <span class="citation" data-cites="rcartocolor">(<a href="#ref-rcartocolor" role="doc-biblioref">Nowosad 2023b</a>)</span>,
<a href="https://cran.r-project.org/package=scico">scico</a> <span class="citation" data-cites="scico">(<a href="#ref-scico" role="doc-biblioref">Pedersen and Crameri 2023</a>)</span>, and
<a href="https://cran.r-project.org/package=cols4all">cols4all</a> <span class="citation" data-cites="cols4all">(<a href="#ref-cols4all" role="doc-biblioref">Tennekes 2023</a>)</span>,
among many others. In most cases, these make palettes available in R that
were developed elsewhere, e.g.,
<a href="https://ColorBrewer2.org/">ColorBrewer.org</a> <span class="citation" data-cites="Harrower+Brewer:2003">(<a href="#ref-Harrower+Brewer:2003" role="doc-biblioref">Harrower and Brewer 2003</a>)</span>,
<a href="https://carto.com/carto-colors/">CARTOColors</a> <span class="citation" data-cites="CARTOColor">(<a href="#ref-CARTOColor" role="doc-biblioref">CARTO 2023</a>)</span>,
the <a href="https://www.fabiocrameri.ch/colourmaps/">scientific color maps</a> of <span class="citation" data-cites="Crameri+Shephard+Heron:2020">Crameri et al. (<a href="#ref-Crameri+Shephard+Heron:2020" role="doc-biblioref">2020</a>)</span>,
and the Viridis palettes for matplotlib in Python <span class="citation" data-cites="Smith+VanDerWalt:2015">(<a href="#ref-Smith+VanDerWalt:2015" role="doc-biblioref">Smith and Van der Walt 2015</a>)</span>.</p></li>
<li><p>Higher-level graphics systems
like <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span> and <a href="https://cran.r-project.org/package=lattice">lattice</a> <span class="citation" data-cites="lattice">(<a href="#ref-lattice" role="doc-biblioref">Sarkar 2008</a>)</span>
developed their own color themes.</p></li>
</ul>
<h2 data-number="3" id="a-new-set-of-r-palettes"><span class="header-section-number">3</span> A new set of R palettes</h2>
<p>On the road to R version 4.0.0 an attempt was made to
address the limited and deficient set of palettes in base R
and to add a range of modern color palettes.
In particular, <code>palette()</code> has a new improved default color palette,
<code>palette.colors()</code> provides further well-established qualitative palettes <span class="citation" data-cites="grDevices2">(<a href="#ref-grDevices2" role="doc-biblioref">Zeileis et al. 2019</a>)</span>, and
<code>hcl.colors()</code> provides a wide range of qualitative, sequential, and diverging palettes obtained by a standardized approach in
the so-called HCL (hue-chroma-luminance) space <span class="citation" data-cites="Wiki+HCL">(<a href="#ref-Wiki+HCL" role="doc-biblioref">Wikipedia 2023</a>)</span>; see <span class="citation" data-cites="grDevices">Zeileis and Murrell (<a href="#ref-grDevices" role="doc-biblioref">2019</a>)</span> and <span class="citation" data-cites="Zeileis+Fisher+Hornik:2020">Zeileis et al. (<a href="#ref-Zeileis+Fisher+Hornik:2020" role="doc-biblioref">2020</a>)</span>.</p>
<h3 data-number="3.1" id="a-new-default-color-palette"><span class="header-section-number">3.1</span> A new default color <code>palette()</code></h3>
<p>The default color palette in R – the default set of colors that can
be specified by integer index – has been replaced. The new palette
follows the same basic hues as the old default palette, but
the palette is less saturated overall and
reduces the size of changes in chroma and luminance across the palette.
This produces a calmer and less distracting palette with a more
even visual impact.
An attempt has also been made to improve the discriminability
of the colors in the default palette for colorblind viewers.
The output (and swatches) below show what R produces from version 4.0.0
onwards.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;black&quot;   &quot;#DF536B&quot; &quot;#61D04F&quot; &quot;#2297E6&quot; &quot;#28E2E5&quot; &quot;#CD0BBC&quot;
[7] &quot;#F5C710&quot; &quot;gray62&quot; </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/R4-1.png" width="100%" /></p>
</div>
<h3 data-number="3.2" id="the-palette.colors-function"><span class="header-section-number">3.2</span> The <code>palette.colors()</code> function</h3>
<p>The <code>palette.colors()</code> function, new in R 4.0.0, provides a way to
access several other predefined palettes
(see also Figure <a href="#fig:newPalettes">7</a>).
All of these are <em>qualitative palettes</em> so they are appropriate for
encoding qualitative (categorical) variables. In other words,
these palettes are appropriate for differentiating between groups.
By default <code>palette.colors()</code> returns the
<code>"Okabe-Ito"</code> <span class="citation" data-cites="Okabe+Ito:2008">(<a href="#ref-Okabe+Ito:2008" role="doc-biblioref">Okabe and Ito 2008</a>)</span> palette.
This palette
was designed to be very robust under color vision deficiencies, so
the different colors in this palette should be easily distinguishable
for all viewers.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.colors</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;#000000&quot; &quot;#E69F00&quot; &quot;#56B4E9&quot; &quot;#009E73&quot; &quot;#F0E442&quot; &quot;#0072B2&quot;
[7] &quot;#D55E00&quot; &quot;#CC79A7&quot; &quot;#999999&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/Okabe-Ito-1.png" width="100%" /></p>
</div>
<p>The first argument to <code>palette.colors()</code> is a number of colors.
Each palette has a fixed number of colors, but we can ask for fewer or,
with <code>recycle = TRUE</code>, we can get more colors by recycling.
For example, the following code just requests the first four colors
from the <code>"Okabe-Ito"</code> palette.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.colors</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;#000000&quot; &quot;#E69F00&quot; &quot;#56B4E9&quot; &quot;#009E73&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/short-1.png" width="100%" /></p>
</div>
<p>Note that up to R version 4.2.x some <code>palette.colors()</code>, including <code>"Okabe-Ito"</code>,
provide <em>named</em> output but starting from 4.3.0 all output is unnamed by default.</p>
<p>The following code requests ten colors from the <code>"Okabe-Ito"</code> palette.
That palette only contains nine colors, but because <code>recycle = TRUE</code>,
a tenth color is provided by recycling the first color (black) from the palette.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.colors</a></span><span class='op'>(</span><span class='fl'>10</span>, recycle <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> [1] &quot;#000000&quot; &quot;#E69F00&quot; &quot;#56B4E9&quot; &quot;#009E73&quot; &quot;#F0E442&quot; &quot;#0072B2&quot;
 [7] &quot;#D55E00&quot; &quot;#CC79A7&quot; &quot;#999999&quot; &quot;#000000&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/recycle-1.png" width="100%" /></p>
</div>
<p>The second argument to <code>palette.colors()</code> is the palette to select colors
from. For example, the following code requests the first four colors
from the <code>"R4"</code> palette (the new default in <code>palette()</code>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.colors</a></span><span class='op'>(</span><span class='fl'>4</span>, palette <span class='op'>=</span> <span class='st'>"R4"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;#000000&quot; &quot;#DF536B&quot; &quot;#61D04F&quot; &quot;#2297E6&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/unnamed-chunk-7-1.png" width="100%" /></p>
</div>
<h3 data-number="3.3" id="the-hcl.colors-function"><span class="header-section-number">3.3</span> The <code>hcl.colors()</code> function</h3>
<p>The <code>hcl.colors()</code> function was added in R 3.6.0, with the range
of supported palettes slowly expanded over time.
This function provides access to another range of palettes,
including sequential and diverging palettes
for representing continuous variables.
As with <code>palette.colors()</code>, the first
argument is a number of colors to generate and the second
specifies a palette to generate colors from.
The <code>hcl.pals()</code> function provides a full list of the
available palette names that we can choose from.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>hcl.colors</a></span><span class='op'>(</span><span class='fl'>8</span>, palette <span class='op'>=</span> <span class='st'>"Blues 3"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;#00366C&quot; &quot;#005893&quot; &quot;#007BC0&quot; &quot;#5E9BD8&quot; &quot;#91BAEB&quot; &quot;#BAD5FA&quot;
[7] &quot;#DDECFF&quot; &quot;#F9F9F9&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/Blues3-1.png" width="100%" /></p>
</div>
<p>One difference with <code>hcl.colors()</code> is that the palette we are
selecting colors from is <em>not</em> a fixed set of colors. Instead,
the palettes in <code>hcl.colors()</code> are a path within HCL colorspace. For each
dimension – hue, chroma, and luminance – a palette can have a constant
value, a monotonic trajectory, or a triangular trajectory. For
example, the trajectories for the <code>"Blues 3"</code> palette are shown in
Figure <a href="#fig:blues3hcl">3</a>. The palette is (almost) constant in the hue
dimension yielding different shades of (almost) the same blue.
The palette is monotonically increasing in the luminance dimension, so
the blues vary from very dark to very light. Finally, the palette has a
triangular trajectory in the chroma dimension, so the blues are more
colorful towards the middle of the palette.
The trajectories do not involve exactly straight lines
because in some cases a power curve is employed and in other cases
the palette has to be adjusted to remain within the range of
representable colours – see <span class="citation" data-cites="Zeileis+Hornik+Murrell:2009">Zeileis et al. (<a href="#ref-Zeileis+Hornik+Murrell:2009" role="doc-biblioref">2009</a>)</span> and <span class="citation" data-cites="colorspace">Ihaka et al. (<a href="#ref-colorspace" role="doc-biblioref">2023</a>)</span>
for more details.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:blues3hcl"></span>
<img src="RJ-2023-071_files/figure-html5/blues3hcl-1.png" alt="Hue, chroma, and luminance paths for the `&quot;Blues 3&quot;` palette. This plot is created by the `colorspace::specplot()` function.  We can see that hue is held constant in this palette, while luminance increases monotonically and chroma peaks towards the middle of the palette." width="49%" />
<p class="caption">
Figure 3: Hue, chroma, and luminance paths for the <code>"Blues 3"</code> palette. This plot is created by the <code>colorspace::specplot()</code> function. We can see that hue is held constant in this palette, while luminance increases monotonically and chroma peaks towards the middle of the palette.
</p>
</div>
</div>
<p>Because the palettes from <code>hcl.colors()</code> are based on a continuous
path in HCL space, we can select as many colors as we like.
For example,
the following code generates five colors from the multi-hue sequential
palette <code>"YlGnBu"</code> (see also Figure <a href="#fig:ylgnbu-viridis">6</a>)
and nine colors from the diverging palette <code>"Purple-Green"</code>
(see also Figure <a href="#fig:purplegreen-fall">12</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>hcl.colors</a></span><span class='op'>(</span><span class='fl'>5</span>, palette <span class='op'>=</span> <span class='st'>"YlGnBu"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;#26185F&quot; &quot;#007EB3&quot; &quot;#18BDB0&quot; &quot;#BCE9C5&quot; &quot;#FCFFDD&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/YlGnBu-1.png" width="100%" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>hcl.colors</a></span><span class='op'>(</span><span class='fl'>9</span>, palette <span class='op'>=</span> <span class='st'>"Purple-Green"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;#492050&quot; &quot;#90529C&quot; &quot;#C490CF&quot; &quot;#E4CAE9&quot; &quot;#F1F1F1&quot; &quot;#BCDABC&quot;
[7] &quot;#72B173&quot; &quot;#2C792D&quot; &quot;#023903&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2023-071_files/figure-html5/PurpleGreen-1.png" width="100%" /></p>
</div>
<h3 data-number="3.4" id="illustrations"><span class="header-section-number">3.4</span> Illustrations</h3>
<p>To illustrate the benefits of the new color palettes,
Figure <a href="#fig:tsplot">4</a> shows several versions of a time series plot,
depicting four different European stock indexes during most of the 1990s
(<code>EuStockMarkets</code> data). The plots compare
the old <code>"R3"</code> default palette with
the new <code>"R4"</code> default and the new qualitative palette
<code>"Okabe-Ito"</code>.
These can all be selected using <code>palette.colors()</code>.
The first row shows the <code>"R3"</code> default using a typical color legend in the top left corner;
the second column shows an emulation of a kind of red-green
color blindness known as deuteranopia using the <a href="#">colorspace</a> package
<span class="citation" data-cites="Machado+Oliveira+Fernandes:2009">(based on <a href="#ref-Machado+Oliveira+Fernandes:2009" role="doc-biblioref">Machado et al. 2009</a>)</span>.
The second row uses the <code>"R4"</code> palette and the third row
uses <code>"Okabe-Ito"</code>; both with direct labels for the different time series instead of
a color legend.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tsplot"></span>
<img src="RJ-2023-071_files/figure-html5/tsplot-1.png" alt="Time series line plot of `EuStockMarkets`. Rows: Old `&quot;R3&quot;` default palette (top), new `&quot;R4&quot;` default palette (middle), `&quot;OkabeIto&quot;` palette (bottom), designed to be robust under color vision deficiencies. Columns: Normal vision (left) and emulated deuteranope vision (right). A color legend is used in the first row and direct labels in the other rows." width="100%" />
<p class="caption">
Figure 4: Time series line plot of <code>EuStockMarkets</code>. Rows: Old <code>"R3"</code> default palette (top), new <code>"R4"</code> default palette (middle), <code>"OkabeIto"</code> palette (bottom), designed to be robust under color vision deficiencies. Columns: Normal vision (left) and emulated deuteranope vision (right). A color legend is used in the first row and direct labels in the other rows.
</p>
</div>
</div>
<p>We can see that the <code>"R3"</code> colors are highly saturated and they vary in
luminance. For example, the yellow line is noticeably lighter than the others.
Futhermore, for deuteranope viewers, the DAX and the SMI lines are difficult to
distinguish from each other (exacerbated by the use of a color legend that makes
matching the lines to labels almost impossible). Moreover, the FTSE line is more
difficult to distinguish from the white background, compared to the other lines.</p>
<p>The <code>"R4"</code> palette is an improvement: the luminance is more even and
the colors are less saturated, plus the colors are more distinguishable for
deuteranope viewers (aided by the use of direct color labels instead of a legend).
The <code>"Okabe-Ito"</code> palette works even better, particularly for deuteranope viewers.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dorian"></span>
<img src="RJ-2023-071_files/figure-html5/dorian-1.png" alt="Probability of wind speeds $&gt;$ 39 mph (63 km h$^{-1}$) during hurricane Dorian in 2019. On the left is the the original image (top row) and two reproductions using the `&quot;Reds&quot;` (middle) and `&quot;YlGnBu&quot;` (bottom) sequential palettes. On the right are emulations of how the images on the left might appear to a colorblind viewer." width="100%" /><img src="RJ-2023-071_files/figure-html5/dorian-2.png" alt="Probability of wind speeds $&gt;$ 39 mph (63 km h$^{-1}$) during hurricane Dorian in 2019. On the left is the the original image (top row) and two reproductions using the `&quot;Reds&quot;` (middle) and `&quot;YlGnBu&quot;` (bottom) sequential palettes. On the right are emulations of how the images on the left might appear to a colorblind viewer." width="100%" /><img src="RJ-2023-071_files/figure-html5/dorian-3.png" alt="Probability of wind speeds $&gt;$ 39 mph (63 km h$^{-1}$) during hurricane Dorian in 2019. On the left is the the original image (top row) and two reproductions using the `&quot;Reds&quot;` (middle) and `&quot;YlGnBu&quot;` (bottom) sequential palettes. On the right are emulations of how the images on the left might appear to a colorblind viewer." width="100%" />
<p class="caption">
Figure 5: Probability of wind speeds <span class="math inline">\(&gt;\)</span> 39 mph (63 km h<span class="math inline">\(^{-1}\)</span>) during hurricane Dorian in 2019. On the left is the the original image (top row) and two reproductions using the <code>"Reds"</code> (middle) and <code>"YlGnBu"</code> (bottom) sequential palettes. On the right are emulations of how the images on the left might appear to a colorblind viewer.
</p>
</div>
</div>
<p>To illustrate an application of the new sequential color palettes
for use with continuous data,
Figure <a href="#fig:dorian">5</a> shows several versions of a weather
map that was produced by the National Oceanic and Atmospheric Administration
<span class="citation" data-cites="Zeileis+Stauffer:2019">(and infamously misinterpreted by a former President of The United States, see <a href="#ref-Zeileis+Stauffer:2019" role="doc-biblioref">Zeileis and Stauffer 2019</a>)</span>.
The top row shows the original image along with an emulation of
deuteranopia in the second column.
The middle row uses the sequential palette
<code>"Reds"</code> that can be selected using <code>hcl.colors()</code> and the
bottom row uses the sequential palette <code>"YlGnBu"</code>, which is also
available via <code>hcl.colors()</code>.</p>
<p>The weather map is intended to convey
the probability of wind speeds <span class="math inline">\(&gt;\)</span> 39 mph
during hurricane Dorian, 2019-08-30–2019-09-04. The probabilities are highest
in the central magenta region and lowest in the outer green regions.
The original image does not convey the information very well because
there is a non-monotonic change in luminance
(from dark to light and back to dark); the high saturation across
all of the colors is also distracting. These issues persist for
deuteranope viewers, plus any benefit of a red (danger!) to green (safe)
change in hue is lost.</p>
<p>The <code>"Reds"</code> version of the image conveys the information more clearly
by relating the monotonic changes in probability to monotonic
changes in luminance. Hue is fairly constant in this palette and
the saturation peaks towards the middle, which is similar to the
<code>"Blues 3"</code> palette shown in
Figure <a href="#fig:blues3hcl">3</a>, just with a different narrow range of hues.
The deuteranope version retains this advantage.</p>
<p>The <code>"YlGnBu"</code> version of the image is also more effective than
the original. This palette employs a much broader range of hues and varies
chroma along with luminances so that the dark colors have higher chroma and
the light colors lower chroma
(see Figure <a href="#fig:ylgnbu-viridis">6</a>). This still clearly conveys
the order from light to dark but additionally yields more distinguishable
colors, making it easier to associate contour bands with the legend.
Note that the <code>"YlGnBu"</code> palette is similar to the very popular
<code>"Viridis"</code> palette (also shown in Figure <a href="#fig:ylgnbu-viridis">6</a>
on the right), with almost the same hue and luminance trajectories.
However, an important advantage of the <code>"YlGnBu"</code> palette in this
visualization is that the light colors have low chroma and thus signal
low risk better than the light colors in the <code>"Viridis"</code> palette which
have very high chroma. Finally, we remark that the <code>"YlGnBu"</code> version
does lose the benefit of red (danger!) at high probabilities;
an alternative would be to use the <code>"Purple-Yellow"</code> multi-hue palette
instead, a variation of which was used by <span class="citation" data-cites="Zeileis+Stauffer:2019">Zeileis and Stauffer (<a href="#ref-Zeileis+Stauffer:2019" role="doc-biblioref">2019</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ylgnbu-viridis"></span>
<img src="RJ-2023-071_files/figure-html5/ylgnbu-viridis-1.png" alt="Hue, chroma, and luminance paths for the `&quot;YlGnBu&quot;` (left) and `&quot;Viridis&quot;` (right) palettes. These plots are created by the `colorspace::specplot()` function. For `&quot;YlGnBu&quot;` we can see that hue changes from blue to yellow, luminance increases monotonically, and chroma has a small peak in the blue range and then decreases with luminance. `&quot;Viridis&quot;`, on the other hand, has almost the same trajectory for both hue and luminance, but chroma increases for the light colors." width="49%" /><img src="RJ-2023-071_files/figure-html5/ylgnbu-viridis-2.png" alt="Hue, chroma, and luminance paths for the `&quot;YlGnBu&quot;` (left) and `&quot;Viridis&quot;` (right) palettes. These plots are created by the `colorspace::specplot()` function. For `&quot;YlGnBu&quot;` we can see that hue changes from blue to yellow, luminance increases monotonically, and chroma has a small peak in the blue range and then decreases with luminance. `&quot;Viridis&quot;`, on the other hand, has almost the same trajectory for both hue and luminance, but chroma increases for the light colors." width="49%" />
<p class="caption">
Figure 6: Hue, chroma, and luminance paths for the <code>"YlGnBu"</code> (left) and <code>"Viridis"</code> (right) palettes. These plots are created by the <code>colorspace::specplot()</code> function. For <code>"YlGnBu"</code> we can see that hue changes from blue to yellow, luminance increases monotonically, and chroma has a small peak in the blue range and then decreases with luminance. <code>"Viridis"</code>, on the other hand, has almost the same trajectory for both hue and luminance, but chroma increases for the light colors.
</p>
</div>
</div>
<p>The following sections describe the full range of
new color palettes in more detail. A much more condensed
overview of the new functions and palettes that are available and
some suggestions for robust default palettes are given in
Section <a href="#sec:summary">6</a>.</p>
<h2 data-number="4" id="a-gallery-of-palettes"><span class="header-section-number">4</span> A gallery of palettes</h2>
<p>This section goes through all of the color palettes that are now
available in base R (without using any additional packages).
There is some discussion of the background for the palettes,
strengths and weaknesses of different palettes, and
appropriate uses of the palettes.</p>
<h3 data-number="4.1" id="the-palette.colors-function-1"><span class="header-section-number">4.1</span> The <code>palette.colors()</code> function</h3>
<p>The <code>palette.colors()</code> function provides a range of qualitative palettes (see
Figure <a href="#fig:newPalettes">7</a> for an overview).
The first argument to the <code>palette.colors()</code> function specifies
the number of colors to return and
the <code>palette</code> argument allows us to select the palette of colors
to choose from. As previously mentioned, the default palette
is <code>"Okabe-Ito"</code>, which has very good perceptual properties.
The <code>"R4"</code> palette specifies the new R default palette
which is also returned by <code>palette()</code> by default.
As previously mentioned, this was constructed to have
reasonable perceptual properties, including accommodation for
color vision deficiencies <span class="citation" data-cites="grDevices2">(see <a href="#ref-grDevices2" role="doc-biblioref">Zeileis et al. 2019</a> for more details)</span>.
The accompanying <code>palette.pals()</code> function returns a character
vector of the available palette names.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:newPalettes"></span>
<img src="RJ-2023-071_files/figure-html5/newPalettes-1.png" alt="New qualitative palettes in base R available from the `palette.colors()` function.  The label above each swatch shows the argument to provide to `palette.colors()` to produce the set of colors.  The palette at top-left is the new default that is also produced by `palette()`.  The `&quot;Okabe-Ito&quot;` palette is the default that is produced by `palette.colors()` (with no arguments)." width="100%" />
<p class="caption">
Figure 7: New qualitative palettes in base R available from the <code>palette.colors()</code> function. The label above each swatch shows the argument to provide to <code>palette.colors()</code> to produce the set of colors. The palette at top-left is the new default that is also produced by <code>palette()</code>. The <code>"Okabe-Ito"</code> palette is the default that is produced by <code>palette.colors()</code> (with no arguments).
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.pals</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> [1] &quot;R3&quot;              &quot;R4&quot;              &quot;ggplot2&quot;        
 [4] &quot;Okabe-Ito&quot;       &quot;Accent&quot;          &quot;Dark 2&quot;         
 [7] &quot;Paired&quot;          &quot;Pastel 1&quot;        &quot;Pastel 2&quot;       
[10] &quot;Set 1&quot;           &quot;Set 2&quot;           &quot;Set 3&quot;          
[13] &quot;Tableau 10&quot;      &quot;Classic Tableau&quot; &quot;Polychrome 36&quot;  
[16] &quot;Alphabet&quot;       </code></pre>
</div>
<p>Each of the predefined palettes can be set as the default palette by passing
the palette name to the <code>palette()</code> function. For example,
the following code sets the Okabe-Ito palette as the default palette.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette</a></span><span class='op'>(</span><span class='st'>"Okabe-Ito"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>There are several palettes that have been taken from the color schemes of
the <a href="#">ggplot2</a> package and Tableau <span class="citation" data-cites="Tableau">(<a href="#ref-Tableau" role="doc-biblioref">Tableau Software, LLC 2021</a>)</span>, both
well-established graphics systems.<br />
The <code>"Tableau 10"</code> palette
represents the redesign of the default palette in Tableau <span class="citation" data-cites="Stone:2016">(<a href="#ref-Stone:2016" role="doc-biblioref">Stone 2016</a>)</span>.
These palettes may be useful
to emulate the look and feel of plots from those other systems.</p>
<p>Several palettes come from ColorBrewer.org <span class="citation" data-cites="Harrower+Brewer:2003">(<a href="#ref-Harrower+Brewer:2003" role="doc-biblioref">Harrower and Brewer 2003</a>)</span> and
were originally designed for filling regions on maps. However, they
are also useful for filling regions within data visualizations like bar plots,
density plots, and heatmaps, among others.
Two of these palettes are a bit different because
they deliberately contain darker and lighter colors:
the <code>"Accent"</code> palette may be useful to emphasize one or more categories
over the others;
the <code>"Paired"</code> palette may be useful to represent more than one
categorical variable via color, e.g., different types of treatment
as well as high vs. low levels of each treatment.</p>
<p>Finally, there are two palettes from the
<a href="https://cran.r-project.org/package=Polychrome">Polychrome</a> package <span class="citation" data-cites="Polychrome">(<a href="#ref-Polychrome" role="doc-biblioref">Coombes et al. 2019</a>)</span>.
These are much larger palettes, with colors chosen to be evenly
spread throughout HCL colorspace. The <code>"Polychrome 36"</code> palette
represents the largest set of colors that could be generated
while still being visually distinguishable. The <code>"Alphabet"</code>
palette is a smaller, but still large, set (one for each letter
of the alphabet). These palettes
may be useful if we are attempting to represent a very large
number of categories at once. The result is unlikely to be
easy to interpret, but these palettes will provide the best chance.</p>
<h3 data-number="4.2" id="the-hcl.colors-function-1"><span class="header-section-number">4.2</span> The <code>hcl.colors()</code> function</h3>
<p>The <code>hcl.colors()</code> function provides
qualitative, sequential, and diverging palettes that are derived from
certain trajectories of the perceptual properties – hue, chroma, and luminance
(HCL). Most of the resulting palettes have one
or more desirable perceptual properties:</p>
<ul>
<li><strong>Colorblind-safe:</strong> This means that the palette retains
its perceptual properties for colorblind users.</li>
<li><strong>Perceptual order:</strong> This means that there is a perceived ordering
of the colors, typically arising from a monotonic change from
light to dark or vice versa.</li>
<li><strong>Perceptual uniformity:</strong> This means that if we take a small step along
the path of the palette in HCL space, the perceived difference
between the two colors will be the same anywhere along the path.</li>
<li><strong>Perceptual balance:</strong> This means that, for example,
while there are changes in hue and chroma, luminance remains
pretty much the same, so no color stands out from the others.</li>
</ul>
<p>These properties are very difficult to achieve in
a single palette, which is one reason why there are multiple palettes
available. Furthermore, different properties will be more or less
important depending on the data being displayed and the point that
a data visualization is attempting to make. For example, perceptual
balance is not desirable when we want to highlight a particular
point or category of interest; in that scenario we explicitly
want some colors to have a greater visual impact than others.
The choice of palette may also depend on how many colors are needed. For
example, a palette with a light gray, a medium color, and a full color may still
work effectively on a white background if the
light gray group is less important and
is just provided in the background for
reference.</p>
<p>Perceptual order and colorblind-safety are closely linked
because the easiest approach to obtaining
a colorblind-safe palette is by using a monotonic
change in luminance. All of the sequential palettes in <code>hcl.colors()</code> in
fact have this property and are colorblind-safe to a certain degree, though
the effectiveness
depends on the range of luminance within the palette.
A quick way to check a palette for colorblind-safety is via
<code>colorspace::swatchplot(pal, cvd = TRUE)</code>, where <code>pal</code> is a palette of colors.
More elaborate tools
are provided by the package <a href="https://cran.r-project.org/package=colorblindcheck">colorblindcheck</a> <span class="citation" data-cites="colorblindcheck">(<a href="#ref-colorblindcheck" role="doc-biblioref">Nowosad 2023a</a>)</span>.</p>
<p>The <a href="https://cran.r-project.org/package=colorspace">colorspace</a> package also provides functions like
<code>sequential_hcl()</code> and <code>diverging_hcl()</code>
to generate palettes by defining a custom set of
hue, chroma, and luminance
trajectories, e.g., based on specific hues that have inherent meanings
for a particular data set.</p>
<h4 class="unnumbered" data-number="4.2.1" id="qualitative-palettes">Qualitative palettes</h4>
<p>The qualitative palettes available from <code>hcl.colors()</code> are shown
in Figure <a href="#fig:qualPalettes">8</a>.
The common feature of these palettes is that they only vary hue
while using the same chroma and luminance for all of their colors.
One drawback to this approach is that fewer easily distinguishable
colors can be generated from these palettes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qualPalettes"></span>
<img src="RJ-2023-071_files/figure-html5/qualPalettes-1.png" alt="The qualitative palettes that are available with the `hcl.colors()` function." width="100%" />
<p class="caption">
Figure 8: The qualitative palettes that are available with the <code>hcl.colors()</code> function.
</p>
</div>
</div>
<p>The first five palettes are inspired by the ColorBrewer.org
palettes of the same name.
They employ different fixed levels of chroma and luminance and
span the full hue range.
Most of these palettes are also available as a fixed set
of colors via <code>palette.colors()</code>. There are two key differences:
First, chroma and luminance are fixed in <code>hcl.colors()</code> but typically
vary somewhat in <code>palette.colors()</code>. The former has the advantage
that the colors are more balanced. The latter has the advantage
that more sufficiently different colors can be obtained. Second,
<code>hcl.colors()</code> will return <code>n</code> colors interpolated from the full
range of hues, whereas <code>palette.colors()</code> will return the first <code>n</code>
colors from a fixed set.</p>
<p>The ColorBrewer.org palettes were designed with good perceptual properties
in mind, but also relied on expert opinion and trial and error.
This means that a little more care should be taken when selecting one
of the ColorBrewer-inspired HCL-based palettes because, for example,
they are often not colorblind-safe.
The ColorBrewer.org palettes are also available in R via the
<a href="#">RColorBrewer</a> package, which includes a facility for
generating ColorBrewer palettes that are colorblind-safe.</p>
<p>The remaining four palettes are taken from <span class="citation" data-cites="Ihaka:2003">Ihaka (<a href="#ref-Ihaka:2003" role="doc-biblioref">2003</a>)</span>. These
palettes keep chroma and luminance fixed and restrict the range
of hues (blues and greens for <code>"Cold"</code> and reds and oranges for
<code>"Warm"</code>). Holding chroma and luminance fixed means that the visual impact
is even across the palette. This makes these palettes appropriate
if all categories in a variable have equal importance, but, as with
the ColorBrewer.org emulations, they are not colorblind-safe and they will not
be appropriate for grayscale printing.</p>
<p>When palettes are employed for shading areas in statistical displays
(e.g., in bar plots, pie charts, or regions in maps), lighter colors
(with moderate chroma and high luminance) such as <code>"Pastel 1"</code> or <code>"Set 3"</code> are typically less distracting. By contrast, when coloring points
or lines, colors with a higher chroma are often required: On
a white background a moderate luminance as in <code>"Dark 2"</code> or <code>"Dark 3"</code>
usually works better while on a black/dark background the luminance
should be higher as in <code>"Set 3"</code> for example.</p>
<h4 class="unnumbered" data-number="4.2.2" id="single-hue-sequential-palettes">Single-hue sequential palettes</h4>
<p>We divide sequential palettes into single-hue (this section)
and multi-hue palettes (the next section).</p>
<p>Single-hue sequential palettes vary only from dark/colorful to light/gray, with
a constant underlying hue.
Figure <a href="#fig:blues3hcl">3</a> provides a good example of the hue, chroma,
and luminance trajectories for these palettes.
Certain hues will be more
appropriate for representing data on specific concepts, such
as green for “vegetation” and red for “temperature”.</p>
<p>Figure <a href="#fig:singleSeqPalettes">9</a> shows the sequential palettes that
hold hue largely constant. All of these palettes have a large
monotonic variation in luminance, typically from dark to light. This
is also typically accompanied by a change in chroma from more
colorful to less. The result is a palette that makes it very easy to
distinguish extreme values. Some palettes also have a pronounced peak
of chroma somewhere in the middle, which makes it easier to
distinguish moderate values from extreme values (e.g.,
<code>"Reds 3"</code>, <code>"Blues 3"</code>, etc.).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:singleSeqPalettes"></span>
<img src="RJ-2023-071_files/figure-html5/singleSeqPalettes-1.png" alt="The single-hue sequential palettes that are available with the `hcl.colors()` function." width="100%" />
<p class="caption">
Figure 9: The single-hue sequential palettes that are available with the <code>hcl.colors()</code> function.
</p>
</div>
</div>
<p>All palettes in this group,
except the last one, are inspired by the ColorBrewer.org palettes with
the same base name, but are restricted to a
single hue only. They are intended for a white/light background. The
last palette, <code>"Oslo"</code>, is taken from Crameri’s scientific color maps
and is intended for a black/dark background and hence the order
is reversed starting from a very light blue (almost white).</p>
<p>When only a few colors
are needed (e.g., for coding an ordinal categorical variable with few
levels) then a lower luminance contrast may suffice
(e.g., <code>"Light Grays"</code>, <code>"Reds 2"</code>, <code>"Blues 2"</code>, etc.).</p>
<h4 class="unnumbered" data-number="4.2.3" id="multi-hue-sequential-palettes">Multi-hue sequential palettes</h4>
<p>Multi-hue
sequential palettes not only vary luminance, from light to dark
(typically along with chroma), but also vary hue.
In order to not only bring out extreme colors in a sequential palette but also
better distinguish middle colors, it is a common strategy to employ a
sequence of hues. This leads to a large range of possible palettes.
Figure <a href="#fig:ylgnbu-viridis">6</a> shows examples of the
hue, chroma, and luminance trajectories from multi-hue palettes.</p>
<p>Note that the palettes in this section
differ substantially in the amount of chroma
and luminance contrasts. For example, many palettes go from a dark
high-chroma color to a neutral low-chroma color (e.g., <code>"Reds"</code>,
<code>"Purples"</code>, <code>"Greens"</code>, <code>"Blues"</code>) or even light gray (e.g.,
<code>"Purple-Blue"</code>). But some palettes also employ relatively high chroma
throughout the palette (e.g., emulations of Viridis and CARTOColor palettes).
The former strategy is suitable to
emphasize extreme values,
while the latter works better if all values along the sequence should
receive the same perceptual weight.</p>
<p>Palettes that involve a
significant variation in hue, e.g., <code>"YlGnBu"</code>, can be more effective
when we need to match specific colors to a legend
(e.g., the bottom row of Figure <a href="#fig:dorian">5</a>) or across several
small-multiples, as in facetted plots.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiSeqPalettes"></span>
<img src="RJ-2023-071_files/figure-html5/multiSeqPalettes-1.png" alt="Some of the multi-hue sequential palettes that are available with the `hcl.colors()` function." width="100%" />
<p class="caption">
Figure 10: Some of the multi-hue sequential palettes that are available with the <code>hcl.colors()</code> function.
</p>
</div>
</div>
<p>Of the palettes shown in Figure <a href="#fig:multiSeqPalettes">10</a>,
<code>"Red-Blue"</code> to <code>"Terrain 2"</code> are palettes created during the
development of the <a href="#">colorspace</a> package.</p>
<p>The next collection of palettes, <code>"Viridis"</code> to <code>"Mako"</code>, emulate
popular palettes within
the Python community.
The <code>"Viridis"</code>, <code>"Plasma"</code>,
and <code>"Inferno"</code> palettes come from the matplotlib Python library
and work well for identifying features of interest in false-color images.
This means that they should also work well for heatmaps.
The large range of hues means that these palettes can also serve
as qualitative palettes, which makes them robust default palettes.
However, this versatility means that
a palette that is purely sequential or purely qualitative may serve better
for a specific purpose.</p>
<p>The <code>"Mako"</code> and <code>"Rocket"</code> palettes are from the seaborn Python
library with an emphasis on high chroma and a wide range of luminance.
This makes these palettes a good choice for heatmaps.</p>
<p>The remaining palettes in Figure <a href="#fig:multiSeqPalettes">10</a>, from
<code>"Mint"</code> to <code>"Sunset"</code> closely match the corresponding CARTOColors
palettes.
These palettes tend to span a much narrower range of hues, chroma,
and luminance, so can be useful if we just need to represent a
small number of ordered values.
The resulting colors from these palettes will have, for example,
more similar hues than a palette generated from <code>"Viridis"</code>, with
its wide range of hues.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiSeqPalettes2"></span>
<img src="RJ-2023-071_files/figure-html5/multiSeqPalettes2-1.png" alt="Some of the multi-hue sequential palettes that are available with the `hcl.colors()` function." width="100%" />
<p class="caption">
Figure 11: Some of the multi-hue sequential palettes that are available with the <code>hcl.colors()</code> function.
</p>
</div>
</div>
<p>Figure <a href="#fig:multiSeqPalettes2">11</a> shows the remaining multi-hue
sequential palettes that are available in <code>hcl.colors()</code>.
Most of the top group of palettes, starting with <code>"Reds"</code>, <code>"Greens"</code>,
and <code>"Blues"</code>, closely match ColorBrewer.org palettes
of the same name. The <code>"YlGnBu"</code> palette is of particular note
as it uses essentially the same hues as the <code>"Viridis"</code> palette
(Figure <a href="#fig:multiSeqPalettes">10</a>), but it is more useful as a
sequential palette because chroma decreases for the high-luminance
colors (see also Figure <a href="#fig:ylgnbu-viridis">6</a>).</p>
<p>The next group of palettes, <code>"Lajolla"</code> to <code>"Batlow"</code> closely match the
palettes of the same name from Crameri’s scientific color maps.
These palettes are constructed with a luminance scale
so that there is a clear visual ordering of the palette.
They are also designed to be readable by colorblind users,
to work for grayscale printing, and to provide perceptual balance, so
that no color has a greater visual emphasis than any other.
While <code>"Lajolla"</code> and <code>"Turku"</code> are intended for use with a black/dark
background, <code>"Hawaii"</code> and <code>"Batlow"</code> are for use with a white/light background.
Moreover, the latter two span a particularly large range of hues, thus
yielding a kind of “scientific rainbow”.</p>
<h4 class="unnumbered" data-number="4.2.4" id="diverging-palettes">Diverging palettes</h4>
<p>The diverging palettes offer a range of underlying hues
for either extreme, with either light gray or yellow as the central “neutral”
value. The palettes with yellow at the centre provide less of a
change in colorfulness, so the “neutral” value is more of
a turning point rather than a local minimum.<br />
Figure <a href="#fig:diverPalettes">13</a> shows the selection of diverging
palettes for use with <code>hcl.colors()</code>.</p>
<p>All of these palettes are “balanced” in the sense that chroma and luminance
vary in the same way as we move from the central neutral color towards
either end of the palette.
Figure <a href="#fig:purplegreen-fall">12</a> (left) shows this idea of balance for
the <code>"Purple-Green"</code> palette.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:purplegreen-fall"></span>
<img src="RJ-2023-071_files/figure-html5/purplegreen-fall-1.png" alt="Hue, chroma, and luminance paths for the `&quot;Purple-Green&quot;` (left) and `&quot;Fall&quot;` (right) palettes. The plots are created by the `colorspace::specplot()` function. We can see that the `&quot;Purple-Green&quot;` palette is &quot;balanced&quot; with luminance and chroma varying symmetrically about the central neutral color for both hues. In contrast, the `&quot;Fall&quot;` palette is &quot;unbalanced&quot; with the left arm of the palette having somewhat darker colors with far less chroma than the right arm. Hue changes gradually from green through yellow to red, yielding a warmer palette compared to `&quot;Purple-Green&quot;`." width="49%" /><img src="RJ-2023-071_files/figure-html5/purplegreen-fall-2.png" alt="Hue, chroma, and luminance paths for the `&quot;Purple-Green&quot;` (left) and `&quot;Fall&quot;` (right) palettes. The plots are created by the `colorspace::specplot()` function. We can see that the `&quot;Purple-Green&quot;` palette is &quot;balanced&quot; with luminance and chroma varying symmetrically about the central neutral color for both hues. In contrast, the `&quot;Fall&quot;` palette is &quot;unbalanced&quot; with the left arm of the palette having somewhat darker colors with far less chroma than the right arm. Hue changes gradually from green through yellow to red, yielding a warmer palette compared to `&quot;Purple-Green&quot;`." width="49%" />
<p class="caption">
Figure 12: Hue, chroma, and luminance paths for the <code>"Purple-Green"</code> (left) and <code>"Fall"</code> (right) palettes. The plots are created by the <code>colorspace::specplot()</code> function. We can see that the <code>"Purple-Green"</code> palette is “balanced” with luminance and chroma varying symmetrically about the central neutral color for both hues. In contrast, the <code>"Fall"</code> palette is “unbalanced” with the left arm of the palette having somewhat darker colors with far less chroma than the right arm. Hue changes gradually from green through yellow to red, yielding a warmer palette compared to <code>"Purple-Green"</code>.
</p>
</div>
</div>
<p>When choosing a particular palette for a display similar
considerations apply as for the sequential palettes. For example,
large luminance differences are important when many colors are used
while smaller luminance contrasts may suffice for palettes with fewer
colors.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diverPalettes"></span>
<img src="RJ-2023-071_files/figure-html5/diverPalettes-1.png" alt="The balanced diverging palettes that are available with the `hcl.colors()` function." width="100%" />
<p class="caption">
Figure 13: The balanced diverging palettes that are available with the <code>hcl.colors()</code> function.
</p>
</div>
</div>
<p>Almost all of the palettes in the first two groups, those
involving simple color pairs like
<code>"Blue-Red"</code> or <code>"Cyan-Magenta"</code>, were developed as part of the
<a href="#">colorspace</a> package, taking inspiration
from various other palettes, including more balanced and simplified
versions of several ColorBrewer.org palettes.
The exception is the <code>"Tropic"</code> palette,
which closely matches the palette of the same name from CARTOColors.</p>
<p>The palettes <code>"Broc"</code> to <code>"Vik"</code> and <code>"Berlin"</code> to <code>"Tofino"</code> closely
match Crameri’s scientific color maps of the same name,
where the first three are intended for a white/light background and
the other three for a black/dark background.</p>
<h4 class="unnumbered" data-number="4.2.5" id="flexible-diverging-palettes">Flexible diverging palettes</h4>
<p>Figure <a href="#fig:diverxPalettes">14</a> shows a set of
more flexible diverging
palettes. These do not impose
any restrictions that the two “arms” of the palette need to be
balanced and also may go through a non-gray neutral color (typically
light yellow). Consequently, these palettes may be used to provide a larger
set of distinguishable colors compared to the diverging palettes from
the previous section. The price of this flexibility is that
the chroma/luminance within these palettes
can be rather unbalanced.
For example, Figure <a href="#fig:purplegreen-fall">12</a> (right) demonstrates this
feature of the <code>"Fall"</code> palette.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diverxPalettes"></span>
<img src="RJ-2023-071_files/figure-html5/diverxPalettes-1.png" alt="The flexible diverging palettes that are available with the `hcl.colors()` function." width="100%" />
<p class="caption">
Figure 14: The flexible diverging palettes that are available with the <code>hcl.colors()</code> function.
</p>
</div>
</div>
<p>The first group of palettes, including
<code>"ArmyRose"</code> and <code>"Temps"</code> closely match the palettes of the same name
from CARTOColors.</p>
<p>The next group, based on two or three hues, like <code>"PuOr"</code> and <code>"RdYlGn"</code>
closely match the
palettes of the same name from ColorBrewer.org.</p>
<p>The final group contains
<code>"Zissou 1"</code>, which closely matches the palette of the same name from
the <a href="https://cran.r-project.org/package=wesanderson">wesanderson</a> package <span class="citation" data-cites="wesanderson">(<a href="#ref-wesanderson" role="doc-biblioref">Ram and Wickham 2023</a>)</span>, <code>"Cividis"</code>,
which is an even more colorblind-safe version of <code>"Viridis"</code> <span class="citation" data-cites="cividis">(<a href="#ref-cividis" role="doc-biblioref">Nuñez et al. 2018</a>)</span> and
<code>"Roma"</code>, which closely matches the palette of the same name
from Crameri’s scientific color maps.</p>
<h2 data-number="5" id="new-defaults-in-graphical-functions"><span class="header-section-number">5</span> New defaults in graphical functions</h2>
<p>The new default color palette will be most visible in the output from
functions in the <a href="#">grDevices</a> and <a href="#">graphics</a> packages.
Several functions from these packages
now have slightly different default output,
namely when they are using integer color specifications such as
<code>2</code> or <code>3</code>.
The resulting colors will still be similar to the old output, e.g.,
still a red or a green, but just a different shade.</p>
<p>Moreover, a couple of functions explicitly have new defaults:
<code>image()</code> and <code>filled.contour()</code>, now use the sequential <code>"YlOrRd"</code> palette
(from ColorBrewer)
which uses similar hues as the old <code>heat.colors()</code>.
See the left panel in Figure <a href="#fig:graphics">15</a>.</p>
<p>Finally, the <code>hist()</code> and <code>boxplot()</code> functions (and therefore
formula-based calls of the form <code>plot(num ~ factor, ...)</code>, also have a new default color:
light gray which makes it easier to compare the shaded areas
(see the middle and right panels in Figure <a href="#fig:graphics">15</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='va'>volcano</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>weight</span> <span class='op'>~</span> <span class='va'>feed</span>, data <span class='op'>=</span> <span class='va'>chickwts</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>chickwts</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:graphics"></span>
<img src="RJ-2023-071_files/figure-html5/graphics-1.png" alt="Examples of the new default color palettes that are used in the base graphics functions `image()`, `boxplot()`, and `hist()`." width="100%" />
<p class="caption">
Figure 15: Examples of the new default color palettes that are used in the base graphics functions <code>image()</code>, <code>boxplot()</code>, and <code>hist()</code>.
</p>
</div>
</div>
<p>Package authors may also benefit from the new palettes available
in R; the new functions <code>palette.colors()</code> and <code>hcl.colors()</code>
allow good default palettes to be set without requiring additional
package dependencies. For example, the <a href="#">lattice</a> package
has already changed its default colors to use the <code>"Okabe-Ito"</code> and
<code>"YlGnBu"</code> palettes (for categorical and numerical data, respectively).</p>
<h2 data-number="6" id="sec:summary"><span class="header-section-number">6</span> Summary</h2>
<p>The default color palette in R has been improved since R version 4.0.0.
The functions <code>palette.colors()</code> and <code>hcl.colors()</code>, from the
<a href="#">grDevices</a> package, also provide a wide range of predefined
palettes based on a number of widely used graphics systems.
There are qualitative palettes for use with categorical data
and sequential and diverging palettes for use with ordinal or continuous data.
The table below summarizes the main types of palettes and provides
suggestions for good default palettes for each type.
We encourage package authors to make use of these palettes
when providing default colors for functions that produce plots.</p>
<table style="width:99%;">
<caption>An overview of the new palette functionality: For each main type of palette, the <em>Purpose</em> row describes what sort of data the type of palette is appropriate for, the <em>Generate</em> row gives the functions that can be used to generate palettes of that type, the <em>List</em> row names the functions that can be used to list available palettes, and the <em>Robust</em> row identifies two or three good default palettes of that type.</caption>
<colgroup>
<col style="width: 7%" />
<col style="width: 28%" />
<col style="width: 27%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Qualitative</th>
<th style="text-align: left;">Sequential</th>
<th style="text-align: left;">Diverging</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><em>Purpose</em></td>
<td style="text-align: left;">Categorical data</td>
<td style="text-align: left;">Ordered or numeric data
(high<span class="math inline">\(~\rightarrow~\)</span>low)</td>
<td style="text-align: left;">Ordered or numeric data with a central value
(high<span class="math inline">\(~\leftarrow~\)</span>neutral<span class="math inline">\(~\rightarrow~\)</span>low)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>Generate</em></td>
<td style="text-align: left;"><code>palette.colors()</code>,
<code>hcl.colors()</code></td>
<td style="text-align: left;"><code>hcl.colors()</code></td>
<td style="text-align: left;"><code>hcl.colors()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>List</em></td>
<td style="text-align: left;"><code>palette.pals()</code>,
<code>hcl.pals("qualitative")</code></td>
<td style="text-align: left;"><code>hcl.pals("sequential")</code></td>
<td style="text-align: left;"><code>hcl.pals("diverging")</code>,
<code>hcl.pals("divergingx")</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>Robust</em></td>
<td style="text-align: left;"><code>"Okabe-Ito"</code>, <code>"R4"</code></td>
<td style="text-align: left;"><code>"Blues 3"</code>, <code>"YlGnBu"</code>, <code>"Viridis"</code></td>
<td style="text-align: left;"><code>"Purple-Green"</code>, <code>"Blue-Red 3"</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="6.1" id="supplementary-materials"><span class="header-section-number">6.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-071.zip">RJ-2023-071.zip</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Bartram+Patra+Stone:2017" class="csl-entry" role="listitem">
L. Bartram, A. Patra and M. Stone. Affective color in visualization. In <em>Proceedings of the 2017 CHI conference on human factors in computing systems</em>, pages. 1364–1374 2017. New York: Association for Computing Machinery. DOI <a href="https://doi.org/10.1145/3025453.3026041">10.1145/3025453.3026041</a>.
</div>
<div id="ref-CARTOColor" class="csl-entry" role="listitem">
CARTO. CARTOColors: Data-driven color schemes. 2023. URL <a href="https://carto.com/carto-colors/">https://carto.com/carto-colors/</a>.
</div>
<div id="ref-Cleveland+McGill:1984" class="csl-entry" role="listitem">
W. S. Cleveland and R. McGill. Graphical perception: Theory, experimentation, and application to the development of graphical methods. <em>Journal of the American Statistical Association</em>, 79(387): 531–554, 1984. DOI <a href="https://doi.org/10.1080/01621459.1984.10478080">10.1080/01621459.1984.10478080</a>.
</div>
<div id="ref-Polychrome" class="csl-entry" role="listitem">
K. R. Coombes, G. Brock, Z. B. Abrams and L. V. Abruzzo. <span>Polychrome</span>: Creating and assessing qualitative palettes with many colors. <em>Journal of Statistical Software, Code Snippets</em>, 90(1): 1–23, 2019. DOI <a href="https://doi.org/10.18637/jss.v090.c01">10.18637/jss.v090.c01</a>.
</div>
<div id="ref-Crameri+Shephard+Heron:2020" class="csl-entry" role="listitem">
F. Crameri, G. E. Shephard and P. J. Heron. The misuse of colour in science communication. <em>Nature Communications</em>, 11(1): 5444, 2020. DOI <a href="https://doi.org/10.1038/s41467-020-19160-7">10.1038/s41467-020-19160-7</a>.
</div>
<div id="ref-Etchebehere+Fedorovskaya:2017" class="csl-entry" role="listitem">
S. Etchebehere and E. Fedorovskaya. On the role of color in visual saliency. <em>Electronic Imaging</em>, 2017(14): 58–63, 2017. DOI <a href="https://doi.org/10.2352/ISSN.2470-1173.2017.14.HVEI-119">10.2352/ISSN.2470-1173.2017.14.HVEI-119</a>.
</div>
<div id="ref-viridis" class="csl-entry" role="listitem">
S. Garnier. <em><span class="nocase">viridis</span>: Default color maps from <span class="nocase">matplotlib</span>.</em> 2023. URL <a href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</a>. <span>R</span> package version 0.6.4.
</div>
<div id="ref-Harrower+Brewer:2003" class="csl-entry" role="listitem">
M. A. Harrower and C. A. Brewer. <span class="nocase">ColorBrewer.org</span>: An online tool for selecting color schemes for maps. <em>The Cartographic Journal</em>, 40: 27–37, 2003. URL <a href="https://ColorBrewer.org/">https://ColorBrewer.org/</a>.
</div>
<div id="ref-Ihaka:2003" class="csl-entry" role="listitem">
R. Ihaka. Colour for presentation graphics. In <em>Proceedings of the 3rd international workshop on distributed statistical computing, vienna, austria</em>, Eds K. Hornik, F. Leisch and A. Zeileis 2003. URL <a href="https://www.R-project.org/conferences/DSC-2003/Proceedings/">https://www.R-project.org/conferences/DSC-2003/Proceedings/</a>. <span>ISSN 1609-395X</span>.
</div>
<div id="ref-colorspace" class="csl-entry" role="listitem">
R. Ihaka, P. Murrell, K. Hornik, J. C. Fisher, R. Stauffer, C. O. Wilke, C. D. McWhite and A. Zeileis. <em><span class="nocase">colorspace</span>: A toolbox for manipulating and assessing colors and palettes.</em> 2023. URL <a href="https://CRAN.R-project.org/package=colorspace">https://CRAN.R-project.org/package=colorspace</a>. <span>R</span> package version 2.1-0.
</div>
<div id="ref-Lonsdale+Lonsdale:2019" class="csl-entry" role="listitem">
M. D. S. Lonsdale and D. Lonsdale. <span>Design2Inform</span>: Information visualisation. The Office of the Chief Scientific Advisor, Gov UK. 2019. URL <a href="https://eprints.whiterose.ac.uk/141931/">https://eprints.whiterose.ac.uk/141931/</a>.
</div>
<div id="ref-Machado+Oliveira+Fernandes:2009" class="csl-entry" role="listitem">
G. M. Machado, M. M. Oliveira and L. A. F. Fernandes. A physiologically-based model for simulation of color vision deficiency. <em>IEEE Transactions on Visualization and Computer Graphics</em>, 15(6): 1291–1298, 2009. DOI <a href="https://doi.org/10.1109/TVCG.2009.113">10.1109/TVCG.2009.113</a>.
</div>
<div id="ref-RColorBrewer" class="csl-entry" role="listitem">
E. Neuwirth. <em><span>RColorBrewer</span>: ColorBrewer palettes.</em> 2022. URL <a href="https://CRAN.R-project.org/package=RColorBrewer">https://CRAN.R-project.org/package=RColorBrewer</a>. <span>R</span> package version 1.1-3.
</div>
<div id="ref-colorblindcheck" class="csl-entry" role="listitem">
J. Nowosad. <em><span class="nocase">colorblindcheck</span>: Check color palettes for problems with color vision deficiency.</em> 2023a. URL <a href="https://CRAN.R-project.org/package=colorblindcheck">https://CRAN.R-project.org/package=colorblindcheck</a>. R package version 1.0.2.
</div>
<div id="ref-rcartocolor" class="csl-entry" role="listitem">
J. Nowosad. <em><span class="nocase">rcartocolor</span>: CARTOColors palettes.</em> 2023b. URL <a href="https://CRAN.R-project.org/package=rcartocolor">https://CRAN.R-project.org/package=rcartocolor</a>. <span>R</span> package version 2.1.1.
</div>
<div id="ref-cividis" class="csl-entry" role="listitem">
J. R. Nuñez, C. R. Anderton and R. S. Renslow. Optimizing colormaps with consideration for color cision deficiency to enable accurate interpretation of scientific data. <em>PLOS ONE</em>, 13(7): 1–14, 2018. DOI <a href="https://doi.org/10.1371/journal.pone.0199239">10.1371/journal.pone.0199239</a>.
</div>
<div id="ref-Okabe+Ito:2008" class="csl-entry" role="listitem">
M. Okabe and K. Ito. Color universal design (<span>CUD</span>): How to make figures and presentations that are friendly to colorblind people. 2008. URL <a href="https://jfly.uni-koeln.de/color/">https://jfly.uni-koeln.de/color/</a>.
</div>
<div id="ref-scico" class="csl-entry" role="listitem">
T. L. Pedersen and F. Crameri. <em><span class="nocase">scico</span>: Colour palettes based on the scientific colour-maps.</em> 2023. URL <a href="https://CRAN.R-project.org/package=scico">https://CRAN.R-project.org/package=scico</a>. <span>R</span> package version 1.5.0.
</div>
<div id="ref-wesanderson" class="csl-entry" role="listitem">
K. Ram and H. Wickham. <em><span class="nocase">wesanderson</span>: A <span>W</span>es <span>A</span>nderson palette generator.</em> 2023. URL <a href="https://CRAN.R-project.org/package=wesanderson">https://CRAN.R-project.org/package=wesanderson</a>. R package version 0.3.7.
</div>
<div id="ref-lattice" class="csl-entry" role="listitem">
D. Sarkar. <em><span class="nocase">lattice</span>: Multivariate data visualization with <span>R</span>.</em> New York: Springer-Verlag, 2008. URL <a href="https://lmdvr.R-Forge.R-project.org/">https://lmdvr.R-Forge.R-project.org/</a>.
</div>
<div id="ref-Smith+VanDerWalt:2015" class="csl-entry" role="listitem">
N. Smith and S. Van der Walt. A better default colormap for <span class="nocase">matplotlib</span>. In <em>SciPy 2015 – scientific computing with <span>Python</span></em>, 2015. Austin. URL <a href="https://www.youtube.com/watch?v=xAoljeRJ3lU">https://www.youtube.com/watch?v=xAoljeRJ3lU</a>.
</div>
<div id="ref-Stone:2016" class="csl-entry" role="listitem">
M. Stone. How we designed the new color palettes in <span>Tableau</span> 10. 2016. URL <a href="https://www.tableau.com/about/blog/2016/7/colors-upgrade-tableau-10-56782">https://www.tableau.com/about/blog/2016/7/colors-upgrade-tableau-10-56782</a>. Tableau Blog.
</div>
<div id="ref-Tableau" class="csl-entry" role="listitem">
Tableau Software, LLC. <span>Tableau</span>: Business intelligence and analytics software. 2021. URL <a href="https://www.tableau.com/">https://www.tableau.com/</a>.
</div>
<div id="ref-cols4all" class="csl-entry" role="listitem">
M. Tennekes. <em><span class="nocase">cols4all</span>: Colors for all.</em> 2023. URL <a href="https://CRAN.R-project.org/package=cols4all">https://CRAN.R-project.org/package=cols4all</a>. <span>R</span> package version 0.6.
</div>
<div id="ref-Ware:2012" class="csl-entry" role="listitem">
C. Ware. <em>Information visualization: Perception for design.</em> 3rd ed Morgan Kaufmann, 2012. DOI <a href="https://doi.org/10.1016/C2009-0-62432-6">10.1016/C2009-0-62432-6</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
H. Wickham. <em><span class="nocase">ggplot2</span>: Elegant graphics for data analysis.</em> 2nd ed Springer-Verlag, 2016. URL <a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a>.
</div>
<div id="ref-Wiki+HCL" class="csl-entry" role="listitem">
Wikipedia. <span>HCL Color Space</span> — <span>W</span>ikipedia<span>,</span> the free encyclopedia. 2023.
</div>
<div id="ref-Zeileis+Fisher+Hornik:2020" class="csl-entry" role="listitem">
A. Zeileis, J. C. Fisher, K. Hornik, R. Ihaka, C. D. McWhite, P. Murrell, R. Stauffer and C. O. Wilke. <span class="nocase">colorspace</span>: A toolbox for manipulating and assessing colors and palettes. <em>Journal of Statistical Software</em>, 96(1): 1–49, 2020. DOI <a href="https://doi.org/10.18637/jss.v096.i01">10.18637/jss.v096.i01</a>.
</div>
<div id="ref-Zeileis+Hornik+Murrell:2009" class="csl-entry" role="listitem">
A. Zeileis, K. Hornik and P. Murrell. Escaping <span>RGB</span>land: Selecting colors for statistical graphics. <em>Computational Statistics &amp; Data Analysis</em>, 53: 3259–3270, 2009. DOI <a href="https://doi.org/10.1016/j.csda.2008.11.033">10.1016/j.csda.2008.11.033</a>.
</div>
<div id="ref-grDevices" class="csl-entry" role="listitem">
A. Zeileis and P. Murrell. <span>HCL</span>-based color palettes in <span class="nocase">grDevices</span>. 2019. URL <a href="https://blog.R-project.org/2019/04/01/hcl-based-color-palettes-in-grdevices/">https://blog.R-project.org/2019/04/01/hcl-based-color-palettes-in-grdevices/</a>. The <span>R</span> Blog.
</div>
<div id="ref-grDevices2" class="csl-entry" role="listitem">
A. Zeileis, P. Murrell, M. Maechler and D. Sarkar. A new <code>palette()</code> for <span>R</span>. 2019. URL <a href="https://blog.R-project.org/2019/11/21/a-new-palette-for-r/">https://blog.R-project.org/2019/11/21/a-new-palette-for-r/</a>. The <span>R</span> Blog.
</div>
<div id="ref-Zeileis+Stauffer:2019" class="csl-entry" role="listitem">
A. Zeileis and R. Stauffer. Was <span>T</span>rump confused by rainbow color map? 2019. URL <a href="https://www.zeileis.org/news/dorian_rainbow/">https://www.zeileis.org/news/dorian_rainbow/</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Zeileis &amp; Murrell, "Coloring in R's Blind Spot", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-071,
  author = {Zeileis, Achim and Murrell, Paul},
  title = {Coloring in R's Blind Spot},
  journal = {The R Journal},
  year = {2023},
  note = {https://doi.org/10.32614/RJ-2023-071},
  doi = {10.32614/RJ-2023-071},
  volume = {15},
  issue = {3},
  issn = {2073-4859},
  pages = {240-256}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
