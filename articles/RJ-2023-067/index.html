<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>fasano.franceschini.test: An Implementation of a Multivariate KS Test in R</title>

<meta property="description" itemprop="description" content="The Kolmogorov--Smirnov (KS) test is a nonparametric statistical test used to test for differences between univariate probability distributions. The versatility of the KS test has made it a cornerstone of statistical analysis across many scientific disciplines. However, the test proposed by Kolmogorov and Smirnov does not easily extend to multivariate distributions. Here we present the [fasano.franceschini.test](https://CRAN.R-project.org/package=fasano.franceschini.test) package, an R implementation of a multivariate two-sample KS test described by @ff1987. The fasano.franceschini.test package provides a test that is computationally efficient, applicable to data of any dimension and type (continuous, discrete, or mixed), and that performs competitively with similar R packages."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-067/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-12-18"/>
<meta property="article:created" itemprop="dateCreated" content="2023-12-18"/>
<meta name="article:author" content="Connor Puritz"/>
<meta name="article:author" content="Elan Ness-Cohn"/>
<meta name="article:author" content="Rosemary Braun"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="fasano.franceschini.test: An Implementation of a Multivariate KS Test in R"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="The Kolmogorov--Smirnov (KS) test is a nonparametric statistical test used to test for differences between univariate probability distributions. The versatility of the KS test has made it a cornerstone of statistical analysis across many scientific disciplines. However, the test proposed by Kolmogorov and Smirnov does not easily extend to multivariate distributions. Here we present the [fasano.franceschini.test](https://CRAN.R-project.org/package=fasano.franceschini.test) package, an R implementation of a multivariate two-sample KS test described by @ff1987. The fasano.franceschini.test package provides a test that is computationally efficient, applicable to data of any dimension and type (continuous, discrete, or mixed), and that performs competitively with similar R packages."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-067/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="fasano.franceschini.test: An Implementation of a Multivariate KS Test in R"/>
<meta property="twitter:description" content="The Kolmogorov--Smirnov (KS) test is a nonparametric statistical test used to test for differences between univariate probability distributions. The versatility of the KS test has made it a cornerstone of statistical analysis across many scientific disciplines. However, the test proposed by Kolmogorov and Smirnov does not easily extend to multivariate distributions. Here we present the [fasano.franceschini.test](https://CRAN.R-project.org/package=fasano.franceschini.test) package, an R implementation of a multivariate two-sample KS test described by @ff1987. The fasano.franceschini.test package provides a test that is computationally efficient, applicable to data of any dimension and type (continuous, discrete, or mixed), and that performs competitively with similar R packages."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-067/"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="fasano.franceschini.test: An Implementation of a Multivariate KS Test in R"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-067"/>
<meta name="citation_pdf_url" content="RJ-2023-067.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="3"/>
<meta name="citation_doi" content="10.32614/RJ-2023-067"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="159"/>
<meta name="citation_lastpage" content="171"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/12/18"/>
<meta name="citation_publication_date" content="2023/12/18"/>
<meta name="citation_author" content="Connor Puritz"/>
<meta name="citation_author_institution" content="Department of Engineering Sciences and Applied Mathematics,&#10;Northwestern University"/>
<meta name="citation_author" content="Elan Ness-Cohn"/>
<meta name="citation_author_institution" content="Department of Molecular Biosciences, Northwestern University"/>
<meta name="citation_author" content="Rosemary Braun"/>
<meta name="citation_author_institution" content="Department of Molecular Biosciences, Northwestern University"/>
<!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","subid","slug","packages","draft","preview","nocite","bibliography","output","pdf_url","citation_url","doi","creative_commons","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["fasano.franceschini.test: An Implementation of a Multivariate KS Test in R"]},{"type":"character","attributes":{},"value":["The Kolmogorov--Smirnov (KS) test is a nonparametric statistical test used to test for differences between univariate probability distributions. The versatility of the KS test has made it a cornerstone of statistical analysis across many scientific disciplines. However, the test proposed by Kolmogorov and Smirnov does not easily extend to multivariate distributions. Here we present the [fasano.franceschini.test](https://CRAN.R-project.org/package=fasano.franceschini.test) package, an R implementation of a multivariate two-sample KS test described by @ff1987. The fasano.franceschini.test package provides a test that is computationally efficient, applicable to data of any dimension and type (continuous, discrete, or mixed), and that performs competitively with similar R packages."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","orcid_id","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Connor Puritz"]},{"type":"character","attributes":{},"value":["Department of Engineering Sciences and Applied Mathematics,\nNorthwestern University"]},{"type":"character","attributes":{},"value":["0000-0001-7602-0444"]},{"type":"character","attributes":{},"value":["Evanston, IL 60208"]},{"type":"character","attributes":{},"value":["connorpuritz2025@u.northwestern.edu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","orcid_id","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Elan Ness-Cohn"]},{"type":"character","attributes":{},"value":["Department of Molecular Biosciences, Northwestern University"]},{"type":"character","attributes":{},"value":["0000-0002-3935-6667"]},{"type":"character","attributes":{},"value":["Evanston, IL 60208"]},{"type":"character","attributes":{},"value":["elan.ness-cohn@northwestern.edu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","orcid_id","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Rosemary Braun"]},{"type":"character","attributes":{},"value":["Department of Molecular Biosciences, Northwestern University"]},{"type":"character","attributes":{},"value":["0000-0001-9668-9866"]},{"type":"character","attributes":{},"value":["Evanston, IL 60208"]},{"type":"character","attributes":{},"value":["rbraun@northwestern.edu"]}]}]},{"type":"character","attributes":{},"value":["2023-12-18"]},{"type":"character","attributes":{},"value":["2022-11-18"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[159]},{"type":"integer","attributes":{},"value":[171]}]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[3]},{"type":"character","attributes":{},"value":["2022-201"]},{"type":"character","attributes":{},"value":["RJ-2023-067"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"NULL"},{"type":"NULL"}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["@rcppparallel,@dipropermR,@atasoy_2017,@baringhaus_2004,@bentley_decomposable_1979,@chiang_2018,@geometry_2008,@rcpp,@ff1987,@cramerR,@hahne_2018,@hemerik2018,@heuchenne_2022,@hoeffding1952,@copulaR,@justel_1997,@kaczanowska_2021,@Kolmogorov1933,@Kolmogorov1933a,@lopes_2007,@microbenchmarkR,@naaman_2021,@ness-cohn_2020,@peacock_1983,@patchworkR,@press2007,@ramdas2022permutation,@mass,@Smirnov1936,@Smirnov1937,@Smirnov1939,@Smirnov1944,@Smirnov1948,@diproperm_original,@rtreeGithub,@ggplotR,@wong_2020,@peacockR\n"]},{"type":"character","attributes":{},"value":["puritz-nesscohn-braun.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","legacy_pdf"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["RJ-2023-067.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-067"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-067"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{},"value":[]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-067/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["code/fig1/fig1.R","code/fig2/fig2_plot.R","code/fig2/fig2a.R","code/fig2/fig2b.R","code/fig2/fig2c.R","code/fig2/fig2d.R","code/fig3/fig3.R","code/fig4/fig4.R","code/fig5/fig5_plot.R","code/fig5/fig5a.R","code/fig5/fig5b.R","code/fig5/fig5c.R","code/fig5/fig5d.R","code/fig6/fig6_plot.R","code/fig6/fig6a.R","code/fig6/fig6b.R","code/fig6/fig6c.R","code/fig6/fig6d.R","figures/fig1.png","figures/fig2.png","figures/fig3.png","figures/fig4.png","figures/fig5.png","figures/fig6.png","puritz-nesscohn-braun.bib","puritz-nesscohn-braun.tex","RJ-2023-067_files/anchor-4.2.2/anchor.min.js","RJ-2023-067_files/bowser-1.9.3/bowser.min.js","RJ-2023-067_files/distill-2.2.21/template.v2.js","RJ-2023-067_files/header-attrs-2.25/header-attrs.js","RJ-2023-067_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2023-067_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2023-067_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2023-067_files/popper-2.6.0/popper.min.js","RJ-2023-067_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2023-067_files/tippy-6.2.7/tippy-light-border.css","RJ-2023-067_files/tippy-6.2.7/tippy.css","RJ-2023-067_files/tippy-6.2.7/tippy.umd.min.js","RJ-2023-067_files/webcomponents-2.0.0/webcomponents.js","RJ-2023-067-src.tex","RJ-2023-067-src.tex-1","RJ-2023-067.pdf","RJ-2023-067.Rmd-1","RJ-2023-067.Rmd-orig","RJ-2023-067.tex","RJ-2023-067.zip","RJournal.sty","RJwrapper.aux","RJwrapper.bbl","RJwrapper.blg","RJwrapper.brf","RJwrapper.fdb_latexmk","RJwrapper.fls","RJwrapper.tex","Rlogo-5.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").first();
      if (tpar && ! tpar.hasClass("subtitle")) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"fasano.franceschini.test: An Implementation of a Multivariate KS Test in R","description":"The Kolmogorov--Smirnov (KS) test is a nonparametric statistical test used to test for differences between univariate probability distributions. The versatility of the KS test has made it a cornerstone of statistical analysis across many scientific disciplines. However, the test proposed by Kolmogorov and Smirnov does not easily extend to multivariate distributions. Here we present the [fasano.franceschini.test](https://CRAN.R-project.org/package=fasano.franceschini.test) package, an R implementation of a multivariate two-sample KS test described by @ff1987. The fasano.franceschini.test package provides a test that is computationally efficient, applicable to data of any dimension and type (continuous, discrete, or mixed), and that performs competitively with similar R packages.","doi":"10.32614/RJ-2023-067","authors":[{"author":"Connor Puritz","authorURL":"#","affiliation":"Department of Engineering Sciences and Applied Mathematics,\nNorthwestern University","affiliationURL":"#","orcidID":"0000-0001-7602-0444"},{"author":"Elan Ness-Cohn","authorURL":"#","affiliation":"Department of Molecular Biosciences, Northwestern University","affiliationURL":"#","orcidID":"0000-0002-3935-6667"},{"author":"Rosemary Braun","authorURL":"#","affiliation":"Department of Molecular Biosciences, Northwestern University","affiliationURL":"#","orcidID":"0000-0001-9668-9866"}],"publishedDate":"2023-12-18T00:00:00.000+00:00","citationText":"Puritz, et al., 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2024-1">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>fasano.franceschini.test: An Implementation of a Multivariate KS Test in R</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>The Kolmogorov–Smirnov (KS) test is a nonparametric statistical test used to test for differences between univariate probability distributions. The versatility of the KS test has made it a cornerstone of statistical analysis across many scientific disciplines. However, the test proposed by Kolmogorov and Smirnov does not easily extend to multivariate distributions. Here we present the <a href="https://CRAN.R-project.org/package=fasano.franceschini.test">fasano.franceschini.test</a> package, an R implementation of a multivariate two-sample KS test described by <span class="citation" data-cites="ff1987">Fasano and Franceschini (<a href="#ref-ff1987" role="doc-biblioref">1987</a>)</span>. The fasano.franceschini.test package provides a test that is computationally efficient, applicable to data of any dimension and type (continuous, discrete, or mixed), and that performs competitively with similar R packages.</p>
</div>

<div class="d-byline">
  Connor Puritz  (Department of Engineering Sciences and Applied Mathematics,
Northwestern University)
  
,   Elan Ness-Cohn  (Department of Molecular Biosciences, Northwestern University)
  
,   Rosemary Braun  (Department of Molecular Biosciences, Northwestern University)
  
<br/>2023-12-18
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>The Kolmogorov–Smirnov (KS) test is a nonparametric, univariate
statistical test designed to assess whether a sample of data is
consistent with a given probability distribution (or, in the two-sample
case, whether the two samples came from the same underlying
distribution). First described by Kolmogorov and Smirnov in a series of
papers
<span class="citation" data-cites="Kolmogorov1933 Kolmogorov1933a Smirnov1936 Smirnov1937 Smirnov1939 Smirnov1944 Smirnov1948">(<a href="#ref-Kolmogorov1933" role="doc-biblioref">Kolmogorov 1933a</a>,<a href="#ref-Kolmogorov1933a" role="doc-biblioref">b</a>; <a href="#ref-Smirnov1936" role="doc-biblioref">Smirnov 1936</a>, <a href="#ref-Smirnov1937" role="doc-biblioref">1937</a>, <a href="#ref-Smirnov1939" role="doc-biblioref">1939</a>, <a href="#ref-Smirnov1944" role="doc-biblioref">1944</a>, <a href="#ref-Smirnov1948" role="doc-biblioref">1948</a>)</span>,
the KS test is a popular goodness-of-fit test that has found use across
a wide variety of scientific disciplines, including neuroscience
<span class="citation" data-cites="atasoy_2017">(<a href="#ref-atasoy_2017" role="doc-biblioref">Atasoy et al. 2017</a>)</span>, climatology <span class="citation" data-cites="chiang_2018">(<a href="#ref-chiang_2018" role="doc-biblioref">Chiang et al. 2018</a>)</span>, robotics <span class="citation" data-cites="hahne_2018">(<a href="#ref-hahne_2018" role="doc-biblioref">Hahne et al. 2018</a>)</span>,
epidemiology <span class="citation" data-cites="wong_2020">(<a href="#ref-wong_2020" role="doc-biblioref">Wong and Collins 2020</a>)</span>, and cell biology <span class="citation" data-cites="kaczanowska_2021">(<a href="#ref-kaczanowska_2021" role="doc-biblioref">Kaczanowska et al. 2021</a>)</span>.</p>
<p>Due to its popularity, several multivariate extensions of the KS test
have been described in literature. <span class="citation" data-cites="justel_1997">Justel et al. (<a href="#ref-justel_1997" role="doc-biblioref">1997</a>)</span> proposed a multivariate
test based on Rosenblatt’s transformation, which reduces to the KS test
in the univariate case. While the test statistic is distribution-free,
it is difficult to compute in more than two dimensions, and an
approximate test with reduced power must be used instead. Furthermore,
the test is only applicable in the one-sample case. <span class="citation" data-cites="heuchenne_2022">Heuchenne and Mordant (<a href="#ref-heuchenne_2022" role="doc-biblioref">2022</a>)</span>
proposed to use the Hilbert space-filling curve to define an ordering in
<span class="math inline">\(\mathbb{R}^{2}\)</span>. The preimage of both samples is computed under the
space-filling curve map, and the two-sample KS test is performed on the
preimages. While it is theoretically possible to extend this approach to
higher dimensions, the authors note that this would be computationally
challenging and leave it as an open problem. <span class="citation" data-cites="naaman_2021">Naaman (<a href="#ref-naaman_2021" role="doc-biblioref">2021</a>)</span> derived a
multivariate extension of the DKW inequality and used it to provide
estimates of the tail properties of the asymptotic distribution of the
KS test statistic in multiple dimensions. While an important theoretical
result, it is of limited practical use absent a method for computing
exact <span class="math inline">\(p\)</span>-values.</p>
<p><span class="citation" data-cites="peacock_1983">Peacock (<a href="#ref-peacock_1983" role="doc-biblioref">1983</a>)</span> proposed a test which addresses the fact that there are
multiple ways to order points in higher dimensions, and thus multiple
ways of defining a cumulative distribution function. In one dimension,
probability density can be integrated from left to right, resulting in
the canonical CDF <span class="math inline">\(P(X&lt;x)\)</span>; or from right to left, resulting in the
survival function <span class="math inline">\(P(X&gt;x)\)</span>. However, since <span class="math inline">\(P(X&lt;x)=1-P(X&gt;x)\)</span> (for
continuous random variables), the KS test statistic is independent of
this choice. In two dimensions, there are four ways of ordering points,
and thus four possible cumulative distribution functions: <span class="math inline">\(P(X&lt;x,Y&lt;y)\)</span>,
<span class="math inline">\(P(X&gt;x,Y&lt;y)\)</span>, <span class="math inline">\(P(X&lt;x,Y&gt;y)\)</span>, and <span class="math inline">\(P(X&gt;x,Y&gt;y)\)</span>. Since any three of these
are independent of one another, the KS test statistic will not be
independent of which ordering is chosen. To address this, <span class="citation" data-cites="peacock_1983">Peacock (<a href="#ref-peacock_1983" role="doc-biblioref">1983</a>)</span>
proposed to compute a KS statistic using each possible cumulative
distribution function, and to take the test statistic to be the maximum
of those.</p>
<p><span class="citation" data-cites="peacock_1983">Peacock (<a href="#ref-peacock_1983" role="doc-biblioref">1983</a>)</span> suggested that for a sample
<span class="math inline">\((X_{1},Y_{1}),\dots,(X_{n},Y_{n})\)</span>, each of the four KS statistics
should be maximized over the set of all coordinate-wise combinations
<span class="math inline">\(\{(X_{i},Y_{j}):1\leq i,j\leq n\}\)</span>. The complexity of computing
Peacock’s test statistic thus scales cubically with sample size, which
is expensive and can become intractable for large sample sizes. <span class="citation" data-cites="ff1987">Fasano and Franceschini (<a href="#ref-ff1987" role="doc-biblioref">1987</a>)</span>
proposed a simple change to Peacock’s test: instead of maximizing each
KS statistic over all coordinate-wise combinations of points in the
sample, the statistics should be maximized over just the points in the
sample itself. This slight change greatly reduces the computational
complexity of the test while maintaining a similar power across a
variety of alternatives <span class="citation" data-cites="ff1987 lopes_2007">(<a href="#ref-ff1987" role="doc-biblioref">Fasano and Franceschini 1987</a>; <a href="#ref-lopes_2007" role="doc-biblioref">Lopes et al. 2007</a>)</span>. <span class="citation" data-cites="ff1987">Fasano and Franceschini (<a href="#ref-ff1987" role="doc-biblioref">1987</a>)</span> proposed both a
one-sample and two-sample version of their test, although we focus on
the two-sample test here.</p>
<p>In this article we present the fasano.franceschini.test package, an R
implementation of the two-sample Fasano–Franceschini test. Our
implementation can be applied to continuous, discrete, or mixed datasets
of any size and of any dimension. We first introduce the test by
detailing how the test statistic is computed, how it can be computed
efficiently, and how <span class="math inline">\(p\)</span>-values can be computed. We then describe the
package structure and provide several basic examples illustrating its
usage. We conclude by comparing the package to three other CRAN packages
implementing multivariate two-sample goodness-of-fit tests.</p>
<h2 data-number="2" id="fasanofranceschini-test"><span class="header-section-number">2</span> Fasano–Franceschini test</h2>
<h3 data-number="2.1" id="two-sample-test-statistic"><span class="header-section-number">2.1</span> Two-sample test statistic</h3>
<p>Let <span class="math inline">\(\mathbf{X}=(\mathbf{X}_{1},\dots,\mathbf{X}_{n_{1}})\)</span> and
<span class="math inline">\(\mathbf{Y}=(\mathbf{Y}_{1},\dots,\mathbf{Y}_{n_{2}})\)</span> be samples of
i.i.d. <span class="math inline">\(d\)</span>-dimensional random vectors drawn from unknown distributions
<span class="math inline">\(F_{1}\)</span> and <span class="math inline">\(F_{2}\)</span>, respectively. The two-sample Fasano–Franceschini
test evaluates the null hypothesis <span class="math display">\[H_{0}:F_{1}=F_{2}\]</span> against the
alternative <span class="math display">\[H_{1}:F_{1}\neq F_{2}.\]</span> In their original paper, <span class="citation" data-cites="ff1987">Fasano and Franceschini (<a href="#ref-ff1987" role="doc-biblioref">1987</a>)</span>
only considered two- and three-dimensional random vectors, although
their test naturally extends to arbitrary dimensions as follows.</p>
<p>For <span class="math inline">\(\mathbf{x}\in\mathbb{R}^{d}\)</span>, we define the <span class="math inline">\(i\)</span>th open orthant with
origin <span class="math inline">\(\mathbf{x}\)</span> as
<span class="math display">\[\mathcal{O}_{i}(\mathbf{x})=\left\{\mathbf{y}\in\mathbb{R}^{d}\,\rvert\,\mathbf{e}_{ij}(\mathbf{y}_{j}-\mathbf{x}_{j})&gt;0,\;j=1,\dots,d\right\}\]</span>
where <span class="math inline">\(\mathbf{e}_{i}\in\{-1,1\}^{d}\)</span> is a length <span class="math inline">\(d\)</span> combination of
<span class="math inline">\(\pm 1\)</span>. For example, in two dimensions, the four combinations
<span class="math inline">\(\mathbf{e}_{1}=(1,1)\)</span>, <span class="math inline">\(\mathbf{e}_{2}=(-1,1)\)</span>,
<span class="math inline">\(\mathbf{e}_{3}=(-1,-1)\)</span>, and <span class="math inline">\(\mathbf{e}_{4}=(1,-1)\)</span> correspond to
quadrants one through four in the plane, respectively. In general there
are <span class="math inline">\(2^{d}\)</span> such combinations, corresponding to the <span class="math inline">\(2^{d}\)</span> orthants
that divide <span class="math inline">\(\mathbb{R}^{d}\)</span>. Using the indicator function
<span class="math display">\[I_{j}(\mathbf{x}\,\rvert\,\mathbf{y})=
\begin{cases}
1,\hfill&amp;\mathbf{x}\in\mathcal{O}_{j}(\mathbf{y})\\
0,\hfill&amp;\mathbf{x}\notin\mathcal{O}_{j}(\mathbf{y})
\end{cases}\]</span> we define <span id="eq:diff">
<span class="math display">\[\label{eq:diff}
D(\mathbf{p}\,\rvert\,\mathbf{X},\mathbf{Y})=\max_{1\leq j\leq 2^{d}}\left|\frac{1}{n_{1}}\sum_{k=1}^{n_{1}}I_{j}\left(\mathbf{X}_{k}\,\rvert\,\mathbf{p}\right)-\frac{1}{n_{2}}\sum_{k=1}^{n_{2}}I_{j}\left(\mathbf{Y}_{k}\,\rvert\,\mathbf{p}\right)\right|.~~~~~(1)\]</span>
</span>
This is similar to the distance used in the two-sample KS test, but
takes into account all possible ways of ordering points in
<span class="math inline">\(\mathbb{R}^{d}\)</span>. Note that this function does not depend on the
enumeration of the orthants. Maximizing <span class="math inline">\(D\)</span> over each sample separately
leads to the difference statistics
<span class="math display">\[D_{1}(\mathbf{X},\mathbf{Y})=\max_{1\leq i\leq n_{1}}D(\mathbf{X}_{i}\,\rvert\,\mathbf{X},\mathbf{Y})\]</span>
and
<span class="math display">\[D_{2}(\mathbf{X},\mathbf{Y})=\max_{1\leq i\leq n_{2}}D(\mathbf{Y}_{i}\,\rvert\,\mathbf{X},\mathbf{Y}).\]</span>
The two-sample Fasano–Franceschini test statistic, as originally
defined by <span class="citation" data-cites="ff1987">Fasano and Franceschini (<a href="#ref-ff1987" role="doc-biblioref">1987</a>)</span>, is the average of the difference statistics scaled
by the sample sizes: <span id="eq:ff_stat"><span class="math display">\[\label{eq:ff_stat}
\mathcal{D}_{0}(\mathbf{X},\mathbf{Y})=\sqrt{\frac{n_{1}n_{2}}{n_{1}+n_{2}}}\left(\frac{D_{1}(\mathbf{X},\mathbf{Y})+D_{2}(\mathbf{X},\mathbf{Y})}{2}\right).~~~~~(2)\]</span></span>
This test statistic is discrete, but in general is not integer-valued.
Note that
<span class="math display">\[n_{1}n_{2}D(\mathbf{p}\,\rvert\,\mathbf{X},\mathbf{Y})=\max_{1\leq j\leq 2^{d}}\left|n_{2}\sum_{k=1}^{n_{1}}I_{j}\left(\mathbf{X}_{k}\,\rvert\,\mathbf{p}\right)-n_{1}\sum_{k=1}^{n_{2}}I_{j}\left(\mathbf{Y}_{k}\,\rvert\,\mathbf{p}\right)\right|\in\mathbb{Z},\]</span>
and thus
<span class="math display">\[n_{1}n_{2}D_{i}(\mathbf{X},\mathbf{Y})\in\mathbb{Z},\;i\in\{1,2\}.\]</span>
Let <span class="math display">\[C_{n_{1},n_{2}}=2\sqrt{n_{1}n_{2}(n_{1}+n_{2})}.\]</span> Then
<span class="math display">\[\begin{aligned}
C_{n_{1},n_{2}}\mathcal{D}_{0}(\mathbf{X},\mathbf{Y})&amp;=2\sqrt{n_{1}n_{2}(n_{1}+n_{2})}\sqrt{\frac{n_{1}n_{2}}{n_{1}+n_{2}}}\left(\frac{D_{1}(\mathbf{X},\mathbf{Y})+D_{2}(\mathbf{X},\mathbf{Y})}{2}\right)\\&amp;=n_{1}n_{2}(D_{1}(\mathbf{X},\mathbf{Y})+D_{2}(\mathbf{X},\mathbf{Y}))\in\mathbb{Z}.
\end{aligned}\]</span> To avoid comparing floating point numbers, it is
preferable for the test statistic to be integer-valued, and thus we use
<span id="eq:test_stat"><span class="math display">\[\mathcal{D}(\mathbf{X},\mathbf{Y})=C_{n_{1},n_{2}}\mathcal{D}_{0}(\mathbf{X},\mathbf{Y})
\label{eq:test_stat}
~~~~~(3)\]</span></span>
as our test statistic. As will be shown, the <span class="math inline">\(p\)</span>-value of the test is
independent of scalar rescaling of the test statistic.</p>
<figure id="figure:example_stat">
<img src="figures/fig1.png" alt="Figure 1: Illustration of the computation of the difference statistic D_{1} in two dimensions. Each point in the first sample is used to divide the plane into four quadrants, and both samples are cumulated in each of the four quadrants. The fraction of each sample in each quadrant is shown in the corresponding plot corner, and the maximum difference over all four quadrants is shown above each plot. D_{1} is taken as the maximum of these differences. To compute the test statistic, we would next compute D_{2} by repeating the same procedure, but using points in the second sample to divide the plane instead." />
<figcaption aria-hidden="true">Figure 1: Illustration of the computation of the difference statistic <span class="math inline">\(D_{1}\)</span> in
two dimensions. Each point in the first sample is used to divide the
plane into four quadrants, and both samples are cumulated in each of the
four quadrants. The fraction of each sample in each quadrant is shown in
the corresponding plot corner, and the maximum difference over all four
quadrants is shown above each plot. <span class="math inline">\(D_{1}\)</span> is taken as the maximum of
these differences. To compute the test statistic, we would next compute
<span class="math inline">\(D_{2}\)</span> by repeating the same procedure, but using points in the second
sample to divide the plane
instead.</figcaption>
</figure>
<h3 data-number="2.2" id="computational-complexity"><span class="header-section-number">2.2</span> Computational complexity</h3>
<p>The bulk of the time required to compute the test statistic in
(<a href="#eq:test_stat" data-reference-type="ref" data-reference="eq:test_stat">3</a>)
is spent evaluating sums of the form
<span class="math display">\[\sum_{\mathbf{x}\in S}I_{j}\left(\mathbf{x}\,\rvert\,\mathbf{y}\right),\]</span>
which count the number of points in a set <span class="math inline">\(S\)</span> that lie in a given
<span class="math inline">\(d\)</span>-dimensional region. The simplest approach to computing such sums is
brute force, where every point <span class="math inline">\(\mathbf{x}\in S\)</span> is checked
independently. The orthant a point lies in can be determined using <span class="math inline">\(d\)</span>
binary checks, resulting in a time complexity of <span class="math inline">\(O(N^{2})\)</span>, where
<span class="math inline">\(N=\max(n_{1},n_{2})\)</span>, to evaluate
(<a href="#eq:test_stat" data-reference-type="ref" data-reference="eq:test_stat">3</a>)
for fixed <span class="math inline">\(d\)</span>.</p>
<p>Alternatively, we can consider each sum as a single query rather than a
sequence of independent ones. Specifically, both sums in
(<a href="#eq:diff" data-reference-type="ref" data-reference="eq:diff">1</a>) are
orthogonal range counting queries, which ask how many points in a set
<span class="math inline">\(S\subset\mathbb{R}^{d}\)</span> lie in an axis-aligned box
<span class="math inline">\((x_{1},x_{1}&#39;)\times\dots \times(x_{d},x_{d}&#39;)\)</span>. Range counting is an
important problem in the field of computational geometry, and as such a
variety of data structures have been described to provide efficient
solutions <span class="citation" data-cites="geometry_2008">(<a href="#ref-geometry_2008" role="doc-biblioref">Berg et al. 2008</a>)</span>. One solution, first introduced by
<span class="citation" data-cites="bentley_decomposable_1979">Bentley (<a href="#ref-bentley_decomposable_1979" role="doc-biblioref">1979</a>)</span>, is a multi-layer binary search tree termed a
range tree. Other slightly more efficient data structures have been
proposed for range counting, but range trees are well suited for our
purposes, particularly because their construction scales easily to
arbitrary dimensions <span class="citation" data-cites="bentley_decomposable_1979 geometry_2008">(<a href="#ref-bentley_decomposable_1979" role="doc-biblioref">Bentley 1979</a>; <a href="#ref-geometry_2008" role="doc-biblioref">Berg et al. 2008</a>)</span>.</p>
<p>A range tree can be constructed on a set of <span class="math inline">\(n\)</span> points in
<span class="math inline">\(d\)</span>-dimensional space using <span class="math inline">\(O(n\log^{d-1}n)\)</span> space in <span class="math inline">\(O(n\log^{d-1}n)\)</span>
time. The number of points that lie in an axis-aligned box can be
reported in <span class="math inline">\(O(\log^{d}n)\)</span> time, and this time can be further reduced to
<span class="math inline">\(O(\log^{d-1}n)\)</span> when <span class="math inline">\(d&gt;1\)</span> using fractional cascading <span class="citation" data-cites="geometry_2008">(<a href="#ref-geometry_2008" role="doc-biblioref">Berg et al. 2008</a>)</span>.
To compute (<a href="#eq:test_stat" data-reference-type="ref" data-reference="eq:test_stat">3</a>), we construct one range tree for each of the
two samples, and then query each tree <span class="math inline">\(2^{d}\)</span> times. Thus the total time
complexity to compute the test statistic using range trees for fixed <span class="math inline">\(d\)</span>
is <span class="math inline">\(O(N\log^{d-1}N)\)</span>, where <span class="math inline">\(N=\max(n_{1},n_{2})\)</span>.</p>
<figure id="figure:stat_time">
<img src="figures/fig2.png" alt="Figure 2: Time to compute the Fasano–Franceschini test statistic as a function of sample size, comparing the brute force and range tree methods for data of dimensions two through five. Points represent the mean time of 200 evaluations. Samples are taken to be of the same size and are drawn from multivariate standard normal distributions." />
<figcaption aria-hidden="true">Figure 2: Time to compute the Fasano–Franceschini test statistic as a function
of sample size, comparing the brute force and range tree methods for
data of dimensions two through five. Points represent the mean time of
<span class="math inline">\(200\)</span> evaluations. Samples are taken to be of the same size and are
drawn from multivariate standard normal
distributions.</figcaption>
</figure>
<p>As the range tree method has a better asymptotic time complexity, we
expect it to outperform the brute force method for larger sample sizes.
However, for smaller sample sizes, the cost of building the range trees
can outweigh the benefit gained by more efficient querying. As exact
computation times can vary depending on the geometry of the samples, it
is not possible to determine in general when one method will outperform
the other. Despite this, we sought to establish rough benchmarks.
Drawing equal sized samples from multivariate standard normal
distributions, we sought to determine the sample size <span class="math inline">\(N^{*}\)</span> at which
the range tree method becomes more efficient than the brute force method
(Figure <a href="#figure:stat_time" data-reference-type="ref" data-reference="figure:stat_time">2</a>). For <span class="math inline">\(d=2\)</span>, <span class="math inline">\(N^{*}\approx 25\)</span>; for <span class="math inline">\(d=3\)</span>,
<span class="math inline">\(N^{*}\approx 200\)</span>; for <span class="math inline">\(d=4,5\)</span>, and presumably all higher dimensions,
<span class="math inline">\(N^{*}&gt;4000\)</span>. Based on these benchmarking results, our package
automatically selects which of the two methods is likely faster based on
the dimension and samples sizes of the supplied data. If users are
interested in performing more precise benchmarking for their specific
dataset, the argument nPermute can be set equal to <span class="math inline">\(0\)</span>, which bypasses
the permutation test and only computes the test statistic.</p>
<h3 data-number="2.3" id="significance-testing"><span class="header-section-number">2.3</span> Significance testing</h3>
<p>To the best of our knowledge, no results have been published concerning
the distribution of the Fasano–Franceschini test statistic. Any
analysis would likely be complicated by the fact that, unlike the KS
test statistic, the Fasano–Franceschini test statistic is not
distribution free <span class="citation" data-cites="ff1987">(<a href="#ref-ff1987" role="doc-biblioref">Fasano and Franceschini 1987</a>)</span>. In their original paper, <span class="citation" data-cites="ff1987">Fasano and Franceschini (<a href="#ref-ff1987" role="doc-biblioref">1987</a>)</span> did not
attempt any analytical analysis and instead performed simulations to
estimate critical values of their test statistic for various two- and
three-dimensional distributions. By fitting a curve to their results,
<span class="citation" data-cites="press2007">Press et al. (<a href="#ref-press2007" role="doc-biblioref">2007</a>)</span> proposed an explicit formula for <span class="math inline">\(p\)</span>-values in the
two-dimensional case. However, this formula is only approximate, and its
accuracy degrades as sample sizes decrease or the true <span class="math inline">\(p\)</span>-value becomes
large (greater than <span class="math inline">\(0.2\)</span>). While this would still allow a simple
rejection decision at any common significance level, it is sometimes
useful to quantify large <span class="math inline">\(p\)</span>-values more exactly (such as if one was to
do a cross-study concordance analysis comparing <span class="math inline">\(p\)</span>-values between
studies as in <span class="citation" data-cites="ness-cohn_2020">Ness-Cohn et al. (<a href="#ref-ness-cohn_2020" role="doc-biblioref">2020</a>)</span>). Effort could be made to improve this
approximation, however it is still only valid in two dimensions, and
thus an alternative method would be needed in higher dimensions.</p>
<p>To ensure the broadest applicability of the test, we assess significance
using a permutation test. Let
<span class="math inline">\(\mathbf{Z}=(\mathbf{Z}_{1},\dots,\mathbf{Z}_{N})\)</span> be defined by
<span class="math display">\[\mathbf{Z}_{i}=\begin{cases}
\mathbf{X}_{i},&amp;1\leq i\leq n_{1}\\
\mathbf{Y}_{i-n_{1}},&amp;n_{1}+1\leq i\leq N
\end{cases}\]</span> where <span class="math inline">\(N=n_{1}+n_{2}\)</span>. The test statistic in
(<a href="#eq:test_stat" data-reference-type="ref" data-reference="eq:test_stat">3</a>) can then be written as
<span class="math display">\[\mathcal{D}(\mathbf{Z})=\mathcal{D}(\mathbf{X},\mathbf{Y}).\]</span> Denote
the symmetric group on <span class="math inline">\(\{1,\dots,n\}\subset\mathbb{N}\)</span> by <span class="math inline">\(S_{n}\)</span>. For
<span class="math inline">\(\mathbf{x}=(\mathbf{x}_{1},\dots,\mathbf{x}_{n})\)</span> and
<span class="math inline">\(\sigma\in S_{n}\)</span>, define
<span class="math display">\[\mathbf{x}_{\sigma}=(\mathbf{x}_{\sigma(1)},\dots,\mathbf{x}_{\sigma(n)}).\]</span>
Under the null hypothesis, <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{Y}\)</span> were drawn from
the same distribution, and thus the elements of <span class="math inline">\(\mathbf{Z}\)</span> are
exchangeable. We can therefore compute the permutation test p-value
<span class="math display">\[p=\frac{\sum_{\sigma\in S_{N}}I(\mathcal{D}(\mathbf{Z}_{\sigma})\geq\mathcal{D}(\mathbf{Z}))}{N!}\]</span>
where <span class="math inline">\(I\)</span> denotes the indicator function
<span class="citation" data-cites="hemerik2018 ramdas2022permutation">(<a href="#ref-hemerik2018" role="doc-biblioref">Hemerik and Goeman 2018</a>; <a href="#ref-ramdas2022permutation" role="doc-biblioref">Ramdas et al. 2022</a>)</span>. As it is generally infeasible to
iterate over all <span class="math inline">\(N!\)</span> permutations, we can instead consider for
<span class="math inline">\(M\in\mathbb{N}\)</span>
<span class="math display">\[p_{M}=\frac{1+\sum_{m=1}^{M}I(\mathcal{D}(\mathbf{Z}_{\sigma_{m}})\geq\mathcal{D}(\mathbf{Z}))}{1+M}\]</span>
where <span class="math inline">\(\sigma_{1},\dots,\sigma_{M}\)</span> are independent permutations drawn
uniformly from <span class="math inline">\(S_{N}\)</span>. This <span class="math inline">\(p\)</span>-value is valid, as under the null
hypothesis
<span class="math display">\[\mathbb{P}(p_{m}\leq\alpha)\leq\alpha \ \forall\alpha\in[0,1].\]</span>
Moreover, <span class="math inline">\(p_{M}\to p\)</span> almost surely. These results hold for any
sampling distributions (continuous, discrete, or mixed) and any valid
test statistic <span class="citation" data-cites="hemerik2018 ramdas2022permutation">(<a href="#ref-hemerik2018" role="doc-biblioref">Hemerik and Goeman 2018</a>; <a href="#ref-ramdas2022permutation" role="doc-biblioref">Ramdas et al. 2022</a>)</span>.</p>
<figure id="figure:pvalues">
<img src="figures/fig3.png" alt="Figure 3: Type I error rate of the test using p_{M} and p_{M}&#39; as dimension increases. Samples are both of size 10 and are drawn from standard multivariate normal distributions of the specified dimension. The number of permutations used is 100, and the error rate is estimated using 10^{5} replications." />
<figcaption aria-hidden="true">Figure 3: Type I error rate of the test using <span class="math inline">\(p_{M}\)</span> and <span class="math inline">\(p_{M}&#39;\)</span> as dimension
increases. Samples are both of size <span class="math inline">\(10\)</span> and are drawn from standard
multivariate normal distributions of the specified dimension. The number
of permutations used is <span class="math inline">\(100\)</span>, and the error rate is estimated using
<span class="math inline">\(10^{5}\)</span> replications.</figcaption>
</figure>
<p>Under certain conditions (see Proposition 2 of <span class="citation" data-cites="hemerik2018">Hemerik and Goeman (<a href="#ref-hemerik2018" role="doc-biblioref">2018</a>)</span>), the
permutation test using the <span class="math inline">\(p\)</span>-value <span class="math inline">\(p_{M}\)</span> is exact, which is to say
that under the null hypothesis
<span class="math display">\[\mathbb{P}(p_{m}\leq\alpha)=\alpha \ \forall\alpha\in[0,1].\]</span> However,
when there is a nonzero probability of ties in the test statistic, this
test can be quite conservative <span class="citation" data-cites="hemerik2018">(<a href="#ref-hemerik2018" role="doc-biblioref">Hemerik and Goeman 2018</a>)</span>. In such cases, the test
can be made exact by instead using
<span class="math display">\[p_{M}&#39;=\frac{\sum_{m=1}^{M}I(\mathcal{D}(\mathbf{Z}_{\sigma_{m}})&gt;\mathcal{D}(\mathbf{Z}))}{1+M}+U\frac{1+\sum_{m=1}^{M}I(\mathcal{D}(\mathbf{Z}_{\sigma_{m}})=\mathcal{D}(\mathbf{Z}))}{1+M}\,,\]</span>
where <span class="math inline">\(U\sim\mathrm{Unif}(0,1)\)</span> <span class="citation" data-cites="hoeffding1952 hemerik2018">(<a href="#ref-hoeffding1952" role="doc-biblioref">Hoeffding 1952</a>; <a href="#ref-hemerik2018" role="doc-biblioref">Hemerik and Goeman 2018</a>)</span>. The fact
that <span class="math inline">\(p_{M}&#39;\)</span> is randomized is not inherently problematic, since it is
already randomized due to the selection of random permutations
<span class="citation" data-cites="hemerik2018">(<a href="#ref-hemerik2018" role="doc-biblioref">Hemerik and Goeman 2018</a>)</span>.</p>
<p>As the test statistic in
(<a href="#eq:test_stat" data-reference-type="ref" data-reference="eq:test_stat">3</a>) is discrete, ties are possible, and thus the
test using <span class="math inline">\(p_{M}\)</span> is generally conservative. In high dimensions, ties
can become quite prevalent, leading the type I error rate to decrease
dramatically (Figure <a href="#figure:pvalues" data-reference-type="ref" data-reference="figure:pvalues">3</a>). We thus use <span class="math inline">\(p_{M}&#39;\)</span> as our <span class="math inline">\(p\)</span>-value
instead of <span class="math inline">\(p_{M}\)</span>. As a final remark, we note that if the test
statistic is scaled by a constant scalar, <span class="math inline">\(p_{M}&#39;\)</span> remains unchanged
since both indicator functions are invariant under scalar rescaling of
<span class="math inline">\(\mathcal{D}\)</span>. Therefore, the outcome of the test does not depend on our
choice to use the integer-valued test statistic <span class="math inline">\(\mathcal{D}\)</span> in
(<a href="#eq:test_stat" data-reference-type="ref" data-reference="eq:test_stat">3</a>) over Fasano and Franceschini’s original test
statistic <span class="math inline">\(\mathcal{D}_{0}\)</span> in
(<a href="#eq:ff_stat" data-reference-type="ref" data-reference="eq:ff_stat">2</a>).</p>
<h2 data-number="3" id="package-overview"><span class="header-section-number">3</span> Package overview</h2>
<p>The fasano.franceschini.test package is written primarily in C++, and
interfaces with R using <a href="https://CRAN.R-project.org/package=Rcpp">Rcpp</a>
<span class="citation" data-cites="rcpp">(<a href="#ref-rcpp" role="doc-biblioref">Eddelbuettel et al. 2022</a>)</span>. The C++ range tree class <span class="citation" data-cites="rtreeGithub">(<a href="#ref-rtreeGithub" role="doc-biblioref">Weihs 2020</a>)</span> was based on the
description in <span class="citation" data-cites="geometry_2008">Berg et al. (<a href="#ref-geometry_2008" role="doc-biblioref">2008</a>)</span>, including an implementation of fractional
cascading. The permutation test is parallelized using
<a href="https://CRAN.R-project.org/package=RcppParallel">RcppParallel</a>
<span class="citation" data-cites="rcppparallel">(<a href="#ref-rcppparallel" role="doc-biblioref">Allaire et al. 2022</a>)</span>. The package consists of one function,
fasano.franceschini.test, for performing the two-sample
Fasano–Franceschini test. The arguments of this function are described
below.</p>
<ul>
<li><p>S1 and S2: the two samples to compare. Both should be either numeric
matrix or data.frame objects with the same number of columns.</p></li>
<li><p>nPermute: the number of permutations to use for performing the
permutation test. The default is <span class="math inline">\(100\)</span>. If set equal to <span class="math inline">\(0\)</span>, the
permutation test is bypassed and only the test statistic is
computed.</p></li>
<li><p>threads: the number of threads to use when performing the
permutation test. The default is one thread. This parameter can also
be set to "auto", which uses the value returned by
RcppParallel::defaultNumThreads().</p></li>
<li><p>seed: an optional seed for the pseudorandom number generator (PRNG)
used during the permutation test.</p></li>
<li><p>verbose: whether to display a progress bar while performing the
permutation test. The default is TRUE. This functionality is only
available when threads = 1.</p></li>
<li><p>method: an optional character indicating which method to use to
compute the test statistic. The two methods are ‘r’ (range tree) and
‘b’ (brute force). Both methods return the same results but may vary
in computation speed. If this argument is not passed, the sample
sizes and dimension of the data are used to infer which method is
likely faster.</p></li>
</ul>
<p>The output is an object of the class htest, and consists of the
following components:</p>
<ul>
<li><p>statistic: the value of the test statistic.</p></li>
<li><p>p.value: the permutation test p-value.</p></li>
<li><p>method: the name of the test (i.e. ‘Fasano-Franceschini Test’).</p></li>
<li><p>data.name: the names of the original data objects.</p></li>
</ul>
<h2 data-number="4" id="examples"><span class="header-section-number">4</span> Examples</h2>
<p>Here we demonstrate the basic usage and features of the
fasano.franceschini.test package. We begin by loading the necessary
libraries and setting a seed for reproducibility.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/braunlab-nu/fasano.franceschini.test'>fasano.franceschini.test</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Note that to produce reproducible results, we need to set two seeds: the
<code>set.seed</code> function sets the seed in R, ensuring we draw reproducible
samples; and the seed passed as an argument to the
<code>fasano.franceschini.test</code> function sets the seed for the C++ PRNG,
ensuring we compute reproducible <span class="math inline">\(p\)</span>-values.</p>
<p>As a first example, we draw two samples from the bivariate standard
normal distribution. The Fasano–Franceschini test fails to reject the
null hypothesis — that the samples were drawn from the same
distribution — at an <span class="math inline">\(\alpha=0.05\)</span> significance level.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>S1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>50</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>S2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>75</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/fasano.franceschini.test/man/fasano.franceschini.test.html'>fasano.franceschini.test</a></span><span class='op'>(</span><span class='va'>S1</span>, <span class='va'>S2</span>, seed <span class='op'>=</span> <span class='fl'>1</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
    Fasano-Franceschini Test

data:  S1 and S2
D = 1425, p-value = 0.5247</code></pre>
</div>
<p>We next draw two samples from bivariate normal distributions with
identical covariance matrices but different locations. The test rejects
the null hypothesis at an <span class="math inline">\(\alpha=0.05\)</span> significance level.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>S3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>40</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>S4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>42</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/fasano.franceschini.test/man/fasano.franceschini.test.html'>fasano.franceschini.test</a></span><span class='op'>(</span><span class='va'>S3</span>, <span class='va'>S4</span>, seed <span class='op'>=</span> <span class='fl'>2</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
    Fasano-Franceschini Test

data:  S3 and S4
D = 1932, p-value = 0.001832</code></pre>
</div>
<p>The test can take a while to run when the sample sizes or the dimension
of the data are large, in which case it is useful to use multiple
threads to speed up computation.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>S5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1000</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span>, Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>S6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>600</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span>, Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/fasano.franceschini.test/man/fasano.franceschini.test.html'>fasano.franceschini.test</a></span><span class='op'>(</span><span class='va'>S5</span>, <span class='va'>S6</span>, seed <span class='op'>=</span> <span class='fl'>3</span>, threads <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
    Fasano-Franceschini Test

data:  S5 and S6
D = 257800, p-value = 0.0007002</code></pre>
</div>
<p>Note that the number of threads used does not affect the results. In
particular, as long as the same seed is used, the same <span class="math inline">\(p\)</span>-value is
returned for any number of threads.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/fasano.franceschini.test/man/fasano.franceschini.test.html'>fasano.franceschini.test</a></span><span class='op'>(</span><span class='va'>S5</span>, <span class='va'>S6</span>, seed <span class='op'>=</span> <span class='fl'>3</span>, threads <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
    Fasano-Franceschini Test

data:  S5 and S6
D = 257800, p-value = 0.0007002</code></pre>
</div>
<h2 data-number="5" id="comparison-with-other-r-packages"><span class="header-section-number">5</span> Comparison with other R packages</h2>
<p>In this section, we compare the fasano.franceschini.test package with
three other CRAN packages that perform multivariate two-sample
goodness-of-fit tests.</p>
<h3 data-number="5.1" id="peacock.test"><span class="header-section-number">5.1</span> Peacock.test</h3>
<p>The <a href="https://CRAN.R-project.org/package=Peacock.test">Peacock.test</a>
package <span class="citation" data-cites="peacockR">(<a href="#ref-peacockR" role="doc-biblioref">Xiao 2016</a>)</span> provides functions to compute Peacock’s test
statistic <span class="citation" data-cites="peacock_1983">(<a href="#ref-peacock_1983" role="doc-biblioref">Peacock 1983</a>)</span> in two and three dimensions. As no function is
provided to compute <span class="math inline">\(p\)</span>-values, we cannot directly compare the
performance of this package with the fasano.franceschini.test package.
However, a treatment of the power of both Peacock and
Fasano–Franceschini tests can be found in both the primary literature
<span class="citation" data-cites="peacock_1983 ff1987">(<a href="#ref-peacock_1983" role="doc-biblioref">Peacock 1983</a>; <a href="#ref-ff1987" role="doc-biblioref">Fasano and Franceschini 1987</a>)</span> and in a subsequent benchmarking paper
<span class="citation" data-cites="lopes_2007">(<a href="#ref-lopes_2007" role="doc-biblioref">Lopes et al. 2007</a>)</span>, which found that the two tests have similar power across
a variety of alternatives.</p>
<h3 data-number="5.2" id="cramer"><span class="header-section-number">5.2</span> cramer</h3>
<p>The <a href="https://CRAN.R-project.org/package=cramer">cramer</a> package
<span class="citation" data-cites="cramerR">(<a href="#ref-cramerR" role="doc-biblioref">Franz 2019</a>)</span> implements the two-sample test described in <span class="citation" data-cites="baringhaus_2004">Baringhaus and Franz (<a href="#ref-baringhaus_2004" role="doc-biblioref">2004</a>)</span>,
which the authors refer to as the Cramér test. The Cramér test statistic
is based on the Euclidean inter-point distances between the two samples,
and is given by
<span class="math display">\[T_{m,n}=\frac{mn}{m+n}\left(\frac{2}{mn}\sum_{i=1}^{m}\sum_{j=1}^{n}\phi\left(\left\lVert\mathbf{X}_{i}-\mathbf{Y}_{j}\right\rVert_{2}^{2}\right)-\frac{1}{m^{2}}\sum_{i,j=1}^{m}\phi\left(\left\lVert\mathbf{X}_{i}-\mathbf{X}_{j}\right\rVert_{2}^{2}\right)-\frac{1}{n^{2}}\sum_{i,j=1}^{n}\phi\left(\left\lVert\mathbf{Y}_{i}-\mathbf{Y}_{j}\right\rVert_{2}^{2}\right)\right)\]</span>
for samples <span class="math inline">\(\mathbf{X}_{1},\dots,\mathbf{X}_{m}\)</span> and
<span class="math inline">\(\mathbf{Y}_{1},\dots,\mathbf{Y}_{n}\)</span>. The default kernel function is
<span class="math inline">\(\phi(x)=\sqrt{x}/2\)</span>, although several other choices are implemented
(see the documentation for more details). Several randomization methods
are provided to compute <span class="math inline">\(p\)</span>-values, including bootstrapping (the
default) and a permutation test.</p>
<h3 data-number="5.3" id="diproperm"><span class="header-section-number">5.3</span> diproperm</h3>
<p>The <a href="https://CRAN.R-project.org/package=diproperm">diproperm</a> package
<span class="citation" data-cites="dipropermR">(<a href="#ref-dipropermR" role="doc-biblioref">Allmon et al. 2021</a>)</span> implements the DiProPerm test introduced by
<span class="citation" data-cites="diproperm_original">Wei et al. (<a href="#ref-diproperm_original" role="doc-biblioref">2016</a>)</span>. A binary linear classifier is first trained to
determine a separating hyperplane between the two samples. The data are
then projected onto the normal vector to the hyperplane, and the test
statistic is taken to be a univariate statistic of the projected data
(by default the absolute difference of means). As in the
fasano.franceschini.test package, significance is determined using a
permutation test.</p>
<h3 data-number="5.4" id="power-comparison"><span class="header-section-number">5.4</span> Power comparison</h3>
<p>To compare the fasano.franceschini.test package with the cramer and
diproperm packages, we performed power analyses using three classes of
alternatives: location alternatives, where the means of the marginals
are varied; dispersion alternatives, where the variances of the
marginals are varied; and copula alternatives, where the marginals
remain fixed but the copula joining them is varied.</p>
<figure id="figure:power_dist">
<img src="figures/fig4.png" alt="Figure 4: Visualization of the distributions used in power analyses. Each plot shows two samples consisting of 10000 points each. The first sample S_{1} is shown in blue, and the second sample S_{2} is shown in red. (a) S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}) and S_{2}\sim N_{2}(\mathbf{0.4},\mathbf{I}_{2}). (b) S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}) and S_{2}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}+1.5). (c) S_{1}\sim G_{2}(0) and S_{2}\sim G_{2}(0.6). (d) S_{1}\sim C_{2}(1) and S_{2}\sim C_{2}(8)." />
<figcaption aria-hidden="true">Figure 4: Visualization of the distributions used in power analyses. Each plot
shows two samples consisting of <span class="math inline">\(10000\)</span> points each. The first sample
<span class="math inline">\(S_{1}\)</span> is shown in blue, and the second sample <span class="math inline">\(S_{2}\)</span> is shown in red.
(a) <span class="math inline">\(S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2})\)</span> and
<span class="math inline">\(S_{2}\sim N_{2}(\mathbf{0.4},\mathbf{I}_{2})\)</span>. (b)
<span class="math inline">\(S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2})\)</span> and
<span class="math inline">\(S_{2}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}+1.5)\)</span>. (c)
<span class="math inline">\(S_{1}\sim G_{2}(0)\)</span> and <span class="math inline">\(S_{2}\sim G_{2}(0.6)\)</span>. (d)
<span class="math inline">\(S_{1}\sim C_{2}(1)\)</span> and
<span class="math inline">\(S_{2}\sim C_{2}(8)\)</span>.</figcaption>
</figure>
<p>For location and dispersion alternatives, we used multivariate normal
distributions. We denote the <span class="math inline">\(d\)</span>-dimensional normal distribution with
mean <span class="math inline">\(\boldsymbol\mu\in\mathbb{R}^{d}\)</span> and covariance matrix
<span class="math inline">\(\boldsymbol\Sigma\in\mathbb{R}^{d\times d}\)</span> by
<span class="math inline">\(N_{d}(\boldsymbol\mu,\boldsymbol\Sigma)\)</span>, and sample from it using the
<a href="https://CRAN.R-project.org/package=MASS">MASS</a> package <span class="citation" data-cites="mass">(<a href="#ref-mass" role="doc-biblioref">Ripley 2021</a>)</span>. The
<span class="math inline">\(d\times d\)</span> identity matrix, which is sometimes used as a covariance
matrix, is denoted by <span class="math inline">\(\mathbf{I}_{d}\)</span>. For copula alternatives, we
consider the Gaussian copula with correlation matrix
<span class="math display">\[[\mathbf{P}(\rho)]_{ij}=\begin{cases}
\rho,&amp;i\neq j\\
1,&amp;i=j
\end{cases}\]</span> and the Clayton copula with parameter
<span class="math inline">\(\theta\in[-1,\infty)\setminus\{0\}\)</span>. We denote the <span class="math inline">\(d\)</span>-dimensional
distribution with standard normal marginals joined by a Gaussian copula
with correlation matrix <span class="math inline">\(\mathbf{P}(\rho)\)</span> by <span class="math inline">\(G_{d}(\rho)\)</span>. We denote
the <span class="math inline">\(d\)</span>-dimensional distribution with standard normal marginals joined
by a Clayton copula with parameter <span class="math inline">\(\theta\)</span> by <span class="math inline">\(C_{d}(\theta)\)</span>. Both
distributions are sampled from using the
<a href="https://CRAN.R-project.org/package=copula">copula</a> package <span class="citation" data-cites="copulaR">(<a href="#ref-copulaR" role="doc-biblioref">Hofert et al. 2022</a>)</span>.
Examples of distributions in each of these four families are shown in
Figure <a href="#figure:power_dist" data-reference-type="ref" data-reference="figure:power_dist">4</a>.</p>
<p>In the following analyses, power was approximated using <span class="math inline">\(1000\)</span>
replications, a significance level of <span class="math inline">\(\alpha=0.05\)</span> was used, all
samples were of size <span class="math inline">\(40\)</span>, and all R functions implementing tests were
called using their default arguments. Although we aimed to cover a wide
range of distributions in this analysis, absent any theoretical results
concerning these three tests, we cannot guarantee that the results here
are generalizable to different sampling distributions or sample sizes.</p>
<figure id="figure:bivariate_power">
<img src="figures/fig5.png" alt="Figure 5: Comparison of power of the Fasano–Franceschini, Cramér, and DiProPerm tests on various bivariate alternatives. (a) Location alternatives, with S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}) and S_{2}\sim N_{2}(\boldsymbol\mu,\mathbf{I}_{2}). (b) Dispersion alternatives, with S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}) and S_{2}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}+\varepsilon). (c) Gaussian copula alternatives, with S_{1}\sim G_{2}(0) and S_{2}\sim G_{2}(\rho). (d) Clayton copula alternatives, with S_{1}\sim C_{2}(1) and S_{2}\sim C_{2}(\theta)." />
<figcaption aria-hidden="true">Figure 5: Comparison of power of the Fasano–Franceschini, Cramér, and DiProPerm
tests on various bivariate alternatives. (a) Location alternatives, with
<span class="math inline">\(S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2})\)</span> and
<span class="math inline">\(S_{2}\sim N_{2}(\boldsymbol\mu,\mathbf{I}_{2})\)</span>. (b) Dispersion
alternatives, with <span class="math inline">\(S_{1}\sim N_{2}(\mathbf{0},\mathbf{I}_{2})\)</span> and
<span class="math inline">\(S_{2}\sim N_{2}(\mathbf{0},\mathbf{I}_{2}+\varepsilon)\)</span>. (c) Gaussian
copula alternatives, with <span class="math inline">\(S_{1}\sim G_{2}(0)\)</span> and
<span class="math inline">\(S_{2}\sim G_{2}(\rho)\)</span>. (d) Clayton copula alternatives, with
<span class="math inline">\(S_{1}\sim C_{2}(1)\)</span> and
<span class="math inline">\(S_{2}\sim C_{2}(\theta)\)</span>.</figcaption>
</figure>
<p>We first examined the power of the tests on various bivariate
alternatives (Figure <a href="#figure:bivariate_power" data-reference-type="ref" data-reference="figure:bivariate_power">5</a>). All three tests had similar power
across location alternatives, although the Cramér and DiProPerm tests
did outperform the Fasano–Franceschini test. Across dispersion
alternatives, the Cramér and Fasano–Franceschini tests had very similar
powers. On Gaussian copula alternatives, the Fasano–Franceschini test
had a consistently higher power than the Cramér test. This was also the
case with Clayton copula alternatives, although none of the tests were
able to achieve high power. The DiProPerm test was unable to achieve a
power above the significance level of <span class="math inline">\(\alpha=0.05\)</span> on any of the
dispersion or copula alternatives. This is likely due to the fact that
in these instances, there is significant overlap between the high
density regions of the two sampling distributions, making it difficult
to find a separating hyperplane between samples drawn from them.</p>
<figure id="figure:dimension_power">
<img src="figures/fig6.png" alt="Figure 6: Comparison of power of the Fasano–Franceschini, Cramér, and DiProPerm tests on fixed alternatives as the dimension of the data increases. (a) Location alternative, with S_{1}\sim N_{d}(\mathbf{0},\mathbf{I}_{d}) and S_{2}\sim N_{d}(\mathbf{0.4},\mathbf{I}_{d}). (b) Dispersion alternative, with S_{1}\sim N_{d}(\mathbf{0},\mathbf{I}_{d}) and S_{2}\sim N_{d}(\mathbf{0},\mathbf{I}_{d}+1.5). (c) Gaussian copula alternative, with S_{1}\sim G_{d}(0) and S_{2}\sim G_{d}(0.6). (d) Clayton copula alternative, with S_{1}\sim C_{d}(1) and S_{2}\sim C_{d}(8)." />
<figcaption aria-hidden="true">Figure 6: Comparison of power of the Fasano–Franceschini, Cramér, and DiProPerm
tests on fixed alternatives as the dimension of the data increases. (a)
Location alternative, with <span class="math inline">\(S_{1}\sim N_{d}(\mathbf{0},\mathbf{I}_{d})\)</span>
and <span class="math inline">\(S_{2}\sim N_{d}(\mathbf{0.4},\mathbf{I}_{d})\)</span>. (b) Dispersion
alternative, with <span class="math inline">\(S_{1}\sim N_{d}(\mathbf{0},\mathbf{I}_{d})\)</span> and
<span class="math inline">\(S_{2}\sim N_{d}(\mathbf{0},\mathbf{I}_{d}+1.5)\)</span>. (c) Gaussian copula
alternative, with <span class="math inline">\(S_{1}\sim G_{d}(0)\)</span> and <span class="math inline">\(S_{2}\sim G_{d}(0.6)\)</span>. (d)
Clayton copula alternative, with <span class="math inline">\(S_{1}\sim C_{d}(1)\)</span> and
<span class="math inline">\(S_{2}\sim C_{d}(8)\)</span>.</figcaption>
</figure>
<p>We next examined how the power of the three tests varied when the two
sampling distributions were kept fixed but the dimension of the data
increased (Figure <a href="#figure:dimension_power" data-reference-type="ref" data-reference="figure:dimension_power">6</a>). On the location alternative, the
Cramér and DiProPerm tests again outperformed the Fasano–Franceschini
test. In particular, for <span class="math inline">\(d&gt;5\)</span>, the Fasano–Franceschini steadily lost
power as the dimension increased whereas the other tests gained power.
On the dispersion alternative, the Cramér and Fasano–Franceschini tests
had nearly identical powers through to <span class="math inline">\(d=5\)</span>, but for higher dimensions
the Cramér test consistently outperformed the Fasano–Franceschini test.
On the other hand, for both the Gaussian and Clayton copula alternatives
the Fasano–Franceschini test had a much higher power than the Cramér
test. The DiProPerm test was still unable to attain a power above the
significance level on the dispersion alternatives or either of the
copula alternatives.</p>
<p>Overall, the Cramér and DiProPerm tests performed better than the
Fasano–Franceschini test on location alternatives, especially as
dimension increased. On dispersion alternatives, the
Fasano–Franceschini and Cramér tests had comparable performance for low
dimensions, but the Cramér test maintained a higher power for high
dimensions. However, in these cases the marginal distributions differ,
and thus a multivariate test is not strictly necessary as univariate
tests could be applied to the marginals independently (with a multiple
testing correction) to detect differences between the multivariate
distributions. On copula alternatives, where a multivariate test is
necessary, the Fasano–Franceschini test consistently outperformed both
the Cramér and DiProPerm tests. Thus while the Fasano–Franceschini did
not achieve the highest power in every case, we believe it to be the
best choice as a general purpose multivariate two-sample goodness-of-fit
test.</p>
<h2 data-number="6" id="summary"><span class="header-section-number">6</span> Summary</h2>
<p>This paper introduces the fasano.franceschini.test package, an R
implementation of the multivariate two-sample goodness-of-fit test
described by <span class="citation" data-cites="ff1987">Fasano and Franceschini (<a href="#ref-ff1987" role="doc-biblioref">1987</a>)</span>. We provide users with a computationally efficient
test that is applicable to data of any dimension and of any type
(continuous, discrete, or mixed), and that demonstrates competitive
performance with similar R packages. Complete package documentation and
source code are available via the Comprehensive R Archive Network (CRAN)
at <a href="https://cran.r-project.org/web/packages/fasano.franceschini.test" class="uri">https://cran.r-project.org/web/packages/fasano.franceschini.test</a>
and the package website at
<a href="https://braunlab-nu.github.io/fasano.franceschini.test" class="uri">https://braunlab-nu.github.io/fasano.franceschini.test</a>.</p>
<h2 data-number="7" id="computational-details"><span class="header-section-number">7</span> Computational details</h2>
<p>The results in this paper were obtained using R 4.2.0 with the packages
fasano.franceschini.test 2.2.1, diproperm 0.2.0, cramer 0.9-3, MASS
7.3-60, copula 1.1-2, and
<a href="https://CRAN.R-project.org/package=microbenchmark">microbenchmark</a>
1.4.10 <span class="citation" data-cites="microbenchmarkR">(<a href="#ref-microbenchmarkR" role="doc-biblioref">Mersmann 2023</a>)</span>. Plots were generated using
<a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a> 3.4.2 <span class="citation" data-cites="ggplotR">(<a href="#ref-ggplotR" role="doc-biblioref">Wickham et al. 2023</a>)</span>
and <a href="https://CRAN.R-project.org/package=patchwork">patchwork</a> 1.1.1
<span class="citation" data-cites="patchworkR">(<a href="#ref-patchworkR" role="doc-biblioref">Pedersen 2020</a>)</span>. All computations were done using the Quest high
performance computing facility at Northwestern University.</p>
<h2 data-number="8" id="acknowledgments"><span class="header-section-number">8</span> Acknowledgments</h2>
<p>This research was supported in part through the computational resources
and staff contributions provided for the Quest high performance
computing facility at Northwestern University which is jointly supported
by the Office of the Provost, the Office for Research, and Northwestern
University Information Technology. Funding for this work was provided by
NIH/NIA R01AG068579, Simons Foundation 597491-RWC01, and NSF 1764421-01.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="8.1" id="supplementary-materials"><span class="header-section-number">8.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-067.zip">RJ-2023-067.zip</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-rcppparallel" class="csl-entry" role="listitem">
J. Allaire, R. Francois, K. Ushey, G. Vandenbrouck, M. Geelnard and Intel. <em>RcppParallel: Parallel programming tools for ’rcpp’.</em> 2022. URL <a href="https://CRAN.R-project.org/package=RcppParallel">https://CRAN.R-project.org/package=RcppParallel</a>. R package version 5.1.5.
</div>
<div id="ref-dipropermR" class="csl-entry" role="listitem">
A. G. Allmon, J. S. Marron and M. G. Hudgens. <em>Diproperm: Conduct direction-projection-permutation tests and display plots.</em> 2021. URL <a href="https://CRAN.R-project.org/package=diproperm">https://CRAN.R-project.org/package=diproperm</a>. R package version 0.2.0.
</div>
<div id="ref-atasoy_2017" class="csl-entry" role="listitem">
S. Atasoy, L. Roseman, M. Kaelen, M. L. Kringelbach, G. Deco and R. L. Carhart-Harris. Connectome-harmonic decomposition of human brain activity reveals dynamical repertoire re-organization under <span>LSD</span>. <em>Scientific Reports</em>, 7(1): 1–18, 2017. URL <a href="https://doi.org/10.1038/s41598-017-17546-0">https://doi.org/10.1038/s41598-017-17546-0</a>.
</div>
<div id="ref-baringhaus_2004" class="csl-entry" role="listitem">
L. Baringhaus and C. Franz. On a new multivariate two-sample test. <em>Journal of Multivariate Analysis</em>, 88(1): 190–206, 2004. URL <a href="https://doi.org/10.1016/S0047-259X(03)00079-4">https://doi.org/10.1016/S0047-259X(03)00079-4</a>.
</div>
<div id="ref-bentley_decomposable_1979" class="csl-entry" role="listitem">
J. L. Bentley. Decomposable searching problems. <em>Information Processing Letters</em>, 8(5): 244–251, 1979. URL <a href="https://doi.org/10.1016/0020-0190(79)90117-0">https://doi.org/10.1016/0020-0190(79)90117-0</a>.
</div>
<div id="ref-geometry_2008" class="csl-entry" role="listitem">
M. de Berg, O. Cheong, M. van Kreveld and M. Overmars. <em>Computational <span>Geometry</span>: <span>Algorithms</span> and <span>Applications</span>.</em> 3rd ed Springer Berlin Heidelberg, 2008. URL <a href="https://doi.org/10.1007/978-3-540-77974-2">https://doi.org/10.1007/978-3-540-77974-2</a>.
</div>
<div id="ref-chiang_2018" class="csl-entry" role="listitem">
F. Chiang, O. Mazdiyasni and A. AghaKouchak. Amplified warming of droughts in southern united states in observations and model simulations. <em>Science Advances</em>, 4(8): eaat2380, 2018. URL <a href="https://doi.org/10.1126/sciadv.aat2380">https://doi.org/10.1126/sciadv.aat2380</a>.
</div>
<div id="ref-rcpp" class="csl-entry" role="listitem">
D. Eddelbuettel, R. Francois, J. Allaire, K. Ushey, Q. Kou, N. Russell, I. Ucar, D. Bates and J. Chambers. <em>Rcpp: Seamless r and c++ integration.</em> 2022. URL <a href="https://CRAN.R-project.org/package=Rcpp">https://CRAN.R-project.org/package=Rcpp</a>. R package version 1.0.9.
</div>
<div id="ref-ff1987" class="csl-entry" role="listitem">
G. Fasano and A. Franceschini. A multidimensional version of the <span>Kolmogorov</span>-<span>Smirnov</span> test. <em>Monthly Notices of the Royal Astronomical Society</em>, 225(1): 155–170, 1987. URL <a href="https://doi.org/10.1093/mnras/225.1.155">https://doi.org/10.1093/mnras/225.1.155</a>.
</div>
<div id="ref-cramerR" class="csl-entry" role="listitem">
C. Franz. <em>Cramer: Multivariate nonparametric cramer-test for the two-sample-problem.</em> 2019. URL <a href="https://CRAN.R-project.org/package=cramer">https://CRAN.R-project.org/package=cramer</a>. R package version 0.9-3.
</div>
<div id="ref-hahne_2018" class="csl-entry" role="listitem">
J. M. Hahne, M. A. Schweisfurth, M. Koppe and D. Farina. Simultaneous control of multiple functions of bionic hand prostheses: Performance and robustness in end users. <em>Science Robotics</em>, 3(19): eaat3630, 2018. URL <a href="https://doi.org/10.1126/scirobotics.aat3630">https://doi.org/10.1126/scirobotics.aat3630</a>.
</div>
<div id="ref-hemerik2018" class="csl-entry" role="listitem">
J. Hemerik and J. Goeman. Exact testing with random permutations. <em>TEST</em>, 27(4): 811–825, 2018. URL <a href="https://doi.org/10.1007/s11749-017-0571-1">https://doi.org/10.1007/s11749-017-0571-1</a>.
</div>
<div id="ref-heuchenne_2022" class="csl-entry" role="listitem">
C. Heuchenne and G. Mordant. Using space filling curves to compare two multivariate distributions with distribution-free tests. <em>Journal of Computational and Applied Mathematics</em>, 416: 114494, 2022. URL <a href="https://doi.org/10.1016/j.cam.2022.114494">https://doi.org/10.1016/j.cam.2022.114494</a>.
</div>
<div id="ref-hoeffding1952" class="csl-entry" role="listitem">
W. Hoeffding. The <span>Large</span>-<span>Sample</span> <span>Power</span> of <span>Tests</span> <span>Based</span> on <span>Permutations</span> of <span>Observations</span>. <em>The Annals of Mathematical Statistics</em>, 23(2): 162–192, 1952. URL <a href="https://doi.org/10.1214/aoms/1177729436">https://doi.org/10.1214/aoms/1177729436</a>.
</div>
<div id="ref-copulaR" class="csl-entry" role="listitem">
M. Hofert, I. Kojadinovic, M. Maechler and J. Yan. <em>Copula: Multivariate dependence with copulas.</em> 2022. URL <a href="https://CRAN.R-project.org/package=copula">https://CRAN.R-project.org/package=copula</a>. R package version 1.1-0.
</div>
<div id="ref-justel_1997" class="csl-entry" role="listitem">
A. Justel, D. Peña and R. Zamar. A multivariate <span>Kolmogorov</span>-<span>Smirnov</span> test of goodness of fit. <em>Statistics &amp; Probability Letters</em>, 35(3): 251–259, 1997. URL <a href="https://doi.org/10.1016/S0167-7152(97)00020-5">https://doi.org/10.1016/S0167-7152(97)00020-5</a>.
</div>
<div id="ref-kaczanowska_2021" class="csl-entry" role="listitem">
S. Kaczanowska, D. W. Beury, V. Gopalan, A. K. Tycko, H. Qin, M. E. Clements, J. Drake, C. Nwanze, M. Murgai, Z. Rae, et al. Genetically engineered myeloid cells rebalance the core immune suppression program in metastasis. <em>Cell</em>, 184(8): 2033–2052.e21, 2021. URL <a href="https://doi.org/10.1016/j.cell.2021.02.048">https://doi.org/10.1016/j.cell.2021.02.048</a>.
</div>
<div id="ref-Kolmogorov1933" class="csl-entry" role="listitem">
A. N. Kolmogorov. <span class="nocase">Sulla Determinazione Empirica di Una Legge di Distribuzione</span>. <em>Giornale dell’Istituto Italiano degli Attuari</em>, 4: 83–91, 1933a.
</div>
<div id="ref-Kolmogorov1933a" class="csl-entry" role="listitem">
A. N. Kolmogorov. <span class="nocase">Über die Grenzwertsätze der Wahrscheinlichkeitsrechnung</span>. <em><span>Bull. Acad. Sci. URSS</span></em>, 3: 363–372, 1933b. URL <a href="https://www.mathnet.ru/eng/im5009">https://www.mathnet.ru/eng/im5009</a>.
</div>
<div id="ref-lopes_2007" class="csl-entry" role="listitem">
R. H. C. Lopes, I. Reid and P. R. Hobson. The two-dimensional <span>Kolmogorov</span>-<span>Smirnov</span> test. In <em>XI international workshop on advanced computing and analysis techniques in physics research</em>, 2007. URL <a href="https://bura.brunel.ac.uk/handle/2438/1166">https://bura.brunel.ac.uk/handle/2438/1166</a>.
</div>
<div id="ref-microbenchmarkR" class="csl-entry" role="listitem">
O. Mersmann. <em>Microbenchmark: Accurate timing functions.</em> 2023. URL <a href="https://CRAN.R-project.org/package=microbenchmark">https://CRAN.R-project.org/package=microbenchmark</a>. R package version 1.4.10.
</div>
<div id="ref-naaman_2021" class="csl-entry" role="listitem">
M. Naaman. On the tight constant in the multivariate <span>Dvoretzky</span>–<span>Kiefer</span>–<span>Wolfowitz</span> inequality. <em>Statistics &amp; Probability Letters</em>, 173: 109088, 2021. URL <a href="https://doi.org/10.1016/j.spl.2021.109088">https://doi.org/10.1016/j.spl.2021.109088</a>.
</div>
<div id="ref-ness-cohn_2020" class="csl-entry" role="listitem">
E. Ness-Cohn, M. Iwanaszko, W. L. Kath, R. Allada and R. Braun. <span class="nocase">TimeTrial: An Interactive Application for Optimizing the Design and Analysis of Transcriptomic Time-Series Data in Circadian Biology Research</span>. <em>Journal of Biological Rhythms</em>, 35(5): 439–451, 2020. URL <a href="https://doi.org/10.1177/0748730420934672">https://doi.org/10.1177/0748730420934672</a>. PMID: 32613882.
</div>
<div id="ref-peacock_1983" class="csl-entry" role="listitem">
J. A. Peacock. Two-dimensional goodness-of-fit testing in astronomy. <em>Monthly Notices of the Royal Astronomical Society</em>, 202(3): 615–627, 1983. URL <a href="https://doi.org/10.1093/mnras/202.3.615">https://doi.org/10.1093/mnras/202.3.615</a>.
</div>
<div id="ref-patchworkR" class="csl-entry" role="listitem">
T. L. Pedersen. <em>Patchwork: The composer of plots.</em> 2020. URL <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>. R package version 1.1.1.
</div>
<div id="ref-press2007" class="csl-entry" role="listitem">
W. H. Press, S. A. Teukolsky, W. T. Vetterling and B. P. Flannery. <em>Numerical recipes: The art of scientific computing.</em> 3rd ed USA: Cambridge University Press, 2007. URL <a href="https://doi.org/10.1145/1874391.187410">https://doi.org/10.1145/1874391.187410</a>.
</div>
<div id="ref-ramdas2022permutation" class="csl-entry" role="listitem">
A. Ramdas, R. F. Barber, E. J. Candes and R. J. Tibshirani. Permutation tests using arbitrary permutation distributions. 2022. URL <a href="https://doi.org/10.48550/arXiv.2204.13581">https://doi.org/10.48550/arXiv.2204.13581</a>.
</div>
<div id="ref-mass" class="csl-entry" role="listitem">
B. Ripley. <em>MASS: Support functions and datasets for venables and ripley’s MASS.</em> 2021. URL <a href="https://CRAN.R-project.org/package=MASS">https://CRAN.R-project.org/package=MASS</a>. R package version 7.3-54.
</div>
<div id="ref-Smirnov1944" class="csl-entry" role="listitem">
N. V. Smirnov. Approximate laws of distribution of random variables from empirical data. <em><span>Uspehi Matem. Nauk</span></em>, 10: 179–206, 1944.
</div>
<div id="ref-Smirnov1939" class="csl-entry" role="listitem">
N. V. Smirnov. On the deviations of the empirical distribution curve [in <span>Russian</span>]. <em><span>Rec. Math. N.S. [Mat. Sbornik]</span></em>, 6(48): 3–26, 1939. URL <a href="https://www.mathnet.ru/eng/sm5810">https://www.mathnet.ru/eng/sm5810</a>.
</div>
<div id="ref-Smirnov1937" class="csl-entry" role="listitem">
N. V. Smirnov. On the distribution of the mises <span class="math inline">\(\omega^2\)</span> criterion [in <span>Russian</span>]. <em><span>Rec. Math. N.S. [Mat. Sbornik]</span></em>, 2: 973–993, 1937. URL <a href="https://www.mathnet.ru/eng/sm5636">https://www.mathnet.ru/eng/sm5636</a>.
</div>
<div id="ref-Smirnov1936" class="csl-entry" role="listitem">
N. V. Smirnov. <span class="nocase">Sur la distribution de <span class="math inline">\(\omega^2\)</span> (criterium de M.R. v. Mises)</span>. <em>Com. Rend. Acad. Sci. (Paris)</em>, 202: 449–452, 1936.
</div>
<div id="ref-Smirnov1948" class="csl-entry" role="listitem">
N. V. Smirnov. Table for estimating the goodness of fit of empirical distributions. <em>The Annals of Mathematical Statistics</em>, 1948. URL <a href="https://doi.org/10.1214/aoms/1177730256">https://doi.org/10.1214/aoms/1177730256</a>.
</div>
<div id="ref-diproperm_original" class="csl-entry" role="listitem">
S. Wei, C. Lee, L. Wichers and J. S. Marron. <span class="nocase">Direction-Projection-Permutation for High-Dimensional Hypothesis Tests</span>. <em>Journal of Computational and Graphical Statistics</em>, 25(2): 549–569, 2016. URL <a href="https://doi.org/10.1080/10618600.2015.1027773">https://doi.org/10.1080/10618600.2015.1027773</a>.
</div>
<div id="ref-rtreeGithub" class="csl-entry" role="listitem">
L. Weihs. <span>C++ Range Tree Data Structure</span>. 2020. URL <a href="https://github.com/Lucaweihs/range-tree">https://github.com/Lucaweihs/range-tree</a>.
</div>
<div id="ref-ggplotR" class="csl-entry" role="listitem">
H. Wickham, W. Chang, L. Henry, T. L. Pedersen, K. Takahashi, C. Wilke, K. Woo, H. Yutani and D. Dunnington. <em>ggplot2: Create elegant data visualisations using the grammar of graphics.</em> 2023. URL <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>. R package version 3.4.2.
</div>
<div id="ref-wong_2020" class="csl-entry" role="listitem">
F. Wong and J. J. Collins. Evidence that coronavirus superspreading is fat-tailed. <em>Proceedings of the National Academy of Sciences</em>, 117(47): 29416–29418, 2020. URL <a href="https://doi.org/10.1073/pnas.2018490117">https://doi.org/10.1073/pnas.2018490117</a>.
</div>
<div id="ref-peacockR" class="csl-entry" role="listitem">
Y. Xiao. <em>Peacock.test: Two and three dimensional kolmogorov-smirnov two-sample tests.</em> 2016. URL <a href="https://CRAN.R-project.org/package=Peacock.test">https://CRAN.R-project.org/package=Peacock.test</a>. R package version 1.0.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Puritz, et al., "fasano.franceschini.test: An Implementation of a Multivariate KS Test in R", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-067,
  author = {Puritz, Connor and Ness-Cohn, Elan and Braun, Rosemary},
  title = {fasano.franceschini.test: An Implementation of a Multivariate KS Test in R},
  journal = {The R Journal},
  year = {2023},
  note = {https://doi.org/10.32614/RJ-2023-067},
  doi = {10.32614/RJ-2023-067},
  volume = {15},
  issue = {3},
  issn = {2073-4859},
  pages = {159-171}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
