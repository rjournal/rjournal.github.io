<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>The R Journal: GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters</title>

<meta property="description" itemprop="description" content="Nutrient pollution affects fresh and coastal waters around the globe. Planning mitigating actions requires tools to assess fluxes of nutrient emissions to waters and expected restoration impacts. Conceptual river basin models take advantage of data on nutrient emissions and concentrations at monitoring stations, providing a physical interpretation of monitored conditions, and enabling scenario analysis. The GREENeR package streamlines water quality model in a region of interest, considering nutrient pathways and the hydrological structure of the river network. The package merges data sources, analyzes local conditions, calibrate the model, and assesses yearly nutrient levels along the river network, determining contributions of load in freshwaters from diffuse and point sources. The package is enriched with functions to perform thorough parameter sensitivity analysis and for mapping nutrient sources and fluxes. The functionalities of the package are demonstrated using datasets from the Vistula river basin."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-065/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-12-20"/>
<meta property="article:created" itemprop="dateCreated" content="2023-12-20"/>
<meta name="article:author" content="Angel Udías"/>
<meta name="article:author" content="Bruna Grizzetti"/>
<meta name="article:author" content="Olga Vigiak"/>
<meta name="article:author" content="Alberto Aloe"/>
<meta name="article:author" content="Cesar Alfaro"/>
<meta name="article:author" content="Javier Gomez"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="The R Journal: GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Nutrient pollution affects fresh and coastal waters around the globe. Planning mitigating actions requires tools to assess fluxes of nutrient emissions to waters and expected restoration impacts. Conceptual river basin models take advantage of data on nutrient emissions and concentrations at monitoring stations, providing a physical interpretation of monitored conditions, and enabling scenario analysis. The GREENeR package streamlines water quality model in a region of interest, considering nutrient pathways and the hydrological structure of the river network. The package merges data sources, analyzes local conditions, calibrate the model, and assesses yearly nutrient levels along the river network, determining contributions of load in freshwaters from diffuse and point sources. The package is enriched with functions to perform thorough parameter sensitivity analysis and for mapping nutrient sources and fluxes. The functionalities of the package are demonstrated using datasets from the Vistula river basin."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-065/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2023-065/figures/fig1.png"/>
<meta property="og:image:width" content="720"/>
<meta property="og:image:height" content="1040"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="The R Journal: GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters"/>
<meta property="twitter:description" content="Nutrient pollution affects fresh and coastal waters around the globe. Planning mitigating actions requires tools to assess fluxes of nutrient emissions to waters and expected restoration impacts. Conceptual river basin models take advantage of data on nutrient emissions and concentrations at monitoring stations, providing a physical interpretation of monitored conditions, and enabling scenario analysis. The GREENeR package streamlines water quality model in a region of interest, considering nutrient pathways and the hydrological structure of the river network. The package merges data sources, analyzes local conditions, calibrate the model, and assesses yearly nutrient levels along the river network, determining contributions of load in freshwaters from diffuse and point sources. The package is enriched with functions to perform thorough parameter sensitivity analysis and for mapping nutrient sources and fluxes. The functionalities of the package are demonstrated using datasets from the Vistula river basin."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-065/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2023-065/figures/fig1.png"/>
<meta property="twitter:image:width" content="720"/>
<meta property="twitter:image:height" content="1040"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="The R Journal: GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-065"/>
<meta name="citation_pdf_url" content="RJ-2023-065.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="3"/>
<meta name="citation_doi" content="10.32614/RJ-2023-065"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="119"/>
<meta name="citation_lastpage" content="137"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/12/20"/>
<meta name="citation_publication_date" content="2023/12/20"/>
<meta name="citation_author" content="Angel Udías"/>
<meta name="citation_author_institution" content="European Commission, Joint Research Centre (JRC)"/>
<meta name="citation_author" content="Bruna Grizzetti"/>
<meta name="citation_author_institution" content="European Commission, Joint Research Centre (JRC)"/>
<meta name="citation_author" content="Olga Vigiak"/>
<meta name="citation_author_institution" content="European Commission, Joint Research Centre (JRC)"/>
<meta name="citation_author" content="Alberto Aloe"/>
<meta name="citation_author_institution" content="European Commission, Joint Research Centre (JRC)"/>
<meta name="citation_author" content="Cesar Alfaro"/>
<meta name="citation_author_institution" content="Departament of Computer Science and Statistics, Rey Juan Carlos University"/>
<meta name="citation_author" content="Javier Gomez"/>
<meta name="citation_author_institution" content="Departament of Computer Science and Statistics, Rey Juan Carlos University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Goodness-of-fit criteria for hydrological models: Model calibration and performance assessment;citation_publisher=Elsevier;citation_volume=600;citation_doi=10.1016/j.jhydrol.2021.126674;citation_author=Daniel Althoff;citation_author=Lineu Neiva Rodrigues"/>
  <meta name="citation_reference" content="citation_title=Climate change impact on riverine nutrient load and land-based remedial measures of the baltic sea action plan;citation_publisher=Springer;citation_volume=41;citation_doi=10.1007/s13280-012-0323-0;citation_author=Berit Arheimer;citation_author=Joel Dahné;citation_author=Chantal Donnelly"/>
  <meta name="citation_reference" content="citation_title=Future socioeconomic conditions may have a larger impact than climate change on nutrient loads to the baltic sea;citation_publisher=Springer;citation_volume=48;citation_doi=10.1007/s13280-019-01243-5;citation_author=Alena Bartosova;citation_author=René Capell;citation_author=Jørgen E Olesen;citation_author=Mohamed Jabloun;citation_author=Jens Christian Refsgaard;citation_author=Chantal Donnelly;citation_author=Kari Hyytiäinen;citation_author=Sampo Pihlainen;citation_author=Marianne Zandersen;citation_author=Berit Arheimer"/>
  <meta name="citation_reference" content="citation_title=Exploring river nitrogen and phosphorus loading and export to global coastal waters in the shared socio-economic pathways;citation_volume=72;citation_doi=https://doi.org/10.1016/j.gloenvcha.2021.102426;citation_issn=0959-3780;citation_author=A. H. W. Beusen;citation_author=J. C. Doelman;citation_author=L. P. H. Van Beek;citation_author=P. J. T. M. Van Puijenbroek;citation_author=J. M. Mogollón;citation_author=H. J. M. Van Grinsven;citation_author=E. Stehfest;citation_author=D. P. Van Vuuren;citation_author=A. F. Bouwman"/>
  <meta name="citation_reference" content="citation_title=Scenario analysis for nutrient emission reduction in the european inland waters;citation_publisher=IOP Publishing;citation_volume=9;citation_doi=10.1088/1748-9326/9/12/125007;citation_author=F Bouraoui;citation_author=V Thieu;citation_author=B Grizzetti;citation_author=W Britz;citation_author=G Bidoglio"/>
  <meta name="citation_reference" content="citation_title=Identifying parametric controls and dependencies in integrated assessment models using global sensitivity analysis;citation_publisher=Elsevier;citation_volume=59;citation_doi=10.1016/j.envsoft.2014.05.001;citation_author=Martha P Butler;citation_author=Patrick M Reed;citation_author=Karen Fisher-Vanden;citation_author=Klaus Keller;citation_author=Thorsten Wagener"/>
  <meta name="citation_reference" content="citation_title=Lhs: Latin hypercube samples;citation_author=Rob Carnell"/>
  <meta name="citation_reference" content="citation_title=Do nash values have value? Discussion and alternate proposals;citation_publisher=Citeseer;citation_volume=22;citation_doi=10.1002/hyp.7072;citation_author=Robert E Criss;citation_author=William E Winston"/>
  <meta name="citation_reference" content="citation_title=Rivers and catchments of europe-catchment characterisation model (CCM);citation_author=A De Jager;citation_author=J Vogt"/>
  <meta name="citation_reference" content="citation_title=An advanced regularization methodology for use in watershed model calibration;citation_publisher=Elsevier;citation_volume=327;citation_doi=10.1016/j.jhydrol.2005.11.058;citation_author=John Doherty;citation_author=Brian E Skahill"/>
  <meta name="citation_reference" content="citation_title=European Environment Agency (EEA);citation_author= EEA"/>
  <meta name="citation_reference" content="citation_title=The data analysis handbook;citation_publisher=Elsevier;citation_author=Ildiko E Frank;citation_author=Roberto Todeschini"/>
  <meta name="citation_reference" content="citation_title=A review of catchment-scale water quality and erosion models and a synthesis of future prospects;citation_publisher=Elsevier;citation_volume=114;citation_doi=10.1016/j.envsoft.2018.12.008;citation_author=Baihua Fu;citation_author=Wendy S Merritt;citation_author=Barry FW Croke;citation_author=Tony R Weber;citation_author=Anthony J Jakeman"/>
  <meta name="citation_reference" content="citation_title=A statistical method for source apportionment of riverine nitrogen loads;citation_publisher=Elsevier;citation_volume=304;citation_doi=10.1016/j.jhydrol.2004.07.036;citation_author=B Grizzetti;citation_author=F Bouraoui;citation_author=G De Marsily;citation_author=G Bidoglio"/>
  <meta name="citation_reference" content="citation_title=Assessing nitrogen pressures on european surface water;citation_publisher=Wiley Online Library;citation_volume=22;citation_doi=10.1029/2007GB003085;citation_author=B Grizzetti;citation_author=F Bouraoui;citation_author=G De Marsily"/>
  <meta name="citation_reference" content="citation_title=Changes of nitrogen and phosphorus loads to european seas;citation_publisher=Wiley Online Library;citation_volume=18;citation_doi=10.1111/j.1365-2486.2011.02576.x;citation_author=Bruna Grizzetti;citation_author=Fayçal Bouraoui;citation_author=Alberto Aloe"/>
  <meta name="citation_reference" content="citation_title=How EU policies could reduce nutrient pollution in european inland and coastal waters;citation_publisher=Elsevier;citation_volume=69;citation_doi=10.1016/j.gloenvcha.2021.102281;citation_author=Bruna Grizzetti;citation_author=Olga Vigiak;citation_author=Angel Udias;citation_author=Alberto Aloe;citation_author=Michela Zanni;citation_author=Faycal Bouraoui;citation_author=Alberto Pistocchi;citation_author=Chiara Dorati;citation_author=Rene Friedland;citation_author=Ad De Roo;citation_author=How EU policies could reduce nutrient pollution in european inland and coastal waters"/>
  <meta name="citation_reference" content="citation_title=Toward improved calibration of hydrologic models: Multiple and noncommensurable measures of information;citation_publisher=Wiley Online Library;citation_volume=34;citation_doi=10.1029/97WR03495;citation_author=Hoshin Vijai Gupta;citation_author=Soroosh Sorooshian;citation_author=Patrice Ogou Yapo"/>
  <meta name="citation_reference" content="citation_title=Decomposition of the mean squared error and NSE performance criteria: Implications for improving hydrological modelling;citation_publisher=Elsevier;citation_volume=377;citation_doi=10.1016/j.jhydrol.2009.08.003;citation_author=Hoshin V Gupta;citation_author=Harald Kling;citation_author=Koray K Yilmaz;citation_author=Guillermo F Martinez"/>
  <meta name="citation_reference" content="citation_title=Fourth baltic sea load compilation (PLC-4);citation_number=93;citation_author=Helsinki Commission HELCOM"/>
  <meta name="citation_reference" content="citation_title=Real-time forecasting with a conceptual hydrologic model: 2. Applications and results;citation_publisher=Wiley Online Library;citation_volume=16;citation_doi=10.1029/WR016i006p01034;citation_author=Peter K Kitanidis;citation_author=Rafael L Bras"/>
  <meta name="citation_reference" content="citation_title=Comparison of different efficiency criteria for hydrological model assessment;citation_publisher=Copernicus GmbH;citation_volume=5;citation_doi=10.5194/adgeo-5-89-2005;citation_author=Peter Krause;citation_author=DP Boyle;citation_author=Frank Bäse"/>
  <meta name="citation_reference" content="citation_title=Nutrient retention handbook;citation_author=Brian Kronvang;citation_author=Josef Hezlar;citation_author=Paul Boers;citation_author=Jens P Jensen;citation_author=Horst Behrendt;citation_author=Tom Anderson;citation_author=Berit Arheimer;citation_author=Marcus Venohr;citation_author=Carl Christian Hoffmann;citation_author=CB Nielsen"/>
  <meta name="citation_reference" content="citation_title=Calibration parameter selection and watershed hydrology model evaluation in time and frequency domains;citation_publisher=MDPI;citation_volume=10;citation_doi=10.3390/w10060710;citation_author=Karthik Kumarasamy;citation_author=Patrick Belmont"/>
  <meta name="citation_reference" content="citation_title=Physical and monetary ecosystem service accounts for europe: A case study for in-stream nitrogen retention;citation_publisher=Elsevier;citation_volume=23;citation_doi=10.1016/j.ecoser.2016.11.002;citation_author=Alessandra La Notte;citation_author=Joachim Maes;citation_author=Silvana Dalmazzone;citation_author=Neville D Crossman;citation_author=Bruna Grizzetti;citation_author=Giovanni Bidoglio"/>
  <meta name="citation_reference" content="citation_title=Impacts of european livestock production: Nitrogen, sulphur, phosphorus and greenhouse gas emissions, land-use, water eutrophication and biodiversity;citation_publisher=IOP Publishing;citation_volume=10;citation_doi=10.1088/1748-9326/10/11/115004;citation_author=Adrian Leip;citation_author=Gilles Billen;citation_author=Josette Garnier;citation_author=Bruna Grizzetti;citation_author=Luis Lassaletta;citation_author=Stefan Reis;citation_author=David Simpson;citation_author=Mark A Sutton;citation_author=Wim De Vries;citation_author=Franz Weiss;citation_author=Impacts of european livestock production: Nitrogen, sulphur, phosphorus and greenhouse gas emissions, land-use, water eutrophication and biodiversity"/>
  <meta name="citation_reference" content="citation_title=Water and nutrient fluxes from major mediterranean and black sea rivers: Past and future trends and their implications for the basin-scale budgets;citation_publisher=Wiley Online Library;citation_volume=24;citation_doi=10.1029/2009GB003594;citation_author=W Ludwig;citation_author=AF Bouwman;citation_author=E Dumont;citation_author=F Lespinas"/>
  <meta name="citation_reference" content="citation_title=Parameter estimation in distributed hydrological catchment modelling using automatic calibration with multiple objectives;citation_publisher=Elsevier;citation_volume=26;citation_doi=10.1016/S0309-1708(02)00092-1;citation_author=Henrik Madsen"/>
  <meta name="citation_reference" content="citation_title=Modelling nutrient fluxes into the mediterranean sea;citation_publisher=Elsevier;citation_volume=22;citation_doi=10.1016/j.ejrh.2019.01.004;citation_author=Anna Malagó;citation_author=Fayçal Bouraoui;citation_author=Bruna Grizzetti;citation_author=Ad De Roo"/>
  <meta name="citation_reference" content="citation_title=Sensitivity analysis of a water-quality model using latin hypercube sampling;citation_publisher=American Society of Civil Engineers;citation_volume=130;citation_doi=10.1061/(ASCE)0733-9496(2004)130:3(232);citation_author=Gemma Manache;citation_author=Charles S Melching"/>
  <meta name="citation_reference" content="citation_title=Global sensitivity analysis in wastewater treatment modelling;citation_publisher=IWA Publishing;citation_volume=1;citation_author=G Mannina;citation_author=A Cosenza;citation_author=MB Neumann;citation_author=PA Vanrolleghem"/>
  <meta name="citation_reference" content="citation_title=A comparison of three methods for selecting values of input variables in the analysis of output from a computer code;citation_volume=21;citation_doi=10.2307/1268522;citation_author=MD McKay;citation_author=RJ Beckman;citation_author=WJ Conover"/>
  <meta name="citation_reference" content="citation_title=Uncertainty in coupled nonpoint source and stream water-quality models;citation_publisher=American Society of Civil Engineers;citation_volume=127;citation_doi=10.1061/(ASCE)0733-9496(2001)127:6(403);citation_author=Charles S Melching;citation_author=Willy Bauwens"/>
  <meta name="citation_reference" content="citation_title=Estimating the volume and age of water stored in global lakes using a geo-statistical approach;citation_publisher=Nature Publishing Group;citation_volume=7;citation_doi=10.1038/ncomms13603;citation_author=Mathis Loïc Messager;citation_author=Bernhard Lehner;citation_author=Günther Grill;citation_author=Irena Nedeva;citation_author=Oliver Schmitt"/>
  <meta name="citation_reference" content="citation_title=River flow forecasting through conceptual models part i-a discussion of principles;citation_publisher=Elsevier;citation_volume=10;citation_doi=10.1016/0022-1694(70)90255-6;citation_author=J Eamonn Nash;citation_author=Jonh V Sutcliffe"/>
  <meta name="citation_reference" content="citation_title=An introduction to sensitivity assessment of simulation models;citation_publisher=Elsevier;citation_volume=69;citation_doi=10.1016/j.envsoft.2015.03.020;citation_author=John Norton"/>
  <meta name="citation_reference" content="citation_title=Comparison of stochastic and machine learning methods for multi-step ahead forecasting of hydrological processes;citation_publisher=Springer;citation_volume=33;citation_doi=10.1007/s00477-018-1638-6;citation_author=Georgia Papacharalampous;citation_author=Hristos Tyralis;citation_author=Demetris Koutsoyiannis"/>
  <meta name="citation_reference" content="citation_title=Sensitivity analysis of environmental models: A systematic review with practical workflow;citation_publisher=Elsevier;citation_volume=79;citation_doi=10.1016/j.envsoft.2016.02.008;citation_author=Francesca Pianosi;citation_author=Keith Beven;citation_author=Jim Freer;citation_author=Jim W Hall;citation_author=Jonathan Rougier;citation_author=David B Stephenson;citation_author=Thorsten Wagener"/>
  <meta name="citation_reference" content="citation_title=Sensobol: An r package to compute variance-based sensitivity indices;citation_volume=102;citation_doi=10.18637/jss.v102.i05;citation_author=Arnald Puy;citation_author=Samuele Lo Piano;citation_author=Andrea Saltelli;citation_author=Simon A. Levin"/>
  <meta name="citation_reference" content="citation_title=Modelling guidelines—-terminology and guiding principles;citation_publisher=Elsevier;citation_volume=27;citation_doi=10.1016/j.advwatres.2003.08.006;citation_author=Jens Christian Refsgaard;citation_author=Hans Jørgen Henriksen"/>
  <meta name="citation_reference" content="citation_title=Sensitivity analysis as an ingredient of modeling;citation_publisher=JSTOR;citation_author=Andrea Saltelli;citation_author=Stefano Tarantola;citation_author=Francesca Campolongo"/>
  <meta name="citation_reference" content="citation_title=Sensitivity analysis.;citation_author=Andrea Saltelli;citation_author=Paola Annoni;citation_author=Sensitivity analysis."/>
  <meta name="citation_reference" content="citation_title=The SPARROW surface water-quality model: Theory, application and user documentation;citation_author=Gregory E Schwarz;citation_author=Anne B Hoos;citation_author=RB Alexander;citation_author=RA Smith"/>
  <meta name="citation_reference" content="citation_title=Sources and delivery of carbon, nitrogen, and phosphorus to the coastal zone: An overview of global nutrient export from watersheds (NEWS) models and their application;citation_publisher=Wiley Online Library;citation_volume=19;citation_doi=10.1029/2005GB002606;citation_author=SP Seitzinger;citation_author=JA Harrison;citation_author=Egon Dumont;citation_author=Arthur HW Beusen;citation_author=AF Bouwman"/>
  <meta name="citation_reference" content="citation_title=Statistical law of stream numbers;citation_publisher=University of Chicago Press;citation_volume=74;citation_author=Ronald L Shreve"/>
  <meta name="citation_reference" content="citation_title=Mathematical models of large watershed hydrology;citation_publisher=Water Resources Publication;citation_author=Vijay P Singh;citation_author=Donald K Frevert"/>
  <meta name="citation_reference" content="citation_title=Regional interpretation of water-quality monitoring data;citation_publisher=Wiley Online Library;citation_volume=33;citation_doi=10.1029/97WR02171;citation_author=Richard A Smith;citation_author=Gregory E Schwarz;citation_author=Richard B Alexander"/>
  <meta name="citation_reference" content="citation_title=Quantitative analysis of watershed geomorphology;citation_publisher=Wiley Online Library;citation_volume=38;citation_doi=10.1029/TR038i006p00913;citation_author=Arthur N Strahler"/>
  <meta name="citation_reference" content="citation_title=Recent regional changes in nutrient fluxes of european surface waters;citation_publisher=Elsevier;citation_volume=858;citation_author=Olga Vigiak;citation_author=Angel Udías;citation_author=Bruna Grizzetti;citation_author=Michela Zanni;citation_author=Alberto Aloe;citation_author=Franz Weiss;citation_author=Jordan Hristov;citation_author=Berny Bisselink;citation_author=Ad Roo;citation_author=Alberto Pistocchi"/>
  <meta name="citation_reference" content="citation_title=Calibration of hydrological models using flow-duration curves;citation_publisher=Copernicus GmbH;citation_volume=15;citation_doi=10.5194/hess-15-2205-2011;citation_author=IK Westerberg;citation_author=J-L Guerrero;citation_author=PM Younger;citation_author=KJ Beven;citation_author=Jan Seibert;citation_author=Sven Halldin;citation_author=JE Freer;citation_author=C-Y Xu"/>
  <meta name="citation_reference" content="citation_title=Evaluating multiple performance criteria to calibrate the distributed hydrological model of the upper neckar catchment;citation_publisher=Springer;citation_volume=69;citation_doi=10.1007/s12665-013-2306-2;citation_author=Thomas Wöhling;citation_author=Luis Samaniego;citation_author=Rohini Kumar"/>
  <meta name="citation_reference" content="citation_title=Automatic calibration of conceptual rainfall-runoff models: Sensitivity to calibration data;citation_publisher=Elsevier;citation_volume=181;citation_doi=10.1016/0022-1694(95)02918-4;citation_author=Patrice O Yapo;citation_author=Hoshin Vijai Gupta;citation_author=Soroosh Sorooshian"/>
  <meta name="citation_reference" content="citation_title=hydroGOF: Goodness-of-fit functions for comparison of simulated and observed hydrological time series;citation_doi=10.5281/zenodo.839854;citation_author=hydroGOF: Goodness-of-fit functions for comparison of simulated and observed hydrological time series"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","draft","date_received","volume","issue","slug","output","header-includes","type","description","bibliography","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","date","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","affiliation2","address2","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Angel Udías"]},{"type":"character","attributes":{},"value":["European Commission, Joint Research Centre (JRC)"]},{"type":"character","attributes":{},"value":["Via Enrico Fermi 2749, I-21027, Ispra","Italy"]},{"type":"character","attributes":{},"value":["Departament of Computer Science and Statistics, Rey Juan Carlos University"]},{"type":"character","attributes":{},"value":["Calle Tulipán S/N, 28933, Móstoles, Madrid","Spain"]},{"type":"character","attributes":{},"value":["0000-0003-1219-0465"]},{"type":"character","attributes":{},"value":["angel.luis.udias@urjc.es"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Bruna Grizzetti"]},{"type":"character","attributes":{},"value":["European Commission, Joint Research Centre (JRC)"]},{"type":"character","attributes":{},"value":["Via Enrico Fermi 2749, I-21027, Ispra","Italy"]},{"type":"character","attributes":{},"value":["bruna.grizzetti@jrc.it"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Olga Vigiak"]},{"type":"character","attributes":{},"value":["European Commission, Joint Research Centre (JRC)"]},{"type":"character","attributes":{},"value":["Via Enrico Fermi 2749, I-21027, Ispra","Italy"]},{"type":"character","attributes":{},"value":["Olga.VIGIAK@ec.europa.eu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Alberto Aloe"]},{"type":"character","attributes":{},"value":["European Commission, Joint Research Centre (JRC)"]},{"type":"character","attributes":{},"value":["Via Enrico Fermi 2749, I-21027, Ispra","Italy"]},{"type":"character","attributes":{},"value":["alberto.aloe@jrc.it"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Cesar Alfaro"]},{"type":"character","attributes":{},"value":["Departament of Computer Science and Statistics, Rey Juan Carlos University"]},{"type":"character","attributes":{},"value":["Calle Tulipán S/N, 28933, Móstoles, Madrid","Spain"]},{"type":"character","attributes":{},"value":["0000-0002-9146-4067"]},{"type":"character","attributes":{},"value":["cesar.alfaro@urjc.es"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Javier Gomez"]},{"type":"character","attributes":{},"value":["Departament of Computer Science and Statistics, Rey Juan Carlos University"]},{"type":"character","attributes":{},"value":["Calle Tulipán S/N, 28933, Móstoles, Madrid","Spain"]},{"type":"character","attributes":{},"value":["0000-0001-6434-7263"]},{"type":"character","attributes":{},"value":["javier.gomez@urjc.es"]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2022-09-13"]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[3]},{"type":"character","attributes":{},"value":["RJ-2023-065"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["\\usepackage{float}"]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["Nutrient pollution affects fresh and coastal waters around the globe. Planning mitigating actions requires tools to assess fluxes of nutrient emissions to waters and expected restoration impacts. Conceptual river basin models take advantage of data on nutrient emissions and concentrations at monitoring stations, providing a physical interpretation of monitored conditions, and enabling scenario analysis. The GREENeR package streamlines water quality model in a region of interest, considering nutrient pathways and the hydrological structure of the river network. The package merges data sources, analyzes local conditions, calibrate the model, and assesses yearly nutrient levels along the river network, determining contributions of load in freshwaters from diffuse and point sources. The package is enriched with functions to perform thorough parameter sensitivity analysis and for mapping nutrient sources and fluxes. The functionalities of the package are demonstrated using datasets from the Vistula river basin."]},{"type":"character","attributes":{},"value":["udias-angel.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[119]},{"type":"integer","attributes":{},"value":[137]}]},{"type":"character","attributes":{},"value":["RJ-2023-065.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-065"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-065"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["GREENeR"]},{"type":"list","attributes":{},"value":[]}]},{"type":"list","attributes":{},"value":[]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["12-20-2023"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-065/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/csv/forestFr.csv","data/csv/lakeProperties.csv","data/csv/length.csv","data/csv/monitoring.csv","data/csv/nutrients.csv","data/csv/precipitation.csv","data/csv/topology.csv","data/shapes/shapes.zip","data/shapes/Wisla.dbf","data/shapes/Wisla.prj","data/shapes/Wisla.shp","data/shapes/Wisla.shx","data/wisla_calib.rds","distill-preview.png","figures/fig1.png","figures/fig10.png","figures/fig2.png","figures/fig3.png","figures/fig4.png","figures/fig5.png","figures/fig6.png","figures/fig7.png","figures/fig8.png","figures/fig9.png","figures/Nefig4.png","RJ-2023-065.log","RJ-2023-065.pdf","RJ-2023-065.Rmd~","RJ-2023-065.tex","RJ-2023-065.zip","RJournal.sty","RJwrapper.aux","RJwrapper.log","RJwrapper.out","RJwrapper.tex","Rlogo-5.png","udias-angel.bib","udias-angel.log"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')


      const abstract = $('<d-abstract>')
      abstract.append('<b>Abstract:</b><br>')
      abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
      $("d-title p:empty").remove() // Remove empty paragraphs after title
      abstract.append(buttons)
      abstract.insertAfter($('d-title')) // Add abstract section after title

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters","description":"Nutrient pollution affects fresh and coastal waters around the globe. Planning mitigating actions requires tools to assess fluxes of nutrient emissions to waters and expected restoration impacts. Conceptual river basin models take advantage of data on nutrient emissions and concentrations at monitoring stations, providing a physical interpretation of monitored conditions, and enabling scenario analysis. The GREENeR package streamlines water quality model in a region of interest, considering nutrient pathways and the hydrological structure of the river network. The package merges data sources, analyzes local conditions, calibrate the model, and assesses yearly nutrient levels along the river network, determining contributions of load in freshwaters from diffuse and point sources. The package is enriched with functions to perform thorough parameter sensitivity analysis and for mapping nutrient sources and fluxes. The functionalities of the package are demonstrated using datasets from the Vistula river basin.","doi":"10.32614/RJ-2023-065","authors":[{"author":"Angel Udías","authorURL":"#","affiliation":"European Commission, Joint Research Centre (JRC)","affiliationURL":"#","orcidID":"0000-0003-1219-0465"},{"author":"Bruna Grizzetti","authorURL":"#","affiliation":"European Commission, Joint Research Centre (JRC)","affiliationURL":"#","orcidID":""},{"author":"Olga Vigiak","authorURL":"#","affiliation":"European Commission, Joint Research Centre (JRC)","affiliationURL":"#","orcidID":""},{"author":"Alberto Aloe","authorURL":"#","affiliation":"European Commission, Joint Research Centre (JRC)","affiliationURL":"#","orcidID":""},{"author":"Cesar Alfaro","authorURL":"#","affiliation":"Departament of Computer Science and Statistics, Rey Juan Carlos University","affiliationURL":"#","orcidID":"0000-0002-9146-4067"},{"author":"Javier Gomez","authorURL":"#","affiliation":"Departament of Computer Science and Statistics, Rey Juan Carlos University","affiliationURL":"#","orcidID":"0000-0001-6434-7263"}],"publishedDate":"2023-12-20T00:00:00.000+00:00","citationText":"Udías, et al., 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../issues/2023-3">Current</a>
<a href="../../submissions.html">Submit</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Nutrient pollution affects fresh and coastal waters around the globe. Planning mitigating actions requires tools to assess fluxes of nutrient emissions to waters and expected restoration impacts. Conceptual river basin models take advantage of data on nutrient emissions and concentrations at monitoring stations, providing a physical interpretation of monitored conditions, and enabling scenario analysis. The GREENeR package streamlines water quality model in a region of interest, considering nutrient pathways and the hydrological structure of the river network. The package merges data sources, analyzes local conditions, calibrate the model, and assesses yearly nutrient levels along the river network, determining contributions of load in freshwaters from diffuse and point sources. The package is enriched with functions to perform thorough parameter sensitivity analysis and for mapping nutrient sources and fluxes. The functionalities of the package are demonstrated using datasets from the Vistula river basin.</p></p>
</div>

<div class="d-byline">
  Angel Udías  (European Commission, Joint Research Centre (JRC))
  
,   Bruna Grizzetti  (European Commission, Joint Research Centre (JRC))
  
,   Olga Vigiak  (European Commission, Joint Research Centre (JRC))
  
,   Alberto Aloe  (European Commission, Joint Research Centre (JRC))
  
,   Cesar Alfaro  (Departament of Computer Science and Statistics, Rey Juan Carlos University)
  
,   Javier Gomez  (Departament of Computer Science and Statistics, Rey Juan Carlos University)
  
<br/>12-20-2023
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Nitrogen and phosphorus are key nutrients that heavily impact aquatic ecosystems. Detecting primary sources of nutrient pollution and their downstream spread, alongside assessing achievable reductions through restoration policies, are crucial for effective natural resource management. They aid in identifying priority intervention areas and planning actions to restore the ecological balance of receiving waters.</p>
<p>Modelling tools can be useful to assess the impacts of future scenarios, policy measures, and climate changes at the regional and continental scale <span class="citation" data-cites="arheimer2012climate bartosova2019future BEUSEN2022102426 bouraoui2014scenario ludwig2010water seitzinger2005sources">(<a href="#ref-seitzinger2005sources" role="doc-biblioref">Seitzinger et al. 2005</a>; <a href="#ref-ludwig2010water" role="doc-biblioref">Ludwig et al. 2010</a>; <a href="#ref-arheimer2012climate" role="doc-biblioref">Arheimer et al. 2012</a>; <a href="#ref-bouraoui2014scenario" role="doc-biblioref">Bouraoui et al. 2014</a>; <a href="#ref-bartosova2019future" role="doc-biblioref">Bartosova et al. 2019</a>; <a href="#ref-BEUSEN2022102426" role="doc-biblioref">Beusen et al. 2022</a>)</span>, and to check the coherence of different policy targets, for instance between water and agricultural policies. The assessment of policy scenarios requires a flexible and spatially detailed analysis to account for climatic, hydrological, and socio-economic gradients <span class="citation" data-cites="grizzetti2021eu">(<a href="#ref-grizzetti2021eu" role="doc-biblioref">Grizzetti et al. 2021</a>)</span>.</p>
<p>Several types of models can be applied to predict the transport of nutrients in river basins <span class="citation" data-cites="fu2019review">Fu et al. (<a href="#ref-fu2019review" role="doc-biblioref">2019</a>)</span>. Among them, statistical or conceptual models have the advantage of being readily applied in large watersheds. These model rely on calibration of few parameters for establishing links between emissions at sources and fate in the stream network. They take full advantage of nutrient emissions and concentrations data at monitoring stations, which are now accessible with increasing spatial and temporal resolution.</p>
<p>A classic example of river basin conceptual model is SPARROW <span class="citation" data-cites="smith1997regional schwarz2006sparrow">(<a href="#ref-smith1997regional" role="doc-biblioref">Smith et al. 1997</a>; <a href="#ref-schwarz2006sparrow" role="doc-biblioref">Schwarz et al. 2006</a>)</span>, which is widely applied in the U.S. to assess water quality over large regions. SPARROW has inspired the Geospatial Regression Equation for European Nutrient (GREEN) losses model <span class="citation" data-cites="grizzetti2005statistical grizzetti2012changes grizzetti2021eu">(<a href="#ref-grizzetti2005statistical" role="doc-biblioref">Grizzetti et al. 2005</a>; <a href="#ref-grizzetti2012changes" role="doc-biblioref">Grizzetti et al. 2012</a>, <a href="#ref-grizzetti2021eu" role="doc-biblioref">2021</a>)</span> which is adapted to European conditions. GREEN has been used for assessing the nutrient loads to the European seas <span class="citation" data-cites="grizzetti2012changes grizzetti2021eu">(<a href="#ref-grizzetti2012changes" role="doc-biblioref">Grizzetti et al. 2012</a>, <a href="#ref-grizzetti2021eu" role="doc-biblioref">2021</a>)</span>, nitrogen retention in European freshwaters <span class="citation" data-cites="grizzetti2012changes la2017physical">(<a href="#ref-grizzetti2012changes" role="doc-biblioref">Grizzetti et al. 2012</a>; <a href="#ref-la2017physical" role="doc-biblioref">La Notte et al. 2017</a>)</span>, and for policy scenario analysis <span class="citation" data-cites="la2017physical bouraoui2014scenario leip2015impacts malago2019modelling grizzetti2021eu">(<a href="#ref-bouraoui2014scenario" role="doc-biblioref">Bouraoui et al. 2014</a>; <a href="#ref-leip2015impacts" role="doc-biblioref">Leip et al. 2015</a>; <a href="#ref-la2017physical" role="doc-biblioref">La Notte et al. 2017</a>; <a href="#ref-malago2019modelling" role="doc-biblioref">Malagó et al. 2019</a>; <a href="#ref-grizzetti2021eu" role="doc-biblioref">Grizzetti et al. 2021</a>)</span>. Despite their usefulness, this type of river basin models are seldom compiled as dedicated R packages, for example SPARROW has some scripts available to process information for and analysis of models results in the R environment.</p>
<p>The GREEN model application comprises several key steps, including data extraction and organization, data harmonization and integration, examination and validation of input data sets, model calibration and parameter selection, model run, and result visualization. All of these features are now integrated into an R package (<a href="https://cran.r-project.org/package=GREENeR">GREENeR</a>) that comprises functions to streamline the process, evaluate and visualize all the steps, thus strengthening the robustness of model application.</p>
<h3 data-number="1.1" id="about-water-surface-nutrients-estimation-with-green"><span class="header-section-number">1.1</span> About water surface nutrients estimation with GREEN</h3>
<p>GREEN <span class="citation" data-cites="grizzetti2005statistical grizzetti2012changes grizzetti2008assessing grizzetti2021eu">(<a href="#ref-grizzetti2005statistical" role="doc-biblioref">Grizzetti et al. 2005</a>, <a href="#ref-grizzetti2008assessing" role="doc-biblioref">2008</a>; <a href="#ref-grizzetti2012changes" role="doc-biblioref">Grizzetti et al. 2012</a>, <a href="#ref-grizzetti2021eu" role="doc-biblioref">2021</a>)</span> is a conceptual model to assess total nitrogen TN and total phosphorous TP from a region of interest (usually a river basin), accounting for both diffuse and point sources. The package allows the analysis of different scenarios of nutrient input in the region of interest, where “scenario” indicates a combination of annual time-series of inputs, such as nitrogen or phosphorus and the topological structure of the region. The model comprises several nutrient sources and pathways:</p>
<ol type="1">
<li>agricultural diffuse sources include nutrients from mineral fertilisers and manure application, nitrogen crop and soil fixation. These sources undergo retention in the land phase (basin retention that account for e.g. crop uptake and volatilization losses) before reaching the stream;</li>
<li>other diffuse emissions, such as from scattered dwellings (i.e., isolated houses and small agglomerations that are not connected to sewerage systems), and atmospheric nitrogen deposition (for nitrogen module) or background losses (for phosphorus module), are also reduced, e.g. due to soil processes, before reaching the stream network;</li>
<li>point sources consist of urban and industrial wastewater discharges that are discharged into surface waters directly.</li>
</ol>
<p>Once in the river network, all nutrient loads are reduced by in-stream retention in rivers and lakes.</p>
<p>Basin retention of agriculture sources is a decay function proportional to the inverse of the total annual precipitation in the catchment. Conversely, river retention is a decay function proportional to the river length, considered as a proxy for water residence time. Finally, lake retention is simulated as a function of the lakes residence time and average depth.</p>
<p>The basin is divided into spatial subunits (called catchments), with a given area, a river reach, an inlet node, and an outlet node. The catchments are topologically connected from the headwaters to the outlet in a cascading sequence. The sequence of nutrient load accumulation through the stream network is defined by Shreve’s order <span class="citation" data-cites="shreve1966statistical">(<a href="#ref-shreve1966statistical" role="doc-biblioref">Shreve 1966</a>)</span>. Nutrient input from the different sources, basin and river retention are simulated in each catchment and routed through the river network. For each catchment <span class="math inline">\(i\)</span> in the basin, the GREEN nutrient load <span class="math inline">\(L_i\)</span> is estimated by the general equation:</p>
<span class="math display" id="eq:green-nutrient-load">\[\begin{equation}
  L_{i,y} = (1-Lret_i) \cdot (DSA_{i,y} \cdot (1-Bret_{i,y} )+ DSB_{i,y} + PS_{i,y} +U_{i,y} ) \cdot (1-Rret_i)
\tag{1}
\end{equation}\]</span>
<p>where <span class="math inline">\(L_{i,y}\)</span> is the nutrient load at the catchment outlet-node (ton/yr) in <span class="math inline">\(y\)</span> year; and the other variables represent different sources and sinks of nutrients.</p>
<p>Sources of nutrients are:</p>
<ul>
<li><p><span class="math inline">\(DSA_{i,y}\)</span>. Annual nutrient diffuse sources on agricultural land in the catchment (ton/yr): mineral and manure fertilization, atmospheric nitrogen deposition, plant and soil fixation for TN; mineral and manure fertilization, and background losses for TP.</p></li>
<li><p><span class="math inline">\(DSB_{i,y}\)</span>. Annual nutrient diffuse sources in the catchment related with scatter dwellings and atmospheric nitrogen deposition on non-agricultural land for TN (<span class="math inline">\(DSB_{i,y} = 0.38 \cdot FF_{i,y} \cdot AtmN_{i,y} + sd_{coeff} \cdot SdN_{i,y}\)</span>, where <span class="math inline">\(FF_{i,y}\)</span> is the fraction of non-agricultural land cover in the catchment, and <span class="math inline">\(AtmN_{i,y}\)</span> is the annual atmospheric nitrogen deposition on the catchment (ton/yr)); nutrient diffuse sources in the catchment related with scatter dwellings and background losses on non-agricultural areas for TP (<span class="math inline">\(DSB_{i,y} = sd_{coeff} \cdot SdP_{i,y})\)</span>.</p></li>
<li><p><span class="math inline">\(PS_{i,y}\)</span>. Nutrient point sources in the catchment (ton/yr).</p></li>
<li><p><span class="math inline">\(U_{i,y}\)</span>. Nutrient load from upstream catchments (ton/yr).</p></li>
</ul>
<p>Sinks of nutrients are:</p>
<ul>
<li><span class="math inline">\(Lret_i\)</span> denotes the lake retention (fraction) of the <span class="math inline">\(i\)</span> catchment. <span class="math inline">\(Lret\)</span> is currently defined according to <span class="citation" data-cites="kronvang2004nutrient">Kronvang et al. (<a href="#ref-kronvang2004nutrient" role="doc-biblioref">2004</a>)</span>, but limited to a <span class="math inline">\(10\%\)</span> maximum reduction:</li>
</ul>
<span class="math display" id="eq:lake-retention">\[\begin{equation}
    Lret = \max\left(0.1, 1 - \frac{1}{1 + (dref / z) \cdot RT}  \right)
    \tag{2}
  \end{equation}\]</span>
<p>where <span class="math inline">\(z\)</span> represents the average lake depth (m); <span class="math inline">\(RT\)</span> is the hydraulic residence time (yr); and <span class="math inline">\(dref\)</span> denotes a nutrient-related coefficient (<span class="math inline">\(dref = 7.3\)</span> for TN and <span class="math inline">\(dref = 26\)</span> for TP).</p>
<ul>
<li><span class="math inline">\(Bret_{i,y}\)</span> is the fraction of basin retention of the <span class="math inline">\(i\)</span> catchment in <span class="math inline">\(y\)</span> year:</li>
</ul>
<span class="math display" id="eq:basin-retention">\[\begin{equation}
    Bret_{i,y} = 1 - \exp(-alpha_P \cdot NrmInvRain_{i,y})
    \tag{3}
  \end{equation}\]</span>
<p>where <span class="math inline">\(NrmInvRain_{i,y}\)</span> is the inverse of annual precipitation (mm) of the <span class="math inline">\(i\)</span> catchment in <span class="math inline">\(y\)</span> year, normalized by its maximum <span class="citation" data-cites="frank1994data">(<a href="#ref-frank1994data" role="doc-biblioref">Frank and Todeschini 1994</a>)</span>. To keep basin retention coefficients comparable across regions, the minimum precipitation <span class="math inline">\(minPrec\)</span> is set to <span class="math inline">\(50\)</span> mm/y, and thus <span class="math inline">\(NrmInvRain_{i,y}\)</span> is defined as</p>
<span class="math display">\[\begin{equation*}
    NrmInvRain_{i,y} = \frac{1 / \max(50,  precipitation_{i,y})}{(1 / minPrec)}
  \end{equation*}\]</span>
<ul>
<li><span class="math inline">\(Rret_i\)</span> is the fraction of river retention of the <span class="math inline">\(i\)</span> catchment:</li>
</ul>
<span class="math display" id="eq:river-retention">\[\begin{equation}
    Rret_i = 1 - \exp(-alpha_L \cdot NrmLengthKm_i)
    \tag{4}
  \end{equation}\]</span>
<p>where <span class="math inline">\(NrmLengthKm_i\)</span> is the length (km) of the catchment reach, normalized by the maximum in the dataset:</p>
<span class="math display">\[\begin{equation*}
    NrmLengthKm_i = \frac{\textrm{catchment length } i \textrm{ reach, in km}}{\max(\textrm{Reach length in the region, in km})}
  \end{equation*}\]</span>
<p>Since the maximum reach length depends on the region and its subdivision of network reaches, the calibrated coefficient <span class="math inline">\(alpha_L\)</span> cannot be compared across regions that adopt different discretization. Note that basin retention varies from year to year according to annual precipitation, whereas the fraction of river and lake retention for a given catchment is constant in time.</p>
<p>Equation <a href="#eq:green-nutrient-load">(1)</a> is applied sequentially from the most upstream nodes to the basin outlet. The model parameters are:</p>
<ol type="1">
<li>the basin retention coefficient (<span class="math inline">\(alpha_P\)</span>), which together with annual precipitation regulates nutrient retention of diffuse agricultural sources (Equation <a href="#eq:basin-retention">(3)</a>);</li>
<li>the river retention coefficient (<span class="math inline">\(alpha_L\)</span>: Equation <a href="#eq:river-retention">(4)</a>), which regulates the river retention per river km.</li>
<li>the fraction of domestic diffuse sources that reaches the stream network (<span class="math inline">\(sd_{coeff}\)</span>).</li>
</ol>
<h2 data-number="2" id="about-the-package"><span class="header-section-number">2</span> About the <a href="#">GREENeR</a> package</h2>
<h3 data-number="2.1" id="package-organization"><span class="header-section-number">2.1</span> Package organization</h3>
<p>This work presents a new efficient and enhanced implementation of the model GREEN developed as an R package named <a href="#">GREENeR</a>. <a href="#">GREENeR</a> is developed in the R statistical software and provides tools and methods for applying GREEN to an area of interest and assessing annual time series of nutrient loads in a river network and at the basin outlet, plus contributions of nutrient sources to these loads. Some of the key features of the package comprise: a) functions for the creation of scenarios from data sources; b) computational efficiency; c) parallel-capable ; d) an extended suite of fine tuning options to control model calibration; e) built-in parameter sensitivity analysis; and f) functions to perform customised post-process analyses.</p>
<p>The functions of <a href="#">GREENeR</a> package are arranged in three groups: i) functions to perform graphical summaries of model inputs; ii) functions to perform model parameters calibration and sensitivity analysis; iii) functions to compute, analyze and visualize through graphs and maps the model outputs, i.e. total loads and contributions by source. The package supports parallel processing, which helps reduce the computational load in handling large basins.</p>
<p>The time-series can represent either historic (current or past) conditions that can be associated to observations for model calibration, or hypothetical conditions foreseen under theoretical changes (e.g. to forecast results of nutrient management plans, or under climatic change).</p>
<p>A scenario contains:</p>
<ol type="1">
<li><p>The geospatial geometry of the catchments of the region, which currently is defined according to the Catchment Characterisation and Modelling Database for European Rivers v2 (CCM2) <span class="citation" data-cites="de2007rivers">(<a href="#ref-de2007rivers" role="doc-biblioref">De Jager and Vogt 2007</a>)</span>.</p></li>
<li><p>The annual time series (1990-2018) of nutrient inputs per catchment.</p></li>
<li><p>Additional catchment information (annual precipitation, annual forest fraction, lake retention, reach length).</p></li>
<li><p>Observed total load (TN or TP) from monitoring stations.</p></li>
</ol>
<p>Two historical scenarios, one for TN and one for TP, of the Lay basin (France) are provided with the <a href="#">GREENeR</a> package. The Lay basin has an area of <span class="math inline">\(1971\)</span> km<span class="math inline">\(^2\)</span>, and is divided into <span class="math inline">\(189\)</span> CCM2 catchments. The mean catchment area is <span class="math inline">\(10.4\)</span> km<span class="math inline">\(^2\)</span>. Nutrient observations comprised <span class="math inline">\(22\)</span> TN entries from six monitoring stations and <span class="math inline">\(58\)</span> TP data entries from eight monitoring stations (data from WISE Waterbase <span class="citation" data-cites="EEA_2019">(<a href="#ref-EEA_2019" role="doc-biblioref">EEA 2021</a>)</span>).</p>
<p>Further, in this article we present examples drawn for the TN historic scenario of the transboundary Vistula (Wisla) river basin, one of the largest river basins of Europe. The Vistula scenario comprises <span class="math inline">\(15465\)</span> CCM2 catchments that compose the <span class="math inline">\(193.894\)</span> km<span class="math inline">\(^2\)</span> river basin, TN inputs for 1990-2018, as well as 1364 observed TN loads from 412 monitoring stations. The TN input dataset is part of the larger dataset created to assess nutrient concentration in the European freshwaters <span class="citation" data-cites="vigiak2023recent">(<a href="#ref-vigiak2023recent" role="doc-biblioref">Vigiak et al. 2023</a>)</span>.</p>
<h3 data-number="2.2" id="key-functions-in-the-greener-package"><span class="header-section-number">2.2</span> Key functions in the GREENeR package</h3>
<p>A brief overview of the package and its main functions is given in Figure <a href="#fig:schematic-diagram-GREENeR">1</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:schematic-diagram-GREENeR"></span>
<img src="figures/fig1.png" alt="Schematic diagram of the procedure of GREENeR, including functions, data inputs and outputs, to estimate the nutrient loads. The green boxes represent data objects and the blue boxes represent the functions." width="90%" height="60%" />
<p class="caption">
Figure 1: Schematic diagram of the procedure of GREENeR, including functions, data inputs and outputs, to estimate the nutrient loads. The green boxes represent data objects and the blue boxes represent the functions.
</p>
</div>
</div>
<p>The key functions included in the package are:</p>
<ul>
<li><p><code>read_geometry()</code>: imports the geospatial vector format (shapefile or ESRI shapefile) with the spatial information of the catchments in R.</p></li>
<li><p><code>read_NSdata()</code>: imports the annual time series of nutrient inputs per catchment and type of nutrient source (manure, mineral fertilization, point sources, scatter dwellings), plus the forest fraction, and the observed annual nutrient loads from monitoring station data. The original data are stored in several comma-separated tables (CSV files).</p></li>
<li><p><code>input_maps()</code>: creates a map showing the mean nutrient load input by source.</p></li>
<li><p><code>input_plot()</code>: creates either a grouped barplot representing the average input load by source for the whole basin, or three density plots showing the distribution of nutrient sources.</p></li>
<li><p><code>input_Tserie()</code>: creates a time series plot showing basin inputs by source.</p></li>
<li><p><code>shreve()</code>: returns the Shreve order of the catchments, a useful indicator of stream size, discharge, and drainage area <span class="citation" data-cites="strahler1957quantitative">(<a href="#ref-strahler1957quantitative" role="doc-biblioref">Strahler 1957</a>)</span> calculated based on the sum of the orders of up of upstream tributaries <span class="citation" data-cites="shreve1966statistical">(<a href="#ref-shreve1966statistical" role="doc-biblioref">Shreve 1966</a>)</span>. Commercial GIS software usually provides a Shreve calculation function, but in other software, it is harder to find. In GREEN, the Shreve’s order defines the cascade of upstream-downstream catchments.</p></li>
<li><p><code>calib_green()</code>: conducts sensitivity analysis of model calibration utilizing a Latin Hypercube Sampling (LHS) scheme <span class="citation" data-cites="manache2004sensitivity">(<a href="#ref-manache2004sensitivity" role="doc-biblioref">Manache and Melching 2004</a>)</span> for three model parameters. It evaluates model performance by calculating several “goodness-of-fit” (GoF) metrics <span class="citation" data-cites="refsgaard2004modelling">(<a href="#ref-refsgaard2004modelling" role="doc-biblioref">Refsgaard and Henriksen 2004</a>)</span> against available observations during the specified simulation period (years).</p></li>
<li><p><code>select_params()</code>: extracts the best parameter set according to a selected GoF metric from the object generated by the calibration function, <code>calib_green()</code>.</p></li>
<li><p><code>calib_boxplot()</code>: creates a figure of boxplots that show the relationships between the best parameter sets determined by the specific GoF metric in each boxplot title, and six other commonly used hydrological metrics <span class="citation" data-cites="althoff2021goodness zambrano2014hydrogof">(<a href="#ref-zambrano2014hydrogof" role="doc-biblioref">Mauricio Zambrano-Bigiarini 2014</a>; <a href="#ref-althoff2021goodness" role="doc-biblioref">Althoff and Rodrigues 2021</a>)</span>. In the lower panel, the figure also highlights the distribution of model parameters; the value of the best parameter set is marked as a red dot in each boxplot.</p></li>
<li><p><code>region_nut_balance()</code>: runs the GREEN model with the selected parameter set, and returns the mean annual mass balance of nutrient fluxes for the whole simulation period of the region. The results of this function can be visualized using a Sankey diagram via the <code>N4_sankey()</code> function.</p></li>
<li><p><code>green()</code>: runs the GREEN model with the selected parameter set and returns nutrient load time series for the simulation period. It generates less information than the <code>green_shares()</code> function, but its execution is faster, so it is used as a function for calibration iterations and is embedded in the <code>calib_green()</code> function.</p></li>
<li><p><code>green_shares()</code>: runs the GREEN model with the selected parameter set and returns time series of nutrient loads and the contributions of each nutrient source in the simulation period. The results of the model can be examined by <code>nutrient_tserie()</code> and <code>nutrient_maps()</code> functions.</p></li>
<li><p><code>scatter_plot()</code>: generates dot plots correlating parameters realizations in the calibration data with GoF metric, visualizing the impact of each parameter on model outcomes. The plot vary based on selected GoF metric from <code>green_calib()</code> function.</p></li>
<li><p><code>simobs_annual_plot()</code>: generates scatter plots comparing model load predictions (PredictLoad) with observations (ObsLoad) for each year of the stimulation period.</p></li>
</ul>
<h3 data-number="2.3" id="input-data-requirements"><span class="header-section-number">2.3</span> Input data requirements</h3>
<p><a href="#">GREENeR</a> requires information on the nutrient inputs, the topology, and the geospatial geometry of the region of interest. The spatio-temporal input data must include all nutrient source fields, and differs in the two nutrient scenarios (TN or TP). In the case of TN (e.g. Figure <a href="#fig:maps-TN">2</a>), fields are (Equation <a href="#eq:appendix1-1">(5)</a> in <a href="#appendix-1">Appendix 1</a>):</p>
<ul>
<li><p><span class="math inline">\(Atmospheric\)</span>: Annual amount of atmospheric nitrogen deposition (ton/yr).</p></li>
<li><p><span class="math inline">\(Mineral\)</span>: Annual amount of nitrogen from mineral fertilisers (ton/yr).</p></li>
<li><p><span class="math inline">\(Manure\)</span>: Annual amount of nitrogen in manure fertilisers (ton/yr).</p></li>
<li><p><span class="math inline">\(Fix\)</span>: Annual amount of nitrogen fixation by leguminous crops and fodder (ton/yr).</p></li>
<li><p><span class="math inline">\(Soil\)</span>: Annual amount of nitrogen fixation in soils (ton/yr).</p></li>
<li><p><span class="math inline">\(Sc. Dwellings\)</span>: Nitrogen input from scattered dwellings (ton/yr).</p></li>
<li><p><span class="math inline">\(PointS\)</span>: Nitrogen input from point sources (ton/yr).</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:maps-TN"></span>
<img src="figures/fig2.png" alt="Maps showing the average TN inputs in the Vistula river basin in 1990-2018. The figure was generated with GREENeR input\_maps() function. Tot.Diff is the sum of diffuse inputs." width="100%" height="35%" />
<p class="caption">
Figure 2: Maps showing the mean annual TN inputs in the Vistula river basin in 1990-2018. The figure was generated with GREENeR input_maps() function. TOT.Diff = sum of diffuse inputs.
</p>
</div>
</div>
<p>In the case of TP, fields are (Equation <a href="#eq:appendix1-2">(6)</a> in <a href="#appendix-1">Appendix 1</a>):</p>
<ul>
<li><p><span class="math inline">\(Background\)</span>: annual amount of phosphorus from background losses (ton/yr).</p></li>
<li><p><span class="math inline">\(Mineral\)</span>: annual amount of phosphorus from mineral fertilisers (ton/yr).</p></li>
<li><p><span class="math inline">\(Manure\)</span>: annual amount of phosphorus in manure fertilisers (ton/yr).</p></li>
<li><p><span class="math inline">\(Sc. Dwellings\)</span>: phosphorus input from scattered dwellings (ton/yr).</p></li>
<li><p><span class="math inline">\(PointS\)</span>: phosphorus input from point sources (ton/yr).</p></li>
</ul>
<p>European datasets for 1990-2018 generated to assess historic and current nutrient fluxes <span class="citation" data-cites="vigiak2023recent">(<a href="#ref-vigiak2023recent" role="doc-biblioref">Vigiak et al. 2023</a>)</span> are available upon request. The model and the package are compatible with an external dataset and can be customized with local information as long as the data structure is respected.</p>
<p>In both nutrient cases, <a href="#">GREENeR</a> needs additional annual catchment information:</p>
<ul>
<li><p><span class="math inline">\(ForestFraction\)</span>: annual fraction (0-1) of non-agricultural land cover area in the catchment (<span class="math inline">\(FF\)</span> in Equations <a href="#eq:appendix1-1">(5)</a> and <a href="#eq:appendix1-2">(6)</a>, in the <a href="#appendix-1">Appendix 1</a>).</p></li>
<li><p><span class="math inline">\(Rain\)</span>: annual precipitation (mm, Equation <a href="#eq:basin-retention">(3)</a>).</p></li>
<li><p><span class="math inline">\(LakeFrRet\)</span>: lake retention fraction (0-1) (<span class="math inline">\(Lret\)</span> in Equation <a href="#eq:green-nutrient-load">(1)</a>, in the <a href="#appendix-1">Appendix 1</a>). Note, this differs for TN or TP scenarios (Equation <a href="#eq:lake-retention">(2)</a>). At European scale, average lake depth and hydraulic residence time can be obtained from HydroLAKES database (<a href="https://www.hydrosheds.org/pages/hydrolakes" class="uri">https://www.hydrosheds.org/pages/hydrolakes</a>, <span class="citation" data-cites="messager2016estimating">Messager et al. (<a href="#ref-messager2016estimating" role="doc-biblioref">2016</a>)</span>).</p></li>
<li><p>Length: is the length (km) of the catchment reach (Equation <a href="#eq:river-retention">(4)</a>).</p></li>
</ul>
<p>The catchment topology outlines the hydrological network configuration within the region. Each catchment must have a unique numerical identifier (HydroID)), to establish the network structure via a source HydroID and destination HydroID table. It is important to note that any outlet of the basin will be given as destination HydroID identifier “-1”. Complementing the topology of the hydrologic network, the length of catchment reach should also be included (Equation <a href="#eq:river-retention">(4)</a>).</p>
<p>Finally, in order to calibrate the model, it is necessary to have some observed nutrient loads from monitoring stations associated to any catchment of the region. Ultimately, the quality, size, and spatial distribution of observed loads determine the robustness of the calibration process. In Europe, a large dataset of annual concentrations is publicly available <span class="citation" data-cites="EEA_2019">(WISE Waterbase, <a href="#ref-EEA_2019" role="doc-biblioref">EEA 2021</a>)</span>, but annual flow must be derived from other sources <span class="citation" data-cites="grizzetti2021eu vigiak2023recent">(<a href="#ref-grizzetti2021eu" role="doc-biblioref">Grizzetti et al. 2021</a>; <a href="#ref-vigiak2023recent" role="doc-biblioref">Vigiak et al. 2023</a>)</span>.</p>
<h3 data-number="2.4" id="performance-and-memory-use"><span class="header-section-number">2.4</span> Performance and memory use</h3>
<p>The <a href="#">GREENeR</a> package performance and memory usage depends on the size of the region (number of catchments) and the number of years of the simulation. As a reference, the Danube basin (i.e. the largest European basin, with <span class="math inline">\(138013\)</span> catchments) TN dataset for 1990-2018 requires approximately <span class="math inline">\(389\)</span> Mb of memory to store the annual data. Table <a href="#tab:computational-requirements">1</a> shows the memory occupied by the scenarios for 6 European basins. In addition, it shows the computation times required in the execution of some key functions of the package. All executions were conducted on two computer configurations:</p>
<ul>
<li><p>CPU1: Desktop running window 10 with one Intel(R) Core i5-8259U CPU (4 cores, two threads per core) CPU at 2.30 GHz and 16 GB of RAM memory</p></li>
<li><p>CPU2: Workstation running Linux with one AMD EPYC 7352 (24 cores, two threads per core) CPU at 2.3 GHz and 128 GB of RAM memory</p></li>
</ul>
<p>The time required for the execution of the different functions increases linearly with the number of catchments (or Shreve order) of the region (Table <a href="#tab:computational-requirements">1</a>). The <code>calib_green()</code> function is the most computationally demanding. However, the parallel implementation of this function drastically reduces the time required for this process. Calibration can be carried out in about 6 hours for practical implementation in large basins.</p>
<div class="layout-chunk" data-layout="l-body">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:computational-requirements">Table 1: </span>Computational requirements to run some <a href="#">GREENeR</a> functions in six European basins scenarios of 29 years. The columns Shreve order, Area and Number of catchments characterize the size of each basin. Mem is the amount of memory occupied by the GREEN model scenario generated by <a href="#">GREENeR</a> package. The green(), green_shares() and calib_green() columns show the computation time required to execute the corresponding <a href="#">GREENeR</a> functions for each scenarios under two computer configurations, CPU1, CPU2 (explanation in the text). All runs of calib_green() have been performed with 200 iterations. The reported time are the average of 5 runs of each process.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="5">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
green()
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
green_shares()
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
calib_green()
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Basin
name
</th>
<th style="text-align:right;">
Shreve
order
</th>
<th style="text-align:right;">
Area
km<span class="math inline">\(^2\)</span>
</th>
<th style="text-align:right;">
Number of
catchments
</th>
<th style="text-align:right;">
Mem
MB
</th>
<th style="text-align:right;">
CPU1
sec
</th>
<th style="text-align:right;">
CPU2
sec
</th>
<th style="text-align:right;">
CPU1
sec
</th>
<th style="text-align:right;">
CPU2
sec
</th>
<th style="text-align:right;">
CPU1
sec
</th>
<th style="text-align:right;">
CPU2
sec
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Lay
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
1971
</td>
<td style="text-align:right;">
189
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
31
</td>
</tr>
<tr>
<td style="text-align:left;">
Miño
</td>
<td style="text-align:right;">
2803
</td>
<td style="text-align:right;">
16985
</td>
<td style="text-align:right;">
5572
</td>
<td style="text-align:right;">
15.7
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
4110
</td>
<td style="text-align:right;">
394
</td>
</tr>
<tr>
<td style="text-align:left;">
Seine
</td>
<td style="text-align:right;">
2902
</td>
<td style="text-align:right;">
75989
</td>
<td style="text-align:right;">
5793
</td>
<td style="text-align:right;">
16.3
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
106
</td>
<td style="text-align:right;">
6320
</td>
<td style="text-align:right;">
452
</td>
</tr>
<tr>
<td style="text-align:left;">
Ebro
</td>
<td style="text-align:right;">
9351
</td>
<td style="text-align:right;">
85611
</td>
<td style="text-align:right;">
18568
</td>
<td style="text-align:right;">
52.3
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
425
</td>
<td style="text-align:right;">
224
</td>
<td style="text-align:right;">
10876
</td>
<td style="text-align:right;">
995
</td>
</tr>
<tr>
<td style="text-align:left;">
Vistula
</td>
<td style="text-align:right;">
7757
</td>
<td style="text-align:right;">
193894
</td>
<td style="text-align:right;">
15465
</td>
<td style="text-align:right;">
43.6
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
314
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
9004
</td>
<td style="text-align:right;">
814
</td>
</tr>
<tr>
<td style="text-align:left;">
Danube
</td>
<td style="text-align:right;">
69505
</td>
<td style="text-align:right;">
802032
</td>
<td style="text-align:right;">
138013
</td>
<td style="text-align:right;">
388.6
</td>
<td style="text-align:right;">
1120
</td>
<td style="text-align:right;">
766
</td>
<td style="text-align:right;">
2855
</td>
<td style="text-align:right;">
1108
</td>
<td style="text-align:right;">
94682
</td>
<td style="text-align:right;">
5638
</td>
</tr>
</tbody>
</table>
</div>
<h2 data-number="3" id="estimating-nutrient-loads-using-the-package"><span class="header-section-number">3</span> Estimating nutrient loads using the <a href="#">GREENeR</a> package</h2>
<p>The entire procedure is summarized on Figure <a href="#fig:schematic-diagram-GREENeR">1</a>. Once the input data have been uploaded, the region scenario (Nutrient data and Catch data) is generated. The <code>calib_green()</code> function explores the parameter set ranges with LHC scheme, calculating GoF of parameter sets. Sensitivity analysis of its results is conducted to determine the best parameter set. Finally, the <code>green_shares()</code> function is used to estimate the nutrient loads and source apportionment (i.e. contribution to loads by source), per year and per catchment.</p>
<h3 data-number="3.1" id="scenario-preparation"><span class="header-section-number">3.1</span> Scenario preparation</h3>
<p>Assembling input data for running the GREEN model is time consuming. To facilitate the process, the <code>read_NSdata()</code> function assembles and organises annual information to generate a list of two objects: <code>Nutrient Time Series Data Object</code> and <code>Catch Data Object</code> of GREEN scenario. It needs four CSV files with specific data, namely:</p>
<ul>
<li><p>Time-series of annual nutrient inputs per catchment.</p></li>
<li><p>Time-series of annual observed loads at monitoring stations.</p></li>
<li><p>Basin topology and lake properties.</p></li>
<li><p>Other: precipitation, forest fraction, reach length.</p></li>
</ul>
<p>The spatial identifiers (HydroID) and temporal (year) units must be coherent in all the files. Besides organizing the input data, the <code>read_NSdata()</code> function also calculates the Shreve order of each catchment, normalises the precipitation (calculating <span class="math inline">\(NrmInvRain_{i,y}\)</span>) and the reach length (<span class="math inline">\(NrmLengthKm_i\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>csv_path</span> <span class='op'>&lt;-</span> <span class='st'>"data/csv/"</span></span>
<span><span class='va'>scen</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/read_NSdata.html'>read_NSdata</a></span><span class='op'>(</span><span class='va'>csv_path</span>,<span class='st'>"nutrients.csv"</span>,<span class='st'>"monitoring.csv"</span>, <span class='st'>"forestFr.csv"</span>,</span>
<span>                    <span class='st'>"precipitation.csv"</span>,<span class='st'>"topology.csv"</span>, <span class='st'>"lakeProperties.csv"</span>,</span>
<span>                    <span class='st'>"length.csv"</span><span class='op'>)</span></span>
<span><span class='va'>nutrient</span> <span class='op'>&lt;-</span> <span class='va'>scen</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span></span>
<span><span class='va'>catch</span>    <span class='op'>&lt;-</span> <span class='va'>scen</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span></span></code></pre>
</div>
</div>
<p>The <code>shreve()</code> function can calculate the Shreve order independently based on the topology of the basin:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>shreve_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/shreve.html'>shreve</a></span><span class='op'>(</span><span class='va'>catch</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<p>Finally, the geospatial geometry of the catchments should be uploaded to enable the visualisation functionalities in map form. The <code>read_geometry()</code> function loads the geometry information file, i.e. a geospatial vector with the geometry of the catchment region:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>geometry</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/read_geometry.html'>read_geometry</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"data/shapes/Wisla.shp"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The geo-reference information, geometry and attributes of the spatial entities must be in a shapefile format (.shp), editable with ArcGIS or similar software. The identifiers of each catchment (HydroID) must be consistent with those in the CSV files of the scenario dataset.</p>
<p>Once the scenario has been generated, the library includes functions to examine the nutrient sources in a basin, and explore their distribution over time or in space. The <code>input_plot()</code> function provides annual average nutrient loads for the whole period and density plots of nutrient loads. The <code>input_Tserie()</code> function allows to examine the temporal evolution of the inputs, whereas the <code>input_maps()</code> function generates maps of nutrient inputs distribution in the basin (Figure <a href="#fig:maps-TN">2</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/input_maps.html'>input_maps</a></span><span class='op'>(</span><span class='va'>nutient</span>, <span class='va'>catch</span>, <span class='va'>geometry</span>, <span class='st'>"Wisla"</span>, <span class='st'>"gr1"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="3.2" id="calibration-procedure-and-sensitivity-analysis"><span class="header-section-number">3.2</span> Calibration procedure and sensitivity analysis</h3>
<p>The calibration process is essential to find a suitable set of parameters for the model. In <a href="#">GREENeR</a> package, the core function <code>calib_green()</code> enables to run a parameter sensitivity analysis and concurrently assessing the model performance according to several GoF metrics.</p>
<p>Sensitivity Analysis (SA) investigates how the variation in the output of a numerical model can be attributed to variations of its input factors. SA aims at identifying the most influential inputs or parameters, and quantifying how much they contribute to the variability/uncertainty of the model outputs. SA provides information on how much of the output variance is controlled by each parameter, or combination of parameters. SA is increasingly being used in environmental modelling for a variety of purposes, including uncertainty assessment, model calibration and diagnostic evaluation, dominant control analysis, and robust decision-making <span class="citation" data-cites="pianosi2016sensitivity saltelli2011 butler2014identifying norton2015introduction mannina2018global">(<a href="#ref-saltelli2011" role="doc-biblioref">Saltelli et al. 2011</a>; <a href="#ref-butler2014identifying" role="doc-biblioref">Butler et al. 2014</a>; <a href="#ref-norton2015introduction" role="doc-biblioref">Norton 2015</a>; <a href="#ref-pianosi2016sensitivity" role="doc-biblioref">Pianosi et al. 2016</a>; <a href="#ref-mannina2018global" role="doc-biblioref">Mannina et al. 2018</a>)</span>. This is achieved by running the model for many samples of the parameter space to determine their impact on the model outputs. SA allows identification of the parameters and input variables that strongly influence the model response (model output). Conversely, it may be of interest to the modeller to verify that although some model parameters may not be very well established they do not significantly contribute to output uncertainty. <span class="citation" data-cites="saltelli2000sensitivity">Saltelli et al. (<a href="#ref-saltelli2000sensitivity" role="doc-biblioref">2000</a>)</span> single out three main classes of SA methods: screening, local, and global methods. Local sensitivity analysis methods focus on assessing the impact of small variations in the input values of a model on the output results. Global sensitivity methods seek to understand how variations in the full range of input values affect the results. <span class="citation" data-cites="puy2022sensobol">Puy et al. (<a href="#ref-puy2022sensobol" role="doc-biblioref">2022</a>)</span> provide a comprehensive overview of several R packages for performing global sensitivity analysis.</p>
<p>Screening methods are economical and qualitative methods. Only screening methods are included in this implementation of the library as they provide a quick assessment of the relative importance of variables. This is particularly useful in exploratory studies and in cases where an initial subset of relevant variables needs to be identified.</p>
<p>Adequate sampling of parameter space is very important in model calibration. Several studies of uncertainty analysis in water resources problems <span class="citation" data-cites="melching2001uncertainty">(<a href="#ref-melching2001uncertainty" role="doc-biblioref">Melching and Bauwens 2001</a>)</span> concluded that Monte Carlo simulation and Latin Hypercube Sampling (LHS) <span class="citation" data-cites="mckay1979acomparisonof carnell2012lhs">(<a href="#ref-mckay1979acomparisonof" role="doc-biblioref">McKay et al. 1979</a>; <a href="#ref-carnell2012lhs" role="doc-biblioref">Carnell 2012</a>)</span> methods are very powerful, robust, and flexible. Other approaches are possible <span class="citation" data-cites="zambrano2014hydrogof">(<a href="#ref-zambrano2014hydrogof" role="doc-biblioref">Mauricio Zambrano-Bigiarini 2014</a>)</span>, but the LHS has the advantage that it is easily parallelisable, it explores the full range of parameter sets, it does not direct the search depending on the values of previous iterations like other optimisation methods (gradients, genetic algorithms, etc.), and is therefore independent of the GoF metric. This allows performing a posteriori sensitivity analysis for several metrics without having to repeat the process.</p>
<p>The <code>calib_green()</code> function computes 15 GoF metrics <span class="citation" data-cites="althoff2021goodness zambrano2014hydrogof">(<a href="#ref-zambrano2014hydrogof" role="doc-biblioref">Mauricio Zambrano-Bigiarini 2014</a>; <a href="#ref-althoff2021goodness" role="doc-biblioref">Althoff and Rodrigues 2021</a>)</span> (listed in <a href="#appendix-2">Appendix 2</a>), and returns an object with all parameter sets generated by the LHS and the corresponding GoF scores. Running <code>calib_green()</code> requires the following settings:</p>
<ol type="1">
<li><p>The expected ranges for each parameter. The ranges are defined by two vectors of three values, one for the lower limits and one for the upper limits of the three parameters. The values correspond to each model parameter in sequence: <span class="math inline">\(alpha_P\)</span> (Equation <a href="#eq:basin-retention">(3)</a>), <span class="math inline">\(alpha_L\)</span> (Equation <a href="#eq:river-retention">(4)</a>), and <span class="math inline">\(sd_{coeff}\)</span> (Equations <a href="#eq:appendix1-1">(5)</a> and <a href="#eq:appendix1-2">(6)</a>).</p></li>
<li><p>The number of iterations to be performed during the calibration process. The higher the number of iterations, the more likely it is to achieve good results, but the longer the computation time. Depending on the basin and parameter range width, it is recommended to run at least 200 iterations to have enough information to continue the calibration process.</p></li>
<li><p>The years to be included in the calibration process.</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>n_iter</span> <span class='op'>&lt;-</span> <span class='fl'>2000</span>  </span>
<span><span class='va'>low</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>0.000</span>, <span class='fl'>0.1</span><span class='op'>)</span>   </span>
<span><span class='va'>upp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>0.1</span>, <span class='fl'>0.9</span><span class='op'>)</span>    </span>
<span><span class='va'>years</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1990</span><span class='op'>:</span><span class='fl'>2018</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>calibration</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/calib_green.html'>calib_green</a></span><span class='op'>(</span><span class='va'>nutrient</span>, <span class='va'>catch</span>, <span class='va'>n_iter</span>, <span class='va'>low</span>, <span class='va'>upp</span>, <span class='va'>years</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The calibration process is automatically parallelised by the package and uses all computer cores except one. The computation time depends on the computer, the number of catchments in the basin, and the number of iterations (Table <a href="#tab:computational-requirements">1</a>). The <code>calib_green()</code> function returns a data frame with a row for each iteration with parameter values and the resulting 15 GoF metric scores. An example of four parameter sets is shown below (cut to the first five GoF metrics).</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>    alpha_P    alpha_L  sd_coeff    NSE   mNSE   rNSE    KGE PBIAS %
s1 39.31203 0.07628558 0.6325056 0.5623 0.6452 0.9595 0.2512   -44.1
s2 35.06049 0.05510985 0.1577470 0.6733 0.6948 0.9563 0.3763   -36.3
s3 28.34947 0.04418381 0.7209566 0.8690 0.7737 0.8998 0.7926    -1.7
s4 40.73533 0.01351723 0.6195734 0.8370 0.7734 0.9607 0.6292   -22.6</code></pre>
</div>
<p>The selection of the appropriate GoF metric(s) for calibration and evaluation of hydrological models can be challenging even for very experienced hydrologists. Choosing the right GoF metric for model calibration largely depends on the overall study scope, which defines the main interest (e.g. high or low load, upper or lower catchment area), and on the available observation dataset (size and quality) <span class="citation" data-cites="kumarasamy2018calibration">(<a href="#ref-kumarasamy2018calibration" role="doc-biblioref">Kumarasamy and Belmont 2018</a>)</span>. Automated calibration typically relies, often exclusively, on a single GoF metric, with the Nash-Suttclife efficiency (NSE) been the most frequently used metric in hydrological models <span class="citation" data-cites="gupta2009decomposition westerberg2011calibration wohling2013evaluating">(<a href="#ref-gupta2009decomposition" role="doc-biblioref">Gupta et al. 2009</a>; <a href="#ref-westerberg2011calibration" role="doc-biblioref">Westerberg et al. 2011</a>; <a href="#ref-wohling2013evaluating" role="doc-biblioref">Wöhling et al. 2013</a>)</span>. As described in <span class="citation" data-cites="singh2002mathematical">Singh and Frevert (<a href="#ref-singh2002mathematical" role="doc-biblioref">2002</a>)</span>, a single criterion is inherently predisposed to bias towards certain components of the data time series. Automated procedures may be improved by using more than one criteria as discussed by <span class="citation" data-cites="gupta1998toward">Gupta et al. (<a href="#ref-gupta1998toward" role="doc-biblioref">1998</a>)</span>. Although automation can help the calibration process become more objective, efficient and practical, it is not a substitute for expert hydrologic intuition and understanding. Whether automated or manual calibration is used, a common approach is to adjust the parameters that display the highest sensitivity <span class="citation" data-cites="madsen2003parameter doherty2006advanced">(<a href="#ref-madsen2003parameter" role="doc-biblioref">Madsen 2003</a>; <a href="#ref-doherty2006advanced" role="doc-biblioref">Doherty and Skahill 2006</a>)</span>.</p>
<p><a href="#">GREENeR</a> includes several functions to assist in selecting the best parameter set. The <code>calib_boxplot()</code> function shows (Figure <a href="#fig:boxplot-vistula-river">3</a>) relationships between best parameter sets chosen according to one GoF parameter (title of each boxplot) in relation to six most frequently used metrics. Additionally, in the lower panel, the figure shows the distribution of model parameters in the most performing subset of parameter sets. The best parameter set according to each GoF metrics is marked as a red dot in each boxplot (Figure <a href="#fig:boxplot-vistula-river">3</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/calib_boxplot.html'>calib_boxplot</a></span><span class='op'>(</span><span class='va'>calibration</span>, rate_bs <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:boxplot-vistula-river"></span>
<img src="figures/fig3.png" alt="Calibration results for the Vistula river basin (TN Scenario). The figure displays the output of the calib\_boxplot() function, and compare several GoF metrics (bR2, KGE, mNSE, NSE, PBIAS, R2, rNSE, VE) with each other and with the model parameters distributions. The top two rows show boxplots of each metric (specified in the title) with others (in the x labels). The lowest row shows the parameter value distributions for the top 5\% (or another threshold indicated in rate\_bs parameter of the function) parameter sets ranked according to the GoF metrics in the x label. The red dots represent the best parameter values for each boxplot." width="100%" height="40%" />
<p class="caption">
Figure 3: Calibration results for the Vistula river basin (TN Scenario). The figure displays the output of the calib_boxplot() function, and compare several GoF metrics (bR2, KGE, mNSE, NSE, PBIAS, R2, rNSE, VE) with each other and with the model parameters distributions. The top two rows show boxplots of each metric (specified in the title) with others (in the x labels). The lowest row shows the parameter value distributions for the top 5% (or another threshold indicated in rate_bs parameter of the function) parameter sets ranked according to the GoF metrics in the x label. The red dots represent the best parameter values for each boxplot.
</p>
</div>
</div>
<p>The <code>select_params()</code> function extracts the parameter set that scored the best GoF metric of choice from the calibration result object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>best_params</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/select_params.html'>select_params</a></span><span class='op'>(</span><span class='va'>calibration</span>, param <span class='op'>=</span> <span class='st'>"NSE"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>alpha_P</span>  <span class='op'>&lt;-</span> <span class='va'>best_params</span><span class='op'>$</span><span class='va'>alpha_P</span></span>
<span><span class='va'>alpha_L</span>  <span class='op'>&lt;-</span> <span class='va'>best_params</span><span class='op'>$</span><span class='va'>alpha_L</span> </span>
<span><span class='va'>sd_coeff</span> <span class='op'>&lt;-</span> <span class='va'>best_params</span><span class='op'>$</span><span class='va'>sd_coeff</span></span></code></pre>
</div>
</div>
<p>It is not recommended to use the parameters extracted by the <code>select_params()</code> function without having performed an analysis of all the calibration results. Instead, alternative parameter sets (according to different GoF) should be compared before making the final selection.</p>
<p>Screening and SA of model parameters can be done via the <code>scatter_plot()</code> and <code>calib_dot()</code> functions of <a href="#">GREENeR</a> package. The <code>scatter_plot()</code> function shows all parameter realizations in the LHS dataset against a selected GoF metric to visualize the influence of each parameter on the metric scores. The result depends on the GoF metric of choice (any metric calculated with <code>calib_green()</code> can be selected) (Figure <a href="#fig:scatter-plot-vistula-river">4</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/scatter_plot.html'>scatter_plot</a></span><span class='op'>(</span><span class='va'>calibration</span>, param <span class='op'>=</span> <span class='st'>"R2"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:scatter-plot-vistula-river"></span>
<img src="figures/fig4.png" alt="Scatter plots of model parameters against R2 metric generated by the scatter\_plot() function for the Vistula river basin (TN)." width="100%" height="31%" />
<p class="caption">
Figure 4: Scatter plots of model parameters against R2 metric generated by the scatter_plot() function for the Vistula river basin (TN).
</p>
</div>
</div>
<p>Figure <a href="#fig:scatter-plot-vistula-river">4</a> example shows that the highest R2 are achieved for values of the parameter <span class="math inline">\(alpha_P\)</span> around <span class="math inline">\(33.3\)</span> and for the parameter <span class="math inline">\(alpha_L\)</span> around <span class="math inline">\(0.025\)</span>, whereas the model is insensitive to the <span class="math inline">\(sd_{coef}\)</span> parameter. Further, <code>scatter_plot()</code> function helps check if the parameter ranges defined in the search were suitable, or if the number of iterations was sufficient. In Figure <a href="#fig:scatter-plot-vistula-river">4</a>, the best values of the parameters <span class="math inline">\(alpha_P\)</span> and <span class="math inline">\(alpha_L\)</span> are in the central part of the plots, thus the search parameter ranges were appropriate, and the distribution of dots is sufficient to visualize the effect of each parameter, indicating that the number of iterations was adequate.</p>
<p>The <code>calib_dot()</code> function shows the distribution of parameters in relation to each other for a chosen GoF metric, and highlights potential correlations between parameters (Figure <a href="#fig:dot-plot-vistula-river">5</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/calib_dot.html'>calib_dot</a></span><span class='op'>(</span><span class='va'>calibration</span>, param <span class='op'>=</span> <span class='st'>"KGE"</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:dot-plot-vistula-river"></span>
<img src="figures/fig5.png" alt="Dot plots of parameter pairs for the Kling-Gupta efficiency (KGE) generated by the calib\_dot() function for the Vistula river basin (TN)." width="100%" height="35%" />
<p class="caption">
Figure 5: Dot plots of parameter pairs for the Kling-Gupta efficiency (KGE) generated by the calib_dot() function for the Vistula river basin (TN).
</p>
</div>
</div>
<p>In Figure <a href="#fig:dot-plot-vistula-river">5</a>, the Kling-Gupta Efficiency metric <span class="citation" data-cites="althoff2021goodness">(KGE, <a href="#ref-althoff2021goodness" role="doc-biblioref">Althoff and Rodrigues 2021</a>)</span> shows interactions between <span class="math inline">\(alpha_P\)</span> and <span class="math inline">\(alpha_L\)</span>, i.e. a higher <span class="math inline">\(alpha_P\)</span> should be associated to a lower <span class="math inline">\(alpha_L\)</span> for achieving similar KGE. The best <span class="math inline">\(alpha_P\)</span> values identified for both R2 and KGE metrics are similar, whereas <span class="math inline">\(alpha_L\)</span> values vary considerably (see also Figure <a href="#fig:boxplot-vistula-river">3</a>).</p>
<p>The <a href="#">GREENeR</a> package includes two useful model calibration functions: <code>compare_calib()</code> and <code>simobs_annual_plot()</code>. <code>compare_calib()</code> shows a scatter plot that compares observed data points with corresponding values predicted by two parameter sets. Figure <a href="#fig:compare-calib-vistula-river">6</a> displays a plot generated by the <code>compare_calib()</code> for the Vistula (TN) basin scenario when using the best parameter sets based on NSE and rNSE metrics. The plot reveals that when rNSE parameter set result in an underestimation of loads in the upper range.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>metrics</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NSE"</span>,<span class='st'>"rNSE"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/compare_calib.html'>compare_calib</a></span><span class='op'>(</span><span class='va'>nutrient</span>, <span class='va'>catch</span>, alpha_p1 <span class='op'>=</span> <span class='fl'>31</span>, alpha_l1 <span class='op'>=</span> <span class='fl'>0.02</span>, sd_coef1 <span class='op'>=</span> <span class='fl'>0.6</span>,</span>
<span>              alpha_p2 <span class='op'>=</span> <span class='fl'>50</span>, alpha_l2 <span class='op'>=</span> <span class='fl'>0.01</span>, sd_coef2 <span class='op'>=</span> <span class='fl'>0.6</span>, years <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1990</span><span class='op'>:</span><span class='fl'>2018</span><span class='op'>)</span>, </span>
<span>              name_basin <span class='op'>=</span> <span class='st'>"Wisla"</span>, <span class='va'>metrics</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:compare-calib-vistula-river"></span>
<img src="figures/fig6.png" alt="Result of compare\_calib() for the Vistula river basin (TN), comparing the best set of parameters selected according to the NSE and rNSE metrics." width="100%" height="45%" />
<p class="caption">
Figure 6: Result of compare_calib() for the Vistula river basin (TN), comparing the best set of parameters selected according to the NSE and rNSE metrics.
</p>
</div>
</div>
<p>The <code>simobs_annual_plot()</code> function compares observed and predicted values over the years (Figure <a href="#fig:simobs-annual-plot-vistula-river">7</a>), which identifies erroneous model performance or data distribucion problems over time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>year_range</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1994</span>, <span class='fl'>1996</span><span class='op'>:</span><span class='fl'>2001</span>, <span class='fl'>2006</span><span class='op'>:</span><span class='fl'>2009</span>, <span class='fl'>2012</span><span class='op'>)</span>      </span>
<span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/simobs_annual_plot.html'>simobs_annual_plot</a></span><span class='op'>(</span><span class='va'>nutrient</span>, <span class='va'>catch</span>, <span class='va'>alpha_P</span>, <span class='va'>alpha_L</span>, <span class='va'>sd_coeff</span>, <span class='va'>year_range</span>, </span>
<span>                   name_basin <span class='op'>=</span> <span class='st'>"Wisla"</span>, max_value <span class='op'>=</span> <span class='fl'>10000</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:simobs-annual-plot-vistula-river"></span>
<img src="figures/fig7.png" alt="Result of the simobs\_annual\_plot() for the Vistula river basin (TN), with the parameter set selected for highest NSE and limiting the plots to the interval between 0 and 10000." width="100%" height="30%" />
<p class="caption">
Figure 7: Result of the simobs_annual_plot() for the Vistula river basin (TN), with the parameter set selected for highest NSE and limiting the plots to the interval between 0 and 10000
</p>
</div>
</div>
<h3 data-number="3.3" id="estimation-of-catchment-nutrient-loads-and-contribution-in-the-basin"><span class="header-section-number">3.3</span> Estimation of catchment nutrient loads and contribution in the basin</h3>
<p>Once the most appropriate parameter set has been selected, it is possible to run the model to estimate nutrient loads in the region. The <code>green_shares()</code> function runs GREEN with the selected parameter set and returns catchment nutrient loads and the contributions by source in the simulation period.</p>
<p>The <code>nutrient_tserie()</code> function shows the temporal evolution of the total load at the basin outlet in the simulation period with contributions by sources (Figure <a href="#fig:total-TN-vistula-river">8</a>). Other options of the function show nutrient loads in different zones of the basin (upper, central and lower part).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nutrient_load</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/green_shares.html'>green_shares</a></span><span class='op'>(</span><span class='va'>nutrient</span>, <span class='va'>catch</span>, <span class='va'>alpha_P</span>, <span class='va'>alpha_L</span>, <span class='va'>sd_coeff</span>, <span class='va'>years</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/nutrient_tserie.html'>nutrient_tserie</a></span><span class='op'>(</span><span class='va'>nutrient_load</span>, <span class='va'>geometry</span>, <span class='st'>"Wisla basin"</span>, <span class='st'>"gr3"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:total-TN-vistula-river"></span>
<img src="figures/fig8.png" alt="Total nitrogen load at the Vistula river basin outlet from 1990 to 2018. Colors indicate the contribution of different sources (Min = mineral, Man = manure, Atm = atmospheric deposition, Fix = crop fixation, Soil = soil fixation, Sd = scattered dwellings and Ps = point sources)." width="90%" height="25%" />
<p class="caption">
Figure 8: TN load at the Vistula river basin outlet from 1990 to 2018. Colors indicate the contribution of different sources (Min = mineral, Man = manure, Atm = atmospheric deposition, Fix = crop fixation, Soil = soil fixation, Sd = scattered dwellings and Ps = point sources).
</p>
</div>
</div>
<p>The <code>nutrient_maps()</code> function uses the object returned by <code>green_shares()</code> to generate maps of the distribution of nutrient loads by source for a given year or as the mean for several years (Figure <a href="#fig:maps-TN-vistula-river">9</a>). The results are shown in logarithmic scale to improve the visualization as nutrient loads in a region may vary over several orders of magnitude. Alternative options of the function show the total load at the outlets of the catchment or the specific loads (i.e. load per catchment area; in kt/km<span class="math inline">\(^2\)</span>/y).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>map_title</span> <span class='op'>&lt;-</span> <span class='st'>"Output Loads for the Vistula basin"</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/nutrient_maps.html'>nutrient_maps</a></span><span class='op'>(</span><span class='va'>nutrient_load</span>, <span class='va'>geometry</span>, <span class='va'>map_title</span>, <span class='st'>"gr1"</span>, legend_position <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:maps-TN-vistula-river"></span>
<img src="figures/fig9.png" alt="Maps of TN loads in the Vistula river basin by different sources and in total (the sum of all other maps, bottom right), in logarithm scale as generated with nutrient\_maps() function." width="100%" height="25%" />
<p class="caption">
Figure 9: Maps of TN loads in the Vistula river basin by different sources and in total (the sum of all other maps, bottom right), in logarithm scale as generated with nutrient_maps() function.
</p>
</div>
</div>
<h3 data-number="3.4" id="estimation-of-nutrient-fluxes-and-sources-contribution-in-the-basin"><span class="header-section-number">3.4</span> Estimation of nutrient fluxes and sources contribution in the basin</h3>
<p>The <code>region_nut_balance()</code> function runs GREEN with the selected parameter set, and returns the nutrient mass balance and fluxes of the region (mean value for the simulation period). The results of this function can be visualized in a Sankey diagram with the function <code>N4_sankey()</code> (Figure <a href="#fig:sankey-vistula-river">10</a>) .</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nut_bal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/region_nut_balance.html'>region_nut_balance</a></span><span class='op'>(</span><span class='va'>nutrient</span>, <span class='va'>catch</span>, <span class='va'>alpha_P</span>, <span class='va'>alpha_L</span>, <span class='va'>sd_coeff</span>, </span>
<span>                              <span class='va'>years</span><span class='op'>)</span></span>
<span><span class='va'>sank</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GREENeR/man/N4_sankey.html'>N4_sankey</a></span><span class='op'>(</span><span class='va'>nut_bal</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:sankey-vistula-river"></span>
<img src="figures/fig10.png" alt="Sankey plot for the Vistula river basin for TN scenario, average for period 1990-2018. The plot represents nitrogen input sources on the left (Min=mineral, Man=manure, Atm=atmospheric deposition, Fix=crop fixation, Soil=soil fixation, Sd=scattered dwellings and Ps=point sources), and nitrogen sinks (land, river and lake retention) and outlet discharge (load to outlet) on the right. The bars in the middle visualize nitrogen agricultural diffuse sources and loads to the stream network." width="100%" height="35%" />
<p class="caption">
Figure 10: Sankey plot for the Vistula river basin for TN scenario, average for period 1990-2018. The plot represents nitrogen input sources on the left (Min=mineral, Man=manure, Atm=atmospheric deposition, Fix=crop fixation, Soil=soil fixation, Sd=scattered dwellings and Ps=point sources), and nitrogen sinks (land, river and lake retention) and outlet discharge (load to outlet) on the right. The bars in the middle visualize nitrogen agricultural diffuse sources and loads to the stream network.
</p>
</div>
</div>
<h2 data-number="4" id="conclusion"><span class="header-section-number">4</span> Conclusion</h2>
<p>The <a href="#">GREENeR</a> package provides several functions to assess nutrient pressures in fresh and coastal waters based on the GREEN model <span class="citation" data-cites="grizzetti2012changes grizzetti2021eu">(<a href="#ref-grizzetti2012changes" role="doc-biblioref">Grizzetti et al. 2012</a>, <a href="#ref-grizzetti2021eu" role="doc-biblioref">2021</a>)</span>. It allows assessing annual nutrient loads and concentrations throughout the river network and at river outlets, as well as the contributions of diffuse and point sources to the total load. <a href="#">GREENeR</a> includes functions to route nutrient sources in a region, considering different pathways and the hydrological structure of the river network. The package is enriched by functions that aid selecting the set of parameters that best suits the study scope. Several functions assist in the preparation of scenarios by assembling input data from the appropriate sources, and in visualising inputs and nutrient fluxes in space and time. The version of the GREEN model implemented in the package is computationally efficient and includes parallel running capabilities for the calibration process, greatly reducing the time required for large basins or regional applications, e.g. at continental scale as in <span class="citation" data-cites="vigiak2023recent">(<a href="#ref-vigiak2023recent" role="doc-biblioref">Vigiak et al. 2023</a>)</span>.</p>
<h2 data-number="5" id="acknowledgements"><span class="header-section-number">5</span> Acknowledgements</h2>
<p>This work has been partially supported by grant XMIDAS, ref. PID2021-122640OB-I00, funded by the Spanish Ministry of Science and Innovation.</p>
<h2 data-number="6" id="appendix"><span class="header-section-number">6</span> Appendix</h2>
<h3 data-number="6.1" id="appendix-1"><span class="header-section-number">6.1</span> Appendix 1</h3>
<p>Diffuse and point sources are defined differently for each nutrient module, i.e. nitrogen or phosphorus. Equation <a href="#eq:appendix1-1">(5)</a> formulates the general GREEN function stated in equation <a href="#eq:green-nutrient-load">(1)</a> in the case of nitrogen. In GREEN nitrogen model, the total nitrogen load <span class="math inline">\(L_i\)</span> of catchment <span class="math inline">\(i\)</span> is estimated as:</p>
<span class="math display" id="eq:appendix1-1">\[\begin{equation}
\begin{split}
   L_i = (1 - Lret_i) \cdot ((MinN_i + ManN_i + FixN_i + SoilN_i + (1 - FF_i) \cdot AtmN_i) \cdot \\ (1 - Bret_i) + 0.38 \cdot FF_i \cdot AtmN_i + sd_{coeff} \cdot SdN_i + PsN_i + U_i) \cdot (1 - Rret_i)  
\end{split}
\tag{5}
\end{equation}\]</span>
<p>where <span class="math inline">\(MinN_i\)</span> is the annual amount of nitrogen from mineral fertilisers (ton/yr); <span class="math inline">\(ManN_i\)</span> is the annual amount of nitrogen in manure fertilisers (ton/yr); <span class="math inline">\(FixN_i\)</span> is the annual amount of nitrogen fixation by leguminous crops and fodder (ton/yr); <span class="math inline">\(SoilN_i\)</span> is the annual amount of nitrogen fixation by bacteria in soils (ton/yr); <span class="math inline">\(AtmN_i\)</span> is the annual nitrogen deposition from atmosphere (ton/yr); <span class="math inline">\(FF_i\)</span> is the non-agricultural land cover in the catchment (fraction); <span class="math inline">\(SdN_i\)</span> is the nitrogen input from scattered dwellings (ton/yr); <span class="math inline">\(PsN_i\)</span> is the nitrogen input from point sources (ton/yr); and, finally, <span class="math inline">\(U_i\)</span> is the nitrogen load from upstream catchments (ton/yr).</p>
<p>Note that nitrogen atmospheric deposition losses are split into two parts, i.e. inputs to agricultural land, which undergo the basin retention (such as crop uptake) that depends on annual precipitation, while in forest areas they are reduced by a fixed rate, before entering into the stream. The contribution of atmospheric nitrogen deposition in non-agricultural land is thus estimated as <span class="math inline">\(0.38 \cdot FF \cdot AtmN\)</span>. For an atmospheric deposition of <span class="math inline">\(10\)</span> kgN/ha this corresponds to a background of <span class="math inline">\(3.8\)</span> kgN/ha (in line with the values reported by <span class="citation" data-cites="helcom2003">HELCOM (<a href="#ref-helcom2003" role="doc-biblioref">2003</a>)</span>).</p>
<p>Phosphorous background losses are split into two parts, with the inputs to agricultural land undergoing basin retention, while in forest areas they are considered entering into the stream. Background losses for phosphorus are estimated at 0.15 kgP/ha (in line with the values reported by <span class="citation" data-cites="helcom2003">(<a href="#ref-helcom2003" role="doc-biblioref">HELCOM 2003</a>)</span>.</p>
<p>In GREEN phosphorus model, the total annual phosphorus load <span class="math inline">\(L_i\)</span> of catchment <span class="math inline">\(i\)</span> the equation estimates:</p>
<span class="math display" id="eq:appendix1-2">\[\begin{equation}
\begin{split}
  L_i = (1 - Lret_i) \cdot ((MinP_i + ManP_i + (1 - FF_i) \cdot BgP_i) \cdot (1 - Bret_i) + \\
  FF_i \cdot BgP_i + sd_{coeff} \cdot SdP_i + PsP_i + Ui_i) \cdot (1 - Rret_i)
  \end{split}
\tag{6}
\end{equation}\]</span>
<p>where <span class="math inline">\(MinP_i\)</span> is the annual amount of phosphorus mineral fertilisers (ton/yr); <span class="math inline">\(ManP_i\)</span> is the annual amount of phosphorus in manure fertilisers (ton/yr); <span class="math inline">\(FF_i\)</span> is the non-agricultural land cover in the catchment (fraction);<span class="math inline">\(BgP_i\)</span> is the annual amount of phosphorus background losses (ton/yr); <span class="math inline">\(SdP_i\)</span> is the phosphorus input from scattered dwellings (ton/yr); <span class="math inline">\(PsP_i\)</span> is the phosphorus input from point sources (ton/yr); and <span class="math inline">\(Ui_i\)</span> is the phosphorus load from upstream catchments (ton/yr).</p>
<h3 data-number="6.2" id="appendix-2"><span class="header-section-number">6.2</span> Appendix 2</h3>
<p>The <code>calib_green()</code> function applies the following GoF metrics <span class="citation" data-cites="althoff2021goodness zambrano2014hydrogof">(<a href="#ref-zambrano2014hydrogof" role="doc-biblioref">Mauricio Zambrano-Bigiarini 2014</a>; <a href="#ref-althoff2021goodness" role="doc-biblioref">Althoff and Rodrigues 2021</a>)</span> (NSE, rNSE, mNSE, R2, PBIAS), where:</p>
<ul>
<li><p>NSE: Nash-Sutcliffe efficiency.</p></li>
<li><p>rNSE: Relative Nash-Sutcliffe efficiency.</p></li>
<li><p>mNSE: Modified Nash-Sutcliffe efficiency.</p></li>
<li><p>cp: Coefficient of Persistence.</p></li>
<li><p>VE: Volumetric Efficiency.</p></li>
<li><p>KGE : Kling-Gupta efficiency.</p></li>
<li><p>d : Index of Agreement.</p></li>
<li><p>md: Modified index of agreement.</p></li>
<li><p>rd: Relative Index of Agreement.</p></li>
<li><p>r: Linear correlation coefficient.</p></li>
<li><p>R2: Coefficient of determination.</p></li>
<li><p>PBIAS: Percent bias.</p></li>
<li><p>MAE: mean absolute error.</p></li>
<li><p>RMSE: Root mean square error.</p></li>
<li><p>ME: Mean error.</p></li>
<li><p>MSE: Mean square error.</p></li>
<li><p>NRMSE: Normalized Root Mean Square Error.</p></li>
</ul>
<p>See <span class="citation" data-cites="papacharalampous2019comparison nash1970river kitanidis1980real yapo1996automatic krause2005comparison criss2008nash gupta1998toward zambrano2014hydrogof">(<a href="#ref-nash1970river" role="doc-biblioref">Nash and Sutcliffe 1970</a>; <a href="#ref-kitanidis1980real" role="doc-biblioref">Kitanidis and Bras 1980</a>; <a href="#ref-yapo1996automatic" role="doc-biblioref">Yapo et al. 1996</a>; <a href="#ref-gupta1998toward" role="doc-biblioref">Gupta et al. 1998</a>; <a href="#ref-krause2005comparison" role="doc-biblioref">Krause et al. 2005</a>; <a href="#ref-criss2008nash" role="doc-biblioref">Criss and Winston 2008</a>; <a href="#ref-zambrano2014hydrogof" role="doc-biblioref">Mauricio Zambrano-Bigiarini 2014</a>; <a href="#ref-papacharalampous2019comparison" role="doc-biblioref">Papacharalampous et al. 2019</a>)</span> for further details.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="6.3" id="supplementary-materials"><span class="header-section-number">6.3</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-065.zip">RJ-2023-065.zip</a></p>
<h3 class="appendix" data-number="6.4" id="cran-packages-used"><span class="header-section-number">6.4</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=GREENeR">GREENeR</a></p>
<h3 class="appendix" data-number="6.5" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">6.5</span> CRAN Task Views implied by cited packages</h3>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-althoff2021goodness" class="csl-entry" role="listitem">
D. Althoff and L. N. Rodrigues. Goodness-of-fit criteria for hydrological models: Model calibration and performance assessment. <em>Journal of Hydrology</em>, 600: 126674, 2021. URL <a href="https://www.sciencedirect.com/science/article/pii/S0022169421007228">https://www.sciencedirect.com/science/article/pii/S0022169421007228</a>.
</div>
<div id="ref-arheimer2012climate" class="csl-entry" role="listitem">
B. Arheimer, J. Dahné and C. Donnelly. Climate change impact on riverine nutrient load and land-based remedial measures of the baltic sea action plan. <em>Ambio</em>, 41(6): 600–612, 2012. URL <a href="https://doi.org/10.1007/s13280-012-0323-0">https://doi.org/10.1007/s13280-012-0323-0</a>.
</div>
<div id="ref-bartosova2019future" class="csl-entry" role="listitem">
A. Bartosova, R. Capell, J. E. Olesen, M. Jabloun, J. C. Refsgaard, C. Donnelly, K. Hyytiäinen, S. Pihlainen, M. Zandersen and B. Arheimer. Future socioeconomic conditions may have a larger impact than climate change on nutrient loads to the baltic sea. <em>Ambio</em>, 48(11): 1325–1336, 2019. URL <a href="https://doi.org/10.1007/s13280-019-01243-5">https://doi.org/10.1007/s13280-019-01243-5</a>.
</div>
<div id="ref-BEUSEN2022102426" class="csl-entry" role="listitem">
A. H. W. Beusen, J. C. Doelman, L. P. H. Van Beek, P. J. T. M. Van Puijenbroek, J. M. Mogollón, H. J. M. Van Grinsven, E. Stehfest, D. P. Van Vuuren and A. F. Bouwman. Exploring river nitrogen and phosphorus loading and export to global coastal waters in the shared socio-economic pathways. <em>Global Environmental Change</em>, 72: 102426, 2022. URL <a href="https://www.sciencedirect.com/science/article/pii/S0959378021002053">https://www.sciencedirect.com/science/article/pii/S0959378021002053</a>.
</div>
<div id="ref-bouraoui2014scenario" class="csl-entry" role="listitem">
F. Bouraoui, V. Thieu, B. Grizzetti, W. Britz and G. Bidoglio. Scenario analysis for nutrient emission reduction in the european inland waters. <em>Environmental Research Letters</em>, 9(12): 125007, 2014. URL <a href="https://doi.org/10.1088/1748-9326/9/12/125007">https://doi.org/10.1088/1748-9326/9/12/125007</a>.
</div>
<div id="ref-butler2014identifying" class="csl-entry" role="listitem">
M. P. Butler, P. M. Reed, K. Fisher-Vanden, K. Keller and T. Wagener. Identifying parametric controls and dependencies in integrated assessment models using global sensitivity analysis. <em>Environmental modelling &amp; software</em>, 59: 10–29, 2014. URL <a href="https://www.sciencedirect.com/science/article/pii/S1364815214001327">https://www.sciencedirect.com/science/article/pii/S1364815214001327</a>.
</div>
<div id="ref-carnell2012lhs" class="csl-entry" role="listitem">
R. Carnell. <em>Lhs: Latin hypercube samples.</em> 2012. URL <a href="https://CRAN.R-project.org/package=lhs">https://CRAN.R-project.org/package=lhs</a>. R package version 0.10.
</div>
<div id="ref-criss2008nash" class="csl-entry" role="listitem">
R. E. Criss and W. E. Winston. Do nash values have value? Discussion and alternate proposals. <em>Hydrological Processes: An International Journal</em>, 22(14): 2723–2725, 2008. URL <a href="https://doi.org/10.1002/hyp.7072">https://doi.org/10.1002/hyp.7072</a>.
</div>
<div id="ref-de2007rivers" class="csl-entry" role="listitem">
A. De Jager and J. Vogt. Rivers and catchments of europe-catchment characterisation model (CCM). <em>European Commission, Joint Research Centre (JRC), Ispra, Italy</em>, 2007.
</div>
<div id="ref-doherty2006advanced" class="csl-entry" role="listitem">
J. Doherty and B. E. Skahill. An advanced regularization methodology for use in watershed model calibration. <em>Journal of Hydrology</em>, 327(3-4): 564–577, 2006. URL <a href="https://www.sciencedirect.com/science/article/pii/S0022169405006542">https://www.sciencedirect.com/science/article/pii/S0022169405006542</a>.
</div>
<div id="ref-EEA_2019" class="csl-entry" role="listitem">
EEA. <span>European Environment Agency (EEA)</span>. <em>WISE Water Framework Directive Database</em>, 2021. URL <a href="https://www.eea.europa.eu/data-and-maps/data/wise-wfd-4">https://www.eea.europa.eu/data-and-maps/data/wise-wfd-4</a>. Accessed: 2022-07-10.
</div>
<div id="ref-frank1994data" class="csl-entry" role="listitem">
I. E. Frank and R. Todeschini. <em>The data analysis handbook.</em> Elsevier, 1994.
</div>
<div id="ref-fu2019review" class="csl-entry" role="listitem">
B. Fu, W. S. Merritt, B. F. Croke, T. R. Weber and A. J. Jakeman. A review of catchment-scale water quality and erosion models and a synthesis of future prospects. <em>Environmental modelling &amp; software</em>, 114: 75–97, 2019. URL <a href="https://www.sciencedirect.com/science/article/pii/S1364815218307461">https://www.sciencedirect.com/science/article/pii/S1364815218307461</a>.
</div>
<div id="ref-grizzetti2012changes" class="csl-entry" role="listitem">
B. Grizzetti, F. Bouraoui and A. Aloe. Changes of nitrogen and phosphorus loads to european seas. <em>Global Change Biology</em>, 18(2): 769–782, 2012. URL <a href="https://doi.org/10.1111/j.1365-2486.2011.02576.x">https://doi.org/10.1111/j.1365-2486.2011.02576.x</a>.
</div>
<div id="ref-grizzetti2008assessing" class="csl-entry" role="listitem">
B. Grizzetti, F. Bouraoui and G. De Marsily. Assessing nitrogen pressures on european surface water. <em>Global Biogeochemical Cycles</em>, 22(4): 2008. URL <a href="https://doi.org/10.1029/2007GB003085">https://doi.org/10.1029/2007GB003085</a>.
</div>
<div id="ref-grizzetti2005statistical" class="csl-entry" role="listitem">
B. Grizzetti, F. Bouraoui, G. De Marsily and G. Bidoglio. A statistical method for source apportionment of riverine nitrogen loads. <em>Journal of Hydrology</em>, 304(1-4): 302–315, 2005. URL <a href="https://www.sciencedirect.com/science/article/pii/S0022169404005013">https://www.sciencedirect.com/science/article/pii/S0022169404005013</a>.
</div>
<div id="ref-grizzetti2021eu" class="csl-entry" role="listitem">
B. Grizzetti, O. Vigiak, A. Udias, A. Aloe, M. Zanni, F. Bouraoui, A. Pistocchi, C. Dorati, R. Friedland, A. De Roo, et al. How EU policies could reduce nutrient pollution in european inland and coastal waters. <em>Global Environmental Change</em>, 69: 102281, 2021. URL <a href="https://www.sciencedirect.com/science/article/pii/S0959378021000601">https://www.sciencedirect.com/science/article/pii/S0959378021000601</a>.
</div>
<div id="ref-gupta2009decomposition" class="csl-entry" role="listitem">
H. V. Gupta, H. Kling, K. K. Yilmaz and G. F. Martinez. Decomposition of the mean squared error and NSE performance criteria: Implications for improving hydrological modelling. <em>Journal of hydrology</em>, 377(1-2): 80–91, 2009. URL <a href="https://www.sciencedirect.com/science/article/pii/S0022169409004843">https://www.sciencedirect.com/science/article/pii/S0022169409004843</a>.
</div>
<div id="ref-gupta1998toward" class="csl-entry" role="listitem">
H. V. Gupta, S. Sorooshian and P. O. Yapo. Toward improved calibration of hydrologic models: Multiple and noncommensurable measures of information. <em>Water Resources Research</em>, 34(4): 751–763, 1998. URL <a href="https://doi.org/10.1029/97WR03495">https://doi.org/10.1029/97WR03495</a>.
</div>
<div id="ref-helcom2003" class="csl-entry" role="listitem">
H. C. HELCOM. Fourth baltic sea load compilation (PLC-4). 93, 189 pages. 2003.
</div>
<div id="ref-kitanidis1980real" class="csl-entry" role="listitem">
P. K. Kitanidis and R. L. Bras. Real-time forecasting with a conceptual hydrologic model: 2. Applications and results. <em>Water Resources Research</em>, 16(6): 1034–1044, 1980. URL <a href="https://doi.org/10.1029/WR016i006p01034">https://doi.org/10.1029/WR016i006p01034</a>.
</div>
<div id="ref-krause2005comparison" class="csl-entry" role="listitem">
P. Krause, D. Boyle and F. Bäse. Comparison of different efficiency criteria for hydrological model assessment. <em>Advances in geosciences</em>, 5: 89–97, 2005. URL <a href="https://adgeo.copernicus.org/articles/5/89/2005/">https://adgeo.copernicus.org/articles/5/89/2005/</a>.
</div>
<div id="ref-kronvang2004nutrient" class="csl-entry" role="listitem">
B. Kronvang, J. Hezlar, P. Boers, J. P. Jensen, H. Behrendt, T. Anderson, B. Arheimer, M. Venohr, C. C. Hoffmann and C. Nielsen. Nutrient retention handbook. <em>Software Manual for EUROHARP-NUTRET and Scientific review on nutrient retention. EUROHARP report</em>, 9–2004, 2004.
</div>
<div id="ref-kumarasamy2018calibration" class="csl-entry" role="listitem">
K. Kumarasamy and P. Belmont. Calibration parameter selection and watershed hydrology model evaluation in time and frequency domains. <em>Water</em>, 10(6): 710, 2018. URL <a href="https://doi.org/10.3390/w10060710">https://doi.org/10.3390/w10060710</a>.
</div>
<div id="ref-la2017physical" class="csl-entry" role="listitem">
A. La Notte, J. Maes, S. Dalmazzone, N. D. Crossman, B. Grizzetti and G. Bidoglio. Physical and monetary ecosystem service accounts for europe: A case study for in-stream nitrogen retention. <em>Ecosystem services</em>, 23: 18–29, 2017. URL <a href="https://www.sciencedirect.com/science/article/pii/S2212041616304545">https://www.sciencedirect.com/science/article/pii/S2212041616304545</a>.
</div>
<div id="ref-leip2015impacts" class="csl-entry" role="listitem">
A. Leip, G. Billen, J. Garnier, B. Grizzetti, L. Lassaletta, S. Reis, D. Simpson, M. A. Sutton, W. De Vries, F. Weiss, et al. Impacts of european livestock production: Nitrogen, sulphur, phosphorus and greenhouse gas emissions, land-use, water eutrophication and biodiversity. <em>Environmental Research Letters</em>, 10(11): 115004, 2015. URL <a href="https://doi.org/10.1088/1748-9326/10/11/115004">https://doi.org/10.1088/1748-9326/10/11/115004</a>.
</div>
<div id="ref-ludwig2010water" class="csl-entry" role="listitem">
W. Ludwig, A. Bouwman, E. Dumont and F. Lespinas. Water and nutrient fluxes from major mediterranean and black sea rivers: Past and future trends and their implications for the basin-scale budgets. <em>Global biogeochemical cycles</em>, 24(4): 2010. URL <a href="https://doi.org/10.1029/2009GB003594">https://doi.org/10.1029/2009GB003594</a>.
</div>
<div id="ref-madsen2003parameter" class="csl-entry" role="listitem">
H. Madsen. Parameter estimation in distributed hydrological catchment modelling using automatic calibration with multiple objectives. <em>Advances in water resources</em>, 26(2): 205–216, 2003. URL <a href="https://www.sciencedirect.com/science/article/pii/S0309170802000921">https://www.sciencedirect.com/science/article/pii/S0309170802000921</a>.
</div>
<div id="ref-malago2019modelling" class="csl-entry" role="listitem">
A. Malagó, F. Bouraoui, B. Grizzetti and A. De Roo. Modelling nutrient fluxes into the mediterranean sea. <em>Journal of Hydrology: Regional Studies</em>, 22: 100592, 2019. URL <a href="https://www.sciencedirect.com/science/article/pii/S221458181830226X">https://www.sciencedirect.com/science/article/pii/S221458181830226X</a>.
</div>
<div id="ref-manache2004sensitivity" class="csl-entry" role="listitem">
G. Manache and C. S. Melching. Sensitivity analysis of a water-quality model using latin hypercube sampling. <em>Journal of Water Resources Planning and Management</em>, 130(3): 232–242, 2004. URL <a href="https://doi.org/10.1061/(ASCE)0733-9496(2004)130:3(232)">https://doi.org/10.1061/(ASCE)0733-9496(2004)130:3(232)</a>.
</div>
<div id="ref-mannina2018global" class="csl-entry" role="listitem">
G. Mannina, A. Cosenza, M. Neumann and P. Vanrolleghem. Global sensitivity analysis in wastewater treatment modelling. <em>Advances in Wastewater Treatment</em>, 1: 32, 2018.
</div>
<div id="ref-zambrano2014hydrogof" class="csl-entry" role="listitem">
Mauricio Zambrano-Bigiarini. <em>hydroGOF: Goodness-of-fit functions for comparison of simulated and observed hydrological time series.</em> 2014. URL <a href="https://github.com/hzambran/hydroGOF">https://github.com/hzambran/hydroGOF</a>. R package version 0.3-8.
</div>
<div id="ref-mckay1979acomparisonof" class="csl-entry" role="listitem">
M. McKay, R. Beckman and W. Conover. A comparison of three methods for selecting values of input variables in the analysis of output from a computer code. <em>Technometrics</em>, 21(2): 239–245, 1979. URL <a href="https://doi.org/10.2307/1268522">https://doi.org/10.2307/1268522</a>.
</div>
<div id="ref-melching2001uncertainty" class="csl-entry" role="listitem">
C. S. Melching and W. Bauwens. Uncertainty in coupled nonpoint source and stream water-quality models. <em>Journal of Water Resources Planning and Management</em>, 127(6): 403–413, 2001. URL <a href="https://doi.org/10.1061/(ASCE)0733-9496(2001)127:6(403)">https://doi.org/10.1061/(ASCE)0733-9496(2001)127:6(403)</a>.
</div>
<div id="ref-messager2016estimating" class="csl-entry" role="listitem">
M. L. Messager, B. Lehner, G. Grill, I. Nedeva and O. Schmitt. Estimating the volume and age of water stored in global lakes using a geo-statistical approach. <em>Nature communications</em>, 7(1): 1–11, 2016. URL <a href="https://doi.org/10.1038/ncomms13603">https://doi.org/10.1038/ncomms13603</a>.
</div>
<div id="ref-nash1970river" class="csl-entry" role="listitem">
J. E. Nash and J. V. Sutcliffe. River flow forecasting through conceptual models part i-a discussion of principles. <em>Journal of hydrology</em>, 10(3): 282–290, 1970. URL <a href="https://www.sciencedirect.com/science/article/pii/0022169470902556">https://www.sciencedirect.com/science/article/pii/0022169470902556</a>.
</div>
<div id="ref-norton2015introduction" class="csl-entry" role="listitem">
J. Norton. An introduction to sensitivity assessment of simulation models. <em>Environmental Modelling &amp; Software</em>, 69: 166–174, 2015. URL <a href="https://www.sciencedirect.com/science/article/pii/S1364815215001085">https://www.sciencedirect.com/science/article/pii/S1364815215001085</a>.
</div>
<div id="ref-papacharalampous2019comparison" class="csl-entry" role="listitem">
G. Papacharalampous, H. Tyralis and D. Koutsoyiannis. Comparison of stochastic and machine learning methods for multi-step ahead forecasting of hydrological processes. <em>Stochastic environmental research and risk assessment</em>, 33(2): 481–514, 2019. URL <a href="https://doi.org/10.1007/s00477-018-1638-6">https://doi.org/10.1007/s00477-018-1638-6</a>.
</div>
<div id="ref-pianosi2016sensitivity" class="csl-entry" role="listitem">
F. Pianosi, K. Beven, J. Freer, J. W. Hall, J. Rougier, D. B. Stephenson and T. Wagener. Sensitivity analysis of environmental models: A systematic review with practical workflow. <em>Environmental Modelling &amp; Software</em>, 79: 214–232, 2016. URL <a href="https://www.sciencedirect.com/science/article/pii/S1364815216300287">https://www.sciencedirect.com/science/article/pii/S1364815216300287</a>.
</div>
<div id="ref-puy2022sensobol" class="csl-entry" role="listitem">
A. Puy, S. Lo Piano, A. Saltelli and S. A. Levin. Sensobol: An r package to compute variance-based sensitivity indices. <em>Journal of Statistical Software</em>, 102(5): 1–37, 2022. URL <a href="https://www.jstatsoft.org/index.php/jss/article/view/v102i05">https://www.jstatsoft.org/index.php/jss/article/view/v102i05</a>.
</div>
<div id="ref-refsgaard2004modelling" class="csl-entry" role="listitem">
J. C. Refsgaard and H. J. Henriksen. Modelling guidelines—-terminology and guiding principles. <em>Advances in Water Resources</em>, 27(1): 71–82, 2004. URL <a href="https://www.sciencedirect.com/science/article/pii/S0309170803001489">https://www.sciencedirect.com/science/article/pii/S0309170803001489</a>.
</div>
<div id="ref-saltelli2011" class="csl-entry" role="listitem">
A. Saltelli, P. Annoni, et al. Sensitivity analysis. 2011.
</div>
<div id="ref-saltelli2000sensitivity" class="csl-entry" role="listitem">
A. Saltelli, S. Tarantola and F. Campolongo. Sensitivity analysis as an ingredient of modeling. <em>Statistical Science</em>, 377–395, 2000. URL <a href="http://www.jstor.org/stable/2676831">http://www.jstor.org/stable/2676831</a>.
</div>
<div id="ref-schwarz2006sparrow" class="csl-entry" role="listitem">
G. E. Schwarz, A. B. Hoos, R. Alexander and R. Smith. The SPARROW surface water-quality model: Theory, application and user documentation. 2006.
</div>
<div id="ref-seitzinger2005sources" class="csl-entry" role="listitem">
S. Seitzinger, J. Harrison, E. Dumont, A. H. Beusen and A. Bouwman. Sources and delivery of carbon, nitrogen, and phosphorus to the coastal zone: An overview of global nutrient export from watersheds (<span>NEWS</span>) models and their application. <em>Global biogeochemical cycles</em>, 19(4): 2005. URL <a href="https://doi.org/10.1029/2005GB002606">https://doi.org/10.1029/2005GB002606</a>.
</div>
<div id="ref-shreve1966statistical" class="csl-entry" role="listitem">
R. L. Shreve. Statistical law of stream numbers. <em>The Journal of Geology</em>, 74(1): 17–37, 1966. URL <a href="http://www.jstor.org/stable/30075174">http://www.jstor.org/stable/30075174</a>.
</div>
<div id="ref-singh2002mathematical" class="csl-entry" role="listitem">
V. P. Singh and D. K. Frevert. <em>Mathematical models of large watershed hydrology.</em> Water Resources Publication, 2002.
</div>
<div id="ref-smith1997regional" class="csl-entry" role="listitem">
R. A. Smith, G. E. Schwarz and R. B. Alexander. Regional interpretation of water-quality monitoring data. <em>Water resources research</em>, 33(12): 2781–2798, 1997. URL <a href="https://doi.org/10.1029/97WR02171">https://doi.org/10.1029/97WR02171</a>.
</div>
<div id="ref-strahler1957quantitative" class="csl-entry" role="listitem">
A. N. Strahler. Quantitative analysis of watershed geomorphology. <em>Eos, Transactions American Geophysical Union</em>, 38(6): 913–920, 1957. URL <a href="https://doi.org/10.1029/TR038i006p00913">https://doi.org/10.1029/TR038i006p00913</a>.
</div>
<div id="ref-vigiak2023recent" class="csl-entry" role="listitem">
O. Vigiak, A. Udías, B. Grizzetti, M. Zanni, A. Aloe, F. Weiss, J. Hristov, B. Bisselink, A. de Roo and A. Pistocchi. Recent regional changes in nutrient fluxes of european surface waters. <em>Science of The Total Environment</em>, 858: 160063, 2023. URL <a href="https://data.jrc.ec.europa.eu/collection/wpi">https://data.jrc.ec.europa.eu/collection/wpi</a>.
</div>
<div id="ref-westerberg2011calibration" class="csl-entry" role="listitem">
I. Westerberg, J.-L. Guerrero, P. Younger, K. Beven, J. Seibert, S. Halldin, J. Freer and C.-Y. Xu. Calibration of hydrological models using flow-duration curves. <em>Hydrology and Earth System Sciences</em>, 15(7): 2205–2227, 2011. URL <a href="https://doi.org/10.5194/hess-15-2205-2011">https://doi.org/10.5194/hess-15-2205-2011</a>.
</div>
<div id="ref-wohling2013evaluating" class="csl-entry" role="listitem">
T. Wöhling, L. Samaniego and R. Kumar. Evaluating multiple performance criteria to calibrate the distributed hydrological model of the upper neckar catchment. <em>Environmental earth sciences</em>, 69(2): 453–468, 2013. URL <a href="https://10.1007/s12665-013-2306-2">10.1007/s12665-013-2306-2</a>.
</div>
<div id="ref-yapo1996automatic" class="csl-entry" role="listitem">
P. O. Yapo, H. V. Gupta and S. Sorooshian. Automatic calibration of conceptual rainfall-runoff models: Sensitivity to calibration data. <em>Journal of hydrology</em>, 181(1-4): 23–48, 1996. URL <a href="https://www.sciencedirect.com/science/article/pii/0022169495029184">https://www.sciencedirect.com/science/article/pii/0022169495029184</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Udías, et al., "The R Journal: GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters", The R Journal, 2023</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-065,
  author = {Udías, Angel and Grizzetti, Bruna and Vigiak, Olga and Aloe, Alberto and Alfaro, Cesar and Gomez, Javier},
  title = {The R Journal: GREENeR: An R Package to Estimate and Visualize Nutrients Pressures on Surface Waters},
  journal = {The R Journal},
  year = {2023},
  note = {https://doi.org/10.32614/RJ-2023-065},
  doi = {10.32614/RJ-2023-065},
  volume = {15},
  issue = {3},
  issn = {2073-4859},
  pages = {119-137}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
