<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Rfssa: An R Package for Functional Singular Spectrum Analysis</title>

<meta property="description" itemprop="description" content="Functional Singular Spectrum Analysis (FSSA) is a non-parametric&#10;approach for analyzing Functional Time Series (FTS) and Multivariate&#10;FTS (MFTS) data. This paper introduces Rfssa, an R package that&#10;addresses implementing FSSA for FTS and MFTS data types. Rfssa&#10;provides a flexible container, the funts class, for FTS/MFTS data&#10;observed on one-dimensional or multi-dimensional domains. It accepts&#10;arbitrary basis systems and offers powerful graphical tools for&#10;visualizing time-varying features and pattern changes. The package&#10;incorporates two forecasting algorithms for FTS data. Developed using&#10;object-oriented programming and Rcpp/RcppArmadillo, Rfssa ensures&#10;computational efficiency. The paper covers theoretical background,&#10;technical details, usage examples, and highlights potential&#10;applications of Rfssa."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2024-019/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-03-11"/>
<meta property="article:created" itemprop="dateCreated" content="2025-03-11"/>
<meta name="article:author" content="Hossein Haghbin"/>
<meta name="article:author" content="Jordan Trinka"/>
<meta name="article:author" content="Mehdi Maadooliat"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Rfssa: An R Package for Functional Singular Spectrum Analysis"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Functional Singular Spectrum Analysis (FSSA) is a non-parametric&#10;approach for analyzing Functional Time Series (FTS) and Multivariate&#10;FTS (MFTS) data. This paper introduces Rfssa, an R package that&#10;addresses implementing FSSA for FTS and MFTS data types. Rfssa&#10;provides a flexible container, the funts class, for FTS/MFTS data&#10;observed on one-dimensional or multi-dimensional domains. It accepts&#10;arbitrary basis systems and offers powerful graphical tools for&#10;visualizing time-varying features and pattern changes. The package&#10;incorporates two forecasting algorithms for FTS data. Developed using&#10;object-oriented programming and Rcpp/RcppArmadillo, Rfssa ensures&#10;computational efficiency. The paper covers theoretical background,&#10;technical details, usage examples, and highlights potential&#10;applications of Rfssa."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2024-019/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2024-019/figures/call_3.png"/>
<meta property="og:image:width" content="1322"/>
<meta property="og:image:height" content="947"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Rfssa: An R Package for Functional Singular Spectrum Analysis"/>
<meta property="twitter:description" content="Functional Singular Spectrum Analysis (FSSA) is a non-parametric&#10;approach for analyzing Functional Time Series (FTS) and Multivariate&#10;FTS (MFTS) data. This paper introduces Rfssa, an R package that&#10;addresses implementing FSSA for FTS and MFTS data types. Rfssa&#10;provides a flexible container, the funts class, for FTS/MFTS data&#10;observed on one-dimensional or multi-dimensional domains. It accepts&#10;arbitrary basis systems and offers powerful graphical tools for&#10;visualizing time-varying features and pattern changes. The package&#10;incorporates two forecasting algorithms for FTS data. Developed using&#10;object-oriented programming and Rcpp/RcppArmadillo, Rfssa ensures&#10;computational efficiency. The paper covers theoretical background,&#10;technical details, usage examples, and highlights potential&#10;applications of Rfssa."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2024-019/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2024-019/figures/call_3.png"/>
<meta property="twitter:image:width" content="1322"/>
<meta property="twitter:image:height" content="947"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Rfssa: An R Package for Functional Singular Spectrum Analysis"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2024-019"/>
<meta name="citation_pdf_url" content="RJ-2024-019.pdf"/>
<meta name="citation_volume" content="16"/>
<meta name="citation_issue" content="2"/>
<meta name="citation_doi" content="10.32614/RJ-2024-019"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="82"/>
<meta name="citation_lastpage" content="98"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/03/11"/>
<meta name="citation_publication_date" content="2025/03/11"/>
<meta name="citation_author" content="Hossein Haghbin"/>
<meta name="citation_author_institution" content="Artificial Intelligence and Data Mining Research Group, ICT Research&#10;Institute"/>
<meta name="citation_author" content="Jordan Trinka"/>
<meta name="citation_author_institution" content="Department of Mathematical and Statistical Sciences, Marquette&#10;University,"/>
<meta name="citation_author" content="Mehdi Maadooliat"/>
<meta name="citation_author_institution" content="Department of Mathematical and Statistical Sciences, Marquette&#10;University,"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Functional Data Analysis;citation_publisher=New York, NY;citation_author=J. O. Ramsay;citation_author=B. W. Silverman"/>
  <meta name="citation_reference" content="citation_title=fda: Functional Data Analysis;citation_author=J. O. Ramsay;citation_author=Hadley Wickham;citation_author=Spencer Graves;citation_author=Giles Hooker"/>
  <meta name="citation_reference" content="citation_title=Fdapace: Functional data analysis and empirical dynamics;citation_author=Alvaro Gajardo;citation_author=Satarupa Bhattacharjee;citation_author=Cody Carroll;citation_author=Yaqing Chen;citation_author=Xiongtao Dai;citation_author=Jianing Fan;citation_author=Pantelis Z. Hadjipantelis;citation_author=Kyunghee Han;citation_author=Hao Ji;citation_author=Changbo Zhu;citation_author=Hans-Georg Müller;citation_author=Jane-Ling Wang"/>
  <meta name="citation_reference" content="citation_title=Object-oriented software for functional data;citation_volume=93;citation_doi=10.18637/jss.v093.i05;citation_author=Clara Happ-Kurz"/>
  <meta name="citation_reference" content="citation_title=Rainbow: Rainbow plots, bagplots and boxplots for functional data;citation_author=Han Lin Shang;citation_author=Rob Hyndman"/>
  <meta name="citation_reference" content="citation_title=funFEM: Clustering in the discriminative functional subspace;citation_author=Charles Bouveyron"/>
  <meta name="citation_reference" content="citation_title=Refund: Regression with functional data;citation_author=Jeff Goldsmith;citation_author=Fabian Scheipl;citation_author=Lei Huang;citation_author=Julia Wrobel;citation_author=Chongzhi Di;citation_author=Jonathan Gellar;citation_author=Jaroslaw Harezlak;citation_author=Mathew W. McLean;citation_author=Bruce Swihart;citation_author=Luo Xiao;citation_author=Ciprian Crainiceanu;citation_author=Philip T. Reiss;citation_author=Yakuan Chen;citation_author=Sonja Greven;citation_author=Lan Huo;citation_author=Madan Gopal Kundu;citation_author=So Young Park;citation_author=David L. Miller;citation_author=Ana-Maria Staicu;citation_author=Erjia Cui;citation_author=Ruonan Li"/>
  <meta name="citation_reference" content="citation_title=Statistical computing in functional data analysis: The r package ;citation_volume=51;citation_doi=10.18637/jss.v051.i04;citation_author=Manuel Febrero-Bandle;citation_author=Manuel Oviedo Fuente"/>
  <meta name="citation_reference" content="citation_title=ftsa: Functional Time Series Analysis;citation_author=Rob Hyndman;citation_author=Han Lin Shang"/>
  <meta name="citation_reference" content="citation_title=ftsspec: Spectral Density Estimation and Comparison for Functional Time Series;citation_author=Shahin Tavakoli"/>
  <meta name="citation_reference" content="citation_title=Analysis of Time Series Structure: SSA and Related Techniques;citation_publisher=Chapman; Hall/CRC, Boca Raton, FL;citation_author=Nina Golyandina;citation_author=Vladimir Nekrutkin;citation_author=Anatoly A Zhigljavsky"/>
  <meta name="citation_reference" content="citation_title=Singular Spectrum Analysis for Time Series;citation_publisher=Springer Science &amp; Business Media, Berlin, Heidelberg;citation_author=Nina Golyandina;citation_author=Anatoly Zhigljavsky"/>
  <meta name="citation_reference" content="citation_title=Singular spectrum analysis with r;citation_publisher=Springer Berlin Heidelberg;citation_author=Nina Golyandina;citation_author=Anton Korobeynikov;citation_author=Anatoly Zhigljavsky"/>
  <meta name="citation_reference" content="citation_title=ASSA: Applied singular spectrum analysis;citation_author=Miguel Carvalho;citation_author=Gabriel Martos"/>
  <meta name="citation_reference" content="citation_title=Real-time nowcasting the US output gap: Singular spectrum analysis at work;citation_publisher=Elsevier;citation_volume=33;citation_author=Miguel Carvalho;citation_author=António Rua"/>
  <meta name="citation_reference" content="citation_title=Multivariate and 2D extensions of the Rssa package;citation_volume=67;citation_doi=10.18637/jss.v067.i02;citation_author=Nina Golyandina;citation_author=Anton Korobeynikov;citation_author=Alex Shlemov;citation_author=Konstantin Usevich"/>
  <meta name="citation_reference" content="citation_title=Functional time series forecasting: Functional singular spectrum analysis approaches;citation_volume=12;citation_doi=10.1002/sta4.621;citation_author=J. Trinka;citation_author=H. Haghbin;citation_author=H. L. Shang;citation_author=M. Maadooliat"/>
  <meta name="citation_reference" content="citation_title=Multivariate singular spectrum analysis: A general view and new vector forecasting approach;citation_volume=01;citation_doi=10.1142/S2335680413500051;citation_author=Hossein Hassani;citation_author=Rahim Mahmoudvand"/>
  <meta name="citation_reference" content="citation_title=Functional singular spectrum analysis;citation_doi=https://doi.org/10.1002/sta4.330;citation_author=Hossein Haghbin;citation_author=Seyed Morteza Najibi;citation_author=Rahim Mahmoudvand;citation_author=Jordan Trinka;citation_author=Mehdi Maadooliat"/>
  <meta name="citation_reference" content="citation_title=Rfssa: Functional singular spectrum analysis;citation_author=Hossein Haghbin;citation_author=Jordan Trinka;citation_author=Seyed Morteza Najibi;citation_author=Mehdi Maadooliat"/>
  <meta name="citation_reference" content="citation_title=Matrix analysis;citation_publisher=Cambridge University Press;citation_author=Roger A. Horn;citation_author=Charles R. Johnson"/>
  <meta name="citation_reference" content="citation_title=Integrating data transformation in principal components analysis;citation_publisher=Taylor &amp; Francis;citation_volume=24;citation_author=Mehdi Maadooliat;citation_author=Jianhua Z Huang;citation_author=Jianhua Hu"/>
  <meta name="citation_reference" content="citation_title=Multivariate functional singular spectrum analysis: A nonparametric approach for analyzing multivariate functional time series;citation_publisher=Springer;citation_author=Jordan Trinka;citation_author=Hossein Haghbin;citation_author=Mehdi Maadooliat"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","slug","citation_url","packages","preview","bibliography","CTV","legacy_pdf","legacy_converted","output","draft","pdf_url","doi","creative_commons","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Rfssa: An R Package for Functional Singular Spectrum Analysis"]},{"type":"character","attributes":{},"value":["Functional Singular Spectrum Analysis (FSSA) is a non-parametric\napproach for analyzing Functional Time Series (FTS) and Multivariate\nFTS (MFTS) data. This paper introduces Rfssa, an R package that\naddresses implementing FSSA for FTS and MFTS data types. Rfssa\nprovides a flexible container, the funts class, for FTS/MFTS data\nobserved on one-dimensional or multi-dimensional domains. It accepts\narbitrary basis systems and offers powerful graphical tools for\nvisualizing time-varying features and pattern changes. The package\nincorporates two forecasting algorithms for FTS data. Developed using\nobject-oriented programming and Rcpp/RcppArmadillo, Rfssa ensures\ncomputational efficiency. The paper covers theoretical background,\ntechnical details, usage examples, and highlights potential\napplications of Rfssa."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Hossein Haghbin"]},{"type":"character","attributes":{},"value":["Artificial Intelligence and Data Mining Research Group, ICT Research\nInstitute"]},{"type":"character","attributes":{},"value":["Faculty of Intelligent Systems Engineering and Data Science, Persian\nGulf University","Boushehr, Iran","(ORCiD 0000-0001-8416-2354)","[haghbin@pgu.ac.ir](haghbin@pgu.ac.ir){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Jordan Trinka"]},{"type":"character","attributes":{},"value":["Department of Mathematical and Statistical Sciences, Marquette\nUniversity,"]},{"type":"character","attributes":{},"value":["Wisconsin, USA","(ORCiD 0000-0001-9118-5781)","[jordantrinka4@hotmail.com](jordantrinka4@hotmail.com){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Mehdi Maadooliat"]},{"type":"character","attributes":{},"value":["Department of Mathematical and Statistical Sciences, Marquette\nUniversity,"]},{"type":"character","attributes":{},"value":["Wisconsin, USA","(ORCiD: 0000-0002-5408-2676)","[mehdi.maadooliat@mu.edu](mehdi.maadooliat@mu.edu){.uri}\n"]}]}]},{"type":"character","attributes":{},"value":["2025-03-11"]},{"type":"character","attributes":{},"value":["2023-07-02"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[82]},{"type":"integer","attributes":{},"value":[98]}]},{"type":"integer","attributes":{},"value":[16]},{"type":"integer","attributes":{},"value":[2]},{"type":"character","attributes":{},"value":["RJ-2024-019"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2024-019"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["fda","funFEM","fda.usc","refund","fdapace","funData","ftsspec","rainbow","ftsa","fdasrvf","roahd","Rfssa","Rcpp","RcppArmadillo","Rssa","ASSA"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["Haghbin_Rfssa.bib"]},{"type":"character","attributes":{},"value":["Cluster","FunctionalData","HighPerformanceComputing","NumericalMathematics","TimeSeries"]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","mathjax","md_extension"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"]},{"type":"character","attributes":{},"value":["-tex_math_single_backslash"]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["RJ-2024-019.pdf"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2024-019"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.4/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2024-019/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["code/Haghbin.R","data/Austin.rds","data/Callcenter.rds","data/Jambi.rds","data/Montana.rds","data/Mortality.rds","data/Utqiagvik.rds","figures/3Dline.png","figures/3Dsurface.png","figures/call_1.png","figures/call_2.png","figures/call_3.png","figures/call_4.png","figures/call_5.png","figures/call_6.png","figures/call_7.png","figures/call_8.png","figures/call_fc.pdf","figures/call_fc.png","figures/call.pdf","figures/fssa_call_1.png","figures/fssa_call_2.png","figures/fssa_call_3.png","figures/fssa_call_4.png","figures/fssa_call_5.png","figures/fssa_call_6.png","figures/fssa_call.pdf","figures/fts.pdf","figures/fts.png","figures/ndvi.pdf","figures/ndvi.png","figures/Rfore.pdf","figures/Rfore.png","figures/roadmap.pdf","figures/roadmap.png","figures/shiny.png","figures/Vfore.pdf","figures/Vfore.png","Haghbin_Rfssa.bib","Haghbin_Rfssa.tex","img/3Dline.png","img/3Dsurface.png","img/call_fc.pdf","img/call.pdf","img/fssa_call.pdf","img/fts.pdf","img/ndvi.pdf","img/Rfore.pdf","img/roadmap.pdf","img/Vfore.pdf","RJ-2024-019.zip","RJournal.sty","RJwrapper.aux","RJwrapper.log","RJwrapper.out","RJwrapper.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.29/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Rfssa: An R Package for Functional Singular Spectrum Analysis","description":"Functional Singular Spectrum Analysis (FSSA) is a non-parametric\napproach for analyzing Functional Time Series (FTS) and Multivariate\nFTS (MFTS) data. This paper introduces Rfssa, an R package that\naddresses implementing FSSA for FTS and MFTS data types. Rfssa\nprovides a flexible container, the funts class, for FTS/MFTS data\nobserved on one-dimensional or multi-dimensional domains. It accepts\narbitrary basis systems and offers powerful graphical tools for\nvisualizing time-varying features and pattern changes. The package\nincorporates two forecasting algorithms for FTS data. Developed using\nobject-oriented programming and Rcpp/RcppArmadillo, Rfssa ensures\ncomputational efficiency. The paper covers theoretical background,\ntechnical details, usage examples, and highlights potential\napplications of Rfssa.","doi":"10.32614/RJ-2024-019","authors":[{"author":"Hossein Haghbin","authorURL":"#","affiliation":"Artificial Intelligence and Data Mining Research Group, ICT Research\nInstitute","affiliationURL":"#","orcidID":""},{"author":"Jordan Trinka","authorURL":"#","affiliation":"Department of Mathematical and Statistical Sciences, Marquette\nUniversity,","affiliationURL":"#","orcidID":""},{"author":"Mehdi Maadooliat","authorURL":"#","affiliation":"Department of Mathematical and Statistical Sciences, Marquette\nUniversity,","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-03-11T00:00:00.000+00:00","citationText":"Haghbin, et al., 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-1">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Rfssa: An R Package for Functional Singular Spectrum Analysis</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Functional Singular Spectrum Analysis (FSSA) is a non-parametric
approach for analyzing Functional Time Series (FTS) and Multivariate
FTS (MFTS) data. This paper introduces Rfssa, an R package that
addresses implementing FSSA for FTS and MFTS data types. Rfssa
provides a flexible container, the funts class, for FTS/MFTS data
observed on one-dimensional or multi-dimensional domains. It accepts
arbitrary basis systems and offers powerful graphical tools for
visualizing time-varying features and pattern changes. The package
incorporates two forecasting algorithms for FTS data. Developed using
object-oriented programming and Rcpp/RcppArmadillo, Rfssa ensures
computational efficiency. The paper covers theoretical background,
technical details, usage examples, and highlights potential
applications of Rfssa.</p></p>
</div>

<div class="d-byline">
  Hossein Haghbin  (Artificial Intelligence and Data Mining Research Group, ICT Research
Institute)
  
,   Jordan Trinka  (Department of Mathematical and Statistical Sciences, Marquette
University,)
  
,   Mehdi Maadooliat  (Department of Mathematical and Statistical Sciences, Marquette
University,)
  
<br/>2025-03-11
</div>

<div class="d-article">
<div class="article">
<h3 data-number="1" id="sec:introduction"><span class="header-section-number">1</span> Introduction</h3>
<p>In recent times, advancements in data acquisition techniques have made
it possible to collect data in high-resolution formats. Due to the
presence of temporal-spatial dependence, one may consider this type of
data as <em>functional data</em>.</p>
<p>Functional Data Analysis (FDA) focuses on developing statistical
methodologies for analyzing data represented as functions or curves.
While FDA methods are particularly well-suited for handling smooth
continuum data, they can also be adapted and extended to effectively
analyze functional data that may not exhibit perfect smoothness,
including high-resolution data and data with inherent variability.</p>
<p>The widely-used <span class="sans-serif">R</span> package for FDA is
<a href="https://CRAN.R-project.org/package=fda"><strong>fda</strong></a> <span class="citation" data-cites="fdapackage">(<a href="#ref-fdapackage" role="doc-biblioref">Ramsay et al. 2023</a>)</span>, which
is designed to support analysis of functional data, as described in the
textbook by <span class="citation" data-cites="ramsay2005">(<a href="#ref-ramsay2005" role="doc-biblioref">Ramsay and Silverman 2005</a>)</span>. Additionally, there are over 40 other
<span class="sans-serif">R</span> packages available on CRAN that incorporate functional
data analysis, such as
<a href="https://CRAN.R-project.org/package=funFEM"><strong>funFEM</strong></a>
<span class="citation" data-cites="funFEMpackage">(<a href="#ref-funFEMpackage" role="doc-biblioref">Bouveyron 2021</a>)</span>,
<a href="https://CRAN.R-project.org/package=fda.usc"><strong>fda.usc</strong></a>
<span class="citation" data-cites="fdauscpackage">(<a href="#ref-fdauscpackage" role="doc-biblioref">Febrero-Bandle and Fuente 2012</a>)</span>,
<a href="https://CRAN.R-project.org/package=refund"><strong>refund</strong></a>
<span class="citation" data-cites="refundpackage">(<a href="#ref-refundpackage" role="doc-biblioref">Goldsmith et al. 2023</a>)</span>,
<a href="https://CRAN.R-project.org/package=fdapace"><strong>fdapace</strong></a>
<span class="citation" data-cites="fdapacepackage">(<a href="#ref-fdapacepackage" role="doc-biblioref">Gajardo et al. 2022</a>)</span>,
<a href="https://CRAN.R-project.org/package=funData"><strong>funData</strong></a>
<span class="citation" data-cites="funDatapackage">(<a href="#ref-funDatapackage" role="doc-biblioref">Happ-Kurz 2020</a>)</span>,
<a href="https://CRAN.R-project.org/package=ftsspec"><strong>ftsspec</strong></a>
<span class="citation" data-cites="ftsspecpackage">(<a href="#ref-ftsspecpackage" role="doc-biblioref">Tavakoli 2015</a>)</span>,
<a href="https://CRAN.R-project.org/package=rainbow"><strong>rainbow</strong></a>
<span class="citation" data-cites="rainbowpackage">(<a href="#ref-rainbowpackage" role="doc-biblioref">Shang and Hyndman 2022</a>)</span>, and
<a href="https://CRAN.R-project.org/package=ftsa"><strong>ftsa</strong></a> <span class="citation" data-cites="ftsapackage">(<a href="#ref-ftsapackage" role="doc-biblioref">Hyndman and Shang 2023</a>)</span>.</p>
<p>One crucial initial requirement for any of these packages is to
establish a framework for representing and storing infinite-dimensional
functional observations. The
<a href="https://CRAN.R-project.org/package=fda"><strong>fda</strong></a> package, for instance,
employs the <code>fd</code> class as a container for functional data defined on a
one-dimensional (1D) domain. An <code>fd</code> object represents functional data
as a finite linear combination of known basis functions (e.g., Fourier,
B-splines, etc.), storing both the basis functions and their respective
coefficients for each curve. This representation aligns with the
practical implementation found in many papers within the field of FDA.
Conversely, several other <span class="sans-serif">R</span> packages store functional
data in a discrete form evaluated on grid points (e.g.,
<a href="https://CRAN.R-project.org/package=fda.usc"><strong>fda.usc</strong></a>,
<a href="https://CRAN.R-project.org/package=refund"><strong>refund</strong></a>,
<a href="https://CRAN.R-project.org/package=funData"><strong>funData</strong></a>,
<a href="https://CRAN.R-project.org/package=rainbow"><strong>rainbow</strong></a>, and
<a href="https://CRAN.R-project.org/package=fdapace"><strong>fdapace</strong></a>). These
packages also provide the capability to analyze functions beyond the
one-dimensional case, such as image data treated as two-dimensional (2D)
functions (e.g.,
<a href="https://CRAN.R-project.org/package=refund"><strong>refund</strong></a>,
<a href="https://CRAN.R-project.org/package=fdasrvf"><strong>fdasrvf</strong></a>, and
<a href="https://CRAN.R-project.org/package=funData"><strong>funData</strong></a>). To the best
of our knowledge, packages that support representation beyond 1D
functions utilize the grid point representation for execution and
storage.</p>
<p>Moreover, recent packages have been developed to handle multivariate
functional data, which consist of more than one function per observation
unit. Examples of such packages include
<a href="https://CRAN.R-project.org/package=roahd"><strong>roahd</strong></a>,
<a href="https://CRAN.R-project.org/package=fda.usc"><strong>fda.usc</strong></a>, and
<a href="https://CRAN.R-project.org/package=funData"><strong>funData</strong></a>.</p>
<p>While some recent FDA packages have focused on analyzing and
implementing techniques for Functional Time Series (FTS), where
sequences of functions are observed over time, none of them handle
Multivariate FTS (MFTS) or multidimensional MFTS. For example, see the
packages <a href="https://CRAN.R-project.org/package=ftsspec"><strong>ftsspec</strong></a>,
<a href="https://CRAN.R-project.org/package=rainbow"><strong>rainbow</strong></a>, and
<a href="https://CRAN.R-project.org/package=ftsa"><strong>ftsa</strong></a>. In summary, there
is still a need for a unified and flexible container for FTS/MFTS data,
defined on either one or multidimensional domains. The <code>funts</code> class in
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> <span class="citation" data-cites="rfssapackage">(<a href="#ref-rfssapackage" role="doc-biblioref">Haghbin et al. 2023</a>)</span>,
the package discussed in this article, aims to address this gap. One of
the primary contributions of the package is its capacity to handle and
visualize 2-dimensional FTS, including image data. Furthermore, the
package accommodates MFTS, especially when observed on distinct domains.
This flexibility empowers users to analyze and visualize FTS with
multiple variables, even when they do not share the same domain.
Notably, the <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a>
package introduces novel visualization tools (as exemplified in Figure
@ref(fig:call_center)). These tools include heatmaps and 3D plots,
thoughtfully designed to provide a deeper understanding of functional
patterns over time. They enhance the ability to discern trends and
variations that might remain inconspicuous in conventional plots. An
additional feature of the <code>funts</code> class is its ability to accept any
arbitrary basis system as input for the class constructor, including FDA
basis functions or even empirical basis represented as matrices
evaluated at grid points. The classes in the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package are
developed using the S3 object-oriented programming system, and for
computational efficiency, significant portions of the package are
implemented using the
<a href="https://CRAN.R-project.org/package=Rcpp"><strong>Rcpp</strong></a>/<a href="https://CRAN.R-project.org/package=RcppArmadillo"><strong>RcppArmadillo</strong></a>
packages. Notably, the package includes a shiny web application that
provides a user-friendly GUI for implementing Functional Singular
Spectrum Analysis (FSSA) on real or simulated FTS/MFTS data.</p>
<p>The <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package was
initially developed to implement FSSA for FTS, as discussed in the work
of <span class="citation" data-cites="haghbin2021">(<a href="#ref-haghbin2021" role="doc-biblioref">Haghbin et al. 2021</a>)</span>. FSSA extends Singular Spectrum Analysis (SSA), a
model-free procedure commonly used to analyze time series data. The
primary goal of SSA is to decompose the original series into a
collection of interpretable components, such as slowly varying trends,
oscillatory patterns, and structureless noise. Notably, SSA does not
rely on restrictive assumptions like stationarity, linearity, or
normality <span class="citation" data-cites="golyandina2013">(<a href="#ref-golyandina2013" role="doc-biblioref">Golyandina and Zhigljavsky 2013</a>)</span>.</p>
<p>It’s worth noting that SSA finds applications beyond the functional
framework, including smoothing and forecasting purposes
<span class="citation" data-cites="hassani2013 deCarvalho2017realtime">(<a href="#ref-hassani2013" role="doc-biblioref">Hassani and Mahmoudvand 2013</a>; <a href="#ref-deCarvalho2017realtime" role="doc-biblioref">Carvalho and Rua 2017</a>)</span>. The non-functional version of
FSSA, known as SSA, has previously been implemented in the
<a href="https://CRAN.R-project.org/package=Rssa"><strong>Rssa</strong></a> package
<span class="citation" data-cites="rssapackage">(<a href="#ref-rssapackage" role="doc-biblioref">Golyandina et al. 2015</a>)</span> and the
<a href="https://CRAN.R-project.org/package=ASSA"><strong>ASSA</strong></a> package
<span class="citation" data-cites="ASSApackage">(<a href="#ref-ASSApackage" role="doc-biblioref">Carvalho and Martos 2020</a>)</span>.</p>
<p>The <a href="https://CRAN.R-project.org/package=Rssa"><strong>Rssa</strong></a> package provides
various visualization tools to facilitate the grouping stage, and the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package includes
equivalent functional versions of those tools <span class="citation" data-cites="golyandina2018singular">(<a href="#ref-golyandina2018singular" role="doc-biblioref">Golyandina et al. 2018</a>)</span>.
While the foundational theory of FSSA was originally designed for
univariate FTS, it has since been extended to handle multidimensional
FTS data, referred to as Multivariate FSSA (MFSSA)
<span class="citation" data-cites="trinka2022multivariate">(<a href="#ref-trinka2022multivariate" role="doc-biblioref">Trinka et al. 2022</a>)</span>. Furthermore, in line with the developments in
SSA for forecasting, two distinct algorithms known as Recurrent
Forecasting (FSSA R-forecasting) and Vector Forecasting (FSSA
V-forecasting) were introduced for FSSA by <span class="citation" data-cites="trinka2023functional">(<a href="#ref-trinka2023functional" role="doc-biblioref">Trinka et al. 2023</a>)</span>. Both
of these forecasting algorithms, along with the capabilities for
handling MFSSA, have been seamlessly integrated into the most recent
version of the <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a>
package.</p>
<p>The remainder of this manuscript is organized as follows. Section 2
introduces the FTS/MFTS data preparation theory used in the <code>funts</code>
class. Section 3 discusses the FSSA methodology, including the basic
schema of FSSA, FSSA R-forecasting, and FSSA V-forecasting. Technical
details of the <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a>
package are provided in Section 4, where we describe the available
classes in the package and illustrate their practical usage with
examples of real data. Section 5 focuses on the reconstruction stage and
FSSA/MFSSA forecasting. In Section 6, we provide a summary of the
embedded shiny app. Finally, we conclude the paper in Section 7.</p>
<h3 data-number="2" id="sec:preparation"><span class="header-section-number">2</span> Data preparation in FTS</h3>
<p>Define <span class="math inline">\(\textbf{y}_N=(y_1,\ldots,y_N)\)</span> to be a collection of
observations from an FTS. In the theory of FTS, <span class="math inline">\(y_i\)</span>’s are considered
as functions in the space <span class="math inline">\(\mathbb{H}=L^2(\mathcal{T})\)</span> where
<span class="math inline">\(\mathcal{T}\)</span> is a compact subset of <span class="math inline">\(\mathbb{R}.\)</span> Let <span class="math inline">\(s\in\mathcal{T}\)</span>
and consider <span class="math inline">\(y_i(s)\in\mathbb{R}^p\)</span>, the sequence of <span class="math inline">\(\textbf{y}_N\)</span> is
called (univariate) FTS if <span class="math inline">\(p=1\)</span>, and multivariate FTS (or MFTS) if
<span class="math inline">\(p&gt;1.\)</span></p>
<p>In the realm of functional data analysis, we operate under the
assumption that the underlying sample functions, denoted as
<span class="math inline">\(y_{i}(\cdot)\)</span>, exhibit smoothness for each sample <span class="math inline">\(i\)</span>, where
<span class="math inline">\(i=1, \ldots, N\)</span>. Nevertheless, in practical scenarios, observations are
typically acquired discretely at a set of grid points and are
susceptible to contamination by random noise. This phenomenon can be
represented as follows:</p>
<p><span class="math display" id="eq:discr-data">\[
    Y_{i,k} = y_{i}(t_k) +\varepsilon_{i,k}, \quad k=1,\ldots, K.   \tag{1}
\]</span></p>
<p>In this expression, <span class="math inline">\(t_k\in\mathcal{T}\)</span>, and <span class="math inline">\(K\)</span> denotes the count of
discrete grid points across all samples. The <span class="math inline">\(\varepsilon_{i,k}\)</span> terms
represent i.i.d. random noise.</p>
<p>To preprocess the raw data, it is customary to employ smoothing
techniques, converting the discrete observations <span class="math inline">\(Y_{i,k}\)</span> into a
continuous form, <span class="math inline">\(y_{i}(\cdot)\)</span>. This is typically performed
individually for each variable and sample. One widely used approach is
finite basis function expansion <span class="citation" data-cites="ramsay2005">(<a href="#ref-ramsay2005" role="doc-biblioref">Ramsay and Silverman 2005</a>)</span>. In this method, a set of
basis functions <span class="math inline">\(\left\lbrace \nu_i \right\rbrace_{ i\in\mathbb{N}}\)</span> is
considered (not necessarily orthogonal) for the function space
<span class="math inline">\(\mathbb{H}\)</span>. Each sample function <span class="math inline">\(y_{i}(\cdot)\)</span> in
<a href="#eq:discr-data">(1)</a> is then considered as a finite linear combination
of the first <span class="math inline">\(d\)</span> basis functions:</p>
<p><span class="math display" id="eq:basis-expan">\[
    y_i(s)= \sum_{j=1}^d c_{ij}\nu_j(s).   \tag{2}
\]</span></p>
<p>Subsequently, the coefficients <span class="math inline">\(c_{ij}\)</span> can be estimated using least
square techniques. By adopting the linear representation form for the
functional data in <a href="#eq:basis-expan">(2)</a>, we establish a correspondence
between each function <span class="math inline">\(y_i(\cdot)\)</span> and its coefficient vector
<span class="math inline">\({\pmb c}_i=(c_{ij})_{j=1}^d.\)</span> As a result, the coefficient vectors
<span class="math inline">\({\pmb c}_i\)</span> can serve to store and retrieve the original functions,
<span class="math inline">\(y_i(\cdot)\)</span>’s. This arises from the inherent isomorphism between two
finite vector spaces of the same dimension (in this case, <span class="math inline">\(d\)</span>).
Consequently, <span class="math inline">\({\pmb c}_i\)</span>’s are stored as the primary attribute of
<code>funts</code> objects within the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package.</p>
<p>Take two elements <span class="math inline">\(x, y\in \mathbb{H}\)</span> with corresponding coefficient
vectors <span class="math inline">\({\pmb c}_x\)</span> and <span class="math inline">\({\pmb c}_y.\)</span> Then, the inner product of <span class="math inline">\(x, y\)</span>
can be computed in matrix form as
<span class="math inline">\(\langle x,y \rangle={\pmb c}_x^\top \mathbf{G} {\pmb c}_y\)</span>, where
<span class="math inline">\(\mathbf{G}=[ \langle \nu_i,\nu_j \rangle ]_{i,j=1}^{d}\)</span> is the Gram
matrix.</p>
<p>It is important to note that <span class="math inline">\(\mathbf{G}\)</span> is Hermitian. Furthermore,
because the basis functions <span class="math inline">\(\{\nu_i\}_{i=1}^d\)</span> are linearly
independent, <span class="math inline">\(\mathbf{G}\)</span> is positive definite, making it invertible
<span class="citation" data-cites="horn2012matrix">(<a href="#ref-horn2012matrix" role="doc-biblioref">Horn and Johnson 2012</a> Thm. 7.2.10)</span>.</p>
<p>Moreover, let <span class="math inline">\(A:\mathbb{H}\rightarrow \mathbb{H}\)</span> be a linear operator
and <span class="math inline">\(y=A(x).\)</span> Then, <span class="math inline">\({\pmb c}_y= \mathbf{G}^{-1}\mathbf{A}{\pmb c}_x,\)</span>
where <span class="math inline">\(\mathbf{A}=[ \langle A(\nu_j),\nu_i \rangle ]_{i,j=1}^{d}\)</span> is
called the corresponding matrix of the operator <span class="math inline">\(A.\)</span></p>
<p>It is worth noting that while the FSSA theory extends to arbitrary
dimensions, practical implementation for dimensions greater than <span class="math inline">\(2\)</span>
introduces considerable computational complexity. Moreover,
high-dimensional FTS data are relatively rare in real-world
applications. Therefore, within the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package, we have
chosen to confine the <code>funts</code> object to support functions observed over
domains that are one or two-dimensional. In the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package, the task
of preprocessing the raw discrete observations and converting those to
the <code>funts</code> object is assigned to the <code>funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> constructor.</p>
<h3 data-number="3" id="sec:methodology"><span class="header-section-number">3</span> An overview of the FSSA methodology</h3>
<p>FSSA is a nonparametric technique to decompose FTS and MFTS, and the
methodology can also be used to forecast such data
<span class="citation" data-cites="haghbin2021 trinka2022multivariate trinka2023functional">(<a href="#ref-haghbin2021" role="doc-biblioref">Haghbin et al. 2021</a>; <a href="#ref-trinka2022multivariate" role="doc-biblioref">Trinka et al. 2022</a>; <a href="#ref-trinka2023functional" role="doc-biblioref">Trinka et al. 2023</a>)</span>; it can
also be used as a visualization tool to illustrate the concept of
seasonality and periodicity in the functional space over time.</p>
<h4 class="unnumbered" data-number="3.1" id="basic-schema-of-fssa">Basic schema of FSSA</h4>
<p>Basic FSSA consists of two stages where each stage includes two steps.
We outline the four steps of the FSSA algorithm here.</p>
<ul>
<li><p><strong>First stage: decomposition</strong></p>
<ul>
<li><p><em>Embedding</em><br />
For a positive integer, <span class="math inline">\(L&lt;N/2\)</span>, let <span class="math inline">\(\mathbb{H}^L\)</span> be the
Cartesian product of <span class="math inline">\(L\)</span> copies of <span class="math inline">\(\mathbb{H}\)</span> and define the
<em>trajectory</em> operator
<span class="math inline">\(\mathbfcal{X}:\mathbb{R}^{K} \rightarrow \mathbb{H}^{L}\)</span> with
<span class="math display" id="eq:trajectory">\[\label{trajectory}
        \mathbfcal{X}{\pmb a}:=\sum_{j=1}^K a_j{\pmb x}_j,\qquad
        \ {\pmb a}=\left(a_1,\ldots, a_K\right)^\top \in\mathbb{R}^K.   \tag{3}\]</span></p>
<p>where <span class="math inline">\(K=N-L+1\)</span> and
<span class="math display" id="eq:flvec">\[\label{flvec}
        {\pmb x}_j(s):= \left( y_j(s), y_{j+1}(s), \ldots, y_{j+L-1}(s)\right)^\top,\ j=1,\ldots, K,   \tag{4}\]</span>
are called <em>lag-vectors</em>. One may consider the trajectory
operator <span class="math inline">\(\mathbfcal{X}\)</span> in <a href="#eq:trajectory">(3)</a> as an
<span class="math inline">\(L \times K\)</span> matrix with functional entries in the form of
<span class="math display" id="eq:eqnhankelmat">\[\label{eqn:hankelmat}
        \mathbfcal{X}(s) = \begin{bmatrix}y_{1}(s) &amp; y_{2}(s) &amp; y_{3}(s) &amp; \cdots &amp; y_{K}(s) \\ y_{2}(s) &amp; y_{3}(s) &amp; y_{4}(s) &amp; \cdots &amp; y_{K+1}(s) \\ y_{3}(s) &amp; y_{4}(s) &amp; y_{5}(s) &amp; \cdots &amp; y_{K+2}(s) \\ \vdots  &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ y_{L}(s) &amp; y_{L+1}(s) &amp; y_{L+2}(s) &amp; \cdots &amp; y_{N}(s)  \end{bmatrix}.   \tag{5}\]</span></p>
<p>Note that the antidiagonal elements of the matrix in
<a href="#eq:eqnhankelmat">(5)</a> are all equal. Such matrices are called
Hankel, and since <span class="math inline">\(\mathbfcal{X}(s)\)</span> is a Hankel matrix for any
<span class="math inline">\(s\)</span> in the domain, we call <span class="math inline">\(\mathbfcal{X}\)</span> a Hankel operator. In
practice, a main challenge is how to use the original basis of
<span class="math inline">\(\mathbb{H}\)</span> to represent the lag-vectors in <span class="math inline">\(\mathbb{H}^L\)</span>. To
do this, one may define a quotient sequence <span class="math inline">\(q_k\)</span>, and a
reminder sequence <span class="math inline">\(r_k\)</span>, by <span class="math inline">\(k=(q_k-1)L+r_k,\)</span> where
<span class="math inline">\(1\leq r_k\leq L\)</span>, and <span class="math inline">\(1\leq q_k\leq d\)</span>. Now, consider
<span class="math inline">\({\pmb \phi}_{k}\)</span> as a functional vector of length <span class="math inline">\(L\)</span> with all
zero functions, except <span class="math inline">\(r_k\)</span>-th element, which is <span class="math inline">\(\nu_{q_k}\)</span>.
Using this definition, the lag-vector <span class="math inline">\({\pmb{x}_j}\)</span> given in
<a href="#eq:flvec">(4)</a> can be represented as a linear combination of
<span class="math inline">\(\{{\pmb \phi}_{k}\}_{k=1}^{Ld}\)</span> with the corresponding
coefficient vector
<span class="math inline">\({\bf b}_j=(c_{1j},\ldots, c_{1,j+L-1},c_{2j},\ldots,c_{2,j+L-1},\ldots,c_{d,j+L-1} )^\top.\)</span></p></li>
<li><p><em>FSVD</em><br />
We apply the functional singular value decomposition (FSVD) to
<span class="math inline">\(\mathbfcal{X}\)</span> and obtain a collection of singular values,
<span class="math inline">\(\{\sqrt{\lambda_i}\}_{i=1}^{r}\)</span>, orthonormal right singular
vectors <span class="math inline">\(\{\mathbf{v}_{i}\}_{i=1}^{r}\)</span> (that are elements of
<span class="math inline">\(\mathbb{R}^{K}\)</span>), and orthonormal left singular functions
<span class="math inline">\(\{\pmb{\psi}_{i}\}_{i=1}^{r}\)</span> (that are elements of
<span class="math inline">\(\mathbb{H}^{L}\)</span>). The collection
<span class="math inline">\((\sqrt{\lambda_i}, \pmb{\psi}_i, \mathbf{v}_i)\)</span> will be called
the <span class="math inline">\(i^{th}\)</span> eigentriple of the FSVD, and <span class="math inline">\(r\)</span> is the rank of
<span class="math inline">\(\mathbfcal{X}\)</span>:
<span class="math display" id="eq:FSVD">\[\label{FSVD}
        \mathbfcal{X} = \sum_{i=1}^{r} \mathbfcal{X}_{i} = \sum_{i=1}^{r} \sqrt{\lambda_i} \mathbf{v}_{i} \otimes \pmb{\psi}_{i},   \tag{6}\]</span>
where
<span class="math inline">\(\mathbfcal{X}_{i}:\mathbb{R}^{K} \rightarrow \mathbb{H}^{L}\)</span> is
a rank one elementary operator. To implement the FSVD of
<span class="math inline">\(\mathbfcal{X}\)</span> given in <a href="#eq:FSVD">(6)</a>, let
<span class="math inline">\({\bf B}:=[{\bf b}_1,\cdots,{\bf b}_K]\)</span>,
<span class="math inline">\(\mathbf{G}:=[ \langle {\pmb \phi}_{i}, {\pmb \phi}_{j} \rangle_{\mathbb{H}^L}]_{i,j=1}^{Ld}\)</span>,
<span class="math inline">\(\mathbf{X}:=\mathbf{G}^{1/2}\mathbf{B}\)</span>, and
<span class="math inline">\(\left(\sqrt{\lambda_i}, \pmb{u}_i, \mathbf{v}_i\right)\)</span>’s be
the eigentriples of the SVD of the matrix <span class="math inline">\(\mathbf{X}\)</span>. It can
be shown that
<span class="math inline">\(\left(\sqrt{\lambda_i},\pmb{\psi}_i,\mathbf{v}_i \right)\)</span> is
the <span class="math inline">\(i^{th}\)</span> eigentriple of the FSVD of <span class="math inline">\(\mathbfcal{X}\)</span>, where
the left singular function, <span class="math inline">\({\pmb \psi}_i\)</span>, is corresponding to
the coefficient vector <span class="math inline">\(\mathbf{G}^{-1/2}{\pmb u}_i\)</span>. See
<span class="citation" data-cites="haghbin2021">(<a href="#ref-haghbin2021" role="doc-biblioref">Haghbin et al. 2021</a>)</span> for more details.</p></li>
</ul>
<p>These steps can also be extended to multivariate case, i.e. MFSSA.
See <span class="citation" data-cites="trinka2022multivariate">(<a href="#ref-trinka2022multivariate" role="doc-biblioref">Trinka et al. 2022</a>)</span> for more details. In the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package, the
results of the decomposition stage is held in an object from the
<code>fssa</code> class. The constructor, <code>fssa(</code><span class="math inline">\(\cdot\)</span><code>)</code>, performs the
decomposition for both FSSA and MFSSA algorithm and returns an
object of class <code>fssa</code>. Further discussion about the attributes and
methods of the <code>fssa</code> class is given in the technical details
section.</p></li>
<li><p><strong>Second stage: reconstruction</strong></p>
<ul>
<li><p><em>Grouping</em><br />
We partition the set of indices <span class="math inline">\(\{1,\dots,r\}\)</span> into disjoint
sets <span class="math inline">\(I_{q}\)</span>, where <span class="math inline">\(q \in \{1,\dots, m\}\)</span> and <span class="math inline">\(m\leq r\)</span>. From
here, we obtain the group <span class="math inline">\(\mathbfcal{X}_{I_{q}}\)</span> by combining
the respective elementary operators accordingly:
<span class="math display">\[\mathbfcal{X}_{I_{q}} = \sum_{i \in I_{q}} \mathbfcal{X}_{i}. \nonumber\]</span>
Exploratory plots of singular values, right singular vectors,
and left singular functions that investigate the different modes
of variation extracted in the decomposition stage are used to
decide how to form the sets, <span class="math inline">\(I_{q}\)</span>, and we discuss such plots
in further detail in section five.</p></li>
<li><p><em>Hankelization</em><br />
Since each <span class="math inline">\(\mathbfcal{X}_{I_{q}}\)</span> is not necessarily Hankel, we
perform diagonal averaging of the entries to Hankelize each
operator. From each Hankelized <span class="math inline">\(\mathbfcal{X}_{I_{q}}\)</span>, we
obtain an FTS, <span class="math inline">\(\mathbf{y}_{N}^{q}\)</span>, that describes main
characteristics of <span class="math inline">\(\mathbf{y}_{N}\)</span> such as mean, seasonal,
trend, and noise behaviors.</p></li>
</ul>
<p>For the reconstruction stage, the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package
provides the function <code>freconstruct(</code><span class="math inline">\(\cdot\)</span><code>)</code> which returns a list
of objects of class <code>funts</code> associated to the groups specified by
the user. If the supplied input to the <code>fssa(</code><span class="math inline">\(\cdot\)</span><code>)</code> function is
an MFTS, the signal extraction process is almost identical as
compared to the univariate case with the exception that now, we have
that each element of the time series is a tuple of functions
comprised of elements observed over one or two-dimensional domains.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figrecon-call"></span>
<img src="figures/call_3.png" alt="graphic without alt text" width="32900%" /><img src="figures/call_4.png" alt="graphic without alt text" width="32900%" /><img src="figures/call_5.png" alt="graphic without alt text" width="32900%" /><img src="figures/call_6.png" alt="graphic without alt text" width="32900%" /><img src="figures/call_7.png" alt="graphic without alt text" width="32900%" /><img src="figures/call_8.png" alt="graphic without alt text" width="32900%" />
<p class="caption">
Figure 1: (A): Line plot of Callcenter data; (B): FTS reconstructed using <span class="math inline">\(I_{\mathfrak{s}} = \{1,\cdots,7\}\)</span>; (C): FTS reconstructed by setting <span class="math inline">\(I_{1}=\{1\}\)</span>; (D): FTS reconstructed using <span class="math inline">\(I_{2} = \{2,3\}\)</span>; (E): FTS reconstructed from <span class="math inline">\(I_{3}=\{4,5\}\)</span>; (F): FTS reconstructed from <span class="math inline">\(I_{4}=\{6,7\}\)</span>.
</p>
</div>
</div>
<p>As a motivating example, consider the <code>Callcenter</code> dataset Figure
<a href="#fig:figrecon-call">1</a>(A), which has been previously discussed in
<span class="citation" data-cites="maadooliat2015integrating">(<a href="#ref-maadooliat2015integrating" role="doc-biblioref">Maadooliat et al. 2015</a>)</span> and is included in the package. This
dataset records the number of calls received by a call center in 1999.
Each functional observation corresponds to the square root of the daily
call count, and the entire FTS represents all the days in 1999. When
dealing with time series data exhibiting known periodic patterns, it is
a common practice in SSA to choose the window length, <span class="math inline">\(L\)</span>, as a multiple
of this underlying periodicity. This choice ensures that the method
effectively extracts the corresponding periodic components
<span class="citation" data-cites="golyandina2001">(<a href="#ref-golyandina2001" role="doc-biblioref">Golyandina et al. 2001</a>)</span>. For our illustrative example using the <code>Callcenter</code>
dataset, we specifically opt for a window length of <span class="math inline">\(L=28\)</span>. This
selection allows us to effectively capture the weekly periodic patterns
that inherently exist within this functional time series <span class="citation" data-cites="haghbin2021">(<a href="#ref-haghbin2021" role="doc-biblioref">Haghbin et al. 2021</a>)</span>.
After applying FSSA, we obtain reconstructed FTS representations under
different grouping considerations, as illustrated in Figures
<a href="#fig:figrecon-call">1</a>(B-F). Particularly noteworthy is the
reconstructed FTS obtained using the leading 7 eigentriples of the FSVD,
as shown in Figure <a href="#fig:figrecon-call">1</a>(B). It is important to
mention that the selection of groups in FTS is typically guided by
various SSA-type plotting tools, which rely on the similarity in the
harmonic structure of extracted elementary components. Such SSA-type
plots have been available for non-functional time series in the
<a href="https://CRAN.R-project.org/package=Rssa"><strong>Rssa</strong></a> package, and
analogous tools for the functional case have been developed in
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> (Figure
<a href="#fig:figcall-decomp">7</a>). However, it’s worth noting that this
extension presented its own set of challenges, both in theory and
implementation. Detailed code for generating the reconstructed functions
shown in Figure <a href="#fig:figrecon-call">1</a> can be found in the subsequent
sections of this paper.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figfor-call"></span>
<img src="figures/call_fc.png" alt="graphic without alt text" width="100%" />
<p class="caption">
Figure 2: The prediction of the last 7 days of the year 1999 for the Callcenter data, based on FSSA R-forecasting and V-forceasting, and comparing the results with the observed functions.
</p>
</div>
</div>
<h4 class="unnumbered" data-number="3.2" id="subsec:forecast">FSSA Forecasting</h4>
<p>After the decomposition stage, one may perform forecasting instead of
reconstruction (Figure <a href="#fig:figroadpap">3</a>). R-forecasting and
V-forecasting are two main defined approaches in FSSA/MFSSA
<span class="citation" data-cites="trinka2023functional">(<a href="#ref-trinka2023functional" role="doc-biblioref">Trinka et al. 2023</a>)</span>. In both forecasting methods, the goal is to
obtain the FTS,
<span class="math inline">\(\mathbf{g}_{N+M}^{q}=\left(g_{1}^{q},\dots,g_{N+M}^{q}\right)\)</span>, where
the first <span class="math inline">\(N\)</span> terms are close to <span class="math inline">\(\mathbf{y}_{N}^{q}\)</span> and the goal is to
forecast the remaining elements, <span class="math inline">\(\{g_{i}^{q}\}_{i=N+1}^{N+M}\)</span>.</p>
<p>Forecasts in the R-forecasting method, are obtained using a linear
combination of the previous <span class="math inline">\(L-1\)</span> elements of <span class="math inline">\(\mathbf{g}_{N+M}^{q}\)</span>.
Consider a positive integer <span class="math inline">\(k&lt;r\)</span> and define
<span class="math inline">\(\mathbfcal{V} = \sum_{i=1}^{k} \pi_{i} \otimes \pi_{i}\)</span>, where
<span class="math inline">\(\pi_{i} \in \mathbb{H}\)</span> is the last element of left singular function
<span class="math inline">\(\pmb{\psi}_{i}\)</span>. Define
<span class="math inline">\(\mathbfcal{A}_{j}: \mathbb{H} \rightarrow \mathbb{H}\)</span> such that
<span class="math inline">\(\mathbfcal{A}_{j} = \sum_{i=1}^{k}\psi_{j,i} \otimes \left(\mathbfcal{I} - \mathbfcal{V}\right)^{-1}\pi_{i}\)</span>,
where <span class="math inline">\(\psi_{j,i}\)</span> is the <span class="math inline">\(j^{\text{th}}\)</span> component of <span class="math inline">\(\pmb{\psi}_{i}\)</span>,
and <span class="math inline">\(\mathbfcal{I}:\mathbb{H} \rightarrow \mathbb{H}\)</span> is the identity
operator. Then the R-forecasting can be obtained using following
equation
<span class="math display">\[g_{i}^{q}=\begin{cases}
        y_{i}^{q}, &amp; i=1,\dots,N \\
        \sum_{j=1}^{L-1}\mathbfcal{A}_{j}g_{i+j-L}^{q}, &amp; i=N+1,\dots,N+M.
    \end{cases}\]</span></p>
<p>Forecasts in the V-forecasting method, are obtained by predicting
functional vectors. One may define an orthogonal projection,
<span class="math inline">\(\pmb{\Pi}:\mathbb{H}^{L-1} \rightarrow \mathbb{H}^{L-1}\)</span>, that projects
onto the space spanned by <span class="math inline">\(\{\pmb{\psi}_{i}^{\nabla}\}_{i=1}^{k}\)</span>, where
<span class="math inline">\(\pmb{\psi}_{i}^{\nabla} \in \mathbb{H}^{L-1}\)</span> is formed from the first
<span class="math inline">\(L-1\)</span> elements of <span class="math inline">\(\pmb{\psi}_{i}\)</span>. Now let
<span class="math inline">\(\mathbfcal{Q}:\mathbb{H}^{L} \rightarrow \mathbb{H}^{L}\)</span> be given by
<span class="math display">\[\mathbfcal{Q}\left(\pmb{x}\right)=\begin{pmatrix} \pmb{\Pi}\left(\pmb{x}^{\Delta}\right) \\ \sum_{j=1}^{L-1}\mathbfcal{A}_{j}x^{\Delta}_{j}\end{pmatrix}, \qquad {\pmb{x}} \in \mathbb{H}^{L} \nonumber,\]</span>
where <span class="math inline">\(\pmb{x}^{\Delta}\)</span> contains the last <span class="math inline">\(L-1\)</span> components of
<span class="math inline">\(\pmb{x}\)</span>, and <span class="math inline">\(x_{j}^{\Delta}\)</span> is the <span class="math inline">\(j^{\text{th}}\)</span> component of
<span class="math inline">\(\pmb{x}^{\Delta}\)</span>. The V-forecasting algorithm is given in the
following steps:</p>
<ol type="1">
<li><p>Define <span class="math inline">\(\pmb{w}^{q}_{j}\)</span> as
<span class="math display">\[\pmb{w}^{q}_{j}= \begin{cases}
      \pmb{x}^{q}_{j}, &amp; j=1,\dots, K \\
     \mathbfcal{Q}\pmb{w}^{q}_{j-1}, &amp; j=K+1, \dots, K+M,
   \end{cases}\]</span>
where <span class="math inline">\(\{\pmb{x}^{q}_{j}\}_{j=1}^{K}\)</span> spans the range of operator
<span class="math inline">\(\mathbfcal{X}_{I_{q}}\)</span>.</p></li>
<li><p>Form the operator
<span class="math inline">\(\mathbfcal{W}^q:\mathbb{R}^{K+M} \rightarrow \mathbb{H}^{L}\)</span> whose
range is linearly spanned by the set
<span class="math inline">\(\{\pmb{w}_{i}^q\}_{i=1}^{K+M}\)</span>.</p></li>
<li><p>Hankelize <span class="math inline">\(\mathbfcal{W}^q\)</span> in order to extract the FTS
<span class="math inline">\(\mathbf{g}^{q}_{N+M}\)</span>.</p></li>
<li><p>The functions, <span class="math inline">\(g^{q}_{N+1}, \dots, g^{q}_{N+M}\)</span>, form the <span class="math inline">\(M\)</span> terms
of the FSSA vector forecast.</p></li>
</ol>
<p>Continuing from the previous example, we utilized the first 358 days of
the year to train the FSSA model on the <code>Callcenter</code> dataset.
Subsequently, we employed the FSSA R-forecasting and V-forecasting
methods to make predictions for the final week (<span class="math inline">\(len = 7\)</span>). Figure
<a href="#fig:figfor-call">2</a> illustrates both the actual and forecasted curves
for each day of the week, employing each respective method. Detailed
code for this process can be found in the subsequent sections.</p>
<p>In the <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package, we
offer the <code>fforecast(</code><span class="math inline">\(\cdot\)</span><code>)</code> function designed for the execution of
R-forecasting or V-forecasting algorithms. This function expects an
input argument of class <code>fssa</code> and yields an output of class
<code>fforecast</code>. The latter comprises a list of objects of class <code>funts</code>,
with each <code>funts</code> representing a forecasted group.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figroadpap"></span>
<img src="figures/roadmap.png" alt="graphic without alt text" width="70.0%" />
<p class="caption">
Figure 3: The roadmap of the Rfssa package.
</p>
</div>
</div>
<h3 data-number="4" id="sec:Technical"><span class="header-section-number">4</span> Technical details of the Rfssa package</h3>
<p>The roadmap of the main functions used in the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package is given
in Figure <a href="#fig:figroadpap">3</a>. The inputs and outputs of these
functions are described in Table <a href="#tbl:tab-1">1</a>. As it can be seen from
Table <a href="#tbl:tab-1">1</a>, three classes (<code>funts</code>, <code>fssa</code> and <code>fforecast</code>) are
used to support the return objects of theses functions. The
<code>funts(</code><span class="math inline">\(\cdot\)</span><code>)</code>, <code>fssa(</code><span class="math inline">\(\cdot\)</span><code>)</code> and <code>fforecast(</code><span class="math inline">\(\cdot\)</span><code>)</code>
functions are the constructors of the <code>funts</code>, <code>fssa</code> and <code>fforecast</code>
classes, respectively. In the rest of this section we present these
classes with illustrative examples, and later we describe the
reconstruction and forecasting functions in details.</p>
<div id="tbl:tab-1">
<table style="width:99%;">
<caption>Table 1: A summary of FSSA written functions in the <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package.</caption>
<colgroup>
<col style="width: 7%" />
<col style="width: 24%" />
<col style="width: 46%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Descriptions</th>
<th></th>
<th style="text-align: left;">Returns</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>funts(</code><span class="math inline">\(\cdot\)</span><code>)</code></td>
<td style="text-align: left;">Create FTS/MFTS objects</td>
<td>Discretely sampled data or coefficients, basis system specifications, a set of argument values corresponding to the observations in X, the time specifications arguments.</td>
<td style="text-align: left;">An object of class <code>funts</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>fssa(</code><span class="math inline">\(\cdot\)</span><code>)</code></td>
<td style="text-align: left;">Performs the decomposition (including embedding and FSVD steps) stage for FTS/MFTS data.</td>
<td>An object of class <code>funts</code> and window length <span class="math inline">\(L.\)</span></td>
<td style="text-align: left;">An object of class <code>fssa</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>freconstruct(</code><span class="math inline">\(\cdot\)</span><code>)</code></td>
<td style="text-align: left;">Performs the reconstruction (including grouping and Hankelization steps) stage.</td>
<td>An object of class <code>fssa</code> and list of numeric vectors includes indices of elementary components of a group.</td>
<td style="text-align: left;">A list of <code>funts</code> objects reconstructed according to the specified groups.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>fforecast(</code><span class="math inline">\(\cdot\)</span><code>)</code></td>
<td style="text-align: left;">Performs FSSA R-forecasting or FSSA V-forecasting.</td>
<td>An object of class <code>fssa</code>, list of numeric vectors includes indices of elementary components of a group used for reconstruction and forecasting and forecast horizon <span class="math inline">\(h\)</span>.</td>
<td style="text-align: left;">An object of class <code>fforecast</code>.</td>
</tr>
</tbody>
</table>
</div>
<h4 class="unnumbered" data-number="4.1" id="subsec:fts">The <code>funts</code> class</h4>
<p>The <code>funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> constructor is used to create an <code>S3</code> object of
class <code>funts</code>. This object is designed to encapsulate various forms of
FTS, including both univariate and multivariate types. It offers a
versatile framework for the creation and manipulation of <code>funts</code>
objects, accommodating different basis systems and dimensions. It
accepts the following arguments:</p>
<ul>
<li><p><code>X</code>: A matrix, three-dimensional array, or a list of matrix or array
objects. When <code>method="data"</code>, it represents the observed curve
values at discrete sampling points or argument values. When
<code>method="coefs"</code>, <code>X</code> specifies the coefficients corresponding to
the basis system defined in <code>basisobj</code>. If <code>X</code> is a list, it defines
a multivariate FTS, with each element being a matrix or
three-dimensional array object. In matrix objects, rows correspond
to argument values, and columns correspond to the length of the FTS.
In three-dimensional array objects, the first and second dimensions
correspond to argument values, and the third dimension to the length
of the FTS.</p></li>
<li><p><code>basisobj</code>: This argument should be an object of class <code>basisfd</code>, a
matrix of empirical basis, or a list of <code>basisfd</code> or empirical basis
objects. In the case of empirical basis, rows correspond to basis
functions, and columns correspond to grid points.</p></li>
<li><p><code>argval</code>: A vector list of length <code>p</code>, representing a set of
argument values corresponding to the observations in <code>X</code>. Each entry
in this list should either be a numeric value or a list of numeric
elements, depending on the dimension of the domain over which the
variable is observed. It’s worth noting that these values can vary
from one variable to another. If <code>argval</code> is set to <code>NULL</code>, the
default values are the integers from 1 to <em>n</em>, where <em>n</em> is the size
of the first dimension in the <code>X</code> argument.</p></li>
<li><p><code>method</code>: This parameter determines the type of the <code>X</code> matrix, and
it can take one of two values: <code>coefs</code> or <code>data</code>.</p></li>
<li><p><code>start</code> and <code>end</code>: Specify time of the first and last observations.
They can be a single positive integer or an object of classes
<code>Date</code>, <code>POSIXct</code>, or <code>POSIXt</code>, representing a natural time unit.</p></li>
<li><p><code>tname</code>, <code>vnames</code> and <code>dnames</code>: These parameters accept strings or
lists of strings to specify the names of time, variables, and
domains.</p></li>
</ul>
<p>The <code>funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> constructor offers flexibility to users. Users
can either provide their custom basis or request
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> to generate the
basis for them, leveraging the capabilities of the
<a href="https://CRAN.R-project.org/package=fda"><strong>fda</strong></a> package. It is assumed
that each variable is observed over a regular and equidistant grid.
Furthermore, each variable in the <code>funts</code> object is assumed to be
observed over either a one or two-dimensional domain, as illustrated in
Figure <a href="#fig:figfts">4</a>. To enhance the representation of time, the
<code>funts</code> function introduces two parameters, namely <code>start</code> and <code>end</code>,
which capture the time series duration. This design allows users to
specify time information in a structured and standardized manner. Users
have the flexibility to set <code>start</code> and <code>end</code> using various time and
date classes, such as <code>Date</code>, <code>POSIXct</code>, or <code>POSIXt</code>. If users do not
provide the <code>start</code> and <code>end</code> arguments, default values are used, with
<code>start=1</code> and <code>end=N</code>, where <span class="math inline">\(N\)</span> represents the length of the time
series. This default approach aligns with common practices, as seen in
classes like <code>ts</code> in the
<a href="https://CRAN.R-project.org/package=stats"><strong>stats</strong></a> package, as well
as <code>fts</code> classes in
<a href="https://CRAN.R-project.org/package=rainbow"><strong>rainbow</strong></a> or
<a href="https://CRAN.R-project.org/package=ftsa"><strong>ftsa</strong></a>. An object of class
<code>funts</code> is a list encompassing the following elements:</p>
<ol type="1">
<li><p><code>N</code>: Represents the length of the time series.</p></li>
<li><p><code>dimSupp</code>: A list specifying the dimensions of the support domain of
the variables.</p></li>
<li><p><code>time</code>: The time object.</p></li>
<li><p><code>coefs</code>: A list containing basis coefficients.</p></li>
<li><p><code>basis</code>: A list of basis systems.</p></li>
<li><p><code>B_mat</code>: Evaluated basis functions on initial arguments.</p></li>
<li><p><code>argval</code>: Initial arguments of the observed functions.</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figfts"></span>
<img src="figures/fts.png" alt="graphic without alt text" width="90.0%" />
<p class="caption">
Figure 4: The main roadmap of funts objects.
</p>
</div>
</div>
<p>The <code>funts</code> class provides essential functionalities for managing FTS
objects, ensuring users have well-defined basic operations. It supports
arithmetic operations like addition and multiplication, along with
indexing methods. Additionally, three generic methods,
<code>length(</code><span class="math inline">\(\cdot\)</span><code>)</code>, <code>print(</code><span class="math inline">\(\cdot\)</span><code>)</code>, and <code>plot(</code><span class="math inline">\(\cdot\)</span><code>)</code>, are
available. The <code>eval.funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> method allows users to evaluate a
<code>funts</code> object on a specified grid. To determine if an object belongs to
the <code>funts</code> class, the <code>is.funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> method is provided.
Converting objects from the
<a href="https://CRAN.R-project.org/package=fda"><strong>fda</strong></a> package’s <code>fd</code> class
or the <a href="https://CRAN.R-project.org/package=rainbow"><strong>rainbow</strong></a>
package’s <code>fts</code> class to a <code>funts</code> object is made easy using the
<code>as.funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> function. The strength of <code>funts</code> objects lies in
their powerful visualization capabilities within the field of FTS. Users
can create two types of plots using the graphical commands
<code>plot(</code><span class="math inline">\(\cdot\)</span><code>)</code> and <code>plotly_funts(</code><span class="math inline">\(\cdot\)</span><code>)</code>. The <code>plot(</code><span class="math inline">\(\cdot\)</span><code>)</code>
method utilizes base graphics objects to generate FTS plots. On the
other hand, the <code>plotly_funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> function offers a versatile
<a href="https://CRAN.R-project.org/package=plotly"><strong>plotly</strong></a> platform for
visualizing FTS data, providing several plot types: <code>line</code>, <code>3Dline</code>,
<code>3Dsurface</code>, and <code>heatmap</code>. These plots making it easier to detect
trends or patterns within each curve’s behavior over time. Furthermore,
users can directly apply <code>plotly_funts(</code><span class="math inline">\(\cdot\)</span><code>)</code> function to objects
from the <code>fd</code>, <code>fds</code>, or <code>fts</code> classes in packages like
<a href="https://CRAN.R-project.org/package=rainbow"><strong>rainbow</strong></a>,
<a href="https://CRAN.R-project.org/package=fds"><strong>fds</strong></a>,
<a href="https://CRAN.R-project.org/package=ftsa"><strong>ftsa</strong></a>, or
<a href="https://CRAN.R-project.org/package=fda"><strong>fda</strong></a>, without the need for
conversion to <code>funts</code> objects. Additionally, when converting objects
from packages like <code>fds</code> or <code>fts</code>, the <code>xname</code> and <code>yname</code> arguments are
automatically captured and used as the <code>xlab</code> and <code>zlab</code> arguments,
ensuring that resulting plots are informative and intuitive.</p>
<p>To demonstrate the capabilities of the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package for
handling FTS, two illustrative examples are provided. The first example
showcases the <code>Callcenter</code> dataset consisting of curves observed over a
one-dimensional domain. In contrast, the second example involves a
bivariate FTS dataset, which includes a sequence of two types of remote
sensing images (two-dimensional functional data domain).</p>
<h5 class="unnumbered" data-number="4.1.1" id="example-creating-funts-objects-for-fts">Example: Creating <code>funts</code> objects for FTS</h5>
<p>The first example uses the raw <code>Callcenter</code> dataset which was discussed
before. The <code>funts</code> object can be made and plotted using the following
codes. The generated plots are shown in Figure
<a href="#fig:figcall-center">5</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(Rfssa)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(fda)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Callcenter data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Call_data <span class="ot">&lt;-</span> <span class="fu">loadCallcenterData</span>()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sqrt</span>(Call_data<span class="sc">$</span>calls)), nrow <span class="ot">=</span> <span class="dv">240</span><span class="er">)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>bs1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">23</span>), <span class="dv">22</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a &#39;funts&#39; object </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>Call_funts <span class="ot">&lt;-</span> <span class="fu">funts</span>(D, bs1, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">&quot;1999-1-1&quot;</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">vnames =</span> <span class="st">&quot;Sqrt of Call Numbers&quot;</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">dnames =</span> <span class="st">&quot;Time (6 minutes aggregated)&quot;</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;Date&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>xtlab <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;00:00&quot;</span>, <span class="st">&quot;06:00&quot;</span>, <span class="st">&quot;12:00&quot;</span>, <span class="st">&quot;18:00&quot;</span>, <span class="st">&quot;24:00&quot;</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>xtloc <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>, <span class="dv">240</span>))</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a line plot using Plotly</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plotly_funts</span>(Call_funts, <span class="at">main =</span> <span class="st">&quot;Call Center Data Line Plot&quot;</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xticklabels =</span> xtlab, <span class="at">xticklocs =</span> xtloc)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a heatmap plot using Plotly</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plotly_funts</span>(Call_funts, <span class="at">type =</span> <span class="st">&quot;heatmap&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Call Center Data Heatmap&quot;</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">xticklabels =</span> xtlab, <span class="at">xticklocs =</span> xtloc)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a 3D line plot using Plotly</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plotly_funts</span>(Call_funts, <span class="at">type =</span> <span class="st">&quot;3Dline&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Call Center Data 3Dline plot&quot;</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">xticklabels =</span> xtlab, <span class="at">xticklocs =</span> xtloc</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a 3D surface plot using Plotly</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plotly_funts</span>(Call_funts, <span class="at">type =</span> <span class="st">&quot;3Dsurface&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Call Center Data 3Dsurface plot&quot;</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">xticklabels =</span> xtlab, <span class="at">xticklocs =</span> xtloc</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figcall-center"></span>
<img src="figures/call_1.png" alt="graphic without alt text" width="661" /><img src="figures/call_2.png" alt="graphic without alt text" width="661" /><img src="figures/3Dline.png" alt="graphic without alt text" width="950" /><img src="figures/3Dsurface.png" alt="graphic without alt text" width="950" />
<p class="caption">
Figure 5: The plot types of the generated plots by plotly_funts(<span class="math inline">\(\cdot\)</span>)
</p>
</div>
</div>
<p>As one can be see from Figure <a href="#fig:figcall-center">5</a>(A), the
overlapping line plot is a common way to view FTS data observed over a
one-dimensional domain, where the curves that are recorded on dates
closer to the start of 1999 are given in light blue while functions
obtained on later dates are plotted in a darker blue. The heatmap plot
in Figure <a href="#fig:figcall-center">5</a>(B) is a newer technique used to
visualize FTS data observed over a one-dimensional domain, allowing the
user to see the evolution of the FTS over time as opposed to relying on
different colorings of the curves to specify date. Such one-dimensional
FTS can also be represented in a interactive 3D view. To obtain such
plots the user simply needs to specify <code>type="3Dsurface"</code> or
<code>type="3Dline"</code>.</p>
<h5 class="unnumbered" data-number="4.1.2" id="example-creating-funts-objects-for-mfts">Example: Creating <code>funts</code> objects for MFTS</h5>
<p>The second example considered two collection of images where each image
is drawn from a region southeast of the city of Jambi, Indonesia located
between latitudes of <span class="math inline">\(1.666792^{\circ}\)</span> S - <span class="math inline">\(1.598042^{\circ}\)</span> S and
longitudes of <span class="math inline">\(103.608963^{\circ}\)</span> E - <span class="math inline">\(103.677742^{\circ}\)</span> E. The
images were recorded using the MODerate Resolution Imaging
Spectroradiometer (MODIS) Terra satellite with a resolution of 250
meters every 16 days starting from February 18, 2000 and ending July 28,
2019. The output of each image is the normalized difference vegetation
index (NDVI) which is used to quantify how much vegetation is present
and enhanced vegetation index (EVI). The NDVI values closer to one being
indicative of more vegetation and values closer to zero indicate less
vegetation <span class="citation" data-cites="haghbin2021">(see <a href="#ref-haghbin2021" role="doc-biblioref">Haghbin et al. 2021</a> for more details)</span>. The following code can
be used to load the data, define a <code>funts</code> object for a MFTS, slice the
<code>funts</code> object to select a specific variable (here NDVI), and plot the
smoothed images over time in an animation, that a snapshot is given in
Figure <a href="#fig:figndvi-image">6</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figndvi-image"></span>
<img src="figures/ndvi.png" alt="graphic without alt text" width="100%" />
<p class="caption">
Figure 6: An NDVI snapshot from the city of Jambi, Indonesia.
</p>
</div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Jambi dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Jambi <span class="ot">&lt;-</span> <span class="fu">loadJambiData</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract NDVI and EVI array data </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>NDVI <span class="ot">&lt;-</span> Jambi<span class="sc">$</span>NDVI</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>EVI <span class="ot">&lt;-</span> (Jambi<span class="sc">$</span>EVI)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list containing NDVI and EVI array data</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>Jambi_Data <span class="ot">&lt;-</span> <span class="fu">list</span>(NDVI, EVI)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a multivariate B-spline basis</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(fda)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>bs2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">13</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>bs2d <span class="ot">&lt;-</span> <span class="fu">list</span>(bs2, bs2)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>bsmv <span class="ot">&lt;-</span> <span class="fu">list</span>(bs2d, bs2d)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a funts object</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Y_J <span class="ot">&lt;-</span> <span class="fu">funts</span>(<span class="at">X =</span> Jambi_Data,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">basisobj =</span> bsmv,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2000-02-18&quot;</span>), <span class="at">end =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2019-07-28&quot;</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">vnames =</span> <span class="fu">c</span>(<span class="st">&quot;NDVI&quot;</span>, <span class="st">&quot;EVI&quot;</span>), <span class="at">tname =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">dnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Longitude&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Longitude&quot;</span>)))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Plotly-based visualization of the NDVI Image</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plotly_funts</span>(Y_J[, <span class="dv">1</span>],</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;NDVI Image (Jambi)&quot;</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">xticklabels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;103.61\u00B0 E&quot;</span>, <span class="st">&quot;103.68\u00B0 E&quot;</span>)),</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">yticklabels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;1.67\u00B0 S&quot;</span>, <span class="st">&quot;1.60\u00B0 S&quot;</span>)),</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xticklocs =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">yticklocs =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color_palette =</span> <span class="st">&quot;RdYlGn&quot;</span>)</span></code></pre></div>
<h4 class="unnumbered" data-number="4.2" id="subsec:fssa">The <code>fssa</code> Class</h4>
<p>Once the <code>funts</code> object is created and <span class="math inline">\(L\)</span> is chosen, one can apply the
<code>fssa(</code><span class="math inline">\(\cdot\)</span><code>)</code> constructor to obtain an <code>S3</code> object of class <code>fssa</code>
that contains our singular values, left singular functions, and right
singular vectors. An object of class <code>fssa</code> is a list of right singular
functions, which is packed in an object of class <code>funts</code> and the
following components:</p>
<ul>
<li><p><code>values:</code> A numeric vector of singular values.</p></li>
<li><p><code>L:</code> The specified window length.</p></li>
<li><p><code>N:</code> The length of the functional time series.</p></li>
<li><p><code>Y:</code> The original <code>funts</code> object.</p></li>
</ul>
<p>The generic <code>plot(</code><span class="math inline">\(\cdot\)</span><code>)</code> is developed for the <code>fssa</code> class to help
the user make decisions on how to do the grouping stage of FSSA/MFSSA.
This method, provides a complete set of visualization tools for the user
to check the quality of the decomposition stage. These SSA-type plots
encompass various types, each providing unique insights into the data:</p>
<ul>
<li><p><strong><code>"values"</code></strong>: Plots the singular values (default).</p></li>
<li><p><strong><code>"paired"</code></strong>: Visualizes pairs of right singular vectors, which is
particularly useful for detecting periodic components.</p></li>
<li><p><strong><code>"wcor"</code></strong>: Generates a plot of the W-correlation matrix for the
reconstructed objects.</p></li>
<li><p><strong><code>"vectors"</code></strong>: Displays the right singular vectors, aiding in the
detection of period length.</p></li>
<li><p><strong><code>"lcurves"</code></strong>: Showcases the left singular functions, assisting in
period length detection.</p></li>
<li><p><strong><code>"lheats"</code></strong>: Heatmap plots of left singular functions are
available, designed for <code>funts</code> variables observed over one or
two-dimensional domains. These plots are valuable for identifying
meaningful patterns.</p></li>
<li><p><strong><code>"periodogram"</code></strong>: Periodogram plots of the right singular vectors
can be generated, which help detect the frequencies of oscillations
in functional data.</p></li>
</ul>
<p>While efforts have been made to align these plots in
<a href="https://CRAN.R-project.org/package=Rfsaa"><strong>Rfsaa</strong></a> with the
non-functional versions available in the
<a href="https://CRAN.R-project.org/package=Rsaa"><strong>Rsaa</strong></a> package, there are
some fundamental differences. Notably, <code>"lheats"</code> and <code>"lcurves"</code> are
novel plot types introduced in the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package for
functional data. Additionally, <code>"paired"</code> and <code>"vectors"</code> types are
developed based on the right singular vectors. All these plot types
utilize the <a href="https://CRAN.R-project.org/package=lattice"><strong>lattice</strong></a>
graphics engine. The following example codes generate these plots for
the <code>Callcenter</code> dataset.</p>
<h5 class="unnumbered" data-number="4.2.1" id="example-performing-decomposition-stage-of-fssa">Example: performing decomposition stage of FSSA</h5>
<p>In the rest of the paper, we will use the pre-generated <code>funts</code> class
object datasets such as <code>Callcenter</code> which are included within the
package. These ready-to-use datasets serve as practical examples and
templates, allowing users to test the FSSA procedure without the need to
start from scratch with data preprocessing. As mentioned previously, our
approach involves performing FSSA with a lag window of <span class="math inline">\(L=28\)</span>. We then
generate a variety of SSA-type plots, as illustrated in Figure
<a href="#fig:figcall-decomp">7</a>, using the following code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Callcenter dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Callcenter&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform FSSA:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>fssa_results <span class="ot">&lt;-</span> <span class="fu">fssa</span>(Callcenter, <span class="at">L =</span> <span class="dv">28</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># FSSA plots:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fssa_results, <span class="at">d =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">&quot;lcurves&quot;</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;(A) Left Singular Functions (within days)&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fssa_results, <span class="at">d =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">&quot;lheats&quot;</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;(B) Left Singular Functions (between days)&quot;</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fssa_results, <span class="at">d =</span> <span class="dv">13</span>, <span class="at">main =</span> <span class="st">&quot;(C) Singular Values&quot;</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fssa_results, <span class="at">d =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">&quot;vectors&quot;</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;(D) Right Singular Vectors&quot;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fssa_results, <span class="at">d =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;paired&quot;</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;(E) Paired Plots of Right Singular Vectors&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fssa_results, <span class="at">d =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">&quot;wcor&quot;</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;(F) W-Correlation Matrix&quot;</span>)</span></code></pre></div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figcall-decomp"></span>
<img src="figures/fssa_call_1.png" alt="graphic without alt text" width="100%" /><img src="figures/fssa_call_2.png" alt="graphic without alt text" width="100%" /><img src="figures/fssa_call_3.png" alt="graphic without alt text" width="100%" /><img src="figures/fssa_call_4.png" alt="graphic without alt text" width="100%" /><img src="figures/fssa_call_5.png" alt="graphic without alt text" width="100%" /><img src="figures/fssa_call_6.png" alt="graphic without alt text" width="100%" />
<p class="caption">
Figure 7: (A): Line plot of the left singular functions, used to identify periodic and trend components; (B): Heatmap of the left singular functions; (C): Scree plot of the singular values often used for grouping; (D): Right singular vectors, used to identify periodic and trend components; (E): Paired plots of the right singular vectors, used for grouping and identifying periodicity in the FTS; (F): Weighted correlation (W-correlation) matrix used for grouping.
</p>
</div>
</div>
<p>The W-correlation matrix in Figure <a href="#fig:figcall-decomp">7</a>(F) is built
by measuring the correlation between FTS that are reconstructed using
the grouping of indices by setting <span class="math inline">\(m=r\)</span> (see the discussion on grouping
in section 2). We also have that Figure <a href="#fig:figcall-decomp">7</a>(E) is
a plot of successive right singular vectors against one another. Using
Figure <a href="#fig:figcall-decomp">7</a>(C, E-F) we identify four groups in the
<code>Callcenter</code> data such that <span class="math inline">\(I_{1}=\{1\}\)</span>, <span class="math inline">\(I_{2} = \{2,3\}\)</span>,
<span class="math inline">\(I_{3}=\{4,5\}\)</span>, and <span class="math inline">\(I_{4}=\{6,7\}\)</span>. Specifically, as discussed in
<span class="citation" data-cites="golyandina2001">(<a href="#ref-golyandina2001" role="doc-biblioref">Golyandina et al. 2001</a>)</span>, periodic components in FTS typically exhibit a rank
of 2, consisting of pairs of harmonic elementary components (sine and
cosine functions with the same frequency). To identify these pairs, we
can examine pairwise scatterplots of the right singular vectors, as
illustrated in Figure <a href="#fig:figcall-decomp">7</a>(E). In such
scatterplots, components with identical frequencies, amplitudes, and
phases form points that lie along a circular path. Additionally, the
number of vertices in the resulting regular T-vertex polygon corresponds
to the periodicity of the component. In Figure
<a href="#fig:figcall-decomp">7</a>(E), subplots 2 vs. 3, 4 vs. 5, and 6 vs. 7
reveal harmonic factors with frequencies of <span class="math inline">\(1/7\)</span>, <span class="math inline">\(8/14\)</span>, and <span class="math inline">\(4/7\)</span>,
respectively. For a more detailed exploration of extracting meaningful
components from the extracted signal, additional references in the SSA
literature, such as <span class="citation" data-cites="golyandina2013">(<a href="#ref-golyandina2013" role="doc-biblioref">Golyandina and Zhigljavsky 2013</a>)</span>, can be consulted. In addition,
using Figure <a href="#fig:figcall-decomp">7</a>(A-B, D-E), we see clear weekly
periodic patterns captured in the decomposition, for example the seven
distinct curves found in various subplots of Figure
<a href="#fig:figcall-decomp">7</a>(A) and the seven corners seen in subplot 2 vs.
3 of Figure <a href="#fig:figcall-decomp">7</a>(E). For interested readers we
provide further results for the decomposition stage and the <code>fssa</code>
object in the GitHub repository of the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package
(<a href="https://github.com/haghbinh/Rfssa" class="uri">https://github.com/haghbinh/Rfssa</a>).</p>
<h3 data-number="5" id="reconstruction-and-forecasting"><span class="header-section-number">5</span> Reconstruction and forecasting</h3>
<p>After obtaining an object of class <code>fssa</code>, the user may then choose to
perform reconstruction using the <code>freconstruct(</code><span class="math inline">\(\cdot\)</span><code>)</code> function or
perform forecasting using <code>fforecast(</code><span class="math inline">\(\cdot\)</span><code>)</code>. The reconstruction and
forecasting functions both return a list of <code>funts</code> objects with length
<span class="math inline">\(m\)</span> (number of groups). We note that even though it is common to perform
forecasting using a combination of groups that best reconstructs the
original signal, the user may try to forecast using several different
combinations of groups.</p>
<h4 class="unnumbered" data-number="5.1" id="reconstruction">Reconstruction</h4>
<p>We start by reconstructing the <code>Callcenter</code> data using the grouping
suggested from the FSSA decomposition. The following code implements the
reconstruction methodology and gives the plots of the reconstruction in
Figure <a href="#fig:figrecon-call">1</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define groups and their labels</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>group_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(B) First Group&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;(C) Second Group&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;(D) Third Group&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;(E) Fourth Group&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;(F) Extracted Signal&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform FSSA‌ reconstruction</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>reconstructed_data  <span class="ot">&lt;-</span> <span class="fu">freconstruct</span>(fssa_results, groups)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and visualize plots</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(groups)) {</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">plotly_funts</span>(reconstructed_data[[i]], <span class="at">main =</span> group_labels[i], </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">xticklocs =</span> xtlab, <span class="at">xticklabels =</span> xtloc))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>One may observe the mean behavior (from group <span class="math inline">\(I_1\)</span>) in Figure
<a href="#fig:figrecon-call">1</a>(C), and the weekly behaviors (from groups
<span class="math inline">\(I_2, I_3\)</span> and <span class="math inline">\(I_4\)</span>) in Figure <a href="#fig:figrecon-call">1</a>(D-F). Note that
the weekly trajectories are more well-separated in <span class="math inline">\(I_4\)</span> as opposed to
the groups <span class="math inline">\(I_2\)</span> and <span class="math inline">\(I_3\)</span>. We consider the last group,
<span class="math inline">\(I_{\mathfrak{s}}=\{1,\cdots,7\}\)</span>, as the set of indices corresponding
to the leading eigentriples, that capture more than <span class="math inline">\(98\%\)</span> of the
variation in the signal, to reconstruct the original FTS in Figure
<a href="#fig:figrecon-call">1</a>(B).</p>
<h4 class="unnumbered" data-number="5.2" id="the-fforecast-class">The <code>fforecast</code> Class</h4>
<p>As previously mentioned, in addition to performing reconstruction of the
FTS, the package offers the capability to perform forecasting using an
object of class <code>fssa</code>. The constructor for this class, i.e., the
<code>fforecast(</code><span class="math inline">\(\cdot\)</span><code>)</code> function, accepts the following arguments:</p>
<ul>
<li><p><code>U</code>: An object of class <code>fssa</code> holding the decomposition.</p></li>
<li><p><code>groups</code>: A list of numeric vectors where each vector is used for
reconstruction and forecasting.</p></li>
<li><p><code>len</code>: An integer representing the desired length of the forecasted
FTS.</p></li>
<li><p><code>method</code>: A character string specifying the type of forecasting to
perform, with options including:</p>
<ul>
<li><p>"recurrent" for FSSA R-forecasting.</p></li>
<li><p>"vector" for FSSA V-forecasting.</p></li>
</ul></li>
<li><p><code>only.new</code>: A logical argument, when set to <code>TRUE</code>, returns only the
forecasted FTS, otherwise the entire FTS is returned.</p></li>
</ul>
<p>The <code>fforecast(</code><span class="math inline">\(\cdot\)</span><code>)</code> function returns an S3 class named
<code>fforecast</code>, which has been introduced to encapsulate the output of the
function. This class is designed to provide a more organized and
intuitive structure for handling FTS data. The <code>fforecast</code> class
includes the following attributes:</p>
<ul>
<li><p><code>original_funts</code>: This attribute stores the original FTS object,
allowing users to maintain a clear reference to the original data.</p></li>
<li><p><code>predicted_time</code>: Stores the forecast time index.</p></li>
<li><p><code>groups</code>: Contains a list of numeric vectors, where each vector
includes indices of elementary components of a group used for
reconstruction and forecasting.</p></li>
<li><p><code>method</code>: A character string specifying the type of forecasting
performed.</p></li>
</ul>
<p>To streamline user interactions further, we have developed a
<code>print(</code><span class="math inline">\(\cdot\)</span><code>)</code> method for the <code>fforecast</code> class, making it more
convenient to view and assess forecasted FTS data. To illustrate these
enhancements, consider the continuous of Callcenter data example in the
following:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform FSSA R-forecasting</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pr_R <span class="ot">&lt;-</span> <span class="fu">fforecast</span>(<span class="at">U =</span> fssa_results, <span class="at">groups =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">len =</span> <span class="dv">14</span>, <span class="at">method =</span> <span class="st">&quot;recurrent&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform FSSA V-forecasting</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>pr_V <span class="ot">&lt;-</span> <span class="fu">fforecast</span>(<span class="at">U =</span> fssa_results, <span class="at">groups =</span> <span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">len =</span> <span class="dv">14</span>, <span class="at">method =</span> <span class="st">&quot;vector&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">only.new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr_R, <span class="at">main =</span> <span class="st">&#39;R-Forecast (only.new = TRUE)&#39;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr_V, <span class="at">main =</span> <span class="st">&#39;V-Forecast (only.new = FALSE)&#39;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pr_V)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># FSSA Forecast (fforecast) class:</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups: List of 2</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># : num 1</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># : int [1:7] 1 2 3 4 5 6 7</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction method:  vector</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted series length:  14</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted time:  Date[1:14], format: &quot;2000-01-01&quot; &quot;2000-01-02&quot; ...</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------The original series-----------</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Functional time series (funts) object:</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of variables:  1</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Lenght:  365</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Start:  10592</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># End:  10956</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Time:  Date[1:365], format: &quot;1999-01-01&quot; &quot;1999-01-02&quot; &quot;1999-01-03&quot;  ...</span></span></code></pre></div>
<p>The resulted figure are shown in the Figure <a href="#fig:figforecast">8</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figforecast"></span>
<img src="figures/Rfore.png" alt="graphic without alt text" width="100%" /><img src="figures/Vfore.png" alt="graphic without alt text" width="100%" />
<p class="caption">
Figure 8: plot(<span class="math inline">\(\cdot\)</span>) method of fforecast class.
</p>
</div>
</div>
<p>The next example will forecast the <code>Callcenter</code> FTS one week into the
future, based on the first <span class="math inline">\(358\)</span> days of the year, by leveraging the
FSSA R-forecasting and V-forecasting methods as the results that had
been given in the Figure <a href="#fig:figfor-call">2</a>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data length</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> Callcenter<span class="sc">$</span>N</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> <span class="fu">fssa</span>(Callcenter[<span class="dv">1</span><span class="sc">:</span>(N<span class="dv">-7</span>)], <span class="dv">28</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform recurrent forecasting using FSSA</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>fore_R <span class="ot">=</span> <span class="fu">fforecast</span>(U1, <span class="at">groups =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">method =</span> <span class="st">&quot;recurrent&quot;</span>, <span class="at">len =</span> <span class="dv">7</span>)[[<span class="dv">1</span>]]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform vector forecasting using FSSA </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>fore_V <span class="ot">=</span> <span class="fu">fforecast</span>(U1, <span class="at">groups =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">method =</span> <span class="st">&quot;vector&quot;</span>, <span class="at">len =</span> <span class="dv">7</span>)[[<span class="dv">1</span>]]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the true call data</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>true_call <span class="ot">&lt;-</span> Callcenter[(N<span class="dv">-7</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define weekdays and colors</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Sunday&#39;</span>, <span class="st">&#39;Monday&#39;</span>, <span class="st">&#39;Tuesday&#39;</span>, <span class="st">&#39;Wednesday&#39;</span>,<span class="st">&#39;Thursday&#39;</span>, <span class="st">&#39;Friday&#39;</span>, <span class="st">&#39;Saturday&#39;</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>clrs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;turquoise4&quot;</span>, <span class="st">&quot;darkorange&quot;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>argvals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">23</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="dv">2</span>, <span class="fl">0.2</span>))</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the days of the week</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(true_call[i], <span class="at">col =</span> clrs[<span class="dv">1</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">5.3</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> wd[i])</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(fore_R[i], <span class="at">col =</span> clrs[<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(fore_V[i], <span class="at">col =</span> clrs[<span class="dv">3</span>], <span class="at">lty =</span> <span class="dv">5</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;R-forecasting&quot;</span>, <span class="st">&quot;V-forecasting&quot;</span>), <span class="at">col =</span> clrs,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>More information on these results may be found in the associated
literature of <span class="citation" data-cites="haghbin2021">(<a href="#ref-haghbin2021" role="doc-biblioref">Haghbin et al. 2021</a>)</span> and <span class="citation" data-cites="trinka2023functional">(<a href="#ref-trinka2023functional" role="doc-biblioref">Trinka et al. 2023</a>)</span>.</p>
<h3 data-number="6" id="a-shiny-application"><span class="header-section-number">6</span> A shiny application</h3>
<p>The <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package
contains shiny-apps for both FSSA and MFSSA methods. Those shiny-apps
can be called using the <code>launchApp(</code><span class="math inline">\(\cdot\)</span><code>)</code> function, and also
available in <a href="http://sctc.mscs.mu.edu/fssa.htm" class="uri">http://sctc.mscs.mu.edu/fssa.htm</a> and
<a href="http://sctc.mscs.mu.edu/mfssa.htm" class="uri">http://sctc.mscs.mu.edu/mfssa.htm</a>. Here we present the features of the
MFSSA app, since the FSSA app would be a special case of that. MFSSA
shiny-app was developed to visualize and extract the information related
to MFTS in a non-parametric framework. The proposed shiny-app provides a
friendly GUI for user to implement the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> functionalities
and even compare the results with the non-functional version
(<a href="https://CRAN.R-project.org/package=Rssa"><strong>Rssa</strong></a>).</p>
<p>Figure <a href="#fig:figshiny">9</a> provides a snapshot of the features available
in MFSSA shiny-app. In the top of the side bar panel, user may specify
the basis functions (B-spline or Fourier) and the associated degrees of
freedom to represent the <code>funts</code> object. Those basis functions can be
visualized in sub-panel <span class="sans-serif">‘Basis Functions’</span> under the main
panel. The remaining inputs in the side bar will be used in other
sub-panels. Specifically ‘Groups’ is an input box for the third step of
the MFSSA algorithm. Each group is specified via a vector (e.g.
‘<code>c(1,2,4)</code>’ or ‘<code>1:3</code>’) and separated from other groups with a comma
(‘,’). The slider ‘d’ is used to specify the dimensions used in MFSSA
(scree, W-correlation, paired, singular vectors &amp; functions, and
periodogram plots). The check-box (a) ‘Demean’ is used to subtract the
mean to obtain mean-zero functions; (b) ‘Dbl Range’ is used to extend
the y-axis to cover all potential mirror functions (e.g. sometime FPCs
may get multiply by a negative sign); and (c) ‘Univ. FSSA’ to compare
the MFSSA results with marginal FSSA ones respectively. The ‘Win.L.’
slider specify the window lengths for the MSSA and the MFSSA. The ‘run
M(F)SSA’ button is used to run MSSA and MFSSA using the specified
parameters for the given dataset. In general, for the side bar, the top
inputs (above the red line) are mostly to describe the basis functions.
The bottom inputs (below the red line) are used to specify SSA and FSSA
parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figshiny"></span>
<img src="figures/shiny.png" alt="graphic without alt text" width="100%" />
<p class="caption">
Figure 9: Snapshot of the MFSSA shiny-app
</p>
</div>
</div>
<p>The main panel includes five sub-panels. Here we briefly describe the
features in each of these sub-panels:</p>
<ul>
<li><p><span class="sans-serif">‘Input Data’</span>: In this sub-panel user can either (a)
use the functional datasets available in the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package (e.g,
<code>Callcenter</code> data or remote sensing datasets); (b) simulate MFTS
<span class="citation" data-cites="haghbin2021">(see <a href="#ref-haghbin2021" role="doc-biblioref">Haghbin et al. 2021</a> for details on simulation setup)</span>; or (c) upload
any arbitrary FTS matrix (where FTS are given in common grid-points
and are represented in the columns of the data matrix) to provide
the dataset and then analyze it.</p></li>
<li><p><span class="sans-serif">‘Basis Functions’</span>: As described before we illustrate
the basis functions selected by user in this sub-panel.</p></li>
<li><p><span class="sans-serif">‘Data Analysis’</span>: In this sub-panel user can call
variety of tools to</p>
<ul>
<li><p>visualize the MFTS.</p></li>
<li><p>obtain the optimal number of basis functions based on the GCV
criteria.</p></li>
<li><p>select variety of outputs under MSSA and MFSSA, that includes
scree plot, W-correlation plot, paired plots, singular vectors
plots, periodogram plots, singular functions (heat or regular
plots), and reconstruction of FTS using different type of plots
(heat, regular, 3Dline and 3Dsurface). An example of the 3Dline
reconstruction plot for the <code>Callcenter</code> data is given in Figure
<a href="#fig:figshiny">9</a>.</p></li>
</ul></li>
<li><p><span class="sans-serif">‘Forecasting’</span>: This sub-panel would be accessible
after user runs the MFSSA procedure, and it includes the
functionalities of R-forecasting and V-forecasting algorithms.</p></li>
<li><p><span class="sans-serif">‘Manual’</span>: This sub-panel provides a brief instruction
manual to use the MFSSA shiny-app.</p></li>
</ul>
<h3 data-number="7" id="sec:conclusion"><span class="header-section-number">7</span> Summary and conclusion</h3>
<p>In summary, <strong>Rfssa</strong> is a pioneering package that brings the power of
SSA to the realm of functional time series, offering novel techniques
for decomposition, reconstruction, multivariate analysis, and functional
forecasting. Its flexible data representation and functional context for
SSA make it a valuable addition to the CRAN ecosystem, providing unique
capabilities not readily available in other packages.</p>
<p>Notably, the package offers extensive capabilities for analyzing
FTS/MFTS data, allowing joint analysis of smoothed curves and image data
across different dimensional domains. The implementations of the
methodologies in the package have been optimized for speed by leveraging
the functionalities of
<a href="https://CRAN.R-project.org/package=RcppEigen"><strong>RcppEigen</strong></a> and
<a href="https://CRAN.R-project.org/package=RSpectra"><strong>RSpectra</strong></a> R packages,
along with custom <span class="sans-serif">C++</span> code. By utilizing the
<a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a> package,
researchers and practitioners can easily apply advanced FSSA-based
techniques to their data, yielding informative results that can
significantly enhance decision-making across various applied domains.
The intuitive nature and computational efficiency of the package make it
a valuable asset for the FTS analysis toolkit.</p>
<h3 class="unnumbered" id="acknowledgments">Acknowledgments</h3>
<p>The authors would like to express their sincere gratitude to the
anonymous reviewers for their valuable feedback and constructive
comments, which greatly contributed to the improvement of this work.
Additionally, we would like to acknowledge the significant contributions
of Dr. S. Morteza Najibi during the development stages of the first
version of the <a href="https://CRAN.R-project.org/package=Rfssa"><strong>Rfssa</strong></a>
package.</p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="8" id="supplementary-materials"><span class="header-section-number">8</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2024-019.zip">RJ-2024-019.zip</a></p>
<h3 class="appendix" data-number="9" id="cran-packages-used"><span class="header-section-number">9</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=fda">fda</a>, <a href="https://cran.r-project.org/package=funFEM">funFEM</a>, <a href="https://cran.r-project.org/package=fda.usc">fda.usc</a>, <a href="https://cran.r-project.org/package=refund">refund</a>, <a href="https://cran.r-project.org/package=fdapace">fdapace</a>, <a href="https://cran.r-project.org/package=funData">funData</a>, <a href="https://cran.r-project.org/package=ftsspec">ftsspec</a>, <a href="https://cran.r-project.org/package=rainbow">rainbow</a>, <a href="https://cran.r-project.org/package=ftsa">ftsa</a>, <a href="https://cran.r-project.org/package=fdasrvf">fdasrvf</a>, <a href="https://cran.r-project.org/package=roahd">roahd</a>, <a href="https://cran.r-project.org/package=Rfssa">Rfssa</a>, <a href="https://cran.r-project.org/package=Rcpp">Rcpp</a>, <a href="https://cran.r-project.org/package=RcppArmadillo">RcppArmadillo</a>, <a href="https://cran.r-project.org/package=Rssa">Rssa</a>, <a href="https://cran.r-project.org/package=ASSA">ASSA</a></p>
<h3 class="appendix" data-number="10" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">10</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Cluster">Cluster</a>, <a href="https://cran.r-project.org/view=FunctionalData">FunctionalData</a>, <a href="https://cran.r-project.org/view=HighPerformanceComputing">HighPerformanceComputing</a>, <a href="https://cran.r-project.org/view=NumericalMathematics">NumericalMathematics</a>, <a href="https://cran.r-project.org/view=TimeSeries">TimeSeries</a></p>
<h3 class="appendix" data-number="11" id="note"><span class="header-section-number">11</span> Note</h3>
<p>This article is converted from a Legacy LaTeX article using the
<a href="https://cran.r-project.org/package=texor">texor</a> package.
The pdf version is the official version. To report a problem with the html,
refer to CONTRIBUTE on the R Journal homepage.</p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-funFEMpackage" class="csl-entry" role="listitem">
C. Bouveyron. <em>funFEM: Clustering in the discriminative functional subspace.</em> 2021. URL <a href="https://CRAN.R-project.org/package=funFEM">https://CRAN.R-project.org/package=funFEM</a>. R package version 1.2.
</div>
<div id="ref-ASSApackage" class="csl-entry" role="listitem">
M. de Carvalho and G. Martos. <em>ASSA: Applied singular spectrum analysis.</em> 2020. URL <a href="https://CRAN.R-project.org/package=ASSA">https://CRAN.R-project.org/package=ASSA</a>. R package version 2.0.
</div>
<div id="ref-deCarvalho2017realtime" class="csl-entry" role="listitem">
M. de Carvalho and A. Rua. Real-time nowcasting the US output gap: Singular spectrum analysis at work. <em>International Journal of Forecasting</em>, 33(1): 185–198, 2017.
</div>
<div id="ref-fdauscpackage" class="csl-entry" role="listitem">
M. Febrero-Bandle and M. O. de la Fuente. Statistical computing in functional data analysis: The <span class="sans-serif">r</span> package. <em>Journal of Statistical Software</em>, 51(4): 1–28, 2012. DOI <a href="https://doi.org/10.18637/jss.v051.i04">10.18637/jss.v051.i04</a>.
</div>
<div id="ref-fdapacepackage" class="csl-entry" role="listitem">
A. Gajardo, S. Bhattacharjee, C. Carroll, Y. Chen, X. Dai, J. Fan, P. Z. Hadjipantelis, K. Han, H. Ji, C. Zhu, et al. <em>Fdapace: Functional data analysis and empirical dynamics.</em> 2022. URL <a href="https://CRAN.R-project.org/package=fdapace">https://CRAN.R-project.org/package=fdapace</a>. R package version 0.5.9.
</div>
<div id="ref-refundpackage" class="csl-entry" role="listitem">
J. Goldsmith, F. Scheipl, L. Huang, J. Wrobel, C. Di, J. Gellar, J. Harezlak, M. W. McLean, B. Swihart, L. Xiao, et al. <em>Refund: Regression with functional data.</em> 2023. URL <a href="https://CRAN.R-project.org/package=refund">https://CRAN.R-project.org/package=refund</a>. R package version 0.1.32.
</div>
<div id="ref-rssapackage" class="csl-entry" role="listitem">
N. Golyandina, A. Korobeynikov, A. Shlemov and K. Usevich. <span class="nocase">Multivariate and 2D extensions of the <span>Rssa</span> package</span>. <em>Journal of Statistical Software</em>, 67(2): 1–78, 2015. URL <a href="http://dx.doi.org/10.18637/jss.v067.i02">http://dx.doi.org/10.18637/jss.v067.i02</a>.
</div>
<div id="ref-golyandina2018singular" class="csl-entry" role="listitem">
N. Golyandina, A. Korobeynikov and A. Zhigljavsky. <em>Singular spectrum analysis with r.</em> Springer Berlin Heidelberg, 2018.
</div>
<div id="ref-golyandina2001" class="csl-entry" role="listitem">
N. Golyandina, V. Nekrutkin and A. A. Zhigljavsky. <em><span class="nocase">Analysis of Time Series Structure: SSA and Related Techniques</span>.</em> Chapman; Hall/CRC, Boca Raton, FL, 2001.
</div>
<div id="ref-golyandina2013" class="csl-entry" role="listitem">
N. Golyandina and A. Zhigljavsky. <em><span class="nocase">Singular Spectrum Analysis for Time Series</span>.</em> Springer Science &amp; Business Media, Berlin, Heidelberg, 2013.
</div>
<div id="ref-haghbin2021" class="csl-entry" role="listitem">
H. Haghbin, S. Morteza Najibi, R. Mahmoudvand, J. Trinka and M. Maadooliat. Functional singular spectrum analysis. <em>Stat</em>, e330, 2021. DOI <a href="https://doi.org/10.1002/sta4.330">https://doi.org/10.1002/sta4.330</a>. e330 STAT-20-0240.R1.
</div>
<div id="ref-rfssapackage" class="csl-entry" role="listitem">
H. Haghbin, J. Trinka, S. M. Najibi and M. Maadooliat. <em>Rfssa: Functional singular spectrum analysis.</em> 2023. URL <a href="https://CRAN.R-project.org/package=Rfssa">https://CRAN.R-project.org/package=Rfssa</a>. R package version 3.0.2.
</div>
<div id="ref-funDatapackage" class="csl-entry" role="listitem">
C. Happ-Kurz. Object-oriented software for functional data. <em>Journal of Statistical Software</em>, 93(5): 1–38, 2020. DOI <a href="https://doi.org/10.18637/jss.v093.i05">10.18637/jss.v093.i05</a>.
</div>
<div id="ref-hassani2013" class="csl-entry" role="listitem">
H. Hassani and R. Mahmoudvand. Multivariate singular spectrum analysis: A general view and new vector forecasting approach. <em>International Journal of Energy and Statistics</em>, 01(01): 55–83, 2013. URL <a href="https://doi.org/10.1142/S2335680413500051">https://doi.org/10.1142/S2335680413500051</a>.
</div>
<div id="ref-horn2012matrix" class="csl-entry" role="listitem">
R. A. Horn and C. R. Johnson. <em>Matrix analysis.</em> Cambridge University Press, 2012.
</div>
<div id="ref-ftsapackage" class="csl-entry" role="listitem">
R. Hyndman and H. L. Shang. <em><span class="nocase">ftsa: Functional Time Series Analysis</span>.</em> 2023. URL <a href="https://CRAN.R-project.org/package=ftsa">https://CRAN.R-project.org/package=ftsa</a>. R package version 6.3.0.
</div>
<div id="ref-maadooliat2015integrating" class="csl-entry" role="listitem">
M. Maadooliat, J. Z. Huang and J. Hu. Integrating data transformation in principal components analysis. <em>Journal of Computational and Graphical Statistics</em>, 24(1): 84–103, 2015.
</div>
<div id="ref-ramsay2005" class="csl-entry" role="listitem">
J. O. Ramsay and B. W. Silverman. <em><span>Functional Data Analysis</span>.</em> New York, NY, 2005. URL <a href="http://0-search.ebscohost.com.libus.csd.mu.edu/login.aspx?direct=true&amp;db=cat06952a&amp;AN=mul.b2395232&amp;site=eds-live">http://0-search.ebscohost.com.libus.csd.mu.edu/login.aspx?direct=true&amp;db=cat06952a&amp;AN=mul.b2395232&amp;site=eds-live</a>.
</div>
<div id="ref-fdapackage" class="csl-entry" role="listitem">
J. O. Ramsay, H. Wickham, S. Graves and G. Hooker. <em><span class="nocase">fda: Functional Data Analysis</span>.</em> 2023. URL <a href="https://CRAN.R-project.org/package=fda">https://CRAN.R-project.org/package=fda</a>. R package version 6.1.4.
</div>
<div id="ref-rainbowpackage" class="csl-entry" role="listitem">
H. L. Shang and R. Hyndman. <em>Rainbow: Rainbow plots, bagplots and boxplots for functional data.</em> 2022. URL <a href="https://CRAN.R-project.org/package=rainbow">https://CRAN.R-project.org/package=rainbow</a>. R package version 3.7.
</div>
<div id="ref-ftsspecpackage" class="csl-entry" role="listitem">
S. Tavakoli. <em><span class="nocase">ftsspec: Spectral Density Estimation and Comparison for Functional Time Series</span>.</em> 2015. URL <a href="https://CRAN.R-project.org/package=ftsspec">https://CRAN.R-project.org/package=ftsspec</a>. R package version 1.0.0.
</div>
<div id="ref-trinka2022multivariate" class="csl-entry" role="listitem">
J. Trinka, H. Haghbin and M. Maadooliat. Multivariate functional singular spectrum analysis: A nonparametric approach for analyzing multivariate functional time series. In <em>Innovations in multivariate statistical modeling: Navigating theoretical and multidisciplinary domains</em>, pages. 187–221 2022. Springer.
</div>
<div id="ref-trinka2023functional" class="csl-entry" role="listitem">
J. Trinka, H. Haghbin, H. L. Shang and M. Maadooliat. Functional time series forecasting: Functional singular spectrum analysis approaches. <em>Stat</em>, 12(1): e621, 2023. URL <a href="https://doi.org/10.1002/sta4.621">https://doi.org/10.1002/sta4.621</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Haghbin, et al., "Rfssa: An R Package for Functional Singular Spectrum Analysis", The R Journal, 2025</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2024-019,
  author = {Haghbin, Hossein and Trinka, Jordan and Maadooliat, Mehdi},
  title = {Rfssa: An R Package for Functional Singular Spectrum Analysis},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2024-019},
  doi = {10.32614/RJ-2024-019},
  volume = {16},
  issue = {2},
  issn = {2073-4859},
  pages = {82-98}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
