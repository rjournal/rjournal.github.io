<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration</title>

<meta property="description" itemprop="description" content="This paper introduces an R package singR that implements Simultaneous non-Gaussian Component Analysis (SING) for data integration. SING uses a non-Gaussian measure of information to extract feature loadings and scores (latent variables) that are shared across multiple datasets. We describe the functions implemented in singR and showcase their use on two examples. The first example is a toy example working with images. The second example is a simulated study integrating functional connectivity estimates from a resting-state functional magnetic resonance imaging dataset and task activation maps from a working memory functional magnetic resonance imaging dataset. The SING model can produce joint components that accurately reflect information shared by multiple datasets, particularly for datasets with non-Gaussian features such as neuroimaging."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2023-084/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2024-04-11"/>
<meta property="article:created" itemprop="dateCreated" content="2024-04-11"/>
<meta name="article:author" content="Liangkang Wang"/>
<meta name="article:author" content="Irina Gaynanova"/>
<meta name="article:author" content="Benjamin Risk"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This paper introduces an R package singR that implements Simultaneous non-Gaussian Component Analysis (SING) for data integration. SING uses a non-Gaussian measure of information to extract feature loadings and scores (latent variables) that are shared across multiple datasets. We describe the functions implemented in singR and showcase their use on two examples. The first example is a toy example working with images. The second example is a simulated study integrating functional connectivity estimates from a resting-state functional magnetic resonance imaging dataset and task activation maps from a working memory functional magnetic resonance imaging dataset. The SING model can produce joint components that accurately reflect information shared by multiple datasets, particularly for datasets with non-Gaussian features such as neuroimaging."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2023-084/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2023-084/figures/Original_data_figure.png"/>
<meta property="og:image:width" content="7200"/>
<meta property="og:image:height" content="4800"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration"/>
<meta property="twitter:description" content="This paper introduces an R package singR that implements Simultaneous non-Gaussian Component Analysis (SING) for data integration. SING uses a non-Gaussian measure of information to extract feature loadings and scores (latent variables) that are shared across multiple datasets. We describe the functions implemented in singR and showcase their use on two examples. The first example is a toy example working with images. The second example is a simulated study integrating functional connectivity estimates from a resting-state functional magnetic resonance imaging dataset and task activation maps from a working memory functional magnetic resonance imaging dataset. The SING model can produce joint components that accurately reflect information shared by multiple datasets, particularly for datasets with non-Gaussian features such as neuroimaging."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2023-084/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2023-084/figures/Original_data_figure.png"/>
<meta property="twitter:image:width" content="7200"/>
<meta property="twitter:image:height" content="4800"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-084"/>
<meta name="citation_pdf_url" content="RJ-2023-084.pdf"/>
<meta name="citation_volume" content="15"/>
<meta name="citation_issue" content="4"/>
<meta name="citation_doi" content="10.32614/RJ-2023-084"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="69"/>
<meta name="citation_lastpage" content="83"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2024/04/11"/>
<meta name="citation_publication_date" content="2024/04/11"/>
<meta name="citation_author" content="Liangkang Wang"/>
<meta name="citation_author_institution" content="Brown University"/>
<meta name="citation_author" content="Irina Gaynanova"/>
<meta name="citation_author_institution" content="University of Michigan"/>
<meta name="citation_author" content="Benjamin Risk"/>
<meta name="citation_author_institution" content="Emory University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Multimodal fusion of brain imaging data: A key to finding the missing link(s) in complex mental illness;citation_volume=1;citation_issn=2451-9022 (Print)&#10;2451-9022;citation_author=V. D. Calhoun;citation_author=J. Sui"/>
  <meta name="citation_reference" content="citation_title=A review of multivariate methods for multimodal fusion of brain imaging data;citation_volume=204;citation_issn=0165-0270 (Print)&#10;0165-0270;citation_author=J. Sui;citation_author=T. Adali;citation_author=Q. Yu;citation_author=J. Chen;citation_author=V. D. Calhoun"/>
  <meta name="citation_reference" content="citation_title=Linked component analysis from matrices to high-order tensors: Applications to biomedical data;citation_volume=104;citation_author=Guoxu Zhou;citation_author=Qibin Zhao;citation_author=Yu Zhang;citation_author=Tülay Adalı;citation_author=Shengli Xie;citation_author=Andrzej Cichocki"/>
  <meta name="citation_reference" content="citation_title=A CCA+ICA based model for multi-task brain imaging data fusion and its application to schizophrenia;citation_volume=51;citation_issn=1053-8119;citation_author=Jing Sui;citation_author=Tülay Adali;citation_author=Godfrey Pearlson;citation_author=Honghui Yang;citation_author=Scott R. Sponheim;citation_author=Tonya White;citation_author=Vince D. Calhoun"/>
  <meta name="citation_reference" content="citation_title=Mapping the functional connectome traits of levels of consciousness;citation_volume=148;citation_issn=1053-8119;citation_author=Enrico Amico;citation_author=Daniele Marinazzo;citation_author=Carol Di Perri;citation_author=Lizette Heine;citation_author=Jitka Annen;citation_author=Charlotte Martial;citation_author=Mario Dzemidzic;citation_author=Murielle Kirsch;citation_author=Vincent Bonhomme;citation_author=Steven Laureys;citation_author=Joaquín Goñi"/>
  <meta name="citation_reference" content="citation_title=A review of group ICA for fMRI data and ICA for joint inference of imaging, genetic, and ERP data;citation_volume=45;citation_issn=1053-8119 (Print)&#10;1053-8119;citation_author=V. D. Calhoun;citation_author=J. Liu;citation_author=T. Adali"/>
  <meta name="citation_reference" content="citation_title=Method for multimodal analysis of independent source differences in schizophrenia: Combining gray matter structural and auditory oddball functional data;citation_volume=27;citation_issn=1065-9471 (Print)&#10;1065-9471;citation_author=V. D. Calhoun;citation_author=T. Adali;citation_author=N. R. Giuliani;citation_author=J. J. Pekar;citation_author=K. A. Kiehl;citation_author=G. D. Pearlson"/>
  <meta name="citation_reference" content="citation_title=A method for multitask fMRI data fusion applied to schizophrenia;citation_volume=27;citation_issn=1065-9471 (Print)&#10;1065-9471;citation_author=V. D. Calhoun;citation_author=T. Adali;citation_author=K. A. Kiehl;citation_author=R. Astur;citation_author=J. J. Pekar;citation_author=G. D. Pearlson"/>
  <meta name="citation_reference" content="citation_title=Discriminating schizophrenia and bipolar disorder by fusing fMRI and DTI in a multimodal CCA+ joint ICA model;citation_volume=57;citation_issn=1053-8119 (Print)&#10;1053-8119;citation_author=J. Sui;citation_author=G. Pearlson;citation_author=A. Caprihan;citation_author=T. Adali;citation_author=K. A. Kiehl;citation_author=J. Liu;citation_author=J. Yamamoto;citation_author=V. D. Calhoun"/>
  <meta name="citation_reference" content="citation_title=A three-way parallel ICA approach to analyze links among genetics, brain structure and brain function;citation_volume=98;citation_issn=1053-8119 (Print)&#10;1053-8119;citation_author=V. M. Vergara;citation_author=A. Ulloa;citation_author=V. D. Calhoun;citation_author=D. Boutte;citation_author=J. Chen;citation_author=J. Liu"/>
  <meta name="citation_reference" content="citation_title=Linear non-gaussian component analysis via maximum likelihood;citation_publisher=Taylor &amp; Francis;citation_volume=114;citation_author=Benjamin B. Risk;citation_author=David S. Matteson;citation_author=David Ruppert"/>
  <meta name="citation_reference" content="citation_title=Simultaneous non-gaussian component analysis (SING) for data integration in neuroimaging;citation_volume=15;citation_author=Benjamin B. Risk;citation_author=Irina Gaynanova"/>
  <meta name="citation_reference" content="citation_title=Investigations into resting-state connectivity using independent component analysis;citation_publisher=The Royal Society London;citation_volume=360;citation_author=Christian F Beckmann;citation_author=Marilena DeLuca;citation_author=Joseph T Devlin;citation_author=Stephen M Smith"/>
  <meta name="citation_reference" content="citation_title=steadyICA: ICA and tests of independence via multivariate distance covariance;citation_author=Benjamin B. Risk;citation_author=Nicholas A. James;citation_author=David S. Matteson"/>
  <meta name="citation_reference" content="citation_title=Ica: Independent component analysis;citation_author=Nathaniel E. Helwig"/>
  <meta name="citation_reference" content="citation_title=fastICA: FastICA algorithms to perform ICA and projection pursuit;citation_author=J L Marchini;citation_author=C Heaton;citation_author=B D Ripley"/>
  <meta name="citation_reference" content="citation_title=Blind source separation based on joint diagonalization in R: The packages JADE and BSSasymp;citation_volume=76;citation_author=Jari Miettinen;citation_author=Klaus Nordhausen;citation_author=Sara Taskinen"/>
  <meta name="citation_reference" content="citation_title=R.jive: Perform JIVE decomposition for multi-source data;citation_author=Michael J. O’Connell;citation_author=Eric F. Lock"/>
  <meta name="citation_reference" content="citation_title=templateICAr;citation_doi=10.1080/01621459.2019.1679638;citation_author=Amanda F Mejia;citation_author=Mary Beth Nebel;citation_author=Tikai Wang;citation_author=Brian S Caffo;citation_author=Ying Guo"/>
  <meta name="citation_reference" content="citation_title=singR;citation_author=Liangkang Wang;citation_author=Irina Gaynanova;citation_author=Benjamin B. Risk"/>
  <meta name="citation_reference" content="citation_title=Group linear non-gaussian component analysis with applications to neuroimaging;citation_publisher=Elsevier;citation_volume=171;citation_author=Yuxuan Zhao;citation_author=David S Matteson;citation_author=Stewart H Mostofsky;citation_author=Mary Beth Nebel;citation_author=Benjamin B Risk"/>
  <meta name="citation_reference" content="citation_title=ICtest: Estimating and testing the number of interesting components in linear dimension reduction;citation_author=Klaus Nordhausen;citation_author=Hannu Oja;citation_author=David E. Tyler;citation_author=Joni Virta"/>
  <meta name="citation_reference" content="citation_title=A multi-modal parcellation of human cerebral cortex;citation_publisher=Nature Publishing Group;citation_volume=536;citation_author=Matthew F Glasser;citation_author=Timothy S Coalson;citation_author=Emma C Robinson;citation_author=Carl D Hacker;citation_author=John Harwell;citation_author=Essa Yacoub;citation_author=Kamil Ugurbil;citation_author=Jesper Andersson;citation_author=Christian F Beckmann;citation_author=Mark Jenkinson;citation_author=A multi-modal parcellation of human cerebral cortex"/>
  <meta name="citation_reference" content="citation_title=Determining the hierarchical architecture of the human brain using subject-level clustering of functional networks;citation_publisher=Nature Publishing Group;citation_volume=9;citation_author=Teddy J Akiki;citation_author=Chadi G Abdallah"/>
  <meta name="citation_reference" content="citation_title=Ajive: Angle based joint and individual variation explained;citation_author=Iain Carmichael"/>
  <meta name="citation_reference" content="citation_title=Angle-based joint and individual variation explained;citation_publisher=Elsevier;citation_volume=166;citation_author=Qing Feng;citation_author=Meilei Jiang;citation_author=Jan Hannig;citation_author=JS Marron"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","slug","packages","draft","preview","bibliography","CTV","output","pdf_url","citation_url","doi","creative_commons","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration"]},{"type":"character","attributes":{},"value":["This paper introduces an R package singR that implements Simultaneous non-Gaussian Component Analysis (SING) for data integration. SING uses a non-Gaussian measure of information to extract feature loadings and scores (latent variables) that are shared across multiple datasets. We describe the functions implemented in singR and showcase their use on two examples. The first example is a toy example working with images. The second example is a simulated study integrating functional connectivity estimates from a resting-state functional magnetic resonance imaging dataset and task activation maps from a working memory functional magnetic resonance imaging dataset. The SING model can produce joint components that accurately reflect information shared by multiple datasets, particularly for datasets with non-Gaussian features such as neuroimaging."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Liangkang Wang"]},{"type":"character","attributes":{},"value":["Brown University"]},{"type":"character","attributes":{},"value":["Department of Biostatistics","Providence, Rhode Island, US"]},{"type":"character","attributes":{},"value":["0000-0003-3393-243X"]},{"type":"character","attributes":{},"value":["liangkang_wang@brown.edu"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","email","orcid_id","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Irina Gaynanova"]},{"type":"character","attributes":{},"value":["https://irinagain.github.io/"]},{"type":"character","attributes":{},"value":["irinagn@umich.edu"]},{"type":"character","attributes":{},"value":["0000-0002-4116-0268"]},{"type":"character","attributes":{},"value":["University of Michigan"]},{"type":"character","attributes":{},"value":["Department of Biostatistics","Ann Arbor, MI, US"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Benjamin Risk"]},{"type":"character","attributes":{},"value":["https://github.com/thebrisklab/"]},{"type":"character","attributes":{},"value":["Emory University"]},{"type":"character","attributes":{},"value":["Department of Biostatistics and Bioinformatics","Atlanta, Georgia, US"]},{"type":"character","attributes":{},"value":["0000-0003-1090-0777"]},{"type":"character","attributes":{},"value":["benjamin.risk@emory.edu"]}]}]},{"type":"character","attributes":{},"value":["2024-04-11"]},{"type":"character","attributes":{},"value":["2022-08-29"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[69]},{"type":"integer","attributes":{},"value":[83]}]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[4]},{"type":"character","attributes":{},"value":["RJ-2023-084"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"NULL"},{"type":"NULL"}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["singR.bib"]},{"type":"list","attributes":{},"value":[]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","legacy_pdf"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["RJ-2023-084.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-084"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-084"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/sitelib-4.4-arm64/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-084/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["extdata/new_mmp.csv","extdata/simdata.rda","extdata/template.dtseries.nii","figures/Est_SJx12_brain.png","figures/Esti_CompX.png","figures/Esti_example1.png","figures/ex2estimated_loadingsY.png","figures/ex2true_loadingsY.png","figures/MJ.png","figures/Original_data_figure.png","figures/Rlogo-5.png","figures/True_SJx12_brain.png","preamble.tex","RJ-2023-084.log","RJ-2023-084.pdf","RJ-2023-084.tex","RJ-2023-084.zip","RJournal.sty","RJwrapper.aux","RJwrapper.log","RJwrapper.out","RJwrapper.tex","Rlogo-5.png","singR_files/anchor-4.2.2/anchor.min.js","singR_files/bowser-1.9.3/bowser.min.js","singR_files/distill-2.2.21/template.v2.js","singR_files/header-attrs-2.25/header-attrs.js","singR_files/jquery-3.6.0/jquery-3.6.0.js","singR_files/jquery-3.6.0/jquery-3.6.0.min.js","singR_files/jquery-3.6.0/jquery-3.6.0.min.map","singR_files/popper-2.6.0/popper.min.js","singR_files/tippy-6.2.7/tippy-bundle.umd.min.js","singR_files/tippy-6.2.7/tippy-light-border.css","singR_files/tippy-6.2.7/tippy.css","singR_files/tippy-6.2.7/tippy.umd.min.js","singR_files/webcomponents-2.0.0/webcomponents.js","singR.bib","singR.log","singR.pdf","singR.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").first();
      if (tpar && ! tpar.hasClass("subtitle")) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration","description":"This paper introduces an R package singR that implements Simultaneous non-Gaussian Component Analysis (SING) for data integration. SING uses a non-Gaussian measure of information to extract feature loadings and scores (latent variables) that are shared across multiple datasets. We describe the functions implemented in singR and showcase their use on two examples. The first example is a toy example working with images. The second example is a simulated study integrating functional connectivity estimates from a resting-state functional magnetic resonance imaging dataset and task activation maps from a working memory functional magnetic resonance imaging dataset. The SING model can produce joint components that accurately reflect information shared by multiple datasets, particularly for datasets with non-Gaussian features such as neuroimaging.","doi":"10.32614/RJ-2023-084","authors":[{"author":"Liangkang Wang","authorURL":"#","affiliation":"Brown University","affiliationURL":"#","orcidID":"0000-0003-3393-243X"},{"author":"Irina Gaynanova","authorURL":"https://irinagain.github.io/","affiliation":"University of Michigan","affiliationURL":"#","orcidID":"0000-0002-4116-0268"},{"author":"Benjamin Risk","authorURL":"https://github.com/thebrisklab/","affiliation":"Emory University","affiliationURL":"#","orcidID":"0000-0003-1090-0777"}],"publishedDate":"2024-04-11T00:00:00.000+00:00","citationText":"Wang, et al., 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../issues/2024-1">Current</a>
<a href="../../submissions.html">Submit</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>This paper introduces an R package singR that implements Simultaneous non-Gaussian Component Analysis (SING) for data integration. SING uses a non-Gaussian measure of information to extract feature loadings and scores (latent variables) that are shared across multiple datasets. We describe the functions implemented in singR and showcase their use on two examples. The first example is a toy example working with images. The second example is a simulated study integrating functional connectivity estimates from a resting-state functional magnetic resonance imaging dataset and task activation maps from a working memory functional magnetic resonance imaging dataset. The SING model can produce joint components that accurately reflect information shared by multiple datasets, particularly for datasets with non-Gaussian features such as neuroimaging.</p></p>
</div>

<div class="d-byline">
  Liangkang Wang  (Brown University)
  
,   Irina Gaynanova <a href="https://irinagain.github.io/" class="uri">https://irinagain.github.io/</a> (University of Michigan)
  
,   Benjamin Risk <a href="https://github.com/thebrisklab/" class="uri">https://github.com/thebrisklab/</a> (Emory University)
  
<br/>2024-04-11
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Combining information across different datasets collected on the same individuals is an important task, especially in biology and medicine. For example, in neuroimaging research, combining information across different modalities, or types of imaging data, can lead to a more comprehensive picture of human brain activity. Commonly used modalities to investigate brain function include functional magnetic resonance imaging (fMRI), resting-state fMRI (rs-fMRI), diffusion MRI, structural images, electroencephalography, and positron emission tomography. Combining data from multiple modalities can result in a better understanding of the underlying biology than analyzing each modality separately <span class="citation" data-cites="RN176">(<a href="#ref-RN176" role="doc-biblioref">Calhoun and Sui 2016</a>)</span>. In previous studies, researchers use data fusion to define a set of joint components that are composed of subject scores (a vector in <span class="math inline">\(\mathbb{R}^n\)</span>, where <span class="math inline">\(n\)</span> is the number of subjects) and loadings (a vector in <span class="math inline">\(\mathbb{R}^{p_k}\)</span>, where <span class="math inline">\(p_k\)</span> is the number of variables in the <span class="math inline">\(k\)</span>th dataset). For a particular component, the subject scores are equal or strongly correlated across datasets. The loadings represent the relative importance of each variable to each component. A higher subject score implies the vector of loadings is more important in that individual.</p>
<p>Data integration approaches for neuroimaging should accommodate the distinct statistical properties of imaging data. Imaging features characterizing brain activation and intrinsic functional connectivity are substantially more non-Gaussian compared to noise. Methods employing principal component analysis (PCA) for dimension reduction and independent component analysis (ICA) have been widely used in neuroscience <span class="citation" data-cites="RN176 RN179 7373530">(<a href="#ref-RN179" role="doc-biblioref">Sui et al. 2012</a>; <a href="#ref-RN176" role="doc-biblioref">Calhoun and Sui 2016</a>; <a href="#ref-7373530" role="doc-biblioref">Zhou et al. 2016</a>)</span>. ICA maximizes the non-Gaussianity of components, which is useful for extracting interesting features from imaging data. ICA is commonly used to estimate resting-state networks <span class="citation" data-cites="beckmann2005investigations">(<a href="#ref-beckmann2005investigations" role="doc-biblioref">Beckmann et al. 2005</a>)</span>, estimate task-activated components <span class="citation" data-cites="SUI2010123">(<a href="#ref-SUI2010123" role="doc-biblioref">Sui et al. 2010</a>)</span>, and has been used to derive network structure in resting-state correlation matrices <span class="citation" data-cites="AMICO2017201">(<a href="#ref-AMICO2017201" role="doc-biblioref">Amico et al. 2017</a>)</span>. <span class="citation" data-cites="RN146">Risk and Gaynanova (<a href="#ref-RN146" role="doc-biblioref">2021</a>)</span> proposed simultaneous non-Gaussian component analysis (SING) for analyzing two datasets, which uses an objective function that maximizes the skewness and kurtosis of latent components with a penalty to enhance the similarity between subject scores. Unlike previous methods, SING does not use PCA for dimension reduction, but rather uses non-Gaussianity measured by skewness and kurtosis, which can improve feature extraction.</p>
<p>Some useful software have been developed in this area. In multimodal analysis and multitask fMRI data fusion, <strong>FIT</strong> is a Matlab toolbox that implements jointICA, parallel ICA <span class="citation" data-cites="RN184">(<a href="#ref-RN184" role="doc-biblioref">Vergara et al. 2014</a>)</span>, and multimodal/multiset CCA <span class="citation" data-cites="RN183">(<a href="#ref-RN183" role="doc-biblioref">Sui et al. 2011</a>)</span>. <strong>GIFT</strong> provides functions for conducting group ICA on fMRI data from multiple subjects from a single modality <span class="citation" data-cites="RN180 RN181 RN182">(<a href="#ref-RN181" role="doc-biblioref">Calhoun et al. 2006a</a>,<a href="#ref-RN182" role="doc-biblioref">b</a>; <a href="#ref-RN180" role="doc-biblioref">2009</a>)</span>. On the Comprehensive R Archive Network (CRAN), there are several R packages for ICA functions, including <a href="https://cran.r-project.org/package=steadyICA">steadyICA</a> <span class="citation" data-cites="steadyICA">(<a href="#ref-steadyICA" role="doc-biblioref">Risk et al. 2015</a>)</span>, <a href="https://cran.r-project.org/package=ica">ica</a> <span class="citation" data-cites="ica">(<a href="#ref-ica" role="doc-biblioref">Helwig 2018</a>)</span>, <a href="https://cran.r-project.org/package=fastICA">fastICA</a> <span class="citation" data-cites="fastICA">(<a href="#ref-fastICA" role="doc-biblioref">Marchini et al. 2021</a>)</span>, <a href="https://cran.r-project.org/package=JADE">JADE</a> <span class="citation" data-cites="JADE">(<a href="#ref-JADE" role="doc-biblioref">Miettinen et al. 2017</a>)</span>, and <a href="https://cran.r-project.org/package=templateICAr">templateICAr</a> <span class="citation" data-cites="templateICAr">(<a href="#ref-templateICAr" role="doc-biblioref">Mejia et al. 2020</a>)</span>. These R packages use different algorithms to extract non-Gaussian features but are designed for decomposing a single modality. For data integration, <strong>r.jive</strong> <span class="citation" data-cites="r.jive">(<a href="#ref-r.jive" role="doc-biblioref">O’Connell and Lock 2020</a>)</span> and <strong>ajive</strong> <span class="citation" data-cites="ajivepackage feng2018angle">(<a href="#ref-feng2018angle" role="doc-biblioref">Feng et al. 2018</a>; <a href="#ref-ajivepackage" role="doc-biblioref">Carmichael 2022</a>)</span> capture the joint variation, or variance shared between datasets, and individual variation, or variance unique to a dataset. JIVE methods use singular value decompositions, which are related to maximizing variance instead of non-Gaussianity. In this way, there exists a need for freely available software for extracting joint structure from multiple datasets using non-Gaussian measures of information.</p>
<p>This paper introduces <a href="https://cran.r-project.org/package=singR">singR</a>, an R package to implement <span class="citation" data-cites="RN146">Risk and Gaynanova (<a href="#ref-RN146" role="doc-biblioref">2021</a>)</span>. This paper is structured as follows. In Section 2, we review the Simultaneous non-Gaussian component analysis (SING) model. In Sections 3 and 4, we present the main functions in the <a href="https://cran.r-project.org/package=singR">singR</a> package and show how to utilize it for joint components estimation in two example datasets. Finally, Section 5 summarizes our conclusions.</p>
<h2 data-number="2" id="methods"><span class="header-section-number">2</span> Methods</h2>
<h3 data-number="2.1" id="linear-non-gaussian-component-analysis"><span class="header-section-number">2.1</span> Linear non-Gaussian Component Analysis</h3>
<p><em>Matrix decomposition for one dataset.</em> Based on linear non-Gaussian component analysis (LNGCA), we first summarize a matrix decomposition for a single dataset <span class="math inline">\(X\in \mathbb{R} ^{n\times p_{x}}\)</span> (<span class="math inline">\(n\)</span> subjects and <span class="math inline">\(p_{x}\)</span> features) into a non-Gaussian subspace and a Gaussian subspace.
Each row of <span class="math inline">\(X\)</span> is a vector of features from the <span class="math inline">\(i\)</span>th subject. Let <span class="math inline">\(X_{c}\)</span> denote the double-centered data matrix such that <span class="math inline">\(1^{T}X_{c}=0^{T}\)</span> and <span class="math inline">\(X_{c}1=0\)</span> where <span class="math inline">\(1\)</span> denotes the vector of ones of appropriate dimension, which has rank <span class="math inline">\(n-1\)</span> when <span class="math inline">\(p_{x}&gt;n\)</span>. Let <span class="math inline">\(I_{r_{x}}\)</span> denote the <span class="math inline">\(r_{x}\times r_{x}\)</span> identity matrix. Then define the matrix decomposition
<span class="math display" id="eq:decomp">\[\begin{equation}
X_{c}=M_{x}S_{x}+M_{N_{x}}N_{x}.
\tag{1}
\end{equation}\]</span>
Here, <span class="math inline">\(M_{x}\in \mathbb{R}^{n\times r_{x}}\)</span>, and the columns of <span class="math inline">\(M_{x}\)</span> are called subject scores. <span class="math inline">\(M_{N_{x}}\in \mathbb{R}^{n\times (n-r_{x}-1)}\)</span>, and the matrix [<span class="math inline">\(M_{x}\)</span>,<span class="math inline">\(M_{N_{x}}\)</span>] is called the mixing matrix and has rank <span class="math inline">\(n-1\)</span>. <span class="math inline">\(S_{x} \in \mathbb{R}^{r \times p_{x}}\)</span> and <span class="math inline">\(N_{x} \in \mathbb{R}^{(n-r_{x}-1) \times p_{x}}\)</span>. <span class="math inline">\(S_{x}S_{x}^{T}=p_{x}I_{r_{x}}\)</span>, <span class="math inline">\(N_{x}S_{x}^{T}=0_{(n-r_{x}-1)\times r_{x}}\)</span>. The rows of <span class="math inline">\(S_{x}\)</span> are the non-Gaussian components, and elements of <span class="math inline">\(S_{x}\)</span> are called variable loadings because <span class="math inline">\(\frac{1}{p_x} X_{c}S_{x}^{T}=M_{x}\)</span>. The rows of <span class="math inline">\(N_{x}\)</span> are the Gaussian components. The rows of <span class="math inline">\(S_{x}\)</span> have the largest non-Gaussianity, as described below.</p>
<p>This decomposition may be meaningful in neuroimaging studies because: 1) vectorized components like brain activation maps and resting-state networks have highly non-Gaussian distributions, and 2) it is often the situation that <span class="math inline">\(p_x \gg n\)</span>, i.e., the number subjects is smaller than the number of voxels or edges.</p>
<p>To achieve the matrix decomposition in <a href="#eq:decomp">(1)</a>, we need to find a separating matrix <span class="math inline">\(A_{x}\)</span> that maximizes non-Gaussianity and satisfies the constraint <span class="math inline">\(A_{x}X_{c}X_{c}^{T}A_{x}^{T}=S_{x}S_{x}^{T}=p_{x}I_{r_{x}}\)</span>. We utilize a prewhitening matrix and then reparameterize the model with a semiorthogonal separating matrix to enforce this constraint. Let <span class="math inline">\(\widehat{\Sigma}_{x}=X_{c} X_{c}^{\top} / p_{x}\)</span>. Then define the eigenvalue decomposition <span class="math inline">\(\widehat{\Sigma}_{x}=V_{x} \Lambda_{x} V_{x}^{\top}\)</span> and the prewhitening matrix <span class="math inline">\(\widehat{L}_{x}=V_{x} \Lambda_{x}^{-1 / 2} V_{x}^{\top}\)</span> (for double-centered <span class="math inline">\(X_c\)</span>, this is understood to be the square root of the generalized inverse from the non-zero eigenvalues). Note <span class="math inline">\(A_{x}=U_{x} \widehat{L}_{x}\)</span>, and it follows that <span class="math inline">\(\widehat{M}_x = \widehat{L}_x^{-}U_x^\top\)</span>, with <span class="math inline">\(\widehat{L}_x^-\)</span> denoting the generalized inverse. Let <span class="math inline">\(f()\)</span> be a measure of non-Gaussianity. Then <a href="#eq:decomp">(1)</a> is estimated using</p>
<p><span class="math display" id="eq:minU">\[\begin{equation}
\begin{split}
&amp; \underset{U_{x}}{\text{minimize}}\;\;-\sum_{l=1}^{r_{x}} f\left(u_{x l}^{\top} \widehat{L}_{x} X_{c}\right),\\
&amp; \text{subject to}\quad   U_{x} U_{x}^{\top}=I_{r_{x}},
\end{split}
\tag{2}
\end{equation}\]</span>
where <span class="math inline">\(u_{x l}^{\top}\)</span> is the <span class="math inline">\(l\)</span>th row of the <span class="math inline">\(r_{x}\times n\)</span> matrix <span class="math inline">\(U_{x}\)</span>.</p>
<p>We measure non-Gaussianity with the <strong>Jarque-Bera (JB) statistic</strong>, a combination of squared skewness and kurtosis. For a vector <span class="math inline">\(s \in \mathbb{R} ^{p}\)</span>, the JB statistic is</p>
<p><span class="math display" id="eq:jbstatistics">\[\begin{equation}
f(s)=0.8\left(\frac{1}{p} \sum_{j} s_{j}^{3}\right)^{2}+0.2\left(\frac{1}{p} \sum_{j} s_{j}^{4}-3\right)^{2}.
\tag{3}
\end{equation}\]</span></p>
<h3 data-number="2.2" id="simultaneous-non-gaussian-component-analysis-model"><span class="header-section-number">2.2</span> Simultaneous non-Gaussian component analysis model</h3>
<p><em>Matrix decomposition for two datasets.</em> We now decompose <span class="math inline">\(X \in \mathbb{R} ^{n \times p_{x}}\)</span> and <span class="math inline">\(Y \in \mathbb{R} ^{n \times p_{y}}\)</span> into a joint non-Gaussian subspace defined by shared subject score directions, individual non-Gaussian subspaces, and Gaussian subspaces. Let <span class="math inline">\(r_{j}\)</span> denote the rank of the joint non-Gaussian subspace and <span class="math inline">\(r_{x},\;r_{y}\)</span> denote the rank of the non-Gaussian subspaces for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, respectively. Define the double-centered <span class="math inline">\(X_{c}\)</span> and <span class="math inline">\(Y_{c}\)</span>, i.e., <span class="math inline">\(1^\top X_c = 0\)</span> and <span class="math inline">\(X_c 1 = 0\)</span>. In data applications, we also recommend standardizing each feature to have unit variance, as is common in PCA. The double centering with standardization requires an iterative algorithm that standardizes each feature (mean 0 variance 1 across subjects), then centers the features for a given subject (the mean of the features for a subject is 0), and repeats (typically <span class="math inline">\(&lt;10\)</span> iterations on real data suffices). The function <code>standard</code> is described in Section [3].</p>
<p>The SING matrix decomposition is</p>
<p><span class="math display" id="eq:two">\[\begin{equation}
\begin{split}
&amp; X_{c}=M_{J}D_{x}S_{Jx}+M_{Ix}S_{Ix}+M_{Nx}N_{x},\\
&amp; Y_{c}=M_{J}D_{y}S_{Jy}+M_{Iy}S_{Iy}+M_{Ny}N_{y}.
\end{split}
\tag{4}
\end{equation}\]</span>
Here, <span class="math inline">\(M_{J}\in \mathbb{R}^{n\times r_{J}}\)</span>, <span class="math inline">\(M_{I_{x}}\in \mathbb{R}^{n\times (r_{x}-r_{J})}\)</span>, <span class="math inline">\(M_{I_{y}}\in \mathbb{R}^{n\times (r_{y}-r_{J})}\)</span>, <span class="math inline">\(M_{N_{x}}\in \mathbb{R}^{n\times (n-r_{x}-1)}\)</span>, and <span class="math inline">\(M_{N_{y}}\in \mathbb{R}^{n\times (n-r_{y}-1)}\)</span>. <span class="math inline">\(D_{x}\)</span> and <span class="math inline">\(D_{y}\)</span> are diagonal and allow the scaling of <span class="math inline">\(M_J\)</span> to vary between datasets. <span class="math inline">\(S_{Jx}\)</span> are the joint non-Gaussian components, <span class="math inline">\(S_{Ix}\)</span> are the individual non-Gaussian components, and <span class="math inline">\(N_{x}\)</span> are the individual Gaussian components, respectively, for <span class="math inline">\(X\)</span>, with constraints <span class="math inline">\(S_{Jx}S_{Jx}^{T}=p_{x}I_{r_{J}}\)</span>, <span class="math inline">\(S_{Ix}S_{Ix}^{T}=p_{x}I_{r_{x}-r_{J}}\)</span>, <span class="math inline">\(S_{Jx}S_{Ix}^{T}=0_{r_J\times (r_{x}-r_J)}\)</span>, <span class="math inline">\(N_{x}S_{Jx}^{T}=0_{(n-r_{x}-1)\times r_J}\)</span>, <span class="math inline">\(N_{x}S_{Ix}^{T}=0_{(n-r_{x}-1)\times (r_{x}-r_J)}\)</span>, and similarly define the components of <span class="math inline">\(Y\)</span>.</p>
<p><em>Simultaneous non-Gaussian Component Analysis fitting and algorithm.</em> Recall the whitening matrix for <span class="math inline">\(X_{c}\)</span> is <span class="math inline">\(\widehat{L}_{x}\)</span>, and define its generalized inverse <span class="math inline">\(\widehat{L}_{x}^{-}=(X_{c}X_{c}^{T}/p_{x})^{1/2}=V_{x} \Lambda_{x}^{1/ 2} V_{x}^{\top}\)</span>. We will estimate a semiorthogonal unmixing matrix <span class="math inline">\(\widehat{U}_x\)</span> such that <span class="math inline">\(\widehat{M}_{x} = \widehat{L}_{x}^{-}\widehat{U}_{x}^{T}\)</span>. Similarly define the whitening matrix <span class="math inline">\(\widehat{L}_{y}\)</span> and <span class="math inline">\(\widehat{M}_{y}\)</span> for <span class="math inline">\(Y_{c}\)</span>. Let <span class="math inline">\(f\)</span> be the JB statistic, as defined in <a href="#eq:jbstatistics">(3)</a>. We consider</p>
<p><span class="math display" id="eq:curvilinear">\[\begin{equation}
\begin{split}
&amp; \underset{U_{x}, U_{y}}{\text{minimize}}\;\;-\sum_{l=1}^{r_{x}} f(u_{x l}^{\top} \widehat{L}_{x}X_{c})-\sum_{l=1}^{r_{y}} f(u_{y l}^{\top} \widehat{L}_{y}Y_{c})+\rho \sum_{l=1}^{r_{J}} d(\widehat{L}_{x}^{-} u_{x l}, \widehat{L}_{y}^{-} u_{y l}) \\
&amp; \text{subject to } \quad  U_{x} U_{x}^{\top}=I_{r_{x}},\; U_{y} U_{y}^{\top}=I_{r_{y}},
\end{split}
\tag{5}
\end{equation}\]</span>
where <span class="math inline">\(d(x,y)\)</span> is the chosen distance metric between vectors <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, calculated using the chordal distance: <span class="math inline">\(d(x, y)=\left\|\frac{x x^{\top}}{\|x\|_{2}^{2}}-\frac{y y^{\top}}{\|y\|_{2}^{2}}\right\|_{F}^{2}\)</span>. When columns are mean zero, the chordal distance between joint scores in the SING objective function is equal to zero when their correlation is equal to one. Larger values of the tuning parameter <span class="math inline">\(\rho\)</span> result in common <span class="math inline">\(M_J\)</span>, but smaller values result in highly correlated joint structure and could also be considered. In our examples, we match components from the separate LNGCA, determine candidate joint components from a permutation test, and then set <span class="math inline">\(\rho\)</span> equal to the sum of the JB statistics of all candidate joint loadings divided by 10, which results in <span class="math inline">\(\widehat{L}_{x}^{-} u_{x l} \approx \widehat{L}_{y}^{-} u_{y l}\)</span>, i.e., a shared <span class="math inline">\(M_J\)</span>.</p>
<p>Let <span class="math inline">\(\widehat{U}_{x}\)</span> and <span class="math inline">\(\widehat{U}_{y}\)</span> be the estimated value of <span class="math inline">\(U_{x}\)</span> and <span class="math inline">\(U_{y}\)</span> in (5). The corresponding estimated non-Gaussian components are defined as <span class="math inline">\(\widehat{S}_{x}=\widehat{U}_{x}X_{w}\)</span> and <span class="math inline">\(\widehat{S}_{y}=\widehat{U}_{x}Y_{w}\)</span>, where <span class="math inline">\(X_{w}=\widehat{L}_{x}X_{c}\)</span>, and <span class="math inline">\(Y_{w}=\widehat{L}_{y}Y_{c}\)</span>, respectively. Then the first <span class="math inline">\(r_{J}\)</span> columns of <span class="math inline">\(\widehat{M}_{x}=\widehat{L}_{x}^{-}\widehat{U}_{x}^{\top}\)</span>, scaled to unit norm, define <span class="math inline">\(\widehat{M}_{Jx}\)</span>. We can similarly define <span class="math inline">\(\widehat{M}_{Jy}\)</span>. For sufficiently large <span class="math inline">\(\rho\)</span>, <span class="math inline">\(\widehat{M}_{Jx}=\widehat{M}_{Jy}=\widehat{M}_J\)</span>, and more generally, <span class="math inline">\(\widehat{M}_J\)</span> is defined from their average. Additionally, the first <span class="math inline">\(r_{J}\)</span> rows of <span class="math inline">\(\widehat{S}_{x}\)</span> correspond to <span class="math inline">\(\widehat{S}_{Jx}\)</span>.</p>
<h2 data-number="3" id="overview-of-functions"><span class="header-section-number">3</span> Overview of functions</h2>
<p>The R package <a href="https://cran.r-project.org/package=singR">singR</a> implements simultaneous non-Gaussian component analysis for data integration in neuroimaging. Highlighted below are key functions:</p>
<p><strong>lngca</strong>: This function estimates non-Gaussian components for a single dataset. Non-Gaussian components can be estimated using the Jarque-Bera test statistic, which is the non-Gaussian measure used in SING, or using likelihood component analysis, which achieves dimension reduction while estimating the densities of non-Gaussian components <span class="citation" data-cites="risklngca">(<a href="#ref-risklngca" role="doc-biblioref">Risk et al. 2019</a>)</span>. It returns <span class="math inline">\(\widehat{U}_{x}\)</span> and <span class="math inline">\(\widehat{S}_{x}\)</span> from decomposing <span class="math inline">\(X_{c}\)</span> through <a href="#eq:minU">(2)</a>. It also returns the non-Gaussianity of each estimated component.</p>
<p><strong>standard</strong>: This function is an iterative algorithm that standardizes each feature (mean 0 variance 1 across subjects), then centers the features for a given subject (the mean of the features for a subject is 0) for the original datasets (<span class="math inline">\(\mathbb{R}^{n\times p}\)</span>), and repeats until the variance is approximately equal to 1 (typically <span class="math inline">\(&lt;10\)</span> iterations on real data suffices).</p>
<p><strong>est.M.ols</strong>: This function returns <span class="math inline">\(\widehat{M}_{x}\)</span> with input <span class="math inline">\(\widehat{S}_{x}\)</span> and <span class="math inline">\(X_{c}\)</span>.</p>
<p><strong>greedymatch</strong>: This function reorders the columns in <span class="math inline">\(\widehat{U}_{x}\)</span> to match the columns (subject scores) in <span class="math inline">\(\widehat{U}_{y}\)</span> based on the chordal distances between corresponding <span class="math inline">\(\widehat{M}_{x}\)</span> and <span class="math inline">\(\widehat{M}_{y}\)</span>.</p>
<p><strong>permTestJointRank</strong>: This function tests whether the correlation between matched columns (subject scores) is significant and returns the family wise error rate corrected p-values.</p>
<p><strong>%^%</strong>: Calculates the matrix exponential. For example, <code>A%^%0.5</code> returns a matrix square root. Used during prewhitening.</p>
<p><strong>calculateJB</strong>: This function calculates the sum of the JB statistics across components and is useful for determining the size of the penalty parameter <span class="math inline">\(\rho\)</span> (sufficiently large <span class="math inline">\(\rho\)</span> results in the chordal distance between <span class="math inline">\(M_{Jx}\)</span> and <span class="math inline">\(M_{Jy}\)</span> equal to 0). Assumes the variance of each row of the input S is equal to 1 and mean of each row is equal to 0.</p>
<p><strong>curvilinear</strong>: This function gives the final estimates of <span class="math inline">\(\widehat{U}_{x}\)</span> and <span class="math inline">\(\widehat{U}_{y}\)</span> using the curvilinear algorithm derived from <a href="#eq:curvilinear">(5)</a>. This is a pure R implementation but is slow.</p>
<p><strong>curvilinear_c</strong>: This implements the curvilinear algorithm in C++, which is faster.</p>
<p><strong>NG_number</strong>: This is a wrapper function for <code>FOBIasymp</code> from <a href="https://cran.r-project.org/package=ICtest">ICtest</a> <span class="citation" data-cites="ICtest">(<a href="#ref-ICtest" role="doc-biblioref">Nordhausen et al. 2022</a>)</span> that can be used to estimate the number of non-Gaussian components in a single dataset.</p>
<p><strong>signchange</strong>: This function makes the skewness of each row of <span class="math inline">\(\widehat{S}_{x}\)</span> positive, which is useful for visualizing non-Gaussian component loadings.</p>
<p><strong>singR</strong>: This function integrates all the functions above. We can use this function to estimate joint scores and loadings from two datasets <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> and optionally return the individual scores and loadings.</p>
<h2 data-number="4" id="examples"><span class="header-section-number">4</span> Examples</h2>
<p>To illustrate the use of <a href="https://cran.r-project.org/package=singR">singR</a>, we provide two examples.</p>
<h3 data-number="4.1" id="example-1.-the-toy-datasets-decomposition"><span class="header-section-number">4.1</span> Example 1. The toy datasets decomposition</h3>
<p>The tutorial dataset <code>exampledata</code> are included in the <a href="https://cran.r-project.org/package=singR">singR</a> package. We generate the SING model in <a href="#eq:two">(4)</a> as follows. We generate joint subject scores <span class="math inline">\(M_{J}=[m_{J1},m_{J2}]\in \mathbb{R}^{n\times2}\)</span> with <span class="math inline">\(m_{J1}\sim N(\mu_{1},I_{n})\)</span>, <span class="math inline">\(m_{J2}\sim N(\mu_{2},I_{n})\)</span>, <span class="math inline">\(\mu_{1}=(1_{24}^{\top},-1_{24}^{\top})^{\top}\)</span> and <span class="math inline">\(\mu_{2}=(-1_{24}^{\top},1_{24}^{\top})^{\top}\)</span>. We set <span class="math inline">\(D_{x}=I\)</span> and <span class="math inline">\(D_{y}=diag(-5,2)\)</span> to have differences in both sign and scale between the two datasets. We generate <span class="math inline">\(M_{Ix}\)</span> and <span class="math inline">\(M_{Iy}\)</span> similar to <span class="math inline">\(M_{J}\)</span> using iid unit variance Gaussian entries with means equal to <span class="math inline">\(\mu_{3y}=(-1_{6}^{\top},1_{6}^{\top},-1_{6}^{\top},1_{6}^{\top},-1_{6}^{\top},1_{6}^{\top}-1_{6}^{\top},-1_{6}^{\top})^{\top}\)</span>, <span class="math inline">\(\mu_{4y}=(1_{24}^{\top},-1_{24}^{\top})^{\top}\)</span>, <span class="math inline">\(\mu_{3x}=(-1_{12}^{\top},1_{12}^{\top},-1_{12}^{\top},1_{12}^{\top})^{\top}\)</span> and <span class="math inline">\(\mu_{4x}=(1_{12}^{\top},-1_{12}^{\top},1_{12}^{\top},-1_{12}^{\top})^{\top}\)</span>. These means result in various degrees of correlation between the columns of the mixing matrices. For the Gaussian noise, we generate <span class="math inline">\(M_{Nx}\)</span>, <span class="math inline">\(M_{Ny}\)</span>, <span class="math inline">\(N_{x}\)</span> and <span class="math inline">\(N_{y}\)</span> using iid standard Gaussian mean zero entries.</p>
<p>Each row of <span class="math inline">\(S_{Jx}\)</span> and <span class="math inline">\(S_{Ix}\)</span> is a vectorized image. We can reshape the loadings back to their image dimensions for visualization. The loadings <span class="math inline">\(S_{Jx}\)</span> are inspired by activation patterns found in functional MRI, and similar simulations were considered in <span class="citation" data-cites="risklngca">(<a href="#ref-risklngca" role="doc-biblioref">Risk et al. 2019</a>)</span>. The rows of <span class="math inline">\(S_{Jy}\)</span> and <span class="math inline">\(S_{Iy}\)</span> are formed from the lower diagonal of a symmetric matrix, which are inspired by ICA of correlation matrices <span class="citation" data-cites="AMICO2017201">(<a href="#ref-AMICO2017201" role="doc-biblioref">Amico et al. 2017</a>)</span>, and we can visualize the loadings by reshaping the vectors back to the symmetric matrix. The true loadings of latent non-Gaussian components are plotted in figure <a href="#fig:origin">1</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>singR</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>exampledata</span><span class='op'>)</span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>exampledata</span></span>
<span></span>
<span><span class='va'>lgrid</span> <span class='op'>=</span> <span class='fl'>33</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># Components for X</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>sjX</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>lgrid</span>, <span class='va'>lgrid</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>,</span>
<span>    xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>, main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Jx"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>",1"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>sjX</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>lgrid</span>, <span class='va'>lgrid</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>,</span>
<span>    xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>, main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Jx"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 2"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>siX</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>lgrid</span>, <span class='va'>lgrid</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>,</span>
<span>    xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>, main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Ix"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 1"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>siX</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>lgrid</span>, <span class='va'>lgrid</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>,</span>
<span>    xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>, main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Ix"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 2"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Components for Y</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/singR/man/vec2net.html'>vec2net</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>sjY</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>, xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>,</span>
<span>    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Jy"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 1"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/singR/man/vec2net.html'>vec2net</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>sjY</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>, xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>,</span>
<span>    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Jy"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 2"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/singR/man/vec2net.html'>vec2net</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>siY</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>, xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>,</span>
<span>    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Iy"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 1"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/singR/man/vec2net.html'>vec2net</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>siY</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>, xaxt <span class='op'>=</span> <span class='st'>"n"</span>, yaxt <span class='op'>=</span> <span class='st'>"n"</span>,</span>
<span>    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Iy"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 2"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:origin"></span>
<img src="figures/Original_data_figure.png" alt="True joint and individual loadings in example 1." width="100%" />
<p class="caption">
Figure 1: True joint and individual loadings in example 1.
</p>
</div>
</div>
<p><strong>Function singR performs all steps in the SING pipeline as a single function</strong></p>
<p>We first illustrate the use of the wrapper function <code>singR</code> using the default settings. We will describe optional arguments in more detail in example 2.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>example1</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/singR.html'>singR</a></span><span class='op'>(</span>dX <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dX</span>, dY <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dY</span>, individual <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><strong>Details of the SING pipeline</strong></p>
<p>We next explain each of the steps involved in SING estimation. Using these individual functions in place of the high-level <code>singR</code> function allows additional fine-tuning and can be helpful for large datasets.</p>
<p>Estimate the number of non-Gaussian components in datasets dX and dY using <code>FOBIasymp</code> from <a href="https://cran.r-project.org/package=ICtest">ICtest</a>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>n.comp.X</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/NG_number.html'>NG_number</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>dX</span><span class='op'>)</span></span>
<span><span class='va'>n.comp.Y</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/NG_number.html'>NG_number</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>dY</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Apply <code>lngca</code> separately to each dataset using the JB statistic as the measure of non-Gaussianity:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># JB on X</span></span>
<span><span class='va'>estX_JB</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/lngca.html'>lngca</a></span><span class='op'>(</span>xData <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dX</span>, n.comp <span class='op'>=</span> <span class='va'>n.comp.X</span>, whiten <span class='op'>=</span> <span class='st'>"sqrtprec"</span>,</span>
<span>    restarts.pbyd <span class='op'>=</span> <span class='fl'>20</span>, distribution <span class='op'>=</span> <span class='st'>"JB"</span><span class='op'>)</span></span>
<span><span class='va'>Uxfull</span> <span class='op'>&lt;-</span> <span class='va'>estX_JB</span><span class='op'>$</span><span class='va'>U</span></span>
<span><span class='va'>Mx_JB</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/est.M.ols.html'>est.M.ols</a></span><span class='op'>(</span>sData <span class='op'>=</span> <span class='va'>estX_JB</span><span class='op'>$</span><span class='va'>S</span>, xData <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dX</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># JB on Y</span></span>
<span><span class='va'>estY_JB</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/lngca.html'>lngca</a></span><span class='op'>(</span>xData <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dY</span>, n.comp <span class='op'>=</span> <span class='va'>n.comp.Y</span>, whiten <span class='op'>=</span> <span class='st'>"sqrtprec"</span>,</span>
<span>    restarts.pbyd <span class='op'>=</span> <span class='fl'>20</span>, distribution <span class='op'>=</span> <span class='st'>"JB"</span><span class='op'>)</span></span>
<span><span class='va'>Uyfull</span> <span class='op'>&lt;-</span> <span class='va'>estY_JB</span><span class='op'>$</span><span class='va'>U</span></span>
<span><span class='va'>My_JB</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/est.M.ols.html'>est.M.ols</a></span><span class='op'>(</span>sData <span class='op'>=</span> <span class='va'>estY_JB</span><span class='op'>$</span><span class='va'>S</span>, xData <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dY</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Use <code>greedymatch</code> to reorder <span class="math inline">\(\widehat{U}_{x}\)</span> and <span class="math inline">\(\widehat{U}_{y}\)</span> by descending matched correlations and use <code>permTestJointRank</code> to estimate the number of joint components:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>matchMxMy</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/greedymatch.html'>greedymatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>Mx_JB</span>, scale <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>My_JB</span>, scale <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>,</span>
<span>    Ux <span class='op'>=</span> <span class='va'>Uxfull</span>, Uy <span class='op'>=</span> <span class='va'>Uyfull</span><span class='op'>)</span></span>
<span><span class='va'>permJoint</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/permTestJointRank.html'>permTestJointRank</a></span><span class='op'>(</span><span class='va'>matchMxMy</span><span class='op'>$</span><span class='va'>Mx</span>, <span class='va'>matchMxMy</span><span class='op'>$</span><span class='va'>My</span><span class='op'>)</span></span>
<span><span class='va'>joint_rank</span> <span class='op'>=</span> <span class='va'>permJoint</span><span class='op'>$</span><span class='va'>rj</span></span></code></pre>
</div>
</div>
<p>For preparing input to <code>curvilinear_c</code>, manually prewhiten dX and dY to get <span class="math inline">\(\widehat{L}_{x}^{-1}\)</span> and <span class="math inline">\(\widehat{L}_{y}^{-1}\)</span>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Center X and Y</span></span>
<span><span class='va'>dX</span> <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dX</span></span>
<span><span class='va'>dY</span> <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>dY</span></span>
<span><span class='va'>n</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>dX</span><span class='op'>)</span></span>
<span><span class='va'>pX</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dX</span><span class='op'>)</span></span>
<span><span class='va'>pY</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dY</span><span class='op'>)</span></span>
<span><span class='va'>dXcentered</span> <span class='op'>&lt;-</span> <span class='va'>dX</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>dX</span><span class='op'>)</span>, <span class='va'>n</span>, <span class='va'>pX</span>, byrow <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span>
<span><span class='va'>dYcentered</span> <span class='op'>&lt;-</span> <span class='va'>dY</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>dY</span><span class='op'>)</span>, <span class='va'>n</span>, <span class='va'>pY</span>, byrow <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># For X Scale rowwise</span></span>
<span><span class='va'>est.sigmaXA</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>tcrossprod</a></span><span class='op'>(</span><span class='va'>dXcentered</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>pX</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>whitenerXA</span> <span class='op'>=</span> <span class='va'>est.sigmaXA</span> <span class='op'><a href='https://rdrr.io/pkg/singR/man/grapes-pow-grapes.html'>%^%</a></span> <span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='va'>xDataA</span> <span class='op'>=</span> <span class='va'>whitenerXA</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>dXcentered</span></span>
<span><span class='va'>invLx</span> <span class='op'>=</span> <span class='va'>est.sigmaXA</span> <span class='op'><a href='https://rdrr.io/pkg/singR/man/grapes-pow-grapes.html'>%^%</a></span> <span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># For Y Scale rowwise</span></span>
<span><span class='va'>est.sigmaYA</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>tcrossprod</a></span><span class='op'>(</span><span class='va'>dYcentered</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>pY</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>whitenerYA</span> <span class='op'>=</span> <span class='va'>est.sigmaYA</span> <span class='op'><a href='https://rdrr.io/pkg/singR/man/grapes-pow-grapes.html'>%^%</a></span> <span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='va'>yDataA</span> <span class='op'>=</span> <span class='va'>whitenerYA</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>dYcentered</span></span>
<span><span class='va'>invLy</span> <span class='op'>=</span> <span class='va'>est.sigmaYA</span> <span class='op'><a href='https://rdrr.io/pkg/singR/man/grapes-pow-grapes.html'>%^%</a></span> <span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Obtain a reasonable value for the penalty <span class="math inline">\(\rho\)</span> by calculating the JB statistics for all the joint components:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Calculate the Sx and Sy.</span></span>
<span><span class='va'>Sx</span> <span class='op'>=</span> <span class='va'>matchMxMy</span><span class='op'>$</span><span class='va'>Ux</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>joint_rank</span>, <span class='op'>]</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>xDataA</span></span>
<span><span class='va'>Sy</span> <span class='op'>=</span> <span class='va'>matchMxMy</span><span class='op'>$</span><span class='va'>Uy</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>joint_rank</span>, <span class='op'>]</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>yDataA</span></span>
<span></span>
<span><span class='co'># Calculate total JB</span></span>
<span><span class='va'>JBall</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/calculateJB.html'>calculateJB</a></span><span class='op'>(</span><span class='va'>Sx</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/calculateJB.html'>calculateJB</a></span><span class='op'>(</span><span class='va'>Sy</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Penalty used in curvilinear algorithm:</span></span>
<span><span class='va'>rho</span> <span class='op'>=</span> <span class='va'>JBall</span><span class='op'>/</span><span class='fl'>10</span></span></code></pre>
</div>
</div>
<p>Estimate <span class="math inline">\(\widehat{U}_{x}\)</span> and <span class="math inline">\(\widehat{U}_{y}\)</span> with <code>curvilinear_c</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># alpha=0.8 corresponds to JB weighting of skewness and kurtosis</span></span>
<span><span class='co'># (can customize to use different weighting):</span></span>
<span><span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span><span class='co'># tolerance:</span></span>
<span><span class='va'>tol</span> <span class='op'>=</span> <span class='fl'>1e-10</span></span>
<span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/curvilinear_c.html'>curvilinear_c</a></span><span class='op'>(</span>invLx <span class='op'>=</span> <span class='va'>invLx</span>, invLy <span class='op'>=</span> <span class='va'>invLy</span>, xData <span class='op'>=</span> <span class='va'>xDataA</span>,</span>
<span>    yData <span class='op'>=</span> <span class='va'>yDataA</span>, Ux <span class='op'>=</span> <span class='va'>matchMxMy</span><span class='op'>$</span><span class='va'>Ux</span>, Uy <span class='op'>=</span> <span class='va'>matchMxMy</span><span class='op'>$</span><span class='va'>Uy</span>, rho <span class='op'>=</span> <span class='va'>rho</span>,</span>
<span>    tol <span class='op'>=</span> <span class='va'>tol</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>, maxiter <span class='op'>=</span> <span class='fl'>1500</span>, rj <span class='op'>=</span> <span class='va'>joint_rank</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Obtain the final result:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Estimate Sx and Sy and true S matrix using rotation matrices</span></span>
<span><span class='co'># of Ux and Uy</span></span>
<span><span class='va'>Sjx</span> <span class='op'>=</span> <span class='va'>out</span><span class='op'>$</span><span class='va'>Ux</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>joint_rank</span>, <span class='op'>]</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>xDataA</span></span>
<span><span class='va'>Six</span> <span class='op'>=</span> <span class='va'>out</span><span class='op'>$</span><span class='va'>Ux</span><span class='op'>[</span><span class='op'>(</span><span class='va'>joint_rank</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>n.comp.X</span>, <span class='op'>]</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>xDataA</span></span>
<span><span class='va'>Sjy</span> <span class='op'>=</span> <span class='va'>out</span><span class='op'>$</span><span class='va'>Uy</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>joint_rank</span>, <span class='op'>]</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>yDataA</span></span>
<span><span class='va'>Siy</span> <span class='op'>=</span> <span class='va'>out</span><span class='op'>$</span><span class='va'>Uy</span><span class='op'>[</span><span class='op'>(</span><span class='va'>joint_rank</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>n.comp.Y</span>, <span class='op'>]</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>yDataA</span></span>
<span></span>
<span><span class='co'># Estimate Mj</span></span>
<span><span class='va'>Mxjoint</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>tcrossprod</a></span><span class='op'>(</span><span class='va'>invLx</span>, <span class='va'>out</span><span class='op'>$</span><span class='va'>Ux</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>joint_rank</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>Mxindiv</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>tcrossprod</a></span><span class='op'>(</span><span class='va'>invLx</span>, <span class='va'>out</span><span class='op'>$</span><span class='va'>Ux</span><span class='op'>[</span><span class='op'>(</span><span class='va'>joint_rank</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>n.comp.X</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>Myjoint</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>tcrossprod</a></span><span class='op'>(</span><span class='va'>invLy</span>, <span class='va'>out</span><span class='op'>$</span><span class='va'>Uy</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>joint_rank</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>Myindiv</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>tcrossprod</a></span><span class='op'>(</span><span class='va'>invLy</span>, <span class='va'>out</span><span class='op'>$</span><span class='va'>Uy</span><span class='op'>[</span><span class='op'>(</span><span class='va'>joint_rank</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>n.comp.Y</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># signchange to make the skewness of the rows of S positive</span></span>
<span><span class='va'>Sjx_sign</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/signchange.html'>signchange</a></span><span class='op'>(</span><span class='va'>Sjx</span>, <span class='va'>Mxjoint</span><span class='op'>)</span></span>
<span><span class='va'>Sjy_sign</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/signchange.html'>signchange</a></span><span class='op'>(</span><span class='va'>Sjy</span>, <span class='va'>Myjoint</span><span class='op'>)</span></span>
<span><span class='va'>Six_sign</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/signchange.html'>signchange</a></span><span class='op'>(</span><span class='va'>Six</span>, <span class='va'>Mxindiv</span><span class='op'>)</span></span>
<span><span class='va'>Siy_sign</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/signchange.html'>signchange</a></span><span class='op'>(</span><span class='va'>Siy</span>, <span class='va'>Myindiv</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Sjx</span> <span class='op'>=</span> <span class='va'>Sjx_sign</span><span class='op'>$</span><span class='va'>S</span></span>
<span><span class='va'>Sjy</span> <span class='op'>=</span> <span class='va'>Sjy_sign</span><span class='op'>$</span><span class='va'>S</span></span>
<span><span class='va'>Six</span> <span class='op'>=</span> <span class='va'>Six_sign</span><span class='op'>$</span><span class='va'>S</span></span>
<span><span class='va'>Siy</span> <span class='op'>=</span> <span class='va'>Siy_sign</span><span class='op'>$</span><span class='va'>S</span></span>
<span></span>
<span><span class='va'>Mxjoint</span> <span class='op'>=</span> <span class='va'>Sjx_sign</span><span class='op'>$</span><span class='va'>M</span></span>
<span><span class='va'>Myjoint</span> <span class='op'>=</span> <span class='va'>Sjy_sign</span><span class='op'>$</span><span class='va'>M</span></span>
<span><span class='va'>Mxindiv</span> <span class='op'>=</span> <span class='va'>Six_sign</span><span class='op'>$</span><span class='va'>M</span></span>
<span><span class='va'>Myindiv</span> <span class='op'>=</span> <span class='va'>Siy_sign</span><span class='op'>$</span><span class='va'>M</span></span>
<span></span>
<span><span class='va'>est.Mj</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/aveM.html'>aveM</a></span><span class='op'>(</span><span class='va'>Mxjoint</span>, <span class='va'>Myjoint</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>trueMj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>mj1 <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>mj</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, mj2 <span class='op'>=</span> <span class='va'>data</span><span class='op'>$</span><span class='va'>mj</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, number <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>48</span><span class='op'>)</span></span>
<span><span class='va'>SINGMj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>mj1 <span class='op'>=</span> <span class='va'>est.Mj</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, mj2 <span class='op'>=</span> <span class='va'>est.Mj</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, number <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>48</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Plot <span class="math inline">\(\widehat{S}_{Jx}\)</span>, <span class="math inline">\(\widehat{S}_{Jy}\)</span>, <span class="math inline">\(\widehat{S}_{Ix}\)</span>, and <span class="math inline">\(\widehat{S}_{Iy}\)</span> in figure <a href="#fig:estiexample1">2</a>.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:estiexample1"></span>
<img src="figures/Esti_example1.png" alt="Estimated joint and individual loadings in example 1." width="100%" />
<p class="caption">
Figure 2: Estimated joint and individual loadings in example 1.
</p>
</div>
</div>
<p>Plot <span class="math inline">\(\widehat{M}_J\)</span> in figure <a href="#fig:mjex1">3</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/ggpubr/'>ggpubr</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># true Mj</span></span>
<span><span class='va'>t1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>trueMj</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Subject ID"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>mj1</span>,</span>
<span>    x <span class='op'>=</span> <span class='va'>number</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True M"</span><span class='op'>[</span><span class='st'>"J"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 1"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>t2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>trueMj</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Subject ID"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>mj2</span>,</span>
<span>    x <span class='op'>=</span> <span class='va'>number</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True M"</span><span class='op'>[</span><span class='st'>"J"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 2"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># SING estimated Mj</span></span>
<span><span class='va'>S1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>SINGMj</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Subject ID"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>mj1</span>,</span>
<span>    x <span class='op'>=</span> <span class='va'>number</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"Estimated M"</span><span class='op'>[</span><span class='st'>"J"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 1"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>S2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>SINGMj</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Subject ID"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>mj2</span>,</span>
<span>    x <span class='op'>=</span> <span class='va'>number</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"Estimated M"</span><span class='op'>[</span><span class='st'>"J"</span><span class='op'>]</span> <span class='op'>*</span> <span class='st'>", 2"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html'>ggarrange</a></span><span class='op'>(</span><span class='va'>t1</span>, <span class='va'>t2</span>, <span class='va'>S1</span>, <span class='va'>S2</span>, ncol <span class='op'>=</span> <span class='fl'>2</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:mjex1"></span>
<img src="figures/MJ.png" alt="Estimated joint subject scores in example 1." width="100%" />
<p class="caption">
Figure 3: Estimated joint subject scores in example 1.
</p>
</div>
</div>
<h3 data-number="4.2" id="example-2.-mri-data-simulation"><span class="header-section-number">4.2</span> Example 2. MRI data simulation</h3>
<p>This example is a simulation inspired by the real data analysis of the Human Connectome Project from <span class="citation" data-cites="RN146">Risk and Gaynanova (<a href="#ref-RN146" role="doc-biblioref">2021</a>)</span>. <span class="math inline">\(X\)</span> are generated from <span class="math inline">\(\widehat{S}_X\)</span> from working memory task maps and <span class="math inline">\(Y\)</span> are generated from <span class="math inline">\(\widehat{S}_Y\)</span> from resting-state correlations from a previous SING analysis of the Human Connectome Project. The working memory loadings are defined on the cortical surface, which is the highly folded ribbon of gray matter forming the outer layer of the brain containing billions of neural bodies and dendrites. Large working memory loadings indicate locations in the brain that tend to work together during memory tasks. The resting-state correlation loadings are defined using a brain parcellation from <span class="citation" data-cites="glasser2016multi">(<a href="#ref-glasser2016multi" role="doc-biblioref">Glasser et al. 2016</a>)</span> and <span class="citation" data-cites="akiki2019determining">(<a href="#ref-akiki2019determining" role="doc-biblioref">Akiki and Abdallah 2019</a>)</span>. Large resting-state loadings are related to large correlations between brain regions occurring when a participant is lying in a scanner performing no task. Additional details are in <span class="citation" data-cites="RN146">(<a href="#ref-RN146" role="doc-biblioref">Risk and Gaynanova 2021</a>)</span>. For the purposes of this example, we reduce computation time by lowering the resolution of the working memory loadings in dataset X from 60,000 to 2,000. For the resting-state correlation loadings, we subset from the 360 x 360 loadings matrices formed from the 360 regions in the multimodal parcellation (MMP) to 100 x 100. To run this example, download the files in the folder <code>extdata</code> from the github repository <span class="citation" data-cites="singR_2022">(<a href="#ref-singR_2022" role="doc-biblioref">Wang et al. 2022</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Load the package</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>singR</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Read and visualize data</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='st'>"extdata/simdata.rda"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># sign change makes the skewness positive, which makes the</span></span>
<span><span class='co'># region of 'activation' yellow in the plots that follow</span></span>
<span><span class='va'>Sxtrue</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/signchange.html'>signchange</a></span><span class='op'>(</span><span class='va'>simdata</span><span class='op'>$</span><span class='va'>sjx</span><span class='op'>)</span><span class='op'>$</span><span class='va'>S</span></span>
<span><span class='va'>Sytrue</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/signchange.html'>signchange</a></span><span class='op'>(</span><span class='va'>simdata</span><span class='op'>$</span><span class='va'>sjy</span><span class='op'>)</span><span class='op'>$</span><span class='va'>S</span></span></code></pre>
</div>
</div>
<p>The <code>simdata.rda</code> have already been resampled from 32k to 2k resolution to reduce computation time. Next, we resample the background surface (i.e., template found on <span class="citation" data-cites="singR_2022">(<a href="#ref-singR_2022" role="doc-biblioref">Wang et al. 2022</a>)</span>) to the same resolution, which will allow us to plot the loadings on the cortical surface. This step uses <a href="https://cran.r-project.org/package=ciftiTools">ciftiTools</a> <span class="citation" data-cites="pham2021ciftitools">(<a href="#ref-pham2021ciftitools" role="doc-biblioref">Pham et al. 2021</a>)</span> and connectome workbench <span class="citation" data-cites="marcus2011informatics">(<a href="#ref-marcus2011informatics" role="doc-biblioref">Marcus et al. 2011</a>)</span>. To run this code, one needs to install connectome workbench, as described in (<a href="https://github.com/mandymejia/ciftiTools" class="uri">https://github.com/mandymejia/ciftiTools</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mandymejia/ciftiTools'>ciftiTools</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/ciftiTools.setOption.html'>ciftiTools.setOption</a></span><span class='op'>(</span><span class='st'>"wb_path"</span>, <span class='st'>"C:/Software/workbench"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>## the template cifti file is on</span></span>
<span><span class='co'>## https://github.com/thebrisklab/singR/tree/main/extdata.</span></span>
<span><span class='co'>## here, resample to 2k resolution.</span></span>
<span><span class='va'>xii_template</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/read_cifti.html'>read_cifti</a></span><span class='op'>(</span><span class='st'>"extdata/template.dtseries.nii"</span>, brainstructures <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>,</span>
<span>    <span class='st'>"right"</span><span class='op'>)</span>, resamp_res <span class='op'>=</span> <span class='fl'>2000</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>xii_new</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/newdata_xifti.html'>newdata_xifti</a></span><span class='op'>(</span><span class='va'>xii_template</span>, <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>Sxtrue</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/view_xifti_surface.html'>view_xifti_surface</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/select_xifti.html'>select_xifti</a></span><span class='op'>(</span><span class='va'>xii_new</span>, <span class='fl'>1</span><span class='op'>)</span>, zlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.43</span>, <span class='fl'>2.82</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'>## true S_JX1</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/view_xifti_surface.html'>view_xifti_surface</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/select_xifti.html'>select_xifti</a></span><span class='op'>(</span><span class='va'>xii_new</span>, <span class='fl'>2</span><span class='op'>)</span>, zlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.43</span>, <span class='fl'>2.82</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'>## true S_JX2</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:truex"></span>
<img src="figures/True_SJx12_brain.png" alt="True joint loadings in dataset X in example 2." width="100%" />
<p class="caption">
Figure 4: True joint loadings in dataset X in example 2.
</p>
</div>
</div>
<p>In figure <a href="#fig:truex">4</a>, the yellow regions indicate locations with large loadings. Similar plots can be created for the two individual components (not shown). When applied to fMRI activation maps, SING tends to identify small patches of cortex, similar to this figure.</p>
<p>Next, we convert the rows of <span class="math inline">\(S_{Jy}\)</span> to symmetric matrices and create plots. The nodes are organized into communities (i.e., modules) to aid visualization. SING tends to identify a single node and the connections with this node, which result in a cross-like pattern in the matrix representation. The joint loadings are plotted in figure <a href="#fig:truey">5</a> with <code>plotNetwork_change</code>, which is defined below. Similar plots can be created for the loadings from the two individual components.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># define plotNetwork_change</span></span>
<span><span class='va'>plotNetwork_change</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>component</span>, <span class='va'>title</span> <span class='op'>=</span> <span class='st'>""</span>, <span class='va'>qmin</span> <span class='op'>=</span> <span class='fl'>0.005</span>,</span>
<span>    <span class='va'>qmax</span> <span class='op'>=</span> <span class='fl'>0.995</span>, <span class='va'>path</span> <span class='op'>=</span> <span class='st'>"mmpplus.csv"</span>, <span class='va'>make.diag</span> <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'># component: vectorized network of length choose(n,2)</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span></span>
<span></span>
<span>    <span class='co'># load communities for plotting:</span></span>
<span>    <span class='va'>mmp_modules</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='va'>path</span>, header <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span>    <span class='va'>mmp_order</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>mmp_modules</span><span class='op'>$</span><span class='va'>Community_Vector</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='va'>zmin</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>component</span>, <span class='va'>qmin</span><span class='op'>)</span></span>
<span>    <span class='va'>zmax</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>component</span>, <span class='va'>qmax</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='va'>netmat</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/vec2net.html'>vec2net</a></span><span class='op'>(</span><span class='va'>component</span>, <span class='va'>make.diag</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='va'>meltsub</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/create.graph.long.html'>create.graph.long</a></span><span class='op'>(</span><span class='va'>netmat</span>, <span class='va'>mmp_order</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='va'>g2</span> <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>meltsub</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>X1</span>, <span class='va'>X2</span>, fill <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient2</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"blue"</span>, high <span class='op'>=</span> <span class='st'>"red"</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>zmin</span>,</span>
<span>            <span class='va'>zmax</span><span class='op'>)</span>, oob <span class='op'>=</span> <span class='va'>squish</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='va'>title</span>, x <span class='op'>=</span> <span class='st'>"Node 1"</span>,</span>
<span>        y <span class='op'>=</span> <span class='st'>"Node 2"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0</span>,</span>
<span>        <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='va'>loadingsummary</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>netmat</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='va'>sum</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span>    <span class='va'>loadingsum2</span> <span class='op'>=</span> <span class='va'>loadingsummary</span><span class='op'>[</span><span class='va'>mmp_order</span><span class='op'>]</span></span>
<span></span>
<span>    <span class='va'>Community</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>mmp_modules</span><span class='op'>$</span><span class='va'>Community_Label</span><span class='op'>)</span><span class='op'>[</span><span class='va'>mmp_order</span><span class='op'>]</span></span>
<span></span>
<span>    <span class='va'>g3</span> <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/qplot.html'>qplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span>, <span class='va'>loadingsum2</span>, col <span class='op'>=</span> <span class='va'>Community</span>, size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"MMP Index"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"L1 Norm of the Rows"</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>netmatfig <span class='op'>=</span> <span class='va'>g2</span>, loadingsfig <span class='op'>=</span> <span class='va'>g3</span>, netmat <span class='op'>=</span> <span class='va'>netmat</span>,</span>
<span>        loadingsummary <span class='op'>=</span> <span class='va'>loadingsummary</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='co'># plot for the true component of Y</span></span>
<span><span class='va'>path</span> <span class='op'>=</span> <span class='st'>"extdata/new_mmp.csv"</span></span>
<span><span class='va'>out_true1</span> <span class='op'>=</span> <span class='fu'>plotNetwork_change</span><span class='op'>(</span><span class='va'>Sytrue</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Jy"</span><span class='op'>]</span> <span class='op'>*</span></span>
<span>    <span class='st'>", 1"</span><span class='op'>)</span>, qmin <span class='op'>=</span> <span class='fl'>0.005</span>, qmax <span class='op'>=</span> <span class='fl'>0.995</span>, path <span class='op'>=</span> <span class='va'>path</span><span class='op'>)</span></span>
<span><span class='va'>out_true2</span> <span class='op'>=</span> <span class='fu'>plotNetwork_change</span><span class='op'>(</span><span class='va'>Sytrue</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"True S"</span><span class='op'>[</span><span class='st'>"Jy"</span><span class='op'>]</span> <span class='op'>*</span></span>
<span>    <span class='st'>", 2"</span><span class='op'>)</span>, qmin <span class='op'>=</span> <span class='fl'>0.005</span>, qmax <span class='op'>=</span> <span class='fl'>0.995</span>, path <span class='op'>=</span> <span class='va'>path</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p1</span> <span class='op'>=</span> <span class='va'>out_true1</span><span class='op'>$</span><span class='va'>netmatfig</span></span>
<span><span class='va'>p2</span> <span class='op'>=</span> <span class='va'>out_true1</span><span class='op'>$</span><span class='va'>loadingsfig</span></span>
<span><span class='va'>p3</span> <span class='op'>=</span> <span class='va'>out_true2</span><span class='op'>$</span><span class='va'>netmatfig</span></span>
<span><span class='va'>p4</span> <span class='op'>=</span> <span class='va'>out_true2</span><span class='op'>$</span><span class='va'>loadingsfig</span></span>
<span></span>
<span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='va'>p2</span>, <span class='va'>p3</span>, <span class='va'>p4</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:truey"></span>
<img src="figures/ex2true_loadingsY.png" alt="True joint loadings in dataset Y in example 2." width="100%" />
<p class="caption">
Figure 5: True joint loadings in dataset Y in example 2.
</p>
</div>
</div>
<p>In figure <a href="#fig:truey">5</a>, the left plots depict the loadings in the network space, where each element represents the strength of the connection between two nodes (i.e., regions). Then if the subject score corresponding to the component is large, the loadings make a large contribution to the subject’s functional connectivity. In our previous work, we found that the loadings for a component tend to be structured such that a single node is prominent, resulting in a cross-like pattern. To easily identify which node or nodes are prominent, the right plots depict the L1-norms of the rows of the loadings matrices. In this example, a single node stands out for each of the components. For additional interpretation, see <span class="citation" data-cites="RN146">(<a href="#ref-RN146" role="doc-biblioref">Risk and Gaynanova 2021</a>)</span>. In <span class="citation" data-cites="RN146">(<a href="#ref-RN146" role="doc-biblioref">Risk and Gaynanova 2021</a>)</span>, it was discovered that for a given joint component, the patch of cortex with largest loadings in the working memory task tended to be located in the same area as the node whose loadings have the largest L1-norm in the resting-state dataset.</p>
<p><strong>Function singR performs all steps in the SING pipeline as a single function</strong></p>
<p>In example 1, we introduced the pipeline of the SING method. We will use example 2 to explain the <code>singR</code> function in detail. The default output of <code>singR</code> is a list of <span class="math inline">\(\widehat{S}_{Jx}\)</span>, <span class="math inline">\(\widehat{S}_{Jy}\)</span>, <span class="math inline">\(\widehat{M}_{J}\)</span>, <span class="math inline">\(\widehat{M}_{Jx}\)</span>, and <span class="math inline">\(\widehat{M}_{Jy}\)</span>. By default, it will center the data such that the mean of each row is equal to zero. In our simulated dataset, all variables are on the same scale, and consequently we do not perform standardization (<code>stand=FALSE</code>). When <code>stand=TRUE</code>, the data are additionally standardized to have the mean of each column equal to zero and variance of each column equal to one, which is the standardization commonly used in PCA. If <code>n.comp.X</code> and <code>n.comp.Y</code> are not specified, <code>singR</code> will use <code>FOBIasymp</code> from <a href="https://cran.r-project.org/package=ICtest">ICtest</a> to estimate the number of non-Gaussian components in each dataset, which requires additional computational expense. Other tests of the number of non-Gaussian components accounting for spatial smoothing/autocorrelation can be found in <span class="citation" data-cites="zhao2022group">(<a href="#ref-zhao2022group" role="doc-biblioref">Zhao et al. 2022</a>)</span>. These may be more effective for spatially correlated data but are generally slower.</p>
<p>When <code>individual = TRUE</code>, the <code>singR</code> will additionally output <span class="math inline">\(\widehat{M}_{Ix}\)</span>, <span class="math inline">\(\widehat{M}_{Iy}\)</span>, <span class="math inline">\(\widehat{S}_{Ix}\)</span> and <span class="math inline">\(\widehat{S}_{Iy}\)</span>. When <code>distribution = "tiltedgaussian"</code>, non-Gaussian components will be estimated through <code>lngca</code> using likelihood component analysis, which is slower but can be more accurate. By default <code>distribution = "JB"</code>, and <code>lngca</code> will use the Jarque-Bera test statistic as the measure of non-Gaussianity of each component.</p>
<p>The <code>Cplus</code> argument determines whether to use <code>curvilinear_c</code> or <code>curvilinear</code> in <code>singR</code>. <code>curvilinear</code> is implemented with pure R but is slow while <code>curvilinear_c</code> uses C++. The parameter <code>rho_extent</code> can be one of <code>c("small", "medium", "large")</code> or a number. This determines the penalty <span class="math inline">\(\rho\)</span> in <code>curvilinear</code> or <code>curvilinear_c</code> that results in equal or highly correlated <span class="math inline">\(\widehat{M}_{Jx}\)</span> and <span class="math inline">\(\widehat{M}_{Jy}\)</span>. Additionally, we can use <code>pmse()</code> to evaluate the distance between two subject score matrices. With larger <span class="math inline">\(\rho\)</span>, the <span class="math inline">\(pmse\left(\widehat{M}_{Jx}, \widehat{M}_{Jy}\right)\)</span> value will be smaller. Usually, “small” <span class="math inline">\(\rho\)</span> is sufficient for approximately equal <span class="math inline">\(\widehat{M}_{Jx}\)</span> and <span class="math inline">\(\widehat{M}_{Jy}\)</span>. We have observed that very large <span class="math inline">\(\rho\)</span> can adversely impact the accuracy of the loadings. Our recommendation is to use “small” <span class="math inline">\(\rho\)</span> and check if it results in equal scores, and if not, then try other settings. The code below took approximately 20 seconds to run on a 2.8 GHz processor.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>example2</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/singR/man/singR.html'>singR</a></span><span class='op'>(</span>dX <span class='op'>=</span> <span class='va'>simdata</span><span class='op'>$</span><span class='va'>dX</span>, dY <span class='op'>=</span> <span class='va'>simdata</span><span class='op'>$</span><span class='va'>dY</span>, rho_extent <span class='op'>=</span> <span class='st'>"small"</span>,</span>
<span>    Cplus <span class='op'>=</span> <span class='cn'>TRUE</span>, stand <span class='op'>=</span> <span class='cn'>FALSE</span>, individual <span class='op'>=</span> <span class='cn'>TRUE</span>, distribution <span class='op'>=</span> <span class='st'>"JB"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The joint loadings <span class="math inline">\(\widehat{S}_{JX}\)</span> are depicted in figure <a href="#fig:estx2">6</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>xii_new</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/newdata_xifti.html'>newdata_xifti</a></span><span class='op'>(</span><span class='va'>xii_template</span>, <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>example2</span><span class='op'>$</span><span class='va'>Sjx</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/view_xifti_surface.html'>view_xifti_surface</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/select_xifti.html'>select_xifti</a></span><span class='op'>(</span><span class='va'>xii_new</span>, <span class='fl'>1</span><span class='op'>)</span>, zlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.43</span>, <span class='fl'>2.82</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'>## component1 small rho</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/view_xifti_surface.html'>view_xifti_surface</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ciftiTools/man/select_xifti.html'>select_xifti</a></span><span class='op'>(</span><span class='va'>xii_new</span>, <span class='fl'>2</span><span class='op'>)</span>, zlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.43</span>, <span class='fl'>2.82</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'>## component2 small rho</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:estx2"></span>
<img src="figures/Est_SJx12_brain.png" alt="Estimated joint loadings in dataset X in example 2." width="100%" />
<p class="caption">
Figure 6: Estimated joint loadings in dataset X in example 2.
</p>
</div>
</div>
<p>The joint loadings <span class="math inline">\(\widehat{S}_{Jy}\)</span> are depicted in figure <a href="#fig:esty2">7</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='va'>path</span> <span class='op'>=</span> <span class='st'>"extdata/new_mmp.csv"</span></span>
<span><span class='va'>out_rhoSmall1</span> <span class='op'>=</span> <span class='fu'>plotNetwork_change</span><span class='op'>(</span><span class='va'>example2</span><span class='op'>$</span><span class='va'>Sjy</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"Estimate S"</span><span class='op'>[</span><span class='st'>"Jy"</span><span class='op'>]</span> <span class='op'>*</span></span>
<span>    <span class='st'>", 1"</span><span class='op'>)</span>, qmin <span class='op'>=</span> <span class='fl'>0.005</span>, qmax <span class='op'>=</span> <span class='fl'>0.995</span>, path <span class='op'>=</span> <span class='va'>path</span><span class='op'>)</span></span>
<span><span class='va'>out_rhoSmall2</span> <span class='op'>=</span> <span class='fu'>plotNetwork_change</span><span class='op'>(</span><span class='va'>example2</span><span class='op'>$</span><span class='va'>Sjy</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"Estimate S"</span><span class='op'>[</span><span class='st'>"Jy"</span><span class='op'>]</span> <span class='op'>*</span></span>
<span>    <span class='st'>", 2"</span><span class='op'>)</span>, qmin <span class='op'>=</span> <span class='fl'>0.005</span>, qmax <span class='op'>=</span> <span class='fl'>0.995</span>, path <span class='op'>=</span> <span class='va'>path</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p5</span> <span class='op'>=</span> <span class='va'>out_rhoSmall1</span><span class='op'>$</span><span class='va'>netmatfig</span></span>
<span><span class='va'>p6</span> <span class='op'>=</span> <span class='va'>out_rhoSmall1</span><span class='op'>$</span><span class='va'>loadingsfig</span></span>
<span><span class='va'>p7</span> <span class='op'>=</span> <span class='va'>out_rhoSmall2</span><span class='op'>$</span><span class='va'>netmatfig</span></span>
<span><span class='va'>p8</span> <span class='op'>=</span> <span class='va'>out_rhoSmall2</span><span class='op'>$</span><span class='va'>loadingsfig</span></span>
<span></span>
<span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>p5</span>, <span class='va'>p6</span>, <span class='va'>p7</span>, <span class='va'>p8</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:esty2"></span>
<img src="figures/ex2estimated_loadingsY.png" alt="Estimated joint loadings in dataset Y in example 2." width="100%" />
<p class="caption">
Figure 7: Estimated joint loadings in dataset Y in example 2.
</p>
</div>
</div>
<h2 data-number="5" id="summary"><span class="header-section-number">5</span> Summary</h2>
<p>This paper introduces the <a href="https://cran.r-project.org/package=singR">singR</a> package and demonstrates how simultaneous non-Gaussian component analysis can be used to extract shared features from two datasets using R. The main contribution of the R package <a href="https://cran.r-project.org/package=singR">singR</a> is to provide easy code for data integration in neuroscience. We introduce the function <code>singR</code>, which combines the SING pipeline into one function that performs data standardization, estimates the number of non-Gaussian components and estimates the number of joint components. Previous analyses indicate the joint structure estimated by SING can improve upon other neuroimaging data integration methods. SING can reveal new insights by using non-Gaussianity for both dimension reduction and latent variable extraction, whereas ICA methods involve an initial PCA step that tends to aggregate features and can remove information.</p>
<h2 data-number="6" id="acknowledgments"><span class="header-section-number">6</span> Acknowledgments</h2>
<p>Research reported in this publication was supported by the National Institute of Mental Health of the National Institutes of Health under award number R01MH129855 to BBR. The research was also supported by the Division of Mathematical Sciences of the National Science Foundation under award number DMS-2044823 to IG. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health and National Science Foundation.</p>
<p>Simulated data were based on a previous analysis of data from the Human Connectome Project. These data were provided [in part] by the Human Connectome Project, WU-Minn Consortium (Principal Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH Institutes and Centers that support the NIH Blueprint for Neuroscience Research; and by the McDonnell Center for Systems Neuroscience at Washington University.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="6.1" id="supplementary-materials"><span class="header-section-number">6.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2023-084.zip">RJ-2023-084.zip</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-akiki2019determining" class="csl-entry" role="listitem">
T. J. Akiki and C. G. Abdallah. Determining the hierarchical architecture of the human brain using subject-level clustering of functional networks. <em>Scientific reports</em>, 9(1): 1–15, 2019. URL <a href="https://doi.org/10.1038/s41598-019-55738-y">https://doi.org/10.1038/s41598-019-55738-y</a>.
</div>
<div id="ref-AMICO2017201" class="csl-entry" role="listitem">
E. Amico, D. Marinazzo, C. Di Perri, L. Heine, J. Annen, C. Martial, M. Dzemidzic, M. Kirsch, V. Bonhomme, S. Laureys, et al. Mapping the functional connectome traits of levels of consciousness. <em>NeuroImage</em>, 148: 201–211, 2017. URL <a href="https://doi.org/https://doi.org/10.1016/j.neuroimage.2017.01.020">https://doi.org/https://doi.org/10.1016/j.neuroimage.2017.01.020</a>.
</div>
<div id="ref-beckmann2005investigations" class="csl-entry" role="listitem">
C. F. Beckmann, M. DeLuca, J. T. Devlin and S. M. Smith. Investigations into resting-state connectivity using independent component analysis. <em>Philosophical Transactions of the Royal Society B: Biological Sciences</em>, 360(1457): 1001–1013, 2005. URL <a href="https://doi.org/10.1098/rstb.2005.1634">https://doi.org/10.1098/rstb.2005.1634</a>.
</div>
<div id="ref-RN181" class="csl-entry" role="listitem">
V. D. Calhoun, T. Adali, N. R. Giuliani, J. J. Pekar, K. A. Kiehl and G. D. Pearlson. Method for multimodal analysis of independent source differences in schizophrenia: Combining gray matter structural and auditory oddball functional data. <em>Hum Brain Mapp</em>, 27(1): 47–62, 2006a. URL <a href="https://doi.org/10.1002/hbm.20166">https://doi.org/10.1002/hbm.20166</a>.
</div>
<div id="ref-RN182" class="csl-entry" role="listitem">
V. D. Calhoun, T. Adali, K. A. Kiehl, R. Astur, J. J. Pekar and G. D. Pearlson. A method for multitask fMRI data fusion applied to schizophrenia. <em>Hum Brain Mapp</em>, 27(7): 598–610, 2006b. URL <a href="https://doi.org/10.1002/hbm.20204">https://doi.org/10.1002/hbm.20204</a>.
</div>
<div id="ref-RN180" class="csl-entry" role="listitem">
V. D. Calhoun, J. Liu and T. Adali. A review of group ICA for fMRI data and ICA for joint inference of imaging, genetic, and ERP data. <em>Neuroimage</em>, 45(1 Suppl): S163–72, 2009. URL <a href="https://doi.org/10.1016/j.neuroimage.2008.10.057">https://doi.org/10.1016/j.neuroimage.2008.10.057</a>.
</div>
<div id="ref-RN176" class="csl-entry" role="listitem">
V. D. Calhoun and J. Sui. Multimodal fusion of brain imaging data: A key to finding the missing link(s) in complex mental illness. <em>Biol Psychiatry Cogn Neurosci Neuroimaging</em>, 1(3): 230–244, 2016. URL <a href="https://doi.org/10.1016/j.bpsc.2015.12.005">https://doi.org/10.1016/j.bpsc.2015.12.005</a>.
</div>
<div id="ref-ajivepackage" class="csl-entry" role="listitem">
I. Carmichael. <em>Ajive: Angle based joint and individual variation explained.</em> 2022. URL <a href="https://cran.r-project.org/web/packages/RaJIVE/index.html">https://cran.r-project.org/web/packages/RaJIVE/index.html</a>. R package version 0.1.0.
</div>
<div id="ref-feng2018angle" class="csl-entry" role="listitem">
Q. Feng, M. Jiang, J. Hannig and J. Marron. Angle-based joint and individual variation explained. <em>Journal of multivariate analysis</em>, 166: 241–265, 2018. URL <a href="https://doi.org/10.1016/j.jmva.2018.03.008">https://doi.org/10.1016/j.jmva.2018.03.008</a>.
</div>
<div id="ref-glasser2016multi" class="csl-entry" role="listitem">
M. F. Glasser, T. S. Coalson, E. C. Robinson, C. D. Hacker, J. Harwell, E. Yacoub, K. Ugurbil, J. Andersson, C. F. Beckmann, M. Jenkinson, et al. A multi-modal parcellation of human cerebral cortex. <em>Nature</em>, 536(7615): 171–178, 2016. URL <a href="https://doi.org/10.1038/nature18933">https://doi.org/10.1038/nature18933</a>.
</div>
<div id="ref-ica" class="csl-entry" role="listitem">
N. E. Helwig. <em>Ica: Independent component analysis.</em> 2018. URL <a href="https://CRAN.R-project.org/package=ica">https://CRAN.R-project.org/package=ica</a>. R package version 1.0-2.
</div>
<div id="ref-fastICA" class="csl-entry" role="listitem">
J. L. Marchini, C. Heaton and B. D. Ripley. <em>fastICA: FastICA algorithms to perform ICA and projection pursuit.</em> 2021. URL <a href="https://CRAN.R-project.org/package=fastICA">https://CRAN.R-project.org/package=fastICA</a>. R package version 1.2-3.
</div>
<div id="ref-marcus2011informatics" class="csl-entry" role="listitem">
D. S. Marcus, J. Harwell, T. Olsen, M. Hodge, M. F. Glasser, F. Prior, M. Jenkinson, T. Laumann, S. W. Curtiss and D. C. Van Essen. Informatics and data mining tools and strategies for the human connectome project. <em>Frontiers in neuroinformatics</em>, 5: 4, 2011. URL <a href="https://doi.org/10.3389/fninf.2011.00004/full">https://doi.org/10.3389/fninf.2011.00004/full</a>.
</div>
<div id="ref-templateICAr" class="csl-entry" role="listitem">
A. F. Mejia, M. B. Nebel, T. Wang, B. S. Caffo and Y. Guo. <span class="nocase">templateICAr</span>. 2020. URL <a href="https://github.com/github/mandymejia/templateICAr">https://github.com/github/mandymejia/templateICAr</a>.
</div>
<div id="ref-JADE" class="csl-entry" role="listitem">
J. Miettinen, K. Nordhausen and S. Taskinen. Blind source separation based on joint diagonalization in <span>R</span>: The packages <span>JADE</span> and <span>BSSasymp</span>. <em>Journal of Statistical Software</em>, 76(2): 1–31, 2017. URL <a href="https://doi.org/10.18637/jss.v076.i02">https://doi.org/10.18637/jss.v076.i02</a>.
</div>
<div id="ref-ICtest" class="csl-entry" role="listitem">
K. Nordhausen, H. Oja, D. E. Tyler and J. Virta. <em>ICtest: Estimating and testing the number of interesting components in linear dimension reduction.</em> 2022. URL <a href="https://CRAN.R-project.org/package=ICtest">https://CRAN.R-project.org/package=ICtest</a>. R package version 0.3-5.
</div>
<div id="ref-r.jive" class="csl-entry" role="listitem">
M. J. O’Connell and E. F. Lock. <em>R.jive: Perform JIVE decomposition for multi-source data.</em> 2020. URL <a href="https://CRAN.R-project.org/package=r.jive">https://CRAN.R-project.org/package=r.jive</a>. R package version 2.4.
</div>
<div id="ref-pham2021ciftitools" class="csl-entry" role="listitem">
D. D. Pham, J. Muschelli and A. F. Mejia. ciftiTools: A package for reading, writing, visualizing and manipulating CIFTI files in r. 2021. URL <a href="https://arxiv.org/abs/2106.11338">https://arxiv.org/abs/2106.11338</a>.
</div>
<div id="ref-RN146" class="csl-entry" role="listitem">
B. B. Risk and I. Gaynanova. Simultaneous non-gaussian component analysis (SING) for data integration in neuroimaging. <em>The Annals of Applied Statistics</em>, 15(3): 1431–1454, 24, 2021. URL <a href="https://doi.org/10.1214/21-AOAS1466">https://doi.org/10.1214/21-AOAS1466</a>.
</div>
<div id="ref-steadyICA" class="csl-entry" role="listitem">
B. B. Risk, N. A. James and D. S. Matteson. <em>steadyICA: ICA and tests of independence via multivariate distance covariance.</em> 2015. URL <a href="https://CRAN.R-project.org/package=steadyICA">https://CRAN.R-project.org/package=steadyICA</a>. R package version 1.0.
</div>
<div id="ref-risklngca" class="csl-entry" role="listitem">
B. B. Risk, D. S. Matteson and D. Ruppert. Linear non-gaussian component analysis via maximum likelihood. <em>Journal of the American Statistical Association</em>, 114(525): 332–343, 2019. URL <a href="https://doi.org/10.1080/01621459.2017.1407772">https://doi.org/10.1080/01621459.2017.1407772</a>.
</div>
<div id="ref-SUI2010123" class="csl-entry" role="listitem">
J. Sui, T. Adali, G. Pearlson, H. Yang, S. R. Sponheim, T. White and V. D. Calhoun. A CCA+ICA based model for multi-task brain imaging data fusion and its application to schizophrenia. <em>NeuroImage</em>, 51(1): 123–134, 2010. URL <a href="https://doi.org/10.1016/j.neuroimage.2010.01.069">https://doi.org/10.1016/j.neuroimage.2010.01.069</a>.
</div>
<div id="ref-RN179" class="csl-entry" role="listitem">
J. Sui, T. Adali, Q. Yu, J. Chen and V. D. Calhoun. A review of multivariate methods for multimodal fusion of brain imaging data. <em>J Neurosci Methods</em>, 204(1): 68–81, 2012. URL <a href="https://doi.org/10.1016/j.jneumeth.2011.10.031">https://doi.org/10.1016/j.jneumeth.2011.10.031</a>.
</div>
<div id="ref-RN183" class="csl-entry" role="listitem">
J. Sui, G. Pearlson, A. Caprihan, T. Adali, K. A. Kiehl, J. Liu, J. Yamamoto and V. D. Calhoun. Discriminating schizophrenia and bipolar disorder by fusing fMRI and DTI in a multimodal CCA+ joint ICA model. <em>Neuroimage</em>, 57(3): 839–55, 2011. URL <a href="https://doi.org/10.1016/j.neuroimage.2011.05.055">https://doi.org/10.1016/j.neuroimage.2011.05.055</a>.
</div>
<div id="ref-RN184" class="csl-entry" role="listitem">
V. M. Vergara, A. Ulloa, V. D. Calhoun, D. Boutte, J. Chen and J. Liu. A three-way parallel ICA approach to analyze links among genetics, brain structure and brain function. <em>Neuroimage</em>, 98: 386–94, 2014. URL <a href="https://doi.org/10.1016/j.neuroimage.2014.04.060">https://doi.org/10.1016/j.neuroimage.2014.04.060</a>.
</div>
<div id="ref-singR_2022" class="csl-entry" role="listitem">
L. Wang, I. Gaynanova and B. B. Risk. <span class="nocase">singR</span>. 2022. URL <a href="https://github.com/thebrisklab/singR">https://github.com/thebrisklab/singR</a>.
</div>
<div id="ref-zhao2022group" class="csl-entry" role="listitem">
Y. Zhao, D. S. Matteson, S. H. Mostofsky, M. B. Nebel and B. B. Risk. Group linear non-gaussian component analysis with applications to neuroimaging. <em>Computational Statistics &amp; Data Analysis</em>, 171: 107454, 2022. URL <a href="https://doi.org/10.1016/j.csda.2022.107454">https://doi.org/10.1016/j.csda.2022.107454</a>.
</div>
<div id="ref-7373530" class="csl-entry" role="listitem">
G. Zhou, Q. Zhao, Y. Zhang, T. Adalı, S. Xie and A. Cichocki. Linked component analysis from matrices to high-order tensors: Applications to biomedical data. <em>Proceedings of the IEEE</em>, 104(2): 310–331, 2016. URL <a href="https://doi.org/10.1109/JPROC.2015.2474704">https://doi.org/10.1109/JPROC.2015.2474704</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Wang, et al., "singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration", The R Journal, 2024</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2023-084,
  author = {Wang, Liangkang and Gaynanova, Irina and Risk, Benjamin},
  title = {singR: An R Package for Simultaneous Non-Gaussian Component Analysis for Data Integration},
  journal = {The R Journal},
  year = {2024},
  note = {https://doi.org/10.32614/RJ-2023-084},
  doi = {10.32614/RJ-2023-084},
  volume = {15},
  issue = {4},
  issn = {2073-4859},
  pages = {69-83}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
