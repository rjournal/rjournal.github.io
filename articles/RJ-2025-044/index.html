<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models</title>

<meta property="description" itemprop="description" content="The MultiATSM package provides estimation tools and a wide range of outputs for eight macrofinance affine term structure model (ATSM) classes, supporting practitioners, academics, and policymakers. All models extend the single-country framework of Joslin et al. (2014) to multicountry settings, with additional adaptations from Jotikasthira et al. (2015) and Candelon and Moura (2024). These model extensions incorporate, respectively, the presence of a dominant (global) economy and adopt a global vector autoregressive (GVAR) setup to capture the joint dynamics of risk factors. The package generates diverse outputs for each ATSM, including graphical representations of model fit, risk premia, impulse response functions, and forecast error variance decompositions. It also implements bootstrap methods for confidence intervals and produces bond yield forecasts."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2025-044/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2026-01-07"/>
<meta property="article:created" itemprop="dateCreated" content="2026-01-07"/>
<meta name="article:author" content="Rubens Moura"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="The MultiATSM package provides estimation tools and a wide range of outputs for eight macrofinance affine term structure model (ATSM) classes, supporting practitioners, academics, and policymakers. All models extend the single-country framework of Joslin et al. (2014) to multicountry settings, with additional adaptations from Jotikasthira et al. (2015) and Candelon and Moura (2024). These model extensions incorporate, respectively, the presence of a dominant (global) economy and adopt a global vector autoregressive (GVAR) setup to capture the joint dynamics of risk factors. The package generates diverse outputs for each ATSM, including graphical representations of model fit, risk premia, impulse response functions, and forecast error variance decompositions. It also implements bootstrap methods for confidence intervals and produces bond yield forecasts."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2025-044/"/>
<meta property="og:image" content="https://journal.r-project.org/articles/RJ-2025-044/RJ-2025-044_files/figure-html5/pca-H-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="960"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models"/>
<meta property="twitter:description" content="The MultiATSM package provides estimation tools and a wide range of outputs for eight macrofinance affine term structure model (ATSM) classes, supporting practitioners, academics, and policymakers. All models extend the single-country framework of Joslin et al. (2014) to multicountry settings, with additional adaptations from Jotikasthira et al. (2015) and Candelon and Moura (2024). These model extensions incorporate, respectively, the presence of a dominant (global) economy and adopt a global vector autoregressive (GVAR) setup to capture the joint dynamics of risk factors. The package generates diverse outputs for each ATSM, including graphical representations of model fit, risk premia, impulse response functions, and forecast error variance decompositions. It also implements bootstrap methods for confidence intervals and produces bond yield forecasts."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2025-044/"/>
<meta property="twitter:image" content="https://journal.r-project.org/articles/RJ-2025-044/RJ-2025-044_files/figure-html5/pca-H-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="960"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-044"/>
<meta name="citation_pdf_url" content="RJ-2025-044.pdf"/>
<meta name="citation_volume" content="17"/>
<meta name="citation_issue" content="4"/>
<meta name="citation_doi" content="10.32614/RJ-2025-044"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="275"/>
<meta name="citation_lastpage" content="303"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2026/01/07"/>
<meta name="citation_publication_date" content="2026/01/07"/>
<meta name="citation_author" content="Rubens Moura"/>
<meta name="citation_author_institution" content="Banco de Mexico"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Global factors in the term structure of interest rates;citation_volume=14;citation_author=Mirko Abbritti;citation_author=Salvatore Dell’Erba;citation_author=Antonio Moreno;citation_author=Sergio Sola"/>
  <meta name="citation_reference" content="citation_title=Pricing the term structure with linear regressions;citation_publisher=Elsevier;citation_volume=110;citation_author=Tobias Adrian;citation_author=Richard K Crump;citation_author=Emanuel Moench"/>
  <meta name="citation_reference" content="citation_title=A no-arbitrage vector autoregression of term structure dynamics with macroeconomic and latent variables;citation_volume=50;citation_author=Andrew Ang;citation_author=Monika Piazzesi"/>
  <meta name="citation_reference" content="citation_title=BGVAR: Bayesian global vector autoregressions;citation_author=Maximilian Boeck;citation_author=Martin Feldkircher;citation_author=Florian Huber;citation_author=Darjus Hosszejni"/>
  <meta name="citation_reference" content="citation_title=bigtime: Sparse estimation of large time series models;citation_author=Ines Wilms;citation_author=David S. Matteson;citation_author=Jacob Bien;citation_author=Sumanta Basu;citation_author=Will Nicholson Enrico Wegner"/>
  <meta name="citation_reference" content="citation_title=BigVAR: Dimension reduction methods for multivariate time series;citation_author=Will Nicholson;citation_author=David Matteson;citation_author=Jacob Bien"/>
  <meta name="citation_reference" content="citation_title=Correcting estimation bias in dynamic term structure models;citation_publisher=Taylor &amp; Francis;citation_volume=30;citation_author=Michael D Bauer;citation_author=Glenn D Rudebusch;citation_author=Jing Cynthia Wu"/>
  <meta name="citation_reference" content="citation_title=Resolving the spanning puzzle in macro-finance term structure models;citation_publisher=Oxford University Press;citation_volume=21;citation_author=Michael D Bauer;citation_author=Glenn D Rudebusch"/>
  <meta name="citation_reference" content="citation_title=Sovereign yield curves and the COVID-19 in emerging markets;citation_publisher=Elsevier;citation_volume=127;citation_author=Bertrand Candelon;citation_author=Rubens Moura"/>
  <meta name="citation_reference" content="citation_title=A multicountry model of the term structures of interest rates with a GVAR;citation_publisher=Oxford University Press;citation_volume=22;citation_author=Bertrand Candelon;citation_author=Rubens Moura"/>
  <meta name="citation_reference" content="citation_title=Theory and practice of GVAR modelling;citation_publisher=Wiley Online Library;citation_volume=30;citation_author=Alexander Chudik;citation_author=M Hashem Pesaran"/>
  <meta name="citation_reference" content="citation_title=Specification analysis of affine term structure models;citation_volume=55;citation_author=Qiang Dai;citation_author=Kenneth J. Singleton"/>
  <meta name="citation_reference" content="citation_title=Expectation puzzles, time-varying risk premia, and affine models of the term structure;citation_publisher=Elsevier;citation_volume=63;citation_author=Qiang Dai;citation_author=Kenneth J Singleton"/>
  <meta name="citation_reference" content="citation_title=A yield-factor model of interest rates;citation_publisher=Wiley Online Library;citation_volume=6;citation_author=Darrell Duffie;citation_author=Rui Kan"/>
  <meta name="citation_reference" content="citation_title=fBonds: Rmetrics - pricing and evaluating bonds;citation_author=Tobias Setz"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Elegant graphics for data analysis;citation_publisher=Springer-Verlag New York;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Modelling the term structure of interest rates in a multicountry setting;citation_author=Rubens Guimães Togeiro Moura"/>
  <meta name="citation_reference" content="citation_title=MTS: All-purpose toolkit for analyzing multivariate time series (MTS) and estimating multivariate volatility models;citation_author=Ruey S. Tsay;citation_author=David Wood;citation_author=Jon Lachmann"/>
  <meta name="citation_reference" content="citation_title=Macroeconomics and the term structure;citation_volume=50;citation_author=Refet S Gürkaynak;citation_author=Jonathan H Wright"/>
  <meta name="citation_reference" content="citation_title=Bootstrap methods in econometrics;citation_publisher=Annual Reviews;citation_volume=11;citation_author=Joel L Horowitz"/>
  <meta name="citation_reference" content="citation_title=CRAN task view: Time series analysis;citation_publisher=Comprehensive R Archive Network (CRAN);citation_author=Rob J Hyndman;citation_author=Rebecca Killick"/>
  <meta name="citation_reference" content="citation_title=Structural vector autoregressive analysis;citation_publisher=Cambridge University Press;citation_author=Lutz Kilian;citation_author=Helmut Lütkepohl"/>
  <meta name="citation_reference" content="citation_title=Risk premiums in dynamic term structure models with unspanned macro risks;citation_volume=69;citation_author=Scott Joslin;citation_author=Marcel Priebsch;citation_author=Kenneth J. Singleton"/>
  <meta name="citation_reference" content="citation_title=A new perspective on Gaussian dynamic term structure models;citation_volume=24;citation_author=Scott Joslin;citation_author=Kenneth J. Singleton;citation_author=Haoxing Zhu"/>
  <meta name="citation_reference" content="citation_title=Why do term structures in different currencies co-move?;citation_volume=115;citation_author=Chotibhak Jotikasthira;citation_author=Anh Le;citation_author=Christian Lundblad"/>
  <meta name="citation_reference" content="citation_title=Common factors affecting bond returns;citation_volume=1;citation_doi=10.3905/jfi.1991.692347;citation_author=Robert Litterman;citation_author=José Scheinkman"/>
  <meta name="citation_reference" content="citation_title=MultiATSM: Multicountry term structure of interest rates models;citation_author=Rubens Moura"/>
  <meta name="citation_reference" content="citation_title=Parsimonious modeling of yield curves;citation_publisher=JSTOR;citation_author=Charles R Nelson;citation_author=Andrew F Siegel"/>
  <meta name="citation_reference" content="citation_title=Generalized impulse response analysis in linear multivariate models;citation_publisher=Elsevier;citation_volume=58;citation_author=H Hashem Pesaran;citation_author=Yongcheol Shin"/>
  <meta name="citation_reference" content="citation_title=Affine term structure models;citation_publisher=Elsevier;citation_author=Monika Piazzesi"/>
  <meta name="citation_reference" content="citation_title=A macro-finance model of the term structure, monetary policy and the economy;citation_publisher=Oxford University Press Oxford, UK;citation_volume=118;citation_author=Glenn D Rudebusch;citation_author=Tao Wu"/>
  <meta name="citation_reference" content="citation_title=simStateSpace: Simulate data from state space models;citation_author=Ivan Jacob Agaloos Pesigan"/>
  <meta name="citation_reference" content="citation_title=Spillover: Spillover/connectedness index based on VAR modelling;citation_author=Jilber Urbina"/>
  <meta name="citation_reference" content="citation_title=statespacer: State space modelling in R;citation_author=Dylan Beijers"/>
  <meta name="citation_reference" content="citation_title=svars: Data-driven identification of SVAR models;citation_author=Alexander Lange;citation_author=Bernhard Dalheimer;citation_author=Helmut Herwartz;citation_author=Simone Maxand;citation_author=Hannes Riebl"/>
  <meta name="citation_reference" content="citation_title=Estimating and interpreting forward interest rates: Sweden 1992-1994;citation_publisher=National Bureau of Economic Research Cambridge, Mass., USA;citation_doi=10.3386/w4871;citation_author=Lars EO Svensson"/>
  <meta name="citation_reference" content="citation_title=An equilibrium characterization of the term structure;citation_publisher=Elsevier;citation_volume=5;citation_author=Oldrich Vasicek"/>
  <meta name="citation_reference" content="citation_title=YieldCurve: Modelling and estimation of the yield curve;citation_author=Sergio Salvino Guirreri"/>
  <meta name="citation_reference" content="citation_title=vars: VAR modelling;citation_author=Bernhard Pfaff;citation_author=Matthieu Stigler"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","description","draft","author","type","output","bibliography","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models"]},{"type":"character","attributes":{},"value":["2026-01-07"]},{"type":"character","attributes":{},"value":["The MultiATSM package provides estimation tools and a wide range of outputs for eight macrofinance affine term structure model (ATSM) classes, supporting practitioners, academics, and policymakers. All models extend the single-country framework of Joslin et al. (2014) to multicountry settings, with additional adaptations from Jotikasthira et al. (2015) and Candelon and Moura (2024). These model extensions incorporate, respectively, the presence of a dominant (global) economy and adopt a global vector autoregressive (GVAR) setup to capture the joint dynamics of risk factors. The package generates diverse outputs for each ATSM, including graphical representations of model fit, risk premia, impulse response functions, and forecast error variance decompositions. It also implements bootstrap methods for confidence intervals and produces bond yield forecasts."]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Rubens Moura"]},{"type":"character","attributes":{},"value":["Banco de Mexico"]},{"type":"character","attributes":{},"value":["Avenida 5 de Mayo, 2","Mexico City, Mexico"]},{"type":"character","attributes":{},"value":["0000-0001-8105-4729"]},{"type":"character","attributes":{},"value":["rubens.guimaraes@banxico.org.mx"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article","rjtools::rjournal_pdf_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["References.bib"]},{"type":"character","attributes":{},"value":["2025-06-10"]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[4]},{"type":"character","attributes":{},"value":["RJ-2025-044"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[275]},{"type":"integer","attributes":{},"value":[303]}]},{"type":"character","attributes":{},"value":["RJ-2025-044.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-044"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-044"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["MultiATSM","YieldCurve","fBonds","statespacer","simStateSpace","vars","MTS","svars","bigtime","BigVAR","Spillover","BGVAR"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["Econometrics","Finance","TimeSeries"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-044/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["MultiATSM_files/figure-html5/FEVD-1.png","MultiATSM_files/figure-html5/FitYields-1.png","MultiATSM_files/figure-html5/IRF-1.png","MultiATSM_files/figure-html5/pca-H-1.png","MultiATSM_files/figure-html5/TermPremia-1.png","MultiATSM.Rmd.bak","MultiATSM.tex","References.bib","RJ-2025-044_files/anchor-4.2.2/anchor.min.js","RJ-2025-044_files/bowser-1.9.3/bowser.min.js","RJ-2025-044_files/distill-2.2.21/template.v2.js","RJ-2025-044_files/figure-html5/FEVD-1.png","RJ-2025-044_files/figure-html5/FitYields-1.png","RJ-2025-044_files/figure-html5/IRF-1.png","RJ-2025-044_files/figure-html5/pca-H-1.png","RJ-2025-044_files/figure-html5/TermPremia-1.png","RJ-2025-044_files/figure-latex/FEVD-1.pdf","RJ-2025-044_files/figure-latex/FitYields-1.pdf","RJ-2025-044_files/figure-latex/IRF-1.pdf","RJ-2025-044_files/figure-latex/pca-L-1.pdf","RJ-2025-044_files/figure-latex/TermPremia-1.pdf","RJ-2025-044_files/header-attrs-2.30/header-attrs.js","RJ-2025-044_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2025-044_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2025-044_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2025-044_files/kePrint-0.0.1/kePrint.js","RJ-2025-044_files/lightable-0.0.1/lightable.css","RJ-2025-044_files/popper-2.6.0/popper.min.js","RJ-2025-044_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2025-044_files/tippy-6.2.7/tippy-light-border.css","RJ-2025-044_files/tippy-6.2.7/tippy.css","RJ-2025-044_files/tippy-6.2.7/tippy.umd.min.js","RJ-2025-044_files/webcomponents-2.0.0/webcomponents.js","RJ-2025-044.log","RJ-2025-044.tex","RJ-2025-044.zip","RJournal.sty","RJwrapper.log","RJwrapper.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.30/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      
      // Conditionally add supplementary files button
      if (document.getElementById('supplementary-materials')) {
        // create element safely
        const btn_suppl = document.createElement('a');
        btn_suppl.href = slug + '.zip';
        btn_suppl.className = 'dt-tag';
        btn_suppl.innerHTML = '<i class="fas fa-file-zipper"></i> Supplement';
        buttons.append(btn_suppl);
      }

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models","description":"The MultiATSM package provides estimation tools and a wide range of outputs for eight macrofinance affine term structure model (ATSM) classes, supporting practitioners, academics, and policymakers. All models extend the single-country framework of Joslin et al. (2014) to multicountry settings, with additional adaptations from Jotikasthira et al. (2015) and Candelon and Moura (2024). These model extensions incorporate, respectively, the presence of a dominant (global) economy and adopt a global vector autoregressive (GVAR) setup to capture the joint dynamics of risk factors. The package generates diverse outputs for each ATSM, including graphical representations of model fit, risk premia, impulse response functions, and forecast error variance decompositions. It also implements bootstrap methods for confidence intervals and produces bond yield forecasts.","doi":"10.32614/RJ-2025-044","authors":[{"author":"Rubens Moura","authorURL":"#","affiliation":"Banco de Mexico","affiliationURL":"#","orcidID":"0000-0001-8105-4729"}],"publishedDate":"2026-01-07T00:00:00.000+00:00","citationText":"Moura, 2026"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-4">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>The MultiATSM package provides estimation tools and a wide range of outputs for eight macrofinance affine term structure model (ATSM) classes, supporting practitioners, academics, and policymakers. All models extend the single-country framework of Joslin et al. (2014) to multicountry settings, with additional adaptations from Jotikasthira et al. (2015) and Candelon and Moura (2024). These model extensions incorporate, respectively, the presence of a dominant (global) economy and adopt a global vector autoregressive (GVAR) setup to capture the joint dynamics of risk factors. The package generates diverse outputs for each ATSM, including graphical representations of model fit, risk premia, impulse response functions, and forecast error variance decompositions. It also implements bootstrap methods for confidence intervals and produces bond yield forecasts.</p></p>
</div>

<div class="d-byline">
  Rubens Moura  (Banco de Mexico)
  
<br/>2026-01-07
</div>

<div class="d-article">
<h3 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h3>
<p>The term structure of interest rates (or yield curve) describes the relationship between bond yields and investment maturities. As <span class="citation" data-cites="Piazzesi2010">Piazzesi (<a href="#ref-Piazzesi2010" role="doc-biblioref">2010</a>)</span> emphasizes, understanding its dynamics is essential for several reasons. First, long-term yields incorporate market expectations of future short-term rates, making the yield curve a handy forecasting tool for macroeconomic aggregates like output and inflation. As such, this supports optimal consumption-saving decisions and capital allocation by economic agents. Second, it plays a key role in the transmission of monetary policy, linking short-term policy rates to long-term borrowing costs. Third, it guides fiscal authorities in shaping debt maturities to balance refinancing risk and interest rate exposure. Fourth, it is essential for pricing and hedging interest rate derivatives, which rely on accurate yield curve modelling.</p>
<p>Affine Term Structure Models (ATSMs) are the workhorse in yield curve modelling. Based on the assumption of no arbitrage, ATSMs offer a flexible framework to assess how investors price risks and generate predictions for the price of any bond (see <span class="citation" data-cites="Piazzesi2010">Piazzesi (<a href="#ref-Piazzesi2010" role="doc-biblioref">2010</a>)</span>; <span class="citation" data-cites="GurkaynakWright2012">Gürkaynak and Wright (<a href="#ref-GurkaynakWright2012" role="doc-biblioref">2012</a>)</span> for comprehensive reviews). Early ATSMs gained popularity for their ability to capture nearly all term structure fluctuations, appealing to both academics and practitioners <span class="citation" data-cites="Vasicek1977 DuffieKan1996 DaiSingleton2002">(<a href="#ref-Vasicek1977" role="doc-biblioref">Vasicek 1977</a>; <a href="#ref-DuffieKan1996" role="doc-biblioref">Duffie and Kan 1996</a>; <a href="#ref-DaiSingleton2002" role="doc-biblioref">Dai and Singleton 2002</a>)</span>. While these models produce accurate statistical descriptions of the yield curve, they are silent on the deeper economic determinants that policymakers require for causal inference.</p>
<p>In response to this limitation, a large body of research has emerged to explore the interplay between the term structure and macroeconomic developments (seminal contributions include <span class="citation" data-cites="AngPiazzesi2003">Ang and Piazzesi (<a href="#ref-AngPiazzesi2003" role="doc-biblioref">2003</a>)</span> and <span class="citation" data-cites="RudebuschWu2008">Rudebusch and Wu (<a href="#ref-RudebuschWu2008" role="doc-biblioref">2008</a>)</span>). A prominent contribution in this area is the unspanned economic risk framework developed by <span class="citation" data-cites="JoslinPriebschSingleton2014">Joslin et al. (<a href="#ref-JoslinPriebschSingleton2014" role="doc-biblioref">2014</a>)</span> (henceforth JPS, 2014). In essence, this model assumes an arbitrage-free bond market and considers a linear state space representation to describe the dynamics of the yield curve. Compared to earlier macrofinance ATSMs, JPS (2014) offers a tractable estimation approach that integrates traditional yield curve factors (spanned factors) with macroeconomic variables (unspanned factors). As a result, the model delivers a strong cross-sectional fit while explicitly linking bond yield responses to the state of the economy.</p>
<p>The work of JPS (2014) lays the foundational framework for the modelling tools included in the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package <span class="citation" data-cites="MultiATSM2025">(<a href="#ref-MultiATSM2025" role="doc-biblioref">Moura 2025</a>)</span>. In addition to the original single-country setup proposed by JPS (2014), the package incorporates multicountry extensions developed by <span class="citation" data-cites="JotikasthiraLeLundblad2015">Jotikasthira et al. (<a href="#ref-JotikasthiraLeLundblad2015" role="doc-biblioref">2015</a>)</span> (henceforth JLL, 2015) and <span class="citation" data-cites="CandelonMoura2024">Candelon and Moura (<a href="#ref-CandelonMoura2024" role="doc-biblioref">2024</a>)</span> (henceforth CM, 2024). Altogether, the package offers functions to build eight types of ATSMs, covering the original versions and several variants of these three frameworks.</p>
<p>Beyond complete routines for model estimation, <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> produces a wide range of analytical outputs. In particular, it generates graphical representations such as model-implied bond yields, bond risk premia, and both orthogonalized and generalized versions of: <em>(i)</em> impulse response functions, and <em>(ii)</em> forecast error variance decompositions for yields and risk factors. Confidence intervals for the two latter outputs can be computed using three bootstrap methods: residual-based, block, or wild bootstrap. Moreover, the package supports out-of-sample forecasting of bond yields across the maturity spectrum. This paper provides detailed guidance on how to use the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package effectively.</p>
<p>There are a few notable packages for term structure modelling in the R programming environment. <a href="https://cran.r-project.org/package=YieldCurve">YieldCurve</a> <span class="citation" data-cites="YieldCurve2015">(<a href="#ref-YieldCurve2015" role="doc-biblioref">Guirreri 2015</a>)</span> and <a href="https://cran.r-project.org/package=fBonds">fBonds</a> <span class="citation" data-cites="fBonds2017">(<a href="#ref-fBonds2017" role="doc-biblioref">Setz 2017</a>)</span> provide a collection of functions to build term structures based on the frameworks of <span class="citation" data-cites="NelsonSiegel1987">Nelson and Siegel (<a href="#ref-NelsonSiegel1987" role="doc-biblioref">1987</a>)</span> and <span class="citation" data-cites="Svensson1994">Svensson (<a href="#ref-Svensson1994" role="doc-biblioref">1994</a>)</span>. These yield curve methods have gained popularity for their parsimonious parameterization and good empirical fit. However, these models do not rule out arbitrage opportunities, a limitation addressed by ATSMs. Moreover, the focus of <a href="https://cran.r-project.org/package=YieldCurve">YieldCurve</a> and <a href="https://cran.r-project.org/package=fBonds">fBonds</a> is restricted to parameter estimation and yield curve fitting, without offering additional model outputs such as those provided by <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a>.</p>
<p>Several other R packages support time series modeling <span class="citation" data-cites="HyndmanKillick2025">(<a href="#ref-HyndmanKillick2025" role="doc-biblioref">Hyndman and Killick 2025</a>)</span>, particularly within state space and vector autoregressive (VAR) frameworks. State space packages are relatively few and tend to focus on either estimation, <a href="https://cran.r-project.org/package=statespacer">statespacer</a> <span class="citation" data-cites="statespacer2023">(<a href="#ref-statespacer2023" role="doc-biblioref">Beijers 2023</a>)</span>, or simulation, <a href="https://cran.r-project.org/package=simStateSpace">simStateSpace</a><span class="citation" data-cites="simStateSpace2025">(<a href="#ref-simStateSpace2025" role="doc-biblioref">Pesigan 2025</a>)</span>. VAR-based tools are more numerous. For instance, <a href="https://cran.r-project.org/package=vars">vars</a> <span class="citation" data-cites="vars2024">(<a href="#ref-vars2024" role="doc-biblioref">Pfaff and Stigler 2024</a>)</span> and <a href="https://cran.r-project.org/package=MTS">MTS</a> <span class="citation" data-cites="MTS2022">(<a href="#ref-MTS2022" role="doc-biblioref">Tsay et al. 2022</a>)</span> provide extensive functionality for estimation, diagnostics, and forecasting, while <a href="https://cran.r-project.org/package=svars">svars</a> <span class="citation" data-cites="svars2023">(<a href="#ref-svars2023" role="doc-biblioref">Lange et al. 2023</a>)</span> adds structural identification methods. High-dimensional VARs are handled by packages like <a href="https://cran.r-project.org/package=bigtime">bigtime</a> <span class="citation" data-cites="bigtime2023">(<a href="#ref-bigtime2023" role="doc-biblioref">Wilms et al. 2023</a>)</span> and <a href="https://cran.r-project.org/package=BigVAR">BigVAR</a> <span class="citation" data-cites="BigVAR2025">(<a href="#ref-BigVAR2025" role="doc-biblioref">Nicholson et al. 2025</a>)</span>, and cross-country spillovers are modeled by <a href="https://cran.r-project.org/package=Spillover">Spillover</a> <span class="citation" data-cites="Spillover2024">(<a href="#ref-Spillover2024" role="doc-biblioref">Urbina 2024</a>)</span> and <a href="https://cran.r-project.org/package=BGVAR">BGVAR</a> <span class="citation" data-cites="BGVAR2024">(<a href="#ref-BGVAR2024" role="doc-biblioref">Boeck et al. 2024</a>)</span>.</p>
<p>Although these tools share some features with <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a>, they are tailored to standard state space or VAR analysis. In contrast, <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> embeds VAR dynamics within a state space representation that is explicitly grounded in arbitrage-free asset pricing theory. As such, <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> fills a specific gap in the R ecosystem by combining the structure of ATSMs with the flexibility of modern time series tools.</p>
<p>The remainder of the paper is organized as follows. Section <a href="#S:ATSMTheory">2</a> outlines the theoretical foundations of the ATSMs implemented in the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package, and Section <a href="#S:ATSMoptions">3</a> details each model’s features. The subsequent sections focus on the practical implementation of ATSMs. Section <a href="#S:SectionData">4</a> presents the dataset included in the package. Section <a href="#S:SectionInputs">5</a> explains the user inputs required for model estimation. Section <a href="#S:SectionEstimation">6</a> explains the estimation procedure, and Section <a href="#S:SectionImplementation">7</a> shows how to estimate ATSMs from scratch using <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a>. Replications of published academic studies are provided in the Appendix.</p>
<h3 data-number="2" id="S:ATSMTheory"><span class="header-section-number">2</span> ATSMs with unspanned economic risks: theoretical background</h3>
<p>In this section, I outline several arbitrage-free ATSMs with unspanned macroeconomic risks available in the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package. A key appealing feature of these setups is their ability to disentangle the yield curve into a cross-sectional component, governed by the risk-neutral (<span class="math inline">\(\mathbb{Q}\)</span>) dynamics, and a time-series component, driven by the physical (<span class="math inline">\(\mathbb{P}\)</span>) dynamics. In light of this characteristic of the models, I present the single and the multicountry <span class="math inline">\(\mathbb{Q}\)</span>-dynamics model dimensions in Section <a href="#S:Qdyn">2.1</a>. Next, I expose the specific features of the risk factor dynamics under the <span class="math inline">\(\mathbb{P}\)</span>-measure of the various restricted and unrestricted VARs settings in Section <a href="#S:Pdyn">2.2</a>. Section <a href="#S:ATSMestimation">2.3</a> describes the model estimation procedures.</p>
<h4 class="unnumbered" data-number="2.1" id="S:Qdyn">Model cross-sectional dimension (Q-dynamics)</h4>
<h5 class="unnumbered" data-number="2.1.1" id="single-country-specifications-individual-q-dynamics-model-classes">Single-country specifications (individual Q-dynamics model classes)</h5>
<p>The model cross-sectional structure is based on two central equations. The first one assumes that the country <span class="math inline">\(i\)</span> short-term interest rate at time <span class="math inline">\(t\)</span>, <span class="math inline">\(r_{i,t}\)</span>, is an affine function of <span class="math inline">\(N\)</span> unobserved (latent) country-specific factors, <span class="math inline">\(\boldsymbol{X_{i,t}}\)</span>:
<span class="math display" id="eq:ShortRate">\[\begin{equation}
\underset{(1 \times 1)}{\vphantom{\Big|}
r_{i,t}} =
\underset{(1 \times 1)}{
\vphantom{\Big|}
\delta_{i,0}} +
\underset{(1 \times N)}{%
\vphantom{\Big|}
\boldsymbol{\delta}_{i,1}^{\top}}
\underset{(N \times 1)}{%
\vphantom{\Big|}
\boldsymbol{X}_{i,t}}\text{,}
\tag{1}
\end{equation}\]</span>
where <span class="math inline">\(\delta_{i,0}\)</span> and <span class="math inline">\(\boldsymbol{\delta_{i,1}}\)</span> are time-invariant parameters.</p>
<p>The second equation assumes that the unobserved factor dynamics for each country <span class="math inline">\(i\)</span> follow a maximally flexible, first-order, <span class="math inline">\(N-\)</span>dimensional multivariate Gaussian (<span class="math inline">\(\mathcal{N}\)</span>) VAR model under the <span class="math inline">\(\mathbb{Q}\)</span>-measure:</p>
<p><span class="math display" id="eq:VARQ">\[\begin{align}
&amp;   \underset{(N \times 1)}{\boldsymbol{\vphantom{\Big|}
X_{i,t}}} =
\underset{(N \times 1)}{\boldsymbol{\vphantom{\Big|}
\mu^{Q}_{i,X}}} +
\underset{(N \times N)}{\vphantom{\Big|}
\Phi^{Q}_{i,X}}
\underset{(N \times 1)}{\boldsymbol{\vphantom{\Big|}
X_{i,t-1}}} +
\underset{(N \times N)}{\vphantom{\Big|}
\Gamma_{i,X}}
\underset{(N \times 1)}{\boldsymbol{\vphantom{\Big|}
\varepsilon_{i,t}^{Q}}}\text{,}
    &amp;  \boldsymbol{\varepsilon_{i,t}^{Q}}\sim {\mathcal{N}_N}(\boldsymbol{0}_N,\mathrm{I}_N)\text{,}
    \tag{2}
\end{align}\]</span>
where <span class="math inline">\(\boldsymbol{\mu^{Q}_{i,X}}\)</span> contains intercepts, <span class="math inline">\(\Phi^{Q}_{i,X}\)</span>, the feedback matrix, and <span class="math inline">\(\Gamma_{i,X}\)</span> a lower triangular matrix.</p>
<p>Based on Equations <a href="#eq:ShortRate">(1)</a> and <a href="#eq:VARQ">(2)</a>, <span class="citation" data-cites="DaiSingleton2000">Dai and Singleton (<a href="#ref-DaiSingleton2000" role="doc-biblioref">2000</a>)</span> show that the country-specific zero-coupon bond yield with maturity of <span class="math inline">\(n\)</span> periods, <span class="math inline">\(y_{i,t}^{(n)}\)</span>, is affine in <span class="math inline">\(\boldsymbol{X_{i,t}}\)</span>:
<span class="math display" id="eq:AffineYieldsScalar">\[\begin{equation}
\underset{(1 \times 1)}{\vphantom{\Big|}
y_{i,t}^{(n)}} =
\underset{(1 \times 1)}{\vphantom{\Big|}
a_{i,n}(\Theta_{n})} +
\underset{(1 \times N)}{\vphantom{\Big|}
\boldsymbol{b_{i,n}(\Theta_{n})}^\top}
\underset{(N \times 1)}{\vphantom{\Big|}
\boldsymbol{X_{i,t}}}\text{,}
    \tag{3}
\end{equation}\]</span>
where <span class="math inline">\(a_{i,n}(\Theta _{n})\)</span> and <span class="math inline">\(\boldsymbol{b_{i,n}(\Theta _{n})}\)</span> are constrained to eliminate arbitrage opportunities within this bond market, as dictated by the well-known Riccati equations.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> For notational simplicity, we collect <span class="math inline">\(J\)</span> bond yields into the vector <span class="math inline">\(\boldsymbol{Y_{i,t}}=[y_{i,t}^{(1)}, y_{i,t}^{(2)},...,y_{i,t}^{(J)}]^\top\)</span>, the <span class="math inline">\(J\)</span> intercepts into <span class="math inline">\(\boldsymbol{A_X(\Theta_i)}=[a_{i,1}(\Theta _{1}), a_{i,2}(\Theta _{2}) ,...,a_{i,J}(\Theta _{J})]^\top\)</span> <span class="math inline">\(\in \mathbb{R}^J\)</span>, and the <span class="math inline">\(N\)</span> slope coefficients into a <span class="math inline">\(J \times N\)</span> matrix <span class="math inline">\(B_X(\Theta_i)=[\boldsymbol{b_{i,1}(\Theta _{1})}^\top, \boldsymbol{b_{i,2}(\Theta _{2})}^\top, ...,\boldsymbol{b_{i,J}(\Theta _{J})}^\top]^\top\)</span>. Accordingly, the yield curve cross-section dimension of country <span class="math inline">\(i\)</span> is:
<span class="math display" id="eq:AffineYieldsVector">\[\begin{equation}
    \underset{(J \times 1)}{\vphantom{\Big|}
    \boldsymbol{Y_{i,t}}} =
    \underset{(J \times 1)}{\vphantom{\Big|}
    \boldsymbol{A_X(\Theta_i)}} +
    \underset{(J \times N)}{\vphantom{\Big|}
    B_X(\Theta_i)}
    \underset{(N \times 1)}{\vphantom{\Big|}
    \boldsymbol{X_{i,t}}}\text{.}
\tag{4}
\end{equation}\]</span></p>
<p>It follows from Equations <a href="#eq:ShortRate">(1)</a> and <a href="#eq:VARQ">(2)</a> that the parameter set <span class="math inline">\(\Theta_i =\{\boldsymbol{\mu^Q_{i,X}},\Phi^Q_{i,X}, \Gamma_{i,X}, \delta_{i,0}, \boldsymbol{\delta_{i,1}}\}\)</span> fully characterizes the cross-section of country’s <span class="math inline">\(i\)</span> term structure. Importantly, <span class="citation" data-cites="DaiSingleton2000">Dai and Singleton (<a href="#ref-DaiSingleton2000" role="doc-biblioref">2000</a>)</span> demonstrate that this system is not identified without additional restrictions, since <span class="math inline">\(\boldsymbol{X_{i,t}}\)</span> and any invertible affine transformation of <span class="math inline">\(\boldsymbol{X_{i,t}}\)</span> yield observationally equivalent representations. To circumvent this problem, JPS (2014) adopt the three sets of (minimal) restrictions proposed by <span class="citation" data-cites="JoslinSingletonZhu2011">Joslin et al. (<a href="#ref-JoslinSingletonZhu2011" role="doc-biblioref">2011</a>)</span>. First, they impose the latent factors to be zero-mean processes, forcing <span class="math inline">\(\boldsymbol{\mu^{Q}_{i,X}}= \boldsymbol{0}_N\)</span>. Second, they choose <span class="math inline">\(\boldsymbol{\delta_{i,1}}\)</span> to be a <span class="math inline">\(N\)</span>-dimensional vector whose entries are all equal to one. Lastly, <span class="math inline">\(\Phi^Q_{i,X}\)</span> is a diagonal matrix, the elements of which are the real and distinct eigenvalues, <span class="math inline">\(\lambda^Q_i\)</span>, of the matrix of eigenvectors of <span class="math inline">\(\Phi^Q_{i,X}\)</span>. Based on this restriction set, <span class="citation" data-cites="JoslinSingletonZhu2011">Joslin et al. (<a href="#ref-JoslinSingletonZhu2011" role="doc-biblioref">2011</a>)</span> show that no additional invariant rotation is possible.</p>
<p><span class="citation" data-cites="JoslinSingletonZhu2011">Joslin et al. (<a href="#ref-JoslinSingletonZhu2011" role="doc-biblioref">2011</a>)</span> also show that a rotation from <span class="math inline">\(\boldsymbol{X_{i,t}}\)</span> to portfolios of yields, the spanned factors <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span>, leads to an observationally equivalent model representation. This invariant transformation implies that <span class="math inline">\(N\)</span> portfolios of yields are perfectly priced and observed without errors, while the remaining <span class="math inline">\(J-N\)</span> portfolios are priced and observed imperfectly. Specifically, the spanned factors are computed as <span class="math inline">\(\boldsymbol{P_{i,t}}=V_i\boldsymbol{Y_{i,t}}\)</span>, for a full-rank matrix <span class="math inline">\(V_i\)</span>. Based on this definition, Equation <a href="#eq:AffineYieldsVector">(4)</a> can be rearranged as an affine function of <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span></p>
<p><span class="math display" id="eq:AffineYieldsSpanned">\[\begin{equation}
    \underset{(J \times 1)}{\vphantom{\Big|}
    \boldsymbol{Y_{i,t}}}=
    \underset{(J \times 1)}{\vphantom{\Big|}
    \boldsymbol{A_P(\Theta_i)}}+
    \underset{(J \times N)}{\vphantom{\Big|}
    B_P(\Theta_i)}
    \underset{(N \times 1)}{\vphantom{\Big|}
    \boldsymbol{P_{i,t}}}\text{.}
    \tag{5}
\end{equation}\]</span>
where <span class="math inline">\(\boldsymbol{A_P(\Theta_i)}= \mathrm{I}_n - B_X(\Theta_i ) \left[ V_iB_X(\Theta_i \right] ^{-1}V_i \boldsymbol{A_X(\Theta_i)}\)</span> and
<span class="math inline">\(B_P(\Theta_i)=B_X(\Theta_i) \left[ V_iB_X(\Theta_i ) \right]^{-1}\)</span>.</p>
<p>The rotation from <span class="math inline">\(\boldsymbol{X_{i,t}}\)</span> to <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span> is convenient for two key reasons. First, <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span> contains directly observable yield curve factors (unlike <span class="math inline">\(\boldsymbol{X_{i,t}}\)</span>), with its <span class="math inline">\(N\)</span> elements mapping to traditional yield curve components. For instance, for <span class="math inline">\(N=3\)</span> and <span class="math inline">\(V_i\)</span> being the weight matrix that results from a principal component analysis, the portfolios of yields <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span> are commonly referred to as the level, slope, and curvature factors (see Section <a href="#S:SpaFac">6.1</a>). Second, it enables a convenient decomposition of the likelihood function, facilitating both estimation and the interpretation of model parameters.</p>
<h5 class="unnumbered" data-number="2.1.2" id="multicountry-specifications-joint-q-dynamics-model-classes">Multicountry specifications (joint Q-dynamics model classes)</h5>
<p>The cross-section multicountry extension is formed by stacking the country yields, spanned factors, and intercepts from Equation <a href="#eq:AffineYieldsSpanned">(5)</a> into, respectively, <span class="math inline">\(\boldsymbol{Y_t}=[\boldsymbol{Y_{1,t}}^\top, \boldsymbol{Y_{2,t}}^\top, ...,\boldsymbol{Y_{C,t}}^\top]^\top\)</span>, <span class="math inline">\(\boldsymbol{P_t}=[\boldsymbol{P_{1,t}}^\top, \boldsymbol{P_{2,t}}^\top, ..., \boldsymbol{P_{C,t}}^\top]^\top\)</span>, and <span class="math inline">\(\boldsymbol{A_P(\Theta)}=[\boldsymbol{A_P^\top(\Theta_1)}, \boldsymbol{A_P^\top(\Theta_2)}, ..., \boldsymbol{A_P^\top(\Theta_C)}]^\top\)</span>, where <span class="math inline">\(C\)</span> denotes the number of countries in this economic system. Additionally, we set <span class="math inline">\(B_{P}(\Theta)\)</span> as block diagonal, <span class="math inline">\(B_P(\Theta)=B_P(\Theta_1) \oplus  B_P(\Theta_2) \oplus \dots \oplus B_P(\Theta_C)\)</span>, where <span class="math inline">\(\oplus\)</span> refers to the direct sum symbol. Accordingly,<br />
<span class="math display" id="eq:AffineYieldsSpannedMultiCountry">\[\begin{equation}
    \underset{(CJ \times 1)}{\vphantom{\Big|}
    \boldsymbol{Y_{t}}} =
    \underset{(CJ \times 1)}{\vphantom{\Big|}
    \boldsymbol{A_{P}(\Theta)}} +
    \underset{(CJ \times CN)}{\vphantom{\Big|}
    B_{P}(\Theta)}
    \underset{(CN \times 1)}{\vphantom{\Big|}
    \boldsymbol{P_{t}}}\text{.}
    \tag{6}
\end{equation}\]</span></p>
<h4 class="unnumbered" data-number="2.2" id="S:Pdyn">Model time series dimension (P-dynamics)</h4>
<p>In the modelling frameworks implemented in the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package, the risk factor dynamics under the <span class="math inline">\(\mathbb{P}\)</span>-measure must include at least <span class="math inline">\(N\)</span> domestic spanned factors (<span class="math inline">\(\boldsymbol{P_{i,t}}\)</span>) and <span class="math inline">\(M\)</span> domestic unspanned factors (<span class="math inline">\(\boldsymbol{M_{i,t}}\)</span>), and may optionally include <span class="math inline">\(G\)</span> global unspanned factors (<span class="math inline">\(\boldsymbol{M_t^W}\)</span>), depending on the specification. The dynamics of these risk factors evolves as either an unrestricted or a restricted VAR models. The unrestricted case corresponds to the JPS specification, while the restricted setup encompasses the GVAR and JLL frameworks.</p>
<p>It is worth stressing the role of unspanned factors in shaping the yield curve developments. Although these factors are absent in the cross-section dimension of the models, they influence the dynamics of the spanned factors which, in turn, affect directly bond yields.</p>
<h5 class="unnumbered" data-number="2.2.1" id="jps-based-models">JPS-based models</h5>
<p>The country-specific state vector, <span class="math inline">\(\boldsymbol{Z_{i,t}}\)</span>, is formed from stacking the global and domestic (unspanned and spanned) risk factors: <span class="math inline">\(\boldsymbol{Z_{i,t}} = [\boldsymbol{M_t^{W^\top}}\)</span>, <span class="math inline">\(\boldsymbol{M_{i,t}}^\top\)</span>, <span class="math inline">\(\boldsymbol{P_{i,t}}^\top]^\top\)</span>. As such, <span class="math inline">\(\boldsymbol{Z_{i,t}}\)</span> is a <span class="math inline">\(R\)</span>-dimensional vector, where <span class="math inline">\(R =G + K\)</span> and <span class="math inline">\(K = M + N\)</span>.
In JPS-based setups, <span class="math inline">\(\boldsymbol{Z_{i,t}}\)</span> follows a standard unrestricted Gaussian VAR(1):
<span class="math display" id="eq:VARunspanned">\[\begin{align}
    &amp; \underset{(R \times 1)}{\vphantom{\Big|}
    \boldsymbol{Z_{i,t}}} =
    \underset{(R \times 1)}{\vphantom{\Big|}
     \boldsymbol{C_i^{\mathbb{P}}}} +
     \underset{(R \times R)}{\vphantom{\Big|}
     \Phi_i^{\mathbb{P}}}
     \underset{ (R \times 1)}{\vphantom{\Big|}
     \boldsymbol{Z_{i,t-1}}} +
     \underset{(R \times R)}{\vphantom{\Big|}
     \Gamma_i}
        \underset{(R \times 1)}{\vphantom{\Big|}
        \boldsymbol{\varepsilon_{Z,t}^{\mathbb{P}}}}\text{,}
        &amp; \boldsymbol{\varepsilon_{Z,t}^{\mathbb{P}}} \sim
        {\mathcal{N}_R}(\boldsymbol{0}_R,\mathrm{I}_R)\text{,}%
    \tag{7}
\end{align}\]</span>
where <span class="math inline">\(\boldsymbol{C_i^{\mathbb{P}}}\)</span> denotes the vector of intercepts; <span class="math inline">\(\Phi_i^{\mathbb{P}}\)</span>, the feedback matrix; and <span class="math inline">\(\Gamma_i\)</span>, the Cholesky factor (a lower triangular matrix).</p>
<h5 class="unnumbered" data-number="2.2.2" id="S:GVARtheory">GVAR-based models</h5>
<p>In the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package, the GVAR setup is formed from two parts: the marginal and the VARX<span class="math inline">\(^{*}\)</span> models. The former captures the joint dynamics of the global economy, whereas the latter describes the developments from the domestic factors. For a thorough description of GVAR models, See <span class="citation" data-cites="ChudikPesaran2016">Chudik and Pesaran (<a href="#ref-ChudikPesaran2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>The marginal model is an unrestricted VAR(<span class="math inline">\(1\)</span>) featuring exclusively the global factors:
<span class="math display" id="eq:MarginalModel">\[\begin{align}
&amp; \underset{(G \times 1)}{\vphantom{\Big|}
\boldsymbol{M_t^W}}=
\underset{(G \times 1)}{\vphantom{\Big|}
\boldsymbol{C^W}} +
\underset{(G \times G)}{\vphantom{\Big|}
\Phi^W} \underset{(G \times 1)}{\vphantom{\Big|}
\boldsymbol{M_{t-1}^W}} +
\underset{(G \times G)}{\vphantom{\Big|}
\Gamma^W}\underset{(G \times 1)}{\vphantom{\Big|}
\boldsymbol{\varepsilon_{t}^W}}\text{,} &amp; \boldsymbol{\varepsilon_t^W} \sim {\mathcal{N}_G}(\boldsymbol{0}_G,\mathrm{I}_G).
\tag{8}
\end{align}\]</span></p>
<p>The VARX<span class="math inline">\(^{*}\)</span> setups are country-specific small-scale VAR models containing global factors and weakly exogenous ‘star’ variables — weighted averages of foreign variables — built as
<span class="math display" id="eq:StarVar">\[\begin{equation}
\boldsymbol{Z_{i,t}^{\ast^\top}} = \sum_{j=1}^{C} w_{i,j} \boldsymbol{Z_{j,t}^\top}, \qquad \sum_{j=1}^{C} w_{i,j}= 1, \quad w_{i,i}=0 \quad \forall i \in \{1,2, ...C \},
\tag{9}
\end{equation}\]</span>
where <span class="math inline">\(Z_{j,t}\)</span> is a <span class="math inline">\(K-\)</span>dimension vector of domestic factors <span class="math inline">\(\boldsymbol{Z_{j,t}} = [\boldsymbol{M_{j,t}}^\top\)</span>, <span class="math inline">\(\boldsymbol{P_{j,t}}^\top]^\top\)</span> and <span class="math inline">\(w_{i,j}\)</span> is a scalar that measures the degree of connectedness of country <span class="math inline">\(i\)</span> with country <span class="math inline">\(j\)</span>.</p>
<p>These models follow a VARX<span class="math inline">\(^{*}(p,q,r)\)</span> specification, where <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span> and <span class="math inline">\(r\)</span> are the number of lags from, respectively, the domestic, the star, and the global risk factors. The <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package provides the estimates for the case <span class="math inline">\(p=q=r=1\)</span>. In such a case, the dynamics of <span class="math inline">\(\boldsymbol{Z_{i,t}}\)</span> is described as a VARX<span class="math inline">\(^{*}\)</span> of the following form:
<span class="math display" id="eq:VARXmodel">\[\begin{align}
&amp; \underset{(K \times 1)}{\vphantom{\Big|}
\boldsymbol{Z_{i,t}}}  =
\underset{(K \times 1)}{\vphantom{\Big|}
\boldsymbol{C^X_{i}}} +
\underset{(K \times K)}{\vphantom{\Big|}
\Phi^X_{i}}
\underset{(K \times 1)}{\vphantom{\Big|}
\boldsymbol{Z_{i,t-1}}} +
\underset{(K \times K)}{\vphantom{\Big|}
\Phi^{X^\ast}_i}  
\underset{(K \times 1)}{\vphantom{\Big|}
\boldsymbol{Z_{i,t-1}^{\ast}}} +
\underset{(K \times G)}{\vphantom{\Big|}
\Phi_{i}^{X^{W}}}
\underset{(G \times 1)}{\vphantom{\Big|}
\boldsymbol{M_{t-1}^{W}}} +
\underset{(K \times K)}{\vphantom{\Big|}
\Gamma_{i}^{X}}
\underset{(K \times 1)}{\vphantom{\Big|}
\boldsymbol{\varepsilon^X_{i,t}}}\text{,}    &amp; \boldsymbol{\varepsilon^X_{i,t}} \sim {\mathcal{N}_K}(\boldsymbol{0}_K,\mathrm{I}_K).
\tag{10}
\end{align}\]</span></p>
<p>Additionally, GVAR models require, as an intermediate step, the specification of country-specific <span class="math inline">\(2K \times CK\)</span>-link matrices, <span class="math inline">\(W_i\)</span>, to unify the individual VARX<span class="math inline">\(^{*}\)</span> models. Formally,
<span class="math display" id="eq:LinkMatequation">\[\begin{equation}
\begin{bmatrix} \boldsymbol{Z_{i,t}} \\ \boldsymbol{Z_{i,t}}^{*} \end{bmatrix}_{2K \times 1} \equiv \underset{(2K \times CK)}{W_i} \begin{bmatrix} \boldsymbol{Z_{1,t}} \\  \boldsymbol{Z_{2,t}} \\     \vdots  \\ \boldsymbol{Z_{C,t}}
\end{bmatrix}_{CK \times 1}.
\tag{11}
\end{equation}\]</span></p>
<p>Last, to compose the <span class="math inline">\(F\)</span>-dimensional state vector for <span class="math inline">\(F = G + CK\)</span>, we gather the global economic variables and the country-specific risk factors, as <span class="math inline">\(\boldsymbol{Z_t} = [\boldsymbol{M_{t}^{W^\top}}\)</span>, <span class="math inline">\(\boldsymbol{Z_{1,t}}^\top\)</span>, <span class="math inline">\(\boldsymbol{Z_{2,t}}^\top, \ldots    \boldsymbol{Z_{C,t}}^\top]^\top\)</span>. As such, we can form a first order GVAR process as
<span class="math display" id="eq:GVARequation">\[\begin{align}
    &amp; \underset{(F \times 1)}{\vphantom{\Big|}
    \boldsymbol{Z_t}} =
    \underset{(F \times 1)}{\vphantom{\Big|}
    \boldsymbol{C_y}} +
    \underset{(F \times F)}{\vphantom{\Big|}
    \Phi_y}
    \underset{(F \times F)}{\vphantom{\Big|}
    \boldsymbol{Z_{t-1}}} +
    \underset{(F \times F)}{\vphantom{\Big|}
    \Gamma_y}
    \underset{(F \times 1)}{\vphantom{\Big|}
    \boldsymbol{\varepsilon_{y,t}}}\text{,} &amp;
    \boldsymbol{\varepsilon_{y,t}} \sim {\mathcal{N}_F}(\boldsymbol{0}_F,\mathrm{I}_F)\text{,}  \tag{12}
\end{align}\]</span>
where <span class="math inline">\(\boldsymbol{C_y} = [\boldsymbol{C^{W^\top}}\)</span>, <span class="math inline">\(\boldsymbol{C_1^{X^\top}}\)</span>, <span class="math inline">\(\boldsymbol{C_2^{X^\top}}\)</span>,… <span class="math inline">\(\boldsymbol{C_C^{X^\top}}]^\top\)</span>, <span class="math inline">\(\boldsymbol{\varepsilon_{y,t}} =[ \boldsymbol{\varepsilon^{W^\top}_t}\)</span>, <span class="math inline">\(\boldsymbol{\varepsilon_{1,t}^{X^\top}}\)</span>, <span class="math inline">\(\boldsymbol{\varepsilon_{2,t}^{X^\top}}\)</span> … <span class="math inline">\(\boldsymbol{\varepsilon_{C,t}^{X^\top}}]^\top\)</span>, <span class="math inline">\(\Gamma_y=\Gamma^W \oplus \Gamma_1^X \oplus \Gamma_2^X \oplus \dots \oplus \Gamma_C^X\)</span>, and</p>
<p><span class="math display">\[\begin{equation}
\Phi_y =
\begin{bmatrix}
\Phi^W &amp; 0_{\scriptscriptstyle{G \times CK}}  \\
\Phi^{X^{W}} &amp; G_1
\end{bmatrix}_{F \times F} ,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\Phi^{X^{W}}=
\begin{bmatrix}
\Phi^{X^{W}}_1 \\
\Phi^{X^{W}}_2 \\
\vdots \\
\Phi^{X^{W}}_C
\end{bmatrix}_{CK \times G}\)</span>
and <span class="math inline">\(G_1=
\begin{bmatrix}
\Phi_1W_1 \\
\Phi_2W_2 \\
\vdots \\
\Phi_CW_C
\end{bmatrix}_{CK \times CK}\)</span>, for <span class="math inline">\(\Phi_i= [\Phi_i^{X}\)</span>, <span class="math inline">\(\Phi_i^{X^*}]\)</span> and <span class="math inline">\(\quad \forall i \in \{1,2, ...C \}\)</span>.</p>
<h5 class="unnumbered" data-number="2.2.3" id="S:JLL">JLL-based models</h5>
<p>JLL-based models incorporate three components: <em>(i)</em> the global economy, <em>(ii)</em> a dominant large economy,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> and <em>(iii)</em> a set of smaller economies. The state vector is formed from a number of linear projections to build domestic risk factors that are free of the influence of the variables from other countries and/or from the global economy.</p>
<p>The construction of the domestic spanned factors proceeds in two steps. First, for each economy <span class="math inline">\(i\)</span>, <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span> is projected on <span class="math inline">\(\boldsymbol{M_{i,t}}\)</span> of this same country
<span class="math display" id="eq:PricingOrthoAll">\[\begin{equation}
    \underset{ (N \times 1)}{\vphantom{\Big|}
    \boldsymbol{P_{i,t}}} =
    \underset{(N \times M)}{\vphantom{\Big|}
    b_i}
    \underset{(M \times 1)}{\vphantom{\Big|}
    \boldsymbol{M_{i,t}}} +
    \underset{ (N \times 1)}{\vphantom{\Big|}
    \boldsymbol{P_{i,t}^e}} \text{,}
\tag{13}
\end{equation}\]</span>
where the residuals <span class="math inline">\(\boldsymbol{P_{i,t}^e}\)</span> are orthogonal to the economic fundamentals of the country <span class="math inline">\(i\)</span>.</p>
<p>Second, for the non-dominant economies, <span class="math inline">\(\boldsymbol{P_{i,t}^e}\)</span> is additionally projected on the orthogonalized spanned factors of the dominant country, indexed by <span class="math inline">\(D\)</span>, as follows:
<span class="math display" id="eq:PricingOrthoNonDU">\[\begin{equation}
    \underset{(N \times 1)}{\vphantom{\Big|}
    \boldsymbol{P_{i,t}^e}} =
    \underset{(N \times N)}{\vphantom{\Big|}
    c_i^D}
    \underset{(N \times 1)}{\vphantom{\Big|}
    \boldsymbol{P_{D,t}^e}} +
    \underset{(N \times 1)}{\vphantom{\Big|}
    \boldsymbol{P_{i,t}^{e*}}}\text{,} \quad  i \neq D,
\tag{14}
\end{equation}\]</span>
where <span class="math inline">\(\boldsymbol{P_{i,t}^{e*}}\)</span> corresponds to the non-dominant country <span class="math inline">\(i\)</span> set of residuals.</p>
<p>The design of the domestic unspanned factors also features two steps: for the dominant economy, <span class="math inline">\(\boldsymbol{M_{D,t}}\)</span> is projected on the global economic factors
<span class="math display" id="eq:MacroOrthoDU">\[\begin{equation}
    \underset{(M \times 1)}{\vphantom{\Big|}
    \boldsymbol{M_{D,t}}} =
    \underset{(M \times G)}{\vphantom{\Big|}
    a_D^W}
    \underset{(G \times 1)}{\vphantom{\Big|}
    \boldsymbol{M_t^W}} +
    \underset{(M \times 1)}{\vphantom{\Big|}
    \boldsymbol{M_{D,t}^e}} \text{,}
\tag{15}
\end{equation}\]</span>
and, for the other economies, the residuals of the previous regression are used to compute
<span class="math display" id="eq:MacroOrthoNonDU">\[\begin{equation}
      \underset{(M \times 1)}{\vphantom{\Big|}
      \boldsymbol{M_{i,t}}} =   
      \underset{(M \times G)}{\vphantom{\Big|}
      a_i^W}  
      \underset{(G \times 1)}{\vphantom{\Big|}
      \boldsymbol{M_t^W}} +   
      \underset{(M \times M)}{\vphantom{\Big|}
      a_i^D}
      \underset{(M \times 1)}{\vphantom{\Big|}
      \boldsymbol{M_{D,t}^e}} +
      \underset{(M \times 1)}{\vphantom{\Big|}
      \boldsymbol{M_{i,t}^{e*}}}\text{.}
\tag{16}
\end{equation}\]</span></p>
<p>Accordingly, the state vector is formed by <span class="math inline">\(\boldsymbol{Z_t^e}= [\boldsymbol{M_t^{W^\top}}\)</span>, <span class="math inline">\(\boldsymbol{M_{D,t}^{e^\top}}\)</span>, <span class="math inline">\(\boldsymbol{P_{D,t}^{e^\top}}\)</span>, <span class="math inline">\(\boldsymbol{M_{2,t}^{e*^\top}}\)</span>, <span class="math inline">\(\boldsymbol{P_{2,t}^{e*^\top}}\)</span> … <span class="math inline">\(\boldsymbol{M_{C,t}^{e*^\top}}\)</span>, <span class="math inline">\(\boldsymbol{P_{C,t}^{e*^\top}}]^\top\)</span> and its dynamics evolve as a restricted VAR(1),
<span class="math display" id="eq:VAROrtho">\[\begin{align}
&amp; \underset{(F \times 1)}{\vphantom{\Big|}
\boldsymbol{Z_t^e}}=
\underset{(F \times 1)}{\vphantom{\Big|}
\boldsymbol{C^{e}_Y}} +
\underset{(F \times F)}{\vphantom{\Big|}
\Phi^e_Y}
\underset{(F \times 1)}{\vphantom{\Big|}
\boldsymbol{Z_{t-1}^e}} +
\underset{(F \times F)}{\vphantom{\Big|}
\Gamma_{Y}^e}
\underset{(F \times 1)}{\vphantom{\Big|}
\boldsymbol{\varepsilon^e_{Z,t}}}\text{,}  &amp;  \boldsymbol{\varepsilon _{Z,t}^{e}} \sim {\mathcal{N}_F}(\boldsymbol{0}_F,\mathrm{I}_F).
\tag{17}
\end{align}\]</span>
JLL (2015) impose a set of zero restrictions on <span class="math inline">\(\Phi^e_Y\)</span> and <span class="math inline">\(\Gamma_{Y}^e\)</span>, with their detailed structure provided in the original study.</p>
<h4 class="unnumbered" data-number="2.3" id="S:ATSMestimation">Estimation procedures</h4>
<p>The approach proposed by JPS (2014) enables an efficient estimation procedure through its structural design. Specifically, the parameters governing the <span class="math inline">\(\mathbb{Q}\)</span>- and <span class="math inline">\(\mathbb{P}\)</span>-measures can be estimated independently. The only exception is the variance-covariance matrix, <span class="math inline">\(\Sigma\)</span>, which appears in both likelihood functions and, therefore, must be estimated jointly.</p>
<p>In JLL (2015), however, the authors adopt a simplified estimation procedure by estimating the <span class="math inline">\(\Sigma\)</span> matrix exclusively under the <span class="math inline">\(\mathbb{P}\)</span>-measure. While they acknowledge that this approach is not fully efficient, they argue that the empirical implications are limited in their application.</p>
<h3 data-number="3" id="S:ATSMoptions"><span class="header-section-number">3</span> The ATSMs available at the MultiATSM package</h3>
<p>As outlined in the previous section, the ATSMs implemented in the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package differ in the specification of their <span class="math inline">\(\mathbb{Q}\)</span>- and <span class="math inline">\(\mathbb{P}\)</span>-measure dynamics. In short, under the <span class="math inline">\(\mathbb{Q}\)</span>-measure, models can be specified either on a country-by-country basis (JPS, 2014) or jointly across countries (JLL, 2015; CM, 2024). Under the <span class="math inline">\(\mathbb{P}\)</span>-measure, risk factor dynamics follow a VAR(1) process, which may be unrestricted, as in the JPS-related frameworks, or restricted, as in the JLL and GVAR specifications.</p>
<p><a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> provides support for eight different classes of ATSMs based on these modelling approaches. These classes vary along several dimensions: the specification of the <span class="math inline">\(\mathbb{P}\)</span>- and <span class="math inline">\(\mathbb{Q}\)</span>-dynamics, the estimation approach, and whether a dominant economy is included. Table <a href="#tab:tab-ModFea-H">1</a> summarizes the defining features of each model class available in the package. A brief overview of these specifications follows below.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:tab-ModFea-H">Table 1: </span>Summary of model features
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="5">
<div style="TRUE">
P-dynamics
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="2">
<div style="TRUE">
Q-dynamics
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="2">
<div style="TRUE">
Sigma matrix estimation
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="1">
<div style="TRUE">
Dom. Eco.
</div>
</th>
</tr>
<tr>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="TRUE">
Single
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="TRUE">
Joint
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Single
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Joint
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
P only
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
P and Q
</div>
</th>
<th style="empty-cells: hide;" colspan="3">
</th>
</tr>
<tr>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
UR
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
R
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
UR
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="TRUE">
R
</div>
</th>
<th style="empty-cells: hide;" colspan="11">
</th>
</tr>
<tr>
<th style="text-align:left;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
JLL
</th>
<th style="text-align:center;font-size: 10px;">
GVAR
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
</tr>
</thead>
<tbody>
<tr grouplength="3">
<td colspan="18" style="background-color: #666; color: #fff;">
<strong>Unrestricted VAR</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
JPS original
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
JPS global
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
JPS multi
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr grouplength="2">
<td colspan="18" style="background-color: #666; color: #fff;">
<strong>Restricted VAR (GVAR)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
GVAR single
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
GVAR multi
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr grouplength="3">
<td colspan="18" style="background-color: #666; color: #fff;">
<strong>Restricted VAR (JLL)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
JLL original
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
x
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
JLL No DomUnit
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;width: 10em; " indentlevel="1">
JLL joint Sigma
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
x
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;width: 4.5em; ">
</td>
<td style="text-align:center;">
x
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Risk factor dynamics under the <span class="math inline">\(\mathbb{P}\)</span>-measure may follow either an unrestricted (UR) or a restricted (R) specification. The set of restrictions present in the JLL-based and GVAR-based models are described in <span class="citation" data-cites="JotikasthiraLeLundblad2015">Jotikasthira et al. (<a href="#ref-JotikasthiraLeLundblad2015" role="doc-biblioref">2015</a>)</span> and <span class="citation" data-cites="CandelonMoura2024">Candelon and Moura (<a href="#ref-CandelonMoura2024" role="doc-biblioref">2024</a>)</span>, respectively. The estimation of the <span class="math inline">\(\Sigma\)</span> matrix is done either exclusively with the other parameters of the <span class="math inline">\(\mathbb{P}\)</span>-dynamics (<em>P</em> column) or jointly under both <span class="math inline">\(\mathbb{P}\)</span>- and <span class="math inline">\(\mathbb{Q}\)</span>-parameters (<em>P and Q</em> column). <em>Dom. Eco.</em> relates to the presence of a dominant economy. The entries featuring <em>x</em> indicate that the referred characteristic is part of the model.
</td>
</tr>
</tfoot>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>The ATSMs in which the estimation is performed separately for each country are labeled as <code>JPS original</code>, <code>JPS global</code> and <code>GVAR single</code>. In the <code>JPS original</code> setup, the set of risk factors includes exclusively each country’s domestic variables and the global unspanned factors, whereas <code>JPS global</code> and <code>GVAR single</code> also incorporate domestic risk factors of the other countries of the economic system. Noticeably, the difference between <code>JPS global</code> and <code>GVAR single</code> stem from the set of restrictions imposed under the <span class="math inline">\(\mathbb{P}\)</span>-dynamics.</p>
<p>Within the multicountry frameworks, certain features are worth noting. The <code>JLL original</code> model reproduces the setup in JLL (2015), assuming an economic cohort composed of a globally dominant economy and a set of smaller countries, and estimating the <span class="math inline">\(\Sigma\)</span> matrix exclusively under the <span class="math inline">\(\mathbb{P}\)</span>-measure. The two alternative versions assume the absence of a dominant country (<code>JLL No DomUnit</code>) and the estimation of <span class="math inline">\(\Sigma\)</span> under both the <span class="math inline">\(\mathbb{P}\)</span> and <span class="math inline">\(\mathbb{Q}\)</span> measures (<code>JLL joint Sigma</code>), as in JPS (2014). The remaining specifications differ in their <span class="math inline">\(\mathbb{P}\)</span>-dynamics: either by an unrestricted VAR model (<code>JPS multi</code>) or by a GVAR setup (<code>GVAR multi</code>), as proposed in CM (2024).</p>
<h3 data-number="4" id="S:SectionData"><span class="header-section-number">4</span> Package dataset</h3>
<p>The <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package provides datasets that approximate those used in the GVAR-based ATSMs of <span class="citation" data-cites="CandelonMoura2023">Candelon and Moura (<a href="#ref-CandelonMoura2023" role="doc-biblioref">2023</a>)</span> and CM (2024). The data requirements for estimating GVAR models encompass those of all other model classes, making them suitable for generating outputs across all models supported by the package. As such, the examples in the following sections use the dataset from CM (2024).</p>
<p>The <code>LoadData()</code> function provides access to the datasets included in the package. To load the data from CM (2024), set the argument to <code>CM_2024</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LoadData.html'>LoadData</a></span><span class='op'>(</span><span class='st'>"CM_2024"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>This function returns three sets of data. The first contains time series of zero-coupon bond yields for four emerging market economies: China, Brazil, Mexico, and Uruguay. The data spans monthly intervals from June 2004 to January 2020. For the purpose of model estimation, the package requires that <em>(i)</em> bond yield maturities are the same across all countries;<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> and <em>(ii)</em> yields must be expressed in annualized percentage terms (not basis points). Note that the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package does not provide routines for bootstrapping zero-coupon yields from coupon bonds, so any such treatment must be handled by the user.</p>
<p>The second dataset comprises time series for unspanned risk factors — specifically, the macroeconomic indicators economic growth and inflation — covering the same period as the bond yield data. These data cover both <em>(i)</em> domestic variables for each of the four countries in the sample and <em>(ii)</em> corresponding global indicators. The construction of unspanned risk factors, like that of bond yields, must be carried out externally by the user.</p>
<p>The final dataset contains measures of interconnectedness, proxied by trade flows, which are specifically required for estimating the GVAR-based models. The trade flow data report the annual value of goods imported and exported between each pair of countries in the sample, starting from 1948. All values are expressed in U.S. dollars on a free-on-board basis. These data are used to construct the transition matrix in the GVAR framework.</p>
<h3 data-number="5" id="S:SectionInputs"><span class="header-section-number">5</span> Required user inputs</h3>
<h4 class="unnumbered" data-number="5.1" id="fundamental-inputs">Fundamental inputs</h4>
<p>To estimate any model, the user must specify several general inputs, which can be grouped into the following categories:</p>
<ol type="1">
<li><p>Desired ATSM class (<code>ModelType</code>): a character vector containing the label of the model to be estimated as described in Table <a href="#tab:tab-ModFea-H">1</a>;</p></li>
<li><p>Risk Factor Features. This includes the following list of elements:</p></li>
</ol>
<ul>
<li><p>Set of economies (<code>Economies</code>): a character vector containing the names of the economies which are part of the economic system;</p></li>
<li><p>Global variables (<code>GlobalVar</code>): a character vector containing the labels of the <span class="math inline">\(G\)</span> global unspanned factors. Studies examining the impact of global developments on bond prices could include proxy measures of global inflation and global economic activity in this category <span class="citation" data-cites="JotikasthiraLeLundblad2015 AbbrittiDellErbaMorenoSola2018 CandelonMoura2024">(<a href="#ref-JotikasthiraLeLundblad2015" role="doc-biblioref">Jotikasthira et al. 2015</a>; <a href="#ref-AbbrittiDellErbaMorenoSola2018" role="doc-biblioref">Abbritti et al. 2018</a>; <a href="#ref-CandelonMoura2024" role="doc-biblioref">Candelon and Moura 2024</a>)</span>;</p></li>
<li><p>Domestic variables (<code>DomVar</code>): a character vector containing the labels of the <span class="math inline">\(M\)</span> domestic unspanned factors. These typically correspond to measures of domestic inflation and economic activity, the standard macroeconomic indicators monitored by central banks <span class="citation" data-cites="AngPiazzesi2003 JoslinPriebschSingleton2014 JotikasthiraLeLundblad2015 CandelonMoura2024">(<a href="#ref-AngPiazzesi2003" role="doc-biblioref">Ang and Piazzesi 2003</a>; <a href="#ref-JoslinPriebschSingleton2014" role="doc-biblioref">Joslin et al. 2014</a>; <a href="#ref-JotikasthiraLeLundblad2015" role="doc-biblioref">Jotikasthira et al. 2015</a>; <a href="#ref-CandelonMoura2024" role="doc-biblioref">Candelon and Moura 2024</a>)</span>;</p></li>
<li><p>Number of spanned factors (<span class="math inline">\(N\)</span>): a scalar representing the number of country-specific spanned factors. Although, in principle, <span class="math inline">\(N\)</span> could vary across countries, the models provided in the package assume a common value of <span class="math inline">\(N\)</span> for all countries.
A common choice in the literature is <span class="math inline">\(N=3\)</span>, as in JPS (2014) and CM (2024), since this produces an excellent cross-sectional fit of bond yields (<span class="citation" data-cites="LittermanScheinkman1991">Litterman and Scheinkman (<a href="#ref-LittermanScheinkman1991" role="doc-biblioref">1991</a>)</span>).
Other studies, such as <span class="citation" data-cites="AdrianCrumpMoench2013">Adrian et al. (<a href="#ref-AdrianCrumpMoench2013" role="doc-biblioref">2013</a>)</span>, extend the specification to <span class="math inline">\(N=5\)</span>, arguing that it improves the performance of model-implied term premia. Further intuition on the role and interpretation of spanned factors is provided in Section <a href="#S:SpaFac">6.1</a>.</p></li>
</ul>
<ol start="3" type="1">
<li>Sample span:</li>
</ol>
<ul>
<li><p>Initial sample date (<code>t0</code>): the start of the sample period in the format <em>dd-mm-yyyy</em>;</p></li>
<li><p>End sample date (<code>tF</code>): the end of the sample period in the format <em>dd-mm-yyyy</em>.</p></li>
</ul>
<ol start="4" type="1">
<li><p>Data Frequency (<code>DataFreq</code>): a character vector specifying the frequency of the time series data. The available options are: <code>Annually</code>, <code>Quarterly</code>, <code>Monthly</code>, <code>Weekly</code>, <code>Daily Business Days</code>, and <code>Daily All Days</code>;</p></li>
<li><p>Stationarity constraint under the <span class="math inline">\(\mathbb{Q}\)</span>-dynamics (<code>StatQ</code>): a logical that takes <code>TRUE</code> if the user wishes to impose that the largest eigenvalue under the <span class="math inline">\(\mathbb{Q}\)</span>-measure, <span class="math inline">\(\lambda^Q_i\)</span>, is strictly less than 1. While enforcing this stationarity constraint may increase estimation time, it can improve convergence and numerical stability. Moreover, by inducing near-cointegration, the eigenvalue restriction helps to pin down more plausible dynamics for bond risk premia <span class="citation" data-cites="BauerRudebuschWu2012 JoslinPriebschSingleton2014">(<a href="#ref-BauerRudebuschWu2012" role="doc-biblioref">Bauer et al. 2012</a>; <a href="#ref-JoslinPriebschSingleton2014" role="doc-biblioref">Joslin et al. 2014</a>)</span>;</p></li>
<li><p>Selected folder to save the graphical outputs (<code>Folder2Save</code>): path where the selected graphical outputs will be saved. If set to <code>NULL</code>, the outputs are stored in the user’s temporary directory (accessible via <code>tempdir()</code>);</p></li>
<li><p>Output label (<code>OutputLabel</code>): A single-element character vector containing the name used in the file name that stores the model outputs.</p></li>
</ol>
<p>The following provides an example of the basic model input specification:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ModelType</span> <span class='op'>&lt;-</span> <span class='st'>"JPS original"</span></span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Brazil"</span>, <span class='st'>"Mexico"</span>, <span class='st'>"Uruguay"</span><span class='op'>)</span></span>
<span><span class='va'>GlobalVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Gl_Eco_Act"</span>, <span class='st'>"Gl_Inflation"</span><span class='op'>)</span></span>
<span><span class='va'>DomVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Eco_Act"</span>, <span class='st'>"Inflation"</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>3</span></span>
<span><span class='va'>t0</span> <span class='op'>&lt;-</span> <span class='st'>"01-07-2005"</span></span>
<span><span class='va'>tF</span> <span class='op'>&lt;-</span> <span class='st'>"01-12-2019"</span></span>
<span><span class='va'>DataFreq</span> <span class='op'>&lt;-</span> <span class='st'>"Monthly"</span></span>
<span><span class='va'>StatQ</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='va'>Folder2Save</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span><span class='va'>OutputLabel</span> <span class='op'>&lt;-</span> <span class='st'>"Model_demo"</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="5.2" id="model-specific-inputs">Model-specific inputs</h4>
<h5 class="unnumbered" data-number="5.2.1" id="S:SectionGVARJLLinputs">GVARlist and JLLlist</h5>
<p>The inputs described above are sufficient for estimating all variants of the JPS models presented in Table <a href="#tab:tab-ModFea-H">1</a>. However, estimating the GVAR or JLL setups requires additional elements. For clarity, these extra inputs should be organized into separate lists for each model. This section outlines the general structure of both lists, while Section <a href="#S:PdynEst">6.2</a> provide a more detailed explanations of their components and available options, reflecting the broader scope of each setup.</p>
<p>For GVAR models, the required inputs are twofold. First, the user must specify the dynamic structure of each country’s VARX model. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>VARXtype</span> <span class='op'>&lt;-</span> <span class='st'>"unconstrained"</span></span></code></pre>
</div>
</div>
<p>Next, provide the desired inputs to build the transition matrix. For instance:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>'TradeFlows'</span><span class='op'>)</span></span>
<span><span class='va'>W_type</span> <span class='op'>&lt;-</span> <span class='st'>"Sample Mean"</span></span>
<span><span class='va'>t_First_Wgvar</span> <span class='op'>&lt;-</span> <span class='st'>"2000"</span></span>
<span><span class='va'>t_Last_Wgvar</span> <span class='op'>&lt;-</span> <span class='st'>"2015"</span></span>
<span><span class='va'>DataConnectedness</span> <span class='op'>&lt;-</span> <span class='va'>TradeFlows</span> </span></code></pre>
</div>
</div>
<p>Based on these inputs, a complete instance of the <code>GVARlist</code> object is</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>GVARlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>VARXtype <span class='op'>=</span> <span class='st'>"unconstrained"</span>, W_type <span class='op'>=</span> <span class='st'>"Sample Mean"</span>, </span>
<span>                 t_First_Wgvar <span class='op'>=</span> <span class='st'>"2000"</span>, t_Last_Wgvar <span class='op'>=</span> <span class='st'>"2015"</span>, </span>
<span>                 DataConnectedness <span class='op'>=</span> <span class='va'>TradeFlows</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<p>For the JLL frameworks, if the chosen model is either <code>JLL original</code> or <code>JLL joint Sigma</code>, it suffices to specify the name of the dominant economy. Otherwise, for the <code>JLL No DomUnit</code> class, the user must set <code>None</code>. For instance:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>## Example for "JLL original" and "JLL joint Sigma" models</span></span>
<span><span class='va'>JLLlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>DomUnit <span class='op'>=</span>  <span class='st'>"China"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>## For "JLL No DomUnit" model</span></span>
<span><span class='va'>JLLlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>DomUnit <span class='op'>=</span>  <span class='st'>"None"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h5 class="unnumbered" data-number="5.2.2" id="S:SectionBRWinputs">BRWlist</h5>
<p>In an influential paper, <span class="citation" data-cites="BauerRudebuschWu2012">Bauer et al. (<a href="#ref-BauerRudebuschWu2012" role="doc-biblioref">2012</a>)</span> (henceforth BRW, 2012) show that estimates from traditional ATSMs often suffer from severe small-sample bias. This can lead to unrealistically stable expectations for future short-term interest rates and, consequently, distort term premium estimates for long-maturity bonds. To address this issue, BRW (2012) propose an indirect inference estimator based on a stochastic approximation algorithm, which corrects for bias and enhances the persistence of short-term interest rates, resulting in more plausible term premium dynamics.</p>
<p>It is worth noting that this framework serves as a complementary feature to the core ATSMs and can therefore be applied to any of the model types supported by the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package. If the user intends to implement a model following the BRW (2012) approach, a few additional inputs must be specified. These include:</p>
<ul>
<li><p>Mean or median of physical dynamic estimates (<code>Cent_Measure</code>): compute the mean or the median of the <span class="math inline">\(\mathbb{P}\)</span>-dynamics estimates after each bootstrap iteration by setting the option to <code>Mean</code> (for the mean) or <code>Median</code> (for the median);</p></li>
<li><p>Adjustment parameter (<code>gamma</code>): this parameter controls the degree of shrinkage applied to the difference between the estimates prior to the bias correction and the bootstrap-based estimates after each iteration. It remains fixed across iterations and must lie in the interval <span class="math inline">\((0,1)\)</span>;</p></li>
<li><p>Number of iteration (<code>N_iter</code>) : total number of iterations used
in the stochastic approximation algorithm after burn-in;</p></li>
<li><p>Number of bootstrap samples (<code>B</code>): quantity of simulated samples
used in each burn-in or actual iteration;</p></li>
<li><p>Perform closeness check (<code>checkBRW</code>): indicates whether the user wishes to compute the root mean square distance between the model estimates obtained through the bias-correction method and those generated via no bias-correction. The default is <code>TRUE</code>;</p></li>
<li><p>Number of bootstrap samples used in the closeness check (<code>B_check</code>):
default is equal to 100,000 samples;</p></li>
<li><p>Eigenvalue restriction (<code>Eigen_rest</code>): impose a restriction on the largest eigenvalue under the <span class="math inline">\(P\)</span>-measure after applying the bias correction procedure. Default is <span class="math inline">\(1\)</span>;</p></li>
<li><p>Number of burn-in iteration (<code>N_burn</code>): quantity of the iterations
to be discarded in the first stage of the bias-correction estimation
process. The recommended number is <span class="math inline">\(15\%\)</span> of the total number of
iterations. In practice, this resembles the burn-in concept in Markov chain Monte Carlo methods. Particularly, the BRW (2012) stochastic approximation algorithm is iterative, and for a sufficiently large number of iterations, the parameters converge to their true values. As such, discarding early iterations avoids the need for assessing a computationally costly exit condition.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>BRWlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>within</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Cent_Measure <span class='op'>=</span> <span class='st'>"Mean"</span>, gamma <span class='op'>=</span> <span class='fl'>0.2</span>, N_iter <span class='op'>=</span> <span class='fl'>500</span>, B <span class='op'>=</span> <span class='fl'>50</span>, </span>
<span>                       checkBRW <span class='op'>=</span> <span class='cn'>TRUE</span>, B_check <span class='op'>=</span> <span class='fl'>1000</span>, Eigen_rest <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, </span>
<span>                       <span class='va'>N_burn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N_iter</span> <span class='op'>*</span> <span class='fl'>0.15</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="5.3" id="S:SectionNumOut">Additional inputs for numerical and graphical outputs</h4>
<p>Once the desired features are selected and the parameters of the chosen ATSM have been estimated, the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package provides tools to generate the following numerical and graphical outputs
via the <code>NumOutputs()</code> function:</p>
<ul>
<li>Time-series dynamics of the risk factors;</li>
<li>Model fit of the bond yields;</li>
<li>Orthogonalized impulse response functions (IRFs);</li>
<li>Orthogonalized forecast error variance decompositions (FEVDs);</li>
<li>Generalized impulse response functions (GIRFs);</li>
<li>Generalized forecast error variance decompositions (GFEVDs);</li>
<li>Decomposition of bond yields into expected and term premia components.</li>
</ul>
<p>These outputs are organized into distinct analytical components, each offering different insights into model behavior and its economic interpretation.</p>
<p>The time-series dynamics of the risk factors are displayed in separate subplots: one for each global factor, and one subplot per domestic risk factor showing all countries in the economic system. The model fit of the bond yields is provided through two measures of model-implied yields. The first is a fitted measure derived solely from the cross-sectional component, as in Equation <a href="#eq:AffineYieldsSpanned">(5)</a> for single-country models and Equation <a href="#eq:AffineYieldsSpannedMultiCountry">(6)</a> for multicountry setups. This measure reflects the fit based exclusively on the parameters governing the <span class="math inline">\(\mathbb{Q}\)</span>-dynamics. The second incorporates both the physical and risk-neutral dynamics, combining the cross-sectional equations with the state evolution specified by each ATSM.</p>
<p>The impulse response functions and variance decompositions are available in both orthogonalized and generalized forms. The orthogonalized outputs (IRFs and FEVDs) are computed using a short-run recursive identification scheme, meaning they depend on the ordering of the selected risk factors. Specifically, the package is structured to place global unspanned factors first, followed by its domestic unspanned and spanned factors within each country, in the order in which countries are listed in the <code>Economies</code> vector. In contrast, the generalized versions (GIRFs and GFEVDs) are robust to factor ordering but allow for correlated shocks across risk factors <span class="citation" data-cites="PesaranShin1998">(<a href="#ref-PesaranShin1998" role="doc-biblioref">Pesaran and Shin 1998</a>)</span>. For the numerical computation of these outputs, a horizon of analysis has to be specified, <em>e.g.</em>, <code>Horiz &lt;- 100</code>.</p>
<p>The bond yield decomposition can be performed with respect to two measures of risk compensation: term premia and forward premia. While the term premium is derived directly from the bond yield levels, the forward premium is obtained from the decomposition of forward rates. A more formal presentation of both measures is provided in the Appendix.</p>
<p>Users must specify the desired graph types in a character vector. Available options include: <code>RiskFactors</code>, <code>Fit</code>, <code>IRF</code>, <code>FEVD</code>, <code>GIRF</code>, <code>GFEVD</code>, and <code>TermPremia</code>. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>DesiredGraphs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Fit"</span>, <span class='st'>"GIRF"</span>, <span class='st'>"GFEVD"</span>, <span class='st'>"TermPremia"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Moreover, for all models, users must indicate the types of variables of interest (yields, risk factors, or both). For JLL-type models specifically, users must also specify whether to include the orthogonalized versions. Each of these options should be set to <code>TRUE</code> to generate the corresponding graphs, and <code>FALSE</code> otherwise.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>WishGraphRiskFac</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='va'>WishGraphYields</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span><span class='va'>WishOrthoJLLgraphs</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span></code></pre>
</div>
</div>
<p>The desired graphical outputs are stored in the selected folder, <code>Folder2Save</code>. Alternatively, users can display the desired plots directly in the console without saving them to <code>Folder2Save</code> by using the <code>autoplot()</code> method.</p>
<h5 class="unnumbered" data-number="5.3.1" id="S:SectionBootstrap">Bootstrap settings</h5>
<p><span class="citation" data-cites="Horowitz2019">Horowitz (<a href="#ref-Horowitz2019" role="doc-biblioref">2019</a>)</span> shows that bootstrap methods generally produce more accurate statistical inference than those based on asymptotic distribution theory. To generate confidence intervals
using bootstrap, via the <code>Bootstrap()</code> function, an additional list of inputs must be provided:</p>
<ul>
<li>Desired bootstrap procedure (<code>methodBS</code>): the user must select one of the following options: <em>(i)</em> standard residual bootstrap (<code>bs</code>); <em>(ii)</em> wild bootstrap (<code>wild</code>); or <em>(iii)</em> block bootstrap (<code>block</code>). If the block bootstrap is selected, the block length must also be specified.
The residual bootstrap is a conventional method that is straightforward to implement when a parametric model, such as a VAR model, is available. The block bootstrap makes weaker assumptions about the data-generating process and is well-suited to handling both weak and strong serial dependence. The wild bootstrap is particularly appropriate for data exhibiting heteroskedasticity <span class="citation" data-cites="Horowitz2019">(<a href="#ref-Horowitz2019" role="doc-biblioref">Horowitz 2019</a>)</span>;</li>
<li>Number of bootstrap draws (<code>ndraws</code>): <span class="citation" data-cites="KilianLutkepohl2017">Kilian and Lütkepohl (<a href="#ref-KilianLutkepohl2017" role="doc-biblioref">2017</a>)</span> suggest that, in VAR specifications, <code>ndraws</code> can range from a few hundred to several thousand, depending on factors such as sample size, lag order, and the desired quantiles of the distribution. Illustrating this, CM (2024) set <span class="math inline">\(ndraws= 1,000\)</span> in their ATSM to construct confidence intervals for IRFs;</li>
<li>Confidence level expressed (<code>pctg</code>): the desired confidence level should be expressed in percentage points. Common choices in VAR-related setups include <span class="math inline">\(68\%\)</span>, <span class="math inline">\(90\%\)</span> and <span class="math inline">\(95\%\)</span> <span class="citation" data-cites="KilianLutkepohl2017">(<a href="#ref-KilianLutkepohl2017" role="doc-biblioref">Kilian and Lütkepohl 2017</a>)</span>.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>Bootlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>methodBS <span class='op'>=</span> <span class='st'>'block'</span>, BlockLength <span class='op'>=</span> <span class='fl'>4</span>, ndraws <span class='op'>=</span>  <span class='fl'>1000</span>, pctg   <span class='op'>=</span>  <span class='fl'>95</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h5 class="unnumbered" data-number="5.3.2" id="S:SectionForecast">Out-of-sample forecast settings</h5>
<p>To generate bond yield forecasts, use <code>ForecastYields()</code> with the following inputs:</p>
<ul>
<li>Forecast horizon (<code>ForHoriz</code>): Number of forecast horizons in periods;</li>
<li>Index of the first observation (<code>t0Sample</code>): time index of the first observation included in the information set;</li>
<li>Index of the last observation (<code>t0Forecast</code>): time index of the last observation in the information set used to generate the first forecast;</li>
<li>Method used for forecast computation (<code>ForType</code>): forecasts can be generated using either a rolling or expanding window. To use a rolling window, set this parameter to <code>Rolling</code>. In this case, the sample length for each forecast is fixed and defined by <code>t0Sample</code>. For expanding window forecasts, set this input to <code>Expanding</code>, allowing the information set to increase at each forecast iteration.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ForecastList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ForHoriz <span class='op'>=</span> <span class='fl'>12</span>, t0Sample <span class='op'>=</span> <span class='fl'>1</span>, t0Forecast <span class='op'>=</span> <span class='fl'>70</span>, ForType <span class='op'>=</span> <span class='st'>"Rolling"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="6" id="S:SectionEstimation"><span class="header-section-number">6</span> Model estimation</h3>
<p>Using the dataset described in Section <a href="#S:SectionData">4</a>, the estimation of the ATSM proceeds in three main steps. First, the country-specific spanned factors are estimated, which, along with the global and domestic unspanned factors, form the complete set of risk factors used in the subsequent estimation steps. Second, the package estimates the parameters governing the dynamics of the risk factors under the <span class="math inline">\(\mathbb{P}\)</span>-measure. Finally, it optimizes the full ATSM specification, including the parameters under the <span class="math inline">\(\mathbb{Q}\)</span>-measure.</p>
<p>As will be made clear in Section <a href="#S:SectionImplementation">7</a>, although the functions introduced in this section can be used individually, they are primarily designed to be used together with the broader set of functions available in the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package. However, as these functions play a central role in the package structure, they warrant a dedicated section.</p>
<h4 class="unnumbered" data-number="6.1" id="S:SpaFac">Spanned factors</h4>
<p>The spanned factors for country <span class="math inline">\(i\)</span>, denoted by <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span>, are typically obtained as the first <span class="math inline">\(N\)</span> principal components (PCs) of the observed bond yields. The PC method provides orthogonal linear combinations of the original variables, ordered by their ability to capture the variance in the data. Formally, <span class="math inline">\(\boldsymbol{P_{i,t}}\)</span> is computed as <span class="math inline">\(\boldsymbol{P_{i,t}} = w_i \boldsymbol{Y_{i,t}}\)</span>, where yields are ordered by increasing maturity in <span class="math inline">\(\boldsymbol{Y_{i,t}}\)</span>, and <span class="math inline">\(w_i\)</span> is the matrix of eigenvectors derived from the covariance matrix of <span class="math inline">\(\boldsymbol{Y_{i,t}}\)</span>.</p>
<p>In the case of <span class="math inline">\(N = 3\)</span>, the spanned factors are traditionally interpreted as level, slope, and curvature components of the yield curve <span class="citation" data-cites="LittermanScheinkman1991">(<a href="#ref-LittermanScheinkman1991" role="doc-biblioref">Litterman and Scheinkman 1991</a>)</span>. This interpretation stems from the properties of the <span class="math inline">\(w_i\)</span> matrix, as illustrated below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>'Yields'</span><span class='op'>)</span></span>
<span><span class='va'>w</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/pca_weights_one_country.html'>pca_weights_one_country</a></span><span class='op'>(</span><span class='va'>Yields</span>, Economy <span class='op'>=</span> <span class='st'>"Uruguay"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In matrix <em>w</em>, each row holds the weights for constructing a spanned factor. The first row relates to the level factor, with weights loading roughly equally across maturities. As such, high (low) values of the level factor indicate an overall high (low) value of yields across all maturities. The second row features increasing weights with maturity, capturing the slope of the yield curve: high values indicate steep curves, while low values reflect flat or inverted curves. The third row corresponds to the curvature factor, with weights emphasizing medium-term maturities. This captures the ‘hump-shaped’ features of the yield curve typically associated with changes in its curvature. These concepts are also graphically illustrated in Figure <a href="#fig:pca-H">1</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:pca-H"></span>
<img src="RJ-2025-044_files/figure-html5/pca-H-1.png" alt="Yield loadings on the spanned factors. Example using bond yield data for Uruguay. Graph generated using the ggplot2 package [@ggplot22016]." width="624" />
<p class="caption">
Figure 1: Yield loadings on the spanned factors. Example using bond yield data for Uruguay. Graph generated using the ggplot2 package <span class="citation" data-cites="ggplot22016">(<a href="#ref-ggplot22016" role="doc-biblioref">Wickham 2016</a>)</span>.
</p>
</div>
</div>
<p>The user can directly obtain the time series of the country-specific spanned factors by calling <code>Spanned_Factors()</code>, as shown below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>'Yields'</span><span class='op'>)</span></span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"China"</span>, <span class='st'>"Brazil"</span>, <span class='st'>"Mexico"</span>, <span class='st'>"Uruguay"</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>2</span></span>
<span><span class='va'>SpaFact</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Spanned_Factors.html'>Spanned_Factors</a></span><span class='op'>(</span><span class='va'>Yields</span>, <span class='va'>Economies</span>, <span class='va'>N</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="6.2" id="S:PdynEst">The P-dynamics estimation</h4>
<p>As presented in Table <a href="#tab:tab-ModFea-H">1</a> and explained in detail in Section <a href="#S:ATSMTheory">2</a>, the dynamics of the risk factors under the <span class="math inline">\(\mathbb{P}\)</span>-measure in the available models follow a VAR(1) process. This specification can be fully unrestricted, as in the JPS-related models, or subject to restrictions, as in the GVAR and JLL frameworks. This subsection illustrates how each of these model configurations is implemented.</p>
<h5 class="unnumbered" data-number="6.2.1" id="S:SectionVAR">VAR</h5>
<p>To use <code>VAR()</code>, the user needs to select the appropriate set of risk factors for the model being estimated and specify <code>unconstrained</code> in the argument <code>VARtype</code>. In the two examples presented below, the outputs are the intercept vector, the feedback matrix, and the variance–covariance matrix for a VAR(1) model under the <span class="math inline">\(\mathbb{P}\)</span>-measure:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>## Example 1: "JPS global" and "JPS multi" models</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"RiskFacFull"</span><span class='op'>)</span></span>
<span><span class='va'>PdynPara</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/VAR.html'>VAR</a></span><span class='op'>(</span><span class='va'>RiskFacFull</span>, VARtype <span class='op'>=</span> <span class='st'>"unconstrained"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>## Example 2: "JPS original" model for China </span></span>
<span><span class='va'>FactorsChina</span> <span class='op'>&lt;-</span> <span class='va'>RiskFacFull</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>7</span>, <span class='op'>]</span></span>
<span><span class='va'>PdynPara</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/VAR.html'>VAR</a></span><span class='op'>(</span><span class='va'>FactorsChina</span>, VARtype <span class='op'>=</span> <span class='st'>"unconstrained"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h5 class="unnumbered" data-number="6.2.2" id="S:SectionGVAR">GVAR</h5>
<p>The <code>GVAR()</code> function estimates a GVAR(1) model constructed from country-specific VARX<span class="math inline">\(^{*}(1,1,1)\)</span> specifications. It requires two main inputs: the number of domestic spanned factors (<span class="math inline">\(N\)</span>) and a set of elements grouped in the <code>GVARinputs</code> list. The latter consists of four components:</p>
<ol type="1">
<li><p>Economies: a <span class="math inline">\(C-\)</span>dimensional character vector containing the names of the economies present in the economic system;</p></li>
<li><p>GVAR list of risk factors: a list of risk factors sorted by country in addition to the global variables. An example of the expected data structure is:</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"GVARFactors"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>To assist in formatting the data accordingly, users may use the <code>DatabasePrep()</code> function;</p>
<ol start="3" type="1">
<li>VARX type: a character vector specifying the desired structure of the VARX<span class="math inline">\(^{*}\)</span> model. Two general options are available:</li>
</ol>
<ul>
<li><p>Fully unconstrained: specify as <code>unconstrained</code>. This option estimates each equation in the system separately via ordinary least squares, without imposing any restrictions.</p></li>
<li><p>With constraints: imposes specific set of zero restrictions on the feedback matrix. This category includes two sub-options:
<em>(a)</em> <code>constrained: Spanned Factors</code> prevents foreign spanned factors from affecting any domestic risk factor;
<em>(b)</em> <code>constrained: [factor name]</code> restricts the specified risk factor to be influenced only by its own lags and the lags of its associated star variables. In both cases, the VARX<span class="math inline">\(^{*}\)</span> is estimated using restricted least squares.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>'GVARFactors'</span><span class='op'>)</span></span>
<span><span class='va'>GVARinputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Economies <span class='op'>=</span> <span class='va'>Economies</span>, GVARFactors <span class='op'>=</span> <span class='va'>GVARFactors</span>, </span>
<span>                   VARXtype <span class='op'>=</span><span class='st'>"constrained: Inflation"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Transition matrix: a <span class="math inline">\(C \times C\)</span> matrix that captures the degree of interdependence across the countries in the system. Each entry <span class="math inline">\((i,j)\)</span> represents the strength of the dependence of economy <span class="math inline">\(i\)</span> on economy <span class="math inline">\(j\)</span>. As an example, the matrix below is computed from bilateral trade flow data, averaged over the period 2006–2019, for a system comprising China, Brazil, Mexico, and Uruguay. The rows are normalized so that the weights sum to <span class="math inline">\(1\)</span> for each country (i.e., each row of the matrix sums to <span class="math inline">\(1\)</span>).
The transition matrix can be generated using <code>Transition_Matrix()</code>, as illustrated in the Appendix :</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<pre><code>         China Brazil Mexico Uruguay
China   0.0000 0.6549 0.3155  0.0296
Brazil  0.8269 0.0000 0.1234  0.0497
Mexico  0.8596 0.1326 0.0000  0.0078
Uruguay 0.3811 0.5498 0.0691  0.0000</code></pre>
</div>
<p>With inputs specified, the user can estimate a GVAR model using:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"GVARFactors"</span><span class='op'>)</span></span>
<span><span class='va'>GVARinputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Economies <span class='op'>=</span> <span class='va'>Economies</span>, GVARFactors <span class='op'>=</span> <span class='va'>GVARFactors</span>,  </span>
<span>                   VARXtype <span class='op'>=</span> <span class='st'>"unconstrained"</span>, Wgvar <span class='op'>=</span> <span class='va'>W_gvar</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>3</span></span>
<span><span class='va'>GVARpara</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/GVAR.html'>GVAR</a></span><span class='op'>(</span><span class='va'>GVARinputs</span>, <span class='va'>N</span>, CheckInputs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Note that the <code>CheckInputs</code> parameter should be set to TRUE to perform a consistency check on the inputs specified in <code>GVARinputs</code> prior to the <span class="math inline">\(\mathbb{P}\)</span>-dynamics estimation.</p>
<h5 class="unnumbered" data-number="6.2.3" id="S:SectionJLL">JLL</h5>
<p>The <code>JLL()</code> function estimates the physical parameters. Required inputs are:</p>
<ol type="1">
<li><p>Risk factors: a time series matrix of the risk factors in their non-orthogonalized form;</p></li>
<li><p>Number of spanned factors (<span class="math inline">\(N\)</span>): a scalar representing the number of country-specific spanned factors;</p></li>
<li><p><code>JLLinputs</code>: a list object containing the following elements:</p></li>
</ol>
<ul>
<li><p>Economies: a <span class="math inline">\(C\)</span>-dimensional character vector listing the economies;</p></li>
<li><p>Dominant Economy: a character vector indicating either the name of the country assigned as the dominant economy (for <code>JLL original</code> and <code>JLL jointSigma</code> models), or <code>None</code> (for the <code>JLL No DomUnit</code> case);</p></li>
<li><p>Estimate Sigma Matrices: a logical equal to <code>TRUE</code> if the user wishes to estimate the full set of JLL sigma matrices (i.e., variance-covariance and Cholesky factor matrices), and <code>FALSE</code> otherwise. Since this numerical estimation is costly, it may significantly increase computation time;</p></li>
<li><p>Precomputed Variance-Covariance Matrix: in some instances, a precomputed variance-covariance matrix from the non-orthogonalized dynamics can be supplied here to save time and memory. If no such matrix is available, this input should be set to <code>NULL</code>;</p></li>
<li><p>JLL type: a character string specifying the chosen JLL model, following the classification described in Table <a href="#tab:tab-ModFea-H">1</a>.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>## First set the JLLinputs </span></span>
<span><span class='va'>ModelType</span> <span class='op'>&lt;-</span> <span class='st'>"JLL original"</span>   </span>
<span><span class='va'>JLLinputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Economies <span class='op'>=</span> <span class='va'>Economies</span>, DomUnit <span class='op'>=</span> <span class='st'>"China"</span>, WishSigmas <span class='op'>=</span> <span class='cn'>TRUE</span>,  </span>
<span>                  SigmaNonOrtho <span class='op'>=</span> <span class='cn'>NULL</span>, JLLModelType <span class='op'>=</span> <span class='va'>ModelType</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>## Then, estimate the desired the P-dynamics from the desired JLL model</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"RiskFacFull"</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>3</span></span>
<span><span class='va'>JLLpara</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/JLL.html'>JLL</a></span><span class='op'>(</span><span class='va'>RiskFacFull</span>, <span class='va'>N</span>, <span class='va'>JLLinputs</span>, CheckInputs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The <code>CheckInputs</code> input is set to <code>TRUE</code> to perform a consistency check on the inputs specified in <code>JLLinputs</code> before running the <span class="math inline">\(\mathbb{P}\)</span>-dynamics estimation.</p>
<h4 class="unnumbered" data-number="6.3" id="atsm-estimation">ATSM estimation</h4>
<p>Estimating the ATSM parameters involves maximizing the log-likelihood function to obtain the best-fitting model parameters using <code>Optimization()</code>. The unspanned risk factor framework of JPS (2014) (and, therefore, all its multicountry extensions) follows a model parameterization similar to that proposed in <span class="citation" data-cites="JoslinSingletonZhu2011">Joslin et al. (<a href="#ref-JoslinSingletonZhu2011" role="doc-biblioref">2011</a>)</span>. Particularly, it requires estimating a set of six parameter blocks:</p>
<ol type="1">
<li><p>The risk-neutral long-run mean of the short rate (<span class="math inline">\(r0\)</span>);</p></li>
<li><p>The risk-neutral feedback matrix (<span class="math inline">\(K1XQ\)</span>);</p></li>
<li><p>Standard deviation of measurement errors for yields observed with error (<span class="math inline">\(se\)</span>);</p></li>
<li><p>The variance-covariance matrix from the VAR process (<span class="math inline">\(SSZ\)</span>);</p></li>
<li><p>The intercept matrix of the physical dynamics (<span class="math inline">\(K0Z\)</span>);</p></li>
<li><p>The feedback matrix of the physical dynamics (<span class="math inline">\(K1Z\)</span>).</p></li>
</ol>
<p>The parameters <span class="math inline">\(K0Z\)</span> and <span class="math inline">\(K1Z\)</span> have closed-form solutions. Similarly, <span class="math inline">\(r0\)</span> and <span class="math inline">\(se\)</span> are derived analytically and are factored out of the log-likelihood function. In contrast, the remaining parameters, <span class="math inline">\(K1XQ\)</span> and <span class="math inline">\(SSZ\)</span>, must be estimated numerically.</p>
<p>The optimization routine in <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> combines the <code>Nelder–Mead</code> and <code>L-BFGS-B</code> algorithms, executed sequentially and repeated until convergence is achieved. At each iteration, the parameter vector yielding the highest likelihood is retained, enhancing robustness to local optima without resorting to full multi-start procedures. Convergence is achieved when the absolute change in the mean log-likelihood falls below a user-defined tolerance (default <span class="math inline">\(10^{-4}\)</span>). For the bootstrap replications, the same optimization procedure is applied; however, only the <code>Nelder–Mead</code> algorithm is used to reduce computation time.</p>
<h3 data-number="7" id="S:SectionImplementation"><span class="header-section-number">7</span> Full implementation of ATSMs</h3>
<h4 class="unnumbered" data-number="7.1" id="package-workflow">Package workflow</h4>
<p>The complete workflow of the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package is built around seven core functions, which together support a streamlined and modular process. An overview of these functions is provided below:</p>
<ol type="1">
<li><p><code>LabFac()</code>: returns a list of risk factor labels used throughout the package. In particular, these labels assist in structuring sub-function inputs and generating variable and graph labels in a parsimonious manner;</p></li>
<li><p><code>InputsForOpt()</code>: collects and processes the inputs needed to build the likelihood function as specified in Section <a href="#S:SectionInputs">5</a>. It estimates the model’s <span class="math inline">\(\mathbb{P}\)</span>-dynamics and returns an object of class <em>ATSMModelInputs</em>, which includes <code>print()</code> and <code>summary()</code> S3 methods. The <code>print()</code> method summarizes model inputs and system features, while <code>summary()</code> reports statistics on risk factors and bond yields;</p></li>
<li><p><code>Optimization()</code>: performs the estimation of the model parameters, primarily the <span class="math inline">\(\mathbb{Q}\)</span>-dynamics, using numerical optimization. This function returns a comprehensive list of the model’s point estimates and can be computationally intensive;</p></li>
<li><p><code>InputsForOutputs()</code>: an auxiliary function that compiles the necessary elements for producing numerical and graphical outputs. It also creates separate folders in the user’s <code>Folder2Save</code> directory to store the generated figures;</p></li>
<li><p><code>NumOutputs()</code>: produces the numerical outputs as selected in Section <a href="#S:SectionNumOut">5.3</a>, based on the model’s point estimates. The function returns an object of class <em>ATSMNumOutputs</em>, for which an <code>autoplot()</code> S3 method is available. This method provides a convenient way to visualize the selected graphical outputs;</p></li>
<li><p><code>Bootstrap()</code>: computes confidence bounds for the numerical outputs using the bootstrap procedures defined in Section <a href="#S:SectionNumOut">5.3</a> (subsection “Bootstrap settings”). The function returns an <em>ATSMModelBoot</em> object, which can be accessed via the <code>autoplot()</code> S3 method to generate the desired graphical outputs with confidence intervals. As this step involves repeated model estimation, it may require several hours (possibly days) to complete;</p></li>
<li><p><code>ForecastYields()</code>: generates bond yield forecasts and the corresponding forecast errors according to the specifications outlined in Section <a href="#S:SectionNumOut">5.3</a> (subsection “Out-of-sample forecast settings”). This function returns an object of class <em>ATSMModelForecast</em>, accesible via the <code>plot()</code> S3 method, which displays Root Mean Squared Errors (RMSEs) by country and forecast horizon.</p></li>
</ol>
<h4 class="unnumbered" data-number="7.2" id="complete-implementation">Complete implementation</h4>
<p>This section illustrates how to fully implement ATSMs using the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package. A simplified two-country <code>JPS original</code> framework serves as the example. The implementation steps are outlined below, and a sample of graphical outputs are presented in Figures <a href="#fig:FitYields">2</a> – <a href="#fig:TermPremia">5</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rubensmoura87/MultiATSM'>MultiATSM</a></span><span class='op'>)</span></span>
<span><span class='co'># 1) USER INPUTS</span></span>
<span><span class='co'># A) Load database data</span></span>
<span><span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LoadData.html'>LoadData</a></span><span class='op'>(</span><span class='st'>"CM_2024"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># B) GENERAL model inputs</span></span>
<span><span class='va'>ModelType</span> <span class='op'>&lt;-</span> <span class='st'>"JPS original"</span> </span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"China"</span>, <span class='st'>"Brazil"</span><span class='op'>)</span> </span>
<span><span class='va'>GlobalVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Gl_Eco_Act"</span><span class='op'>)</span> </span>
<span><span class='va'>DomVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Eco_Act"</span><span class='op'>)</span> </span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>  </span>
<span><span class='va'>t0_sample</span> <span class='op'>&lt;-</span> <span class='st'>"01-05-2005"</span> </span>
<span><span class='va'>tF_sample</span> <span class='op'>&lt;-</span> <span class='st'>"01-12-2019"</span> </span>
<span><span class='va'>OutputLabel</span> <span class='op'>&lt;-</span> <span class='st'>"Test"</span> </span>
<span><span class='va'>DataFreq</span> <span class='op'>&lt;-</span><span class='st'>"Monthly"</span></span>
<span><span class='va'>Folder2Save</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span><span class='va'>StatQ</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> </span>
<span></span>
<span><span class='co'># B.1) SPECIFIC model inputs</span></span>
<span><span class='co'># GVAR-based models </span></span>
<span><span class='va'>GVARlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> VARXtype <span class='op'>=</span> <span class='st'>"unconstrained"</span>, W_type <span class='op'>=</span> <span class='st'>"Sample Mean"</span>, t_First_Wgvar <span class='op'>=</span> <span class='st'>"2005"</span>,</span>
<span>                  t_Last_Wgvar <span class='op'>=</span> <span class='st'>"2019"</span>, DataConnectedness <span class='op'>=</span> <span class='va'>TradeFlows</span> <span class='op'>)</span> </span>
<span></span>
<span><span class='co'># JLL-based models </span></span>
<span><span class='va'>JLLlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>DomUnit <span class='op'>=</span>  <span class='st'>"China"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># BRW inputs  </span></span>
<span><span class='va'>WishBC</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> </span>
<span><span class='va'>BRWlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>within</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Cent_Measure <span class='op'>=</span> <span class='st'>"Mean"</span>, gamma <span class='op'>=</span> <span class='fl'>0.05</span>, N_iter <span class='op'>=</span> <span class='fl'>250</span>, B <span class='op'>=</span> <span class='fl'>50</span>, checkBRW <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                       B_check <span class='op'>=</span> <span class='fl'>1000</span>, Eigen_rest <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,  <span class='va'>N_burn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N_iter</span> <span class='op'>*</span> <span class='fl'>0.15</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># C) Decide on Settings for numerical outputs</span></span>
<span><span class='va'>WishFPremia</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span> </span>
<span><span class='va'>FPmatLim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>120</span><span class='op'>)</span> </span>
<span>                      </span>
<span><span class='va'>Horiz</span> <span class='op'>&lt;-</span> <span class='fl'>30</span></span>
<span><span class='va'>DesiredGraphs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span> </span>
<span><span class='va'>WishGraphRiskFac</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='va'>WishGraphYields</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='va'>WishOrthoJLLgraphs</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span></span>
<span><span class='co'># D) Bootstrap settings</span></span>
<span><span class='va'>WishBootstrap</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span> </span>
<span><span class='va'>BootList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>methodBS <span class='op'>=</span> <span class='st'>'bs'</span>, BlockLength <span class='op'>=</span> <span class='fl'>4</span>, ndraws <span class='op'>=</span> <span class='fl'>5</span>, pctg <span class='op'>=</span>  <span class='fl'>95</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># E) Out-of-sample forecast</span></span>
<span><span class='va'>WishForecast</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span> </span>
<span><span class='va'>ForecastList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ForHoriz <span class='op'>=</span> <span class='fl'>12</span>,  t0Sample <span class='op'>=</span> <span class='fl'>1</span>, t0Forecast <span class='op'>=</span> <span class='fl'>162</span>, ForType <span class='op'>=</span> <span class='st'>"Rolling"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>##########################################################################################</span></span>
<span><span class='co'># NO NEED TO MAKE CHANGES FROM HERE:</span></span>
<span><span class='co'># The sections below automatically process the inputs provided above, run the model </span></span>
<span><span class='co'># estimation, generate the numerical and graphical outputs, and save results.</span></span>
<span></span>
<span><span class='co'># 2) Minor preliminary work: get the sets of factor labels</span></span>
<span><span class='va'>FactorLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LabFac.html'>LabFac</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>DomVar</span>, <span class='va'>GlobalVar</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 3) Prepare the inputs of the likelihood function</span></span>
<span><span class='va'>ATSMInputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/InputsForOpt.html'>InputsForOpt</a></span><span class='op'>(</span><span class='va'>t0_sample</span>, <span class='va'>tF_sample</span>, <span class='va'>ModelType</span>, <span class='va'>Yields</span>, <span class='va'>GlobalMacro</span>, </span>
<span>                           <span class='va'>DomMacro</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>DataFreq</span>, <span class='va'>GVARlist</span>, </span>
<span>                           <span class='va'>JLLlist</span>, <span class='va'>WishBC</span>, <span class='va'>BRWlist</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 4) Optimization of the ATSM (Point Estimates)</span></span>
<span><span class='va'>ModelParaList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Optimization.html'>Optimization</a></span><span class='op'>(</span><span class='va'>ATSMInputs</span>, <span class='va'>StatQ</span>, <span class='va'>DataFreq</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 5) Numerical and graphical outputs</span></span>
<span><span class='co'># a) Prepare list of inputs for graphs and numerical outputs</span></span>
<span><span class='va'>InputsForOutputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/InputsForOutputs.html'>InputsForOutputs</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>Horiz</span>, <span class='va'>DesiredGraphs</span>, <span class='va'>OutputLabel</span>, <span class='va'>StatQ</span>, </span>
<span>                                     <span class='va'>DataFreq</span>, <span class='va'>WishGraphYields</span>, <span class='va'>WishGraphRiskFac</span>, </span>
<span>                                     <span class='va'>WishOrthoJLLgraphs</span>, <span class='va'>WishFPremia</span>, </span>
<span>                                     <span class='va'>FPmatLim</span>, <span class='va'>WishBootstrap</span>, <span class='va'>BootList</span>, </span>
<span>                                     <span class='va'>WishForecast</span>, <span class='va'>ForecastList</span><span class='op'>)</span></span>
<span>                                     </span>
<span><span class='co'># b) Fit, IRF, FEVD, GIRF, GFEVD, and Term Premia</span></span>
<span><span class='va'>NumericalOutputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/NumOutputs.html'>NumOutputs</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>InputsForOutputs</span>, </span>
<span>                               <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>Folder2Save</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># c) Confidence intervals (bootstrap analysis)</span></span>
<span><span class='va'>BootstrapAnalysis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Bootstrap.html'>Bootstrap</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>NumericalOutputs</span>, <span class='va'>Economies</span>, </span>
<span>                               <span class='va'>InputsForOutputs</span>, <span class='va'>FactorLabels</span>, <span class='va'>JLLlist</span>, <span class='va'>GVARlist</span>, </span>
<span>                               <span class='va'>WishBC</span>, <span class='va'>BRWlist</span>, <span class='va'>Folder2Save</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 6) Out-of-sample forecasting</span></span>
<span><span class='va'>Forecasts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/ForecastYields.html'>ForecastYields</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>InputsForOutputs</span>, <span class='va'>FactorLabels</span>, </span>
<span>                            <span class='va'>Economies</span>, <span class='va'>JLLlist</span>, <span class='va'>GVARlist</span>, <span class='va'>WishBC</span>, <span class='va'>BRWlist</span>, </span>
<span>                            <span class='va'>Folder2Save</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:FitYields"></span>
<img src="RJ-2025-044_files/figure-html5/FitYields-1.png" alt="Chinese bond yield maturities with model fit comparisons. *Model-fit* reflects estimation using only risk-neutral ($\mathbb{Q}$) dynamics parameters, while *Model-Implied* incorporates both physical ($\mathbb{P}$) and risk-neutral ($\mathbb{Q}$) dynamics. The $x$-axes represent time in months and the $y$-axis is in natural units." width="100%" />
<p class="caption">
Figure 2: Chinese bond yield maturities with model fit comparisons. <em>Model-fit</em> reflects estimation using only risk-neutral (<span class="math inline">\(\mathbb{Q}\)</span>) dynamics parameters, while <em>Model-Implied</em> incorporates both physical (<span class="math inline">\(\mathbb{P}\)</span>) and risk-neutral (<span class="math inline">\(\mathbb{Q}\)</span>) dynamics. The <span class="math inline">\(x\)</span>-axes represent time in months and the <span class="math inline">\(y\)</span>-axis is in natural units.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:IRF"></span>
<img src="RJ-2025-044_files/figure-html5/IRF-1.png" alt="IRFs from the Brazilian bond yields to global economic activity. Size of the shock is one-standard deviation. The black lines are the point estimates. Gray dashed lines are the bounds of the 95% confidence intervals and the green lines correspond to the median of these intervals. The $x$-axes are expressed in months and the $y$-axis is in natural units." width="100%" />
<p class="caption">
Figure 3: IRFs from the Brazilian bond yields to global economic activity. Size of the shock is one-standard deviation. The black lines are the point estimates. Gray dashed lines are the bounds of the 95% confidence intervals and the green lines correspond to the median of these intervals. The <span class="math inline">\(x\)</span>-axes are expressed in months and the <span class="math inline">\(y\)</span>-axis is in natural units.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:FEVD"></span>
<img src="RJ-2025-044_files/figure-html5/FEVD-1.png" alt="FEVD from the Brazilian bond yield with maturity 60 months. The $x$-axis represents the forecast horizon in months and the $y$-axis is in natural units." width="100%" />
<p class="caption">
Figure 4: FEVD from the Brazilian bond yield with maturity 60 months. The <span class="math inline">\(x\)</span>-axis represents the forecast horizon in months and the <span class="math inline">\(y\)</span>-axis is in natural units.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:TermPremia"></span>
<img src="RJ-2025-044_files/figure-html5/TermPremia-1.png" alt="Chinese sovereign yield curve decomposition showing (i) expected future short rates and (ii) term premia components. The $x$-axis represents time in months and the $y$-axis is expressed in percentage points." width="100%" />
<p class="caption">
Figure 5: Chinese sovereign yield curve decomposition showing (i) expected future short rates and (ii) term premia components. The <span class="math inline">\(x\)</span>-axis represents time in months and the <span class="math inline">\(y\)</span>-axis is expressed in percentage points.
</p>
</div>
</div>
<h3 data-number="8" id="concluding-remarks"><span class="header-section-number">8</span> Concluding remarks</h3>
<p>The <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package aims to advance yield curve (term structure) modelling within the R programming environment. It provides a comprehensive yet user-friendly toolkit for practitioners, academics, and policymakers, featuring estimation routines and generating detailed outputs across several macrofinance model classes. This allows for an in-depth exploration of the relationship between the real economy developments and the fixed income markets.</p>
<p>The package covers eight classes of macrofinance term structure models, all built upon the single-country unspanned macroeconomic risk framework of <span class="citation" data-cites="JoslinPriebschSingleton2014">Joslin et al. (<a href="#ref-JoslinPriebschSingleton2014" role="doc-biblioref">2014</a>)</span>, which is also extended to a multicountry setting. Additional multicountry variants based on <span class="citation" data-cites="JotikasthiraLeLundblad2015">Jotikasthira et al. (<a href="#ref-JotikasthiraLeLundblad2015" role="doc-biblioref">2015</a>)</span> and <span class="citation" data-cites="CandelonMoura2024">Candelon and Moura (<a href="#ref-CandelonMoura2024" role="doc-biblioref">2024</a>)</span> are included, incorporating, respectively, a dominant economy and a GVAR structure to model cross-country interdependence.</p>
<p>Each model class provides analytical outputs that offer insight into term structure dynamics, including plots of model fit, risk premia, impulse responses, and forecast error variance decompositions.The <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package also offers bootstrap procedures for confidence interval construction and out-of-sample forecasting of bond yields.</p>
<h3 class="unnumbered" id="acknowledgments">Acknowledgments</h3>
<p>I thank the editor, Rob Hyndman, and an anonymous referee for several helpful comments. I am also grateful to Bertrand Candelon, Adhir Dhoble and Gustavo Torregrosa for many insightful discussions. An earlier version of this paper circulated under the title <em>MultiATSM: An R Package for Arbitrage-Free Multicountry Affine Term Structure of Interest Rate Models with Unspanned Macroeconomic Risk</em> and was part of the author’s PhD dissertation at UCLouvain <span class="citation" data-cites="Moura2022">(<a href="#ref-Moura2022" role="doc-biblioref">Moura 2022</a>)</span>. The views expressed in this paper are those of the author and do not necessarily reflect those of Banco de Mexico.</p>
<h3 class="appendix" data-number="9" id="appendix"><span class="header-section-number">9</span> Appendix</h3>
<section id="a-supplementary-functions" class="unnumbered">
<h4 class="unnumbered">A: Supplementary functions</h4>
<h5 class="unnumbered" data-number="9.0.1" id="importing-data-from-excel-files">Importing data from Excel files</h5>
<p>The <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package also provides an automated procedure for importing data from Excel files via <code>Load_Excel_Data()</code> and preparing the risk factor database used directly in the model estimation. To ensure compatibility with the package functions, the following requirements must be met:</p>
<ol type="1">
<li>Databases must be organized in separate Excel files: one for unspanned factors and another for term structure data. For GVAR-based models, a third file containing the interdependence measures is also required;</li>
<li>Each Excel file should include one tab per country. In the case of unspanned factors, an additional tab must be included for the global variables if the user opts to incorporate them;</li>
<li>Variable names must be identical across all tabs within each file.</li>
</ol>
<p>An example Excel file meeting these requirements is provided with the package. Below is an example of how to import the data from excel and construct the input list to be supplied:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>MacroData</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Load_Excel_Data.html'>Load_Excel_Data</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"MacroData.xlsx"</span>, </span>
<span>                                          package <span class='op'>=</span> <span class='st'>"MultiATSM"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>YieldsData</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Load_Excel_Data.html'>Load_Excel_Data</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"YieldsData.xlsx"</span>, </span>
<span>                                          package <span class='op'>=</span> <span class='st'>"MultiATSM"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ModelType</span> <span class='op'>&lt;-</span> <span class='st'>"JPS original"</span></span>
<span><span class='va'>Initial_Date</span> <span class='op'>&lt;-</span> <span class='st'>"2006-09-01"</span></span>
<span><span class='va'>Final_Date</span> <span class='op'>&lt;-</span> <span class='st'>"2019-01-01"</span></span>
<span><span class='va'>DataFrequency</span> <span class='op'>&lt;-</span> <span class='st'>"Monthly"</span></span>
<span><span class='va'>GlobalVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GBC"</span>, <span class='st'>"VIX"</span><span class='op'>)</span></span>
<span><span class='va'>DomVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Eco_Act"</span>, <span class='st'>"Inflation"</span>, <span class='st'>"Com_Prices"</span>, <span class='st'>"Exc_Rates"</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>3</span></span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"China"</span>, <span class='st'>"Mexico"</span>, <span class='st'>"Uruguay"</span>, <span class='st'>"Brazil"</span>, <span class='st'>"Russia"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>These inputs are used to construct the <em>RiskFactorsSet</em> variable, which holds the full collection of risk factors required by the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>FactorLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LabFac.html'>LabFac</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>DomVar</span>, <span class='va'>GlobalVar</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span>
<span><span class='va'>RiskFactorsSet</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/DataForEstimation.html'>DataForEstimation</a></span><span class='op'>(</span><span class='va'>Initial_Date</span>, <span class='va'>Final_Date</span>, <span class='va'>Economies</span>, <span class='va'>N</span>, <span class='va'>FactorLabels</span>,</span>
<span>                                    <span class='va'>ModelType</span>, <span class='va'>DataFrequency</span>, <span class='va'>MacroData</span>, <span class='va'>YieldsData</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h5 class="unnumbered" data-number="9.0.2" id="transition-matrix-and-star-factors">Transition matrix and star factors</h5>
<p>To construct the transition matrix for GVAR specifications, the user can employ <code>Transition_Matrix()</code>. This function requires:</p>
<ol type="1">
<li><p>Data selection: choose proxies for cross-country interdependence.</p></li>
<li><p>Time frame: specify the sample’s start and end dates.</p></li>
<li><p>Dependence measure: select from:</p></li>
</ol>
<ul>
<li>Time-varying (dynamic weights)</li>
<li>Sample Mean (static average)</li>
<li>A numeric scalar (fixed-year snapshot).</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"TradeFlows"</span><span class='op'>)</span></span>
<span><span class='va'>t_First</span> <span class='op'>&lt;-</span> <span class='st'>"2006"</span></span>
<span><span class='va'>t_Last</span> <span class='op'>&lt;-</span> <span class='st'>"2019"</span></span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"China"</span>, <span class='st'>"Brazil"</span>, <span class='st'>"Mexico"</span>, <span class='st'>"Uruguay"</span><span class='op'>)</span></span>
<span><span class='va'>type</span> <span class='op'>&lt;-</span> <span class='st'>"Sample Mean"</span></span>
<span><span class='va'>W_gvar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Transition_Matrix.html'>Transition_Matrix</a></span><span class='op'>(</span><span class='va'>t_First</span>, <span class='va'>t_Last</span>, <span class='va'>Economies</span>, <span class='va'>type</span>, <span class='va'>TradeFlows</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Note that if data is missing for any country in a given year, the corresponding transition matrix will contain only <code>NA</code>s.</p>
<p>A more flexible approach to modelling interdependence is to allow the transition matrix to vary over time. In this case, the star factors are constructed using trade flow weights specific to each year, adjusting the corresponding year’s risk factors accordingly. To enable this feature, users must set the <code>type</code> argument to <code>Time-varying</code> and specify the same year for both the initial and final periods in the transition matrix. This indicates that the trade weights from that particular year is used when solving the GVAR system (i.e., in the construction of the link matrices, see Equation <a href="#eq:LinkMatequation">(11)</a>).</p>
</section>
<section id="b-additional-theoretical-considerations" class="unnumbered">
<h4 class="unnumbered">B: Additional theoretical considerations</h4>
<h5 class="unnumbered" data-number="9.0.3" id="bond-yield-decomposition">Bond yield decomposition</h5>
<p>The <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package allows for the calculation
of two risk compensation measures: term premia and forward premia. Assume that an <span class="math inline">\(n\)</span>-maturity bond yield can be decomposed into two components: the expected short-rate (<span class="math inline">\(\mathrm{Exp}_{i,t}^{(n)}\)</span>) and term premia
(<span class="math inline">\(\mathrm{TP}_{i,t}^{(n)}\)</span>).
Technically: <span class="math display">\[
y_{i,t}^{(n)} = \mathrm{Exp}_{i,t}^{(n)} + \mathrm{TP}_{i,t}^{(n)} \text{.}
\]</span> In the package’s standard form, the expected short rate term is
computed from time <span class="math inline">\(t\)</span> to <span class="math inline">\(t+n\)</span>, which represents the bond’s maturity:
<span class="math inline">\(\mathrm{Exp}_{i,t}^{(n)} = \sum_{h=0}^{n} E_t[y_{i, t+h}^{(1)}]\)</span>. Alternatively,
the decomposition for the forward rates (<span class="math inline">\(f_{i,t}^{(n)}\)</span>) is
<span class="math inline">\(f_{i,t}^{(n)} = \sum_{h=m}^{n} E_t[y_{i,t+h}^{(1)}] + \mathrm{FP}_{i,t}^{(n)}\)</span> where
<span class="math inline">\(\mathrm{FP}_{i,t}^{(n)}\)</span> corresponds to the forward premia. In this case, the user
must specify <code>TRUE</code> if the computation of forward
premia is desired, or <code>FALSE</code> otherwise. If set to <code>TRUE</code>, the user must also
provide a two-element numerical vector containing the maturities
corresponding to the starting and ending dates of the bond maturity.
Example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span>    <span class='va'>WishFPremia</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>  </span>
<span>    <span class='va'>FPmatLim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>, <span class='fl'>120</span><span class='op'>)</span></span></code></pre>
</div>
</div>
</section>
<section id="c-replication-of-existing-research" class="unnumbered">
<h4 class="unnumbered">C: Replication of existing research</h4>
<h5 class="unnumbered" data-number="9.0.4" id="joslin-priebisch-and-singleton-2014">Joslin, Priebisch and Singleton (2014)</h5>
<p>The dataset used in this replication was constructed by <span class="citation" data-cites="BauerRudebusch2017">Bauer and Rudebusch (<a href="#ref-BauerRudebusch2017" role="doc-biblioref">2017</a>)</span> (henceforth BR, 2017) and is available on Bauer’s website. In their paper, BR (2017) investigate whether macrofinance term structure models are better suited to the unspanned macro risk framework of JPS (2014) or to earlier, traditional spanned settings such as <span class="citation" data-cites="AngPiazzesi2003">Ang and Piazzesi (<a href="#ref-AngPiazzesi2003" role="doc-biblioref">2003</a>)</span>. To that end, BR (2017) replicate selected empirical results from JPS (2014). The corresponding R code is also available on Bauer’s website.</p>
<p>Using the dataset from BR (2017), the code below applies the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package to estimate the key ATSM parameters following the <code>JPS original</code> modelling setup.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 1) INPUTS</span></span>
<span><span class='co'># A) Load database data</span></span>
<span><span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LoadData.html'>LoadData</a></span><span class='op'>(</span><span class='st'>"BR_2017"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># B) GENERAL model inputs</span></span>
<span><span class='va'>ModelType</span> <span class='op'>&lt;-</span> <span class='st'>"JPS original"</span></span>
<span></span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"US"</span><span class='op'>)</span> </span>
<span><span class='va'>GlobalVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span> </span>
<span><span class='va'>DomVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GRO"</span>, <span class='st'>"INF"</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>3</span> </span>
<span><span class='va'>t0_sample</span> <span class='op'>&lt;-</span> <span class='st'>"January-1985"</span></span>
<span><span class='va'>tF_sample</span> <span class='op'>&lt;-</span> <span class='st'>"December-2007"</span></span>
<span><span class='va'>DataFreq</span> <span class='op'>&lt;-</span> <span class='st'>"Monthly"</span> </span>
<span><span class='va'>StatQ</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> </span>
<span></span>
<span><span class='co'># 2) Minor preliminary work</span></span>
<span><span class='va'>FactorLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LabFac.html'>LabFac</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>DomVar</span>, <span class='va'>GlobalVar</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span> </span>
<span><span class='va'>Yields</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>BR_jps_out</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span></span>
<span><span class='va'>DomesticMacroVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>BR_jps_out</span><span class='op'>$</span><span class='va'>M.o</span><span class='op'>)</span></span>
<span><span class='va'>GlobalMacroVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 3) Prepare the inputs of the likelihood function</span></span>
<span><span class='va'>ATSMInputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/InputsForOpt.html'>InputsForOpt</a></span><span class='op'>(</span><span class='va'>t0_sample</span>, <span class='va'>tF_sample</span>, <span class='va'>ModelType</span>, <span class='va'>Yields</span>, <span class='va'>GlobalMacroVar</span>, </span>
<span>                           <span class='va'>DomesticMacroVar</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>DataFreq</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 4) Optimization of the model</span></span>
<span><span class='va'>ModelPara</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Optimization.html'>Optimization</a></span><span class='op'>(</span><span class='va'>ATSMInputs</span>, <span class='va'>StatQ</span>, <span class='va'>DataFreq</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The tables below compare the ATSM parameter estimates generated from BR (2017) and the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a>. Table <a href="#tab:QdynTab-H">2</a> reports the risk-neutral parameters. While the values presented do not match exactly, the differences are well within convergence tolerance and are arguably economically negligible. Table <a href="#tab:PdynTab-H">3</a>, by contrast, contains parameters related to the model’s time-series dynamics. As these are derived in closed form, the estimates are exactly the same under both specifications.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:QdynTab-H">Table 2: </span><span class="math inline">\(Q\)</span>-dynamics parameters
</caption>
<thead>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
MultiATSM
</th>
<th style="text-align:center;font-size: 14px;">
BR (2017)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(r_0\)</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0006</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0002</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_1\)</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9967</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9968</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_2\)</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9149</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9594</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_3\)</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9149</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.8717</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> λ’s are the eigenvalues from the risk-neutral feedback matrix and r₀ is the long-run mean of the short rate under Q.
</td>
</tr>
</tfoot>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body-outset">
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:PdynTab-H">Table 3: </span><span class="math inline">\(P\)</span>-dynamics parameters
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="1">
<div style="TRUE">
K0Z
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="5">
<div style="TRUE">
K1Z
</div>
</th>
</tr>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
PC1
</th>
<th style="text-align:center;font-size: 14px;">
PC2
</th>
<th style="text-align:center;font-size: 14px;">
PC3
</th>
<th style="text-align:center;font-size: 14px;">
GRO
</th>
<th style="text-align:center;font-size: 14px;">
INF
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>BR (2017)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0781</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9369</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0131</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0218</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1046</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1003</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0210</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0058</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9781</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1703</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.1672</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0402</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC3
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1005</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0104</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0062</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.7835</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0399</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0437</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
GRO
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0690</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0048</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0180</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.1112</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.8818</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0025</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
INF
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0500</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0018</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0064</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0592</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0277</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9859</span>
</td>
</tr>
<tr grouplength="5">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MultiATSM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0781</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9369</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0131</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0218</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1046</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1003</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0210</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0058</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9781</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1703</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.1672</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0402</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC3
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.1005</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0104</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0062</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.7835</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0399</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0437</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
GRO
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0690</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0048</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0180</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.1112</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.8818</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0025</span>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
INF
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0500</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0018</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0064</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">−0.0592</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.0277</span>
</td>
<td style="text-align:center;">
<span style="display:inline-block; width:5em; text-align:right;">0.9859</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> <span class="math inline">\(K0Z\)</span> is the intercept and <span class="math inline">\(K1Z\)</span> is the feedback matrix from the <span class="math inline">\(P\)</span>-dynamics.
</td>
</tr>
</tfoot>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>For replicability, it is important to note that the physical dynamics results reported in Table <a href="#tab:PdynTab-H">3</a> using <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> rely on the principal component weights provided by BR (2017). Such a matrix is simply a scaled-up version of the one provided by the function <code>pca_weights_one_country()</code> of the current package. Accordingly, despite the numerical differences on the weight matrices, both methods generate time series of spanned factors which are perfectly correlated. Another difference between the two approaches relates to the construction of the log-likelihood function: while in the BR (2017) code this is expressed in terms of a portfolio of yields, the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package generates this same input directly as a function of observed yields (i.e. both procedures lead to equivalent log-likelihood vales up to the Jacobian term).</p>
<p>Additionally, it is worth highlighting that the standard deviations for the portfolios of yields observed with errors are nearly identical, matching to seven decimal places: 0.0000546 for <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> and 0.0000550 for BR (2017).</p>
<h5 class="unnumbered" data-number="9.0.5" id="candelon-and-moura-2024">Candelon and Moura (2024)</h5>
<p>The multicountry framework introduced in <span class="citation" data-cites="CandelonMoura2024">Candelon and Moura (<a href="#ref-CandelonMoura2024" role="doc-biblioref">2024</a>)</span> enhances the tractability of large-scale ATSMs and deepens our understanding of the global economic mechanisms driving domestic yield curve fluctuations. This framework also generates more precise model estimates and enhances the forecasting capabilities of these models. This novel setup, embodied by the <code>GVAR multi</code> model class, is benchmarked against the findings of <span class="citation" data-cites="JotikasthiraLeLundblad2015">Jotikasthira et al. (<a href="#ref-JotikasthiraLeLundblad2015" role="doc-biblioref">2015</a>)</span>, which are captured by the <code>JLL original</code> model class. The paper showcases an empirical illustration involving China, Brazil, Mexico, and Uruguay.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 1) INPUTS</span></span>
<span><span class='co'># A) Load database data</span></span>
<span><span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LoadData.html'>LoadData</a></span><span class='op'>(</span><span class='st'>"CM_2024"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># B) GENERAL model inputs</span></span>
<span><span class='va'>ModelType</span> <span class='op'>&lt;-</span> <span class='st'>"GVAR multi"</span> </span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"China"</span>, <span class='st'>"Brazil"</span>, <span class='st'>"Mexico"</span>, <span class='st'>"Uruguay"</span><span class='op'>)</span></span>
<span><span class='va'>GlobalVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Gl_Eco_Act"</span>, <span class='st'>"Gl_Inflation"</span><span class='op'>)</span></span>
<span><span class='va'>DomVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Eco_Act"</span>, <span class='st'>"Inflation"</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>3</span></span>
<span><span class='va'>t0_sample</span> <span class='op'>&lt;-</span> <span class='st'>"01-06-2004"</span></span>
<span><span class='va'>tF_sample</span> <span class='op'>&lt;-</span> <span class='st'>"01-01-2020"</span></span>
<span><span class='va'>OutputLabel</span> <span class='op'>&lt;-</span> <span class='st'>"CM_jfec"</span></span>
<span><span class='va'>DataFreq</span> <span class='op'>&lt;-</span><span class='st'>"Monthly"</span></span>
<span><span class='va'>StatQ</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span></span>
<span><span class='co'># B.1) SPECIFIC model inputs</span></span>
<span><span class='co'># GVAR-based models </span></span>
<span><span class='va'>GVARlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> VARXtype <span class='op'>=</span> <span class='st'>"unconstrained"</span>, W_type <span class='op'>=</span> <span class='st'>"Sample Mean"</span>, t_First_Wgvar <span class='op'>=</span> <span class='st'>"2004"</span>,</span>
<span>                  t_Last_Wgvar <span class='op'>=</span> <span class='st'>"2019"</span>, DataConnectedness <span class='op'>=</span> <span class='va'>TradeFlows</span> <span class='op'>)</span></span>
<span></span>
<span><span class='co'># JLL-based models </span></span>
<span><span class='va'>JLLlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>DomUnit <span class='op'>=</span>  <span class='st'>"China"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># BRW inputs</span></span>
<span><span class='va'>WishBC</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span><span class='va'>BRWlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>within</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Cent_Measure <span class='op'>=</span> <span class='st'>"Mean"</span>, gamma <span class='op'>=</span> <span class='fl'>0.001</span>, N_iter <span class='op'>=</span> <span class='fl'>200</span>, B <span class='op'>=</span> <span class='fl'>50</span>, checkBRW <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                       B_check <span class='op'>=</span> <span class='fl'>1000</span>, Eigen_rest <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,  <span class='va'>N_burn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N_iter</span> <span class='op'>*</span> <span class='fl'>0.15</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># C) Decide on Settings for numerical outputs</span></span>
<span><span class='va'>WishFPremia</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span><span class='va'>FPmatLim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>24</span>,<span class='fl'>36</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Horiz</span> <span class='op'>&lt;-</span> <span class='fl'>25</span></span>
<span><span class='va'>DesiredGraphs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GIRF"</span>, <span class='st'>"GFEVD"</span>, <span class='st'>"TermPremia"</span><span class='op'>)</span></span>
<span><span class='va'>WishGraphRiskFac</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='va'>WishGraphYields</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span><span class='va'>WishOrthoJLLgraphs</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span></span>
<span><span class='co'># D) Bootstrap settings</span></span>
<span><span class='va'>WishBootstrap</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> </span>
<span><span class='va'>BootList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>methodBS <span class='op'>=</span> <span class='st'>'bs'</span>, BlockLength <span class='op'>=</span> <span class='fl'>4</span>, ndraws <span class='op'>=</span> <span class='fl'>1000</span>, pctg <span class='op'>=</span>  <span class='fl'>95</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># E) Out-of-sample forecast</span></span>
<span><span class='va'>WishForecast</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span><span class='va'>ForecastList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ForHoriz <span class='op'>=</span> <span class='fl'>12</span>,  t0Sample <span class='op'>=</span> <span class='fl'>1</span>, t0Forecast <span class='op'>=</span> <span class='fl'>100</span>, ForType <span class='op'>=</span> <span class='st'>"Rolling"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 2) Minor preliminary work: get the sets of factor labels and  a vector of common maturities</span></span>
<span><span class='va'>FactorLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LabFac.html'>LabFac</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>DomVar</span>, <span class='va'>GlobalVar</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 3) Prepare the inputs of the likelihood function</span></span>
<span><span class='va'>ATSMInputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/InputsForOpt.html'>InputsForOpt</a></span><span class='op'>(</span><span class='va'>t0_sample</span>, <span class='va'>tF_sample</span>, <span class='va'>ModelType</span>, <span class='va'>Yields</span>, <span class='va'>GlobalMacro</span>, </span>
<span>                           <span class='va'>DomMacro</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>DataFreq</span>, </span>
<span>                           <span class='va'>GVARlist</span>, <span class='va'>JLLlist</span>, <span class='va'>WishBC</span>, <span class='va'>BRWlist</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 4) Optimization of the ATSM (Point Estimates)</span></span>
<span><span class='va'>ModelParaList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Optimization.html'>Optimization</a></span><span class='op'>(</span><span class='va'>ATSMInputs</span>, <span class='va'>StatQ</span>, <span class='va'>DataFreq</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 5) Numerical and graphical outputs</span></span>
<span><span class='co'># a) Prepare list of inputs for graphs and numerical outputs</span></span>
<span><span class='va'>InputsForOutputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/InputsForOutputs.html'>InputsForOutputs</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>Horiz</span>, <span class='va'>DesiredGraphs</span>, <span class='va'>OutputLabel</span>, <span class='va'>StatQ</span>, </span>
<span>                                     <span class='va'>DataFreq</span>, <span class='va'>WishGraphYields</span>, <span class='va'>WishGraphRiskFac</span>, </span>
<span>                                     <span class='va'>WishOrthoJLLgraphs</span>, <span class='va'>WishFPremia</span>, <span class='va'>FPmatLim</span>, </span>
<span>                                     <span class='va'>WishBootstrap</span>, <span class='va'>BootList</span>, <span class='va'>WishForecast</span>, </span>
<span>                                     <span class='va'>ForecastList</span><span class='op'>)</span></span>
<span>                                    </span>
<span><span class='co'># b) Fit, IRF, FEVD, GIRF, GFEVD, and Term Premia</span></span>
<span><span class='va'>NumericalOutputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/NumOutputs.html'>NumOutputs</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>InputsForOutputs</span>, </span>
<span>                               <span class='va'>FactorLabels</span>, <span class='va'>Economies</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># c) Confidence intervals (bootstrap analysis)</span></span>
<span><span class='va'>BootstrapAnalysis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Bootstrap.html'>Bootstrap</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>NumericalOutputs</span>, <span class='va'>Economies</span>,</span>
<span>                               <span class='va'>InputsForOutputs</span>, <span class='va'>FactorLabels</span>, <span class='va'>JLLlist</span>, <span class='va'>GVARlist</span>, </span>
<span>                               <span class='va'>WishBC</span>, <span class='va'>BRWlist</span><span class='op'>)</span></span>
<span>                               </span>
<span><span class='co'># 6) Out-of-sample forecasting</span></span>
<span><span class='va'>Forecasts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/ForecastYields.html'>ForecastYields</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>InputsForOutputs</span>, <span class='va'>FactorLabels</span>, </span>
<span>                            <span class='va'>Economies</span>, <span class='va'>JLLlist</span>, <span class='va'>GVARlist</span>, <span class='va'>WishBC</span>, <span class='va'>BRWlist</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h5 class="unnumbered" data-number="9.0.6" id="candelon-and-moura-2023">Candelon and Moura (2023)</h5>
<p>In this paper, <span class="citation" data-cites="CandelonMoura2023">Candelon and Moura (<a href="#ref-CandelonMoura2023" role="doc-biblioref">2023</a>)</span> investigate the underlying factors that shape the sovereign yield curves of Brazil, India, Mexico, and Russia during the COVID<span class="math inline">\(-19\)</span> pandemic crisis. The study adopts a <code>GVAR multi</code> approach to capture the complex global macrofinancial, and especially health-related interdependencies during the latest pandemic.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 1) INPUTS</span></span>
<span><span class='co'># A) Load database data</span></span>
<span><span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LoadData.html'>LoadData</a></span><span class='op'>(</span><span class='st'>"CM_2023"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># B) GENERAL model inputs</span></span>
<span><span class='va'>ModelType</span> <span class='op'>&lt;-</span> <span class='st'>"GVAR multi"</span></span>
<span><span class='va'>Economies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Brazil"</span>, <span class='st'>"India"</span>, <span class='st'>"Russia"</span>, <span class='st'>"Mexico"</span><span class='op'>)</span></span>
<span><span class='va'>GlobalVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"US_Output_growth"</span>, <span class='st'>"China_Output_growth"</span>, <span class='st'>"SP500"</span><span class='op'>)</span></span>
<span><span class='va'>DomVar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Inflation"</span>,<span class='st'>"Output_growth"</span>, <span class='st'>"CDS"</span>, <span class='st'>"COVID"</span><span class='op'>)</span></span>
<span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>2</span></span>
<span><span class='va'>t0_sample</span> <span class='op'>&lt;-</span> <span class='st'>"22-03-2020"</span></span>
<span><span class='va'>tF_sample</span> <span class='op'>&lt;-</span> <span class='st'>"26-09-2021"</span></span>
<span><span class='va'>OutputLabel</span> <span class='op'>&lt;-</span> <span class='st'>"CM_EM"</span></span>
<span><span class='va'>DataFreq</span> <span class='op'>&lt;-</span><span class='st'>"Weekly"</span></span>
<span><span class='va'>StatQ</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span></span>
<span><span class='co'># B.1) SPECIFIC model inputs</span></span>
<span><span class='co'># GVAR-based models </span></span>
<span><span class='va'>GVARlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>VARXtype <span class='op'>=</span> <span class='st'>"constrained: COVID"</span>, W_type <span class='op'>=</span> <span class='st'>"Sample Mean"</span>, </span>
<span>                 t_First_Wgvar <span class='op'>=</span> <span class='st'>"2015"</span>, t_Last_Wgvar <span class='op'>=</span> <span class='st'>"2020"</span>, </span>
<span>                 DataConnectedness <span class='op'>=</span> <span class='va'>TradeFlows_covid</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># BRW inputs  </span></span>
<span><span class='va'>WishBC</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span></span>
<span><span class='co'># C) Decide on Settings for numerical outputs</span></span>
<span><span class='va'>WishFPremia</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span><span class='va'>FPmatLim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>47</span>,<span class='fl'>48</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Horiz</span> <span class='op'>&lt;-</span> <span class='fl'>12</span></span>
<span><span class='va'>DesiredGraphs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GIRF"</span>, <span class='st'>"GFEVD"</span>, <span class='st'>"TermPremia"</span><span class='op'>)</span></span>
<span><span class='va'>WishGraphRiskFac</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='va'>WishGraphYields</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span><span class='va'>WishOrthoJLLgraphs</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span></span>
<span><span class='co'># D) Bootstrap settings</span></span>
<span><span class='va'>WishBootstrap</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span> </span>
<span><span class='va'>BootList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>methodBS <span class='op'>=</span> <span class='st'>'bs'</span>, BlockLength <span class='op'>=</span> <span class='fl'>4</span>, ndraws <span class='op'>=</span> <span class='fl'>100</span>, pctg <span class='op'>=</span>  <span class='fl'>95</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 2) Minor preliminary work: get the sets of factor labels and  a vector of common maturities</span></span>
<span><span class='va'>FactorLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/LabFac.html'>LabFac</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>DomVar</span>, <span class='va'>GlobalVar</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 3) Prepare the inputs of the likelihood function</span></span>
<span><span class='va'>ATSMInputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/InputsForOpt.html'>InputsForOpt</a></span><span class='op'>(</span><span class='va'>t0_sample</span>, <span class='va'>tF_sample</span>, <span class='va'>ModelType</span>, <span class='va'>Yields_covid</span>, <span class='va'>GlobalMacro_covid</span>, </span>
<span>                           <span class='va'>DomMacro_covid</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>DataFreq</span>, <span class='va'>GVARlist</span><span class='op'>)</span> </span>
<span>                           </span>
<span><span class='co'># 4) Optimization of the ATSM (Point Estimates)</span></span>
<span><span class='va'>ModelParaList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Optimization.html'>Optimization</a></span><span class='op'>(</span><span class='va'>ATSMInputs</span>, <span class='va'>StatQ</span>, <span class='va'>DataFreq</span>, <span class='va'>FactorLabels</span>, <span class='va'>Economies</span>, <span class='va'>ModelType</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 5) Numerical and graphical outputs</span></span>
<span><span class='co'># a) Prepare list of inputs for graphs and numerical outputs</span></span>
<span><span class='va'>InputsForOutputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/InputsForOutputs.html'>InputsForOutputs</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>Horiz</span>, <span class='va'>DesiredGraphs</span>, <span class='va'>OutputLabel</span>, <span class='va'>StatQ</span>, </span>
<span>                                     <span class='va'>DataFreq</span>, <span class='va'>WishGraphYields</span>, <span class='va'>WishGraphRiskFac</span>, </span>
<span>                                     <span class='va'>WishOrthoJLLgraphs</span>, <span class='va'>WishFPremia</span>, <span class='va'>FPmatLim</span>,</span>
<span>                                     <span class='va'>WishBootstrap</span>, <span class='va'>BootList</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># b) Fit, IRF, FEVD, GIRF, GFEVD, and Term Premia</span></span>
<span><span class='va'>NumericalOutputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/NumOutputs.html'>NumOutputs</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>InputsForOutputs</span>, <span class='va'>FactorLabels</span>, </span>
<span>                               <span class='va'>Economies</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># c) Confidence intervals (bootstrap analysis)</span></span>
<span><span class='va'>BootstrapAnalysis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rubensmoura87.github.io/MultiATSM/reference/Bootstrap.html'>Bootstrap</a></span><span class='op'>(</span><span class='va'>ModelType</span>, <span class='va'>ModelParaList</span>, <span class='va'>NumericalOutputs</span>, <span class='va'>Economies</span>, </span>
<span>                               <span class='va'>InputsForOutputs</span>, <span class='va'>FactorLabels</span>, </span>
<span>                               JLLlist <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>GVARlist</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
</section>
<h3 class="appendix" data-number="10" id="supplementary-materials"><span class="header-section-number">10</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-044.zip">RJ-2025-044.zip</a></p>
<h3 class="appendix" data-number="11" id="cran-packages-used"><span class="header-section-number">11</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a>, <a href="https://cran.r-project.org/package=YieldCurve">YieldCurve</a>, <a href="https://cran.r-project.org/package=fBonds">fBonds</a>, <a href="https://cran.r-project.org/package=statespacer">statespacer</a>, <a href="https://cran.r-project.org/package=simStateSpace">simStateSpace</a>, <a href="https://cran.r-project.org/package=vars">vars</a>, <a href="https://cran.r-project.org/package=MTS">MTS</a>, <a href="https://cran.r-project.org/package=svars">svars</a>, <a href="https://cran.r-project.org/package=bigtime">bigtime</a>, <a href="https://cran.r-project.org/package=BigVAR">BigVAR</a>, <a href="https://cran.r-project.org/package=Spillover">Spillover</a>, <a href="https://cran.r-project.org/package=BGVAR">BGVAR</a></p>
<h3 class="appendix" data-number="12" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">12</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Econometrics">Econometrics</a>, <a href="https://cran.r-project.org/view=Finance">Finance</a>, <a href="https://cran.r-project.org/view=TimeSeries">TimeSeries</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-AbbrittiDellErbaMorenoSola2018" class="csl-entry" role="listitem">
M. Abbritti, S. Dell’Erba, A. Moreno and S. Sola. Global factors in the term structure of interest rates. <em>International Journal of Central Banking</em>, 14(2): 301–339, 2018. URL <a href="https://www.ijcb.org/journal/ijcb18q1a7.htm">https://www.ijcb.org/journal/ijcb18q1a7.htm</a>.
</div>
<div id="ref-AdrianCrumpMoench2013" class="csl-entry" role="listitem">
T. Adrian, R. K. Crump and E. Moench. Pricing the term structure with linear regressions. <em>Journal of Financial Economics</em>, 110(1): 110–138, 2013. URL <a href="https://doi.org/10.1016/j.jfineco.2013.04.009">https://doi.org/10.1016/j.jfineco.2013.04.009</a>.
</div>
<div id="ref-AngPiazzesi2003" class="csl-entry" role="listitem">
A. Ang and M. Piazzesi. A no-arbitrage vector autoregression of term structure dynamics with macroeconomic and latent variables. <em>Journal of Monetary Economics</em>, 50(4): 745–787, 2003. URL <a href="https://doi.org/10.1016/S0304-3932(03)00032-1">https://doi.org/10.1016/S0304-3932(03)00032-1</a>.
</div>
<div id="ref-BauerRudebusch2017" class="csl-entry" role="listitem">
M. D. Bauer and G. D. Rudebusch. Resolving the spanning puzzle in macro-finance term structure models. <em>Review of Finance</em>, 21(2): 511–553, 2017. URL <a href="https://doi.org/10.1093/rof/rfw044">https://doi.org/10.1093/rof/rfw044</a>.
</div>
<div id="ref-BauerRudebuschWu2012" class="csl-entry" role="listitem">
M. D. Bauer, G. D. Rudebusch and J. C. Wu. Correcting estimation bias in dynamic term structure models. <em>Journal of Business &amp; Economic Statistics</em>, 30(3): 454–467, 2012. URL <a href="https://doi.org/10.1080/07350015.2012.693855">https://doi.org/10.1080/07350015.2012.693855</a>.
</div>
<div id="ref-statespacer2023" class="csl-entry" role="listitem">
D. Beijers. <em><span class="nocase">statespacer</span>: State space modelling in <span>R</span>.</em> 2023. URL <a href="https://CRAN.R-project.org/package=statespacer">https://CRAN.R-project.org/package=statespacer</a>. <span>R</span> package version 0.5.0.
</div>
<div id="ref-BGVAR2024" class="csl-entry" role="listitem">
M. Boeck, M. Feldkircher, F. Huber and D. Hosszejni. <em><span>BGVAR</span>: <span>Bayesian</span> global vector autoregressions.</em> 2024. URL <a href="https://CRAN.R-project.org/package=BGVAR">https://CRAN.R-project.org/package=BGVAR</a>. <span>R</span> package version 2.5.8.
</div>
<div id="ref-CandelonMoura2024" class="csl-entry" role="listitem">
B. Candelon and R. Moura. A multicountry model of the term structures of interest rates with a <span>GVAR</span>. <em>Journal of Financial Econometrics</em>, 22(5): 1558–1587, 2024. URL <a href="https://doi.org/10.1093/jjfinec/nbae008">https://doi.org/10.1093/jjfinec/nbae008</a>.
</div>
<div id="ref-CandelonMoura2023" class="csl-entry" role="listitem">
B. Candelon and R. Moura. Sovereign yield curves and the <span>COVID</span>-19 in emerging markets. <em>Economic Modelling</em>, 127: 106453, 2023. URL <a href="https://doi.org/10.1016/j.econmod.2023.106453">https://doi.org/10.1016/j.econmod.2023.106453</a>.
</div>
<div id="ref-ChudikPesaran2016" class="csl-entry" role="listitem">
A. Chudik and M. H. Pesaran. Theory and practice of <span>GVAR</span> modelling. <em>Journal of Economic Surveys</em>, 30(1): 165–197, 2016. URL <a href="https://doi.org/10.1111/joes.12095">https://doi.org/10.1111/joes.12095</a>.
</div>
<div id="ref-DaiSingleton2002" class="csl-entry" role="listitem">
Q. Dai and K. J. Singleton. Expectation puzzles, time-varying risk premia, and affine models of the term structure. <em>Journal of Financial Economics</em>, 63(3): 415–441, 2002. URL <a href="https://doi.org/10.1016/S0304-405X(02)00067-3">https://doi.org/10.1016/S0304-405X(02)00067-3</a>.
</div>
<div id="ref-DaiSingleton2000" class="csl-entry" role="listitem">
Q. Dai and K. J. Singleton. Specification analysis of affine term structure models. <em>Journal of Finance</em>, 55(5): 1943–1978, 2000. URL <a href="https://doi.org/10.1111/0022-1082.00278">https://doi.org/10.1111/0022-1082.00278</a>.
</div>
<div id="ref-DuffieKan1996" class="csl-entry" role="listitem">
D. Duffie and R. Kan. A yield-factor model of interest rates. <em>Mathematical Finance</em>, 6(4): 379–406, 1996. URL <a href="https://doi.org/10.1111/j.1467-9965.1996.tb00123.x">https://doi.org/10.1111/j.1467-9965.1996.tb00123.x</a>.
</div>
<div id="ref-YieldCurve2015" class="csl-entry" role="listitem">
S. S. Guirreri. <em><span>YieldCurve</span>: Modelling and estimation of the yield curve.</em> 2015. URL <a href="https://CRAN.R-project.org/package=YieldCurve">https://CRAN.R-project.org/package=YieldCurve</a>. <span>R</span> package version 4.1.
</div>
<div id="ref-GurkaynakWright2012" class="csl-entry" role="listitem">
R. S. Gürkaynak and J. H. Wright. Macroeconomics and the term structure. <em>Journal of Economic Literature</em>, 50(2): 331–67, 2012. URL <a href="https://www.aeaweb.org/articles?id=10.1257/jel.50.2.331">https://www.aeaweb.org/articles?id=10.1257/jel.50.2.331</a>.
</div>
<div id="ref-Horowitz2019" class="csl-entry" role="listitem">
J. L. Horowitz. Bootstrap methods in econometrics. <em>Annual Review of Economics</em>, 11(1): 193–224, 2019. URL <a href="https://doi.org/10.1146/annurev-economics-080218-025651">https://doi.org/10.1146/annurev-economics-080218-025651</a>.
</div>
<div id="ref-HyndmanKillick2025" class="csl-entry" role="listitem">
R. J. Hyndman and R. Killick. <span>CRAN</span> task view: Time series analysis. 2025. URL <a href="https://cran.r-project.org/web/views/TimeSeries.html">https://cran.r-project.org/web/views/TimeSeries.html</a>.
</div>
<div id="ref-JoslinPriebschSingleton2014" class="csl-entry" role="listitem">
S. Joslin, M. Priebsch and K. J. Singleton. Risk premiums in dynamic term structure models with unspanned macro risks. <em>Journal of Finance</em>, 69(3): 1197–1233, 2014. URL <a href="https://doi.org/10.1111/jofi.12131">https://doi.org/10.1111/jofi.12131</a>.
</div>
<div id="ref-JoslinSingletonZhu2011" class="csl-entry" role="listitem">
S. Joslin, K. J. Singleton and H. Zhu. A new perspective on <span>Gaussian</span> dynamic term structure models. <em>Review of Financial Studies</em>, 24(3): 926–970, 2011. URL <a href="https://doi.org/10.1093/rfs/hhq128">https://doi.org/10.1093/rfs/hhq128</a>.
</div>
<div id="ref-JotikasthiraLeLundblad2015" class="csl-entry" role="listitem">
C. Jotikasthira, A. Le and C. Lundblad. Why do term structures in different currencies co-move? <em>Journal of Financial Economics</em>, 115: 58–83, 2015. URL <a href="https://doi.org/10.1016/j.jfineco.2014.09.004">https://doi.org/10.1016/j.jfineco.2014.09.004</a>.
</div>
<div id="ref-KilianLutkepohl2017" class="csl-entry" role="listitem">
L. Kilian and H. Lütkepohl. <em>Structural vector autoregressive analysis.</em> Cambridge University Press, 2017. URL <a href="https://doi.org/10.1017/9781108164818">https://doi.org/10.1017/9781108164818</a>.
</div>
<div id="ref-svars2023" class="csl-entry" role="listitem">
A. Lange, B. Dalheimer, H. Herwartz, S. Maxand and H. Riebl. <em><span class="nocase">svars</span>: Data-driven identification of <span>SVAR</span> models.</em> 2023. URL <a href="https://CRAN.R-project.org/package=svars">https://CRAN.R-project.org/package=svars</a>. <span>R</span> package version 1.3.11.
</div>
<div id="ref-LittermanScheinkman1991" class="csl-entry" role="listitem">
R. Litterman and J. Scheinkman. Common factors affecting bond returns. <em>Journal of Fixed Income</em>, 1: 54–61, 1991. DOI <a href="https://doi.org/10.3905/jfi.1991.692347">10.3905/jfi.1991.692347</a>.
</div>
<div id="ref-MultiATSM2025" class="csl-entry" role="listitem">
R. Moura. <em><span>MultiATSM</span>: Multicountry term structure of interest rates models.</em> 2025. URL <a href="https://CRAN.R-project.org/package=MultiATSM">https://CRAN.R-project.org/package=MultiATSM</a>. <span>R</span> package version 1.5.1.
</div>
<div id="ref-Moura2022" class="csl-entry" role="listitem">
R. G. T. de Moura. Modelling the term structure of interest rates in a multicountry setting. 2022. URL <a href="https://dial.uclouvain.be/pr/boreal/object/boreal:262850">https://dial.uclouvain.be/pr/boreal/object/boreal:262850</a>.
</div>
<div id="ref-NelsonSiegel1987" class="csl-entry" role="listitem">
C. R. Nelson and A. F. Siegel. Parsimonious modeling of yield curves. <em>Journal of Business</em>, 473–489, 1987. URL <a href="https://www.jstor.org/stable/2352957">https://www.jstor.org/stable/2352957</a>.
</div>
<div id="ref-BigVAR2025" class="csl-entry" role="listitem">
W. Nicholson, D. Matteson and J. Bien. <em><span>BigVAR</span>: Dimension reduction methods for multivariate time series.</em> 2025. URL <a href="https://CRAN.R-project.org/package=BigVAR">https://CRAN.R-project.org/package=BigVAR</a>. <span>R</span> package version 1.1.3.
</div>
<div id="ref-PesaranShin1998" class="csl-entry" role="listitem">
H. H. Pesaran and Y. Shin. Generalized impulse response analysis in linear multivariate models. <em>Economics Letters</em>, 58(1): 17–29, 1998. URL <a href="https://doi.org/10.1016/S0165-1765(97)00214-0">https://doi.org/10.1016/S0165-1765(97)00214-0</a>.
</div>
<div id="ref-simStateSpace2025" class="csl-entry" role="listitem">
I. J. A. Pesigan. <em><span class="nocase">simStateSpace</span>: Simulate data from state space models.</em> 2025. URL <a href="https://CRAN.R-project.org/package=simStateSpace">https://CRAN.R-project.org/package=simStateSpace</a>. <span>R</span> package version 1.2.10.
</div>
<div id="ref-vars2024" class="csl-entry" role="listitem">
B. Pfaff and M. Stigler. <em><span class="nocase">vars</span>: <span>VAR</span> modelling.</em> 2024. URL <a href="https://CRAN.R-project.org/package=vars">https://CRAN.R-project.org/package=vars</a>. <span>R</span> package version 1.6-1.
</div>
<div id="ref-Piazzesi2010" class="csl-entry" role="listitem">
M. Piazzesi. Affine term structure models. In <em>Handbook of financial econometrics: Tools and techniques</em>, pages. 691–766 2010. Elsevier. URL <a href="https://doi.org/10.1016/B978-0-444-50897-3.50015-8">https://doi.org/10.1016/B978-0-444-50897-3.50015-8</a>.
</div>
<div id="ref-RudebuschWu2008" class="csl-entry" role="listitem">
G. D. Rudebusch and T. Wu. A macro-finance model of the term structure, monetary policy and the economy. <em>The Economic Journal</em>, 118(530): 906–926, 2008. URL <a href="https://doi.org/10.1111/j.1468-0297.2008.02155.x">https://doi.org/10.1111/j.1468-0297.2008.02155.x</a>.
</div>
<div id="ref-fBonds2017" class="csl-entry" role="listitem">
T. Setz. <em><span class="nocase">fBonds</span>: <span>R</span>metrics - pricing and evaluating bonds.</em> 2017. URL <a href="https://CRAN.R-project.org/package=fBonds">https://CRAN.R-project.org/package=fBonds</a>. <span>R</span> package version 3042.78.
</div>
<div id="ref-Svensson1994" class="csl-entry" role="listitem">
L. E. Svensson. Estimating and interpreting forward interest rates: <span>Sweden</span> 1992-1994. 1994. URL <a href="https://www.nber.org/papers/w4871">https://www.nber.org/papers/w4871</a>.
</div>
<div id="ref-MTS2022" class="csl-entry" role="listitem">
R. S. Tsay, D. Wood and J. Lachmann. <em><span>MTS</span>: All-purpose toolkit for analyzing multivariate time series (MTS) and estimating multivariate volatility models.</em> 2022. URL <a href="https://CRAN.R-project.org/package=MTS">https://CRAN.R-project.org/package=MTS</a>. <span>R</span> package version 1.2.1.
</div>
<div id="ref-Spillover2024" class="csl-entry" role="listitem">
J. Urbina. <em><span>Spillover</span>: Spillover/connectedness index based on VAR modelling.</em> 2024. URL <a href="https://CRAN.R-project.org/package=Spillover">https://CRAN.R-project.org/package=Spillover</a>. <span>R</span> package version 0.1.1.
</div>
<div id="ref-Vasicek1977" class="csl-entry" role="listitem">
O. Vasicek. An equilibrium characterization of the term structure. <em>Journal of Financial Economics</em>, 5(2): 177–188, 1977. URL <a href="https://doi.org/10.1016/0304-405X(77)90016-2">https://doi.org/10.1016/0304-405X(77)90016-2</a>.
</div>
<div id="ref-ggplot22016" class="csl-entry" role="listitem">
H. Wickham. <em><span class="nocase">ggplot2</span>: Elegant graphics for data analysis.</em> Springer-Verlag New York, 2016. URL <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-bigtime2023" class="csl-entry" role="listitem">
I. Wilms, D. S. Matteson, J. Bien, S. Basu and W. N. E. Wegner. <em><span class="nocase">bigtime</span>: Sparse estimation of large time series models.</em> 2023. URL <a href="https://CRAN.R-project.org/package=bigtime">https://CRAN.R-project.org/package=bigtime</a>. <span>R</span> package version 0.2.3.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>Specifically, the referred loadings are <span class="math inline">\(a_{i,n+1}(\Theta _{n+1}) = a_{i,n}(\Theta _{n}) + b_{i,n}(\Theta _{n}) \mu^{Q}_{i,X} + \frac{1}{2} b_{i,n}(\Theta _{n}) \Gamma_{i,X} \Gamma_{i,X}&#39; b_{i,n}(\Theta _{n})&#39; - \delta_{i,0}\)</span> and <span class="math inline">\(b_{i, n+1}=b_{i,n}\Phi^{Q}_{i,X} - \delta_{i,1}\)</span>, considering that the boundary conditions are <span class="math inline">\(a_{i,1}(\Theta _1)=-\delta_{i,0}\)</span> and <span class="math inline">\(b_{i,1}(\Theta_1)=-\delta_{i,1}\)</span>. These expressions assume that the Radon–Nikodym derivative, which maps the risk-neutral measure to the physical measure, follows a log-normal process, and that the market price of risk is time-varying and affine in <span class="math inline">\(X_t\)</span>. See <span class="citation" data-cites="AngPiazzesi2003">Ang and Piazzesi (<a href="#ref-AngPiazzesi2003" role="doc-biblioref">2003</a>)</span> for a detailed derivation of these expressions.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Noticeably, in the context of the <a href="https://cran.r-project.org/package=MultiATSM">MultiATSM</a> package, the model type <code>JLL No DomUnit</code> is the only exception (see Section <a href="#S:ATSMoptions">3</a>).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>It is worth emphasizing that, although the <code>DataForEstimation()</code> and <code>InputsForOpt()</code> functions in the package accept inputs with differing maturities, their outputs are standardized to a common set of yields.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Moura, "MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models", The R Journal, 2026</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2025-044,
  author = {Moura, Rubens},
  title = {MultiATSM: An R Package for Arbitrage-Free Macrofinance Multicountry Affine Term Structure Models},
  journal = {The R Journal},
  year = {2026},
  note = {https://doi.org/10.32614/RJ-2025-044},
  doi = {10.32614/RJ-2025-044},
  volume = {17},
  issue = {4},
  issn = {2073-4859},
  pages = {275-303}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
