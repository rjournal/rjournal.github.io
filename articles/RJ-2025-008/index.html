<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies</title>

<meta property="description" itemprop="description" content="In the context of paid research studies and clinical trials, budget&#10;considerations often require patient sampling from available&#10;populations, which comes with inherent constraints. We introduce the R&#10;package CDsampling, which is the first to our knowledge to integrate&#10;optimal design theories within the framework of constrained sampling.&#10;This package offers the possibility to find both D-optimal approximate&#10;and exact allocations for samplings with or without constraints.&#10;Additionally, it provides functions to find constrained uniform&#10;sampling as a robust sampling strategy when the model information is&#10;limited. To demonstrate its efficacy, we provide simulated examples&#10;and a real-data example with datasets embedded in the package and&#10;compare them with classical sampling methods. Furthermore, the&#10;CDsampling package revisits the theoretical results of the Fisher&#10;information matrix for generalized linear models (including the&#10;regular linear regression model) and multinomial logistic models,&#10;offering functions for its computation."/>

<link rel="canonical" href="https://doi.org/10.32614/RJ-2025-008/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../resources/favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-08-18"/>
<meta property="article:created" itemprop="dateCreated" content="2025-08-18"/>
<meta name="article:author" content="Yifei Huang"/>
<meta name="article:author" content="Liping Tong"/>
<meta name="article:author" content="Jie Yang"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="In the context of paid research studies and clinical trials, budget&#10;considerations often require patient sampling from available&#10;populations, which comes with inherent constraints. We introduce the R&#10;package CDsampling, which is the first to our knowledge to integrate&#10;optimal design theories within the framework of constrained sampling.&#10;This package offers the possibility to find both D-optimal approximate&#10;and exact allocations for samplings with or without constraints.&#10;Additionally, it provides functions to find constrained uniform&#10;sampling as a robust sampling strategy when the model information is&#10;limited. To demonstrate its efficacy, we provide simulated examples&#10;and a real-data example with datasets embedded in the package and&#10;compare them with classical sampling methods. Furthermore, the&#10;CDsampling package revisits the theoretical results of the Fisher&#10;information matrix for generalized linear models (including the&#10;regular linear regression model) and multinomial logistic models,&#10;offering functions for its computation."/>
<meta property="og:url" content="https://doi.org/10.32614/RJ-2025-008/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="The R Journal"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies"/>
<meta property="twitter:description" content="In the context of paid research studies and clinical trials, budget&#10;considerations often require patient sampling from available&#10;populations, which comes with inherent constraints. We introduce the R&#10;package CDsampling, which is the first to our knowledge to integrate&#10;optimal design theories within the framework of constrained sampling.&#10;This package offers the possibility to find both D-optimal approximate&#10;and exact allocations for samplings with or without constraints.&#10;Additionally, it provides functions to find constrained uniform&#10;sampling as a robust sampling strategy when the model information is&#10;limited. To demonstrate its efficacy, we provide simulated examples&#10;and a real-data example with datasets embedded in the package and&#10;compare them with classical sampling methods. Furthermore, the&#10;CDsampling package revisits the theoretical results of the Fisher&#10;information matrix for generalized linear models (including the&#10;regular linear regression model) and multinomial logistic models,&#10;offering functions for its computation."/>
<meta property="twitter:url" content="https://doi.org/10.32614/RJ-2025-008/"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies"/>
<meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-008"/>
<meta name="citation_pdf_url" content="RJ-2025-008.pdf"/>
<meta name="citation_volume" content="17"/>
<meta name="citation_issue" content="1"/>
<meta name="citation_doi" content="10.32614/RJ-2025-008"/>
<meta name="citation_journal_title" content="The R Journal"/>
<meta name="citation_issn" content="2073-4859"/>
<meta name="citation_firstpage" content="160"/>
<meta name="citation_lastpage" content="179"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/08/18"/>
<meta name="citation_publication_date" content="2025/08/18"/>
<meta name="citation_author" content="Yifei Huang"/>
<meta name="citation_author_institution" content="Department of Mathematics, Statistics, and Computer Science"/>
<meta name="citation_author" content="Liping Tong"/>
<meta name="citation_author_institution" content="Advocate Aurora Health"/>
<meta name="citation_author" content="Jie Yang"/>
<meta name="citation_author_institution" content="Department of Mathematics, Statistics, and Computer Science"/>
<!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","slug","citation_url","packages","preview","bibliography","CTV","legacy_pdf","legacy_converted","output","draft","pdf_url","doi","creative_commons","csl","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies"]},{"type":"character","attributes":{},"value":["In the context of paid research studies and clinical trials, budget\nconsiderations often require patient sampling from available\npopulations, which comes with inherent constraints. We introduce the R\npackage CDsampling, which is the first to our knowledge to integrate\noptimal design theories within the framework of constrained sampling.\nThis package offers the possibility to find both D-optimal approximate\nand exact allocations for samplings with or without constraints.\nAdditionally, it provides functions to find constrained uniform\nsampling as a robust sampling strategy when the model information is\nlimited. To demonstrate its efficacy, we provide simulated examples\nand a real-data example with datasets embedded in the package and\ncompare them with classical sampling methods. Furthermore, the\nCDsampling package revisits the theoretical results of the Fisher\ninformation matrix for generalized linear models (including the\nregular linear regression model) and multinomial logistic models,\noffering functions for its computation."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Yifei Huang"]},{"type":"character","attributes":{},"value":["Department of Mathematics, Statistics, and Computer Science"]},{"type":"character","attributes":{},"value":["University of Illinois at Chicago","E-mail: [yhuan39@uic.edu](yhuan39@uic.edu){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Liping Tong"]},{"type":"character","attributes":{},"value":["Advocate Aurora Health"]},{"type":"character","attributes":{},"value":["E-mail: [liping.tong@aah.org](liping.tong@aah.org){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Jie Yang"]},{"type":"character","attributes":{},"value":["Department of Mathematics, Statistics, and Computer Science"]},{"type":"character","attributes":{},"value":["University of Illinois at Chicago","E-mail: [jyang06@uic.edu](jyang06@uic.edu){.uri}\n"]}]}]},{"type":"character","attributes":{},"value":["2025-08-18"]},{"type":"character","attributes":{},"value":["2025-01-22"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[160]},{"type":"integer","attributes":{},"value":[179]}]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[1]},{"type":"character","attributes":{},"value":["RJ-2025-008"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-008"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["CDsampling","sampling","SamplingStrata","AlgDesign","OptimalDesign","acebayes","OPDOE","cubature"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["CDsampling.bib"]},{"type":"character","attributes":{},"value":["Bayesian","ExperimentalDesign","NumericalMathematics","OfficialStatistics"]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","mathjax","md_extension"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"]},{"type":"character","attributes":{},"value":["-tex_math_single_backslash"]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["RJ-2025-008.pdf"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-008"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-008/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["CDsampling.bib","CDsampling.tex","figures/approx_to_exact.png","figures/Lift_one.png","figures/RMSE_paid.png","figures/trauma_data.png","figures/trial_data.png","figures/unconstrained_lift_one.png","RJ-2025-008_files/anchor-4.2.2/anchor.min.js","RJ-2025-008_files/bowser-1.9.3/bowser.min.js","RJ-2025-008_files/distill-2.2.21/template.v2.js","RJ-2025-008_files/header-attrs-2.29/header-attrs.js","RJ-2025-008_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2025-008_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2025-008_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2025-008_files/popper-2.6.0/popper.min.js","RJ-2025-008_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2025-008_files/tippy-6.2.7/tippy-light-border.css","RJ-2025-008_files/tippy-6.2.7/tippy.css","RJ-2025-008_files/tippy-6.2.7/tippy.umd.min.js","RJ-2025-008_files/webcomponents-2.0.0/webcomponents.js","RJ-2025-008.pdf","RJ-2025-008.zip","RJournal.sty","RJwrapper.tex","supplement.pdf"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.7);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #ffffff;
}

.distill-site-footer {
  --text-color:       rgba(0, 0, 0, 0.8);
  --text-size:        15px;
  --hover-color:      black;
  --bkgd-color:       #fafafa;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

.nav-right > a {
  text-transform: uppercase;
}

d-title h1, d-title p, d-title figure,
d-abstract p, d-abstract b {
  grid-column: page;
}

.rj-blue {
  color: #2467bb;
}

ul li {
  line-height: 1.6;
  margin-top: 0em;
  margin-bottom: 0em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.29/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies","description":"In the context of paid research studies and clinical trials, budget\nconsiderations often require patient sampling from available\npopulations, which comes with inherent constraints. We introduce the R\npackage CDsampling, which is the first to our knowledge to integrate\noptimal design theories within the framework of constrained sampling.\nThis package offers the possibility to find both D-optimal approximate\nand exact allocations for samplings with or without constraints.\nAdditionally, it provides functions to find constrained uniform\nsampling as a robust sampling strategy when the model information is\nlimited. To demonstrate its efficacy, we provide simulated examples\nand a real-data example with datasets embedded in the package and\ncompare them with classical sampling methods. Furthermore, the\nCDsampling package revisits the theoretical results of the Fisher\ninformation matrix for generalized linear models (including the\nregular linear regression model) and multinomial logistic models,\noffering functions for its computation.","doi":"10.32614/RJ-2025-008","authors":[{"author":"Yifei Huang","authorURL":"#","affiliation":"Department of Mathematics, Statistics, and Computer Science","affiliationURL":"#","orcidID":""},{"author":"Liping Tong","authorURL":"#","affiliation":"Advocate Aurora Health","affiliationURL":"#","orcidID":""},{"author":"Jie Yang","authorURL":"#","affiliation":"Department of Mathematics, Statistics, and Computer Science","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-08-18T00:00:00.000+00:00","citationText":"Huang, et al., 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../resources/rlogo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">The R Journal</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../issues/2025-1">Current</a>
<a href="../../issues.html">Issues</a>
<a href="../../news.html">News</a>
<a href="../../submissions.html">Submit</a>
<a href="../../contribute.html">Contribute</a>
<a href="../../editors.html">Editorial board</a>
<a href="../../articles.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>In the context of paid research studies and clinical trials, budget
considerations often require patient sampling from available
populations, which comes with inherent constraints. We introduce the R
package CDsampling, which is the first to our knowledge to integrate
optimal design theories within the framework of constrained sampling.
This package offers the possibility to find both D-optimal approximate
and exact allocations for samplings with or without constraints.
Additionally, it provides functions to find constrained uniform
sampling as a robust sampling strategy when the model information is
limited. To demonstrate its efficacy, we provide simulated examples
and a real-data example with datasets embedded in the package and
compare them with classical sampling methods. Furthermore, the
CDsampling package revisits the theoretical results of the Fisher
information matrix for generalized linear models (including the
regular linear regression model) and multinomial logistic models,
offering functions for its computation.</p></p>
</div>

<div class="d-byline">
  Yifei Huang  (Department of Mathematics, Statistics, and Computer Science)
  
,   Liping Tong  (Advocate Aurora Health)
  
,   Jie Yang  (Department of Mathematics, Statistics, and Computer Science)
  
<br/>2025-08-18
</div>

<div class="d-article">
<div class="article">
<h3 data-number="1" id="sec:intro"><span class="header-section-number">1</span> Introduction</h3>
<p>Paid research studies are essential for determining the influence of new
interventions or treatments and for providing quantitative evidence in
various domains, such as healthcare, psychology, and politics. However,
conducting such studies often involves a limited budget and a large pool
of potential volunteers, which poses a challenge in selecting the best
sample to meet the research objectives. Poor samples may result in
biased or inaccurate estimates, low statistical power, and even
misleading conclusions. Therefore, finding a good sampling strategy is
crucial for researchers and practitioners.</p>
<p>Consider a constrained sampling problem commonly encountered in paid
research studies. Suppose, in a research study to evaluate a new
intervention, <span class="math inline">\(N=500\)</span> volunteers register to participate. Upon
registration, the investigators collect basic demographic information,
such as gender (female or male) and age groups (<span class="math inline">\(18\sim25\)</span>, <span class="math inline">\(26\sim64\)</span>,
<span class="math inline">\(65\)</span> and above) for each volunteer. Treating gender and age as
stratification factors, we obtain <span class="math inline">\(m=6\)</span> subgroups. However, due to
budget limitations, the study could only accommodate <span class="math inline">\(n=200\)</span>
participants. Let <span class="math inline">\(N_i\)</span> denote the frequency of volunteers within the
<span class="math inline">\(i\)</span>th subgroup, where <span class="math inline">\(i=1,\dots,m\)</span>. We call the integer number of
participants sampled from each subgroup, <span class="math inline">\(n_i\)</span>, the exact allocation,
and the corresponding proportion <span class="math inline">\(n_i/N_i\)</span> the approximate allocation.
The goal is to select a sample of <span class="math inline">\(200\)</span> participants
<span class="math inline">\(\mathbf n = (n_1, \dots, n_m)\)</span>, such that <span class="math inline">\(\sum_{i=1}^m n_i = 200\)</span> from
the pool of <span class="math inline">\(N=500\)</span> volunteers to evaluate the intervention effect most
accurately, subject to the constraint that no subgroup is oversampled
beyond the number of available volunteers within that subgroup, that is,
<span class="math inline">\(n_i \le N_i\)</span>. This constraint is the most commonly encountered in paid
research studies (see
Section <a href="#sec:example_glm" data-reference-type="ref" data-reference="sec:example_glm">3.1</a> for details, and for constraints of other
forms, please refer to
Section <a href="#sec:MLM_example" data-reference-type="ref" data-reference="sec:MLM_example">3.2</a>).</p>
<p>Commonly used sampling strategies include simple random sampling,
stratified sampling, and cluster sampling. Simple random sampling is the
most straightforward form of probability sampling, where each element
has an equal chance of being selected (Tillé 2006). Proportionally
stratified sampling involves dividing the population into homogeneous
subgroups, such as gender and age groups, and applying random sampling
to sample proportionally within each subgroup (Lohr 2019). Cluster
sampling, on the other hand, splits the population into heterogeneous
clusters, for example, based on the locations of volunteers, and
randomly selects some clusters as the sample units. However, these
methods have their drawbacks. Cluster sampling is relatively low-cost
but less precise than simple random sampling. Stratified sampling can
produce more efficient estimators of population means, but it requires
finding well-defined and relevant subgroups that cover the entire
population (Levy and Lemeshow 2008). Moreover, these existing methods
are based on assumptions that may not hold if model estimation is the
primary goal of the paid research study.</p>
<p>In the proposed
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package,
we implement the sampling strategy based on optimal design theory (with
main functions <code>liftone_GLM()</code>, <code>liftone_constrained_GLM()</code>,
<code>liftone_MLM()</code>, and ), which can improve the accuracy of the
intervention effect estimation. Optimal design theory is a branch of
experimental design that aims to find the best allocation of
experimental units to achieve a specific optimality criterion such as
minimizing the variance of estimation or equivalently maximizing the
information obtained from the design. For example, D-optimality
maximizes the determinant of the information matrix, which minimizes the
estimators’ expected volume of the joint confidence ellipsoid.
A-optimality minimizes the trace of the inverse information matrix,
equivalent to minimizing the average of the variances of the estimators.
E-optimality minimizes the maximum eigenvalue of the inverse information
matrix, which minimizes the largest expected semi-axis of the confidence
ellipsoid and protects against the worst possible case (Fedorov 1972;
Atkinson, Donev, and Tobias 2007; M. Yang and Stufken 2012; Fedorov and
Leonov 2014). In this paper, we focus on D-optimality due to its overall
good performance and mathematical simplicity (Zocchi and Atkinson 1999;
Atkinson, Donev, and Tobias 2007). <span style="color: black">According to (Huang, Tong, and Yang
2025), the constrained D-optimal sampling strategies work well for paid
research studies or clinical trials.</span> To implement
the recommended sampling strategy, we develop an R package called
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> (namely,
<u>C</u>onstrained <u>D</u>-optimal
<u>sampling</u>), available on CRAN at
<a href="https://cran.r-project.org/package=CDsampling" class="uri">https://cran.r-project.org/package=CDsampling</a>. To the best of our
knowledge,
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> is the
first R package offering a sampling tool with constraints in paid
research studies based on optimal design theory. Package
<a href="https://CRAN.R-project.org/package=sampling"><strong>sampling</strong></a> implements
random samples using different sampling schemes (Tillé and Matei 2016).
The package also provides functions to obtain (generalized) calibration
weights, different estimators, as well as some variance estimators.
Package
<a href="https://CRAN.R-project.org/package=SamplingStrata"><strong>SamplingStrata</strong></a>
determines the best stratification for a population frame that ensures
the minimum sample cost with precision thresholds (Barcaroli 2014). On
the other hand, there are existing R packages for optimal designs.
Package <a href="https://CRAN.R-project.org/package=AlgDesign"><strong>AlgDesign</strong></a>
finds exact and approximate allocations of optimal designs under D-, A-,
and I-criteria (Wheeler and Braun 2019). Package
<a href="https://CRAN.R-project.org/package=OptimalDesign"><strong>OptimalDesign</strong></a>
enables users to compute D-, A-, I-, and c-efficient designs with or
without replications, restricted design spaces, and under multiple
linear constraints (Harman, Filova, and Filova 2016). Package
<a href="https://CRAN.R-project.org/package=acebayes"><strong>acebayes</strong></a> finds
Bayesian optimal experimental designs with approximate coordinate
exchange algorithm (Antony M. Overstall, Woods, and Adamou 2020; Antony
M. Overstall et al. 2018). Package
<a href="https://CRAN.R-project.org/package=OPDOE"><strong>OPDOE</strong></a> provides functions
for optimal designs with polynomial regression models and ANOVA
(Grömping 2011). These packages provide programming tools for finding
samplings or optimal designs under different criteria and models.
However, they do not address the specific challenges of practical
feasibility in the constrained sampling scheme of paid research studies.
The proposed
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package
fills this gap by offering an efficient sampling tool to handle general
constraints and common parametric models in paid research studies.</p>
<h3 data-number="2" id="sec:model"><span class="header-section-number">2</span> Method</h3>
<h4 class="unnumbered" data-number="2.1" id="sec:model_algorithm">Constrained lift-one algorithm</h4>
<p>The lift-one algorithm was initially proposed by J. Yang, Mandal, and
Majumdar (2016) to find D-optimal designs with binary responses. This
was extended to generalized linear models (GLMs) by J. Yang and Mandal
(2015) and subsequently adapted for cumulative link models by J. Yang,
Tong, and Mandal (2017). The methodology was further extended to
multinomial logit models (MLMs) by Bu, Majumdar, and Yang (2020).</p>
<p>Figure <a href="#fig:liftone_algo" data-reference-type="ref" data-reference="fig:liftone_algo">1</a> provides a concise summary of the lift-one
algorithm applied to general parametric models. The detailed algorithm
is provided in Algorithm <span class="math inline">\(3\)</span> from the Supplementary Material of Huang,
Tong, and Yang (2025). We consider a general study or experiment
involving covariates <span class="math inline">\(\mathbf{x}_i = (x_{i1}, \dots, x_{id})^\top\)</span>, for
<span class="math inline">\(i = 1, \dots, m\)</span>, referred to as experimental settings. In paid
research studies, these covariates could be the stratification factors
such as the gender and age groups in our motivating example. Here,
<span class="math inline">\(m \ge 2\)</span> denotes the number of experimental settings, which corresponds
to <span class="math inline">\(m=6\)</span>, the number of gender and age groups in the motivating example.
Suppose the responses follow a parametric model
<span class="math inline">\(M(\mathbf x_i, \boldsymbol \theta)\)</span>, where
<span class="math inline">\(\boldsymbol \theta \subseteq \mathbb{R}^p\)</span> with <span class="math inline">\(p\ge 2\)</span>. Under
regularity conditions, the Fisher information matrix of the experiment
design can be written as <span class="math inline">\(\mathbf F = \sum_{i=1}^m n_i \mathbf F_i\)</span>,
where <span class="math inline">\(\mathbf F_i, i=1, \dots, m\)</span> is the Fisher information matrix at
<span class="math inline">\(\mathbf x_i\)</span> and <span class="math inline">\(n_i\)</span> is the number of subjects allocated to the <span class="math inline">\(i\)</span>th
experimental setting. In the setting of paid research studies, <span class="math inline">\(n_i\)</span>
corresponds to the number of subjects sampled from the <span class="math inline">\(i\)</span>th subgroup.
We usually call <span class="math inline">\(\mathbf n = (n_1, \dots, n_m)^\top\)</span> the exact
allocation, where <span class="math inline">\(n=\sum_{i=1}^m n_i\)</span>, and
<span class="math inline">\(\mathbf w = (w_1,\dots,w_m)^\top=(n_1/n, \dots, n_m/n)^\top\)</span> the
approximate allocation, where <span class="math inline">\(w_i \ge 0\)</span> and <span class="math inline">\(\sum_{i=1}^m w_i = 1\)</span>
(Kiefer 1974; Pukelsheim 2006; Atkinson, Donev, and Tobias 2007). The
approximate allocation is theoretically more tractable, while the exact
allocation is practically more useful. In the statistical literature,
approximate allocations are more commonly discussed (Kiefer 1974). The
D-optimal design aims to find the optimal allocation that maximizes
<span class="math inline">\(f({\mathbf w})=|\mathbf F({\mathbf w})|=|\sum_{i=1}^m w_i \mathbf F_i|\)</span>.
The lift-one algorithm simplifies a complex multivariate optimization
problem into a sequence of simpler univariate optimization problems.
This is achieved by “lifting” and optimizing one weight <span class="math inline">\(w_i\)</span>, within
the approximate allocation vector <span class="math inline">\(\mathbf w\)</span>. Specifically, in step
<span class="math inline">\(3^\circ\)</span> of the algorithm depicted in
Figure <a href="#fig:liftone_algo" data-reference-type="ref" data-reference="fig:liftone_algo">1</a>, the determinant of the Fisher information
matrix function concerning the lift-one variable is expressed as
<span class="math inline">\(f(z) = f(\mathbf w_i(z))\)</span> where the variable <span class="math inline">\(z\)</span> substitutes for <span class="math inline">\(w_i\)</span>
in allocation <span class="math inline">\(\mathbf{w}\)</span>, and the remaining weights are adjusted
proportionally, denoted as <span class="math inline">\(\mathbf w_i\)</span>. The updated weight vector is
given by
<span class="math display">\[\mathbf w_i(z) = \left( \frac{1-z}{1-w_i}w_1, \ldots, \frac{1-z}{1-w_i}w_{i-1}, z, \frac{1-z}{1-w_i}w_{i+1}, \ldots, \frac{1-z}{1-w_i}w_m\right)^\top.\]</span>
The allocation that results from the convergence in step <span class="math inline">\(6^\circ\)</span> of
the algorithm is identified as the D-optimal approximate allocation.</p>
<figure id="fig:liftone_algo">
<img src="figures/unconstrained_lift_one.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 1: The framework of lift-one
algorithm.</figcaption>
</figure>
<p>In the context of paid research studies, budgetary limitations often
necessitate the selection of a subset of participants. We consider the
sampling of <span class="math inline">\(n\)</span> subjects from a larger population of <span class="math inline">\(N\)</span>, where <span class="math inline">\(n &lt; N\)</span>.
A typical constraint in such studies is <span class="math inline">\(n_i \leq N_i\)</span>, where <span class="math inline">\(N_i\)</span>
represents the number of available subjects from the <span class="math inline">\(i\)</span>th experimental
setting group. This effectively places an upper bound on the sample size
for each subgroup (or stratum), ensuring the sampling process does not
overdraw from any subgroup. Additional constraints may include
<span class="math inline">\(n_1 + n_2 + n_3 + n_4 \leq 392\)</span> (see the MLM example in
Section <a href="#sec:MLM_example" data-reference-type="ref" data-reference="sec:MLM_example">3.2</a>), <span class="math inline">\(4n_1 \geq n_3\)</span> (see Example S2.2 in
Supplementary Material Section S2), etc. The constrained lift-one
algorithm seeks the approximate allocation <span class="math inline">\({\mathbf w}\)</span> that maximizes
<span class="math inline">\(|{\mathbf F}({\mathbf w})|\)</span>, on a collection of feasible approximate
allocations <span class="math inline">\(S \subseteq S_0\)</span> where
<span class="math display">\[S_0 := \{(w_1, \ldots, w_m)^\top \in \mathbb{R}^m \mid w_i \geq 0, i=1, \ldots, m; \sum_{i=1}^m w_i = 1\}.\]</span>
The set <span class="math inline">\(S\)</span> is presumed to be either a closed convex set or a finite
union of closed convex sets. The framework of the constrained lift-one
algorithm is provided in
Figure <a href="#fig:constrained_liftone_algo" data-reference-type="ref" data-reference="fig:constrained_liftone_algo">2</a>. The details of the algorithm
can be found in Algorithm 1 of Huang, Tong, and Yang (2025). In the
constrained lift-one algorithm, the search for the optimal lift-one
weight <span class="math inline">\(z\)</span> in step <span class="math inline">\(3^\circ\)</span> of
Figure <a href="#fig:constrained_liftone_algo" data-reference-type="ref" data-reference="fig:constrained_liftone_algo">2</a> is confined within the
interval of <span class="math inline">\([r_{i1}, r_{i2}]\)</span> (Example S2.2 in Supplementary Material
Section S2 and Section S.3 in (Huang, Tong, and Yang 2025) for details
of finding <span class="math inline">\([r_{i1}, r_{i2}]\)</span>). To ensure that the resulting allocation
is D-optimal, two additional decision steps, labeled steps <span class="math inline">\(7^\circ\)</span> and
<span class="math inline">\(8^\circ\)</span>, are incorporated into the algorithm. The reported allocation
in step <span class="math inline">\(10^\circ\)</span> is the constrained D-optimal approximate allocation
for the study. To illustrate the difference between the lift-one
algorithm and the constrained lift-one algorithm, we provide examples in
Supplementary Material Section S2.</p>
<figure id="fig:constrained_liftone_algo">
<img src="figures/Lift_one.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 2: The framework of constrained lift-one
algorithm.</figcaption>
</figure>
<p>Upon obtaining the approximate allocation, we may employ the constrained
approximate to exact allocation algorithm outlined in
Figure <a href="#fig:approx_to_exact_algo" data-reference-type="ref" data-reference="fig:approx_to_exact_algo">3</a> for the conversion of a
real-valued approximate allocation to an integer-valued exact
allocation. The full details of the algorithm are in Algorithm 2 of
Huang, Tong, and Yang (2025). The algorithm begins by assigning a floor
integer value to all subgroups <span class="math inline">\(n_i = \lfloor Nw_i\rfloor\)</span>. Subsequently, each
remaining subject is added to the corresponding group in a manner that
maximizes the determinant of the Fisher information matrix. This
transformation provides a more pragmatic application in the actual
sampling process within paid research studies.</p>
<figure id="fig:approx_to_exact_algo">
<img src="figures/approx_to_exact.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 3: The framework of constrained approximate to exact
algorithm.</figcaption>
</figure>
<p>The calculation of the Fisher information matrix <span class="math inline">\(\mathbf{F}\)</span> and the
subsequent maximization of its determinant <span class="math inline">\(|\mathbf{F}|\)</span> are key steps
in both the constrained and original (unconstrained) lift-one
algorithms. The theoretical details and functions for the computation of
<span class="math inline">\(\mathbf{F}\)</span> are provided in
Sections <a href="#sec:model_fisher_glm" data-reference-type="ref" data-reference="sec:model_fisher_glm">2.2</a> and
Section <a href="#sec:model_fisher_mlm" data-reference-type="ref" data-reference="sec:model_fisher_mlm">2.3</a>.</p>
<h4 class="unnumbered" data-number="2.2" id="sec:model_fisher_glm">Fisher information for generalized linear models</h4>
<p>The generalized linear model (GLM) broadens the scope of the traditional
linear model. In the standard approach, the response variable is
expected to change in direct proportion to the covariate. Yet, this
isn’t always a practical assumption. Take binary outcomes, for instance,
the classic linear model falls short here. Similarly, it’s unsuitable
for positive-only data like count data. (Nelder and Wedderburn 1972)
expanded the model to accommodate a wider range of applications.</p>
<p>For a GLM, we assume that response variables <span class="math inline">\(Y_1, \dots, Y_n\)</span> are
independent and from the exponential family. Then we have (Dobson and
Barnett 2018; McCullagh and Nelder 1989)
<span class="math display">\[E(Y_i \mid \mathbf X_i) = \mu_i,\quad g(\mu_i)=\eta_i=\mathbf X_i^\top \boldsymbol \beta\]</span>
where <span class="math inline">\(g\)</span> is a link function,
<span class="math inline">\(\boldsymbol \beta = (\beta_1, \beta_2,\dots, \beta_p)^\top\)</span> is the
parameter vector of interest, and <span class="math inline">\(\mu_i\)</span> is the conditional expectation
of response <span class="math inline">\(Y_i\)</span> given predictors
<span class="math inline">\(\mathbf X_i = \mathbf h(\mathbf x_i) = (h_1(\mathbf x_i),\dots, h_p(\mathbf x_i))^\top\)</span>,
where <span class="math inline">\(i = 1, \dots, n\)</span> with known and deterministic predictor functions
<span class="math inline">\(\mathbf h = (h_1, \dots, h_p)^\top\)</span>. There are various link functions
that could be used, for example, logit link
<span class="math inline">\(\eta_i = \log\frac{\mu_i}{1-\mu_i}\)</span>; probit link
<span class="math inline">\(\eta_i = \Phi^{-1}(\mu_i)\)</span>, where <span class="math inline">\(\Phi(\cdot)\)</span> is the normal
cumulative distribution function; and complementary log-log link
<span class="math inline">\(\eta_i = \log\{-\log(1-\mu_i)\}\)</span>. Regular linear models can be
considered as GLMs with the identity link function and normal responses.
Suppose we have a design with <span class="math inline">\(m\)</span> design points
<span class="math inline">\(\mathbf x_1, \dots, \mathbf x_m\)</span> that has an exact allocation
<span class="math inline">\((n_1,\dots,n_m)\)</span> where <span class="math inline">\(\sum_i n_i = n\)</span> and corresponding approximate
allocation <span class="math inline">\((w_1,\dots,w_m)=(\frac{n_1}{n},\dots,\frac{n_m}{n})\)</span>. The
Fisher information matrix <span class="math inline">\(\mathbf F\)</span> under GLMs can be written as
(McCullagh and Nelder 1989; Khuri et al. 2006; Stufken and Yang 2012; J.
Yang, Mandal, and Majumdar 2016):
<span class="math display" id="eq:FisherGLM">\[\label{eq:FisherGLM}
\mathbf F = n \mathbf X^\top \mathbf W \mathbf X = n\sum_{i=1}^m w_i \nu_i {\mathbf X}_i{\mathbf X}_i^\top   \tag{1}\]</span>
where <span class="math inline">\(\mathbf X = (\mathbf X_1, \dots, \mathbf X_m)^\top\)</span> is the
<span class="math inline">\(m\times p\)</span> design matrix with <span class="math inline">\(\mathbf X_i = \mathbf h(\mathbf x_i)\)</span>,
<span class="math inline">\(\mathbf W = \text{diag}\{w_1\nu_1,\)</span> <span class="math inline">\(\dots, w_m\nu_m\}\)</span> is a diagonal
matrix with
<span class="math inline">\(\nu_i = \frac{1}{\text{Var}(Y_i)} (\frac{\partial \mu_i}{\partial \eta_i})^2\)</span>.
Here, <span class="math inline">\(\nu_i\)</span> represents how much information the design point
<span class="math inline">\(\mathbf x_i\)</span> contains. The explicit formats of <span class="math inline">\(\nu_i\)</span> with different
response distributions and link functions can be found in Table 5 of the
Supplementary Material of (Huang, Tong, and Yang 2025). To calculate the
Fisher information matrix <span class="math inline">\(\mathbf{F}\)</span> given the approximate allocation
<span class="math inline">\(\mathbf{w}\)</span>, we may use the <code>F_func_GLM()</code> function in the
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package.
Additionally, the <code>W_func_GLM()</code> function can be used to find the
diagonal elements of the matrix <span class="math inline">\(\mathbf{W}\)</span> in the Fisher information
matrix <a href="#eq:FisherGLM">(1)</a> of GLM. An example of finding the Fisher
information matrix for GLM is provided in Example S1.1 of Supplementary
Material.</p>
<h4 class="unnumbered" data-number="2.3" id="sec:model_fisher_mlm">Fisher information for multinomial logistic model</h4>
<p>The multinomial logistic model (MLM) is an extension of GLM aiming to
manage responses that fall into multiple categories, such as rating
scales and disease severity levels (Agresti 2013).</p>
<p>We assume that the responses <span class="math inline">\(\mathbf Y_i = (Y_{i1},\dots,Y_{iJ})\)</span>
follow a multinomial distribution with probabilities
<span class="math inline">\((\pi_{i1}, \dots,  \pi_{iJ})\)</span>, where
<span class="math inline">\(\pi_{ij} = \text{P}(Y_i=j \mid {\mathbf x}_i)\)</span>, <span class="math inline">\(Y_i \in \{1, \ldots, J\}\)</span> is
the <span class="math inline">\(i\)</span>th original categorical response, <span class="math inline">\(j = 1,\dots, J\)</span>, and
<span class="math inline">\(\sum_j \pi_{ij} = 1\)</span>. If the response variables are nominal, in other
words, there is no natural ordering among different levels, a commonly
used MLM is the baseline-category logit model with the <span class="math inline">\(J\)</span>th level
selected as the baseline category. If the response variable is ordinal,
that is, we have a natural ordering of response levels, there are three
commonly used MLMs in the literature: cumulative logit model, adjacent
logit model, and continuation-ratio logit model (Bu, Majumdar, and Yang
2020; Dousti Mousavi, Aldirawi, and Yang 2023; Wang and Yang, n.d.).</p>
<p>In addition to different logit models, the proportional odds (po)
assumption is an important concept in MLMs. The po assumption is a
parsimonious model assumption, where a model simultaneously uses all
<span class="math inline">\(J-1\)</span> logits in a single model with the same coefficients. This means
the covariate effect is constant on the odds ratio among different
response levels. When the assumption doesn’t hold, the model is referred
to as a non-proportional odds (npo) model and has more parameters in it.
When the assumption only holds for part of the parameters, the model is
referred to as a partial proportional odds (ppo) model. Commonly used
multinomial logit models with po, npo, or ppo assumptions can be
summarized in a unified matrix form (Glonek and McCullagh 1995; Zocchi
and Atkinson 1999; Bu, Majumdar, and Yang 2020):
<span class="math display">\[\mathbf C^\top \log(\mathbf L \boldsymbol \pi_i) = \mathbf X_i \boldsymbol \theta\]</span>
where
<span class="math display">\[\mathbf C^\top = \begin{pmatrix}
\mathbf I_{J-1} &amp; -\mathbf I_{J-1} &amp; \mathbf 0^\top_{J-1} \\
\mathbf 0^\top_{J-1} &amp; \mathbf 0_{J-1} &amp; 1 \\
\end{pmatrix}\]</span>
is a <span class="math inline">\(J \times (2J-1)\)</span> constant matrix, <span class="math inline">\(\mathbf L\)</span> is a
<span class="math inline">\((2J-1)\times J\)</span> constant matrix with different formats among the four
different multinomial logit models, and
<span class="math inline">\(\boldsymbol \pi_i = (\pi_{i1},\dots,\pi_{iJ})^\top\)</span>. The model matrix
<span class="math inline">\(\mathbf X_i\)</span> is defined in general as
<span class="math display">\[\mathbf X_i = \begin{pmatrix}
    \mathbf h_1^\top(\mathbf x_i)&amp;  &amp;  &amp; \mathbf h_c^\top(\mathbf x_i)\\
     &amp; \ddots &amp; &amp; \vdots\\
      &amp; &amp; \mathbf h_{J-1}^\top (\mathbf x_i) &amp; \mathbf h_{c}^\top (\mathbf x_i)\\
      \mathbf 0^\top_{p_1} &amp; \dots &amp; \mathbf 0^\top_{p_{J-1}} &amp; \mathbf 0^\top_{p_c}
\end{pmatrix}_{J \times p}
\]</span>
and the parameter
<span class="math inline">\(\boldsymbol \theta=(\boldsymbol\beta_1^\top, \dots, \boldsymbol \beta^\top_{J-1}, \boldsymbol\zeta^\top)^\top\)</span>
consists of <span class="math inline">\(p=p_1 + \dots + p_{J-1}+p_c\)</span> unknown parameters. Here
<span class="math inline">\(\mathbf h_j^\top(\cdot) = (h_{j1}(\cdot),\dots, h_{jp_j}(\cdot))\)</span> are
known functions to determine <span class="math inline">\(p_j\)</span> predictors associated with unknown
parameters
<span class="math inline">\(\boldsymbol \beta_j = (\beta_{j1}, \dots, \beta_{jp_{j}})^\top\)</span> in
<span class="math inline">\(j\)</span>th response category, and
<span class="math inline">\(\mathbf h_c^\top(\cdot) = (h_{1}(\cdot),\dots, h_{p_c}(\cdot))\)</span> are
known functions to determine <span class="math inline">\(p_c\)</span> predictors associated with
proportional odds parameters
<span class="math inline">\(\boldsymbol \zeta = (\zeta_1, \dots, \zeta_{p_c})^\top\)</span>. If
<span class="math inline">\(\mathbf h_j^\top(\mathbf x_i)\equiv1\)</span>, the model is a po model; if
<span class="math inline">\(\mathbf h_c^\top(\mathbf x_i)\equiv0\)</span>, the model is an npo model.</p>
<p>According to Theorem 2.1 in (Bu, Majumdar, and Yang 2020), the Fisher
information matrix under a multinomial logistic regression model with
independent observations can be written as
<span class="math display" id="eq:F-sum">\[\label{eq:F_sum}
   \mathbf F = \sum_{i=1}^m n_i \mathbf F_i   \tag{2}\]</span>
where
<span class="math inline">\(\mathbf F_i = (\frac{\partial{\boldsymbol\pi_i}}{\partial{\boldsymbol \theta^\top}})^\top \text{diag}(\boldsymbol \pi_i)^{-1}\frac{\partial \boldsymbol \pi_i}{\partial \boldsymbol \theta^\top}\)</span>
with
<span class="math inline">\(\frac{\partial \boldsymbol \pi_i}{\partial \boldsymbol \theta^\top} = (\mathbf C^\top \mathbf D_i^{-1} \mathbf L)^{-1}\)</span>
and <span class="math inline">\(\mathbf D_i = \text{diag}(\mathbf L \boldsymbol \pi_i)\)</span>. Explicit
forms of <span class="math inline">\((\mathbf C^\top \mathbf D_i^{-1} \mathbf L)^{-1}\)</span> can be found
in Section S.3 of the Supplementary Material of (Bu, Majumdar, and Yang
2020). To calculate the Fisher information matrix <span class="math inline">\(\mathbf F\)</span> for the
MLM, one may use the function <code>F_func_MLM()</code> in the
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package.
An example of finding the Fisher information matrix for MLM is provided
in Example S1.2 of the Supplementary Material.</p>
<h3 data-number="3" id="sec:example"><span class="header-section-number">3</span> Examples</h3>
<p>The methods described in Section <a href="#sec:model" data-reference-type="ref" data-reference="sec:model">2</a> are implemented in the proposed R package
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a>. The
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package
comprises <span class="math inline">\(16\)</span> functions, as detailed in
Table <a href="#Tab:summary_functions" data-reference-type="ref" data-reference="Tab:summary_functions">1</a>. The primary functions of the
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package
are <code>liftone_constrained_GLM()</code> and <code>liftone_constrained_MLM()</code>.
Additionally, the package includes the original (unconstrained) lift-one
algorithm for general experimental designs, accessible via the
<code>liftone_GLM()</code> and <code>liftone_MLM()</code> functions. Two datasets <code>trial_data</code>
and <code>trauma_data</code> are provided for illustration purposes.</p>
<div id="Tab:summary_functions">
<table style="width:99%;">
<caption><span id="tab:T1">Table 1: </span> Functions and corresponding usages in the
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package.</caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 51%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: left;">Usage</th>
<th style="text-align: left;">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" style="text-align: center;">Model</td>
<td style="text-align: left;">Calculating <span class="math inline">\(\mathbf W\)</span> matrix diagonal elements of
generalized linear model (see
Section <a href="#sec:model_fisher_glm" data-reference-type="ref" data-reference="sec:model_fisher_glm">2.2</a>); providing input for
function <code>liftone_GLM()</code> and <code>liftone_constrained_GLM()</code>.</td>
<td style="text-align: left;"><code>W_func_GLM()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Calculating Fisher information matrix and its determinant
of generalized linear model (see Example S1.1 in
Supplementary Material).</td>
<td style="text-align: left;"><code>F_func_GLM()</code>, <code>Fdet_func_GLM()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Calculating Fisher information matrix of multinomial
logit model at a specific design point (see
Section <a href="#sec:model_fisher_mlm" data-reference-type="ref" data-reference="sec:model_fisher_mlm">2.3</a>); using as input of
<code>liftone_MLM()</code> and <code>liftone_constrained_MLM()</code>.</td>
<td style="text-align: left;"><code>Fi_func_MLM()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Calculating Fisher information matrix and its determinant
of multinomial logit model (see Example S1.2 in
Supplementary Material).</td>
<td style="text-align: left;"><code>F_func_MLM()</code>, <code>Fdet_func_MLM()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Using in <code>approxtoexact_constrained_func()</code> to find
constrained uniform exact allocation.</td>
<td style="text-align: left;"><code>Fdet_func_unif()</code></td>
</tr>
<tr class="even">
<td rowspan="4" style="text-align: center;">Sampling</td>
<td style="text-align: left;">Finding unconstrained D-optimal approximate allocation
for generalized linear model and multinomial logit model
(see Section S2 in Supplementary Material).</td>
<td style="text-align: left;"><code>liftone_GLM()</code>, <code>liftone_MLM()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Finding constrained D-optimal approximate allocation for
generalized linear model and multinomial logit model (see
Section <a href="#sec:example" data-reference-type="ref" data-reference="sec:example">3</a>).</td>
<td style="text-align: left;"><code>liftone_constrained_GLM()</code>,
<code>liftone_constrained_MLM()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Transferring approximate allocation to exact allocation
(see Section <a href="#sec:example" data-reference-type="ref" data-reference="sec:example">3</a>).</td>
<td style="text-align: left;"><code>approxtoexact_constrained_func()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Finding constrained uniform exact allocation for bounded
constraint (see
Section <a href="#sec:example_glm" data-reference-type="ref" data-reference="sec:example_glm">3.1</a>).</td>
<td style="text-align: left;"><code>approxtoexact_func()</code>
<code>bounded_uniform()</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">Example Specific</td>
<td style="text-align: left;">Finding <span class="math inline">\(I\)</span> set for exact allocation conversion in
<code>trial_data</code> and <code>trauma_data</code> examples (see
Section <a href="#sec:example" data-reference-type="ref" data-reference="sec:example">3</a> and Section S4 in Supplementary
Material).</td>
<td style="text-align: left;"><code>iset_func_trauma()</code>,
<code>iset_func_trial()</code></td>
</tr>
</tbody>
</table>
</div>
<p>In the remainder of this section, we present two examples to illustrate
the usage of the
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package
for sampling problems in paid research studies, using datasets provided
by <a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a>. All
results in this section were generated using R version 4.3.2 on a macOS
Sonoma 14.6.1 system.</p>
<h4 class="unnumbered" data-number="3.1" id="sec:example_glm">Applications in paid research study: <span class="math inline">\(\tt trial\_data\)</span> example</h4>
<p>The <code>trial_data</code> dataset is simulated data for a toy example of paid
research studies. This study includes a cohort of <span class="math inline">\(500\)</span> patients for a
clinical trial, with gender and age as stratification factors. A
logistic regression model incorporates these factors as covariates:
<code>gender</code> (coded as <span class="math inline">\(0\)</span> for female and <span class="math inline">\(1\)</span> for male) and <code>age</code> (coded as
two dummy variables <span class="math inline">\(age\_1\)</span> and <span class="math inline">\(age\_2\)</span> with
<span class="math inline">\((age\_1, age\_2) = (0, 0)\)</span> for age group <span class="math inline">\(18\sim25\)</span>; <span class="math inline">\((1, 0)\)</span> for age
group <span class="math inline">\(26\sim64\)</span>, and <span class="math inline">\((0, 1)\)</span> for age group <span class="math inline">\(65\)</span> and above). For
simplicity, the study assumes binary gender options and a tripartite age
categorization. In total, there are <span class="math inline">\(m=6\)</span> combinations of covariate
factors. In practice, non-binary gender options and a “prefer not to
answer” choice may be included to respect gender diversity and protect
patient confidentiality. The response <span class="math inline">\(Y\)</span> denotes the treatment’s
efficacy (<span class="math inline">\(0\)</span> indicating ineffectiveness, <span class="math inline">\(1\)</span> indicating effectiveness).
The data is generated by the logistic regression model
<span class="math display" id="eq:triallogisticmodel">\[\label{eq:triallogisticmodel}
{\rm logit} \{P(Y_{ij}=1 \mid x_{gender\_i}, x_{age\_1i}, x_{age\_2i})\} = \beta_0 + \beta_1 x_{gender\_i} + \beta_{21} x_{age\_1i} + \beta_{22} x_{age\_2i}   \tag{3}\]</span>
with <span class="math inline">\((\beta_0, \beta_1, \beta_{21}, \beta_{22}) = (0,3,3,3)\)</span>, where
<span class="math inline">\(i=1, \ldots, 6\)</span> stands for the <span class="math inline">\(i\)</span>th covariate combination, and
<span class="math inline">\(j = 1, \ldots, N_i\)</span> is an index of patients who fall into the <span class="math inline">\(i\)</span>th
covariate combination or sampling subgroups.
Figure <a href="#fig:trial_data" data-reference-type="ref" data-reference="fig:trial_data">4</a> illustrates the distribution of treatment
efficacy across different <code>gender</code> and <code>age</code> groups.</p>
<figure id="fig:trial_data">
<img src="figures/trial_data.png" style="width:60.0%" alt="graphic without alt text" />
<figcaption>Figure 4: The number of patients from different gender (F, M) and age
groups (<span class="math inline">\(18-25\)</span>, <span class="math inline">\(26-64\)</span>, and <span class="math inline">\(\ge 65\)</span>) and their responses (<span class="math inline">\(0\)</span>
indicating ineffectiveness, <span class="math inline">\(1\)</span> indicating effectiveness) to treatment
in <code>trial_data</code> of
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a>
package.</figcaption>
</figure>
<p>In this example, it is posited that a sample of <span class="math inline">\(n=200\)</span> participants is
desired from the population of <span class="math inline">\(N=500\)</span> volunteers due to budget
constraints. The objective is to examine the variation in efficacy rates
across gender and age demographics. Should a pilot study or relevant
literature provide approximate values for the model parameters, a
constrained lift-one algorithm may be employed to find a locally
D-optimal design. Conversely, if only partial parameter information is
available, the expectation can be deduced from some prior distributions,
and the constrained lift-one algorithm can be utilized to determine an
EW D-optimal allocation (substituting <span class="math inline">\(\mathbf W\)</span> in the Fisher
information matrix <a href="#eq:FisherGLM">(1)</a> with <span class="math inline">\(E(\mathbf W)\)</span>).</p>
<p>There are <span class="math inline">\(m=6\)</span> design points, corresponding to gender and age group
combinations <span class="math inline">\((x_{gender\_i},\)</span> <span class="math inline">\(x_{age\_1i}, x_{age\_2i}) = (0,0,0)\)</span>,
<span class="math inline">\((0,1,0)\)</span>, <span class="math inline">\((0,0,1)\)</span>, <span class="math inline">\((1,0,0)\)</span>, <span class="math inline">\((1,1,0)\)</span>, and <span class="math inline">\((1,0,1)\)</span>, respectively.
The numbers of available volunteers in the six categories are
<span class="math inline">\((N_1, N_2, \ldots, N_6) = (50, 40, 10,\)</span> <span class="math inline">\(200, 150, 50)\)</span>. Our goal is to
find the constrained D-optimal allocation <span class="math inline">\((w_1, w_2, \dots, w_6)\)</span> in
the set of all feasible allocations <span class="math inline">\(S = \{(w_1, \ldots,\)</span>
<span class="math inline">\(w_m)^T \in S_0 \mid n w_i \leq N_i, i=1, \ldots, m\}\)</span>.</p>
<p>We consider the logistic regression model <a href="#eq:triallogisticmodel">(3)</a>, to find the locally D-optimal
design, we assume, for illustrative purposes, that the model parameters
<span class="math inline">\((\beta_0, \beta_{1}, \beta_{21}, \beta_{22})\)</span> <span class="math inline">\(=(0,3,3,3)\)</span>. We may
define the parameters and the model matrix as follows. Subsequently, we
find the <span class="math inline">\(\mathbf W\)</span> matrix in Equation <a href="#eq:FisherGLM">(1)</a> for the Fisher information matrix
<span class="math inline">\(\mathbf F\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> beta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>) <span class="co">#coefficients</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#design matrix</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> X<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> W<span class="ot">=</span><span class="fu">W_func_GLM</span>(<span class="at">X=</span>X, <span class="at">b=</span>beta, <span class="at">link=</span><span class="st">&quot;logit&quot;</span>) <span class="co">#find W as input of constrained liftone</span></span></code></pre></div>
<p>To define the number of design points, sample size, and constraints with
<span class="math inline">\(S\)</span>, we use the following R codes (see Section S3 in the Supplementary
Material of (Huang, Tong, and Yang 2025) for details on finding <span class="math inline">\(r_{i1}\)</span>
and <span class="math inline">\(r_{i2}\)</span> in step 3 of the constrained liftone algorithm in
Figure <a href="#fig:constrained_liftone_algo" data-reference-type="ref" data-reference="fig:constrained_liftone_algo">2</a>):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rc <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">50</span>)<span class="sc">/</span><span class="dv">200</span> <span class="co">#available volunteers/sample size</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> m <span class="ot">=</span> <span class="dv">6</span> <span class="co">#design points</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.con <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>(<span class="dv">2</span><span class="sc">*</span>m<span class="sc">+</span><span class="dv">1</span>), <span class="at">ncol=</span>m) <span class="co">#constraints</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.con[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, m)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.con[<span class="dv">2</span><span class="sc">:</span>(m<span class="sc">+</span><span class="dv">1</span>),] <span class="ot">=</span> <span class="fu">diag</span>(m)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.con[(m<span class="sc">+</span><span class="dv">2</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>m<span class="sc">+</span><span class="dv">1</span>), ] <span class="ot">=</span> <span class="fu">diag</span>(m)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.dir <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;==&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&lt;=&quot;</span>, m), <span class="fu">rep</span>(<span class="st">&quot;&gt;=&quot;</span>, m)) <span class="co">#direction</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.rhs <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, rc, <span class="fu">rep</span>(<span class="dv">0</span>, m)) <span class="co">#righ-hand side</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#lower bound in step 3 of constrained liftone</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> lower.bound<span class="ot">=</span><span class="cf">function</span>(i, w){</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   rc <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">50</span>)<span class="sc">/</span><span class="dv">200</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   m<span class="ot">=</span><span class="fu">length</span>(w)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   temp <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   temp[w<span class="sc">&gt;</span><span class="dv">0</span>]<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pmin</span>(<span class="dv">1</span>,rc[w<span class="sc">&gt;</span><span class="dv">0</span>])<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w[i])<span class="sc">/</span>w[w<span class="sc">&gt;</span><span class="dv">0</span>];</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   temp[i]<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">max</span>(<span class="dv">0</span>,temp);</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   }</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#upper bound in step 3 of constrained liftone</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> upper.bound<span class="ot">=</span><span class="cf">function</span>(i, w){</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   rc <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">50</span>)<span class="sc">/</span><span class="dv">200</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">min</span>(<span class="dv">1</span>,rc[i]);</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   }</span></code></pre></div>
<p>To identify the subgroups of the output D-optimal allocations, we may
add an optional label for each of the <span class="math inline">\(m=6\)</span> covariatres combination or
subgroups as “F, 18-25”, “F, 26-64”, “F, &gt;=65”, “M, 18-2”, “M, 26-6”,
“M, &gt;=65” using the following codes:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> label <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;F, 18-25&quot;</span>, <span class="st">&quot;F, 26-64&quot;</span>, <span class="st">&quot;F, &gt;=65&quot;</span>, <span class="st">&quot;M, 18-25&quot;</span>, <span class="st">&quot;M, 26-64&quot;</span>, <span class="st">&quot;M, &gt;=65&quot;</span>)</span></code></pre></div>
<p>Then, we run the constrained lift-one algorithm with to find the
constrained D-optimal approximate allocation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">092</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> approximate_design <span class="ot">=</span> <span class="fu">liftone_constrained_GLM</span>(<span class="at">X=</span>X, <span class="at">W=</span>W, <span class="at">g.con=</span>g.con, <span class="at">g.dir=</span>g.dir,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">g.rhs=</span>g.rhs, <span class="at">lower.bound=</span>lower.bound, <span class="at">upper.bound=</span>upper.bound, <span class="at">reltol=</span><span class="fl">1e-10</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">maxit=</span><span class="dv">100</span>, <span class="at">random=</span><span class="cn">TRUE</span>, <span class="at">nram=</span><span class="dv">4</span>, <span class="at">w00=</span><span class="cn">NULL</span>, <span class="at">epsilon=</span><span class="fl">1e-8</span>, <span class="at">label=</span>label)</span></code></pre></div>
<p>The design output is presented below:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(approximate_design)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Optimal Sampling Results<span class="sc">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="er">================================================================================</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Optimal approximate allocation<span class="sc">:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   F, <span class="dv">18-25</span> F, <span class="dv">26-64</span> F, <span class="sc">&gt;=</span><span class="dv">65</span> M, <span class="dv">18-25</span> M, <span class="dv">26-64</span> M, <span class="sc">&gt;=</span><span class="dv">65</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>w  <span class="fl">0.25</span>     <span class="fl">0.2</span>      <span class="fl">0.05</span>    <span class="fl">0.5</span>      <span class="fl">0.0</span>      <span class="fl">0.0</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>w0 <span class="fl">0.25</span>     <span class="fl">0.0</span>      <span class="fl">0.05</span>    <span class="fl">0.7</span>      <span class="fl">0.0</span>      <span class="fl">0.0</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>maximum <span class="sc">:</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fl">2.8813e-08</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>convergence <span class="sc">:</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>itmax <span class="sc">:</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fl">9.0</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>deriv.ans <span class="sc">:</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span>, <span class="fl">3.6017e-08</span>, <span class="fl">4.8528e-07</span>, <span class="sc">-</span><span class="fl">1.1525e-07</span>, <span class="sc">-</span><span class="fl">1.0310e-07</span>, <span class="sc">-</span><span class="fl">7.9507e-08</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>gmax <span class="sc">:</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>reason <span class="sc">:</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;gmax &lt;= 0&quot;</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span></code></pre></div>
<p>The output includes several key components:</p>
<ul>
<li><p><span class="math inline">\(\mathbf w\)</span>: reports the D-optimal approximate allocation.</p></li>
<li><p><span class="math inline">\(\mathbf w_0\)</span>: reports the random initial approximate allocation used
to initialize optimization.</p></li>
<li><p><strong>maximum</strong>: reports the maximum determinant of Fisher information
matrix.</p></li>
<li><p><strong>reason</strong>: reports the termination criterion for the constrained
lift-one algorithm including either “all derivative <span class="math inline">\(\le\)</span> 0” or “gmax
<span class="math inline">\(\le\)</span> 0”, which corresponds to step <span class="math inline">\(7^\circ\)</span> and step <span class="math inline">\(8^\circ\)</span> in
the constrained lift-one algorithm in
Figure <a href="#fig:constrained_liftone_algo" data-reference-type="ref" data-reference="fig:constrained_liftone_algo">2</a>.</p></li>
</ul>
<p>In practical terms, exact allocations are more beneficial. One may use
the constrained approximate to exact allocation algorithm depicted in
Figure <a href="#fig:approx_to_exact_algo" data-reference-type="ref" data-reference="fig:approx_to_exact_algo">3</a>, which is implemented as the
function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> exact_design <span class="ot">=</span> <span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">w=</span>approximate_design<span class="sc">$</span>w, <span class="at">m=</span><span class="dv">6</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">beta=</span>beta, <span class="at">link=</span><span class="st">&#39;logit&#39;</span>, <span class="at">X=</span>X, <span class="at">Fdet_func=</span>Fdet_func_GLM, <span class="at">iset_func=</span>iset_func_trial,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">label=</span>label)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(exact_design)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Optimal Sampling Results<span class="sc">:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="er">================================================================================</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>Optimal exact allocation<span class="sc">:</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                F, <span class="dv">18-25</span> F, <span class="dv">26-64</span> F, <span class="sc">&gt;=</span><span class="dv">65</span> M, <span class="dv">18-25</span> M, <span class="dv">26-64</span> M, <span class="sc">&gt;=</span><span class="dv">65</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>allocation      <span class="fl">50.0</span>     <span class="fl">40.0</span>     <span class="fl">10.0</span>    <span class="fl">100.0</span>    <span class="fl">0.0</span>      <span class="fl">0.0</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>allocation.real <span class="fl">0.25</span>     <span class="fl">0.2</span>      <span class="fl">0.05</span>    <span class="fl">0.5</span>      <span class="fl">0.0</span>      <span class="fl">0.0</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>det.maximum <span class="sc">:</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fl">46.1012</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span></code></pre></div>
<p>The output provides three key components for the sampling results:</p>
<ul>
<li><p><strong>allocation</strong>: reports the exact allocation of D-optimal sampling,
specifying the number of subjects to sample from each subgroup.</p></li>
<li><p><strong>allocation.real</strong>: reports the real-number approximate allocation
used prior to integer conversion.</p></li>
<li><p><strong>det.maximum</strong>: reports the maximum determinant of the Fisher
information matrix by the optimal design.</p></li>
</ul>
<p>In this example, the D-optimal exact allocation is to sample <span class="math inline">\(50\)</span>
subjects from the “female, <span class="math inline">\(18-25\)</span>” subgroup, <span class="math inline">\(40\)</span> subjects from the
“female, <span class="math inline">\(26-64\)</span>” subgroup, <span class="math inline">\(10\)</span> subjects from the “female, <span class="math inline">\(\ge 65\)</span>”
subgroup, and <span class="math inline">\(100\)</span> subjects from the “male, <span class="math inline">\(18-25\)</span>” subgroup. Such a
design may not explore all the design space and may lead to extreme
design cases. In practice, allocating some subjects to the omitted
subgroups “male, <span class="math inline">\(26-64\)</span>” and “male, <span class="math inline">\(\ge 65\)</span>” could improve robustness
and reduce the risk of overfitting.</p>
<p>Alternatively, one may aim for EW D-optimal allocations when partial
coefficient information is available with the <span class="math inline">\({\mathbf W}\)</span> matrix
substituted by the expectation (EW stands for the expected weight). To calculate these expectations, one may define
prior distributions for the parameters based on available information.
For instance, in this scenario, we assume the following independent
prior distributions: <span class="math inline">\(\beta_0\sim\)</span> uniform<span class="math inline">\((-2,2)\)</span>, <span class="math inline">\(\beta_1\sim\)</span>
uniform<span class="math inline">\((-1,5)\)</span>, <span class="math inline">\(\beta_{21}\sim\)</span> uniform<span class="math inline">\((-1,5)\)</span>, and <span class="math inline">\(\beta_{22}\sim\)</span>
uniform(-1,5). Subsequently, the diagonal elements of <span class="math inline">\({\mathbf W}\)</span> are
determined through integration. For <span class="math inline">\(i=1,\dots,m\)</span> and
<span class="math inline">\(\eta_i = \beta_0 + x_{gender\_i}\beta_1+ x_{age\_i1}\beta_{21}+ x_{age\_i2}\beta_{22}\)</span>,
we calculate the key component <span class="math inline">\(E(\nu_i)\)</span> of the <span class="math inline">\(i\)</span>th diagonal element
of <span class="math inline">\({\mathbf W}\)</span> through:
<span class="math display">\[\int_{-1}^{5} \int_{-1}^{5} \int_{-1}^{5} \int_{-2}^{2} \frac{\exp(\eta_i)}{(1+\exp(\eta_i))^2} {\rm Pr}(\beta_0){\rm Pr}(\beta_{1}){\rm Pr}(\beta_{21}){\rm Pr}(\beta_{22}) \, d\beta_0 d\beta_1 d\beta_{21} d\beta_{22}\]</span>
where <span class="math inline">\(\rm{Pr}(\cdot)\)</span> stands for the corresponding probability density
function. We use the <code>hcubature()</code> function in the
<a href="https://CRAN.R-project.org/package=cubature"><strong>cubature</strong></a> package to
calculate the integration as illustrated by the R codes below.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> unif.prior <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>,  <span class="dv">5</span>,  <span class="dv">5</span>, <span class="dv">5</span>)) <span class="co">#prior parameters</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#find expectation of W matrix given priors</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> W.EW.unif <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>  x <span class="ot">=</span> X[i,]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>  W.EW.unif[i] <span class="ot">=</span> <span class="fu">hcubature</span>(<span class="cf">function</span>(beta) <span class="fu">dunif</span>(beta[<span class="dv">1</span>], <span class="at">min=</span>unif.prior[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">max=</span>unif.prior[<span class="dv">2</span>,<span class="dv">1</span>])<span class="sc">*</span><span class="fu">dunif</span>(beta[<span class="dv">2</span>], <span class="at">min=</span>unif.prior[<span class="dv">1</span>,<span class="dv">2</span>], <span class="at">max=</span>unif.prior[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">*</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(beta[<span class="dv">3</span>], <span class="at">min=</span>unif.prior[<span class="dv">1</span>,<span class="dv">3</span>], <span class="at">max=</span>unif.prior[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">*</span><span class="fu">dunif</span>(beta[<span class="dv">4</span>],</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">min=</span>unif.prior[<span class="dv">1</span>,<span class="dv">4</span>], <span class="at">max=</span>unif.prior[<span class="dv">2</span>,<span class="dv">4</span>])<span class="sc">*</span>(<span class="fu">exp</span>(x[<span class="dv">1</span>]<span class="sc">*</span>beta[<span class="dv">1</span>]<span class="sc">+</span>x[<span class="dv">2</span>]<span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">+</span>x[<span class="dv">3</span>]<span class="sc">*</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>beta[<span class="dv">3</span>]<span class="sc">+</span>x[<span class="dv">4</span>]<span class="sc">*</span>beta[<span class="dv">4</span>])<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(x[<span class="dv">1</span>]<span class="sc">*</span>beta[<span class="dv">1</span>]<span class="sc">+</span>x[<span class="dv">2</span>]<span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">+</span>x[<span class="dv">3</span>]<span class="sc">*</span>beta[<span class="dv">3</span>]<span class="sc">+</span>x[<span class="dv">4</span>]<span class="sc">*</span>beta[<span class="dv">4</span>]))<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">lowerLimit =</span> unif.prior[<span class="dv">1</span>,], <span class="at">upperLimit  =</span> unif.prior[<span class="dv">2</span>,])<span class="sc">$</span>integral</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>  }</span></code></pre></div>
<p>Given the expectation of <span class="math inline">\({\mathbf W}\)</span>, the functions
<code>liftone_constrained_GLM()</code> and are used for deriving the constrained EW
D-optimal approximate allocation and the corresponding exact allocation,
respectively. This process follows a similar procedure to that used for
local D-optimal approximate allocation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> approximate_design_EW <span class="ot">=</span> <span class="fu">liftone_constrained_GLM</span>(<span class="at">X=</span>X, <span class="at">W=</span>W.EW.unif,  <span class="at">g.con=</span>g.con,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">g.dir=</span>g.dir, <span class="at">g.rhs=</span>g.rhs, <span class="at">lower.bound=</span>lower.bound, <span class="at">upper.bound=</span>upper.bound,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">reltol=</span><span class="fl">1e-12</span>, <span class="at">maxit=</span><span class="dv">100</span>, <span class="at">random=</span><span class="cn">TRUE</span>, <span class="at">nram=</span><span class="dv">4</span>, <span class="at">w00=</span><span class="cn">NULL</span>, <span class="at">epsilon=</span><span class="fl">1e-10</span>, <span class="at">label=</span>label)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> exact_design <span class="ot">=</span> <span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">200</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">w=</span>approximate_design_EW<span class="sc">$</span>w, <span class="at">m=</span><span class="dv">6</span>, <span class="at">beta=</span>beta, <span class="at">link=</span><span class="st">&#39;logit&#39;</span>, <span class="at">X=</span>X, <span class="at">Fdet_func=</span>Fdet_func_GLM,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">iset_func=</span>iset_func_trial, <span class="at">label=</span>label)</span></code></pre></div>
<p>The output is summarized with <code>print()</code> function and presented below:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(exact_design_EW)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Optimal Sampling Results<span class="sc">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="er">================================================================================</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Optimal exact allocation<span class="sc">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                F, <span class="dv">18-25</span> F, <span class="dv">26-64</span> F, <span class="sc">&gt;=</span><span class="dv">65</span> M, <span class="dv">18-25</span> M, <span class="dv">26-64</span> M, <span class="sc">&gt;=</span><span class="dv">65</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>allocation      <span class="fl">48.0</span>     <span class="fl">40.0</span>     <span class="fl">10.0</span>    <span class="fl">43.0</span>     <span class="fl">19.0</span>     <span class="fl">40.0</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>allocation.real <span class="fl">0.2406</span>   <span class="fl">0.2</span>      <span class="fl">0.05</span>    <span class="fl">0.2102</span>   <span class="fl">0.0991</span>   <span class="fl">0.2001</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>det.maximum <span class="sc">:</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fl">25.59</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span></code></pre></div>
<p>In situations when the model parameters are unknown, the constrained
uniform allocation is applicable. This method entails sampling an equal
number of patients from each category within the given constraints. The
selection criterion is <span class="math inline">\(n_i = \min\{k, N_i\}\)</span> or <span class="math inline">\(\min\{k, N_i\}+1\)</span> with
<span class="math inline">\(k\)</span> satisfying
<span class="math inline">\(\sum_{i=1}^m \min\{k, N_i\} \leq n &lt; \sum_{i=1}^m \min\{k+1, N_i\}\)</span>,
where <span class="math inline">\(N_i\)</span> represents the maximum allowable number for each category.
This is an example of a bounded design problem, where each category has
an upper boundary. The function <code>bounded_uniform()</code> can be used to find
the constrained uniform allocation with the <code>trial_data</code> example and
“<strong>allocation</strong>” in the output representing the constrained uniform
allocation.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">bounded_uniform</span>(<span class="at">Ni=</span><span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">50</span>), <span class="at">nsample=</span><span class="dv">200</span>, <span class="at">label=</span>label)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Optimal Sampling Results<span class="sc">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="er">================================================================================</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>Optimal exact allocation<span class="sc">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>           F, <span class="dv">18-25</span> F, <span class="dv">26-64</span> F, <span class="sc">&gt;=</span><span class="dv">65</span> M, <span class="dv">18-25</span> M, <span class="dv">26-64</span> M, <span class="sc">&gt;=</span><span class="dv">65</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>allocation <span class="fl">38.0</span>     <span class="fl">38.0</span>     <span class="fl">10.0</span>    <span class="fl">38.0</span>     <span class="fl">38.0</span>     <span class="fl">38.0</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span></code></pre></div>
<p>Alternatively, we may also use <code>approxtoexact_constrained_func()</code> to
find the same constrained uniform exact allocation. This function can be
used under fairly general constraints. To find the constrained uniform
exact allocation using , we suggest starting with one subject in each
stratum or subgroup, which corresponds to the approximate allocation
<span class="math inline">\(\mathbf{w_{00}}=(1/200,1/200,1/200,1/200,1/200,1/200)\)</span> in this case.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> w00 <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="dv">6</span>) <span class="co">#initial approximate allocation</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> unif_design <span class="ot">=</span> <span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">w=</span>w00, <span class="at">m=</span><span class="dv">6</span>, <span class="at">beta=</span><span class="cn">NULL</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">link=</span><span class="cn">NULL</span>, <span class="at">X=</span><span class="cn">NULL</span>, <span class="at">Fdet_func=</span>Fdet_func_unif, <span class="at">iset_func=</span>iset_func_trial, <span class="at">label=</span>label)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(unif_design)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>Optimal Sampling Results<span class="sc">:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="er">================================================================================</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>Optimal exact allocation<span class="sc">:</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                F, <span class="dv">18-25</span> F, <span class="dv">26-64</span> F, <span class="sc">&gt;=</span><span class="dv">65</span> M, <span class="dv">18-25</span> M, <span class="dv">26-64</span> M, <span class="sc">&gt;=</span><span class="dv">65</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>allocation      <span class="fl">38.0</span>     <span class="fl">38.0</span>     <span class="fl">10.0</span>    <span class="fl">38.0</span>     <span class="fl">38.0</span>     <span class="fl">38.0</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>allocation.real <span class="fl">0.005</span>    <span class="fl">0.005</span>    <span class="fl">0.005</span>   <span class="fl">0.005</span>    <span class="fl">0.005</span>    <span class="fl">0.005</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>det.maximum <span class="sc">:</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fl">792351680.0</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span></code></pre></div>
<p>The <code>iset_func_trial()</code> function in the
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package
is specifically designed for the <code>trial_data</code> example, which defines the
set <span class="math inline">\(I\)</span> in step <span class="math inline">\(1^\circ\)</span> and step <span class="math inline">\(2.4\)</span> in the constrained approximate
to exact algorithm depicted by
Figure <a href="#fig:approx_to_exact_algo" data-reference-type="ref" data-reference="fig:approx_to_exact_algo">3</a>. This function serves as a
template that users can adapt to their specific constraints by modifying
the codes. The package includes two such template functions: and with
details provided in Section S4 of Supplementary Material.</p>
<p>To perform a comparison analysis on different sampling strategies,
including the constrained D-optimal allocation, the constrained EW
D-optimal allocation with uniform priors, the constrained uniform
allocation, simple random sample without replacement (SRSWOR), as well
as the full data (all the <span class="math inline">\(500\)</span> patients enrolled), we simulate their
responses <span class="math inline">\(Y_{ij}\)</span>’s based on
model <a href="#eq:triallogisticmodel">(3)</a> with parameter values <span class="math inline">\((0,3,3,3)\)</span>.
We apply each sampling strategy to obtain a sample of <span class="math inline">\(n=200\)</span>
observations out of <span class="math inline">\(500\)</span>, and estimate the parameters using the <span class="math inline">\(200\)</span>
observations. The exception is the full data method, where estimation is
performed using all <span class="math inline">\(500\)</span> patients. We use the root mean square error
(RMSE) to measure the accuracy of the estimates (see Section 4 of
(Huang, Tong, and Yang 2025) for more theoretical and technical
details). We repeat the procedure <span class="math inline">\(100\)</span> times and display the
corresponding RMSEs in Figure <a href="#fig:RMSE_GLM" data-reference-type="ref" data-reference="fig:RMSE_GLM">5</a> and simulation codes in Supplementary Material
Section S3 (Wickham 2016; Wickham et al. 2023). Obviously, if we use the
full data (all <span class="math inline">\(500\)</span> patients) to fit the model, its RMSE attains the
lowest. Besides that, the constrained locally D-optimal allocation and
the constrained EW D-optimal allocation have a little higher RMSEs than
the full data estimates but outperform SRSWOR and the constrained
uniform allocation. The sampling strategy based on the constrained
uniform allocation doesn’t need any model information and is a more
robust sampling scheme, which is still better than SRSWOR.</p>
<figure id="fig:RMSE_GLM">
<img src="figures/RMSE_paid.png" style="width:95.0%" alt="graphic without alt text" />
<figcaption>Figure 5: Boxplots of RMSEs obtained from <span class="math inline">\(100\)</span> simulations using full
data (full), SRSWOR, constrained uniform design (Unif), the constrained
locally D-optimal allocation (local_Dopt), and constrained EW D-optimal
allocation with uniform priors (EW_Unif), with black diamonds
representing average RMSE.</figcaption>
</figure>
<h4 class="unnumbered" data-number="3.2" id="sec:MLM_example">Applications in paid research study: <span class="math inline">\(\tt trauma\_data\)</span> example</h4>
<p>In the <a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a>
package, <code>trauma_data</code> is a dataset of <span class="math inline">\(N=802\)</span> trauma patients from
(Chuang-Stein and Agresti 1997), stratified according to the trauma
severity at the entry time of the study with <span class="math inline">\(392\)</span> mild and <span class="math inline">\(410\)</span>
moderate/severe patients enrolled. The study involved four treatment
groups determined by the <code>dose</code> level, <span class="math inline">\(x_{i1} = 1\)</span> (<code>Placebo</code>), <span class="math inline">\(2\)</span>
(<code>Low dose</code>), <span class="math inline">\(3\)</span> (<code>Medium dose</code>), and <span class="math inline">\(4\)</span> (<code>High dose</code>). Combining with
<code>severity</code> grade (<span class="math inline">\(x_{i2} = 0\)</span> for <code>mild</code> or <span class="math inline">\(1\)</span> for
<code>moderate</code>/<code>severe</code>), there are <span class="math inline">\(m=8\)</span> distinct experimental settings
with
<span class="math inline">\((x_{i1}, x_{i2}) = (1,0), (2,0), (3,0), (4,0), (1,1), (2,1), (3,1), (4,1)\)</span>,
respectively. The responses belong to five ordered categories, <code>Death</code>
(<span class="math inline">\(1\)</span>), <code>Vegetative state</code> (<span class="math inline">\(2\)</span>), <code>Major disability</code> (<span class="math inline">\(3\)</span>),
<code>Minor disability</code> (<span class="math inline">\(4\)</span>) and <code>Good</code> <code>recovery</code> (<span class="math inline">\(5\)</span>), known as the
Glasgow Outcome Scale (Jennett and Bond 1975).
Figure <a href="#fig:trauma_data" data-reference-type="ref" data-reference="fig:trauma_data">6</a> shows the distribution of outcomes over
<code>severity</code> grades and <code>dose</code> levels.</p>
<figure id="fig:trauma_data">
<img src="figures/trauma_data.png" style="width:95.0%" alt="graphic without alt text" />
<figcaption>Figure 6: The number of patients from different <code>dose</code> levels
(Placebo, Low, Medium, and High) and <code>severity</code> grades (Mild,
Moderate/Severe) groups and their treatment outcomes in <code>trauma_data</code> of
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a>
package.</figcaption>
</figure>
<p>In this example, we have <span class="math inline">\(m=8\)</span> subgroups, which are combinations of the
two covariates categories: <code>dose</code> levels and <code>severity</code> grades. We aim
to enroll <span class="math inline">\(n=600\)</span> patients from the <span class="math inline">\(802\)</span> available patients. The
collection of feasible allocations is inherently constrained by the
number of patients in different severity grades, defined as
<span class="math display">\[S=\{(w_1, \ldots, w_8)^\top \in S_0 \mid n(w_1+w_2+w_3+w_4) \leq 392, ~~ n(w_5+w_6+w_7+w_8) \leq 410\}.\]</span>
The constraints specify that in the sample, the number of patients with
mild symptoms must not exceed <span class="math inline">\(392\)</span> across all dose levels, while those
with moderate/severe symptoms must not exceed <span class="math inline">\(410\)</span>.</p>
<p>The parameters fitted from the <code>trauma_data</code> are
<span class="math display">\[\begin{align*}
\boldsymbol\beta &amp;= (\hat\beta_{11}, \hat\beta_{12}, \hat\beta_{13}, \hat\beta_{21}, \hat\beta_{22}, \hat\beta_{23}, \hat\beta_{31}, \hat\beta_{32}, \hat\beta_{33}, \hat\beta_{41}, \hat\beta_{42}, \hat\beta_{43})^\top \\
&amp;= (-4.047, -0.131, 4.214, -2.225, -0.376, 3.519, -0.302, -0.237,  2.420, 1.386,  -0.120,  1.284)^\top.
\end{align*}\]</span>
The model can be written in the following format:
<span class="math display">\[\begin{align*}
    \log\left(\frac{\pi_{i1}}{\pi_{i2}+\dots+\pi_{i5}}\right) &amp;= \beta_{11}+\beta_{12}x_{i1}+\beta_{13}x_{i2}\\
    \log\left(\frac{\pi_{i1}+\pi_{i2}}{\pi_{i3}+\pi_{i4}+\pi_{i5}}\right) &amp;= \beta_{21}+\beta_{22}x_{i1}+\beta_{23}x_{i2}\\
    \log\left(\frac{\pi_{i1}+\pi_{i2}+\pi_{i3}}{\pi_{i4}+\pi_{i5}}\right) &amp;= \beta_{31}+\beta_{32}x_{i1}+\beta_{33}x_{i2}\\
    \log\left(\frac{\pi_{i1}+\dots+\pi_{i4}}{\pi_{i5}}\right) &amp;=\beta_{41}+\beta_{42}x_{i1}+\beta_{43}x_{i2}
\end{align*}\]</span>
where <span class="math inline">\(i=1,\dots,8\)</span>.</p>
<p>We use the R codes below to define the model matrix and coefficients.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> J<span class="ot">=</span><span class="dv">5</span>; p<span class="ot">=</span><span class="dv">12</span>; m<span class="ot">=</span><span class="dv">8</span>; <span class="co">#response levels; parameters; subgroups</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#coefficients</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> beta <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.047</span>, <span class="sc">-</span><span class="fl">0.131</span>, <span class="fl">4.214</span>, <span class="sc">-</span><span class="fl">2.225</span>, <span class="sc">-</span><span class="fl">0.376</span>, <span class="fl">3.519</span>, <span class="sc">-</span><span class="fl">0.302</span>, <span class="sc">-</span><span class="fl">0.237</span>,  <span class="fl">2.420</span>, <span class="fl">1.386</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="sc">-</span><span class="fl">0.120</span>,  <span class="fl">1.284</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#define design matrix of 8 subgroups</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Xi<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,J<span class="sc">*</span>p<span class="sc">*</span>m); <span class="fu">dim</span>(Xi)<span class="ot">=</span><span class="fu">c</span>(J,p,m);</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">3</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">4</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">5</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">6</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">7</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Xi[,,<span class="dv">8</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>), <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>To define the sample size, the constraints, and the functions of lower
and upper boundaries <span class="math inline">\(r_{i1}\)</span> and <span class="math inline">\(r_{i2}\)</span>, we may use the following R
codes (see Section S3 in the Supplementary Material of (Huang, Tong, and
Yang 2025) for details on finding <span class="math inline">\(r_{i1}\)</span> and <span class="math inline">\(r_{i2}\)</span>):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> nsample<span class="ot">=</span><span class="dv">600</span> <span class="co">#sample size</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> constraint <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">392</span>, <span class="dv">410</span>)  <span class="co">#mild:severe</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#lower bound function in step 3 of constrained liftone</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> lower.bound <span class="ot">&lt;-</span> <span class="cf">function</span>(i, w0){</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   n <span class="ot">=</span> <span class="dv">600</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   constraint <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">392</span>,<span class="dv">410</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="cf">if</span>(i <span class="sc">&lt;=</span> <span class="dv">4</span>){</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     a.lower <span class="ot">&lt;-</span> (<span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>])<span class="sc">-</span>(constraint[<span class="dv">2</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>]))}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="cf">else</span>{</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     a.lower <span class="ot">&lt;-</span> (<span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])<span class="sc">-</span>(constraint[<span class="dv">1</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]))}</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    a.lower}</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#upper bound function in step 3 of constrained liftone</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> upper.bound <span class="ot">&lt;-</span> <span class="cf">function</span>(i, w0){</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>  n <span class="ot">=</span> <span class="dv">600</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>  constraint <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">392</span>,<span class="dv">410</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>  <span class="cf">if</span>(i <span class="sc">&lt;=</span> <span class="dv">4</span>){</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    b.upper <span class="ot">&lt;-</span> ((constraint[<span class="dv">1</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]) <span class="sc">-</span> (<span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])<span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]))}</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>  <span class="cf">else</span>{</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    b.upper <span class="ot">&lt;-</span> ((constraint[<span class="dv">2</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]) <span class="sc">-</span> (<span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>])<span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>]))}</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>    b.upper}</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co">#define constraints</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> g.con <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">length</span>(constraint)<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>m, <span class="at">ncol=</span>m)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.con[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,] <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ncol =</span> m, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.con[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, m)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.con[<span class="dv">4</span><span class="sc">:</span>(<span class="fu">length</span>(constraint)<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>m), ] <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="at">nrow=</span>m)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.dir <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;==&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>,<span class="st">&quot;&lt;=&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&gt;=&quot;</span>,m))</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> g.rhs <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">ifelse</span>((constraint<span class="sc">/</span>nsample<span class="sc">&lt;</span><span class="dv">1</span>),constraint<span class="sc">/</span>nsample,<span class="dv">1</span>), <span class="fu">rep</span>(<span class="dv">0</span>, m))</span></code></pre></div>
<p>Then, we may define an optional label of the sampling subgroups that
corresponds to each of the <span class="math inline">\(m=8\)</span> subgroups using the following code:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> label<span class="ot">=</span>label <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Placebo-Mild&quot;</span>, <span class="st">&quot;Low-Mild&quot;</span>, <span class="st">&quot;Medium-Mild&quot;</span>, <span class="st">&quot;High-Mild&quot;</span>, <span class="st">&quot;Placebo-Severe&quot;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="st">&quot;Low-Severe&quot;</span>, <span class="st">&quot;Medium-Severe&quot;</span>, <span class="st">&quot;High-Severe&quot;</span>)</span></code></pre></div>
<p>We then run the constrained lift-one algorithm to find the constrained
D-optimal approximate allocation using <code>liftone_constrained_MLM()</code>
function and convert the approximate allocation to an exact allocation
with <code>approxtoexact_constrained_func</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> approx_design <span class="ot">=</span> <span class="fu">liftone_constrained_MLM</span>(<span class="at">m=</span>m, <span class="at">p=</span>p, <span class="at">Xi=</span>Xi, <span class="at">J=</span>J, <span class="at">beta=</span>beta,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">lower.bound=</span>lower.bound, <span class="at">upper.bound=</span>upper.bound, <span class="at">g.con=</span>g.con, <span class="at">g.dir=</span>g.dir,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">g.rhs=</span>g.rhs, <span class="at">w00=</span><span class="cn">NULL</span>, <span class="at">link=</span><span class="st">&#39;cumulative&#39;</span>,  <span class="at">Fi.func=</span>Fi_func_MLM, <span class="at">reltol=</span><span class="fl">1e-5</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">maxit=</span><span class="dv">500</span>, <span class="at">delta=</span><span class="fl">1e-6</span>, <span class="at">epsilon=</span><span class="fl">1e-8</span>, <span class="at">random=</span><span class="cn">TRUE</span>, <span class="at">nram=</span><span class="dv">3</span>, <span class="at">label=</span>label)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> exact_design <span class="ot">=</span> <span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">600</span>, <span class="at">w=</span>approx_design<span class="sc">$</span>w, <span class="at">m=</span><span class="dv">8</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">beta=</span>beta, <span class="at">link=</span><span class="st">&#39;cumulative&#39;</span>, <span class="at">X=</span>Xi, <span class="at">Fdet_func=</span>Fdet_func_MLM,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">iset_func=</span>iset_func_trauma, <span class="at">label=</span>label)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(exact_design)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>Optimal Sampling Results<span class="sc">:</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="er">================================================================================</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>Optimal exact allocation<span class="sc">:</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>             Placebo<span class="sc">-</span>Mild Low<span class="sc">-</span>Mild Medium<span class="sc">-</span>Mild High<span class="sc">-</span>Mild Placebo<span class="sc">-</span>Severe</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>allocation      <span class="fl">155.0</span>        <span class="fl">0.0</span>      <span class="fl">0.0</span>         <span class="fl">100.0</span>     <span class="fl">168.0</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>allocation.real <span class="fl">0.2593</span>       <span class="fl">0.0</span>      <span class="fl">0.0</span>         <span class="fl">0.1667</span>    <span class="fl">0.2796</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>              Low<span class="sc">-</span>Severe Medium<span class="sc">-</span>Severe High<span class="sc">-</span>Severe</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>allocation      <span class="fl">0.0</span>        <span class="fl">0.0</span>           <span class="fl">177.0</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>allocation.real <span class="fl">0.0</span>        <span class="fl">0.0</span>           <span class="fl">0.2944</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>det.maximum <span class="sc">:</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="fl">1.63163827059162e+23</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span></code></pre></div>
<p>The <strong>allocation</strong> output provides the exact allocation of the sampling
across different treatment-severity subgroups, representing the
implementable sample sizes for each subgroup. The result is derived by
converting the <strong>allocation.real</strong>, which is the D-optimal approximate
allocation outcome from <code>liftone_constrained_MLM()</code>.</p>
<p>As the <code>trauma_data</code> example doesn’t have bounded constraints, to find
the constrained uniform sampling allocation, we use
<code>approxtoexact_constrained_func()</code> with one subject in each stratum or
subgroup as the input, that is, the approximate allocation
<span class="math inline">\(\mathbf w = (1/600, 1/600, 1/600, 1/600,\)</span>
<span class="math inline">\(1/600, 1/600, 1/600, 1/600)\)</span>. The corresponding <span class="math inline">\(I\)</span> set function is
provided in the
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a> package,
and it can be easily defined according to other constraints, see
Section S4 of Supplementary Material. Note that the determinant provided
by <code>approxtoexact_constrained_func()</code> for different designs is not
comparable, as the criteria <code>Fdet_func</code> differs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> unif_design <span class="ot">=</span> <span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">600</span>, <span class="at">w=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">600</span>,<span class="dv">8</span>), <span class="at">m=</span><span class="dv">8</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="at">beta=</span><span class="cn">NULL</span>, <span class="at">link=</span><span class="cn">NULL</span>, <span class="at">X=</span><span class="cn">NULL</span>, <span class="at">Fdet_func=</span>Fdet_func_unif, <span class="at">iset_func=</span>iset_func_trauma)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(unif_design)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>Optimal Sampling Results<span class="sc">:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="er">================================================================================</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>Optimal exact allocation<span class="sc">:</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                Placebo<span class="sc">-</span>Mild Low<span class="sc">-</span>Mild Medium<span class="sc">-</span>Mild High<span class="sc">-</span>Mild Placebo<span class="sc">-</span>Severe Low<span class="sc">-</span>Severe</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>allocation      <span class="fl">75.0</span>         <span class="fl">75.0</span>     <span class="fl">75.0</span>        <span class="fl">75.0</span>      <span class="fl">75.0</span>           <span class="fl">75.0</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>allocation.real <span class="fl">0.0017</span>       <span class="fl">0.0017</span>   <span class="fl">0.0017</span>      <span class="fl">0.0017</span>    <span class="fl">0.0017</span>         <span class="fl">0.0017</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                Medium<span class="sc">-</span>Severe High<span class="sc">-</span>Severe</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>allocation      <span class="fl">75.0</span>          <span class="fl">75.0</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>allocation.real <span class="fl">0.0017</span>        <span class="fl">0.0017</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>det.maximum <span class="sc">:</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="dv">1001129150390625</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------------</span></span></code></pre></div>
<h3 data-number="4" id="summary"><span class="header-section-number">4</span> Summary</h3>
<p>The current version of
<a href="https://CRAN.R-project.org/package=CDsampling"><strong>CDsampling</strong></a>
implements D-optimal allocations within both paid research sampling and
general study frameworks with or without constraints. Its primary
objective is to optimize sampling allocations for better model
estimation accuracy in the studies. The package includes <code>F_func_GLM()</code>
and <code>F_func_MLM()</code> for the computation of the Fisher information matrix
of GLMs and MLMs, respectively. It is noteworthy that standard linear
regression models are special GLMs with an identity link function and
Gaussian-distributed responses, which is also supported by our package.
Theoretical results are summarized in
Section <a href="#sec:model_fisher_glm" data-reference-type="ref" data-reference="sec:model_fisher_glm">2.2</a> and
Section <a href="#sec:model_fisher_mlm" data-reference-type="ref" data-reference="sec:model_fisher_mlm">2.3</a> while illustrative examples are
provided in Supplementary Section S1.</p>
<p>To find standard or unconstrained D-optimal allocations, our package
implements the lift-one algorithm through functions <code>liftone_GLM()</code> and
<code>liftone_MLM()</code>. Paid research studies often impose sampling
constraints. To address this, the constrained lift-one algorithm can be
applied using functions <code>liftone_constrained_GLM()</code> and
<code>liftone_constrained_MLM()</code>. An example illustrating the difference
between the lift-one algorithm and the constrained lift-one algorithm is
provided in Supplementary Section S2 while
Section <a href="#sec:example" data-reference-type="ref" data-reference="sec:example">3</a>
presents two application examples from paid research studies.</p>
<p>In the absence of model information, <code>constrained_uniform()</code> function is
available to find a robust constrained uniform allocation with bounded
constraints, while the function can be used to find constrained uniform
allocation with more general constraints. For transitioning from
approximate to exact allocations, the package provides
<code>approxtoexact_constrained_func()</code> for constrained cases and for
unconstrained cases. Detailed applications for both GLMs and MLMs are
provided in Sections <a href="#sec:example_glm" data-reference-type="ref" data-reference="sec:example_glm">3.1</a>
and <a href="#sec:MLM_example" data-reference-type="ref" data-reference="sec:MLM_example">3.2</a>.</p>
<p>Future enhancements of the package may aim to incorporate a broader
spectrum of optimality criteria, such as A-optimality and E-optimality,
as well as some models beyond GLMs and MLMs to expand its applicability.</p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-agresti2013" class="csl-entry" role="listitem">
Agresti, A. 2013. <em>Categorical Data Analysis</em>. 3rd ed. Wiley.
<a href="https://doi.org/10.1007/s00362-015-0733-8" class="uri">https://doi.org/10.1007/s00362-015-0733-8</a>.
</div>
<div id="ref-atkinson2007" class="csl-entry" role="listitem">
Atkinson, A. C., A. N. Donev, and R. D. Tobias. 2007. <em>Optimum
Experimental Designs, with SAS</em>. Oxford University Press.
<a href="https://doi.org/10.1093/oso/9780199296590.001.0001" class="uri">https://doi.org/10.1093/oso/9780199296590.001.0001</a>.
</div>
<div id="ref-barcaroli2014samplingstrata" class="csl-entry" role="listitem">
Barcaroli, Giulio. 2014. “SamplingStrata: An R Package for the
Optimization of Stratified Sampling.” <em>Journal of Statistical Software</em>
61: 1–24. <a href="https://doi.org/10.18637/jss.v061.i04" class="uri">https://doi.org/10.18637/jss.v061.i04</a>.
</div>
<div id="ref-bu2020" class="csl-entry" role="listitem">
Bu, X., D. Majumdar, and J. Yang. 2020. “D-Optimal Designs for
Multinomial Logistic Models.” <em>Annals of Statistics</em> 48 (2): 983–1000.
<a href="https://doi.org/10.1214/19-AOS1834" class="uri">https://doi.org/10.1214/19-AOS1834</a>.
</div>
<div id="ref-chuang1997" class="csl-entry" role="listitem">
Chuang-Stein, C., and A. Agresti. 1997. “Tutorial in Biostatistics-a
Review of Tests for Detecting a Monotone Dose-Response Relationship with
Ordinal Response Data.” <em>Statistics in Medicine</em> 16: 2599–2618.
</div>
<div id="ref-dobson2018" class="csl-entry" role="listitem">
Dobson, A. J., and A. G. Barnett. 2018. <em>An Introduction to Generalized
Linear Models</em>. 4th ed. Chapman &amp; Hall/CRC.
<a href="https://doi.org/10.1201/9781315182780" class="uri">https://doi.org/10.1201/9781315182780</a>.
</div>
<div id="ref-dousti2023categorical" class="csl-entry" role="listitem">
Dousti Mousavi, Niloufar, Hani Aldirawi, and Jie Yang. 2023.
“Categorical Data Analysis for High-Dimensional Sparse Gene Expression
Data.” <em>BioTech</em> 12 (3): 52. <a href="https://doi.org/10.3390/biotech12030052" class="uri">https://doi.org/10.3390/biotech12030052</a>.
</div>
<div id="ref-fedorov1972" class="csl-entry" role="listitem">
Fedorov, V. V. 1972. <em>Theory of Optimal Experiments</em>. Academic Press.
</div>
<div id="ref-fedorov2014" class="csl-entry" role="listitem">
Fedorov, V. V., and S. L. Leonov. 2014. <em>Optimal Design for Nonlinear
Response Models</em>. Chapman &amp; Hall/CRC. <a href="https://doi.org/10.1201/b15054" class="uri">https://doi.org/10.1201/b15054</a>.
</div>
<div id="ref-pmcc1995" class="csl-entry" role="listitem">
Glonek, G. F. V., and P. McCullagh. 1995. “Multivariate Logistic
Models.” <em>Journal of the Royal Statistical Society, Series B</em> 57:
533–46. <a href="https://www.jstor.org/stable/2346155" class="uri">https://www.jstor.org/stable/2346155</a>.
</div>
<div id="ref-gromping2011optimal" class="csl-entry" role="listitem">
Grömping, Ulrike. 2011. “Optimal Experimental Design with R.” <em>Journal
of Statistical Software</em> 43: 1–4.
<a href="https://doi.org/10.18637/jss.v043.b05" class="uri">https://doi.org/10.18637/jss.v043.b05</a>.
</div>
<div id="ref-harman2016package" class="csl-entry" role="listitem">
Harman, Radoslav, Lenka Filova, and Maintainer Lenka Filova. 2016.
“Package ‘OptimalDesign’.”
<a href="https://cran.r-project.org/package=OptimalDesign" class="uri">https://cran.r-project.org/package=OptimalDesign</a>.
</div>
<div id="ref-huang2023constrained" class="csl-entry" role="listitem">
Huang, Yifei, Liping Tong, and Jie Yang. 2025. “Constrained d-Optimal
Design for Paid Research Study.” <em>Statistica Sinica</em>.
<a href="https://doi.org/10.5705/ss.202022.0414" class="uri">https://doi.org/10.5705/ss.202022.0414</a>.
</div>
<div id="ref-jennett1975" class="csl-entry" role="listitem">
Jennett, B., and M. Bond. 1975. “Assessment of Outcome After Severe
Brain Damage.” <em>Lancet</em> 305: 480–84.
<a href="https://doi.org/10.1016/S0140-6736(75)92830-5" class="uri">https://doi.org/10.1016/S0140-6736(75)92830-5</a>.
</div>
<div id="ref-khuri2006" class="csl-entry" role="listitem">
Khuri, A. I., B. Mukherjee, B. K. Sinha, and M. Ghosh. 2006. “Design
Issues for Generalized Linear Models: A Review.” <em>Statistical Science</em>
21: 376–99. <a href="https://doi.org/10.1214/088342306000000105" class="uri">https://doi.org/10.1214/088342306000000105</a>.
</div>
<div id="ref-kiefer1974" class="csl-entry" role="listitem">
Kiefer, J. 1974. “General Equivalence Theory for Optimum Designs
(Approximate Theory).” <em>Annals of Statistics</em> 2: 849–79.
<a href="https://doi.org/10.1214/aos/1176342810" class="uri">https://doi.org/10.1214/aos/1176342810</a>.
</div>
<div id="ref-alma991096987459705816" class="csl-entry" role="listitem">
Levy, Paul S., and Stanley. Lemeshow. 2008. <em>Sampling of Populations:
Methods and Applications</em>. 4th ed. Hoboken, N.J: Wiley.
<a href="https://doi.org/10.1002/9780470374597" class="uri">https://doi.org/10.1002/9780470374597</a>.
</div>
<div id="ref-lohr2019sampling" class="csl-entry" role="listitem">
Lohr, S. L. 2019. <em>Sampling: Design and Analysis</em>. Chapman; Hall/CRC.
<a href="https://doi.org/10.1201/9780429298899" class="uri">https://doi.org/10.1201/9780429298899</a>.
</div>
<div id="ref-pmcc1989" class="csl-entry" role="listitem">
McCullagh, P., and J. Nelder. 1989. <em>Generalized Linear Models</em>. 2nd ed.
Chapman; Hall/CRC. <a href="https://doi.org/10.1007/978-1-4899-3242-6" class="uri">https://doi.org/10.1007/978-1-4899-3242-6</a>.
</div>
<div id="ref-nelder1972generalized" class="csl-entry" role="listitem">
Nelder, John Ashworth, and Robert WM Wedderburn. 1972. “Generalized
Linear Models.” <em>Journal of the Royal Statistical Society Series A:
Statistics in Society</em> 135 (3): 370–84.
<a href="https://doi.org/10.2307/2344614" class="uri">https://doi.org/10.2307/2344614</a>.
</div>
<div id="ref-overstall2017acebayes" class="csl-entry" role="listitem">
Overstall, Antony M., David C. Woods, and Maria Adamou. 2020. “Acebayes:
An R Package for Bayesian Optimal Design of Experiments via Approximate
Coordinate Exchange.” <em>Journal of Statistical Software</em> 95 (13): 1–33.
<a href="https://doi.org/10.18637/jss.v095.i13" class="uri">https://doi.org/10.18637/jss.v095.i13</a>.
</div>
<div id="ref-overstall2018package" class="csl-entry" role="listitem">
Overstall, Antony M, David C Woods, Maria Adamou, and Damianos
Michaelides. 2018. “Package ‘Acebayes’.”
<a href="https://cran.r-project.org/package=acebayes" class="uri">https://cran.r-project.org/package=acebayes</a>.
</div>
<div id="ref-pukelsheim2006optimal" class="csl-entry" role="listitem">
Pukelsheim, Friedrich. 2006. <em>Optimal Design of Experiments</em>.
Philadelphia: SIAM. <a href="https://doi.org/10.1137/1.9780898719109" class="uri">https://doi.org/10.1137/1.9780898719109</a>.
</div>
<div id="ref-stufken2012" class="csl-entry" role="listitem">
Stufken, J., and M. Yang. 2012. “Optimal Designs for Generalized Linear
Models.” In <em>Design and Analysis of Experiments, Volume 3: Special
Designs and Applications</em>, edited by K. Hinkelmann, 137–64. Wiley.
<a href="https://doi.org/10.1002/9781118147634" class="uri">https://doi.org/10.1002/9781118147634</a>.
</div>
<div id="ref-tille2006sampling" class="csl-entry" role="listitem">
Tillé, Yves. 2006. <em>Sampling Algorithms</em>. Springer.
<a href="https://doi.org/10.1007/0-387-34240-0" class="uri">https://doi.org/10.1007/0-387-34240-0</a>.
</div>
<div id="ref-tille2016package" class="csl-entry" role="listitem">
Tillé, Yves, and Alina Matei. 2016. “Package ‘Sampling’.” <em>Surv.
Sampling. Kasutatud</em> 23: 2017.
<a href="https://cran.r-project.org/package=sampling" class="uri">https://cran.r-project.org/package=sampling</a>.
</div>
<div id="ref-wang2023identifying" class="csl-entry" role="listitem">
Wang, Tianmeng, and Jie Yang. n.d. “Identifying the Most Appropriate
Order for Categorical Responses.” <em>Statistica Sinica</em> 35: 411–30.
<a href="https://doi.org/10.25417/uic.25599399.v1" class="uri">https://doi.org/10.25417/uic.25599399.v1</a>.
</div>
<div id="ref-wheeler2019package" class="csl-entry" role="listitem">
Wheeler, Bob, and Maintainer Jerome Braun. 2019. “Package ‘AlgDesign’.”
<em>R Proj. Stat. Comput</em> 1 (0): 1–25.
<a href="https://cloud.r-project.org/web/packages/AlgDesign/AlgDesign.pdf" class="uri">https://cloud.r-project.org/web/packages/AlgDesign/AlgDesign.pdf</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis
Vaughan. 2023. <em>Dplyr: A Grammar of Data Manipulation</em>.
<a href="https://dplyr.tidyverse.org" class="uri">https://dplyr.tidyverse.org</a>.
</div>
<div id="ref-ym2015" class="csl-entry" role="listitem">
Yang, J., and A. Mandal. 2015. “D-Optimal Factorial Designs Under
Generalized Linear Models.” <em>Communications in Statistics - Simulation
and Computation</em> 44: 2264–77.
<a href="https://doi.org/10.1080/03610918.2013.815773" class="uri">https://doi.org/10.1080/03610918.2013.815773</a>.
</div>
<div id="ref-ymm2016" class="csl-entry" role="listitem">
Yang, J., A. Mandal, and D. Majumdar. 2016. “Optimal Designs for <span class="math inline">\(2^k\)</span>
Factorial Experiments with Binary Response.” <em>Statistica Sinica</em> 26:
385–411. <a href="https://doi.org/10.5705/ss.2013.265" class="uri">https://doi.org/10.5705/ss.2013.265</a>.
</div>
<div id="ref-ytm2016" class="csl-entry" role="listitem">
Yang, J., L. Tong, and A. Mandal. 2017. “D-Optimal Designs with Ordered
Categorical Data.” <em>Statistica Sinica</em> 27: 1879–1902.
<a href="https://doi.org/10.5705/ss.202016.0210" class="uri">https://doi.org/10.5705/ss.202016.0210</a>.
</div>
<div id="ref-yangmin2012" class="csl-entry" role="listitem">
Yang, M., and J. Stufken. 2012. “Identifying Locally Optimal Designs for
Nonlinear Models: A Simple Extension with Profound Consequences.”
<em>Annals of Statistics</em> 40: 1665–81.
<a href="https://doi.org/10.1214/12-AOS992" class="uri">https://doi.org/10.1214/12-AOS992</a>.
</div>
<div id="ref-atkinson1999" class="csl-entry" role="listitem">
Zocchi, S. S., and A. C. Atkinson. 1999. “Optimum Experimental Designs
for Multinomial Logistic Models.” <em>Biometrics</em> 55: 437–44.
<a href="https://doi.org/10.1111/j.0006-341X.1999.00437.x" class="uri">https://doi.org/10.1111/j.0006-341X.1999.00437.x</a>.
</div>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="5" id="supplementary-materials"><span class="header-section-number">5</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-008.zip">RJ-2025-008.zip</a></p>
<h3 class="appendix" data-number="6" id="cran-packages-used"><span class="header-section-number">6</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=CDsampling">CDsampling</a>, <a href="https://cran.r-project.org/package=sampling">sampling</a>, <a href="https://cran.r-project.org/package=SamplingStrata">SamplingStrata</a>, <a href="https://cran.r-project.org/package=AlgDesign">AlgDesign</a>, <a href="https://cran.r-project.org/package=OptimalDesign">OptimalDesign</a>, <a href="https://cran.r-project.org/package=acebayes">acebayes</a>, <a href="https://cran.r-project.org/package=OPDOE">OPDOE</a>, <a href="https://cran.r-project.org/package=cubature">cubature</a></p>
<h3 class="appendix" data-number="7" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">7</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Bayesian">Bayesian</a>, <a href="https://cran.r-project.org/view=ExperimentalDesign">ExperimentalDesign</a>, <a href="https://cran.r-project.org/view=NumericalMathematics">NumericalMathematics</a>, <a href="https://cran.r-project.org/view=OfficialStatistics">OfficialStatistics</a></p>
<h3 class="appendix" data-number="8" id="note"><span class="header-section-number">8</span> Note</h3>
<p>This article is converted from a Legacy LaTeX article using the
<a href="https://cran.r-project.org/package=texor">texor</a> package.
The pdf version is the official version. To report a problem with the html,
refer to CONTRIBUTE on the R Journal homepage.</p>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Huang, et al., "CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies", The R Journal, 2025</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@article{RJ-2025-008,
  author = {Huang, Yifei and Tong, Liping and Yang, Jie},
  title = {CDsampling: An R Package for Constrained D-Optimal Sampling in Paid Research Studies},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2025-008},
  doi = {10.32614/RJ-2025-008},
  volume = {17},
  issue = {1},
  issn = {2073-4859},
  pages = {160-179}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© The R Foundation, <a href="mailto:r-journal@r-project.org">web page
contact</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
