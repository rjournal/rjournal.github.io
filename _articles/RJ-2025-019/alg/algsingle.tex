\documentclass[preview,border=5pt]{standalone}
\usepackage{xcolor}
\usepackage{verbatim}
\usepackage[T1]{fontenc}
\usepackage{hyperref}
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\R}{R}
\newcommand{\pkg}[1]{#1}
\newcommand{\CRANpkg}[1]{\pkg{#1}}%
\newcommand{\BIOpkg}[1]{\pkg{#1}}
\usepackage{amsmath,amssymb,array}
\usepackage{booktabs}
\usepackage{verbatim}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{subcaption}
\begin{document}
\nopagecolor
\begin{algorithmic}[1]
\Require Samples from the previous iteration $(\mathcal{T}_t, \mathcal{T}^\prime_t,\mathcal{M}_t,\mathcal{M}_t^\prime)$ for $t=1, \ldots, T$ and $(\sigma^2, \boldsymbol{s}_{13})$, and data $(y_i, A_i, \boldsymbol{X}_i)$ for $i=1, \cdots, N$
\For{$r=1, \ldots, M$ iteration}
\For{$i=1, \ldots, N$}
\State $Z_i \sim \left\{ \begin{array}{ll}
         N\left(\sum_{t=1}^T g_1(\boldsymbol{X}_i; \mathcal{T}_t, \mathcal{M}_t), 1\right)I_{(Z_i  > 0)} & \mbox{for $A_i =1 $};\\
        N\left(\sum_{t=1}^T g_1(\boldsymbol{X}_i; \mathcal{T}_t, \mathcal{M}_t), 1\right)I_{(Z_i  \leq 0)} & \mbox{for $A_i = 0 $}\end{array} \right.$ \Comment{latent exposure variable}
\EndFor
\For{$j=1, \ldots, T$}
\For{$i=1, \ldots, N$}
\State $R_{i,-j}^{(r)} = Z_i - \sum_{t\neq j} g_1(\boldsymbol{X}_i; \mathcal{T}_t, \mathcal{M}_t)$  \Comment{residual of the exposure model}
\State $H_{i,-j}^{(r)} = y_i - \sum_{t\neq j} g_3(\boldsymbol{X}_i; \mathcal{T}_t^\prime, \mathcal{M}_t^\prime)$  \Comment{residual of the outcome model}
\EndFor
\State $\mathcal{T}_j^{(r)} \sim [\mathcal{T}_j | R_{1, -j}^{(r)}, \cdots, R_{N, -j}^{(r)}, 1]$  \Comment{based on one of the three acceptance ratios}
\State $\mathcal{T}_j^{\prime,(r)} \sim [\mathcal{T}_j^\prime | H_{1, -j}^{(r)}, \cdots, H_{N, -j}^{(r)}, \sigma^2]$  \Comment{based on one of the three acceptance ratios}
\State $\mathcal{M}_j^{(r)} \sim [\mathcal{M}_j | \mathcal{T}_j^{(r)}, R_{1, -j}^{(r)}, \cdots, R_{N, -j}^{(r)}, 1]$
\State $\mathcal{M}_j^{\prime,(r)} \sim [\mathcal{M}_j^\prime | \mathcal{T}_j^{\prime,(r)}, H_{1, -j}^{(r)}, \cdots, H_{N, -j}^{(r)}, \sigma^2]$
\EndFor
\State \[(\sigma^2)^{(r)} \sim \text{Inv.Gamma}\left(a_\sigma+\frac{N}{2}, b_\sigma+\frac{1}{2}\left\{\sum_{i=1}^{N} \left(y_i - \sum_{t=1}^T g_3(\boldsymbol{X}_i; \mathcal{T}_t^{\prime,(r)}, \mathcal{M}_t^{\prime,(r)})\right) \right\}\right)\]
\State Update $\boldsymbol{s}_{13}^{(r)}$ based on the M-H algorithm:
\State \[\text{Proposal:} \quad \boldsymbol{s}_{13}^{(r)} \sim \mathcal{D}\left(n_{0,3} + c + \alpha/P, n_{1,1}+n_{1,3} + \alpha/P, \cdots, n_{P,1}+n_{P,3} + \alpha/P\right)\]
\State \[\text{Acceptance Ratio:} \quad P_\text{AR} (\boldsymbol{s}_{13} \rightarrow \boldsymbol{s}_{13}^{(r)}) = \text{min} \left\{1, \left(\frac{1-\sum_{j=1}^P s_j}{1-\sum_{j=1}^Ps_j^{(r)}}\right)^{\sum_{j=1}^J n_{j,3}}  \right\}\]
\EndFor
\end{algorithmic}
\end{document}
