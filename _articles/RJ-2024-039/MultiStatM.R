# Generated by `rjournal_pdf_article()` using `knitr::purl()`: do not edit by hand
# Please edit MultiStatM.Rmd to modify this file

## ----setup, include=FALSE-----------------------------------------------------
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
#library(plotly)
library(ggplot2)
library(kableExtra)
library(MultiStatM)


## -----------------------------------------------------------------------------
PTA <- PartitionTypeAll(4)


## -----------------------------------------------------------------------------
PTA$S_N_r


## -----------------------------------------------------------------------------
PTA$Part.class[[2]]


## -----------------------------------------------------------------------------
PTA$Part.class[[10]] 


## -----------------------------------------------------------------------------
PTA$S_r_j[[2]] 


## -----------------------------------------------------------------------------
PTA$eL_r


## -----------------------------------------------------------------------------
a1 <- c(1, 2)
a2 <- c(2, 3, 4)
a3 <- c(1, 3)
x <- a1 %x% a2 %x% a3
c(CommutatorMatr(Type = "Kperm", c(3, 1, 2), c(2, 3, 2)) %*% x)
a3 %x% a1 %x% a2


## -----------------------------------------------------------------------------
x[CommutatorIndx(Type = "Kperm", c(3, 1, 2), c(2, 3, 2))]


## -----------------------------------------------------------------------------
x <- c(1, 2)
HN <- HermiteN(x, 3, Type = "Multivariate")


## -----------------------------------------------------------------------------
HN[[3]]


## -----------------------------------------------------------------------------
k2 <- c(1, 0, 0, 1)
c(SymMatr(2, 3) %*% (kronecker(HN[[2]], x) - (3 - 1) * kronecker(HN[[1]], k2)))


## -----------------------------------------------------------------------------
mu <- list(
  c(1, 1), c(2, 1.5, 1.5, 2), c(4, 3, 3, 3, 3, 3, 3, 4),
  +c(10, 7, 7, 6.5, 7, 6.5, 6.5, 7, 7, 6.5, 6.5, 7, 6.5, 7, 7, 10)
)
cum <- Mom2Cum(mu, Type = "Multivariate")
cum


## -----------------------------------------------------------------------------
Cum2Mom(cum, Type = "Multivariate")


## -----------------------------------------------------------------------------
r.mu <- mu[[3]][EliminIndx(2, 3)]
r.mu


## -----------------------------------------------------------------------------
mu3 <- r.mu[QplicIndx(2, 3)]
mu3


## -----------------------------------------------------------------------------
alpha <- c(10, 5, 0)
omega <- diag(3)
MSN <- MomCumSkewNorm(r = 3, omega, alpha, nMu = TRUE)
round(MSN$Mu[[3]], 3)
round(MSN$CumX[[3]], 3)


## -----------------------------------------------------------------------------
EVSKUniS(3, Type = "Standard")$Kurt.U


## -----------------------------------------------------------------------------
data <- rSkewNorm(1000, omega, alpha)
EsMSN <- SampleEVSK(data)
ThMSN <- EVSKSkewNorm(omega, alpha)


## -----------------------------------------------------------------------------
EsMSN$estSkew[EliminIndx(3, 3)]
ThMSN$SkewX[EliminIndx(3, 3)]


## -----------------------------------------------------------------------------
EsMSN$estSkew[UnivMomCum(3, 3)]
EsMSN$estKurt[UnivMomCum(3, 4)] 


## -----------------------------------------------------------------------------
SampleSkew(data, Type = "Mardia")
ThMSN$SkewX.tot


## -----------------------------------------------------------------------------
SampleSkew(data, Type = "MRSz")
c(t(c(diag(3)) %x% diag(3)) %*% ThMSN$SkewX)


## -----------------------------------------------------------------------------
d <- 3
Cov <- diag(d)
CovH3 <- HermiteCov12(Cov, 3)


## -----------------------------------------------------------------------------
ME <- EliminMatr(3, 3)
CovH3D <- ME %*% CovH3 %*% t(ME)
InvCovH3D <- solve(CovH3D)


## -----------------------------------------------------------------------------
x <- MASS::mvrnorm(150, rep(0, d), diag(d))
EH3 <- SampleHermiteN(x, 3)


## -----------------------------------------------------------------------------
EH3D <- EH3[EliminIndx(d, 3)]


## -----------------------------------------------------------------------------
b1T <- EH3D %*% InvCovH3D %*% EH3D
b1T


## -----------------------------------------------------------------------------
b1 <- SampleSkew(x, Type = "Mardia")$Mardia.Skewness
b1


## -----------------------------------------------------------------------------
alpha <- c(4, 12)
omega <- diag(2)
set.seed(1234)
X <- rSkewNorm(500, omega, alpha) 
X <- X - sqrt(2 / pi) * c(omega %*% alpha) / c(sqrt(1 + alpha %*% omega %*% alpha))


## -----------------------------------------------------------------------------
EC <- SampleMomCum(X, r = 4, centering = TRUE, scaling = FALSE)


## -----------------------------------------------------------------------------
TC <- MomCumSkewNorm(r = 4, omega, alpha, nMu = FALSE)


## -----------------------------------------------------------------------------
EC$estCum.r[[3]][EliminIndx(2, 3)]
TC$CumX[[3]][EliminIndx(2, 3)]


## -----------------------------------------------------------------------------
EC$estCum.r[[4]][EliminIndx(2, 4)]
TC$CumX[[4]][EliminIndx(2, 4)]


## -----------------------------------------------------------------------------
fy4 <- SampleGC(X, cum = EC$estCum.r)


## ----Gram-Charlier, echo=FALSE,out.width = "100%", out.height = "50%", fig.cap = "Contour plots of the skew-normal true density (left), the Gram-Charlier approximation with estimated cumulants (center) and the Gram-Charlier approximation with true cumulants (right). Case with $k=4$ (first row) and $k=6$ (second row).", fig.alt="Contour plots of the skew-normal true density (left), the Gram-Charlier approximation with estimated cumulants (center) and the Gram-Charlier approximation with true cumulants (right). Case with $k=4$ (first row) and $k=6$ (second row)."----
knitr::include_graphics("figures/GCALL.png")


## ----eval=FALSE---------------------------------------------------------------
# CommutatorMatr(Type = "Kperm", perm = c(2, 4, 6, 1, 3, 8, 5, 7), dims = 3)


## ----eval=FALSE---------------------------------------------------------------
# CommutatorMatr(Type = "Kperm", perm = c(2, 4, 6, 1, 3, 8, 5, 7),
#                dims = c(3, 3, 3, 3, 3, 3, 3, 3))

