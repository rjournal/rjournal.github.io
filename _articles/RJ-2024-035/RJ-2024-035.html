<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package</title>

  <meta property="description" itemprop="description" content="Low-frequency time-series (e.g., quarterly data) are often treated as benchmarks for interpolating to higher frequencies, since they generally exhibit greater precision and accuracy in contrast to their high-frequency counterparts (e.g., monthly data) reported by governmental bodies. An array of regression-based methods have been proposed in the literature which aim to estimate a target high-frequency series using higher frequency indicators. However, in the era of big data and with the prevalence of large volumes of administrative data-sources there is a need to extend traditional methods to work in high-dimensional settings, i.e., where the number of indicators is similar or larger than the number of low-frequency samples. The package DisaggregateTS includes both classical regressions-based disaggregation methods alongside recent extensions to high-dimensional settings. This paper provides guidance on how to implement these methods via the package in R, and demonstrates their use in an application to disaggregating CO2 emissions."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-06-27"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-06-27"/>
  <meta name="article:author" content="Luke Mosley"/>
  <meta name="article:author" content="Kaveh Salehzadeh Nobari"/>
  <meta name="article:author" content="Giuseppe Brandi"/>
  <meta name="article:author" content="Alex Gibberd"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Low-frequency time-series (e.g., quarterly data) are often treated as benchmarks for interpolating to higher frequencies, since they generally exhibit greater precision and accuracy in contrast to their high-frequency counterparts (e.g., monthly data) reported by governmental bodies. An array of regression-based methods have been proposed in the literature which aim to estimate a target high-frequency series using higher frequency indicators. However, in the era of big data and with the prevalence of large volumes of administrative data-sources there is a need to extend traditional methods to work in high-dimensional settings, i.e., where the number of indicators is similar or larger than the number of low-frequency samples. The package DisaggregateTS includes both classical regressions-based disaggregation methods alongside recent extensions to high-dimensional settings. This paper provides guidance on how to implement these methods via the package in R, and demonstrates their use in an application to disaggregating CO2 emissions."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package"/>
  <meta property="twitter:description" content="Low-frequency time-series (e.g., quarterly data) are often treated as benchmarks for interpolating to higher frequencies, since they generally exhibit greater precision and accuracy in contrast to their high-frequency counterparts (e.g., monthly data) reported by governmental bodies. An array of regression-based methods have been proposed in the literature which aim to estimate a target high-frequency series using higher frequency indicators. However, in the era of big data and with the prevalence of large volumes of administrative data-sources there is a need to extend traditional methods to work in high-dimensional settings, i.e., where the number of indicators is similar or larger than the number of low-frequency samples. The package DisaggregateTS includes both classical regressions-based disaggregation methods alongside recent extensions to high-dimensional settings. This paper provides guidance on how to implement these methods via the package in R, and demonstrates their use in an application to disaggregating CO2 emissions."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package"/>
  <meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2024-035"/>
  <meta name="citation_pdf_url" content="RJ-2024-035.pdf"/>
  <meta name="citation_volume" content="16"/>
  <meta name="citation_issue" content="4"/>
  <meta name="citation_doi" content="10.32614/RJ-2024-035"/>
  <meta name="citation_journal_title" content="The R Journal"/>
  <meta name="citation_issn" content="2073-4859"/>
  <meta name="citation_firstpage" content="62"/>
  <meta name="citation_lastpage" content="73"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2025/06/27"/>
  <meta name="citation_publication_date" content="2025/06/27"/>
  <meta name="citation_author" content="Luke Mosley"/>
  <meta name="citation_author_institution" content="Lancaster University"/>
  <meta name="citation_author" content="Kaveh Salehzadeh Nobari"/>
  <meta name="citation_author_institution" content="Imperial College London London School of Economics and Political Science"/>
  <meta name="citation_author" content="Giuseppe Brandi"/>
  <meta name="citation_author_institution" content="Imperial College London Northeastern University London"/>
  <meta name="citation_author" content="Alex Gibberd"/>
  <meta name="citation_author_institution" content="Lancaster University"/>
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Benchmarking, temporal distribution, and reconciliation methods for time series;citation_publisher=Springer;citation_author=Estela Bee Dagum;citation_author=Pierre A Cholette"/>
  <meta name="citation_reference" content="citation_title=Macroeconomic forecasting in the era of big data: Theory and practice;citation_publisher=Springer;citation_volume=52;citation_author=Peter Fuleky"/>
  <meta name="citation_reference" content="citation_title=DisaggregateTS: High-dimensional temporal disaggregation;citation_author=Luke Mosley;citation_author=Kaveh S. Nobari"/>
  <meta name="citation_reference" content="citation_title=Sparse Temporal Disaggregation;citation_volume=185;citation_doi=10.1111/rssa.12952;citation_issn=0964-1998;citation_author=Luke Mosley;citation_author=Idris A. Eckley;citation_author=Alex Gibberd"/>
  <meta name="citation_reference" content="citation_title=Temporal disaggregation of time series;citation_volume=5;citation_author=Christoph Sax;citation_author=Peter Steiner"/>
  <meta name="citation_reference" content="citation_title=“Tempdisagg”: Methods for temporal disaggregation and interpolation of time series;citation_author=Christoph Sax;citation_author=Peter Steiner;citation_author=Tommaso Di Fonzo"/>
  <meta name="citation_reference" content="citation_title=The adaptive and the thresholded lasso for potentially misspecified models (and a lower bound for the lasso).;citation_volume=5;citation_author=Sara Van de Geer;citation_author=Peter Bühlmann;citation_author=Shuheng Zhou"/>
  <meta name="citation_reference" content="citation_title=The adaptive lasso and its oracle properties;citation_publisher=Taylor &amp; Francis;citation_volume=101;citation_author=Hui Zou"/>
  <meta name="citation_reference" content="citation_title=Réflexions sur la méthode d’elaboration des comptes trimestriels;citation_publisher=JSTOR;citation_volume=36;citation_author=Jacques Bournay;citation_author=Guy Laroque"/>
  <meta name="citation_reference" content="citation_title=Estimating the dimension of a model;citation_volume=6;citation_author=G Schwarz"/>
  <meta name="citation_reference" content="citation_title=High-dimensional statistics: A non-asymptotic viewpoint;citation_publisher=Cambridge university press;citation_volume=48;citation_author=Martin J Wainwright"/>
  <meta name="citation_reference" content="citation_title=Adjustment of monthly or quarterly series to annual totals: An approach based on quadratic minimization;citation_publisher=Taylor &amp; Francis;citation_volume=66;citation_author=Frank T Denton"/>
  <meta name="citation_reference" content="citation_title=Best linear unbiased interpolation, distribution, and extrapolation of time series by related series;citation_publisher=JSTOR;citation_volume=53;citation_author=Gregory C Chow;citation_author=An-loh Lin"/>
  <meta name="citation_reference" content="citation_title=Temporal disaggregation of economic time series: The view from the trenches;citation_publisher=Wiley Online Library;citation_volume=72;citation_author=Enrique M Quilis"/>
  <meta name="citation_reference" content="citation_title=Best linear unbiased estimation of missing observations in an economic time series;citation_publisher=Taylor &amp; Francis;citation_volume=71;citation_author=Gregory C Chow;citation_author=An-Loh Lin"/>
  <meta name="citation_reference" content="citation_title=A methodological note on the estimation of time series;citation_publisher=JSTOR;citation_volume=63;citation_author=Roque B Fernández"/>
  <meta name="citation_reference" content="citation_title=A random walk, markov model for the distribution of time series;citation_publisher=Taylor &amp; Francis;citation_volume=1;citation_author=Robert B Litterman"/>
  <meta name="citation_reference" content="citation_title=Regression shrinkage and selection via the lasso;citation_publisher=Wiley Online Library;citation_volume=58;citation_author=Robert Tibshirani"/>
  <meta name="citation_reference" content="citation_title=Gretl User’s Guide: Gnu Regression, Econometrics and Time-series Library;citation_author=Allin Cottrell;citation_author=Riccardo Lucchetti"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","description","draft","author","type","output","bibliography","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl"]}},"value":[{"type":"character","attributes":{},"value":["Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package"]},{"type":"character","attributes":{},"value":["2025-06-27"]},{"type":"character","attributes":{},"value":["Low-frequency time-series (e.g., quarterly data) are often treated as benchmarks for interpolating to higher frequencies, since they generally exhibit greater precision and accuracy in contrast to their high-frequency counterparts (e.g., monthly data) reported by governmental bodies. An array of regression-based methods have been proposed in the literature which aim to estimate a target high-frequency series using higher frequency indicators. However, in the era of big data and with the prevalence of large volumes of administrative data-sources there is a need to extend traditional methods to work in high-dimensional settings, i.e., where the number of indicators is similar or larger than the number of low-frequency samples. The package DisaggregateTS includes both classical regressions-based disaggregation methods alongside recent extensions to high-dimensional settings. This paper provides guidance on how to implement these methods via the package in R, and demonstrates their use in an application to disaggregating CO2 emissions.\n"]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Luke Mosley"]},{"type":"character","attributes":{},"value":["Lancaster University"]},{"type":"character","attributes":{},"value":["School of Mathematical Sciences","Lancaster, United Kingdom"]},{"type":"character","attributes":{},"value":["lukemos313@gmail.com"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Kaveh Salehzadeh Nobari"]},{"type":"character","attributes":{},"value":["Imperial College London","London School of Economics and Political Science"]},{"type":"character","attributes":{},"value":["Centre for Climate Finance & Investment, London, United Kingdom","Department of Psychological and Behavioural Science, London, United Kingdom"]},{"type":"character","attributes":{},"value":["k.salehzadeh-nobari@imperial.ac.uk"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Giuseppe Brandi"]},{"type":"character","attributes":{},"value":["Imperial College London","Northeastern University London"]},{"type":"character","attributes":{},"value":["Centre for Climate Finance & Investment, London, United Kingdom","Khoury College of Computer Sciences, London, United Kingdom"]},{"type":"character","attributes":{},"value":["g.brandi@imperial.ac.uk"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email"]}},"value":[{"type":"character","attributes":{},"value":["Alex Gibberd"]},{"type":"character","attributes":{},"value":["Lancaster University"]},{"type":"character","attributes":{},"value":["School of Mathematical Sciences","Lancaster, United Kingdom"]},{"type":"character","attributes":{},"value":["a.gibberd@lancaster.ac.uk"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["rjtools::rjournal_pdf_article","distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"character","attributes":{},"value":["2024-01-11"]},{"type":"integer","attributes":{},"value":[16]},{"type":"integer","attributes":{},"value":[4]},{"type":"character","attributes":{},"value":["RJ-2024-035"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[62]},{"type":"integer","attributes":{},"value":[73]}]},{"type":"character","attributes":{},"value":["RJ-2024-035.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2024-035"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2024-035"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["DisaggregateTS","tempdisagg"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["TimeSeries"]},{"type":"character","attributes":{},"value":["/home/mark/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/Exogenous_variables_IBM.csv","data/Total_emissions.csv","initial_checks.log","kaveh-nobari.log","kaveh-nobari.tex","RJ-2024-035_files/anchor-4.2.2/anchor.min.js","RJ-2024-035_files/bowser-1.9.3/bowser.min.js","RJ-2024-035_files/distill-2.2.21/template.v2.js","RJ-2024-035_files/figure-html5/fig-res-1.png","RJ-2024-035_files/figure-html5/fig-res-sim-cs-1.png","RJ-2024-035_files/figure-html5/fig-res-sim-hds-1.png","RJ-2024-035_files/figure-html5/sub1-1.png","RJ-2024-035_files/figure-html5/sub2-1.png","RJ-2024-035_files/header-attrs-2.29/header-attrs.js","RJ-2024-035_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2024-035_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2024-035_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2024-035_files/kePrint-0.0.1/kePrint.js","RJ-2024-035_files/lightable-0.0.1/lightable.css","RJ-2024-035_files/popper-2.6.0/popper.min.js","RJ-2024-035_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2024-035_files/tippy-6.2.7/tippy-light-border.css","RJ-2024-035_files/tippy-6.2.7/tippy.css","RJ-2024-035_files/tippy-6.2.7/tippy.umd.min.js","RJ-2024-035_files/webcomponents-2.0.0/webcomponents.js","RJ-2024-035.log","RJ-2024-035.pdf","RJ-2024-035.tex","RJ-2024-035.zip","RJournal.sty","RJreferences.bib","RJwrapper.aux","RJwrapper.out","RJwrapper.tex","Rlogo-5.png","scripts/HDTD_empirical_example.R","scripts/HDTD_simulations.R"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="RJ-2024-035_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="RJ-2024-035_files/kePrint-0.0.1/kePrint.js"></script>
  <link href="RJ-2024-035_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="RJ-2024-035_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="RJ-2024-035_files/popper-2.6.0/popper.min.js"></script>
  <link href="RJ-2024-035_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="RJ-2024-035_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="RJ-2024-035_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="RJ-2024-035_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="RJ-2024-035_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="RJ-2024-035_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="RJ-2024-035_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package","description":"Low-frequency time-series (e.g., quarterly data) are often treated as benchmarks for interpolating to higher frequencies, since they generally exhibit greater precision and accuracy in contrast to their high-frequency counterparts (e.g., monthly data) reported by governmental bodies. An array of regression-based methods have been proposed in the literature which aim to estimate a target high-frequency series using higher frequency indicators. However, in the era of big data and with the prevalence of large volumes of administrative data-sources there is a need to extend traditional methods to work in high-dimensional settings, i.e., where the number of indicators is similar or larger than the number of low-frequency samples. The package DisaggregateTS includes both classical regressions-based disaggregation methods alongside recent extensions to high-dimensional settings. This paper provides guidance on how to implement these methods via the package in R, and demonstrates their use in an application to disaggregating CO2 emissions.","doi":"10.32614/RJ-2024-035","authors":[{"author":"Luke Mosley","authorURL":"#","affiliation":"Lancaster University","affiliationURL":"#","orcidID":""},{"author":"Kaveh Salehzadeh Nobari","authorURL":"#","affiliation":["Imperial College London","London School of Economics and Political Science"],"affiliationURL":"#","orcidID":""},{"author":"Giuseppe Brandi","authorURL":"#","affiliation":["Imperial College London","Northeastern University London"],"affiliationURL":"#","orcidID":""},{"author":"Alex Gibberd","authorURL":"#","affiliation":"Lancaster University","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-06-27T00:00:00.000+02:00","citationText":"Mosley, et al., 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Low-frequency time-series (e.g., quarterly data) are often treated as benchmarks for interpolating to higher frequencies, since they generally exhibit greater precision and accuracy in contrast to their high-frequency counterparts (e.g., monthly data) reported by governmental bodies. An array of regression-based methods have been proposed in the literature which aim to estimate a target high-frequency series using higher frequency indicators. However, in the era of big data and with the prevalence of large volumes of administrative data-sources there is a need to extend traditional methods to work in high-dimensional settings, i.e., where the number of indicators is similar or larger than the number of low-frequency samples. The package DisaggregateTS includes both classical regressions-based disaggregation methods alongside recent extensions to high-dimensional settings. This paper provides guidance on how to implement these methods via the package in R, and demonstrates their use in an application to disaggregating CO2 emissions.</p></p>
</div>

<div class="d-byline">
  Luke Mosley  (Lancaster University)
  
,   Kaveh Salehzadeh Nobari  (Imperial College LondonLondon School of Economics and Political Science)
  
,   Giuseppe Brandi  (Imperial College LondonNortheastern University London)
  
,   Alex Gibberd  (Lancaster University)
  
<br/>2025-06-27
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Economic and administrative data, such as recorded surveys and consensus, are often disseminated by international governmental agencies at low or inconsistent frequencies, or irregularly-spaced intervals. To aid the forecasting of the evolution of the dynamics of these macroeconomic and socioeconomic indicators, as well as their comparison with higher resolution indicators provided by international agencies, statistical agencies rely on signal extraction, interpolation and temporal distribution adjustments of the low-frequency data to provide high precision and uninterrupted historical data. Although, temporal distribution, interpolation and benchmarking are closely associated with one another, this article and its respective package <span class="citation" data-cites="DisaggregateTS">(<a href="https://cran.r-project.org/package=DisaggregateTS" role="doc-biblioref">DisaggregateTS</a>, <a href="#ref-DisaggregateTS" role="doc-biblioref">Mosley and S. Nobari 2024</a>)</span>, expend particular attention to interpolation and temporal distribution (disaggregation) techniques, where the latter is predicated on regression-based methods<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. These regression-based temporal distribution techniques rely on high-frequency indicators to estimate (relatively) accurate high-frequency data points. With the prevalence of large volume of high-frequency administrative data, a great body of literature pertaining to statistical and machine learning methods has been dedicated to taking advantage of these additional resources for forecasting purposes <span class="citation" data-cites="fuleky2019macroeconomic">(see <a href="#ref-fuleky2019macroeconomic" role="doc-biblioref">Fuleky 2019</a> for an overview of macroeconomic forecasting in the presence of big data)</span>. Additionally, one may wish to utilize these abundant indicators to generate high-frequency estimates of low-frequency time-series with greater precision. However, in high-dimensional linear regression models where the number of dimensions surpass that of the observations, consistent estimates of the parameters is not possible without imposing additional structure <span class="citation" data-cites="wainwright2019high">(see <a href="#ref-wainwright2019high" role="doc-biblioref">Wainwright 2019</a>)</span>. Hence, this article and the package <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> adapt recent contributions in high-dimensional temporal disaggregation <span class="citation" data-cites="10-1111rssa-12952">(see <a href="#ref-10-1111rssa-12952" role="doc-biblioref">Mosley et al. 2022</a>)</span> to extend previous work within this domain <span class="citation" data-cites="sax2016package">Sax and Steiner (<a href="#ref-sax2013temporal2" role="doc-biblioref">2013</a>)</span> to high-dimensional settings.</p>
<p>As noted by <span class="citation" data-cites="dagum2006benchmarking">Dagum and Cholette (<a href="#ref-dagum2006benchmarking" role="doc-biblioref">2006</a>)</span>, time-series data reported by most governmental and administrative agencies tend to be of low-frequency and precise, but not particularly timely, whereas their high-frequency counterparts seldom uphold the same degree of precision.</p>
<p>The aim of temporal distribution techniques is to generate high-frequency estimates that can track shorter term movements, than directly observable with the direct low-frequency observations. While interpolation problems are generally encountered in the context of stock series, where say, the quarterly value of the low-frequency series must coincide with the value of third month of the high-frequency data (of the same quarter), temporal distribution problems often concern flow series, where instead the value of the low-frequency quarterly series must agree with the sum (or weighted combination) of the values of the high-frequency months in that quarter. The latter approach is generally accomplished by identifying and taking advantage of a number of high-frequency indicators which are deemed to behave in a similar manner to the low-frequency series, and by estimating the high-frequency series through a linear combination of such indicators.</p>
<p>In the last few decades, a significant number of articles have been published within this domain—see <span class="citation" data-cites="dagum2006benchmarking">Dagum and Cholette (<a href="#ref-dagum2006benchmarking" role="doc-biblioref">2006</a>)</span> for a detailed review of these techniques. Notable studies within this context include the additive regression-based benchmarking methods of <span class="citation" data-cites="denton1971adjustment">Denton (<a href="#ref-denton1971adjustment" role="doc-biblioref">1971</a>)</span> and <span class="citation" data-cites="chow1971best">Chow and Lin (<a href="#ref-chow1971best" role="doc-biblioref">1971</a>)</span>, <span class="citation" data-cites="chow1976best">Chow and Lin (<a href="#ref-chow1976best" role="doc-biblioref">1976</a>)</span>, as well as those proposed by <span class="citation" data-cites="fernandez1981methodological">Fernández (<a href="#ref-fernandez1981methodological" role="doc-biblioref">1981</a>)</span> and <span class="citation" data-cites="litterman1983random">Litterman (<a href="#ref-litterman1983random" role="doc-biblioref">1983</a>)</span> in the presence of highly persistent error processes. More recently these methods have been extended to the high-dimensional setting by <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span>, where prior information on the structure of the linear regression model is used to enable estimation, and better condition the regression problem. Specifically, this is accomplished by least absolute shrinkage and selection operator (LASSO hereafter) proposed by <span class="citation" data-cites="tibshirani1996regression">Tibshirani (<a href="#ref-tibshirani1996regression" role="doc-biblioref">1996</a>)</span>, which in principle selects an appropriate model by penalizing the coefficients (in scale) of the high-dimensional regression, in effect discarding the irrelevant indicators from the model. In what follows, we demonstrate how to apply these methods using <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> to easily estimate high-frequency series of interest.</p>
<p>The remainder of the paper is organized as follows: Section <a href="#Sparse-temporal-disaggregation">2</a> presents the methodologies behind key temporal disaggregation techniques included in the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> package, along with their extensions to high-dimensional settings. Section <a href="#The-package">3</a> introduces the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> package and highlights its key functions. Sections <a href="#Simulations">4</a> and <a href="#Empirical-application">5</a> provide examples based on simulations (using a function in the package that generates synthetic data) and empirical data to demonstrate the package’s functionality. Finally, Section <a href="#Summary">6</a> concludes the paper.</p>
<h2 data-number="2" id="Sparse-temporal-disaggregation"><span class="header-section-number">2</span> Sparse temporal disaggregation</h2>
<h3 data-number="2.1" id="Classical-regression-based-techniques"><span class="header-section-number">2.1</span> Classical regression-based techniques</h3>
<p>The data in figures <a href="#fig:sub1">1</a> and <a href="#fig:sub2">2</a> are generated using the <code>TempDisaggDGP()</code> function from the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> package, representing simulated stock and flow data. For the simulated stock data (Figure <a href="#fig:sub1">1</a>, each quarter’s low-frequency data should match the first month’s value of the corresponding high-frequency series, denoted with red dots. For the simulated flow data (Figure <a href="#fig:sub2">2</a>, the quarterly figures should equal the sum of the sub-quarterly values</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sub1"></span>
<img src="RJ-2024-035_files/figure-html5/sub1-1.png" alt="Quarterly and monthly simulated stock data" width="528" />
<p class="caption">
Figure 1: Quarterly and monthly simulated stock data
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sub2"></span>
<img src="RJ-2024-035_files/figure-html5/sub2-1.png" alt="Quarterly and monthly simulated flow data" width="528" />
<p class="caption">
Figure 2: Quarterly and monthly simulated flow data
</p>
</div>
</div>
<p>Suppose we observe a low-frequency series, say, quarterly GDP, encoded as the vector <span class="math inline">\(\mathbf{y}_q\in \mathbb{R}^n\)</span>, containing <span class="math inline">\(n\)</span> quarterly observations. We desire to disaggregate this series to higher frequencies (say monthly), where the disaggregated series is denoted <span class="math inline">\(\mathbf{y}_m\in \mathbb{R}^p\)</span>, with <span class="math inline">\(p=3n\)</span>. Furthermore, we wish that the disaggregated series be temporally consistent without exhibiting any jumps between quarters <span class="citation" data-cites="dagum2006benchmarking">(see Section 3.4 of <a href="#ref-dagum2006benchmarking" role="doc-biblioref">Dagum and Cholette 2006</a> for examples of such inconsistencies between the periods)</span>. The challenge is to identify an approach that distributes the variation between each observed quarterly point to the monthly level. A method that has been extensively studied in the literature concerns finding high-frequency (e.g., monthly) indicator series that are thought to exhibit similar inter-quarterly movements as the low-frequency variable of interest. Let us denote a set of <span class="math inline">\(p\)</span> observations from these <span class="math inline">\(d\)</span> indicators as the matrix <span class="math inline">\(\mathbf{X}_m\in \mathbb{R}^{p\times d}\)</span>. A classical approach to provide high-frequency estimates is the regression-based temporal disaggregation technique proposed by <span class="citation" data-cites="chow1971best">Chow and Lin (<a href="#ref-chow1971best" role="doc-biblioref">1971</a>)</span> whereby the unobserved monthly series <span class="math inline">\(\mathbf{y}_m\)</span> are assumed to follow the regression:
<span class="math display" id="eq:ChowLin">\[\begin{equation}
\mathbf{y}_m=\mathbf{X}_m\beta+\mathbf{u}_m,\quad \mathbf{u}_m\sim N(\mathbf{0}_m,\mathbf{V}_m)
\tag{1}
\end{equation}\]</span>
where <span class="math inline">\(\beta \in\mathbb{R}^d\)</span> is a vector of regression coefficients to be estimated (noting that <span class="math inline">\(\mathbf{X}_m\)</span> may contain deterministic terms) and <span class="math inline">\(\mathbf{u}_m\in \mathbb{R}^p\)</span> is a vector of residuals. <span class="citation" data-cites="chow1971best">Chow and Lin (<a href="#ref-chow1971best" role="doc-biblioref">1971</a>)</span> assume that <span class="math inline">\(\mathbf{u}_m\)</span> follows as AR(1) process of the form <span class="math inline">\(u_t=\rho u_{t-1}+\varepsilon_t\)</span> with <span class="math inline">\(\varepsilon_t\sim N(0,\sigma^2)\)</span> and <span class="math inline">\(\lvert \rho\rvert &lt;1\)</span>. The assumption of stationary residuals allows for a cointegrating relationship between <span class="math inline">\(\mathbf{y}_m\)</span> and <span class="math inline">\(\mathbf{X}_m\)</span> when they are integrated of the same order.
Thus, the covariance matrix has a well-known Toeplitz structure as follows:
<span class="math display">\[\begin{equation}
\mathbf{V}_m=\frac{\sigma^2}{1-\rho^2}
\begin{pmatrix}
1 &amp; \rho &amp;\cdots &amp; \rho^{p-1}\\
\rho &amp; 1 &amp;\cdots &amp; \rho^{p-2}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots \\
\rho^{p-1} &amp; \rho^{p-2} &amp;\cdots &amp; 1\\
\end{pmatrix}
\end{equation}\]</span>
where <span class="math inline">\(\rho\)</span> and <span class="math inline">\(\sigma\)</span> are unknown parameters that need to be estimated. The dependent variable <span class="math inline">\(\mathbf{y}_m\)</span> in <a href="#eq:ChowLin">(1)</a> is unobserved, hence the regression is premultiplied by the <span class="math inline">\(n\times p\)</span> aggregation matrix <span class="math inline">\(\mathbf{C}\)</span>, where:
<span class="math display" id="eq:flowData">\[\begin{align}
\begin{split}
\mathbf{C}&amp;=\mathbf{I}_n\otimes (1,1,1)\\
&amp;=
\begin{pmatrix}
1&amp;1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;\cdots &amp;0\\
0&amp;0&amp;0 &amp; 1&amp;1&amp;1&amp;0&amp;\cdots &amp;0\\
\vdots&amp;\vdots&amp;\vdots &amp; &amp;\ddots&amp;\ddots&amp;\ddots&amp;\vdots &amp;\vdots\\
0&amp;\cdots&amp;0&amp;0&amp;0&amp;0&amp;1&amp;1 &amp;1
\end{pmatrix}_{n\times p}
\end{split}
\tag{2}
\end{align}\]</span>
where <span class="math inline">\(\otimes\)</span> is the Kronecker operator, and the vector of ones in <a href="#eq:flowData">(2)</a> is used for flow data (e.g., GDP), such that the sum of the monthly GDPs coincides with its quarterly counterpart<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The premultiplication yields the quarterly counterpart of <a href="#eq:ChowLin">(1)</a>:
<span class="math display">\[\begin{equation}
\mathbf{C}\mathbf{y}_m=\mathbf{C}\mathbf{X}_m\beta+\mathbf{C}\mathbf{u}_m,\quad \mathbf{C}\mathbf{u}_m\sim N(\mathbf{C}\mathbf{0}_m,\mathbf{C}\mathbf{V}_m\mathbf{C}^{\top}).
\end{equation}\]</span>
The GLS estimator for <span class="math inline">\(\beta\)</span> is thus expressed as follows:
<span class="math display" id="eq:GLSEstimator" id="eq:CostFunction">\[\begin{align}
\hat{\beta}=&amp;\arg\min_{\beta\in\mathbb{R}^d}\left\{\Big\lVert \mathbf{V}_q^{-\frac{1}{2}}(\mathbf{y}_q-\mathbf{X}_q\beta)\Big\rvert_2^2\right\}
\tag{3}\\
=&amp;\left(\mathbf{X}_q^{\top}\mathbf{V}_q^{-1}\mathbf{X}_q\right)^{-1}\mathbf{X}_q^{\top}\mathbf{V}_q^{-1}\mathbf{y}_q
\tag{4}
\end{align}\]</span>
where <span class="math inline">\(\mathbf{X}_q=\mathbf{CX}_m\)</span>, <span class="math inline">\(\mathbf{y}_q=\mathbf{Cy}_m\)</span> and <span class="math inline">\(\mathbf{V}_q=\mathbf{C}\mathbf{V}_m\mathbf{C}^{\top}\)</span>. Note that estimating <span class="math inline">\(\beta\)</span> requires the knowledge of the unknown parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\rho\)</span> in <span class="math inline">\(\mathbf{V}_m\)</span> which are unknown. We employ the profile-likelihood maximization technique of <span class="citation" data-cites="bournay1979reflexions">Bournay and Laroque (<a href="#ref-bournay1979reflexions" role="doc-biblioref">1979</a>)</span>, which involves first estimating <span class="math inline">\(\hat{\beta}\)</span> and <span class="math inline">\(\mathbf{V}_q\)</span> conditional on a given value of <span class="math inline">\(\rho\)</span>, and maximizing the log-likelihood function by conducting a grid search over <span class="math inline">\(\rho \in (-1, 1)\)</span> for the autoregressive parameter. However, in practical applications, including well-known implementations such as the <a href="https://cran.r-project.org/package=tempdisagg">tempdisagg</a> package and the <code>Gretl</code> econometric software <span class="citation" data-cites="cottrell2023gretl">Cottrell and Lucchetti (<a href="#ref-cottrell2023gretl" role="doc-biblioref">2023</a>)</span>, the grid search is often restricted to <span class="math inline">\(\rho \in [0, 1)\)</span>, reflecting a non-negative constraint on the autoregressive parameter. Our method is specifically designed to search within <span class="math inline">\(\rho \in [0, 1)\)</span>, reflecting this non-negative constraint.</p>
<p><span class="citation" data-cites="chow1971best">Chow and Lin (<a href="#ref-chow1971best" role="doc-biblioref">1971</a>)</span> show the optimal solution is obtained by:</p>
<p><span class="math display">\[\begin{equation}
\hat{\mathbf{y}}_m=\mathbf{X}_m\hat{\beta}+\hat{\mathbf{V}}_m\mathbf{C}\hat{\mathbf{V}}_q^{-1}\left(\mathbf{y}_q-\mathbf{X}_q\hat{\beta}\right),
\end{equation}\]</span>
where <span class="math inline">\(\mathbf{X}_m\hat{\beta}\)</span> is the conditional expectation of <span class="math inline">\(\mathbf{y}_m\)</span> given <span class="math inline">\(\mathbf{X}_m\)</span> and the estimate of the monthly residuals are obtained by disaggregating the quarterly residuals <span class="math inline">\(\mathbf{y}_q-\mathbf{X}_q\hat{\beta}\)</span> to attain temporal consistency between <span class="math inline">\(\hat{\mathbf{y}}_m\)</span> and <span class="math inline">\(\mathbf{y}\)</span>.</p>
<p>Other variants of the regression-based techniques include those proposed by <span class="citation" data-cites="denton1971adjustment">Denton (<a href="#ref-denton1971adjustment" role="doc-biblioref">1971</a>)</span>, <span class="citation" data-cites="fernandez1981methodological">Fernández (<a href="#ref-fernandez1981methodological" role="doc-biblioref">1981</a>)</span>, <span class="citation" data-cites="litterman1983random">Litterman (<a href="#ref-litterman1983random" role="doc-biblioref">1983</a>)</span>, and <span class="citation" data-cites="cholette1984adjusting">Cholette (<a href="#ref-cholette1984adjusting" role="doc-biblioref">1984</a>)</span>, with the latter two addressing scenarios where <span class="math inline">\(\mathbf{y}_m\)</span> and <span class="math inline">\(\mathbf{X}_m\)</span> are not cointegrated. Although these traditional techniques are included in the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> package, a comprehensive overview of different temporal disaggregation techniques and distribution matrices can be found in Table 2 of <span class="citation" data-cites="sax2013temporal2">Sax and Steiner (<a href="#ref-sax2013temporal2" role="doc-biblioref">2013</a>)</span>. The <a href="https://cran.r-project.org/package=tempdisagg">tempdisagg</a> package implements several standard methods for temporal disaggregation, each with distinct approaches for estimating high-frequency series. These include the Denton, Denton-Cholette, Chow-Lin, fernández, and Litterman methods. As summarized in Table 2 of <span class="citation" data-cites="sax2013temporal2">Sax and Steiner (<a href="#ref-sax2013temporal2" role="doc-biblioref">2013</a>)</span>, Denton and Denton-Cholette focus on movement preservation, while regression-based methods like Chow-Lin, fernández, and Litterman perform generalized least squares regressions on the low-frequency series using one or more high-frequency indicators. We have implemented the Chow-Lin method with a non-negative autoregressive parameter, constrained within the range <span class="math inline">\([0, 1)\)</span>, following the approach of <span class="citation" data-cites="bournay1979reflexions">Bournay and Laroque (<a href="#ref-bournay1979reflexions" role="doc-biblioref">1979</a>)</span> and <span class="citation" data-cites="cottrell2023gretl">Cottrell and Lucchetti (<a href="#ref-cottrell2023gretl" role="doc-biblioref">2023</a>)</span>. This offers flexibility in different disaggregation scenarios.</p>
<h3 data-number="2.2" id="extension-to-high-dimensional-settings"><span class="header-section-number">2.2</span> Extension to high-dimensional settings</h3>
<p>The shortcoming of <span class="citation" data-cites="chow1971best">Chow and Lin (<a href="#ref-chow1971best" role="doc-biblioref">1971</a>)</span> becomes evident in data-rich environments, where the number of indicators <span class="math inline">\(d\gg n\)</span> surpass that of the time-stamps for the low-frequency data. Let us once again recall the GLS estimator <a href="#eq:GLSEstimator">(4)</a>. When <span class="math inline">\(d&lt;n\)</span> and the columns of <span class="math inline">\(\mathbf{X}_q^{\top}\mathbf{V}_q^{-1}\mathbf{X}_q\)</span> are independent, the estimator is well-defined. However, when <span class="math inline">\(d&gt;n\)</span>, the matrix is rank-deficient - i.e., <span class="math inline">\(\text{rank}(\mathbf{X}_q^{\top}\mathbf{V}_q^{-1}\mathbf{X}_q)\leq \min(n,d)\)</span>, the matrix <span class="math inline">\(\mathbf{X}_q^{\top}\mathbf{V}_q^{-1}\mathbf{X}_q\)</span> has linearly dependent columns, and thus is not invertible. In moderate dimensions, where <span class="math inline">\(d\approx n\)</span>, <span class="math inline">\(\mathbf{X}_q^{\top}\mathbf{V}_q^{-1}\mathbf{X}_q\)</span> has eigenvalues close to zero, leading to high variance estimates of <span class="math inline">\(\hat{\beta}\)</span>.</p>
<p><span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span> resolve this problem by adding a regularizing penalty (e.g., <span class="math inline">\(\ell_1\)</span> regularizer) onto the GLS cost function <a href="#eq:CostFunction">(3)</a>:
<span class="math display" id="eq:LASSO">\[\begin{equation}
\hat{\beta}(\lambda_n\mid\rho)=\arg\min_{\beta\in\mathbb{R}^d}\left\{\Big\lVert \mathbf{V}_q^{-\frac{1}{2}}(\mathbf{y}_q-\mathbf{X}_q\beta)\Big\rVert_2^2+\lambda_n\lVert \beta\rVert_1\right\}.
\tag{5}
\end{equation}\]</span></p>
<p>Unlike the GLS estimator <a href="#eq:GLSEstimator">(4)</a>, the regularized estimator corresponding to the cost function <a href="#eq:LASSO">(5)</a> is a function of <span class="math inline">\(\lambda_n\)</span> and the autoregressive parameter <span class="math inline">\(\rho\)</span>. Henceforth, it is important to nominate the most suitable <span class="math inline">\(\lambda_n\)</span> and <span class="math inline">\(\rho\)</span> to correctly recover the parameters. In <a href="#eq:LASSO">(5)</a>, we denote the estimator as <span class="math inline">\(\hat{\beta}(\lambda_n\mid\rho)\)</span> to highlight that the solution paths of the estimator for different values of <span class="math inline">\(\lambda_n\)</span>, say, <span class="math inline">\(\lambda_n^{(1)},\lambda_n^{(2)},\cdots,\lambda_n^{(k)}\)</span> are generated for (i.e. conditional on) a fixed <span class="math inline">\(\rho\)</span>. The solution paths are obtained using the LARS algorithm proposed by <span class="citation" data-cites="efron2004least">Efron et al. (<a href="#ref-efron2004least" role="doc-biblioref">2004</a>)</span>, the benefits of which have been extensively discussed in <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span>.</p>
<p>LASSO estimators inherently exhibit a small bias, such that <span class="math inline">\(\lVert \hat{\beta}\rVert_2^2\leq \lVert \beta^*\rVert_2^2\)</span>, where <span class="math inline">\(\beta^*\)</span> denotes the true coefficient vector. To alleviate this issue, <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span> further follow <span class="citation" data-cites="belloni2013least">Belloni and Chernozhukov (<a href="#ref-belloni2013least" role="doc-biblioref">2013</a>)</span>, by performing a refitting procedure using least squares re-estimation. The latter entails generating a new <span class="math inline">\(n\times d^{(l)}\)</span> sub-matrix <span class="math inline">\(\mathbf{X&#39;}_q\)</span>, where <span class="math inline">\(d^{(l)}\leq d\)</span> from the original <span class="math inline">\(n\times d\)</span> matrix <span class="math inline">\(\mathbf{X}_q\)</span>, with <span class="math inline">\(\mathbf{X&#39;}_q\)</span> corresponding to the columns of <span class="math inline">\(\mathbf{X}_q\)</span> supported by <span class="math inline">\(\hat{\beta}(\lambda_n^{(l)}\mid\rho)\)</span>, for solutions <span class="math inline">\(l=1,\cdots,k\)</span> obtained from the LARS algorithm<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. We then perform a usual least squares estimation on <span class="math inline">\((\mathbf{y}_q,\mathbf{X&#39;}_q)\)</span> to obtain debiased solution paths for each <span class="math inline">\(\lambda_n^{(l)}\)</span>.</p>
<p>Finally, <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span> choose the optimal estimate from <span class="math inline">\(\hat{\beta}(\lambda_n^{1}\mid \rho),\cdots,\hat{\beta}(\lambda_n^{k}\mid \rho)\)</span> using the Bayesian Information Criterion (BIC hereafter) proposed by <span class="citation" data-cites="schwarz1978estimating">Schwarz (<a href="#ref-schwarz1978estimating" role="doc-biblioref">1978</a>)</span>. The motivation for nominating this statistic over resampling methods, such as cross-validation or bootstrapping techniques, stems from the small sample size in the low-frequency observations. The optimal regularization is chosen conditional on <span class="math inline">\(\rho\)</span> according to
<span class="math display" id="eq:BIC">\[\begin{equation}
\hat{\lambda}_n(\rho)={\arg\min}_{\lambda_n(\rho)\in\{\lambda_n^{(1)}(\rho),\cdots,\lambda_n^{(k)}(\rho)\}}\left\{-2\mathcal{L}\left(\hat{\beta}(\lambda_n\mid \rho),\hat{\sigma}^2\right)+\log(n)K_{\lambda_n(\rho)}\right\},
\tag{6}
\end{equation}\]</span>
where <span class="math inline">\(K_{\lambda_n(\rho)}=\lvert \{r:(\hat{\beta}(\lambda_n\mid \rho)_r\neq 0)\}\rvert\)</span> is the degrees of freedom and <span class="math inline">\(\mathcal{L}(\hat{\beta}(\lambda_n\mid \rho),\hat{\sigma}^2)\)</span> is the log-likelihood function of the GLS regression <a href="#eq:GLSEstimator">(4)</a>, which in the presence of Gaussian errors, is given by:
<span class="math display">\[\begin{equation}
\mathcal{L}(\hat{\beta},\hat{\sigma}^2)=-\frac{n}{2}\log(2\pi)-\frac{n}{2}\log(\sigma^2)-\frac{1}{2}\log(\lvert \mathbf{S}\rvert)-\frac{1}{2\sigma^2}(\mathbf{y}_q-\mathbf{X}_q\beta)^\top(\mathbf{y}_q-\mathbf{X}_q\beta),
\end{equation}\]</span>
where <span class="math inline">\(\lvert \mathbf{S}\rvert\)</span> is the determinant of the Toeplitz matrix <span class="math inline">\(\mathbf{S}\)</span> depending on <span class="math inline">\(\rho\)</span>, such that <span class="math inline">\(\mathbf{V}_q=\sigma^2\mathbf{S}\)</span> (recalling that <span class="math inline">\(\mathbf{V}_q=\mathbf{C}\mathbf{V}_m\mathbf{C}^{\top}\)</span>).</p>
<h2 data-number="3" id="The-package"><span class="header-section-number">3</span> The package</h2>
<p>In this Section, we showcase the main functions that has been included in the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> package. Following <span class="citation" data-cites="sax2016package">Sax et al. (<a href="#ref-sax2016package" role="doc-biblioref">2023</a>)</span>, we first introduce the main function of the package and it its features, and subsequently we will showcase other functions that allow the practitioner to conducting simulations and analyses.</p>
<h3 data-number="3.1" id="functions"><span class="header-section-number">3.1</span> Functions</h3>
<p>The main function of the package which performs the sparse temporal disaggregation method proposed by <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span> is <code>disaggregate()</code>. This function is of the following form:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/DisaggregateTS/man/disaggregate.html'>disaggregate</a></span><span class='op'>(</span><span class='va'>Y</span>, <span class='va'>X</span>, <span class='va'>aggMat</span>, <span class='va'>aggRatio</span>, <span class='va'>method</span>, <span class='va'>...</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>where the first argument of the function, <code>Y</code>, corresponds to the <span class="math inline">\(n\times 1\)</span> vector of low-frequency series <span class="math inline">\(\mathbf{y}_q\)</span> that we wish to disaggregate, and the second argument, <code>X</code>, is the <span class="math inline">\(p\times d\)</span> matrix of high-frequency indicator series <span class="math inline">\(\mathbf{X}_m\)</span>. In the event that there is no input <code>X</code>, the disaggregation matrix <span class="math inline">\(\mathbf{X}_m\)</span> is replaced with an <span class="math inline">\(n\times 1\)</span> vector of ones.</p>
<p>The argument <code>aggMat</code> coincides with the aggregation matrix <span class="math inline">\(\mathbf{C}\)</span> in <a href="#eq:flowData">(2)</a>, and it has been set to <code>"sum"</code> by default, rendering it suitable for flow data. Alternative options include <code>"first"</code>, <code>"last"</code> and <code>"average"</code>. The aggregation (distribution) matrices that are utilized in this function are summarized in table 2 of <span class="citation" data-cites="sax2016package">Sax et al. (<a href="#ref-sax2016package" role="doc-biblioref">2023</a>)</span>.</p>
<p>The argument <code>aggRatio</code> has been set to <code>4</code> by default, which represents the ratio of annual to quarterly data. In general, this argument should be set to the ratio of the high-frequency to low-frequency series. For instance, in the examples considered in the preceding Sections, we had considered quarterly data as the low-frequency series, and monthly data as its high-frequency counterpart. Thus, in this setting <code>aggRatio = 3</code>. At first glance, the presence of the <code>aggRatio</code> argument may seem redundant. However, if <span class="math inline">\(n\geq n_l\times \text{aggRatio}\)</span>, then extrapolation is done up to <span class="math inline">\(n\)</span>.</p>
<p>Finally, the argument <code>method</code> refers to the method of disaggregation under consideration. This argument has been set to <code>"Chow-lin"</code> method by default, which is the classical regression-based disaggregation technique introduced in Section <span id="Classical-regression-based-techniques">2.1</span>. Other classical low-dimensional options include <code>"Denton"</code>, <code>"Denton-Cholette"</code>, <code>"fernandez"</code>, and <code>"Litterman"</code>, where these techniques have been extensively discussed in <span class="citation" data-cites="dagum2006benchmarking">Dagum and Cholette (<a href="#ref-dagum2006benchmarking" role="doc-biblioref">2006</a>)</span> and <span class="citation" data-cites="sax2013temporal2">Sax and Steiner (<a href="#ref-sax2013temporal2" role="doc-biblioref">2013</a>)</span>. The main contribution of this package stems from the <code>"spTD"</code> and <code>"adaptive-spTD"</code> options pertaining to sparse temporal disaggregation and adaptive sparse temporal disaggregation, which are <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span>’s high-dimensional extension of the regression-based techniques proposed by <span class="citation" data-cites="chow1971best">Chow and Lin (<a href="#ref-chow1971best" role="doc-biblioref">1971</a>)</span>. In a high-dimensional regression, the adaptive LASSO is relevant when, for instance, the columns of the design matrix <span class="math inline">\(\mathbf{X}\)</span> exhibit multicollinearity, and the <em>Irrepresentability Condition</em> (IC hereafter) is violated <span class="citation" data-cites="zou2006adaptive">(see <a href="#ref-zou2006adaptive" role="doc-biblioref">Zou 2006</a> for details)</span>. In such settings, the regularization parameter <span class="math inline">\(\lambda\)</span> does not satisfy the oracle property, which can lead to inconsistent variable selection. The adaptive counterpart of the regularized GLS cost function <a href="#eq:LASSO">(5)</a>, can be expressed as follows:
<span class="math display" id="eq:AdaptiveLASSO">\[\begin{equation}
\hat{\beta}(\lambda_n\mid\rho)=\arg\min_{\beta\in\mathbb{R}^d}\left\{\Big\lVert \mathbf{V}_q^{-\frac{1}{2}}(\mathbf{y}_q-\mathbf{X}_q\beta)\Big\rVert_2^2+\lambda_n\sum_{j=1}^{d}\frac{\lvert \beta_j\rvert}{\lvert \hat{\beta}_{\text{init},j}\rvert}\right\},
\tag{7}
\end{equation}\]</span>
where <span class="math inline">\(\hat{\beta}_{\text{init},j}\)</span> is an initial estimator, predicated on <span class="math inline">\(\hat{\beta}(\hat{\rho})\)</span> from the regularized (LASSO) temporal disaggregation. See <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span>, for the details of the proposed methodology, and <span class="citation" data-cites="zou2006adaptive">Zou (<a href="#ref-zou2006adaptive" role="doc-biblioref">2006</a>)</span> and <span class="citation" data-cites="van2011adaptive">Van de Geer et al. (<a href="#ref-van2011adaptive" role="doc-biblioref">2011</a>)</span> to yield variable selection consistency using the OLS estimator and LASSO as <span class="math inline">\(\hat{\beta}_{\text{init},j}\)</span> when the IC condition is violated.</p>
<p>The second main function of the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> package is <code>TempDisaggDGP()</code>, which generates synthetic data that can be used for conducting simulations using the <code>disaggregate()</code> function. The main arguments of this function are as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/DisaggregateTS/man/TempDisaggDGP.html'>TempDisaggDGP</a></span><span class='op'>(</span><span class='va'>n_l</span>, <span class='va'>n</span>, <span class='va'>aggRatio</span>, <span class='va'>p</span>, <span class='va'>beta</span>, <span class='va'>sparsity</span>, <span class='va'>method</span>, <span class='va'>aggMat</span>, <span class='va'>rho</span>, <span class='va'>...</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>where the first argument corresponds to the size of low-frequency series and <code>n</code> to that of the high-frequency series. Moreover, <code>aggRatio</code> and <code>aggMat</code> are defined as before, in turn representing the ratio of the high-frequency to low-frequency series, as well as the aggregation matrix <a href="#eq:flowData">(2)</a>. A minor difference in the DGP function is that if <span class="math inline">\(n\geq n_l\times \text{aggRatio}\)</span>, then the last <span class="math inline">\(n-\text{aggRatio}\times n_l\)</span> columns of the aggregation matrix are set to zero, such that <span class="math inline">\(Y\)</span> is observed only up to <span class="math inline">\(n_l\)</span>. Argument <code>p</code> sets the dimensionality of high-frequency series (set to <span class="math inline">\(1\)</span> by default), <code>beta</code> which has been set to <code>1</code> by default is the positive and negative elements of the coefficient vector, <code>sparsity</code> is the sparsity percentage of the coefficient vector, and
<code>rho</code> is the autocorrelation of the error terms, which has been set to <code>0</code> by default. Finally, the <code>method</code> argument determines the data generating process of the error terms, corresponding to methods discussed earlier in this Section.</p>
<p>A number of optional arguments included in the function determine the mean vector and the standard deviation of the design matrix, as well as options such a setting seed for running the simulations, where the design matrix and the coefficient vectors are fixed.</p>
<p>In what follows, we showcase a simple example of the function and its respective outputs:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Generate low-frequency quarterly series and its high-frequency monthly counterpart</span></span>
<span><span class='va'>SynthethicData</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DisaggregateTS/man/TempDisaggDGP.html'>TempDisaggDGP</a></span><span class='op'>(</span>n_l <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>                                n <span class='op'>=</span> <span class='fl'>6</span>, </span>
<span>                                aggRatio <span class='op'>=</span> <span class='fl'>3</span>, </span>
<span>                                p <span class='op'>=</span> <span class='fl'>6</span>, </span>
<span>                                beta <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>                                sparsity <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>                                method  <span class='op'>=</span> <span class='st'>'Chow-Lin'</span>, </span>
<span>                                rho <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In the example above, we generate low-frequency series <span class="math inline">\(\mathbf{y}_q\in \mathbb{R}^2\)</span> corresponding to two quarters, and consequently, its high-frequency monthly counterpart <span class="math inline">\(\mathbf{y}_m \in \mathbb{R}^{6}\)</span>. It is further assumed that the data is generated using six monthly indicators - i.e., <span class="math inline">\(\mathbf{X}^{6\times 6}_m\)</span>, with a coefficient vector <span class="math inline">\(\beta\in \mathbb{R}^6\)</span>, where <span class="math inline">\(\beta_j \in \{-0.5, 0, +0.5\}\)</span>. Since, the sparsity argument is set to <span class="math inline">\(0.5\)</span>, only half of <span class="math inline">\(\beta\)</span>’s elements are non-zero. Finally, the error vector <span class="math inline">\(\mathbf{u}_m\)</span> is assumed to follow the AR(<span class="math inline">\(1\)</span>) structure of <span class="citation" data-cites="chow1971best">Chow and Lin (<a href="#ref-chow1971best" role="doc-biblioref">1971</a>)</span>, with an autocorrelation parameter of <span class="math inline">\(\rho=0.5\)</span>.</p>
<h2 data-number="4" id="Simulations"><span class="header-section-number">4</span> Simulations</h2>
<p>In this Section, we show a simulation exercise to demonstrate the implementation of the temporal disaggregation method via the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> package.</p>
<h3 data-number="4.1" id="classical-setting"><span class="header-section-number">4.1</span> Classical setting</h3>
<p>We start by simulating the dependent variable <span class="math inline">\(Y\in \mathbb{R}^{17}\)</span> and the set of high-frequency exogenous variables <span class="math inline">\(X \in \mathbb{R}^{68\times 5}\)</span> by using the command:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Set seed for reproducibility</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>27</span><span class='op'>)</span></span>
<span><span class='co'># Generate low-frequency yearly series and its high-frequency quarterly counterpart</span></span>
<span><span class='va'>n_l</span> <span class='op'>&lt;-</span> <span class='fl'>17</span> <span class='co'># The number of low-frequency data points - annual</span></span>
<span><span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>68</span> <span class='co'># The number of high-frequency (quarterly) data points.</span></span>
<span><span class='va'>p_sim</span> <span class='op'>&lt;-</span> <span class='fl'>5</span> <span class='co'># The number of the high-frequency exogenous variables.</span></span>
<span><span class='va'>rho_sim</span> <span class='op'>&lt;-</span> <span class='fl'>0.8</span> <span class='co'># autocorrelation parameter</span></span>
<span><span class='va'>Sim_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DisaggregateTS/man/TempDisaggDGP.html'>TempDisaggDGP</a></span><span class='op'>(</span><span class='va'>n_l</span>, </span>
<span>                          <span class='va'>n</span>, </span>
<span>                          aggRatio <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                          p <span class='op'>=</span> <span class='va'>p_sim</span>,</span>
<span>                          rho <span class='op'>=</span> <span class='va'>rho_sim</span><span class='op'>)</span></span>
<span><span class='va'>Y_sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>Sim_data</span><span class='op'>$</span><span class='va'>Y_Gen</span><span class='op'>)</span> <span class='co'># Extract the simulated dependent low-frequency variable</span></span>
<span><span class='va'>X_sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>Sim_data</span><span class='op'>$</span><span class='va'>X_Gen</span><span class='op'>)</span> <span class='co'># Extract the simulated dependent </span></span>
<span><span class='co'># (low-frequency) variable</span></span>
<span><span class='va'>Y_sim_HF_obs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>Sim_data</span><span class='op'>$</span><span class='va'>y_Gen</span><span class='op'>)</span> <span class='co'>#  HF simulated observations</span></span></code></pre>
</div>
</div>
<p>In this example, we are generating a set of low-frequency data, i.e. 17 annual datapoints and a set of high-frequency (quarterly) exogenous variables that we want to use to infer the high-frequency counterpart of the low-frequency data. We now want to temporally disaggregate the low-frequency time series by using the information encapsulated in the high-frequency time series. In this case, since the number of time observations is larger than the number of exogenous variables, we can use standard methodologies to estimate the temporal disaggregation model. To do so, we use the <code>disaggregate()</code> function setting <code>method="Chow-Lin"</code>. The code is as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>C_sparse_SIM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DisaggregateTS/man/disaggregate.html'>disaggregate</a></span><span class='op'>(</span><span class='va'>Y_sim</span>, </span>
<span>                             <span class='va'>X_sim</span>,</span>
<span>                             aggMat <span class='op'>=</span> <span class='st'>"sum"</span>,</span>
<span>                             aggRatio <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                             method <span class='op'>=</span> <span class='st'>"Chow-Lin"</span><span class='op'>)</span></span>
<span><span class='va'>C_sparse_SIM</span><span class='op'>$</span><span class='va'>beta_Est</span></span></code></pre>
</div>
<pre><code>1 x 1 Matrix of class &quot;dgeMatrix&quot;
          [,1]
[1,] 0.3193439</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>Y_HF_SIM</span> <span class='op'>&lt;-</span> <span class='va'>C_sparse_SIM</span><span class='op'>$</span><span class='va'>y_Est</span><span class='op'>[</span> ,<span class='fl'>1</span><span class='op'>]</span> <span class='co'># Extract the temporal disaggregated </span></span>
<span><span class='co'># dependent variable estimated through the function disaggregate()</span></span></code></pre>
</div>
</div>
<p>We show in Figure <a href="#fig:fig-res-sim-cs">3</a> the results, where we depict the high-frequency observation computed via standard interpolation and estimated through the Chow-Lin temporal disaggregation method.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig-res-sim-cs"></span>
<img src="RJ-2024-035_files/figure-html5/fig-res-sim-cs-1.png" alt="Temporal disaggregated and interpolated observations for the estimation under the classical setting. The plot is built using the snippet code provided in this subsection. As we used the setting `aggMat = sum`, the sum of every four disaggregated observations corresponds to an actual low-frequency observation." width="528" />
<p class="caption">
Figure 3: Temporal disaggregated and interpolated observations for the estimation under the classical setting. The plot is built using the snippet code provided in this subsection. As we used the setting <code>aggMat = sum</code>, the sum of every four disaggregated observations corresponds to an actual low-frequency observation.
</p>
</div>
</div>
<h3 data-number="4.2" id="high-dimensional-setting"><span class="header-section-number">4.2</span> High-dimensional setting</h3>
<p>We now repeat the simulation experiment in a high-dimensional setting, where the number of temporal observations is lower than the number of exogenous variables. In this case, standard methods like Chow-Lin cannot be applied.
To do so, we simulate the dependent variable <span class="math inline">\(Y\in \mathbb{R}^{17}\)</span> as before, but now the set of high-frequency exogenous variables is of dimension <span class="math inline">\(X \in \mathbb{R}^{68\times 100}\)</span>. Similarly, as before, we can use the following command:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Generate low-frequency yearly series and its high-frequency quarterly counterpart</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>27</span><span class='op'>)</span></span>
<span><span class='va'>n_l</span> <span class='op'>&lt;-</span> <span class='fl'>17</span> <span class='co'># The number of low-frequency data points </span></span>
<span><span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>68</span> <span class='co'># The number of high-frequency data points - quarterly</span></span>
<span><span class='va'>p_sim</span> <span class='op'>&lt;-</span> <span class='fl'>100</span> <span class='co'># The number of the high-frequency exogenous variables.</span></span>
<span><span class='va'>rho_sim</span> <span class='op'>&lt;-</span> <span class='fl'>0.8</span> <span class='co'># autocorrelation parameter</span></span>
<span><span class='va'>Sim_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DisaggregateTS/man/TempDisaggDGP.html'>TempDisaggDGP</a></span><span class='op'>(</span><span class='va'>n_l</span>,</span>
<span>                          <span class='va'>n</span>,</span>
<span>                          aggRatio <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                          p <span class='op'>=</span> <span class='va'>p_sim</span>,</span>
<span>                          rho <span class='op'>=</span> <span class='va'>rho_sim</span><span class='op'>)</span></span>
<span><span class='va'>Y_sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>Sim_data</span><span class='op'>$</span><span class='va'>Y_Gen</span><span class='op'>)</span> <span class='co'>#Extract the simulated dependent </span></span>
<span><span class='co'># (low-frequency) variable</span></span>
<span><span class='va'>X_sim</span> <span class='op'>&lt;-</span> <span class='va'>Sim_data</span><span class='op'>$</span><span class='va'>X_Gen</span> <span class='co'>#Extract the simulated exogenous variables - high-frequency</span></span></code></pre>
</div>
</div>
<p>In this case, we cannot use a standard technique, and we need to estimate a sparse model to overcome the curse of dimensionality. The <code>disaggregate()</code> function can handle the high-dimensional setting by choosing the method to be <code>"spTD"</code> or <code>"adaptive-spTD"</code>. In the following example, we use the latter:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig-res-sim-hds"></span>
<img src="RJ-2024-035_files/figure-html5/fig-res-sim-hds-1.png" alt="Temporal disaggregated and interpolated observations for the estimation under the high-dimensional setting. The plot is built using the snippet code provided in this subsection. As we used the setting `aggMat = sum`, the sum of every four disaggregated observations corresponds to an actual low-frequency observation." width="528" />
<p class="caption">
Figure 4: Temporal disaggregated and interpolated observations for the estimation under the high-dimensional setting. The plot is built using the snippet code provided in this subsection. As we used the setting <code>aggMat = sum</code>, the sum of every four disaggregated observations corresponds to an actual low-frequency observation.
</p>
</div>
</div>
<p>As we can see from both Figures <a href="#fig:fig-res-sim-cs">3</a> and <a href="#fig:fig-res-sim-hds">4</a>, the standard interpolation cannot reproduce the fluctuations of the data, making the result overly smooth. On the other hand, the temporal disaggregation methods demonstrate fluctuations in line with the actual observations. We remark that the degree of success in recovering the short-term fluctuations depends considerably on the setting, and as one may expect, performance is not as strong in the high-dimensional scenario where the estimator must simultaneously search for appropriate indicators and estimate the parameters.</p>
<p>We would in general caution against throwing sets of non-curated (i.e. possibly irrelevant) indicators into any of the Chow-Lin methods. Instead, we recommend that where possible, indicators that are designed to track the outcome of interest are used, e.g., we may wish to benchmark (align) monthly flash-indicators of GDP against more reliable yearly/quarterly observations, in this case, the flash estimates can be used as an indicator within a standard Chow-Lin approach. If there is a larger set of indicators which practitioners find hard to decide amongst, that is all indicators could be feasible from the practitioner view, then we recommend users may try the model-selection based <code>"spTD"</code>, and <code>"adaptive-spTD"</code> routines. In some settings, use of the classical Chow-Lin procedure becomes impossible due to the lack of low-frequency responses, in such settings it is necessary to either apply regularization or perform model-selection.</p>
<p>To conclude the simulation exercise, we present a set of statistics from 1,000 simulations for both the linearly interpolated and temporally disaggregated time series across the two simulation settings. The results are summarized in Table <a href="#tab:comparisons-html">1</a>. As it can be observed, the temporally disaggregated time series provides a much better representation of the real data’s level of dispersion, while interpolation consistently underestimates it. In terms of MSE and MAE, the findings are mixed: for the classic case, temporal disaggregation shows lower values for both metrics, whereas in the high-dimensional setting, the opposite trend is observed.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:comparisons-html">Table 1: </span>Mean and standard deviation (in parentheses) of key statistical measures for the high-frequency simulated observations, temporal disaggregated observations, and interpolated observations across 1000 Monte Carlo simulations. MAE and MSE are computed with respect to the high-frequency simulated observations.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:center;">
Classical_Obs
</th>
<th style="text-align:center;">
Classical_Temporal_Disaggregation
</th>
<th style="text-align:center;">
Classical_Interpolation
</th>
<th style="text-align:center;">
HighDim_Obs
</th>
<th style="text-align:center;">
HighDim_Temporal_Disaggregation
</th>
<th style="text-align:center;">
HighDim_Interpolation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Standard Deviation
</td>
<td style="text-align:center;">
2.716 (0.258)
</td>
<td style="text-align:center;">
2.888 (0.597)
</td>
<td style="text-align:center;">
1.488 (0.321)
</td>
<td style="text-align:center;">
10.089 (0.888)
</td>
<td style="text-align:center;">
8.478 (1.696)
</td>
<td style="text-align:center;">
4.18 (0.817)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kurtosis
</td>
<td style="text-align:center;">
2.897 (0.519)
</td>
<td style="text-align:center;">
2.902 (0.527)
</td>
<td style="text-align:center;">
2.689 (0.694)
</td>
<td style="text-align:center;">
2.898 (0.558)
</td>
<td style="text-align:center;">
2.890 (0.523)
</td>
<td style="text-align:center;">
2.892 (0.772)
</td>
</tr>
<tr>
<td style="text-align:left;">
MSE
</td>
<td style="text-align:center;">
<ul>
<li>(-)
</td>
<td style="text-align:center;">
2.405 (1.733)
</td>
<td style="text-align:center;">
5.158 (0.977)
</td>
<td style="text-align:center;">
<ul>
<li>(-)
</td>
<td style="text-align:center;">
104.463 (28.519)
</td>
<td style="text-align:center;">
86.095 (16.258)
</td>
</tr>
<tr>
<td style="text-align:left;">
MAE
</td>
<td style="text-align:center;">
<ul>
<li>(-)
</td>
<td style="text-align:center;">
1.185 (0.386)
</td>
<td style="text-align:center;">
1.809 (0.178)
</td>
<td style="text-align:center;">
<ul>
<li>(-)
</td>
<td style="text-align:center;">
8.136 (1.101)
</td>
<td style="text-align:center;">
7.403 (0.735)
</td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 data-number="5" id="Empirical-application"><span class="header-section-number">5</span> Empirical application</h2>
<p>In this Section, we show how temporal disaggregation can be used in a real-world problem.</p>
<p>The urgent need to address climate change has propelled the scientific community to explore innovative approaches to quantify and manage greenhouse gas (GHG) emissions. Carbon intensity, a crucial metric that measures the amount of carbon dioxide equivalent emitted per unit of economic activity (e.g. sales), plays a pivotal role in assessing the environmental sustainability of industries, countries, and global economies. By focusing on emissions per unit of economic output, carbon intensity accounts for the fact that larger organizations or economies may naturally produce more emissions simply due to scale. This allows for a fair comparison of sustainability performance across different entities, regardless of size. Accurate and timely carbon accounting and the development of robust measurement frameworks are essential for effective emission reduction strategies and the pursuit of sustainable development goals.
While carbon accounting frameworks offer valuable insights into emissions quantification, they are not without limitations. One of those limitations is the frequency with which this information is released, generally at an annual frequency, while most companies’ economic indicators are made public on a quarterly basis.
This is a perfect example in which temporal disaggregation can be used to bridge the gap between data availability and prompt economic and financial analyses. In this application, the variable of interest is the GHG emissions for IBM between Q3 2005 and Q3 2021, at annual frequency, resulting in 17 datapoints, i.e. <span class="math inline">\(Y\in \mathbb{R}^{17}\)</span>. For the high-frequency data, we used the balance sheet, income statement, and cash flow statement quarterly data between Q3 2005 and Q3 2021, resulting in 68 datapoints for the 128 variables. We remove variables that have a pairwise correlation higher than 0.99, resulting in a filtered dataset with 112 variables, i.e. <span class="math inline">\(X \in \mathbb{R}^{68\times 112}\)</span>. In this example, we employed the adaptive LASSO method (<code>method = "adaptive-spTD"</code>) as a way to select the best variables that can be used to recover the high-frequency observations and we applied the <code>aggMat = "sum"</code> aggregation method. The rationale for using this method, in conjunction with <code>aggRatio = 4</code> is to ensure that the disaggregated quarterly carbon intensity values are consistent with the overall annual figures as the goal is to break down the emissions and sales data such that the sum of the quarterly carbon intensities equals the yearly total. The adaptive LASSO procedure select only seven non-zero coefficients, which are Actual sales per employee, trailing 12-month net sales, Enterprise value, Current liabilities, total liabilities and equity, total line of credit and net debt. Actual sales per employee, trailing 12-month net sales and Enterprise value indicate company sales and size, both linked to the company’s economic activity, operational intensity, and commitment to sustainability, and hence potential emissions. Current liabilities and total liabilities and equity reflect the company’s financial position and operational scale, both of which might influence emissions. Total line of credit and net debt highlight the company’s ability to borrow, which could impact investment in emissions-reducing projects. We show the results in Figure <a href="#fig:fig-res">5</a> alongside a linear interpolation method.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig-res"></span>
<img src="RJ-2024-035_files/figure-html5/fig-res-1.png" alt="Temporal disaggregated and interpolated GHG emissions observations. In this example, we used the setting `aggMat = sum`, so the sum of the quarterly disaggregated GHG sums to the actual annual observation." width="528" />
<p class="caption">
Figure 5: Temporal disaggregated and interpolated GHG emissions observations. In this example, we used the setting <code>aggMat = sum</code>, so the sum of the quarterly disaggregated GHG sums to the actual annual observation.
</p>
</div>
</div>
<p>As it is possible to observe from the plot, the interpolated data do not fluctuate as we would expect from real GHG emissions, as the method is not conditional on the variability of the high-frequency variables. In this respect, the temporal disaggregated observations show more realistic dynamics. This result can then be used to compute the GHG intensity, computing the ratio between GHG emissions and the sales for the corresponding quarter.</p>
<h2 data-number="6" id="Summary"><span class="header-section-number">6</span> Summary</h2>
<p>In this paper, we have given an overview of the key functionality for the <a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a> R package. The package builds on features of the existing <a href="https://cran.r-project.org/package=tempdisagg">tempdisagg</a> package allowing the user to easily apply the regularized Chow-Lin type procedure of <span class="citation" data-cites="10-1111rssa-12952">Mosley et al. (<a href="#ref-10-1111rssa-12952" role="doc-biblioref">2022</a>)</span> and compare this with classical methods based on interpolation via smoothing <span class="citation" data-cites="denton1971adjustment">(e.g. <a href="#ref-denton1971adjustment" role="doc-biblioref">Denton 1971</a>)</span>, or the <span class="citation" data-cites="fernandez1981methodological">Fernández (<a href="#ref-fernandez1981methodological" role="doc-biblioref">1981</a>)</span> and <span class="citation" data-cites="fernandez1981methodological">Fernández (<a href="#ref-fernandez1981methodological" role="doc-biblioref">1981</a>)</span> methods in the case where series are not co-integrated. The package may be extended in future to allow cross-sectional constraints, the disaggregation of panel time-series data, and the accommodation of factor (latent-variable) structures in the temporal-disaggregation problem.</p>
<p>It is important to point out that when performing disaggregation, one should be careful to select an appropriate set of indicator time-series, and not purely rely on the model-selection procedures deployed here. Whilst these methods can help pick from a set of indicators, there is still room for them to pick irrelevant/spurious series, especially given the short nature of the aggregate series. To this end, we do not recommend just relying on one method alone, but rather a user deploy several methods of disaggregation. The user should then attempt to obtain some form of (potentially qualitative) external validation of the resultant series in their application of choice. One should always remember, that as the high-frequency series is not observed, there can be no direct empirical validation of the methods other than at the aggregate scale.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="6.1" id="supplementary-materials"><span class="header-section-number">6.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2024-035.zip">RJ-2024-035.zip</a></p>
<h3 class="appendix" data-number="6.2" id="cran-packages-used"><span class="header-section-number">6.2</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=DisaggregateTS">DisaggregateTS</a>, <a href="https://cran.r-project.org/package=tempdisagg">tempdisagg</a></p>
<h3 class="appendix" data-number="6.3" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">6.3</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=TimeSeries">TimeSeries</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-belloni2013least" class="csl-entry" role="listitem">
A. Belloni and V. Chernozhukov. Least squares after model selection in high-dimensional sparse models. <em>Bernoulli</em>, 19(2): 521–547, 2013.
</div>
<div id="ref-bournay1979reflexions" class="csl-entry" role="listitem">
J. Bournay and G. Laroque. R<span>é</span>flexions sur la m<span>é</span>thode d’elaboration des comptes trimestriels. In <em>Annales de l’INSEE</em>, pages. 3–30 1979. JSTOR.
</div>
<div id="ref-cholette1984adjusting" class="csl-entry" role="listitem">
P.-A. Cholette. Adjusting sub-annual series to yearly benchmarks. <em>Survey Methodology</em>, 10(1): 35–49, 1984.
</div>
<div id="ref-chow1971best" class="csl-entry" role="listitem">
G. C. Chow and A. Lin. Best linear unbiased interpolation, distribution, and extrapolation of time series by related series. <em>The review of Economics and Statistics</em>, 53(4): 372–375, 1971.
</div>
<div id="ref-chow1976best" class="csl-entry" role="listitem">
G. C. Chow and A.-L. Lin. Best linear unbiased estimation of missing observations in an economic time series. <em>Journal of the American Statistical Association</em>, 71(355): 719–721, 1976.
</div>
<div id="ref-cottrell2023gretl" class="csl-entry" role="listitem">
A. Cottrell and R. Lucchetti. <em><span class="nocase">Gretl User’s Guide: Gnu Regression, Econometrics and Time-series Library</span>.</em> 2023. URL <a href="https://gretl.sourceforge.net/gretl-help/gretl-guide.pdf">https://gretl.sourceforge.net/gretl-help/gretl-guide.pdf</a>. Accessed: 2023-10-08.
</div>
<div id="ref-dagum2006benchmarking" class="csl-entry" role="listitem">
E. B. Dagum and P. A. Cholette. <em>Benchmarking, temporal distribution, and reconciliation methods for time series.</em> Springer, 2006.
</div>
<div id="ref-denton1971adjustment" class="csl-entry" role="listitem">
F. T. Denton. Adjustment of monthly or quarterly series to annual totals: An approach based on quadratic minimization. <em>Journal of the american statistical association</em>, 66(333): 99–102, 1971.
</div>
<div id="ref-efron2004least" class="csl-entry" role="listitem">
B. Efron, T. Hastie, I. Johnstone and R. Tibshirani. Least angle regression. <em>The Annals of Statistics</em>, 32(2): 407–451, 2004.
</div>
<div id="ref-fernandez1981methodological" class="csl-entry" role="listitem">
R. B. Fernández. A methodological note on the estimation of time series. <em>The Review of Economics and Statistics</em>, 63(3): 471–476, 1981.
</div>
<div id="ref-fuleky2019macroeconomic" class="csl-entry" role="listitem">
P. Fuleky. <em>Macroeconomic forecasting in the era of big data: Theory and practice.</em> Springer, 2019.
</div>
<div id="ref-litterman1983random" class="csl-entry" role="listitem">
R. B. Litterman. A random walk, markov model for the distribution of time series. <em>Journal of Business &amp; Economic Statistics</em>, 1(2): 169–173, 1983.
</div>
<div id="ref-10-1111rssa-12952" class="csl-entry" role="listitem">
L. Mosley, I. A. Eckley and A. Gibberd. <span>Sparse Temporal Disaggregation</span>. <em>Journal of the Royal Statistical Society Series A: Statistics in Society</em>, 185(4): 2203–2233, 2022. URL <a href="https://doi.org/10.1111/rssa.12952">https://doi.org/10.1111/rssa.12952</a>.
</div>
<div id="ref-DisaggregateTS" class="csl-entry" role="listitem">
L. Mosley and K. S. Nobari. <em>DisaggregateTS: High-dimensional temporal disaggregation.</em> 2024. URL <a href="https://CRAN.R-project.org/package=DisaggregateTS">https://CRAN.R-project.org/package=DisaggregateTS</a>. R package version 3.0.1.
</div>
<div id="ref-quilis2018temporal" class="csl-entry" role="listitem">
E. M. Quilis. Temporal disaggregation of economic time series: The view from the trenches. <em>Statistica Neerlandica</em>, 72(4): 447–470, 2018.
</div>
<div id="ref-sax2013temporal2" class="csl-entry" role="listitem">
C. Sax and P. Steiner. Temporal disaggregation of time series. <em>The R Journal</em>, 5(2): 80–87, 2013.
</div>
<div id="ref-sax2016package" class="csl-entry" role="listitem">
C. Sax, P. Steiner and T. Di Fonzo. <em><span>“Tempdisagg”</span>: Methods for temporal disaggregation and interpolation of time series.</em> 2023. URL <a href="https://CRAN.R-project.org/package=tempdisagg">https://CRAN.R-project.org/package=tempdisagg</a>. R package version 1.1.1.
</div>
<div id="ref-schwarz1978estimating" class="csl-entry" role="listitem">
G. Schwarz. Estimating the dimension of a model. <em>The Annals of Statistics</em>, 6(2): 461–464, 1978.
</div>
<div id="ref-tibshirani1996regression" class="csl-entry" role="listitem">
R. Tibshirani. Regression shrinkage and selection via the lasso. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, 58(1): 267–288, 1996.
</div>
<div id="ref-van2011adaptive" class="csl-entry" role="listitem">
S. Van de Geer, P. Bühlmann and S. Zhou. The adaptive and the thresholded lasso for potentially misspecified models (and a lower bound for the lasso). <em>Electronic Journal of Statistics</em>, 5: 688–749, 2011.
</div>
<div id="ref-wainwright2019high" class="csl-entry" role="listitem">
M. J. Wainwright. <em>High-dimensional statistics: A non-asymptotic viewpoint.</em> Cambridge university press, 2019.
</div>
<div id="ref-zou2006adaptive" class="csl-entry" role="listitem">
H. Zou. The adaptive lasso and its oracle properties. <em>Journal of the American statistical association</em>, 101(476): 1418–1429, 2006.
</div>
</div>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>See <span class="citation" data-cites="dagum2006benchmarking">Dagum and Cholette (<a href="#ref-dagum2006benchmarking" role="doc-biblioref">2006</a>)</span> for an overview of benchmarking, interpolation, temporal distribution and calendarization techniques.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>For alternative aggregations see <span class="citation" data-cites="quilis2018temporal">Quilis (<a href="#ref-quilis2018temporal" role="doc-biblioref">2018</a>)</span> and <span class="citation" data-cites="sax2016package">Sax et al. (<a href="#ref-sax2016package" role="doc-biblioref">2023</a>)</span>. For instance, if quarterly values correspond to averages of monthly values, then the vector in equation <a href="#eq:flowData">(2)</a> assumes the form <span class="math inline">\((0.33,0.33,0.33)\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>noting the LARS algorithm produces solutions evaluated at a series of <span class="math inline">\(\{\lambda_l\}_{l=1}^k\)</span> points.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Mosley, et al., "Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package", The R Journal, 2025</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@article{RJ-2024-035,
  author = {Mosley, Luke and Nobari, Kaveh Salehzadeh and Brandi, Giuseppe and Gibberd, Alex},
  title = {Disaggregating Time-Series with Many Indicators: An Overview of the DisaggregateTS Package},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2024-035},
  doi = {10.32614/RJ-2024-035},
  volume = {16},
  issue = {4},
  issn = {2073-4859},
  pages = {62-73}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
