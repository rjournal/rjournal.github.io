<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>moonboot: An R Package Implementing m-out-of-n Bootstrap Methods</title>

  <meta property="description" itemprop="description" content="The m-out-of-n bootstrap is a possible workaround to compute&#10;confidence intervals for bootstrap inconsistent estimators, because it&#10;works under weaker conditions than the n-out-of-n bootstrap. It has&#10;the disadvantage, however, that it requires knowledge of an&#10;appropriate scaling factor tau(n) and that the coverage probability&#10;for finite n depends on the choice of m. This article presents an R&#10;package [**moonboot**](https://CRAN.R-project.org/package=moonboot)&#10;which implements the computation of m-out-of-n bootstrap confidence&#10;intervals and provides functions for estimating the parameters tau(n)&#10;and m. By means of Monte Carlo simulations, we evaluate the different&#10;methods and compare them for different estimators."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-10-24"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-10-24"/>
  <meta name="article:author" content="Christoph Dalitz"/>
  <meta name="article:author" content="Felix "/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="moonboot: An R Package Implementing m-out-of-n Bootstrap Methods"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="The m-out-of-n bootstrap is a possible workaround to compute&#10;confidence intervals for bootstrap inconsistent estimators, because it&#10;works under weaker conditions than the n-out-of-n bootstrap. It has&#10;the disadvantage, however, that it requires knowledge of an&#10;appropriate scaling factor tau(n) and that the coverage probability&#10;for finite n depends on the choice of m. This article presents an R&#10;package [**moonboot**](https://CRAN.R-project.org/package=moonboot)&#10;which implements the computation of m-out-of-n bootstrap confidence&#10;intervals and provides functions for estimating the parameters tau(n)&#10;and m. By means of Monte Carlo simulations, we evaluate the different&#10;methods and compare them for different estimators."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="moonboot: An R Package Implementing m-out-of-n Bootstrap Methods"/>
  <meta property="twitter:description" content="The m-out-of-n bootstrap is a possible workaround to compute&#10;confidence intervals for bootstrap inconsistent estimators, because it&#10;works under weaker conditions than the n-out-of-n bootstrap. It has&#10;the disadvantage, however, that it requires knowledge of an&#10;appropriate scaling factor tau(n) and that the coverage probability&#10;for finite n depends on the choice of m. This article presents an R&#10;package [**moonboot**](https://CRAN.R-project.org/package=moonboot)&#10;which implements the computation of m-out-of-n bootstrap confidence&#10;intervals and provides functions for estimating the parameters tau(n)&#10;and m. By means of Monte Carlo simulations, we evaluate the different&#10;methods and compare them for different estimators."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="moonboot: An R Package Implementing m-out-of-n Bootstrap Methods"/>
  <meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-031"/>
  <meta name="citation_pdf_url" content="RJ-2025-031.pdf"/>
  <meta name="citation_volume" content="17"/>
  <meta name="citation_issue" content="3"/>
  <meta name="citation_doi" content="10.32614/RJ-2025-031"/>
  <meta name="citation_journal_title" content="The R Journal"/>
  <meta name="citation_issn" content="2073-4859"/>
  <meta name="citation_firstpage" content="125"/>
  <meta name="citation_lastpage" content="139"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2025/10/24"/>
  <meta name="citation_publication_date" content="2025/10/24"/>
  <meta name="citation_author" content="Christoph Dalitz"/>
  <meta name="citation_author_institution" content="Niederrhein University of Applied Sciences"/>
  <meta name="citation_author" content="Felix "/>
  <meta name="citation_author_institution" content="Niederrhein University of Applied Sciences"/>
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Bootstrap confidence intervals;citation_volume=11;citation_author=Thomas J DiCiccio;citation_author=Bradley Efron"/>
  <meta name="citation_reference" content="citation_title=Theoretical comparison of bootstrap confidence intervals;citation_volume=16;citation_author=Peter Hall"/>
  <meta name="citation_reference" content="citation_title=Construction of confidence intervals;citation_publisher=Hochschule Niederrhein, Fachbereich Elektrotechnik und Informatik;citation_number=2017-01;citation_author=Christoph Dalitz"/>
  <meta name="citation_reference" content="citation_title=Bootstrap methods: Another look at the jackknife;citation_volume=7;citation_author=Bradley Efron"/>
  <meta name="citation_reference" content="citation_title=Bootstrap methods and their application;citation_publisher=Cambridge University Press;citation_author=A. C. Davison;citation_author=D. V. Hinkley"/>
  <meta name="citation_reference" content="citation_title=The jackknife and bootstrap;citation_publisher=Springer;citation_author=Jun Shao;citation_author=Dongsheng Tu"/>
  <meta name="citation_reference" content="citation_title=Bootstrapping general empirical measures;citation_author=Evarist Giné;citation_author=Joel Zinn"/>
  <meta name="citation_reference" content="citation_title=On the bootstrap in cube root asymptotics;citation_volume=34;citation_author=Christian Léger;citation_author=Brenda MacGibbon"/>
  <meta name="citation_reference" content="citation_title=Resampling fewer than n observations: Gains, losses, and remedies for losses;citation_volume=7;citation_author=Peter J Bickel;citation_author=Friedrich Götze;citation_author=Willem R Zwet"/>
  <meta name="citation_reference" content="citation_title=Large sample confidence regions based on subsamples under minimal assumptions;citation_volume=22;citation_doi=10.1214/aos/1176325770;citation_author=Dimitris N. Politis;citation_author=Joseph P. Romano"/>
  <meta name="citation_reference" content="citation_title=Subsampling;citation_publisher=Springer;citation_author=Dimitris N. Politis;citation_author=Joseph P. Romano;citation_author=Michael Wolf"/>
  <meta name="citation_reference" content="citation_title=Adaptive choice of bootstrap sample sizes;citation_volume=36 (State of the Art in Probability and Statistics);citation_author=Friedrich Götze;citation_author=Alfredas Račkauskas"/>
  <meta name="citation_reference" content="citation_title=On the choice of m in the m out of n bootstrap and confidence bounds for extrema;citation_volume=18;citation_author=Peter J Bickel;citation_author=Anat Sakov"/>
  <meta name="citation_reference" content="citation_title=Optimal bootstrap sample size in construction of percentile confidence bounds;citation_volume=28;citation_author=Kam-Hin Chung;citation_author=Stephen MS Lee"/>
  <meta name="citation_reference" content="citation_title=Bootstrap confidence regions based on M-estimators under nonstandard conditions;citation_volume=48;citation_author=Stephen MS Lee;citation_author=Puyudi Yang"/>
  <meta name="citation_reference" content="citation_title=On subsampling estimators with unknown rate of convergence;citation_volume=94;citation_author=Patrice Bertail;citation_author=Dimitris N Politis;citation_author=Joseph P Romano"/>
  <meta name="citation_reference" content="citation_title=A scalable bootstrap for massive data;citation_volume=76;citation_author=Ariel Kleiner;citation_author=Ameet Talwalkar;citation_author=Purnamrita Sarkar;citation_author=Michael I Jordan"/>
  <meta name="citation_reference" content="citation_title=On the asymptotic accuracy of the bootstrap under arbitrary resampling size;citation_volume=55;citation_author=Miguel A Arcones"/>
  <meta name="citation_reference" content="citation_title=Confidence intervals based on estimators with unknown rates of convergence;citation_volume=46;citation_author=Michael Sherman;citation_author=Edward Carlstein"/>
  <meta name="citation_reference" content="citation_title=A new coefficient of correlation;citation_volume=116;citation_doi=10.1080/01621459.2020.1758115;citation_author=Sourav Chatterjee"/>
  <meta name="citation_reference" content="citation_title=XICOR: Robust and generalized correlation coefficients;citation_author=Sourav Chatterjee;citation_author=Susan Holmes"/>
  <meta name="citation_reference" content="citation_title=On the failure of the bootstrap for Chatterjee’s rank correlation;citation_doi=10.1093/biomet/asae004;citation_author=Zhexiao Lin;citation_author=Fang Han"/>
  <meta name="citation_reference" content="citation_title=A simple bias reduction for Chatterjee’s correlation;citation_volume=18;citation_doi=10.1007/s42519-024-00399-y;citation_author=Christoph Dalitz;citation_author=Juliane Arning;citation_author=Steffen Goebbels"/>
  <meta name="citation_reference" content="citation_title=Limit theorems of Chatterjee’s rank correlation;citation_author=Zhexiao Lin;citation_author=Fang Han"/>
  <meta name="citation_reference" content="citation_title=Inconsistency of bootstrap: The Grenander estimator;citation_volume=38;citation_author=Bodhisattva Sen;citation_author=Moulinath Banerjee;citation_author=Michael Woodroofe"/>
  <meta name="citation_reference" content="citation_title=Robust estimators of location;citation_publisher=Princeton University Press;citation_author=D. F. Andrews;citation_author=P. J. Bickel;citation_author=F. R. Hampel;citation_author=P. J. Huber;citation_author=W. H. Rogers;citation_author=J. W. Tukey"/>
  <meta name="citation_reference" content="citation_title=Numerical recipes in C;citation_publisher=Cambridge University Press;citation_author=William H. Press;citation_author=Saul A. Teukolsky;citation_author=William T. Vetterling;citation_author=Brian P. Flannery"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","slug","citation_url","packages","preview","bibliography","CTV","legacy_pdf","legacy_converted","output","draft","pdf_url","doi","creative_commons","csl"]}},"value":[{"type":"character","attributes":{},"value":["moonboot: An R Package Implementing m-out-of-n Bootstrap Methods"]},{"type":"character","attributes":{},"value":["The m-out-of-n bootstrap is a possible workaround to compute\nconfidence intervals for bootstrap inconsistent estimators, because it\nworks under weaker conditions than the n-out-of-n bootstrap. It has\nthe disadvantage, however, that it requires knowledge of an\nappropriate scaling factor tau(n) and that the coverage probability\nfor finite n depends on the choice of m. This article presents an R\npackage [**moonboot**](https://CRAN.R-project.org/package=moonboot)\nwhich implements the computation of m-out-of-n bootstrap confidence\nintervals and provides functions for estimating the parameters tau(n)\nand m. By means of Monte Carlo simulations, we evaluate the different\nmethods and compare them for different estimators.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Christoph Dalitz"]},{"type":"character","attributes":{},"value":["Niederrhein University of Applied Sciences"]},{"type":"character","attributes":{},"value":["Institute for Pattern Recognition","Reinarzstr. 49","Germany","(ORCiD 0000-0002-7004-5584)","[christoph.dalitz@hs-niederrhein.de](christoph.dalitz@hs-niederrhein.de){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Felix "]},{"type":"character","attributes":{},"value":["Niederrhein University of Applied Sciences"]},{"type":"character","attributes":{},"value":["Institute for Pattern Recognition","Reinarzstr. 49","Germany\n"]}]}]},{"type":"character","attributes":{},"value":["2025-10-24"]},{"type":"character","attributes":{},"value":["2025-01-22"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[125]},{"type":"integer","attributes":{},"value":[139]}]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[3]},{"type":"character","attributes":{},"value":["RJ-2025-031"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-031"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["moonboot","XICOR"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["moonboot.bib"]},{"type":"list","attributes":{},"value":[]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","mathjax","md_extension"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"]},{"type":"character","attributes":{},"value":["-tex_math_single_backslash"]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["RJ-2025-031.pdf"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-031"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/estimate-tau-inconsistent.csv","data/estimate-tau.csv","data/mean-comparison-old.csv","data/mean-noonboot.csv","data/pcov-databased-m.csv","data/pcov-fixed-m-inconsistent.csv","data/pcov-fixed-m.csv","data/volatility-politis.csv","fig/goetze-max-n200-nosmooth.pdf","fig/goetze-max-n200-nosmooth.png","fig/goetze-max-n200-smooth.pdf","fig/goetze-max-n200-smooth.png","fig/mean-comparison-length.pdf","fig/mean-comparison-length.png","fig/mean-comparison-pcov.pdf","fig/mean-comparison-pcov.png","fig/pcov-databased-m-max.pdf","fig/pcov-databased-m-max.png","fig/pcov-databased-m-mean.pdf","fig/pcov-databased-m-mean.png","fig/pcov-databased-m-shorth.pdf","fig/pcov-databased-m-shorth.png","fig/pcov-databased-m-xicor.pdf","fig/pcov-databased-m-xicor.png","fig/pcov-fixed-m-shorth.pdf","fig/pcov-fixed-m-shorth.png","fig/pcov-fixed-m-xicor.pdf","fig/pcov-fixed-m-xicor.png","fig/volatility-shorth.pdf","fig/volatility-shorth.png","fig/volatility-xicor.pdf","fig/volatility-xicor.png","moonboot.bib","moonboot.tex","RJ-2025-031_files/anchor-4.2.2/anchor.min.js","RJ-2025-031_files/bowser-1.9.3/bowser.min.js","RJ-2025-031_files/distill-2.2.21/template.v2.js","RJ-2025-031_files/header-attrs-2.30/header-attrs.js","RJ-2025-031_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2025-031_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2025-031_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2025-031_files/popper-2.6.0/popper.min.js","RJ-2025-031_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2025-031_files/tippy-6.2.7/tippy-light-border.css","RJ-2025-031_files/tippy-6.2.7/tippy.css","RJ-2025-031_files/tippy-6.2.7/tippy.umd.min.js","RJ-2025-031_files/webcomponents-2.0.0/webcomponents.js","RJ-2025-031.zip","RJournal.sty","RJwrapper.bbl","RJwrapper.blg","RJwrapper.brf","RJwrapper.fdb_latexmk","RJwrapper.fls","RJwrapper.log","RJwrapper.out","RJwrapper.tex","scripts/estimate-tau-inconsistent.r","scripts/estimate-tau.r","scripts/estimate.tau.r","scripts/plot-goetze-max.r","scripts/plot-mean-comparison.r","scripts/plot-pcov-databased-m.r","scripts/plot-pcov-fixed-m.r","scripts/plot-volatility-politis.r","scripts/utils.r","scripts/volatility-politis.r","supplement/mean-noonboot.r","supplement/pcov-databased-m.r","supplement/pcov-fixed-inconsistent.r","supplement/pcov-fixed-m.r","supplement/utils.r"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="RJ-2025-031_files/header-attrs-2.30/header-attrs.js"></script>
  <script src="RJ-2025-031_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="RJ-2025-031_files/popper-2.6.0/popper.min.js"></script>
  <link href="RJ-2025-031_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="RJ-2025-031_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="RJ-2025-031_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="RJ-2025-031_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="RJ-2025-031_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="RJ-2025-031_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="RJ-2025-031_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      
      // Conditionally add supplementary files button
      document.addEventListener('DOMContentLoaded', () => {
        if (document.getElementById('supplementary-materials')) {
          // create element safely
          const btn_suppl = document.createElement('a');
          btn_suppl.href = slug + '.zip';
          btn_suppl.className = 'dt-tag';
          btn_suppl.innerHTML = '<i class="fas fa-file-zipper"></i> Supplement';
          buttons.append(btn_suppl);
        }
      });

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"moonboot: An R Package Implementing m-out-of-n Bootstrap Methods","description":"The m-out-of-n bootstrap is a possible workaround to compute\nconfidence intervals for bootstrap inconsistent estimators, because it\nworks under weaker conditions than the n-out-of-n bootstrap. It has\nthe disadvantage, however, that it requires knowledge of an\nappropriate scaling factor tau(n) and that the coverage probability\nfor finite n depends on the choice of m. This article presents an R\npackage [**moonboot**](https://CRAN.R-project.org/package=moonboot)\nwhich implements the computation of m-out-of-n bootstrap confidence\nintervals and provides functions for estimating the parameters tau(n)\nand m. By means of Monte Carlo simulations, we evaluate the different\nmethods and compare them for different estimators.","doi":"10.32614/RJ-2025-031","authors":[{"author":"Christoph Dalitz","authorURL":"#","affiliation":"Niederrhein University of Applied Sciences","affiliationURL":"#","orcidID":""},{"author":"Felix ","authorURL":"#","affiliation":"Niederrhein University of Applied Sciences","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-10-24T00:00:00.000+11:00","citationText":"Dalitz & Felix, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>moonboot: An R Package Implementing m-out-of-n Bootstrap Methods</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>The m-out-of-n bootstrap is a possible workaround to compute
confidence intervals for bootstrap inconsistent estimators, because it
works under weaker conditions than the n-out-of-n bootstrap. It has
the disadvantage, however, that it requires knowledge of an
appropriate scaling factor tau(n) and that the coverage probability
for finite n depends on the choice of m. This article presents an R
package <a href="https://CRAN.R-project.org/package=moonboot"><strong>moonboot</strong></a>
which implements the computation of m-out-of-n bootstrap confidence
intervals and provides functions for estimating the parameters tau(n)
and m. By means of Monte Carlo simulations, we evaluate the different
methods and compare them for different estimators.</p></p>
</div>

<div class="d-byline">
  Christoph Dalitz  (Niederrhein University of Applied Sciences)
  
,   Felix  (Niederrhein University of Applied Sciences)
  
<br/>2025-10-24
</div>

<div class="d-article">
<div class="article">
<h3 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h3>
<p>The bootstrap is a resampling method introduced by <span class="citation" data-cites="efron:1979">Efron (<a href="#ref-efron:1979" role="doc-biblioref">1979</a>)</span>, which
repeatedly simulates samples of the same size <span class="math inline">\(n\)</span> as the observed data
by <span class="math inline">\(n\)</span>-fold drawing with replacement. Let us call this method the
n-out-of-n bootstrap, in order to distinguish it from different sampling
schemes. For each of these samples, the estimator <span class="math inline">\(T\)</span> of interest is
computed, thereby simulating a sample <span class="math inline">\(T_1^*, \ldots, T_R^*\)</span> for the
distribution of <span class="math inline">\(T\)</span>, where <span class="math inline">\(R\)</span> is the number of bootstrap repetitions.
For sufficiently smooth estimators <span class="math inline">\(T\)</span>, this bootstrap distribution
asymptotically approaches the true distribution of <span class="math inline">\(T\)</span>
<span class="citation" data-cites="gine:1990 shao:1995">(<a href="#ref-gine:1990" role="doc-biblioref">Giné and Zinn 1990</a>; <a href="#ref-shao:1995" role="doc-biblioref">Shao and Tu 1995</a>)</span>, and it can thus be used to construct
confidence intervals for <span class="math inline">\(T\)</span>. The coverage probability of confidence
intervals based on flipping the quantiles of the bootstrapped
distribution <span class="math inline">\(T_1^*, \ldots, T_R^*\)</span> at the point estimate (“basic
bootstrap”) can be shown to be first order accurate, i.e. up to
<span class="math inline">\(O(n^{-1/2})\)</span>. Under certain conditions, it is even possible to make the
confidence intervals second order accurate, i.e. up to <span class="math inline">\(O(n^{-1})\)</span>, by
studentized sampling (“bootstrap-<span class="math inline">\(t\)</span>”) or accelerated bias correction
(“<span class="math inline">\(BC_a\)</span> bootstrap”) <span class="citation" data-cites="hall:1988 diciccio:1996 davison:1997">(<a href="#ref-hall:1988" role="doc-biblioref">Hall 1988</a>; <a href="#ref-diciccio:1996" role="doc-biblioref">DiCiccio and Efron 1996</a>; <a href="#ref-davison:1997" role="doc-biblioref">Davison and Hinkley 1997</a>)</span>.
Compared to other methods for estimating confidence intervals, the
bootstrap is more versatile because it neither relies on a likelihood
function, nor does it require asymptotic normality. The bootstrap has
thus become a standard technique for estimating confidence intervals,
and it is even included in vanilla R with the package <strong>boot</strong>
<span class="citation" data-cites="R:boot">(<a href="#ref-R:boot" role="doc-biblioref"><strong>R:boot?</strong></a>)</span>, which implements five different methods in <code>boot.ci()</code>.</p>
<p>There are, however, bootstrap inconsistent estimators, i.e., estimators
for which the n-out-of-n bootstrap fails to yield confidence intervals
with an asymptotically correct coverage probability. Examples include
extreme order statistics <span class="citation" data-cites="bickel:1997">(<a href="#ref-bickel:1997" role="doc-biblioref">Bickel et al. 1997</a>)</span>, the Grenander estimator of a
monotonous density <span class="citation" data-cites="sen:2010">(<a href="#ref-sen:2010" role="doc-biblioref">Sen et al. 2010</a>)</span>, Chernoff’s estimator of the mode and
Tukey’s shorth <span class="citation" data-cites="leger:2006">(<a href="#ref-leger:2006" role="doc-biblioref">Léger and MacGibbon 2006</a>)</span>, or Chatterjee’s rank correlation index
<span class="citation" data-cites="lin:2023 dalitz:2024">(<a href="#ref-dalitz:2024" role="doc-biblioref">Dalitz et al. 2024</a>; <a href="#ref-lin:2023" role="doc-biblioref">Lin and Han 2024</a>)</span>. See the discussion by <span class="citation" data-cites="lin:2023">Lin and Han (<a href="#ref-lin:2023" role="doc-biblioref">2024</a>)</span> for a
literature review and further examples. A possible workaround in these
cases is the m-out-of-n bootstrap, which samples only <span class="math inline">\(m&lt;n\)</span>
observations. This can be done with or without replacement.
<span class="citation" data-cites="politis:1994">Politis and Romano (<a href="#ref-politis:1994" role="doc-biblioref">1994</a>)</span>, who introduced this method, only considered sampling
without replacement, which they called subsampling. They have shown that
the m-out-of-n bootstrap without replacement works under much weaker
conditions than the n-out-of-n bootstrap, provided <span class="math inline">\(m\)</span> is chosen such
that, for <span class="math inline">\(n\to\infty\)</span>, <span class="math inline">\(m\to\infty\)</span> and <span class="math inline">\(m/n\to 0\)</span>. The only condition
is that the estimator, suitably scaled by some factor <span class="math inline">\(\tau_n\)</span>,
possesses a limit distribution, whereas no smoothness of the estimator
or uniformity of the convergence are required. If the sampling is
instead done with replacement, <span class="citation" data-cites="bickel:1997">(<a href="#ref-bickel:1997" role="doc-biblioref">Bickel et al. 1997</a>)</span> have shown that a similar
result requires additional restrictions on the estimator. Sampling
without replacement thus works under weaker conditions than sampling
with replacement, and, in the present article, we therefore only
consider sampling without replacement. Our package
<a href="https://CRAN.R-project.org/package=moonboot"><strong>moonboot</strong></a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> supports
sampling both with and without replacement by means of an argument
<code>replace</code>, which is set to <code>FALSE</code> by default.</p>
<p>The wider applicability of the m-out-of-n bootstrap comes at a price,
though. One drawback is that the scaling factor <span class="math inline">\(\tau_n\)</span> must be known.
<span class="citation" data-cites="bertail:1999">Bertail et al. (<a href="#ref-bertail:1999" role="doc-biblioref">1999</a>)</span> explained that it must be chosen such that
<span class="math inline">\(\tau_n^2 \operatorname{Var}(T)\)</span> converges to some constant, and they
also suggested a method to estimate the scaling factor with another
bootstrap. For root-<span class="math inline">\(n\)</span> consistent estimators, it is <span class="math inline">\(\tau_n=\sqrt{n}\)</span>,
but not all estimators are root-<span class="math inline">\(n\)</span> consistent, especially if they are
bootstrap inconsistent, and even if root-<span class="math inline">\(n\)</span> consistency is conjectured
it can be difficult to prove <span class="citation" data-cites="lin:2023">(<a href="#ref-lin:2023" role="doc-biblioref">Lin and Han 2024</a>)</span>. Moreover, the m-out-of-n
bootstrap can have less than first order accuracy: <span class="citation" data-cites="politis:1994">Politis and Romano (<a href="#ref-politis:1994" role="doc-biblioref">1994</a>)</span> gave a
theoretical example with accuracy <span class="math inline">\(O(n^{-1/3})\)</span> for an optimal choice of
<span class="math inline">\(m\)</span>, and even worse for other choices of <span class="math inline">\(m\)</span>. That the accuracy depends
on the choice of <span class="math inline">\(m\)</span> was demonstrated, too, in a simulation study by
<span class="citation" data-cites="kleiner:2014">Kleiner et al. (<a href="#ref-kleiner:2014" role="doc-biblioref">2014</a>)</span>. And for the sample quantiles and sampling with
replacement, <span class="citation" data-cites="arcones:2003">Arcones (<a href="#ref-arcones:2003" role="doc-biblioref">2003</a>)</span> has shown that the choice <span class="math inline">\(m\propto n^{2/3}\)</span>
is optimal. This raises the problem of how to choose <span class="math inline">\(m\)</span>, and several
heuristics have been suggested in the literature
<span class="citation" data-cites="politis:1999 goetze:2001 bickel:2008 chung:2001 lee:2020">(<a href="#ref-politis:1999" role="doc-biblioref">Politis et al. 1999</a>; <a href="#ref-chung:2001" role="doc-biblioref">Chung and Lee 2001</a>; <a href="#ref-goetze:2001" role="doc-biblioref">Götze and Račkauskas 2001</a>; <a href="#ref-bickel:2008" role="doc-biblioref">Bickel and Sakov 2008</a>; <a href="#ref-lee:2020" role="doc-biblioref">Lee and Yang 2020</a>)</span>.</p>
<p>Due to these shortcomings, the usual n-out-of-n bootstrap is generally
preferable for bootstrap consistent estimators. However, there <em>are</em>
bootstrap inconsistent estimators and there is thus need for an R
package that facilitates the application of the m-out-of-n bootstrap by
providing the required functions. To this end, we present a new package
<a href="https://CRAN.R-project.org/package=moonboot"><strong>moonboot</strong></a>, evaluate
the algorithms implemented therein by means of Monte Carlo simulations,
and give recommendations and use cases for their application. The name
of the package was inspired by an article by <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span>, who
abbreviated the m-out-of-n bootstrap as “moon bootstrap”.</p>
<h3 data-number="2" id="sec:moon-bootstrap"><span class="header-section-number">2</span> The m-out-of-n bootstrap</h3>
<p>Let <span class="math inline">\(X_1,\ldots,X_n\)</span> be i.i.d. random variables, <span class="math inline">\(\theta\)</span> be some
parameter of their underlying distribution, and
<span class="math inline">\(T_n=T_n(X_1,\ldots,X_n)\)</span> be an estimator for <span class="math inline">\(\theta\)</span>. Let us
additionally assume<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> that <span class="math inline">\(E(T_n^2)&lt;\infty\)</span>. The m-out-of-n bootstrap
requires that, for some scaling factor <span class="math inline">\(\tau_n\)</span> which behaves for
<span class="math inline">\(n\to\infty\)</span> as
<span class="math display" id="eq:tau">\[\label{eq:tau}
  \frac{\tau_{m(n)}}{\tau_n} \to 0 \quad for  \quad m(n)\to\infty \quad with \quad \frac{m(n)}{n}\to 0,   \tag{1}\]</span>
the estimator converges in distribution to some limit law when centered
around the true parameter <span class="math inline">\(\theta\)</span> and scaled with <span class="math inline">\(\tau_n\)</span>:
<span class="math display" id="eq:tscaled">\[\label{eq:tscaled}
  S_n = \tau_n (T_n - \theta) \;\stackrel{n\to\infty}{\longrightarrow}\; S \; in distribution   \tag{2}\]</span>
Note that condition (<a href="#eq:tau">(1)</a>) implies that <span class="math inline">\(\tau_n\to\infty\)</span>, and
thus the convergence (<a href="#eq:tscaled">(2)</a>) requires that <span class="math inline">\(T_n\)</span> converges
to <span class="math inline">\(\theta\)</span> in probability (in other words: <span class="math inline">\(T_n\)</span> must be consistent),
because it follows from (<a href="#eq:tscaled">(2)</a>) that
<span class="math display">\[P(|T_n-\theta|&gt;\varepsilon) = F_n(-\tau_n\varepsilon)+(1-F_n(\tau_n\varepsilon)) \;\stackrel{n\to\infty}{\longrightarrow}\; 0\]</span>
where <span class="math inline">\(F_n\)</span> is the cumulative distribution function of <span class="math inline">\(S_n\)</span>. Moreover,
if additionally the second moment of <span class="math inline">\(S_n\)</span> converges to some constant,
the scaling factor <span class="math inline">\(\tau_n\)</span> is related to the rate of decrease of the
variance of <span class="math inline">\(T_n\)</span>:
<span class="math display" id="eq:vartn">\[\label{eq:vartn}
  V = \lim_{n\to\infty} \operatorname{Var}(S_n) =
   \lim_{n\to\infty} \operatorname{Var}(\tau_n T_n)
\quad\Rightarrow\quad \operatorname{Var}(T_n) \sim \frac{V}{\tau_n^2} \quad for\quad n\to\infty   \tag{3}\]</span>
This relationship allows one to determine <span class="math inline">\(\tau_n\)</span> theoretically by
means of an analytical calculation, or to estimate it by means of Monte
Carlo simulations.</p>
<p><span class="citation" data-cites="politis:1994">Politis and Romano (<a href="#ref-politis:1994" role="doc-biblioref">1994</a>)</span> have shown that, under the assumptions (<a href="#eq:tscaled">(2)</a>)
and (<a href="#eq:tau">(1)</a>), a confidence interval with asymptotic coverage
probability <span class="math inline">\((1-\alpha)\)</span> can be constructed as
<span class="math display" id="eq:ci-m-out-of-n">\[\label{eq:ci-m-out-of-n}
  \left[ T_n - \frac{q(1-\alpha/2)}{\tau_n},\; T_n - \frac{q(\alpha/2)}{\tau_n} \right]   \tag{4}\]</span>
where <span class="math inline">\(q(1-\alpha/2)\)</span> and <span class="math inline">\(q(\alpha/2)\)</span> are the quantiles of the scaled
bootstrap distribution <span class="math inline">\(\tau_m(T_m^* - T_n)\)</span>, where <span class="math inline">\(T_m^*\)</span> denotes the
bootstrap samples obtained by <span class="math inline">\(m\)</span>-fold drawing without replacement. In
<strong>moonboot</strong>, this interval is implemented by
<code>mboot.ci(..., method="politis")</code>.</p>
<p>If the variance of <span class="math inline">\(S_n\)</span> converges to some value <span class="math inline">\(\sigma^2\)</span> and the
limiting distribution of <span class="math inline">\(S\)</span> is the <em>normal distribution</em> with standard
deviation <span class="math inline">\(\sigma\)</span>, then the m-out-of-n bootstrap can alternatively be
used to estimate the variance <span class="math inline">\(\sigma^2\)</span> and compute the standard
confidence interval
<span class="math display" id="eq:ci-norm">\[\label{eq:ci-norm}
  T_n \pm z_{1-\alpha/2}\,\hat{\sigma}_m^* \quad with\quad \hat{\sigma}_m^* = \frac{\tau_m}{\tau_n}\sqrt{\operatorname{Var}(T_m^*)}   \tag{5}\]</span>
In <strong>moonboot</strong>, this is implemented by <code>mboot.ci(..., method="norm")</code>.
Although this interval is only reasonable for asymptotically normal
estimators, its coverage probability can have a faster convergence to
the nominal value than the interval (<a href="#eq:ci-m-out-of-n">(4)</a>) provided
asymptotic normality indeed holds <span class="citation" data-cites="dalitz:2024">(<a href="#ref-dalitz:2024" role="doc-biblioref">Dalitz et al. 2024</a>)</span>.</p>
<p><span class="citation" data-cites="sherman:2004">Sherman and Carlstein (<a href="#ref-sherman:2004" role="doc-biblioref">2004</a>)</span> observed that the scaling with <span class="math inline">\(\tau_m/\tau_n\)</span> in
(<a href="#eq:ci-m-out-of-n">(4)</a>) can be omitted if the interval is centered
around one of the <span class="math inline">\(T_m\)</span> instead of <span class="math inline">\(T_n\)</span>. They suggested using the first
<span class="math inline">\(m\)</span> samples for computing <span class="math inline">\(T_m\)</span>, but this is an arbitrary choice and
thus even the location of the confidence interval is not uniquely
determined by the data. Moreover, the lack of scaling increases the
interval length. The greater length is compensated by the higher
volatility of the location so that the coverage probability still is
close to the nominal value. This does not hold, however, for drawing
without replacement as <span class="math inline">\(m\)</span> approaches <span class="math inline">\(n\)</span>, and a compromise must be made
between small interval length and approximate coverage probability.
<span class="citation" data-cites="sherman:2004">Sherman and Carlstein (<a href="#ref-sherman:2004" role="doc-biblioref">2004</a>)</span> suggested a heuristic method for choosing <span class="math inline">\(m\)</span> on the basis
of a double bootstrap, and they gave the rule of thumb to choose <span class="math inline">\(m\)</span>
between <span class="math inline">\(n^{1/2}\)</span> and <span class="math inline">\(n^{2/3}\)</span>. However, due to the greater interval
length, this method should only be used as a last resort if the
convergence rate <span class="math inline">\(\tau_n\)</span> is unknown and cannot be estimated from the
data. In <strong>moonboot</strong>, this method is implemented by
<code>mboot.ci(..., method="sherman")</code> and the method for estimating <span class="math inline">\(m\)</span> by
<code>estimate.m.sherman()</code>.</p>
<h4 class="unnumbered" data-number="2.1" id="estimation-of-tau_n">Estimation of <span class="math inline">\(\tau_n\)</span></h4>
<p>According to Eq. (<a href="#eq:vartn">(3)</a>), the formula for the scaling factor
<span class="math inline">\(\tau_n\)</span> can be determined by an analytic investigation of
<span class="math inline">\(\operatorname{Var}(T_n)\)</span>, which can not only be difficult for some
estimators, but it requires an ad hoc study of the specific estimator
<span class="math inline">\(T_n\)</span> under consideration. This thwarts the application of the
m-out-of-n bootstrap out-of-the-box.</p>
<p>Fortunately, the relationship (<a href="#eq:vartn">(3)</a>) makes it possible to
estimate <span class="math inline">\(\tau_n\)</span> by another bootstrap <span class="citation" data-cites="bertail:1999">(<a href="#ref-bertail:1999" role="doc-biblioref">Bertail et al. 1999</a>)</span>. If the variance
<span class="math inline">\(V_m=\operatorname{Var}(T_m^*)\)</span> is estimated by sampling with different
subsampling sizes <span class="math inline">\(m\)</span> and <span class="math inline">\(\tau_n\)</span> is assumed to be of the form
<span class="math inline">\(\tau_n=n^\beta\)</span>, then the asymptotic relationship (<a href="#eq:vartn">(3)</a>)
becomes
<span class="math display" id="eq:bertail">\[\label{eq:bertail}
  \log V_m \approx -2\beta\log m + \log V   \tag{6}\]</span>
and <span class="math inline">\(\beta\)</span> can be estimated with a least-squares fit. For the choice of
the test values <span class="math inline">\(m\)</span>, <span class="citation" data-cites="bertail:1999">Bertail et al. (<a href="#ref-bertail:1999" role="doc-biblioref">1999</a>)</span> suggested <span class="math inline">\(m_i=n^{\gamma_i}\)</span>, but
wrote that “the difficult problem of choosing the <span class="math inline">\(\gamma_i\)</span>’s requires
more work on a case-by-case basis”<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. This casts doubt on the whole
method, because removing the necessity of a detailed asymptotic analysis
of the estimator is the whole point of estimating <span class="math inline">\(\tau_n\)</span> from the
data. Indeed, we have not found a sequence of values for the <span class="math inline">\(\gamma_i\)</span>
that worked equally well in all of our examples. We thus leave the
choice of the <span class="math inline">\(\gamma\)</span>-sequence as an option to the user and use the
default of five values between <span class="math inline">\(0.2\)</span> and <span class="math inline">\(0.7\)</span>, which worked reasonably
well for some of our estimators.</p>
<p><span class="citation" data-cites="bertail:1999">(<a href="#ref-bertail:1999" role="doc-biblioref">Bertail et al. 1999</a>)</span> suggested the alternative of using quantiles instead of
the variance, but as the method involves taking logarithms, this makes
no sense when the estimator tends to be negative or close to zero. As a
workaround, <span class="citation" data-cites="politis:1999">(<a href="#ref-politis:1999" role="doc-biblioref">Politis et al. 1999</a>)</span> suggested replacing <span class="math inline">\(V_m\)</span> in
Eq. (<a href="#eq:bertail">(6)</a>) with the average of quantile ranges
<span class="math display">\[Q_m = \frac{1}{J}\sum_{j=1}^J \left( \operatorname{quantile}(T_m^*, \alpha^{high}_j) - \operatorname{quantile}(T_m^*, \alpha^{low}_j) \right)\]</span>
We have implemented this, too, with the choice
<span class="math inline">\(\alpha^{high}_j=0.75+j\cdot 0.05\)</span> and <span class="math inline">\(\alpha^{low}_j=0.25-j\cdot 0.05\)</span>
for <span class="math inline">\(j=0,\ldots,4\)</span>, but the results in section
<a href="#sec:results:tau" data-reference-type="ref" data-reference="sec:results:tau">4.1</a> show that this makes almost no difference
in comparison to using the variance.</p>
<p>This method is implemented in <strong>moonboot</strong> by <code>estimate.tau()</code>, which is
automatically called by <code>mboot.ci()</code> when no rate for the parameter
<code>tau</code> is provided.</p>
<figure id="fig:volatility">
<table>
<caption>
</caption>
<tbody>
<tr>
<td style="text-align: center;">
<img src="fig/volatility-xicor.png"
style="width:100.0%" alt="graphic without alt text" />
</td>
<td style="text-align: center;">
<img src="fig/volatility-shorth.png"
style="width:100.0%" alt="graphic without alt text" />
</td>
</tr>
<tr>
<td style="text-align: center;">
<ol type="1">
<li>xicor
</td>
<td style="text-align: center;">
<ol start="2" type="1">
<li>shorth
</td>
</tr>
</tbody>
</table>
<figcaption>
Figure 1: <span id="fig:volatility" data-label="fig:volatility"></span>Volatility index after <span class="citation" data-cites="politis:1999">Politis, Romano, and Wolf
(1999)</span> as a function of <span class="math inline"><em>m</em></span> for Chatterjee’s correlation
(<span><em>xicor</em></span>) and Tukey’s shorth for <span class="math inline"><em>n</em> = 1000</span>.
</figcaption>
</figure></li>
</ol></li>
</ol>
<h4 class="unnumbered" data-number="2.2" id="choice-of-m">Choice of <span class="math inline">\(m\)</span></h4>
<p>According to <span class="citation" data-cites="politis:1994">Politis and Romano (<a href="#ref-politis:1994" role="doc-biblioref">1994</a>)</span>, the m-out-of-n bootstrap asymptotically
works for any choice of <span class="math inline">\(m\)</span> satisfying <span class="math inline">\(m\to\infty\)</span> and <span class="math inline">\(m/n\to 0\)</span> as
<span class="math inline">\(n\to\infty\)</span>. This, however, leaves a wide range of choices,
e.g. <span class="math inline">\(m=cn^\beta\)</span> for any <span class="math inline">\(\beta\in (0,1)\)</span>, and the simulations in
section <a href="#sec:results" data-reference-type="ref" data-reference="sec:results">4</a>
show that the convergence rate of the coverage probability depends on
the choice of <span class="math inline">\(m\)</span>. It might thus be desirable to choose <span class="math inline">\(m\)</span> in a
data-dependent way, for which different methods have been suggested in
the literature
<span class="citation" data-cites="politis:1999 chung:2001 goetze:2001 bickel:2008 lee:2020">(<a href="#ref-politis:1999" role="doc-biblioref">Politis et al. 1999</a>; <a href="#ref-chung:2001" role="doc-biblioref">Chung and Lee 2001</a>; <a href="#ref-goetze:2001" role="doc-biblioref">Götze and Račkauskas 2001</a>; <a href="#ref-bickel:2008" role="doc-biblioref">Bickel and Sakov 2008</a>; <a href="#ref-lee:2020" role="doc-biblioref">Lee and Yang 2020</a>)</span>.</p>
<p><span class="citation" data-cites="politis:1999">Politis et al. (<a href="#ref-politis:1999" role="doc-biblioref">1999</a>, ch. 9.3.2)</span> suggested a <em>minimum volatility method</em> for
estimating <span class="math inline">\(m\)</span>, which is based on the idea that there should be some
range for <span class="math inline">\(m\)</span> where its choice has little effect on the estimated
confidence interval endpoints. The optimal <span class="math inline">\(m\)</span> is that with the lowest
“volatility” of the confidence interval, which is defined as the running
standard deviation of the interval endpoints around each specific choice
for <span class="math inline">\(m\)</span>. Before computing the standard deviation, the interval endpoints
should be smoothed out, too, by averaging over the endpoints computed
for the neighboring choices for <span class="math inline">\(m\)</span>.</p>
<p>The algorithm has two parameters, the window width <span class="math inline">\(h_{ci}\)</span> for
smoothing the interval end points and the window width <span class="math inline">\(h_\sigma\)</span> for
computing the running standard deviation. <span class="citation" data-cites="politis:1999">Politis et al. (<a href="#ref-politis:1999" role="doc-biblioref">1999</a>)</span> recommended
<span class="math inline">\(h_{ci}=h_\sigma=2\)</span> or <span class="math inline">\(3\)</span>, which corresponds to a range of <span class="math inline">\(5\)</span> or <span class="math inline">\(7\)</span>
values. To avoid finding a minimum that is too close to <span class="math inline">\(n\)</span>, as happens
in Fig. <a href="#fig:volatility" data-reference-type="ref" data-reference="fig:volatility">1</a>b, we have restricted the search range to
values <span class="math inline">\(m&lt;n/2\)</span>. For efficiency reasons, <span class="citation" data-cites="politis:1999">Politis et al. (<a href="#ref-politis:1999" role="doc-biblioref">1999</a>)</span> recommended not to
try every <span class="math inline">\(m\)</span>, but only a grid of equidistant values. Our implementation
in the function <code>estimate.m.volatility()</code> in the package <strong>moonboot</strong>
therefore only tries out a maximum of 50 values for <span class="math inline">\(m\)</span>.</p>
<p>The methods by <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span> and <span class="citation" data-cites="bickel:2008">Bickel and Sakov (<a href="#ref-bickel:2008" role="doc-biblioref">2008</a>)</span> are both based on
minimizing the distance between the distributions of <span class="math inline">\(S_m^*\)</span> and
<span class="math inline">\(S_{m&#39;}^*\)</span> for different choices <span class="math inline">\(m\)</span> and <span class="math inline">\(m&#39;\)</span> of the subsampling size.
As a distance measure, both articles utilized the Kolmogorov distance,
i.e., the maximum distance between the cumulative distribution
functions. The methods differ in the values that are tried out for <span class="math inline">\(m\)</span>
and <span class="math inline">\(m&#39;\)</span>: <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span> suggested searching the minimum among all values
for <span class="math inline">\(m\)</span> and <span class="math inline">\(m/2\)</span>, whereas <span class="citation" data-cites="bickel:2008">Bickel and Sakov (<a href="#ref-bickel:2008" role="doc-biblioref">2008</a>)</span> searched the minimum distance
between <span class="math inline">\(m_j\)</span> and <span class="math inline">\(m_{j+1}\)</span> for <span class="math inline">\(m_j=\lceil q^j n\rceil\)</span>, with the
recommendation to set <span class="math inline">\(q=0.75\)</span>. These methods are provided by
<strong>moonboot</strong> as <code>estimate.m(..., method="goetze")</code> and
<code>estimate.m(..., method="bickel")</code>, respectively.</p>
<figure id="fig:goetze-max">
<table>
<caption>
</caption>
<tbody>
<tr>
<td style="text-align: center;">
<img
src="fig/goetze-max-n200-nosmooth.png" style="width:100.0%"
alt="graphic without alt text" />
</td>
<td style="text-align: center;">
<img
src="fig/goetze-max-n200-smooth.png" style="width:100.0%"
alt="graphic without alt text" />
</td>
</tr>
<tr>
<td style="text-align: center;">
<ol type="1">
<li>single sample
</td>
<td style="text-align: center;">
<ol start="2" type="1">
<li>averaged over multiple samples
</td>
</tr>
</tbody>
</table>
<figcaption>
Figure 2: <span id="fig:goetze-max" data-label="fig:goetze-max"></span>Kolmogorov distance between the CDFs
of <span class="math inline"><em>S</em><sub><em>m</em></sub><sup><em></sup></span>
and <span
class="math inline"><em>S</em><sub><em>m</em>/2</sub><sup></em></sup></span>
for the estimator of the maximum of a uniform distribution with <span class="math inline"><em>n</em> = 200</span>. The left results are for a
single sampling per <span class="math inline"><em>m</em></span>, and the
right results for averaging over fivefold sampling.
</figcaption>
</figure></li>
</ol></li>
</ol>
<p>Trying out all combinations of <span class="math inline">\(m\)</span> and <span class="math inline">\(m/2\)</span>, as suggested by
<span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span>, has a runtime of order <span class="math inline">\(O(Rn^2)\)</span>, and it would thus be
preferable to use a more efficient minimum search like, e.g., a Golden
Section Search <span class="citation" data-cites="press:1992">(<a href="#ref-press:1992" role="doc-biblioref">Press et al. 1992</a>)</span>. Such algorithms, however, are devised for
deterministic functions, not for random functions. As can be seen in
Fig. <a href="#fig:goetze-max" data-reference-type="ref" data-reference="fig:goetze-max">2</a>, the Kolmogorov distance <span class="math inline">\(d(m,m/2)\)</span> between
two randomly sampled distributions scatters considerably and this is
only somewhat remedied by repeated sampling. This means that even the
usual initial bracketing process by going downhill with increasing step
size is unreliable when sampling from specific data, even if, on
average, the function actually has a non-boundary minimum<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. We
therefore stuck to the original suggestion by <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span> and have
implemented an exhaustive search over all even values for <span class="math inline">\(m\)</span>.</p>
<p>Two other methods have been suggested in the literature, which we have
not included in <strong>moonboot</strong>. <span class="citation" data-cites="chung:2001">Chung and Lee (<a href="#ref-chung:2001" role="doc-biblioref">2001</a>)</span> based their method on the
assumptions of root-n consistency and asymptotic normality of the
estimator. Although the assumption of root-n consistency might be
overcome by replacing factors <span class="math inline">\(n^{1/2}\)</span> with <span class="math inline">\(\tau_n\)</span> in the formulas,
the normality assumption is essential for that method because it is
based on an Edgeworth expansion. In our tests with non-normal
estimators, the coverage probabilities were very low and did not even
converge to the nominal value for large <span class="math inline">\(n\)</span>. <span class="citation" data-cites="lee:2020">Lee and Yang (<a href="#ref-lee:2020" role="doc-biblioref">2020</a>)</span> suggested using a
double bootstrap for estimating the coverage probability for different
values of <span class="math inline">\(m\)</span> and to choose the <span class="math inline">\(m\)</span> where this estimate is close to the
nominal value. In our experiments, however, the estimated coverage
probability based on an in-sample bootstrap was either way too low or
almost one and thus rarely close to the nominal value. For <em>xicor</em>, this
behavior was not even monotone in <span class="math inline">\(m\)</span>, which made the method difficult
to apply. Moreover, it has a runtime complexity of <span class="math inline">\(O(R^2 n^2)\)</span>, which
made Monte Carlo simulations for its evaluation infeasible.</p>
<h4 class="unnumbered" data-number="2.3" id="functions-provided-by-moonboot">Functions provided by <em>moonboot</em></h4>
<p>Like in the <strong>boot</strong> package, the computation of the confidence interval
is split into two steps: the sampling procedure for simulating the
bootstrap distribution <span class="math inline">\(T_m^*\)</span>, and the computation of the confidence
interval therefrom. Using the same interface makes it easy for a user to
switch between <strong>boot</strong> and <strong>moonboot</strong>. Moreover, this interface is
very flexible because it allows for statistics defined on complicated
data structures for which only the user knows how to do the
sub-indexing. The interface consists of the following two functions:</p>
<dl>
<dt><code>mboot(data, statistic, m, R=1000, replace=FALSE, ...)</code></dt>
<dd>
<p> <br />
Simulates the bootstrap distribution of the given estimator
<em>statistic</em>, which must have been defined as a function with two
arguments: <code>statistic(data, indices)</code>. For multidimensional data,
each row in <em>data</em> is assumed to be one data point. Additional
arguments are passed to <em>statistic</em>.</p>
</dd>
<dt><code>mboot.ci(boot, conf=0.95, tau=NULL, type=c("all", "basic", "norm"))</code></dt>
<dd>
<p> <br />
Estimates the confidence interval with
Eqs. (<a href="#eq:ci-m-out-of-n">(4)</a>) (“basic”) or (<a href="#eq:ci-norm">(5)</a>)
(“norm”). <em>tau</em> must be a function that computes <span class="math inline">\(\tau_n\)</span> from its
argument <span class="math inline">\(n\)</span>. If it is not provided, it is estimated with
<code>estimate.tau()</code> with the default settings of this function.
According to the results in Section
<a href="#sec:results:tau" data-reference-type="ref" data-reference="sec:results:tau">4.1</a>, this is not recommended, though, and
it is preferable to provide the correct value for <em>tau</em>.</p>
</dd>
</dl>
<p>Calling these functions requires knowledge of the scaling factor
<span class="math inline">\(\tau_n\)</span> and a choice for the subsample size <span class="math inline">\(m\)</span>. For the cases that
<span class="math inline">\(\tau_n\)</span> is not known or that <span class="math inline">\(m\)</span> shall be chosen in a data-based way,
two other functions are provided:</p>
<p><code>estimate.tau(data, statistic, R=1000, replace=FALSE, min.m=3,</code><br />
<code>             gamma=seq(0.2, 0.7, length.out=5), method="variance", ...)</code></p>
<p>:  <br />
Estimates the scaling factor with the method by <span class="citation" data-cites="bertail:1999">Bertail et al. (<a href="#ref-bertail:1999" role="doc-biblioref">1999</a>)</span>. The
values for <span class="math inline">\(m\)</span> are tried out as <span class="math inline">\(m_i=n^{\gamma_i}\)</span>. <em>min.m</em> is the
minimum sample size for which the statistic makes sense and can be
computed. The estimation is based on the scaling behavior of the
variance (<code>method="variance"</code>) or of the quantile ranges
(<code>method="quantile"</code>).</p>
<p><code>estimate.m(data, statistic, tau, R=1000, replace=FALSE, min.m=3,</code><br />
<code>           method="bickel", params=NULL, ...)</code></p>
<p>:  <br />
Estimates <span class="math inline">\(m\)</span> with the method by <span class="citation" data-cites="bickel:2008">(<a href="#ref-bickel:2008" role="doc-biblioref">Bickel and Sakov 2008</a>)</span> (<code>method="bickel"</code>),
the method by <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span> (<code>method="goetze"</code>), or with the
volatility index (<code>method="politis"</code>). <em>params</em> is a list that can
be used to pass additional parameters for the underlying method,
e.g. <code>params=list(q=0.75)</code> for the method by <span class="citation" data-cites="bickel:2008">(<a href="#ref-bickel:2008" role="doc-biblioref">Bickel and Sakov 2008</a>)</span>. <em>min.m</em>
is the minimum sample size for which the statistic makes sense and
can be computed.</p>
<h4 class="unnumbered" data-number="2.4" id="typical-usage">Typical usage</h4>
<p>Let us assume that you want to estimate a confidence interval for an
estimator <code>my.stat</code> on the basis of some data <code>x</code>. Then you must first
define a wrapper function that computes <code>my.stat</code> only for the data
selected according to the provided indices:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  boot.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, indices) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">my.stat</span>(dat[indices])</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>Without any knowledge about the asymptotic properties of <code>my.stat</code>, you
can estimate a 95% confidence interval with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  boot.out <span class="ot">&lt;-</span> <span class="fu">mboot</span>(x, boot.stat, <span class="at">m=</span><span class="fu">sqrt</span>(<span class="fu">NROW</span>(x)))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">mboot.ci</span>(boot.out, <span class="at">type=</span><span class="st">&quot;basic&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(ci)</span></code></pre></div>
<p>Beware that this automatically estimates the asymptotic convergence rate
<span class="math inline">\(1/\tau_n^2\)</span> of the variance of <code>my.stat</code> with the method by
<span class="citation" data-cites="bertail:1999">Bertail et al. (<a href="#ref-bertail:1999" role="doc-biblioref">1999</a>)</span>. It is thus better to provide this rate in the parameter
<code>tau</code>, if you happen to know it. For a root-n consistent estimator,
e.g., it is <span class="math inline">\(\tau_n=\sqrt{n}\)</span> and you can call <code>mboot.ci()</code> as
follows<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">mboot.ci</span>(boot.out, <span class="at">tau=</span><span class="cf">function</span>(n) { n<span class="sc">^</span><span class="fl">0.5</span> }, <span class="at">type=</span><span class="st">&quot;basic&quot;</span>)</span></code></pre></div>
<h3 data-number="3" id="sec:examples"><span class="header-section-number">3</span> Examples</h3>
<div id="tbl:models">
<table style="width:99%;">
<caption><span id="tab:T1">Table 1: </span> Tested estimators and data generation processes.
<span class="math inline">\(x=(x_1,\ldots,x_n)\)</span> and <span class="math inline">\(y=(y_1,\ldots,y_n)\)</span> are the simulated data
sets.</caption>
<colgroup>
<col style="width: 21%" />
<col style="width: 53%" />
<col style="width: 13%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><em>estimator</em> <span class="math inline">\(\hat{\theta}\)</span></th>
<th style="text-align: left;"><em>data model</em></th>
<th style="text-align: left;"><em>true</em> <span class="math inline">\(\theta\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\tau_n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>max(x)</code></td>
<td style="text-align: left;"><span class="math inline">\(x_i\sim\operatorname{unif}(0,1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>moonboot::shorth(x)</code></td>
<td style="text-align: left;"><span class="math inline">\(x_i\sim \operatorname{norm}(0,1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n^{1/3}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>XICOR::xicor(x,y)</code></td>
<td style="text-align: left;"><span class="math inline">\(x_i\sim\operatorname{unif}(-1,1)\)</span>, <span class="math inline">\(y_i\sim x_i+ \mathcal{N}(0,0.5)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(0.3818147\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>mean(x)</code></td>
<td style="text-align: left;"><span class="math inline">\(x_i\sim\operatorname{power(2,0,1)}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(3/4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sqrt{n}\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>In order to evaluate the implemented methods, we applied them to four
different estimators, three of which were bootstrap inconsistent. A
summary can be found in Tbl. <a href="#tab:T1" data-reference-type="ref" data-reference="tbl:models">1</a>, and the detailed description follows.
<span class="math inline">\(x_1,\ldots,x_n\)</span> denote the i.i.d. sample values drawn from the given
distributions.</p>
<h6 class="unnumbered" data-number="3.0.0.1" id="maximum-of-a-uniform-distribution-max.">Maximum of a uniform distribution (max).</h6>
<p>The maximum likelihood estimator for the upper bound of a uniform
distribution between zero and <span class="math inline">\(\theta\)</span> is
<span class="math inline">\(\hat{\theta}=\max\{x_1,\ldots,x_n\}\)</span>. This estimator was already given
by <span class="citation" data-cites="bickel:1997">Bickel et al. (<a href="#ref-bickel:1997" role="doc-biblioref">1997</a>)</span> as an example of a bootstrap inconsistent estimator. It
has the nice property that its probability density <span class="math inline">\(g(t)\)</span> can be readily
computed as
<span class="math display" id="eq:maxdist">\[\label{eq:max:dist}
  g(t) = \left\{\begin{array}{ll}
  n t^{n-1}\theta^{-n} &amp;  for 0\leq t\leq\theta \\ 0 &amp;  else
  \end{array}\right.   \tag{7}\]</span>
This estimator is neither root-n consistent, nor asymptotically normal.
The scaling factor <span class="math inline">\(\tau_n\)</span> can be computed from Eq. (<a href="#eq:maxdist">(7)</a>)
as
<span class="math display" id="eq:maxtau">\[\label{eq:max:tau}
  \operatorname{Var}(\hat{\theta}) = \theta^2\frac{n}{(n+2)(n+1)^2} \stackrel{n\to\infty}{\sim} \frac{\theta^2}{n^2} \quad\Rightarrow\quad \tau_n = n   \tag{8}\]</span></p>
<h6 class="unnumbered" data-number="3.0.0.2" id="tukeys-shorth-shorth.">Tukey’s Shorth (shorth).</h6>
<p>This is the mean of the data points in the shortest interval that
contains half of the data. For symmetric distributions with a strongly
unimodal density, <span class="citation" data-cites="andrews:1972">Andrews et al. (<a href="#ref-andrews:1972" role="doc-biblioref">1972 50ff</a>)</span> has shown that this estimator
is cube root consistent, i.e., <span class="math inline">\(\tau_n=n^{1/3}\)</span>. Bootstrap inconsistency
of the shorth was mentioned by <span class="citation" data-cites="leger:2006">Léger and MacGibbon (<a href="#ref-leger:2006" role="doc-biblioref">2006</a>)</span>. We have implemented this
estimator in <strong>moonboot</strong> as <code>shorth()</code> and applied it to normally
distributed data.</p>
<h6 class="unnumbered" data-number="3.0.0.3" id="chatterjees-rank-correlation-xicor.">Chatterjee’s rank correlation (xicor).</h6>
<p>This coefficient <span class="math inline">\(\xi_n\)</span> was introduced by <span class="citation" data-cites="chatterjee:2021">Chatterjee (<a href="#ref-chatterjee:2021" role="doc-biblioref">2021</a>)</span> as an
estimator for an index <span class="math inline">\(\xi(X,Y)\)</span> that is zero, if the two random
variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, and one, if <span class="math inline">\(Y\)</span> is a measurable
function of <span class="math inline">\(X\)</span>. For continuous <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, this is an interesting
example of a root-n consistent estimator <span class="citation" data-cites="lin:2022">(<a href="#ref-lin:2022" role="doc-biblioref">Lin and Han 2022</a>)</span> that is bootstrap
inconsistent <span class="citation" data-cites="lin:2023 dalitz:2024">(<a href="#ref-dalitz:2024" role="doc-biblioref">Dalitz et al. 2024</a>; <a href="#ref-lin:2023" role="doc-biblioref">Lin and Han 2024</a>)</span>. We have used the implementation
<code>xicor()</code> from the package
<a href="https://CRAN.R-project.org/package=XICOR"><strong>XICOR</strong></a> <span class="citation" data-cites="xicor_r">(<a href="#ref-xicor_r" role="doc-biblioref">Chatterjee and Holmes 2023</a>)</span> to
compute <span class="math inline">\(\xi_n\)</span>, and the function given by <span class="citation" data-cites="dalitz:2024">Dalitz et al. (<a href="#ref-dalitz:2024" role="doc-biblioref">2024</a>)</span> to compute
<span class="math inline">\(\xi(X,Y)\)</span> for the model <span class="math inline">\(X \sim Y + \varepsilon\)</span>, where <span class="math inline">\(\varepsilon\)</span>
is normally distributed with zero mean and <span class="math inline">\(\sigma=0.5\)</span>. Note that we
have used the original definition of <span class="math inline">\(\xi_n\)</span> by <span class="citation" data-cites="chatterjee:2021">Chatterjee (<a href="#ref-chatterjee:2021" role="doc-biblioref">2021</a>)</span>, not
the bias reduced form suggested by <span class="citation" data-cites="dalitz:2024">Dalitz et al. (<a href="#ref-dalitz:2024" role="doc-biblioref">2024</a>)</span>.</p>
<h6 class="unnumbered" data-number="3.0.0.4" id="mean-of-an-unsymmetric-distribution-mean.">Mean of an unsymmetric distribution (mean).</h6>
<p>The mean is a very well-behaved statistic: it is asymptotically normal,
root-n consistent and bootstrap consistent. It can thus serve as a
simple test case of how well the m-out-of-n bootstrap performs for
bootstrap consistent estimators. We have simulated data according to the
density <span class="math inline">\(f(x)=3x^2\)</span> for <span class="math inline">\(x\in [0,1]\)</span>, which was already used in a study
by <span class="citation" data-cites="dalitz:2017">Dalitz (<a href="#ref-dalitz:2017" role="doc-biblioref">2017</a>)</span>, and for which we have implemented the random number
generator <code>rpower()</code> in <strong>moonboot</strong>.</p>
<h3 data-number="4" id="sec:results"><span class="header-section-number">4</span> Results</h3>
<p>For all four estimators, we have evaluated the methods for estimating
<span class="math inline">\(\tau_n\)</span> and the different choices for <span class="math inline">\(m\)</span> in the m-out-of-n bootstrap
without replacement by means of Monte Carlo simulations. We have
computed confidence intervals with a nominal coverage probability
<span class="math inline">\(P_{cov}\)</span> of <span class="math inline">\(0.95\)</span> and estimated the actual coverage probability by
repeating the computation <span class="math inline">\(N=10^4\)</span> times. This means that the accuracy
(i.e. the width of a 95% confidence interval) of the estimated <span class="math inline">\(P_{cov}\)</span>
is about <span class="math inline">\(\pm 0.005\)</span>. Using a larger <span class="math inline">\(N\)</span> would have made the simulation
for the method by Goetze intractable. All simulations were done with
<span class="math inline">\(R=1000\)</span> bootstrap repetitions.</p>
<h4 class="unnumbered" data-number="4.1" id="sec:results:tau">Estimation of <span class="math inline">\(\tau_n\)</span></h4>
<div id="tbl:estimatetau">
<table style="width:98%;">
<caption><span id="tab:T2">Table 2: </span> Dependency of the estimation of <span class="math inline">\(\tau_n=n^\beta\)</span> on
the chosen endpoints for the sequence <span class="math inline">\(m_i=n^{\gamma_i}\)</span> and two
different values for <span class="math inline">\(n\)</span>. The better choice is marked in bold for each
estimator. The estimated values for the power <span class="math inline">\(\beta\)</span> in <span class="math inline">\(\tau_n\)</span> have
been averaged over 100 estimations.</caption>
<colgroup>
<col style="width: 8%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 19%" />
<col style="width: 4%" />
<col style="width: 17%" />
<col style="width: 4%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><em>method</em></th>
<th style="text-align: center;"><em>estimator</em></th>
<th style="text-align: center;"><em>true <span class="math inline">\(\beta\)</span></em></th>
<th style="text-align: center;"><span class="math inline">\((\gamma_1,\gamma_5)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(n\)</span></th>
<th style="text-align: right;"><em>estimated <span class="math inline">\(\beta\)</span></em></th>
<th style="text-align: center;"><span class="math inline">\(n\)</span></th>
<th style="text-align: right;"><em>estimated <span class="math inline">\(\beta\)</span></em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">variance</td>
<td style="text-align: center;">mean</td>
<td style="text-align: center;"><span class="math inline">\(0.5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mathbf{(0.2,0.5)}\)</span></td>
<td style="text-align: center;">100</td>
<td style="text-align: right;">0.4723</td>
<td style="text-align: center;">500</td>
<td style="text-align: right;">0.4870</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\((0.4,0.8)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.5964</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.5480</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">max</td>
<td style="text-align: center;"><span class="math inline">\(1.0\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0.2,0.5)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.6789</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.7730</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\mathbf{(0.4,0.8)}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.9595</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">1.0043</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">xicor</td>
<td style="text-align: center;"><span class="math inline">\(0.5\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0.2,0.5)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.1821</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.2945</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\mathbf{(0.4,0.8)}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.4914</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.5052</td>
</tr>
<tr class="odd">
<td style="text-align: center;">quantile</td>
<td style="text-align: center;">mean</td>
<td style="text-align: center;"><span class="math inline">\(0.5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mathbf{(0.2,0.5)}\)</span></td>
<td style="text-align: center;">100</td>
<td style="text-align: right;">0.5394</td>
<td style="text-align: center;">500</td>
<td style="text-align: right;">0.5164</td>
</tr>
<tr class="even">
<td style="text-align: center;">range</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\((0.4,0.8)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.6167</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.5600</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">max</td>
<td style="text-align: center;"><span class="math inline">\(1.0\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0.2,0.5)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.8355</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.8722</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\mathbf{(0.4,0.8)}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">1.1068</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">1.0872</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">xicor</td>
<td style="text-align: center;"><span class="math inline">\(0.5\)</span></td>
<td style="text-align: center;"><span class="math inline">\((0.2,0.5)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.0332</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.2128</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\mathbf{(0.4,0.8)}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.4880</td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.5171</td>
</tr>
</tbody>
</table>
</div>
<figure id="fig:pcov-fixed">
<table>
<caption>
</caption>
<tbody>
<tr>
<td style="text-align: center;">
<img src="fig/pcov-fixed-m-shorth.png"
style="width:100.0%" alt="graphic without alt text" />
</td>
<td style="text-align: center;">
<img src="fig/pcov-fixed-m-xicor.png"
style="width:100.0%" alt="graphic without alt text" />
</td>
</tr>
<tr>
<td style="text-align: center;">
<span>a. shorth</span>
</td>
<td style="text-align: center;">
<span>b. xicor</span>
</td>
</tr>
</tbody>
</table>
<figcaption>
Figure 3: <span id="fig:pcov-fixed" data-label="fig:pcov-fixed"></span>Coverage probability <span class="math inline"><em>P</em><sub><em>c</em><em>o</em><em>v</em></sub></span>
of the m-out-of-n bootstrap without replacement for the choices <span class="math inline"><em>m</em> = <em>n</em><sup><em>β</em></sup></span>
with <span class="math inline"><span class="math inline">\(\beta\in\{\frac{1}{2},\frac{1}{3},\frac{3}{4}\}\)</span></span>.
Note that the <span class="math inline"><em>n</em></span>-axis uses a
logarithmic scale.
</figcaption>
</figure>
<p>Our simulations confirmed that the choice for the extreme values of the
trial values <span class="math inline">\(m_i=n^{\gamma_i}\)</span> for <span class="math inline">\(i=1,\ldots,5\)</span> indeed influence the
accuracy of the estimation of <span class="math inline">\(\tau_n\)</span>. For the <em>mean</em> estimator, e.g.,
we achieved the best results for <span class="math inline">\(\gamma_1=0.2\)</span> and <span class="math inline">\(\gamma_5=0.5\)</span>,
whereas this choice was poor for <em>xicor</em> and <em>max</em> (see
Tbl. <a href="#tab:T2" data-reference-type="ref" data-reference="tbl:estimatetau">2</a>).
The results for estimation by means of the variance or quantile ranges
are similar. We thus conclude that it does not matter which method is
used. The results for <em>xicor</em>, however, are a warning that the
estimation of <span class="math inline">\(\tau_n\)</span> with the method by <span class="citation" data-cites="bertail:1999">(<a href="#ref-bertail:1999" role="doc-biblioref">Bertail et al. 1999</a>)</span> can be grossly
inaccurate, unless the range of the <span class="math inline">\(\gamma_i\)</span> has been luckily guessed.</p>
<h4 class="unnumbered" data-number="4.2" id="sec:results:m">Choice of <span class="math inline">\(m\)</span></h4>
<p>To see how the coverage probability depends on the choice of <span class="math inline">\(m\)</span>, we
have first used the fixed formula <span class="math inline">\(m=n^\beta\)</span> with different choices for
<span class="math inline">\(\beta\)</span>. The results in Fig. <a href="#fig:pcov-fixed" data-reference-type="ref" data-reference="fig:pcov-fixed">3</a> show that the coverage probability indeed
depends on the choice of <span class="math inline">\(m\)</span>. Moreover, the optimal choice for <span class="math inline">\(\beta\)</span>
depends on the estimator: <span class="math inline">\(\beta=1/3\)</span> was, e.g., a decent choice for
<em>shorth</em>, but a poor choice for <em>xicor</em>.</p>
<figure id="fig:pcov-databased">
<table>
<caption>
</caption>
<tbody>
<tr>
<td style="text-align: center;">
<img src="fig/pcov-databased-m-max.png"
style="width:100.0%" alt="graphic without alt text" />
</td>
<td style="text-align: center;">
<img
src="fig/pcov-databased-m-shorth.png" style="width:100.0%"
alt="graphic without alt text" />
</td>
</tr>
<tr>
<td style="text-align: center;">
<span>a. max</span>
</td>
<td style="text-align: center;">
<span>b. shorth</span>
</td>
</tr>
<tr>
<td style="text-align: center;">
<img
src="fig/pcov-databased-m-xicor.png" style="width:100.0%"
alt="graphic without alt text" />
</td>
<td style="text-align: center;">
<img src="fig/pcov-databased-m-mean.png"
style="width:100.0%" alt="graphic without alt text" />
</td>
</tr>
<tr>
<td style="text-align: center;">
<span>c. xicor</span>
</td>
<td style="text-align: center;">
<span>d. mean</span>
</td>
</tr>
</tbody>
</table>
<figcaption>
Figure 4: <span id="fig:pcov-databased" data-label="fig:pcov-databased"></span>Comparison of the three data
based methods for choosing <span class="math inline"><em>m</em></span>
in the m-out-of-n bootstrap without replacement. The upper plots show
the mean value <span class="math inline"><em>m</em>(<em>n</em>)</span>
together with error bars <span class="math inline">±sd (<em>m</em>)</span> and a least squares fit
<span class="math inline">log (<em>m</em>) = log (<em>c</em><em>n</em><sup><em>β</em></sup>)</span>.
The bottom plots show the resulting coverage probabilities. Note that
the <span class="math inline"><em>n</em></span>-axis uses a logarithmic
scale.
</figcaption>
</figure>
<p>The results for the data based methods for choosing <span class="math inline">\(m\)</span> are summarized
in Fig. <a href="#fig:pcov-databased" data-reference-type="ref" data-reference="fig:pcov-databased">4</a>. The method by <span class="citation" data-cites="politis:1999">Politis et al. (<a href="#ref-politis:1999" role="doc-biblioref">1999</a>)</span> cannot be
recommended, because the resulting coverage probability never approached
the nominal value in our simulations. For the <em>shorth</em>, it was only
about 0.7 even for high values of <span class="math inline">\(n\)</span>. For the other estimators, it was
somewhat greater, but nevertheless too small. This behavior can be
understood from the curves showing <span class="math inline">\(m(n)\)</span> in
Fig. <a href="#fig:pcov-databased" data-reference-type="ref" data-reference="fig:pcov-databased">4</a>: The method by <span class="citation" data-cites="politis:1999">Politis et al. (<a href="#ref-politis:1999" role="doc-biblioref">1999</a>)</span> always
chooses an <span class="math inline">\(m\)</span> proportional to <span class="math inline">\(n\)</span>, which means that the condition
<span class="math inline">\(\lim_{n\to\infty}m/n=0\)</span> is violated.</p>
<p>The methods according to <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span> and <span class="citation" data-cites="bickel:2008">Bickel and Sakov (<a href="#ref-bickel:2008" role="doc-biblioref">2008</a>)</span>, on the other
hand, both showed for all estimators a similar coverage probability
which approached the nominal value with increasing <span class="math inline">\(n\)</span>. The method by
<span class="citation" data-cites="bickel:2008">Bickel and Sakov (<a href="#ref-bickel:2008" role="doc-biblioref">2008</a>)</span> was slightly better for three of the four tested
estimators. It should be noted, though, that there was considerable
fluctuation in the estimated values for <span class="math inline">\(m\)</span>, as can be concluded from
the wide error bars in
Fig. <a href="#fig:pcov-databased" data-reference-type="ref" data-reference="fig:pcov-databased">4</a>. As the method by <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span> has a
much higher runtime of order <span class="math inline">\(O(Rn^2)\)</span>, the method by <span class="citation" data-cites="bickel:2008">Bickel and Sakov (<a href="#ref-bickel:2008" role="doc-biblioref">2008</a>)</span>,
which has a runtime of order <span class="math inline">\(O(Rn)\)</span>, is preferable from a runtime
perspective, too.</p>
<figure id="fig:comparison-noon">
<table>
<caption>
</caption>
<tbody>
<tr>
<td style="text-align: center;">
<img src="fig/mean-comparison-pcov.png"
style="width:100.0%" alt="graphic without alt text" />
</td>
<td style="text-align: center;">
<img
src="fig/mean-comparison-length.png" style="width:100.0%"
alt="graphic without alt text" />
</td>
</tr>
<tr>
<td style="text-align: center;">
<span>a. coverage
probability</span>
</td>
<td style="text-align: center;">
<span>b. average interval
length</span>
</td>
</tr>
</tbody>
</table>
<figcaption>
Figure 5: <span id="fig:comparison-noon" data-label="fig:comparison-noon"></span>Comparison of the m-out-of-n
bootstrap without replacement with the ordinary n-out-of-n (basic)
bootstrap for the bootstrap consistent estimator
<span><em>mean</em></span>. Note that the <span class="math inline"><em>n</em></span>-axis uses a logarithmic
scale.
</figcaption>
</figure>
<p>Out of curiosity, we have also compared the m-out-of-n bootstrap without
replacement with the ordinary n-out-of-n bootstrap for the estimator
<em>mean</em>, which is bootstrap consistent and thus allows for a comparison.
For bootstrap consistent estimators with additional smoothness
properties<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>, it was generally proven by <span class="citation" data-cites="bickel:1997">Bickel et al. (<a href="#ref-bickel:1997" role="doc-biblioref">1997</a>)</span> that estimates
based on the m-out-of-n bootstrap with or without replacement are less
efficient than those based on the n-out-of-n bootstrap. The mean is an
example of such an estimator. As can be seen in
Fig. <a href="#fig:comparison-noon" data-reference-type="ref" data-reference="fig:comparison-noon">5</a>, the m-out-of-n bootstrap is
competitive with the basic bootstrap only for large <span class="math inline">\(n\gtrsim 2000\)</span> and
a luckily chosen <span class="math inline">\(m\)</span>. For a data based choice of <span class="math inline">\(m\)</span> with the method by
<span class="citation" data-cites="bickel:2008">Bickel and Sakov (<a href="#ref-bickel:2008" role="doc-biblioref">2008</a>)</span>, the coverage probability is smaller, although the
difference in the interval length is small. This again demonstrates
that, for bootstrap consistent estimators, the usual n-out-of-n
bootstrap is preferable, especially because the best choice for <span class="math inline">\(m\)</span> is
not known, in general.</p>
<h3 data-number="5" id="violation-of-the-assumptions"><span class="header-section-number">5</span> Violation of the assumptions</h3>
<p>The assumptions (<a href="#eq:tau">(1)</a>) &amp; (<a href="#eq:tscaled">(2)</a>), under which the
m-out-of-n bootstrap works, are quite weak, but there are nevertheless
some estimators that violate these conditions. For example, inconsistent
estimators, i.e., estimators that do not converge in probability to the
true parameter value, violate the assumptions because consistency is a
necessary condition for the assumptions to hold, as shown in section
<a href="#sec:moon-bootstrap" data-reference-type="ref" data-reference="sec:moon-bootstrap">2</a>. Using <strong>moonboot</strong> in such a case is an
error on the side of the user, and if the user has determined the
scaling factor <span class="math inline">\(\tau_n\)</span> by an analysis of the estimator, he usually will
be aware of this. It might be, however, that a user relies on the fully
automated estimation of <span class="math inline">\(\tau_n\)</span> provided by <strong>moonboot</strong> and thus is
not aware of a violation of the assumptions.</p>
<p>We therefore have tested our package with two unbiased, yet inconsistent
estimators, too. Please note that these estimators are bizarre examples
and are not meant to be used in practice. The first estimator is only
the very first observation as an estimator for the mean <span class="math inline">\(\mu\)</span> of the
unsymmetric distribution <code>moonboot::dpower(..,2,0,1)</code>:
<span class="math display" id="eq:mu1">\[\label{eq:mu1}
  \hat{\mu}_1=X_1   \tag{9}\]</span>
The distribution of this estimator is the same for all sample sizes, and
the scaling factor is thus <span class="math inline">\(\tau_n\propto 1\)</span>, which fulfills condition
(<a href="#eq:tscaled">(2)</a>), but violates condition (<a href="#eq:tau">(1)</a>). The second
estimator estimates the parameter <span class="math inline">\(\lambda\)</span> of a Poisson distribution.
For a Poisson distribution, both mean and variance are <span class="math inline">\(\lambda\)</span>, which
allows for the construction of an unbiased estimator for <span class="math inline">\(\lambda\)</span> from
the unbiased estimators <span class="math inline">\(\overline{X}\)</span> for the mean and <span class="math inline">\(S^2\)</span> for the
variance as follows:
<span class="math display" id="eq:lambdan">\[\label{eq:lambdan}
  \hat{\lambda}_n = n\overline{X} - (n-1)S^2 = \sum_{i=1}^n X_i - \sum_{i=1}^n \left( X_i - \overline{X} \right)^2   \tag{10}\]</span>
As both <span class="math inline">\(\overline{X}\)</span> and <span class="math inline">\(S^2\)</span> are root-<span class="math inline">\(n\)</span> consistent estimators, the
scaling factor for condition (<a href="#eq:tscaled">(2)</a>) to hold is
<span class="math inline">\(\tau_n\propto n^{-1/2}\)</span>, which again is in violation of condition
(<a href="#eq:tau">(1)</a>).</p>
<p>As the assumptions (<a href="#eq:tau">(1)</a>) &amp; (<a href="#eq:tscaled">(2)</a>) are only
sufficient, but not necessary conditions for the m-out-of-n bootstrap,
we first estimated the coverage probability of the “basic” m-out-of-n
bootstrap interval when the correct scaling factor <span class="math inline">\(\tau_n\)</span> is provided.
For <span class="math inline">\(\hat{\mu}_1\)</span>, the coverage probability obviously neither depends on
<span class="math inline">\(n\)</span> nor on the subsampling size <span class="math inline">\(m\)</span>, and it turned out to be about
<span class="math inline">\(0.52\)</span> for a nominal <span class="math inline">\(0.95\)</span> interval. For <span class="math inline">\(\hat{\lambda}_n\)</span>, the
coverage probability decreased with increasing <span class="math inline">\(n\)</span> and was only about
<span class="math inline">\(0.17\)</span> for <span class="math inline">\(n=5000\)</span> and <span class="math inline">\(m=\sqrt{n}\)</span>. These results show that the
m-out-of-n bootstrap indeed does not work for these inconsistent
estimators.</p>
<p>We then estimated the scaling factors with <code>estimate.tau()</code> for <span class="math inline">\(n=100\)</span>
and <span class="math inline">\(n=500\)</span>, and, for all parameter settings, the mean estimates for
<span class="math inline">\(\beta\)</span> in <span class="math inline">\(\tau_n=n^\beta\)</span> were less than <span class="math inline">\(0.002\)</span> for <span class="math inline">\(\hat{\mu}_1\)</span> and
less than <span class="math inline">\(-0.40\)</span> for <span class="math inline">\(\hat{\lambda}_n\)</span>. This means that, for these
estimators, the violation of the assumptions can be automatically
detected due to suspiciously small estimated values for <span class="math inline">\(\beta\)</span>. In
order to make the user aware of this issue, <code>mboot.ci()</code> gives a warning
if <span class="math inline">\(\tau_n\)</span> decreases or if its increase is suspiciously small, i.e., if
it increases at a slower rate than <span class="math inline">\(n^{0.01}\)</span>.</p>
<h3 data-number="6" id="conclusions"><span class="header-section-number">6</span> Conclusions</h3>
<p>The <strong>moonboot</strong> package provides ready-to-run implementations of the
m-out-of-n bootstrap and methods for estimating its parameters. Our
simulations have shown that the quality of the data based method for
estimating the scaling factor <span class="math inline">\(\tau_n\)</span> is highly sensitive to a
parameter for which no universal recommendations can be made. It is thus
recommended to estimate <span class="math inline">\(\tau_n\)</span> by a different method, e.g., by model
based Monte Carlo simulations of the variance of the estimator and
estimating it by means of Eq. (<a href="#eq:vartn">(3)</a>). For a data based choice
of <span class="math inline">\(m\)</span>, the method by <span class="citation" data-cites="bickel:2008">Bickel and Sakov (<a href="#ref-bickel:2008" role="doc-biblioref">2008</a>)</span> as implemented in
<code>estimate.m(..., method="bickel")</code> can be recommended, according to our
simulations.</p>
<h3 class="unnumbered" id="acknowledgements">Acknowledgements</h3>
<p>We thank the anonymous reviewers for their valuable comments and for the
suggestion to investigate the case when the assumptions are violated.</p>
<p>:::::</p>
<h3 class="appendix" data-number="7" id="supplementary-materials"><span class="header-section-number">7</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-031.zip">RJ-2025-031.zip</a></p>
<h3 class="appendix" data-number="8" id="cran-packages-used"><span class="header-section-number">8</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=moonboot">moonboot</a>, <a href="https://cran.r-project.org/package=XICOR">XICOR</a></p>
<h3 class="appendix" data-number="9" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">9</span> CRAN Task Views implied by cited packages</h3>
<h3 class="appendix" data-number="10" id="note"><span class="header-section-number">10</span> Note</h3>
<p>This article is converted from a Legacy LaTeX article using the
<a href="https://cran.r-project.org/package=texor">texor</a> package.
The pdf version is the official version. To report a problem with the html,
refer to CONTRIBUTE on the R Journal homepage.</p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-andrews:1972" class="csl-entry" role="listitem">
D. F. Andrews, P. J. Bickel, F. R. Hampel, P. J. Huber, W. H. Rogers and J. W. Tukey. <em>Robust estimators of location.</em> Princeton, USA: Princeton University Press, 1972.
</div>
<div id="ref-arcones:2003" class="csl-entry" role="listitem">
M. A. Arcones. On the asymptotic accuracy of the bootstrap under arbitrary resampling size. <em>Annals of the Institute of Statistical Mathematics</em>, 55: 563–583, 2003.
</div>
<div id="ref-bertail:1999" class="csl-entry" role="listitem">
P. Bertail, D. N. Politis and J. P. Romano. On subsampling estimators with unknown rate of convergence. <em>Journal of the American Statistical Association</em>, 94(446): 569–579, 1999.
</div>
<div id="ref-bickel:1997" class="csl-entry" role="listitem">
P. J. Bickel, F. Götze and W. R. van Zwet. Resampling fewer than n observations: Gains, losses, and remedies for losses. <em>Statistica Sinica</em>, 7(1): 1–31, 1997.
</div>
<div id="ref-bickel:2008" class="csl-entry" role="listitem">
P. J. Bickel and A. Sakov. On the choice of m in the m out of n bootstrap and confidence bounds for extrema. <em>Statistica Sinica</em>, 18(3): 967–985, 2008.
</div>
<div id="ref-chatterjee:2021" class="csl-entry" role="listitem">
S. Chatterjee. A new coefficient of correlation. <em>Journal of the American Statistical Association</em>, 116(536): 2009–2022, 2021. DOI <a href="https://doi.org/10.1080/01621459.2020.1758115">10.1080/01621459.2020.1758115</a>.
</div>
<div id="ref-xicor_r" class="csl-entry" role="listitem">
S. Chatterjee and S. Holmes. <em><span>XICOR</span>: Robust and generalized correlation coefficients.</em> 2023. <span>R</span> package. <a href="https://CRAN.R-project.org/package=XICOR" class="uri">https://CRAN.R-project.org/package=XICOR</a>.
</div>
<div id="ref-chung:2001" class="csl-entry" role="listitem">
K.-H. Chung and S. M. Lee. Optimal bootstrap sample size in construction of percentile confidence bounds. <em>Scandinavian Journal of Statistics</em>, 28(1): 225–239, 2001.
</div>
<div id="ref-dalitz:2017" class="csl-entry" role="listitem">
C. Dalitz. Construction of confidence intervals. 2017-01, 15–28 pages. Hochschule Niederrhein, Fachbereich Elektrotechnik und Informatik. 2017.
</div>
<div id="ref-dalitz:2024" class="csl-entry" role="listitem">
C. Dalitz, J. Arning and S. Goebbels. A simple bias reduction for <span>C</span>hatterjee’s correlation. <em>Journal of Statistical Theory and Practice</em>, 18: 51, 2024. DOI <a href="https://doi.org/10.1007/s42519-024-00399-y">10.1007/s42519-024-00399-y</a>.
</div>
<div id="ref-davison:1997" class="csl-entry" role="listitem">
A. C. Davison and D. V. Hinkley. <em>Bootstrap methods and their application.</em> Cambridge University Press, 1997.
</div>
<div id="ref-diciccio:1996" class="csl-entry" role="listitem">
T. J. DiCiccio and B. Efron. Bootstrap confidence intervals. <em>Statistical Science</em>, 11(3): 189–228, 1996.
</div>
<div id="ref-efron:1979" class="csl-entry" role="listitem">
B. Efron. Bootstrap methods: Another look at the jackknife. <em>Annals of Statistics</em>, 7(1): 1–26, 1979.
</div>
<div id="ref-gine:1990" class="csl-entry" role="listitem">
E. Giné and J. Zinn. Bootstrapping general empirical measures. <em>The Annals of Probability</em>, 851–869, 1990.
</div>
<div id="ref-goetze:2001" class="csl-entry" role="listitem">
F. Götze and A. Račkauskas. Adaptive choice of bootstrap sample sizes. <em>Lecture Notes-Monograph Series</em>, 36 (State of the Art in Probability and Statistics): 286–309, 2001.
</div>
<div id="ref-hall:1988" class="csl-entry" role="listitem">
P. Hall. Theoretical comparison of bootstrap confidence intervals. <em>The Annals of Statistics</em>, 16(3): 927–953, 1988.
</div>
<div id="ref-kleiner:2014" class="csl-entry" role="listitem">
A. Kleiner, A. Talwalkar, P. Sarkar and M. I. Jordan. A scalable bootstrap for massive data. <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>, 76(4): 795–816, 2014.
</div>
<div id="ref-lee:2020" class="csl-entry" role="listitem">
S. M. Lee and P. Yang. Bootstrap confidence regions based on <span>M</span>-estimators under nonstandard conditions. <em>The Annals of Statistics</em>, 48(1): 274–299, 2020.
</div>
<div id="ref-leger:2006" class="csl-entry" role="listitem">
C. Léger and B. MacGibbon. On the bootstrap in cube root asymptotics. <em>Canadian Journal of Statistics</em>, 34(1): 29–44, 2006.
</div>
<div id="ref-lin:2022" class="csl-entry" role="listitem">
Z. Lin and F. Han. Limit theorems of <span>C</span>hatterjee’s rank correlation. 2022. Preprint. <a href="https://arxiv.org/abs/2204.08031" class="uri">https://arxiv.org/abs/2204.08031</a>.
</div>
<div id="ref-lin:2023" class="csl-entry" role="listitem">
Z. Lin and F. Han. On the failure of the bootstrap for <span>C</span>hatterjee’s rank correlation. <em>Biometrika</em>, asae004, 2024. DOI <a href="https://doi.org/10.1093/biomet/asae004">10.1093/biomet/asae004</a>.
</div>
<div id="ref-politis:1994" class="csl-entry" role="listitem">
D. N. Politis and J. P. Romano. Large sample confidence regions based on subsamples under minimal assumptions. <em>The Annals of Statistics</em>, 22(4): 2031–2050, 1994. DOI <a href="https://doi.org/10.1214/aos/1176325770">10.1214/aos/1176325770</a>.
</div>
<div id="ref-politis:1999" class="csl-entry" role="listitem">
D. N. Politis, J. P. Romano and M. Wolf. <em>Subsampling.</em> New York: Springer, 1999.
</div>
<div id="ref-press:1992" class="csl-entry" role="listitem">
W. H. Press, S. A. Teukolsky, W. T. Vetterling and B. P. Flannery. <em>Numerical recipes in <span>C</span>.</em> 2nd ed Cambridge, USA: Cambridge University Press, 1992.
</div>
<div id="ref-sen:2010" class="csl-entry" role="listitem">
B. Sen, M. Banerjee and M. Woodroofe. Inconsistency of bootstrap: The <span>G</span>renander estimator. <em>The Annals of Statistics</em>, 38(4): 1953–1977, 2010.
</div>
<div id="ref-shao:1995" class="csl-entry" role="listitem">
J. Shao and D. Tu. <em>The jackknife and bootstrap.</em> Springer, 1995.
</div>
<div id="ref-sherman:2004" class="csl-entry" role="listitem">
M. Sherman and E. Carlstein. Confidence intervals based on estimators with unknown rates of convergence. <em>Computational Statistics &amp; Data Analysis</em>, 46(1): 123–139, 2004.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>This article used version 2.0.x, available, e.g., from
<a href="https://github.com/cdalitz/moonboot" class="uri">https://github.com/cdalitz/moonboot</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="politis:1994">Politis and Romano (<a href="#ref-politis:1994" role="doc-biblioref">1994</a>)</span> did not make this assumption, but it is necessary
for the estimation of the scaling factor <span class="math inline">\(\tau_n\)</span> with the method by
<span class="citation" data-cites="bertail:1999">Bertail et al. (<a href="#ref-bertail:1999" role="doc-biblioref">1999</a>)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note that <span class="citation" data-cites="bertail:1999">Bertail et al. (<a href="#ref-bertail:1999" role="doc-biblioref">1999</a>)</span> wrote <span class="math inline">\(n^{\beta_i}\)</span> for the test values
<span class="math inline">\(m_i\)</span>, but we have renamed them to <span class="math inline">\(n^{\gamma_i}\)</span> to avoid confusion
with the power <span class="math inline">\(\beta\)</span> that is to be estimated.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Fig. 2 in the article by <span class="citation" data-cites="goetze:2001">Götze and Račkauskas (<a href="#ref-goetze:2001" role="doc-biblioref">2001</a>)</span> shows that even this is not
guaranteed, and the method can thus fail.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>It is more efficient to just set <code>tau=sqrt</code>, of course, but the
example uses a more complicated way for the sake of clarity.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Most notably that it is twice Fréchet differentiable.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Dalitz &amp; Felix, "moonboot: An R Package Implementing m-out-of-n Bootstrap Methods", The R Journal, 2025</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@article{RJ-2025-031,
  author = {Dalitz, Christoph and Felix, },
  title = {moonboot: An R Package Implementing m-out-of-n Bootstrap Methods},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2025-031},
  doi = {10.32614/RJ-2025-031},
  volume = {17},
  issue = {3},
  issn = {2073-4859},
  pages = {125-139}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
