<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools</title>

  <meta property="description" itemprop="description" content="This article introduces an R package, exvatools, that simplifies the analysis of trade in value added with  international input-output tables. It provides a full set of commands for data extraction, matrix creation and manipulation, decomposition  of value added in gross exports (using alternative methodologies)  and a straightforward calculation of many value added indicators.  It can handle both raw data from well-known public input-output databases and custom data. It has a wide sector and geographical flexibility and can be easily expanded and adapted to specific economic analysis needs, facilitating a better understanding and a wider use of the available statistical resources to study globalization."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2024-04-26"/>
  <meta property="article:created" itemprop="dateCreated" content="2024-04-26"/>
  <meta name="article:author" content="Enrique Feás"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This article introduces an R package, exvatools, that simplifies the analysis of trade in value added with  international input-output tables. It provides a full set of commands for data extraction, matrix creation and manipulation, decomposition  of value added in gross exports (using alternative methodologies)  and a straightforward calculation of many value added indicators.  It can handle both raw data from well-known public input-output databases and custom data. It has a wide sector and geographical flexibility and can be easily expanded and adapted to specific economic analysis needs, facilitating a better understanding and a wider use of the available statistical resources to study globalization."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools"/>
  <meta property="twitter:description" content="This article introduces an R package, exvatools, that simplifies the analysis of trade in value added with  international input-output tables. It provides a full set of commands for data extraction, matrix creation and manipulation, decomposition  of value added in gross exports (using alternative methodologies)  and a straightforward calculation of many value added indicators.  It can handle both raw data from well-known public input-output databases and custom data. It has a wide sector and geographical flexibility and can be easily expanded and adapted to specific economic analysis needs, facilitating a better understanding and a wider use of the available statistical resources to study globalization."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools"/>
  <meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2023-092"/>
  <meta name="citation_pdf_url" content="RJ-2023-092.pdf"/>
  <meta name="citation_volume" content="15"/>
  <meta name="citation_issue" content="4"/>
  <meta name="citation_doi" content="10.32614/RJ-2023-092"/>
  <meta name="citation_journal_title" content="The R Journal"/>
  <meta name="citation_issn" content="2073-4859"/>
  <meta name="citation_firstpage" content="216"/>
  <meta name="citation_lastpage" content="235"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2024/04/26"/>
  <meta name="citation_publication_date" content="2024/04/26"/>
  <meta name="citation_author" content="Enrique Feás"/>
  <meta name="citation_author_institution" content="Universidad de Alcalá and Elcano Royal Institute"/>
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Measuring Bilateral Trade in Terms of Value Added;citation_doi=10.2760/639612;citation_author=Iñaki Arto;citation_author=Erik Dietzenbacher;citation_author=José Manuel Rueda-Cantuche;citation_author=Measuring Bilateral Trade in Terms of Value Added;citation_author=10.2760/639612"/>
  <meta name="citation_reference" content="citation_title=Tracing Value-Added and Double Counting in Gross Exports;citation_volume=104;citation_doi=10.1257/aer.104.2.459;citation_issn=0002-8282;citation_author=Robert Koopman;citation_author=Zhi Wang;citation_author=Shang-Jin Wei"/>
  <meta name="citation_reference" content="citation_title=Decompr: Global Value Chain Decomposition in R;citation_publisher=Centre for Trade &amp; Economic Integration;citation_number=2015-01;citation_author=Bastiaan Quast;citation_author=Victor Kummritz"/>
  <meta name="citation_reference" content="citation_title=Tracing Value-Added and Double Counting in Gross Exports: Comment;citation_volume=106;citation_doi=10.1257/aer.20140883;citation_issn=0002-8282;citation_author=Bart Los;citation_author=Marcel P. Timmer;citation_author=Gaaitzen J. Vries"/>
  <meta name="citation_reference" content="citation_title=Accounting for the Differences Between Gross and Value Added Trade Balances;citation_volume=39;citation_doi=10.1111/twec.12401;citation_issn=1467-9701;citation_author=Arne J. Nagengast;citation_author=Robert Stehrer"/>
  <meta name="citation_reference" content="citation_title=Ioanalysis: Input Output Analysis;citation_author=John Wade;citation_author=Ignacio Sarmiento-Barbieri"/>
  <meta name="citation_reference" content="citation_title=Quantifying International Production Sharing at the Bilateral and Sector Levels;citation_publisher=National Bureau of Economic Research, Inc;citation_number=19677;citation_author=Zhi Wang;citation_author=Shang-Jin Wei;citation_author=Kunfu Zhu"/>
  <meta name="citation_reference" content="citation_title=Who produces for whom in the world economy?;citation_volume=44;citation_doi=10.1111/j.1540-5982.2011.01679.x;citation_issn=1540-5982;citation_author=Guillaume Daudin;citation_author=Christine Rifflart;citation_author=Danielle Schweisguth"/>
  <meta name="citation_reference" content="citation_title=Accounting for intermediates: Production sharing and trade in value added;citation_volume=86;citation_doi=10.1016/j.jinteco.2011.10.003;citation_issn=0022-1996;citation_author=Robert C. Johnson;citation_author=Guillermo Noguera"/>
  <meta name="citation_reference" content="citation_title=Measuring Bilateral Exports of Value Added: A Unified Framework;citation_publisher=NBER;citation_number=w24896;citation_doi=10.3386/w24896;citation_author=Bart Los;citation_author=Marcel P. Timmer"/>
  <meta name="citation_reference" content="citation_title=Decomposing Value Added in Gross Exports;citation_volume=33;citation_doi=10.1080/09535314.2020.1730308;citation_issn=0953-5314, 1469-5758;citation_author=Sébastien Miroudot;citation_author=Ming Ye"/>
  <meta name="citation_reference" content="citation_title=Measuring Global Value Chains;citation_volume=10;citation_doi=10.1146/annurev-economics-080217-053600;citation_issn=1941-1383, 1941-1391;citation_author=Robert C. Johnson"/>
  <meta name="citation_reference" content="citation_title=Icio: Economic analysis with intercountry input–output tables;citation_volume=21;citation_doi=10.1177/1536867X211045573;citation_issn=1536-867X, 1536-8734;citation_author=Federico Belotti;citation_author=Alessandro Borin;citation_author=Michele Mancini"/>
  <meta name="citation_reference" content="citation_title=Quantitative Input and Output Relations in the Economic System of the United States;citation_volume=18;citation_author=Wassily W. Leontief"/>
  <meta name="citation_reference" content="citation_title=Value added content of trade: A comprehensive approach;citation_volume=120;citation_doi=10.1016/j.econlet.2013.05.003;citation_issn=01651765;citation_author=Neil Foster-McGregor;citation_author=Robert Stehrer"/>
  <meta name="citation_reference" content="citation_title=An Illustrated User Guide to the World Input-Output Database: The Case of Global Automotive Production;citation_volume=23;citation_doi=10.1111/roie.12178;citation_issn=09657576;citation_author=Marcel P. Timmer;citation_author=Erik Dietzenbacher;citation_author=Bart Los;citation_author=Robert Stehrer;citation_author=Gaaitzen J. Vries"/>
  <meta name="citation_reference" content="citation_title=OECD Inter-Country Input-Output Database;citation_author=OECD Inter-Country Input-Output Database"/>
  <meta name="citation_reference" content="citation_title=Building Eora: A Global Multi-Region Input–Output Database at High Country and Sector Resolution;citation_volume=25;citation_doi=10.1080/09535314.2013.769938;citation_issn=0953-5314, 1469-5758;citation_author=Manfred Lenzen;citation_author=Daniel Moran;citation_author=Keiichiro Kanemoto;citation_author=Arne Geschke"/>
  <meta name="citation_reference" content="citation_title=Multiregional Input-Output Database (ADB-MRIO);citation_author=Multiregional Input-Output Database (ADB-MRIO)"/>
  <meta name="citation_reference" content="citation_title=Stata Statistical Software: Release 17;citation_publisher=StataCorp LLC;citation_author=Stata Statistical Software: Release 17"/>
  <meta name="citation_reference" content="citation_title=Measuring what matters in value-added trade;citation_doi=10.1080/09535314.2022.2153221;citation_issn=0953-5314, 1469-5758;citation_author=Alessandro Borin;citation_author=Michele Mancini"/>
  <meta name="citation_reference" content="citation_title=EU inter-country supply, use and input-output tables: Full international and global accounts for research in input output analysis (FIGARO): 2019 edition.;citation_publisher=EU Publications Office;citation_doi=10.2785/008780"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","type","preamble","output","bibliography","always_allow_html","date_received","volume","issue","slug","journal","draft","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl","date"]}},"value":[{"type":"character","attributes":{},"value":["exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools"]},{"type":"character","attributes":{},"value":["This article introduces an R package, exvatools, that simplifies the analysis of trade in value added with  international input-output tables. It provides a full set of commands for data extraction, matrix creation and manipulation, decomposition  of value added in gross exports (using alternative methodologies)  and a straightforward calculation of many value added indicators.  It can handle both raw data from well-known public input-output databases and custom data. It has a wide sector and geographical flexibility and can be easily expanded and adapted to specific economic analysis needs, facilitating a better understanding and a wider use of the available statistical resources to study globalization.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Enrique Feás"]},{"type":"character","attributes":{},"value":["Universidad de Alcalá and Elcano Royal Institute"]},{"type":"character","attributes":{},"value":["Universidad de Alcalá, Pl. de San Diego, s/n, 28801 Alcalá de Henares, Madrid, Spain","Elcano Royal Institute, Calle del Príncipe de Vergara, 51. 28006 Madrid, Spain"]},{"type":"character","attributes":{},"value":["0000-0002-9431-6051"]},{"type":"character","attributes":{},"value":["enrique.feas@edu.uah.es, efeas@rielcano.org"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["\\usepackage{amsmath} \\usepackage{framed} \\usepackage{mathtools} \\usepackage{cancel} \\usepackage{tikz} \\usepackage{tikz-qtree} \\usetikzlibrary{trees}\n"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["exvatools.bib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2023-04-20"]},{"type":"integer","attributes":{},"value":[15]},{"type":"integer","attributes":{},"value":[4]},{"type":"character","attributes":{},"value":["RJ-2023-092"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[216]},{"type":"integer","attributes":{},"value":[235]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["RJ-2023-092.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2023-092"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2023-092"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["exvatools","ioanalysis","decompr"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["Econometrics"]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/sitelib-4.4-arm64/rjtools/rjournal.csl"]},{"type":"character","attributes":{},"value":["04-26-2024"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["exvatools_files/figure-latex/decomposition-1.pdf","exvatools.bib","exvatools.log","exvatools.tex","RJ-2023-092.log","RJ-2023-092.pdf","RJ-2023-092.tex","RJournal.sty","RJwrapper.aux","RJwrapper.log","RJwrapper.out","RJwrapper.tex","Rlogo-5.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="RJ-2023-092_files/header-attrs-2.25/header-attrs.js"></script>
  <script src="RJ-2023-092_files/kePrint-0.0.1/kePrint.js"></script>
  <link href="RJ-2023-092_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="RJ-2023-092_files/htmlwidgets-1.6.4/htmlwidgets.js"></script>
  <script src="RJ-2023-092_files/viz-1.8.2/viz.js"></script>
  <link href="RJ-2023-092_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
  <script src="RJ-2023-092_files/grViz-binding-1.0.11/grViz.js"></script>
  <script src="RJ-2023-092_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="RJ-2023-092_files/popper-2.6.0/popper.min.js"></script>
  <link href="RJ-2023-092_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="RJ-2023-092_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="RJ-2023-092_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="RJ-2023-092_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="RJ-2023-092_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="RJ-2023-092_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="RJ-2023-092_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").first();
      if (tpar && ! tpar.hasClass("subtitle")) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools","description":"This article introduces an R package, exvatools, that simplifies the analysis of trade in value added with  international input-output tables. It provides a full set of commands for data extraction, matrix creation and manipulation, decomposition  of value added in gross exports (using alternative methodologies)  and a straightforward calculation of many value added indicators.  It can handle both raw data from well-known public input-output databases and custom data. It has a wide sector and geographical flexibility and can be easily expanded and adapted to specific economic analysis needs, facilitating a better understanding and a wider use of the available statistical resources to study globalization.","doi":"10.32614/RJ-2023-092","authors":[{"author":"Enrique Feás","authorURL":"#","affiliation":"Universidad de Alcalá and Elcano Royal Institute","affiliationURL":"#","orcidID":"0000-0002-9431-6051"}],"publishedDate":"2024-04-26T00:00:00.000+12:00","citationText":"Feás, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>This article introduces an R package, exvatools, that simplifies the analysis of trade in value added with international input-output tables. It provides a full set of commands for data extraction, matrix creation and manipulation, decomposition of value added in gross exports (using alternative methodologies) and a straightforward calculation of many value added indicators. It can handle both raw data from well-known public input-output databases and custom data. It has a wide sector and geographical flexibility and can be easily expanded and adapted to specific economic analysis needs, facilitating a better understanding and a wider use of the available statistical resources to study globalization.</p></p>
</div>

<div class="d-byline">
  Enrique Feás  (Universidad de Alcalá and Elcano Royal Institute)
  
<br/>04-26-2024
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>The analysis of trade in value added involves the use of international
input-output tables and intensive matrix manipulation. Some trade databases,
such as the OECD Trade in Value Added Database (TiVA), offer a web interface,
but cannot be customized and lack some key indicators developed in recent
literature, especially indicators of bilateral trade in value added and
participation in global value chains. This makes recourse to raw data almost
inevitable and creates the need for software capable of performing complex
matrix analysis in a user-friendly environment.</p>
<p>This is the gap <a href="https://cran.r-project.org/package=exvatools">exvatools</a> pretends to fill. It has been designed as a
package for <strong>R</strong> with a triple purpose: as an international input-output table
general analysis tool (with commands to extract raw data and produce and
manipulate large matrices), as a way to decompose value added in exports using
alternative methodologies, and as a tool to easily produce complex tailor-made
value added indicators with flexible sector and geographical customization.</p>
<p>To our knowledge, there are no equivalent software tools available. There are
some input-out analysis tools, like <a href="https://cran.r-project.org/package=ioanalysis">ioanalysis</a>
<span class="citation" data-cites="wade_ioanalysis_2020">(<a href="#ref-wade_ioanalysis_2020" role="doc-biblioref">Wade and Sarmiento-Barbieri 2020</a>)</span>, but they cannot properly handle OECD’s ICIO-type data
(with some countries divided in industrial areas). The package <a href="https://cran.r-project.org/package=decompr">decompr</a>
<span class="citation" data-cites="quast_decompr_2015">(<a href="#ref-quast_decompr_2015" role="doc-biblioref">Quast and Kummritz 2015</a>)</span> produces a decomposition of value added in exports, but
only according to the methodology of <span class="citation" data-cites="wang_quantifying_2013">Wang et al. (<a href="#ref-wang_quantifying_2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>Outside of the <strong>R</strong> ecosystem, the module <code>icio</code> <span class="citation" data-cites="belotti_icio_2021">(<a href="#ref-belotti_icio_2021" role="doc-biblioref">Belotti et al. 2021</a>)</span> for the
software <strong>Stata</strong> <span class="citation" data-cites="statacorp_stata_2021">(<a href="#ref-statacorp_stata_2021" role="doc-biblioref">StataCorp 2021</a>)</span> provides the more modern (and
methodologically sounder) decomposition method of <span class="citation" data-cites="borin_measuring_2023">Borin and Mancini (<a href="#ref-borin_measuring_2023" role="doc-biblioref">2023</a>)</span>.
However, <code>icio</code> is a closed-source module, it does not allow complex sector
analysis and customization, direct handling of input-output tables nor detailed
decompositions (for instance, distinguishing between value added exported
induced by inputs and by final goods).</p>
<p><a href="https://cran.r-project.org/package=exvatools">exvatools</a> can therefore be used as all-purpose tool, both to
facilitate the extraction and manipulation of input-output matrices and to
obtain detailed and customized indicators of trade in value added, facilitating
research on global value chains, globalization, and its economic effects. In the
following sections, we will describe the methodological background of
<a href="https://cran.r-project.org/package=exvatools">exvatools</a>, in particular the international input-output table
framework and its use to calculate value added induced by gross exports. Then we
will explain the creation of the three basic objects of <a href="https://cran.r-project.org/package=exvatools">exvatools</a>: a
list of basic input-output tables (the <code>wio</code> class), a list with the different
matrix components of a decomposition of value added in exports (the <code>exvadec</code>
class) and a list with a detailed origin and destination of value added (the
<code>exvadir</code> class). We will then explain the commands to fully exploit the
information included in the aforementioned classes. Along the way we will
produce examples of use.</p>
<p><a href="https://cran.r-project.org/package=exvatools">exvatools</a> can be installed from the CRAN repository and made
available for the current session following the usual procedure:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"exvatools"</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>exvatools</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 data-number="2" id="background-methodology"><span class="header-section-number">2</span> Background methodology</h2>
<h3 data-number="2.1" id="the-international-input-output-framework"><span class="header-section-number">2.1</span> The international input-output framework</h3>
<p>Analyzing the value added in exports requires the previous extraction of a
series of basic input-output matrices in a standardized format. We will consider
a typical international input-output framework with <span class="math inline">\(G\)</span> countries and <span class="math inline">\(N\)</span>
sectors. Each country <span class="math inline">\(s\)</span> provides goods and services from each sector <span class="math inline">\(i\)</span> to
each sector <span class="math inline">\(j\)</span> in country <span class="math inline">\(r\)</span>, and sources its goods and services from the
sectors of each country <span class="math inline">\(t\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Output
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Intermediate uses
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Final uses
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Output
</div>
</th>
</tr>
</thead>
<caption>
<span id="tab:iotable">Table 1: </span>Input-Output Table
</caption>
<tbody>
<tr>
<td style="text-align:center;">
<strong>Input</strong>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(1\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(2\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(G\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(1\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(2\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(G\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(1\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{11}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{12}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{G1}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{11}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{12}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{G1}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{X}_{1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<strong>Intermediate</strong>
</td>
<td style="text-align:center;">
<span class="math inline">\(2\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{21}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{22}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{G2}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{21}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{22}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{G2}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{X}_{2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<strong>inputs</strong>
</td>
<td style="text-align:center;">
…
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(G\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{G1}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{G2}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{GN}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{G1}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Z}_{G2}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{Y}_{GN}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{X}_{G}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<strong>Value Added</strong>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{VA}_{1}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{VA}_{2}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{VA}_{G}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
</tr>
<tr>
<td style="text-align:center;">
<strong>Input</strong>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{X}_{1}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{X}_{2}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\dots\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
<span class="math inline">\(\mathbf{X}_{G}\)</span>
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
<td style="text-align:center;border-left:1px solid;">
</td>
</tr>
</tbody>
</table>
</div>
<p>In a typical international input-output table (which is a matrix composed of
block matrices) <span class="math inline">\(\mathbf{Z}\)</span> is the matrix of intermediate inputs (dimension <span class="math inline">\(GN \times GN\)</span>), with each sub-matrix <span class="math inline">\(\mathbf{Z}_{sr}\)</span> (dimension <span class="math inline">\(N \times N\)</span>)
elements <span class="math inline">\(z_{sr}^{ij}\)</span> representing the deliveries of intermediate inputs from
sector <span class="math inline">\(i\)</span> in country <span class="math inline">\(s\)</span> to sector <span class="math inline">\(j\)</span> in country <span class="math inline">\(r\)</span>. <span class="math inline">\(\mathbf{Y}\)</span> is the
matrix of final demand, of dimension <span class="math inline">\(GN \times G\)</span> (aggregated by country for
practical purposes from an original <span class="math inline">\(\mathbf{Yfd}\)</span> matrix with <span class="math inline">\(FD\)</span> demand
components). <span class="math inline">\(\mathbf{X}\)</span> is the production matrix, of dimension <span class="math inline">\(GN \times 1\)</span>,
and <span class="math inline">\(\mathbf{VA}\)</span> the value added demand, of dimension <span class="math inline">\(1 \times GN\)</span>.</p>
<h3 data-number="2.2" id="the-demand-model"><span class="header-section-number">2.2</span> The demand model</h3>
<p>The typical demand model, which dates back to
<span class="citation" data-cites="leontief_quantitative_1936">Leontief (<a href="#ref-leontief_quantitative_1936" role="doc-biblioref">1936</a>)</span>, assumes that the inputs from sector <span class="math inline">\(i\)</span> of country
<span class="math inline">\(s\)</span> to sector <span class="math inline">\(j\)</span> of country <span class="math inline">\(r\)</span> are a constant proportion of the output of
sector <span class="math inline">\(j\)</span> in country <span class="math inline">\(r\)</span>. From there we obtain a matrix of coefficients
<span class="math inline">\(\mathbf{A}\)</span> whose elements are the proportion of intermediate inputs over total
production, <span class="math inline">\(a_{sr}^{ij} = z_{sr}^{ij} / {x_{r}^{j}}\)</span>. Then the relations in the
international input-output table can be expressed as
<span class="math inline">\(\mathbf{AX}+\mathbf{Y}=\mathbf{X}\)</span>, from where we deduct a relation between
production and final demand:</p>
<p><span class="math display" id="eq:XBY">\[\begin{equation}
  \mathbf{X}=\left(\mathbf{I}-\mathbf{A}\right)^{-1}\mathbf{Y}=\mathbf{BY}
   \tag{1}
\end{equation}\]</span></p>
<p>Here the matrix <span class="math inline">\(\mathbf{B}\)</span> (inverse of <span class="math inline">\(\mathbf{I} -\mathbf{A}\)</span>, where
<span class="math inline">\(\mathbf{I}\)</span> is the identity matrix) collects the backward linkages that the
final demand <span class="math inline">\(\mathbf{Y}\)</span> induces on production. Each element of <span class="math inline">\(\mathbf{B}\)</span>,
<span class="math inline">\(b_{sr}^{ij}\)</span>, can be expressed as the increase of production of sector <span class="math inline">\(i\)</span> in
country <span class="math inline">\(s\)</span>, when the final demand of sector <span class="math inline">\(j\)</span> in country <span class="math inline">\(r\)</span> increases by one
unit.</p>
<h3 data-number="2.3" id="value-added-in-trade"><span class="header-section-number">2.3</span> Value added in trade</h3>
<p>If the ratio between inputs and production is constant, then the ratio between
value added (i.e., the value of production minus the value of inputs) and
production can also be considered constant, so we can define vector <span class="math inline">\(\mathbf{V}\)</span>
as the value added by unit of output <span class="math inline">\(\mathbf{X}\)</span> and express the value added in
terms of global demand as <span class="math inline">\(\mathbf{V} \mathbf{X} = \mathbf{V} \mathbf{BY}\)</span>. More
specifically, for a given country <span class="math inline">\(s\)</span>:</p>
<p><span class="math display" id="eq:VBY">\[\begin{equation}
  \mathbf{V}_s \mathbf{X}_s =
    \mathbf{V}_s \sum_{j}^{G}\sum_{r}^{G}{\mathbf{B}_{sj} \mathbf{Y}_{jr}}
    \tag{2}
\end{equation}\]</span></p>
<p>that we can break down into the value added produced and absorbed in <span class="math inline">\(s\)</span> and the
value added produced in <span class="math inline">\(s\)</span> and absorbed abroad:</p>
<p><span class="math display" id="eq:VADVAX">\[\begin{equation}
  \mathbf{V}_s \sum_{j}^{G}{\mathbf{B}_{sj}\mathbf{Y}_{js}} +
    \mathbf{V}_s \sum_{j}^{G} \sum_{r\neq s}^{G} {\mathbf{B}_{sj}\mathbf{Y}_{jr}}
    \tag{3}
\end{equation}\]</span></p>
<p>The second term in <a href="#eq:VADVAX">(3)</a> is usually referred to as value added
exported <span class="math inline">\({\mathbf{VAX}}_s\)</span> <span class="citation" data-cites="johnson_accounting_2012">(<a href="#ref-johnson_accounting_2012" role="doc-biblioref">Johnson and Noguera 2012</a>)</span>. In aggregated terms,
value added absorbed abroad coincides with value added exported, but this is not
true in bilateral terms. In fact, <span class="math inline">\({\mathbf{VAX}}_{sr}\)</span> is the value added
produced in <span class="math inline">\(s\)</span> and absorbed in <span class="math inline">\(r\)</span>, but <em>regardless of the export destination</em>.
To obtain the value added exported to <span class="math inline">\(r\)</span> <em>regardless of the absorption country</em>
we need to calculate the value added induced not by final demand, but by the
demand of gross exports.</p>
<p>For that, knowing that each column of the matrix product
<span class="math inline">\(\mathbf{V} \mathbf{B}\)</span> is a linear combination whose sum is a unit vector
<span class="math inline">\(\boldsymbol{\iota}\)</span>, we can break down the linkage effects over the production
of any country <span class="math inline">\(s\)</span> into those derived of domestic inputs and those derived of
foreign components.</p>
<p><span class="math display" id="eq:sumVB">\[\begin{equation}
    \boldsymbol{\iota} = \sum_{t}^{G}{{\mathbf{V}}_t\mathbf{B}_{ts}} =
    {\mathbf{V}}_s \mathbf{B}_{ss} + \sum_{t\neq s}^{G}
    {{\mathbf{V}}_t\mathbf{B}_{ts}}
     \tag{4}
\end{equation}\]</span></p>
<p>If we multiply both terms of equation <a href="#eq:sumVB">(4)</a> by the demand of gross
exports of country <span class="math inline">\(s\)</span>, <span class="math inline">\(\mathbf{E}_s\)</span>, we obtain a basic decomposition of the
content of value added in exports into domestic and foreign content.</p>
<p><span class="math display" id="eq:content">\[\begin{equation}
    \boldsymbol{\iota} \mathbf{E}_{s}
    = \sum_{t}^{G} {{\mathbf{V}}_t\mathbf{B}_{ts}\mathbf{E}_{s}}
    = {\mathbf{V}}_s \mathbf{B}_{ss} \mathbf{E}_{s} +
    \sum_{t\neq s}^{G}{{\mathbf{V}}_t \mathbf{B}_{ts} \mathbf{E}_{s}}
    \tag{5}
\end{equation}\]</span></p>
<p>Expression <a href="#eq:content">(5)</a> reflects that the demand of gross exports of <span class="math inline">\(s\)</span>
can only be satisfied with domestic value added or with foreign value added
(with inputs being value added of other sectors). This is also valid for the
bilateral exports of <span class="math inline">\(s\)</span>, <span class="math inline">\(\mathbf{E}_{sr}\)</span> (the sum being in this case the
total gross bilateral exports).</p>
<p>We have so far overlooked the sector distribution of exports. It we wanted to
preserve the sector information, we should use a diagonalized version of matrix
<span class="math inline">\(\mathbf{V}\)</span>, <span class="math inline">\(\hat{\mathbf{V}}\)</span>, with the resulting product <span class="math inline">\(\hat{\mathbf{V}} \mathbf{B}\)</span> reflecting the sector of origin of value added. If we opted instead
(as it normally the case) to reflect the value-added exporting sector, then the
products <span class="math inline">\({\hat{\mathbf{V}}}_s \mathbf{B}_{ss}\)</span> and <span class="math inline">\({\hat{\mathbf{V}}}_t \mathbf{B}_{ts}\)</span> should be diagonalized as <span class="math inline">\(\widehat{{\mathbf{V}}_s \mathbf{B}_{ss}}\)</span> and <span class="math inline">\(\widehat{{\mathbf{V}}_t \mathbf{B}_{ts}}\)</span>, respectively.</p>
<p>The decomposition of value added in exports essentially consists in
analyzing the elements of Equation <a href="#eq:content">(5)</a>, extracting the elements
that are not really value added (double counted) as well as those that are
not really exports (flows eventually re-imported and absorbed domestically).</p>
<h2 data-number="3" id="creating-and-manipulating-input-output-matrices"><span class="header-section-number">3</span> Creating and manipulating input-output matrices</h2>
<h3 data-number="3.1" id="usage"><span class="header-section-number">3.1</span> Usage</h3>
<p>The basic matrices of a Leontief demand-induced model can be easily obtained
from raw data with the command <code>make_wio()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_wio.html'>make_wio</a></span><span class='op'>(</span>wiotype <span class='op'>=</span> <span class='st'>"icio2023"</span>, year <span class='op'>=</span> <span class='cn'>NULL</span>, </span>
<span>         src_dir <span class='op'>=</span> <span class='cn'>NULL</span>, quiet <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>where:</p>
<ul>
<li><code>wiotype</code> is a string specifying the type of international input-output table
to be used (and therefore the source zip file to be looked for in the source
directory <code>src_dir</code>).</li>
<li><code>year</code> is an integer specifying the reference year. If missing, <code>make_wio()</code>
will use the last available year for that database (e.g., 2020 for
<code>"icio2023"</code> or 2014 for <code>"wiod2016"</code>).</li>
<li><code>src_dir</code> is the source directory where the raw data is located. If data is
stored in the current working directory, this argument can be omitted.</li>
<li><code>quiet</code> is a boolean, with <code>TRUE</code> opting for a silent output.</li>
</ul>
<h3 data-number="3.2" id="source-data"><span class="header-section-number">3.2</span> Source data</h3>
<p><a href="https://cran.r-project.org/package=exvatools">exvatools</a> produces basic input-output tables from three types
of data: public international input-output databases, custom data and
sample data.</p>
<p>Public international input-output databases can be directly downloaded from the
web pages of their respective institutions. Three sources are currently
supported:</p>
<ul>
<li>OECD Inter-Country Input-Output (ICIO) tables <span class="citation" data-cites="oecd_oecd_2023">(<a href="#ref-oecd_oecd_2023" role="doc-biblioref">OECD 2023</a>)</span>, on which
the OECD’s Trade in Value Added database (TiVA) is based,</li>
<li>World Input Output Database (WIOD) tables <span class="citation" data-cites="timmer_illustrated_2015">(<a href="#ref-timmer_illustrated_2015" role="doc-biblioref">Timmer et al. 2015</a>)</span>.</li>
<li>FIGARO EU Input-Output Tables (EU IC-SUIOTs) <span class="citation" data-cites="remond-tierrez_eu_2019">(<a href="#ref-remond-tierrez_eu_2019" role="doc-biblioref">Remond-Tierrez and Rueda-Cantuche 2019</a>)</span></li>
</ul>
<p>The default <code>wiotype</code> is <code>"icio2023"</code>, corresponding to the OECD ICIO Tables,
version 2023 (years 1995 to 2020), available as zip files that can be downloaded
from the <a href="https://www.oecd.org/sti/ind/inter-country-input-output-tables.htm">ICIO web
page</a>. Older
versions of OECD ICIO (<code>"icio2021"</code>, <code>"icio2018"</code> and <code>"icio2016"</code>) are provided
for backward compatibility (for example, to reproduce examples in literature
using those databases). For WIOD Tables, versions included are <code>"wiod2016"</code>
(version 2016, years 2000 to 2014), <code>"wiod2013"</code> and <code>"lrwiod2022"</code> (long-run
WIOD tables, version 2022, for years 1965 to 2000). All of them are available at
the University of Groningen’s <a href="https://www.rug.nl/ggdc/valuechain/wiod/">Growth and Development Centre web
page</a>. FIGARO tables, whether
industry-by-industry (<code>"figaro2022i"</code>) or product-by-product (<code>"figaro2022p"</code>)
are available at the <a href="https://ec.europa.eu/eurostat/web/esa-supply-use-input-tables/database">Eurostat web
page</a>.</p>
<p>The advantage of these databases is threefold: they are widely used in the
economic literature, they are quite rich in terms of countries and sectors, and
they are directly downloadable from the web page of their supporting
institutions, typically as zipped files containing comma-delimited files
(<code>.csv</code>), Excel files (<code>.xlsx</code>) or R data files (<code>.RData</code>). In any case,
<a href="https://cran.r-project.org/package=exvatools">exvatools</a> can be easily extended to other available international
input-output databases like the Eora database <span class="citation" data-cites="lenzen_building_2013">(<a href="#ref-lenzen_building_2013" role="doc-biblioref">Lenzen et al. 2013</a>)</span> or the ADB
Multi-Regional Input Output (ADB-MRIO) Database
<span class="citation" data-cites="asian_development_bank_multiregional_2023">(<a href="#ref-asian_development_bank_multiregional_2023" role="doc-biblioref">Asian Development Bank 2023</a>)</span>.</p>
<p>For instance, if we want to use <a href="https://cran.r-project.org/package=exvatools">exvatools</a> with the 2023 edition of the
OECD ICIO tables (with data up to 2020), we must first download the source file
“ICIO_2016-2020-extended.zip” (92 MB) from the <a href="https://www.oecd.org/sti/ind/inter-country-input-output-tables.htm">ICIO web
page</a>. Then
we will use the command <code>make_wio()</code>, specifying the edition, the year and the
folder where the source zip file is saved (just the directory). For instance, if
the file was located in <code>C:\Users\Username\Documents\R</code> and we wanted the year
2020:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>wio</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_wio.html'>make_wio</a></span><span class='op'>(</span><span class='st'>"icio2023"</span>, year <span class='op'>=</span> <span class='fl'>2020</span>, </span>
<span>                src_dir <span class='op'>=</span> <span class='st'>"C:/Users/Username/Documents/R"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>and <a href="https://cran.r-project.org/package=exvatools">exvatools</a> will take care of the rest: it will extract the
<code>.csv</code> files from the zip file and produce the basic input-output matrices.</p>
<p>Alternatively, <a href="https://cran.r-project.org/package=exvatools">exvatools</a> can use custom data to create basic
input-output matrices. In this case, we just need as input a numeric matrix or
data frame with the intermediate inputs <span class="math inline">\(\mathbf{Z}\)</span> and the final demand
<span class="math inline">\(\mathbf{Yfd}\)</span>, plus a vector with the names of the countries. In this case, we
will use an alternative command, <code>make_custom_wio()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>wio</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_custom_wio.html'>make_custom_wio</a></span><span class='op'>(</span><span class='va'>df</span>, g_names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"C01"</span>, <span class='st'>"C02"</span>, <span class='st'>"C03"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>If we just want to check the features of <a href="https://cran.r-project.org/package=exvatools">exvatools</a>, there is no need
to download any data. The package includes two sets of fictitious data,
<code>wiotype = "iciotest"</code> (an ICIO-type data sample, with Mexico and China
disaggregated) and <code>wiotype = "wiodtest"</code> (a WIOD-type data sample). Both can
be directly used in <code>make_wio()</code>, with no need to specify year or source
directory.</p>
<p>As the dimension of publicly available input-output matrices is big,
here we will use here ICIO-type fictitious data made with
<code>make_wio("iciotest")</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>wio</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_wio.html'>make_wio</a></span><span class='op'>(</span><span class='st'>"iciotest"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The newly created <code>wio</code> class, which can be easily checked with <code>summary(wio)</code>,
includes the following elements:</p>
<ul>
<li><span class="math inline">\(\mathbf{Z}\)</span>, the <span class="math inline">\(GN \times GN\)</span> matrix of intermediate inputs.
<span class="math inline">\(\mathbf{Zd}\)</span> is the matrix of domestic intermediate inputs (diagonal block
matrix of <span class="math inline">\(\mathbf{Z}\)</span>) and <span class="math inline">\(\mathbf{Zm}\)</span> the matrix of international
intermediate inputs, exported or imported (off-diagonal block matrix of
<span class="math inline">\(\mathbf{Z}\)</span>).</li>
<li><span class="math inline">\(\mathbf{A}\)</span>, the <span class="math inline">\(GN \times GN\)</span> coefficient matrix. <span class="math inline">\(\mathbf{Ad}\)</span> is
the coefficient matrix of domestic inputs (diagonal block matrix of
<span class="math inline">\(\mathbf{A}\)</span>) and <span class="math inline">\(\mathbf{Am}\)</span> the matrix of exported or imported inputs
(off-diagonal block matrix of <span class="math inline">\(\mathbf{A}\)</span>).</li>
<li><span class="math inline">\(\mathbf{B}\)</span>, the <span class="math inline">\(GN \times GN\)</span> global inverse Leontief matrix.
<span class="math inline">\(\mathbf{Bd}\)</span> is the global Leontief matrix for domestic linkage effects
(diagonal block matrix) and <span class="math inline">\(\mathbf{Bm}\)</span> is the global Leontief matrix
for international linkage effects (off-diagonal block matrix), in both
cases using both domestic and international inputs.</li>
<li><span class="math inline">\(\mathbf{Ld}\)</span>, the <span class="math inline">\(GN \times GN\)</span> local inverse Leontief matrix
reflecting domestic linkage effects using only domestic inputs.</li>
<li><span class="math inline">\(\mathbf{VA}\)</span>, the <span class="math inline">\(GN \times 1\)</span> value added vector matrix.</li>
<li><span class="math inline">\(\mathbf{X}\)</span>, the <span class="math inline">\(GN \times 1\)</span> production vector matrix.</li>
<li><span class="math inline">\(\mathbf{V}\)</span>, the <span class="math inline">\(GN \times 1\)</span> vector reflecting the value-added
share of production (<span class="math inline">\(\mathbf{VA}/\mathbf{X}\)</span>). <span class="math inline">\(\mathbf{W}\)</span> is the diagonal
matrix of <span class="math inline">\(\mathbf{V}\)</span> (usually expressed as <span class="math inline">\(\hat{\mathbf{V}}\)</span>).</li>
<li><span class="math inline">\(\mathbf{Yfd}\)</span>, the <span class="math inline">\(GN \times GFD\)</span> full demand matrix (with final
demand components by country in columns); <span class="math inline">\(\mathbf{Y}\)</span>, the <span class="math inline">\(GN \times G\)</span>
final demand matrix, with aggregated total demand by country in columns;
<span class="math inline">\(\mathbf{Yd}\)</span> is the domestic final demand (diagonal block matrix of
<span class="math inline">\(\mathbf{Y}\)</span>) and <span class="math inline">\(\mathbf{Ym}\)</span> the foreign final demand (non-diagonal block
matrix of <span class="math inline">\(\mathbf{Y}\)</span>).</li>
<li><span class="math inline">\(\mathbf{EXGR}\)</span>, the <span class="math inline">\(GN \times G\)</span> total gross bilateral exports
matrix. <span class="math inline">\(\mathbf{E}\)</span> is the <span class="math inline">\(GN \times GN\)</span> diagonal matrix of aggregated
total exports (also shown sometimes as <span class="math inline">\(\hat{\mathbf{E}}\)</span>).</li>
</ul>
<p>Additionally, the main dimensions are provided in the list <code>dims</code>,
such as the number of countries <span class="math inline">\(G\)</span>, the number of countries including
disaggregated countries <span class="math inline">\(GX\)</span>, the number of sectors <span class="math inline">\(N\)</span>, the number of final
demand components <span class="math inline">\(FD\)</span>, or combinations thereof (<span class="math inline">\(GN\)</span>, <span class="math inline">\(GXN\)</span>, <span class="math inline">\(GFD\)</span>). A list
<code>names</code> is also provided, including the names of countries (ISO codes of
3 characters), the names of sectors, (from D01 to D99 for tables based in ISIC
revision 4, and from C01 to C99 for tables based in ISIC revision 3), the
names of demand components, and two additional metadata: the type of source
database (<code>"icio2023"</code>, <code>"wiod2016"</code>, etc.) and the <code>year</code>.</p>
<h3 data-number="3.3" id="commands-for-input-output-matrix-manipulation"><span class="header-section-number">3.3</span> Commands for input-output matrix manipulation</h3>
<p>Although <a href="https://cran.r-project.org/package=exvatools">exvatools</a> was initially conceived as a trade analysis
software, it also includes a series of commands that facilitate the manipulation
of international input-output tables for any other purposes. Thus, we can
multiply a diagonal matrix by an ordinary one with <code>dmult()</code>, an ordinary by a
diagonal with <code>multd()</code>, or make a block-by-block Hadamard product of matrices
with <code>hmult()</code>. We can also easily obtain a block diagonal matrix with <code>bkd()</code>,
a block off-diagonal matrix with <code>bkoffd()</code>, or a diagonal matrix with the sums
of all columns with <code>diagcs()</code>.</p>
<p>Additionally, as <a href="https://cran.r-project.org/package=exvatools">exvatools</a> always operates with named rows and columns
(names of countries and sectors), several commands are included to consolidate
matrices, preserving the matrix format and optionally providing names for the
resulting rows or columns: <code>rsums()</code> to sum rows, <code>csums()</code> to sum columns,
<code>sumnrow()</code> to sum every <em>nth</em> row of a matrix, <code>sumncol()</code> to sum every <em>nth</em>
column, <code>sumgrows()</code> to sum groups of rows of a particular size, <code>sumgcols()</code> to
do the same with columns, etc.</p>
<p>On the other hand, the OECD ICIO tables have a particular feature: two big
industrial countries, China and Mexico, are broken down into two regions each.
Calculations must initially be done with disaggregated data, but later
consolidated under the name of the country. The command <code>meld()</code> takes
care of that.</p>
<p>Let us, for instance, check that the production <span class="math inline">\(\mathbf{X}\)</span> is equivalent to
the product of the global Leontief inverse matrix <span class="math inline">\(\mathbf{B}\)</span> and the final
demand <span class="math inline">\(\mathbf{Y}\)</span>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>BY</span> <span class='op'>&lt;-</span> <span class='va'>wio</span><span class='op'>$</span><span class='va'>B</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>wio</span><span class='op'>$</span><span class='va'>Y</span></span></code></pre>
</div>
</div>
<p>We can sum the rows (with <code>rsums()</code>, naming the result as <code>"BY"</code>) and check that
it coincides with the production vector:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>BY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/rsums.html'>rsums</a></span><span class='op'>(</span><span class='va'>BY</span>, <span class='st'>"BY"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>BY</span>, <span class='fl'>10</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>wio</span><span class='op'>$</span><span class='va'>X</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                BY        X
ESP_01T09 1378.568 1378.568
ESP_10T39 1914.607 1914.607
ESP_41T98 2113.699 2113.699
FRA_01T09 1848.173 1848.173
FRA_10T39 1799.486 1799.486
FRA_41T98 1608.004 1608.004
MEX_01T09    0.000    0.000
MEX_10T39    0.000    0.000
MEX_41T98    0.000    0.000
USA_01T09 1895.742 1895.742</code></pre>
</div>
<p>Now let us calculate the value added absorbed abroad. For that we need to
multiply the value added coefficients matrix <span class="math inline">\(\hat{\mathbf{V}}\)</span> (represented
here as <span class="math inline">\(\mathbf{W}\)</span>) by the global inverse matrix <span class="math inline">\(\mathbf{B}\)</span> by the final
demand matrix <span class="math inline">\(\mathbf{Y}\)</span>, and then exclude the value added absorbed
domestically. This can be easily done with a few commands.</p>
<p>To calculate all value added induced by final demand:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>VBY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/dmult.html'>dmult</a></span><span class='op'>(</span><span class='va'>wio</span><span class='op'>$</span><span class='va'>W</span>, <span class='va'>wio</span><span class='op'>$</span><span class='va'>B</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>wio</span><span class='op'>$</span><span class='va'>Y</span></span>
<span><span class='va'>VBY</span></span></code></pre>
</div>
<pre><code>                ESP       FRA       MEX       USA       CHN       ROW
ESP_01T09  33.25239  33.04328  29.13415  39.26315  44.36171  40.26254
ESP_10T39 105.86567  99.40932 118.73322 139.90848 115.91495 126.97831
ESP_41T98 221.93642 191.16663 158.37563 173.76610 145.22181 168.64254
FRA_01T09  48.48628  66.62310  51.62458  49.45643  47.66424  70.97642
FRA_10T39 120.80031 104.64030 128.78920 102.79096  97.91708  99.78527
FRA_41T98 134.74749 129.14500  99.99938  88.70168  86.75694 101.79354
MEX_01T09   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
MEX_10T39   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
MEX_41T98   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
USA_01T09 175.01545 130.46673 128.74728 107.71747 102.20179 117.94400
USA_10T39 102.29790  84.03672  79.60012 121.89497  66.60450 100.75615
USA_41T98 115.50508 118.18725 129.51719 122.16680  95.86500 111.98916
CHN_01T09   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
CHN_10T39   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
CHN_41T98   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
ROW_01T09  82.22487  42.82585  45.01008  60.06683  46.78138  51.62906
ROW_10T39  90.44372  97.64510  80.63597  95.00232  91.33130  91.05473
ROW_41T98  62.56171  51.01318  42.64560  58.70599  41.40437  50.09897
MX1_01T09 173.85507 180.14952 154.43342 149.69601 164.13090 149.43125
MX1_10T39 119.84480  74.11099 117.78742  97.93871 142.64384 121.97803
MX1_41T98  49.45281  29.23090  35.52473  39.69653  36.67997  31.42076
MX2_01T09  96.85254  83.89485  70.55941  97.36493  80.35587  66.40230
MX2_10T39 138.50490  86.35272  92.84516 108.88726  99.24637 102.95958
MX2_41T98  82.91973  67.68778  62.14849  77.03372  65.06803  75.12146
CN1_01T09 109.94070 114.47837  91.18810 152.37369 127.84703 118.37641
CN1_10T39 119.64017 127.22095 126.45021 165.70116 164.43470 128.00251
CN1_41T98 109.34845  93.91197 106.67385 115.50129 111.77386 119.86482
CN2_01T09  84.74417  83.13258  69.33664  86.84078  80.88526  72.00972
CN2_10T39  73.17244  54.76049  43.08188  56.11525  70.19744  78.67920
CN2_41T98 158.98841 103.45062 108.60598 136.04997 128.63627 109.93866</code></pre>
</div>
<p>The rows for Mexico and China are disaggregated. We can easily meld
them with <code>meld()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>VBY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/meld.html'>meld</a></span><span class='op'>(</span><span class='va'>VBY</span><span class='op'>)</span></span>
<span><span class='va'>VBY</span></span></code></pre>
</div>
<pre><code>                ESP       FRA       MEX       USA       CHN       ROW
ESP_01T09  33.25239  33.04328  29.13415  39.26315  44.36171  40.26254
ESP_10T39 105.86567  99.40932 118.73322 139.90848 115.91495 126.97831
ESP_41T98 221.93642 191.16663 158.37563 173.76610 145.22181 168.64254
FRA_01T09  48.48628  66.62310  51.62458  49.45643  47.66424  70.97642
FRA_10T39 120.80031 104.64030 128.78920 102.79096  97.91708  99.78527
FRA_41T98 134.74749 129.14500  99.99938  88.70168  86.75694 101.79354
MEX_01T09 270.70761 264.04436 224.99283 247.06094 244.48677 215.83355
MEX_10T39 258.34970 160.46370 210.63258 206.82598 241.89021 224.93762
MEX_41T98 132.37254  96.91869  97.67322 116.73025 101.74800 106.54222
USA_01T09 175.01545 130.46673 128.74728 107.71747 102.20179 117.94400
USA_10T39 102.29790  84.03672  79.60012 121.89497  66.60450 100.75615
USA_41T98 115.50508 118.18725 129.51719 122.16680  95.86500 111.98916
CHN_01T09 194.68487 197.61095 160.52474 239.21447 208.73229 190.38614
CHN_10T39 192.81261 181.98144 169.53209 221.81640 234.63214 206.68171
CHN_41T98 268.33686 197.36260 215.27984 251.55127 240.41013 229.80349
ROW_01T09  82.22487  42.82585  45.01008  60.06683  46.78138  51.62906
ROW_10T39  90.44372  97.64510  80.63597  95.00232  91.33130  91.05473
ROW_41T98  62.56171  51.01318  42.64560  58.70599  41.40437  50.09897</code></pre>
</div>
<p>We just want the value added absorbed abroad. For that we need the block
off-diagonal matrix of <span class="math inline">\(\mathbf{\hat{V}BY}\)</span>, that we can produce with
<code>bkoffd()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>vax</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/bkoffd.html'>bkoffd</a></span><span class='op'>(</span><span class='va'>VBY</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>vax</span>, <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                ESP       FRA       MEX       USA       CHN       ROW
ESP_01T09   0.00000  33.04328  29.13415  39.26315  44.36171  40.26254
ESP_10T39   0.00000  99.40932 118.73322 139.90848 115.91495 126.97831
ESP_41T98   0.00000 191.16663 158.37563 173.76610 145.22181 168.64254
FRA_01T09  48.48628   0.00000  51.62458  49.45643  47.66424  70.97642
FRA_10T39 120.80031   0.00000 128.78920 102.79096  97.91708  99.78527
FRA_41T98 134.74749   0.00000  99.99938  88.70168  86.75694 101.79354
MEX_01T09 270.70761 264.04436   0.00000 247.06094 244.48677 215.83355
MEX_10T39 258.34970 160.46370   0.00000 206.82598 241.89021 224.93762
MEX_41T98 132.37254  96.91869   0.00000 116.73025 101.74800 106.54222
USA_01T09 175.01545 130.46673 128.74728   0.00000 102.20179 117.94400</code></pre>
</div>
<h2 data-number="4" id="decomposition-of-value-added-in-exports"><span class="header-section-number">4</span> Decomposition of value added in exports</h2>
<h3 data-number="4.1" id="methodology-extracting-double-counting-and-re-imports"><span class="header-section-number">4.1</span> Methodology: extracting double counting and re-imports</h3>
<p>Equation <a href="#eq:content">(5)</a> showed a basic decomposition of the value of gross
exports into its domestic and foreign content. However, matrix <span class="math inline">\(\mathbf{B}\)</span> in
that equation is the result of successive rounds of production induced by
demand, therefore incurring in double counting. To differentiate between true
value added and double counting we must specify a spatial perimeter and a
sequential perimeter. The spatial perimeter (or perspective) will delimit the
border that has to be crossed a specific number of times for a transaction to be
considered as value added, and the the sequential perimeter (or approach) will
delimit the number of border crossings for a transaction to be considered as
value added.</p>
<p>The most consistent decomposition methods employ for the spatial perimeter the
exporting country’s border (country perspective) and for the sequential
perimeter the first border crossing (source-based approach). As a result,
export flows are considered as value added <em>the first time</em> they cross
<em>the exporting country’s border</em>, with ulterior flows being considered as
double counting.</p>
<p>Once we have identified export flows that are double counted (and therefore do
not constitute real value added), we must also differentiate the export flows
that eventually return to be absorbed in the exporting country (and therefore do
not constitute true exports). The methodology to calculate value added in
exports is not univocal, and has led to a considerable amount of discussion in
the past few years, following <span class="citation" data-cites="daudin_who_2011">Daudin et al. (<a href="#ref-daudin_who_2011" role="doc-biblioref">2011</a>)</span>; <span class="citation" data-cites="johnson_accounting_2012">Johnson and Noguera (<a href="#ref-johnson_accounting_2012" role="doc-biblioref">2012</a>)</span>;
<span class="citation" data-cites="foster-mcgregor_value_2013">Foster-McGregor and Stehrer (<a href="#ref-foster-mcgregor_value_2013" role="doc-biblioref">2013</a>)</span>; <span class="citation" data-cites="wang_quantifying_2013">Wang et al. (<a href="#ref-wang_quantifying_2013" role="doc-biblioref">2013</a>)</span>;
<span class="citation" data-cites="koopman_tracing_2014">Koopman et al. (<a href="#ref-koopman_tracing_2014" role="doc-biblioref">2014</a>)</span>; <span class="citation" data-cites="los_tracing_2016">Los et al. (<a href="#ref-los_tracing_2016" role="doc-biblioref">2016</a>)</span> and
<span class="citation" data-cites="los_measuring_2018">Los and Timmer (<a href="#ref-los_measuring_2018" role="doc-biblioref">2018</a>)</span>; <span class="citation" data-cites="nagengast_accounting_2016">Nagengast and Stehrer (<a href="#ref-nagengast_accounting_2016" role="doc-biblioref">2016</a>)</span>;
<span class="citation" data-cites="johnson_measuring_2018">Johnson (<a href="#ref-johnson_measuring_2018" role="doc-biblioref">2018</a>)</span>; <span class="citation" data-cites="arto_measuring_2019">Arto et al. (<a href="#ref-arto_measuring_2019" role="doc-biblioref">2019</a>)</span>; <span class="citation" data-cites="miroudot_decomposing_2021">Miroudot and Ye (<a href="#ref-miroudot_decomposing_2021" role="doc-biblioref">2021</a>)</span> and
<span class="citation" data-cites="borin_measuring_2023">Borin and Mancini (<a href="#ref-borin_measuring_2023" role="doc-biblioref">2023</a>)</span>.</p>
<p>The most recent decomposition methods, including those of <span class="citation" data-cites="borin_measuring_2023">Borin and Mancini (<a href="#ref-borin_measuring_2023" role="doc-biblioref">2023</a>)</span>
or <span class="citation" data-cites="miroudot_decomposing_2021">Miroudot and Ye (<a href="#ref-miroudot_decomposing_2021" role="doc-biblioref">2021</a>)</span>, involve the calculation of a coefficient matrix
<span class="math inline">\(\mathbf{A}\)</span> that excludes the linkage effects of exported inputs. Thus, for a
given country <span class="math inline">\(s\)</span> we will define an extraction matrix <span class="math inline">\(\mathbf{A}^{xs}\)</span> as a
global coefficient matrix whose coefficients corresponding to the exports of
inputs of <span class="math inline">\(s\)</span> are equal to zero.</p>
<p><span class="math display" id="eq:Anots">\[\begin{equation}
    \mathbf{A}^{xs}
    =
    \left[
    \begin{matrix}
    \mathbf{A}_{11} &amp;
    \mathbf{A}_{12} &amp;
    \cdots &amp;
    \mathbf{A}_{1s} &amp;
    \cdots &amp;
    \mathbf{A}_{1G} \\
    \mathbf{A}_{21} &amp;
    \mathbf{A}_{22} &amp;
    \cdots &amp;
    \mathbf{A}_{2s} &amp;
    \cdots &amp;
    \mathbf{A}_{2G} \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0 &amp;
    0 &amp;
    \cdots &amp;
    \mathbf{A}_{ss} &amp;
    \cdots &amp;
    0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    \mathbf{A}_{G1} &amp;
    \mathbf{A}_{G2} &amp;
    \cdots&amp;
    \mathbf{A}_{Gs}&amp;
    \cdots&amp;
    \mathbf{A}_{GG} \\
    \end{matrix}
    \right]
    \tag{6}
\end{equation}\]</span></p>
<p>The global inverse Leontief matrix <span class="math inline">\(\mathbf{B}^{xs}\)</span> derived of this
extraction matrix will collect the value added induced by exports excluding
intermediate goods. Therefore, the double counting will be the difference
between the Leontief inverse global matrix <span class="math inline">\(\mathbf{B}\)</span> and the Leontief
inverse global extraction matrix <span class="math inline">\(\mathbf{B}^{xs}\)</span>, from where we can break
down the components of equation <a href="#eq:content">(5)</a> into the domestic value added
<span class="math inline">\({\mathbf{V}}_s \mathbf{B}^{xs}_{ss} \mathbf{E}_{sr}\)</span>, the
double counted domestic value added
<span class="math inline">\({\mathbf{V}}_s (\mathbf{B}_{ss} - \mathbf{B}^{xs}_{ss}) \mathbf{E}_{sr}\)</span>,
the foreign value added
<span class="math inline">\(\sum_{t\neq s}^{G}{{\mathbf{V}}_t \mathbf{B}^{xs}_{ts} \mathbf{E}_{sr}}\)</span>,
and the foreign double counting
<span class="math inline">\(\sum_{t\neq s}^{G}{{\mathbf{V}}_t (\mathbf{B}_{ts} - \mathbf{B}^{xs}_{ts}) \mathbf{E}_{sr}}\)</span></p>
<p>Then, after expressing exports in terms of final demand, we we will be able to
separate the exports that eventually return home to be absorbed, called
reflection. Figure <a href="#fig:decomposition">1</a> shows the process carried out by
<code>make_exvadec()</code>, first separating Domestic Content (DC) and Foreign Content
(FC), then identifying Domestic Value Added (DVA) and Foreign Value added (FVA),
separating them from Domestic Double Counting (DDC) and Foreign Double Counting
(FDC), and finally dividing Domestic Value Added between Value Added Exported
(VAX) and Reflection (REF).</p>
<!-- For HTML -->
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:decomposition"></span>
<div class="grViz html-widget html-fill-item" id="htmlwidget-d455b71d74e55aaa9f78" style="width:624px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-d455b71d74e55aaa9f78">{"x":{"diagram":"\ndigraph boxes_and_circles {\n\n  # a \"graph\" statement\n  graph [overlap = true, fontsize = 6, rankdir = LR]\n\n  # several \"node\" statements\n  node [shape = box,\n        fontname = Helvetica]\n  A [label = \"Gross\nExports\n(EXGR)\"];\n  B [label = \"Domestic\nContent\n(DC)\"]\n  C [label = \"Foreign\nContent\n(FC)\"]\n  D [label = \"Domestic\nValue Added\n(DVA)\"]\n  E [label = \"Domestic\nDouble Counting\n(DDC)\"]\n  F [label = \"Foreign\nValue Added\n(VA)\"]\n  G [label = \"Foreign\nDoble Counting\n(FDC)\"]\n  H [label = \"Value Added\nExported\n(VAX)\"]\n  I [label = \"Reflection\n(REF)\"]\n  B; C; D; E; F; G; H; I\n\n  # several \"edge\" statements\n  A->B A->C B->D B->E C->F\n  C->G D->H D->I\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 1: Decomposition of value added in gross exports
</p>
</div>
</div>
<!-- For LaTeX -->
<p>Using these indicators (or parts thereof) we can obtain additional indicators to
measure the participation of countries in global value chains, whether in the
form of foreign inputs used in the domestic production of exports (backward
vertical specialization) or in the form of domestic inputs exported to be used
in the production of foreign exports (forward vertical specialization). In case
these indicators are available, the denomination will be global value chain
participation (GVC), divided in global value chain participation backwards
(GVCB) and forward (GVCF).</p>
<h3 data-number="4.2" id="usage-1"><span class="header-section-number">4.2</span> Usage</h3>
<p>The command <code>make_exvadec()</code> (export value added decomposition) provides, from a
<code>wio</code> object, the full decomposition of the value added in exports for every
country or for a particular country or country group, according to different
methodologies. The command syntax is as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_exvadec.html'>make_exvadec</a></span><span class='op'>(</span><span class='va'>wio_object</span>, exporter <span class='op'>=</span> <span class='st'>"all"</span>, method <span class='op'>=</span> <span class='st'>"bm_src"</span>,</span>
<span>             output <span class='op'>=</span> <span class='st'>"standard"</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>with the following arguments:</p>
<ul>
<li><code>wio_object</code> is an object of class <code>wio</code> obtained through the
command <code>make_wio</code>.</li>
<li><code>exporter</code> is a string with the code for the exporting country.
Default is <code>"all"</code> (producing an output of dimension <span class="math inline">\(GN \times G\)</span>), but
can be the code of a country, e.g., <code>"ESP"</code>, or country group, e.g.,
<code>"EU27"</code> (producing an output of dimension <span class="math inline">\(N \times G\)</span>).</li>
<li><code>method</code> is a string specifying the decomposition method.</li>
<li><code>output</code> is a string specifying the desired output type.</li>
<li><code>quiet</code> is a boolean indicating whether to produce output silently (default is
<code>FALSE</code>).</li>
</ul>
<p>The available methods and outputs are summarized in Table
<a href="#tab:methodoutput">2</a>. Selecting <code>"bm_src"</code> will produce a
<span class="citation" data-cites="borin_measuring_2023">Borin and Mancini (<a href="#ref-borin_measuring_2023" role="doc-biblioref">2023</a>)</span> source-based decomposition (from our point of view,
the most methodologically sound), <code>"bm_snk"</code> a <span class="citation" data-cites="borin_measuring_2023">Borin and Mancini (<a href="#ref-borin_measuring_2023" role="doc-biblioref">2023</a>)</span> sink-based
decomposition, <code>"my"</code> a <span class="citation" data-cites="miroudot_decomposing_2021">Miroudot and Ye (<a href="#ref-miroudot_decomposing_2021" role="doc-biblioref">2021</a>)</span> decomposition, <code>"wwz"</code> a
<span class="citation" data-cites="wang_quantifying_2013">Wang et al. (<a href="#ref-wang_quantifying_2013" role="doc-biblioref">2013</a>)</span> decomposition, <code>"kww"</code> a <span class="citation" data-cites="koopman_tracing_2014">Koopman et al. (<a href="#ref-koopman_tracing_2014" role="doc-biblioref">2014</a>)</span>
decomposition and <code>"oecd"</code> a basic OECD decomposition.</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption><span id="tab:methodoutput">Table 2: </span><code>make_exvadec()</code> output</caption>
<colgroup>
<col style="width: 7%" />
<col style="width: 29%" />
<col style="width: 37%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Perimeters</th>
<th style="text-align: left;">Outputs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>bm_src</code></td>
<td style="text-align: left;">Borin and Mancini (2019), source</td>
<td style="text-align: left;">Source-based approach, various perspectives</td>
<td style="text-align: left;"><code>basic</code>, <code>standard</code>, <code>terms</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bm_snk</code></td>
<td style="text-align: left;">Borin and Mancini (2019), sink</td>
<td style="text-align: left;">Sink-based approach, country perspective</td>
<td style="text-align: left;"><code>standard</code>, <code>terms</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>my</code></td>
<td style="text-align: left;">Miroudot and Ye (2021)</td>
<td style="text-align: left;">Source-based approach, various perspectives</td>
<td style="text-align: left;"><code>standard</code>, <code>terms</code>, <code>terms2</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>wwz</code></td>
<td style="text-align: left;">Wang et al. (2013)</td>
<td style="text-align: left;">Mix of both</td>
<td style="text-align: left;"><code>standard</code>, <code>terms</code>, <code>terms2</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>kww</code></td>
<td style="text-align: left;">Koopman et al. (2014)</td>
<td style="text-align: left;">Sink-based approach, mixed perspective</td>
<td style="text-align: left;"><code>standard</code>, <code>terms</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>oecd</code></td>
<td style="text-align: left;">OECD (2021) (not a decomposition)</td>
<td style="text-align: left;">Not applicable</td>
<td style="text-align: left;"><code>standard</code>, <code>terms</code>, <code>tiva</code></td>
</tr>
</tbody>
</table>
</div>
<p>The <code>"standard"</code> output of <code>make_exvadec()</code> will include a series of matrices of
dimension <span class="math inline">\(GN \times G\)</span> (when exporter is <code>"all"</code>) or of dimension <span class="math inline">\(N \times G\)</span>
(when the exporting country is specified, e.g., <code>"USA"</code>), with breakdown by
exporting country and sector, and by importer (country of destination), plus
additional metadata:</p>
<ul>
<li><span class="math inline">\(\mathbf{EXGR}\)</span>, total gross exports by country and exporting sector
and by country of destination.</li>
<li><span class="math inline">\(\mathbf{DC}\)</span>, total domestic content in exports by exporting sector
and country of destination.</li>
<li><span class="math inline">\(\mathbf{DVA}\)</span>, domestic value added (including value added that
returns home).</li>
<li><span class="math inline">\(\mathbf{VAX}\)</span>, or value added effectively exported.</li>
<li><span class="math inline">\(\mathbf{REF}\)</span>, or reflection, value added that is eventually absorbed
in the exporting country and therefore does not constitute real exports.</li>
<li><span class="math inline">\(\mathbf{DDC}\)</span>, or domestic double counting, or flows of value added
that are reexported after passing a second time for the exporting country
and therefore nor constituting real value added.</li>
<li><span class="math inline">\(\mathbf{FC}\)</span>, total foreign value added content in exports
(including double counting).</li>
<li><span class="math inline">\(\mathbf{FVA}\)</span>, foreign value added, excluding double counting.</li>
<li><span class="math inline">\(\mathbf{FDC}\)</span>, foreign double content, or flows of foreign value added
that have passed more than once by the exporting country, therefore already
computed.</li>
</ul>
<p>In some cases, indicators reflecting the participation in global value chains
(vertical specialization) will be provided, mainly foreign value added that
eventually takes part in the domestic production of exports (<span class="math inline">\(\mathbf{GVCB}\)</span> or
global value chain participation backwards) or domestic value added that
eventually takes part in the foreign production of exports (<span class="math inline">\(\mathbf{GVCF}\)</span> or
global value chain participation forward).</p>
<p><code>exvadec</code> objects will inherit metadata of the <code>wio</code> object they come from, like
<code>dims</code>, <code>names</code>, or <code>source</code> (<code>type</code>), plus the indication of the decomposition
<code>method</code> used and, in case of individual decompositions, the <code>exporter</code>. The
<code>"standard"</code> output should be enough for most analyses, but alternative outputs
can be specified with the argument <code>output</code>. The option <code>"terms"</code> will show all
the elements of the decomposition (whose sum is the total value of gross
exports), which is useful if we need to distinguish the value added induced by
intermediate outputs. The <span class="citation" data-cites="wang_quantifying_2013">Wang et al. (<a href="#ref-wang_quantifying_2013" role="doc-biblioref">2013</a>)</span> decomposition corresponds with
the terminology of their Table A2 (pg. 35), but an additional <code>"terms2"</code> is
provided (with the terminology of their Table E1, pg. 61).</p>
<p>The <code>"kww"</code> and <code>"wwz"</code> methods are, in fact, a mix of perspectives and
approaches. The exporting country perspective and the source approach should
probably be considered as the standard, but some alternative approaches (like
the sink approach, considering value added all flows prior to the last border
crossing) and various tailored perspectives are provided. Thus, the sector,
bilateral or bilateral-sector perspectives consider double counting all flows
out of those perimeters, and can be calculated for the <code>"bm_src"</code> and the <code>"my"</code>
methods (by using the additional arguments <code>partner</code> and <code>sector</code>).
Additionally, the <code>"my"</code> method allows a world perspective (using <code>perim = "WLD"</code>), consider as double counting the crossing of <em>any</em> border more than
once, not only that of the exporting country.</p>
<p>We have included an additional decomposition called <code>"oecd"</code>, which is not a
true full decomposition method, but represents nevertheless a calculation of
several elements of value added in exports. It includes a <code>"tiva"</code> output to
show the most typical indicators included in the OECD TiVA database. In this
decomposition (unlike in the the rest), the bilateral VAX is just VAX absorbed
in the partner country.</p>
<h3 data-number="4.3" id="examples"><span class="header-section-number">4.3</span> Examples</h3>
<p>To create create a full decomposition of the value added in the exports of Spain
using the method of <span class="citation" data-cites="borin_measuring_2023">Borin and Mancini (<a href="#ref-borin_measuring_2023" role="doc-biblioref">2023</a>)</span>, using a exporting country perspective
and a source-based approach, we would type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>exvadec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_exvadec.html'>make_exvadec</a></span><span class='op'>(</span><span class='va'>wio</span>, exporter <span class='op'>=</span> <span class='st'>"ESP"</span>, method <span class='op'>=</span> <span class='st'>"bm_src"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>======================================================================
       DECOMPOSITION OF VALUE ADDED IN EXPORTS OF SPAIN IN 2022
               Sector: All sectors
               Destination: All countries
======================================================================
 VA_components                              USD_MM  Percent
 Gross exports of goods and services (EXGR) 4666.96 100.00 
   Domestic Content in VA (DC)              2165.17  46.39 
     Domestic Value Added (DVA)             1880.60  40.30 
       Value Added Exported (VAX)           1624.18  34.80 
       Reflection (REF)                      256.41   5.49 
     Domestic Double Counting (DDC)          284.58   6.10 
   Foreign Content in VA (FC)               2501.78  53.61 
     Foreign Value Added (FVA)              2176.21  46.63 
     Foreign Double Counting (FDC)           325.58   6.98 
 Global Value Chain-related trade (GVC)     4034.25  86.44 
 GVC-related trade, backward (GVCB)         2786.36  59.70 
 GVC-related trade, forward (GVCF)          1247.89  26.74 
======================================================================
Method: Borin and Mancini (2023), source-based, standard output
Country perspective, source approach</code></pre>
</div>
<p>If we want to go deeper into the components of this value added,
differentiating between final and intermediate exports, we can use:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>exvadec.terms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_exvadec.html'>make_exvadec</a></span><span class='op'>(</span><span class='va'>wio</span>, exporter <span class='op'>=</span> <span class='st'>"ESP"</span>, </span>
<span>                              method <span class='op'>=</span> <span class='st'>"bm_src"</span>, output <span class='op'>=</span> <span class='st'>"terms"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>======================================================================
       DECOMPOSITION OF VALUE ADDED IN EXPORTS OF SPAIN IN 2022
               Sector: All sectors
               Destination: All countries
======================================================================
 VA_components                               USD_MM  Percent
 EXGR (Gross exports of goods and services)  4666.96 100.00 
   T01 VAX1 (DVA, finals)                     534.98  11.46 
   T02 VAX2 (DVA, interm. for absorption)      97.73   2.09 
   T03 VAX3 (DVA, interm. for final exports)  314.51   6.74 
   T04 VAX4 (DVA, interm. for reexport)       676.96  14.51 
   T05 REF1 (Reflection, finals)              102.25   2.19 
   T06 REF2 (Reflection, intermediates)       154.17   3.30 
   T07 DDC (Domestic Double Counting)         284.58   6.10 
   T08 FVA1 (FVA, finals)                     631.12  13.52 
   T09 FVA2 (FVA, interm. for absorption)     112.29   2.41 
   T10 FVA3 (FVA, interm. for final exports)  478.65  10.26 
   T11 FVA4 (FVA, interm. for reexport)       954.15  20.44 
   T12 FDC (Foreign Double Counting)          325.58   6.98 
======================================================================
Method: Borin and Mancini (2023), source-based, terms output
Country perspective, source approach</code></pre>
</div>
<p>If we want to get a list of common trade indicators (exports,
imports, value added, production) similar to those of the TiVA database, we
could just use <code>make_exvadec()</code> with the method <code>"oecd"</code> and
<code>output = "tiva"</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tiva</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_exvadec.html'>make_exvadec</a></span><span class='op'>(</span><span class='va'>wio</span>, exporter <span class='op'>=</span> <span class='st'>"ESP"</span>, </span>
<span>                     method <span class='op'>=</span> <span class='st'>"oecd"</span>, output <span class='op'>=</span> <span class='st'>"tiva"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>======================================================================
       DECOMPOSITION OF VALUE ADDED IN EXPORTS OF SPAIN IN 2022
               Sector: All sectors
               Destination: All countries
======================================================================
 VA_components                               USD_MM  Percent
 Gross exports of goods and services (EXGR)  4666.96 100.00 
   Gross exports, finals (EXGR_FNL)          1343.03  28.78 
   Gross exports, intermediates (EXGR_INT)   3323.92  71.22 
   Gross imports (IMGR)                      5292.12 113.40 
   Gross imports, finals (IMGR_FNL)          2386.14  51.13 
   Gross imports, intermediates (IMGR_INT)   2905.98  62.27 
   Domestic absorption (DOM)                  739.92  15.85 
   Domestic absorption, finals (DOM_FNL)      224.26   4.81 
   Domestic absorption, interm. (DOM_INT)     515.66  11.05 
   Gross balance (BALGR)                     -625.17 -13.40 
   Domestic Content in VA (EXGR_DVA)         2165.17  46.39 
   Direct domestic VA content (EXGR_DDC)     1757.25  37.65 
   Indirect domestic VA content (EXGR_IDC)    123.34   2.64 
   Reimported domestic VA content (EXGR_RIM)  284.58   6.10 
   Value Added in final demand (FD_VA)       1985.24  42.54 
   DVA in dom. final dem. (VAD) (DXD_DVA)     361.05   7.74 
   DVA in foreign final dem. (VAX) (FFD_DVA) 1624.18  34.80 
   FVA in dom. final dem. (VAM) (DFD_FVA)    2249.35  48.20 
   Balance of VA (VAX - VAM) (BALVAFD)       -625.17 -13.40 
   Foreign VA Content (EXGR_FVA)             2501.78  53.61 
   Backward participation in GVC (DEXFVAP)   2501.78  53.61 
   Forward participation in GVC (FEXDVAP)    3047.87  65.31 
   Value added (VA)                          1985.24  42.54 
   Production (PROD)                         5406.87 115.85 
======================================================================
Method: OECD (2022), TiVA output
Country perspective, source approach</code></pre>
</div>
<h2 data-number="5" id="direction-origin-and-destination-of-value-added"><span class="header-section-number">5</span> Direction (origin and destination) of value added</h2>
<p>The decomposition of <code>make_exvadec()</code> does not distinguish between the different
sources of foreign value added. This is where the command <code>make_exvadir()</code> might
be useful. It provides data on the direction of value added, i.e., details of
both the geographical and sectoral origin of the value added incorporated in
exports and of the final destination (in gross terms or in terms of final
demand). It allows therefore a thorough analysis of where the value added is
generated and where it ends up (for instance, how EU services are important for
UK’s exports of goods, or the role of China as intermediate party in the exports
of Russia).</p>
<h3 data-number="5.1" id="methodology"><span class="header-section-number">5.1</span> Methodology</h3>
<p>The command <code>make_exvadir()</code> produces an output which is the result of
multiplying the value added matrix <span class="math inline">\(\hat{\mathbf{V}}\)</span> by the global Leontief
inverse matrix <span class="math inline">\(\mathbf{B}\)</span> by a matrix of exports <span class="math inline">\(\mathbf{EXGR}\)</span>, but with a
high level of specification of the three matrices. First, the matrix
<span class="math inline">\(\hat{\mathbf{V}}\)</span> (<span class="math inline">\(\mathbf{V}\)</span> diagonalized, to preserve the sector
information) will be multiplied by a specific form of <span class="math inline">\(\mathbf{B}\)</span>: regular
<span class="math inline">\(\mathbf{B}\)</span> to obtain the total value added content, <span class="math inline">\(\mathbf{B}_d\)</span> to obtain
the domestic value added content and <span class="math inline">\(\mathbf{B_m}\)</span> to obtain the foreign value
added content; or its equivalents in the form of extraction matrices
<span class="math inline">\(\mathbf{B}^{xs}\)</span> to obtain the total, domestic or foreign value added excluding
double counting, according to the methodology of
<span class="citation" data-cites="borin_measuring_2023">Borin and Mancini (<a href="#ref-borin_measuring_2023" role="doc-biblioref">2023</a>)</span>.</p>
<p>Then, depending of the sectoral perspective, the product <span class="math inline">\(\hat{\mathbf{V}} \mathbf{B}\)</span> will be left as it is (sector of origin) or will be summed up by
columns and diagonalized, i.e., as <span class="math inline">\(\widehat{\mathbf{VB}}\)</span> (default option,
exporting sector perspective). The specification of sectors or countries of
origin of value added will be done by setting the non-specified values to zero.
If the exporter is a group of countries, there is the possibility of considering
intra-regional flows as exports or not (by default, intra-regional flows will be
excluded).</p>
<p>Finally, the resulting adjusted product <span class="math inline">\({\mathbf{VB}}\)</span> will be multiplied by a
form of export matrix <span class="math inline">\(\mathbf{EXGR}\)</span>. By default, the ordinary gross export
matrix will be considered, but the option will be given to express exports in
terms of absorption (i.e., final demand), as <span class="math inline">\(\mathbf{EXGRY}\)</span>, giving in this
case the possibility of distinguishing between destination of final goods
(<span class="math inline">\(\mathbf{Y_m}\)</span>) and destination of intermediate exports processed as final
goods (<span class="math inline">\(\mathbf{A_m B Y}\)</span>: this is the only way of calculating the value added
induced by intermediate exports).</p>
<p>Additionally, the possibility will be given to consider exports that go via a
specific country, i.e., an intermediate importer (for example, Russian exports
to the EU that go via China). If this is the case, <span class="math inline">\(\widehat{\mathbf{VB}}\)</span> will
be multiplied by <span class="math inline">\(\mathbf{Y}_{sr} + \mathbf{A}_{sr}[\mathbf{BY}]_r\)</span>, with <span class="math inline">\(s\)</span>
being the exporter and <span class="math inline">\(r\)</span> the intermediate importer, and <span class="math inline">\([\mathbf{BY}]_r\)</span>
the rows of product <span class="math inline">\(\mathbf{BY}\)</span> for country <span class="math inline">\(r\)</span>), i.e., the exports of <span class="math inline">\(s\)</span>
used in the production of <span class="math inline">\(r\)</span>, that ends up in <span class="math inline">\(r\)</span> or exported elsewhere.</p>
<h3 data-number="5.2" id="usage-2"><span class="header-section-number">5.2</span> Usage</h3>
<p>The syntax of <code>make_exvadir()</code> is:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_exvadir.html'>make_exvadir</a></span><span class='op'>(</span><span class='va'>wio_object</span>, va_type <span class='op'>=</span> <span class='st'>"TC"</span>, flow_type <span class='op'>=</span> <span class='st'>"EXGR"</span>, <span class='va'>exporter</span>,</span>
<span>             via <span class='op'>=</span> <span class='st'>"any"</span>, sec_orig <span class='op'>=</span> <span class='st'>"all"</span>, geo_orig <span class='op'>=</span> <span class='st'>"all"</span>,</span>
<span>             intra <span class='op'>=</span> <span class='cn'>FALSE</span>, perspective <span class='op'>=</span> <span class='st'>"exporter"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The arguments are as follows:</p>
<ul>
<li><code>wio_object</code> is an object of class <code>wio</code> (required).</li>
<li><code>va_type</code> is a string describing the type of value added: <code>"TC"</code>,
the default, is the total content in value added (matrix <span class="math inline">\(\mathbf{B}\)</span>), both
foreign and domestic, but we can also select <code>"DC"</code> (the domestic value
added content, using matrix <span class="math inline">\(\mathbf{B_d}\)</span>) or <code>"FC"</code> (the foreign value
added content, using matrix <span class="math inline">\(\mathbf{B_m}\)</span>). <code>"TVA"</code> is the total pure
value added, i.e., excluding double counting (matrix
<span class="math inline">\(\mathbf{B}^{xs}\)</span>), and we can also get the <code>"DVA"</code> (domestic
value added, excluding double counting, matrix <span class="math inline">\(\mathbf{B_d}^{xs}\)</span>) or
the <code>"FVA"</code> (foreign value added, excluding double counting, matrix
<span class="math inline">\(\mathbf{B_m}^{xs}\)</span>).</li>
<li><code>flow_type</code> is a string specifying the type of export flow. Default is
gross total exports (<code>"EXGR"</code>). Alternatives are exports expressed
in terms of final demand: total exports (<code>"EXGRY"</code>), final exports
(<code>"EXGRY_FIN"</code>) or intermediate exports (<code>"EXGRY_INT"</code>). The latter
options will show where value added exported is eventually absorbed,
regardless of where it was initially exported.</li>
<li><code>exporter</code> is a string reflecting the code of the exporting country or
group of countries.</li>
<li><code>via</code> is a string with the code of the intermediate importing country or
country group. Default is <code>"any"</code>. This option requires flows to be expressed
necessarily in terms of final demand.</li>
<li><code>geo_orig</code> is a string with the code of the country or country group origin
of value added. Default is <code>"all"</code>.</li>
<li><code>sec_orig</code> is string with the code of sector of origin of value added (e.g.,
<code>"AGR"</code>, <code>"MANUF"</code>, <code>"SRVWC"</code>…). Default is <code>"all"</code>.</li>
<li><code>intra</code> is a boolean to specify whether to include or not intra-region
exports (default is <code>FALSE</code>, i.e., EU27 exports will include only extra-EU
exports).</li>
<li><code>perspective</code> shows the sectoral perspective of value added. Default is
exporting sector (<code>"exporter"</code>) but sector of <code>"origin"</code> can also be
specified.</li>
</ul>
<p>Please note that, compared to <code>make_exvadec()</code>, <code>make_exvadir()</code> is logically
more restricted at decomposing value added, so in principle calculations will
be shown in terms of domestic and foreign content (DC/FC) or, at most, domestic
and foreign value added (DVA/FVA, excluding double counting), but including
reflection (REF). Also note that the total content in value added from all
origins and all sectors is, precisely, the value of total gross exports.</p>
<h3 data-number="5.3" id="example"><span class="header-section-number">5.3</span> Example</h3>
<p>We have seen that the foreign content in Spanish exports amounts to USD 2501.78
million. Where does it come from? The specific geographical and sector origin of
the value added in exports can be obtained using the command <code>make_exvadir()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>exvadir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_exvadir.html'>make_exvadir</a></span><span class='op'>(</span><span class='va'>wio</span>, exporter <span class='op'>=</span> <span class='st'>"ESP"</span>, va_type <span class='op'>=</span> <span class='st'>"FC"</span>, </span>
<span>                        flow_type <span class='op'>=</span> <span class='st'>"EXGR"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>exvadir</span><span class='op'>$</span><span class='va'>FC</span>, <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>          ESP      FRA      MEX      USA      CHN      ROW
ESP_01T09   0  0.00000  0.00000  0.00000  0.00000  0.00000
ESP_10T39   0  0.00000  0.00000  0.00000  0.00000  0.00000
ESP_41T98   0  0.00000  0.00000  0.00000  0.00000  0.00000
FRA_01T09   0 19.45318 26.47295 15.19438 35.51728 24.42115
FRA_10T39   0 14.09801 34.93554 23.48504 32.13613 27.09630
FRA_41T98   0 15.84674 25.71533 14.12113 17.62330 14.63281
MEX_01T09   0 38.41321 52.27477 30.00356 70.13415 48.22319
MEX_10T39   0 31.07698 77.01024 51.76931 70.83935 59.72978
MEX_41T98   0 33.18999 53.85912 29.57581 36.91088 30.64749
USA_01T09   0 23.35813 31.78700 18.24443 42.64685 29.32333</code></pre>
</div>
<p>Note that the <code>exvadir</code> object that we have obtained is different from
the <code>exvadec</code> object, in the sense that ‘exporters’ in an <code>exvadir</code>
object are the different countries and sectors of origin of the value added
included in the exports of a specific country (in this case, Spain). We can
better understand this by typing <code>summary(exvadir)</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>exvadir</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
====================================================================== 
  ORIGIN AND DESTINATION OF VALUE ADDED IN EXPORTS OF SPAIN IN 2022 
====================================================================== 
Value added type: Foreign VA content (FC) 
In type of flow: Total gross exports (EXGR) 
That goes via country: any 
Using inputs from sector: all sectors 
Of country: all countries 
With sector perspective: exporter 
====================================================================== 

Available countries of origin of VA (G): 6 
ESP, FRA, MEX, USA, CHN, ROW 
 
Available sectors of origin of VA (N): 3 
D01T09, D10T39, D41T98 
 
Available destinations of VA (G): 6 
ESP, FRA, MEX, USA, CHN, ROW 
 </code></pre>
</div>
<p>Now we will see how to maximize the information given by these objects.</p>
<h2 data-number="6" id="sector-and-geographic-analysis"><span class="header-section-number">6</span> Sector and geographic analysis</h2>
<p>The commands <code>make_wio()</code>, <code>make_exvadec()</code> and <code>make_exvadir()</code>
produce objects that are lists of matrices will a full breakdown by sector and
countries of destination. However, most analyses require grouping of those
variables. The advantage is that grouping by sector or by destination do not
require additional computing, just an aggregation of variables.</p>
<p>To check the information about sectors, it suffices to print <code>info_sec()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/info_sec.html'>info_sec</a></span><span class='op'>(</span><span class='st'>"iciotest"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
======================================================================
 Test Input Output Table, ICIO-type, 2022 edition
======================================================================

Individual sectors:
PRIMARY: D01T09 (Primary sector), MANUF: D10T39 (Manufacturing),
SRVWC: D41T98 (Services, including construction)

Sector groups:
TOTAL: D01T98 (Total goods and services), GOODSWU: D01T39 (Goods,
total, incl. utilities)</code></pre>
</div>
<p>To check the information about available countries, the command is
<code>info_geo()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/info_geo.html'>info_geo</a></span><span class='op'>(</span><span class='st'>"iciotest"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
======================================================================
 Test Input Output Table, ICIO-type, 2022 edition
======================================================================

Individual countries:
FRA (France), MEX (Mexico), ESP (Spain), USA (United States), CHN
(China), ROW (Rest of the world)

Groups of countries:
WLD (World), EU27 (EU-27), NONEU27 (Non-EU27), NAFTA (NAFTA), USMCA
(USMCA)</code></pre>
</div>
<p>These commands do not require to have a <code>wio</code> in the environment, so we
can just check what countries are available in the OECD’s ICIO tables, 2023
edition.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/info_geo.html'>info_geo</a></span><span class='op'>(</span><span class='st'>"icio2023"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
======================================================================
 OECD&#39;s Inter-Country Input-Output Table (ICIO), 2023 edition
======================================================================

Individual countries:
AUS (Australia), AUT (Austria), BEL (Belgium), CAN (Canada), CHL
(Chile), CZE (Czech Republic), DNK (Denmark), EST (Estonia), FIN
(Finland), FRA (France), DEU (Germany), GRC (Greece), HUN (Hungary),
ISL (Iceland), IRL (Ireland), ISR (Israel), ITA (Italy), JPN (Japan),
KOR (Korea), LVA (Latvia), LTU (Lithuania), LUX (Luxembourg), MEX
(Mexico), NLD (Netherlands), NZL (New Zealand), NOR (Norway), POL
(Poland), PRT (Portugal), SVK (Slovak Republic), SVN (Slovenia), ESP
(Spain), SWE (Sweden), CHE (Switzerland), TUR (Turkey), GBR (United
Kingdom), USA (United States), ARG (Argentina), BGD (Bangladesh), BLR
(Belarus), BRA (Brazil), BRN (Brunei Darussalam), BGR (Bulgaria), KHM
(Cambodia), CMR (Cameroon), CHN (China), COL (Colombia), CRI (Costa
Rica), CIV (Côte d&#39;Ivoire), HRV (Croatia), CYP (Cyprus), EGY (Egypt),
IND (India), IDN (Indonesia), JOR (Jordania), HKG (Hong Kong, China),
KAZ (Kazakhstan), LAO (Laos), MYS (Malaysia), MLT (Malta), MAR
(Morocco), MMR (Myanmar), NGA (Nigeria), PAK (Pakistan), PER (Peru),
PHL (Philippines), ROU (Romania), RUS (Russia), SAU (Saudi Arabia),
SEN (Senegal), SGP (Singapore), ZAF (South Africa), TWN (Chinese
Taipei), THA (Thailand), TUN (Tunisia), UKR (Ukraine), VNM (Vietnam),
ROW (Rest of the world)

Groups of countries:
WLD (World), EU28 (EU-28), EU27 (EU-27), OECD (OECD), EMU (EMU),
NONEU28 (Non-EU28), NONEU27 (Non-EU27), NONOECD (Non-OECD),
EU28NONEMU (EU-28 not EMU), EU27NONEMU (EU-27 not EMU), EURNONEU
(Rest of Europe), EUROPE (Europe), AMER (America), NAMER (North
America), CSAMER (Central and South America), LATAM (Latin America
and Caribbean), AFRI (Africa), ASIA (Asia), OCEA (Oceania), ASIAOC
(Asia and Oceania), G20 (G-20), G7 (G7), NAFTA (NAFTA), USMCA
(USMCA), EEA (EEA), EFTA (EFTA), APEC (APEC), ASEAN (ASEAN), RCEP
(RCEP)</code></pre>
</div>
<p>Additionally, the commands <code>get_geo_codes()</code> and <code>get_sec_codes()</code>
provide details about the components of the different groups. These commands
are also directly applicable for any available input-output table. For
instance, for <code>"wiod2016"</code> we would have the following components of
NAFTA:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_geo_codes.html'>get_geo_codes</a></span><span class='op'>(</span><span class='st'>"NAFTA"</span>, wiotype <span class='op'>=</span> <span class='st'>"wiod2016"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;CAN|MEX|USA&quot;</code></pre>
</div>
<p>And for <code>"icio2023"</code> we have the following components of the information
services sector (<code>INFO</code>):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_sec_codes.html'>get_sec_codes</a></span><span class='op'>(</span><span class='st'>"INFO"</span>, wiotype <span class='op'>=</span> <span class='st'>"icio2023"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;D58T60|D61|D62T63&quot;</code></pre>
</div>
<p>Once we know the sector and geographical disaggregation, we can discuss
how to take advantage of the information contained in <code>exvatools</code> objects.</p>
<h2 data-number="7" id="breaking-down-decompositions"><span class="header-section-number">7</span> Breaking down decompositions</h2>
<p>Once we have obtained a decomposition, we can play with the results in terms of
sectors and countries of destination just using the command
<code>get_exvadec_bkdown()</code>. For instance, to select the value added in Spanish
exports of services (including construction) to the United States, we just have
to type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_exvadec_bkdown.html'>get_exvadec_bkdown</a></span><span class='op'>(</span><span class='va'>exvadec</span>, exporter <span class='op'>=</span> <span class='st'>"ESP"</span>, </span>
<span>                   sector <span class='op'>=</span> <span class='st'>"SRVWC"</span>, importer <span class='op'>=</span> <span class='st'>"USA"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>======================================================================
       DECOMPOSITION OF VALUE ADDED IN EXPORTS OF SPAIN IN 2022
               Sector: Services, including construction (SRVWC)
               Destination: United States (USA)
======================================================================
 VA_components                              USD_MM Percent
 Gross exports of goods and services (EXGR) 276.71 100.00 
   Domestic Content in VA (DC)              159.63  57.69 
     Domestic Value Added (DVA)             145.95  52.74 
       Value Added Exported (VAX)           127.28  46.00 
       Reflection (REF)                      18.67   6.75 
     Domestic Double Counting (DDC)          13.68   4.94 
   Foreign Content in VA (FC)               117.08  42.31 
     Foreign Value Added (FVA)              101.53  36.69 
     Foreign Double Counting (FDC)           15.55   5.62 
 Global Value Chain-related trade (GVC)     221.62  80.09 
 GVC-related trade, backward (GVCB)         130.76  47.26 
 GVC-related trade, forward (GVCF)           90.86  32.84 
======================================================================
Method: Borin and Mancini (2023), source-based, standard output
Country perspective, source approach</code></pre>
</div>
<p>Note that the bilateral <code>VAX</code> in this case shows the value added exported to
the United States, regardless of the final absorption country.</p>
<p>We can also produce an <code>exvadec</code> object will all countries and then select any
exporting country and any partner or sector:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>exvadec.all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/make_exvadec.html'>make_exvadec</a></span><span class='op'>(</span><span class='va'>wio</span>, exporter <span class='op'>=</span> <span class='st'>"all"</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>and then:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_exvadec_bkdown.html'>get_exvadec_bkdown</a></span><span class='op'>(</span><span class='va'>exvadec.all</span>, exporter <span class='op'>=</span> <span class='st'>"USA"</span>, </span>
<span>                   sector <span class='op'>=</span> <span class='st'>"MANUF"</span>, importer <span class='op'>=</span> <span class='st'>"CHN"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>======================================================================
   DECOMPOSITION OF VALUE ADDED IN EXPORTS OF UNITED STATES IN 2022
               Sector: Manufacturing (MANUF)
               Destination: China (CHN)
======================================================================
 VA_components                              USD_MM Percent
 Gross exports of goods and services (EXGR) 400.89 100.00 
   Domestic Content in VA (DC)              164.19  40.96 
     Domestic Value Added (DVA)             138.36  34.51 
       Value Added Exported (VAX)           114.29  28.51 
       Reflection (REF)                      24.06   6.00 
     Domestic Double Counting (DDC)          25.83   6.44 
   Foreign Content in VA (FC)               236.70  59.04 
     Foreign Value Added (FVA)              204.59  51.03 
     Foreign Double Counting (FDC)           32.12   8.01 
 Global Value Chain-related trade (GVC)     379.14  94.58 
 GVC-related trade, backward (GVCB)         262.53  65.49 
 GVC-related trade, forward (GVCF)          116.61  29.09 
======================================================================
Method: Borin and Mancini (2023), source-based, standard output
Country perspective, source approach</code></pre>
</div>
<p>Apart from the console printout, <code>get_exvadec_bkdown()</code> will output a
matrix with the results.</p>
<h2 data-number="8" id="extracting-data-from-exvatools-objects"><span class="header-section-number">8</span> Extracting data from exvatools objects</h2>
<p>The command <code>get_data()</code> takes an <code>exvatools</code> object (<code>wio</code> or
<code>exvadec</code>) and produces a value or a matrix of values. It allows a quick
extraction of data. The main advantage of <code>get_data()</code> is that it does not
only admit individual sectoral codes (<code>"MANUF"</code>) or destination country
codes (<code>"USA"</code>, <code>"NAFTA"</code>), but also lists of sectors and countries
in vector form. Therefore, we can easily produce a matrix of domestic value
added with breakdown by sector and by destination groups. The syntax of
<code>get_data()</code>is as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exvatools_object</span>, <span class='va'>variable</span>, exporter <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>         sector <span class='op'>=</span> <span class='st'>"TOTAL"</span>, importer <span class='op'>=</span> <span class='st'>"WLD"</span>, custom <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The arguments are as follows:</p>
<ul>
<li><code>exvatools_object</code> (required) is an object of class <code>wio</code>, <code>exvadec</code> or
<code>exvadir</code>, and <code>variable</code> is a string specifying one of the variables included
in the <code>exvatools_object</code>, such as <code>"EXGR"</code>, <code>"VAX"</code>, <code>"FVA"</code>, etc.</li>
<li><code>exporter</code> is a string vector with one or more codes of exporters or groups of
exporters, such as <code>"ESP"</code>, <code>"EU27"</code>, <code>c("WLD", "EU27", "NONEU27")</code>, etc. This
will define the rows in the resulting matrix. Specific exclusions can be
accepted through the excluding code <code>x</code> (lowercase x), so <code>"EU27xESP"</code> would
be EU countries, excluding Spain, <code>"WLDxEU27"</code> would be total world except EU,
and so on. More than one exception can be specified with the <code>"|"</code> element,
such as in <code>"WLDxESP|FRA|ITA"</code>. Available countries and country group id codes
can be checked with the command <code>info_geo()</code>. The argument <code>exporter</code> is
required in all cases except two: in case of a country-specific <code>exvadec</code>
object, in which the exporter is previously defined, and in case of an
<code>exvadir</code> object, where, by definition, there is only one exporter. Note that,
in the case of an <code>exvadir</code> object obtained for country <span class="math inline">\(s\)</span>, the argument
<code>exporter</code> does not refer to country <span class="math inline">\(s\)</span> itself, but to the <span class="math inline">\(t = 1 \dots G\)</span>
exporters of value added that is used by country <span class="math inline">\(s\)</span> to produce its exports.
Therefore, if the <code>exporter</code> argument is missing, the default behavior of
<code>get_data()</code> will be different, depending on the case: for a country-specific
<code>exvadec</code>, it will default to the exporting country, whereas for an <code>exvadir</code>
object it will default to <code>"WLD"</code> (i.e., sum of all origins of value added).</li>
<li><code>sector</code> is a string vector with one or more codes of sectors or groups
of sectors, such as <code>"MANUF"</code>, <code>"SERVS"</code>, <code>"TOTAL"</code>,
<code>c("TOTAL", "GOODSWU", "SRVWC")</code>, etc. These will also show as rows in
the result. Specific exclusions can be accepted through the excluding code
<code>x</code>, so <code>"MANUFxPET"</code> would be manufactures, excluding oil products,
<code>"SRVWCxBIZSV"</code> would be total services (with construction) except
business services, and so on. Available sector id codes can be checked with
the command <code>info_sec()</code>. Default option is <code>"TOTAL"</code> (sum of all
sectors for the specific exporter). The option <code>"all"</code> can be used to
specify all sectors.</li>
<li><code>importer</code> is a character string or vector with one or more codes of
importing countries or groups of countries, such as <code>"ESP"</code>,
<code>"EU27"</code>, <code>c("WLD", "EU27", "NONEU27")</code>, etc. This defines the
columns of the result. Default option is <code>"WLD"</code>, i.e, the sum of all
importers for the specific exporter (and sector) selection.</li>
<li><code>custom</code> is a boolean specifying whether custom-made groups of countries
or sectors present in the environment should be looked up by <code>get_data()</code>.
For instance, <code>HITECH</code> could be a specific variable including all
high-tech sectors, or <code>LDC</code> could be a list of least-developed countries.
Custom variables should be referred to as strings in <code>get_data()</code>, so, for
instance, <code>get_data(exva, "VAX", exporter = "LDC", custom = TRUE)</code> would
look for a variable called <code>LDC</code> in the environment and would use its
codes to extract and group data.</li>
</ul>
<p>We can use <code>get_data()</code> to summarize the foreign content of Spanish
exports, with a breakdown between EU and Non-EU origin (specifying a few
countries) and also distinguishing between goods (with utilities) and
services. We can also break down the destination of those exports between EU
and non-EU countries:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exvadir</span>, exporter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"WLD"</span>, <span class='st'>"EU27"</span>, <span class='st'>"FRA"</span>,</span>
<span>                               <span class='st'>"NONEU27"</span>, <span class='st'>"USA"</span><span class='op'>)</span>,</span>
<span>         sector <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TOTAL"</span>, <span class='st'>"GOODSWU"</span>, <span class='st'>"SRVWC"</span><span class='op'>)</span>,</span>
<span>         importer <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"WLD"</span>, <span class='st'>"EU27"</span>, <span class='st'>"NONEU27"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                       WLD      EU27    NONEU27
WLD_TOTAL       2501.78421 367.55781 2134.22640
WLD_GOODSWU     1772.66226 236.16941 1536.49285
WLD_SRVWC        729.12195 131.38840  597.73355
EU27_TOTAL       340.74928  49.39794  291.35134
EU27_GOODSWU     252.80996  33.55120  219.25877
EU27_SRVWC        87.93932  15.84674   72.09258
FRA_TOTAL        340.74928  49.39794  291.35134
FRA_GOODSWU      252.80996  33.55120  219.25877
FRA_SRVWC         87.93932  15.84674   72.09258
NONEU27_TOTAL   2161.03493 318.15987 1842.87505
NONEU27_GOODSWU 1519.85229 202.61821 1317.23408
NONEU27_SRVWC    641.18263 115.54166  525.64097
USA_TOTAL        433.65389  64.94868  368.70521
USA_GOODSWU      286.90179  38.50383  248.39796
USA_SRVWC        146.75210  26.44485  120.30725</code></pre>
</div>
<p>If there is not a specific group in the database of sectors or countries,
the user has two options: to create a group and use <code>get_data()</code> with the
option <code>custom = TRUE</code>, or simply to use a combination of countries or
sectors with a vertical line <code>"|"</code>.</p>
<p>In the latter case, for instance, if we want to combine <code>ESP</code> and <code>MEX</code>
in a single group, we can just type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exvadec.all</span>, <span class='st'>"VAX"</span>, exporter <span class='op'>=</span> <span class='st'>"ESP|MEX"</span>, </span>
<span>         sector <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TOTAL"</span>, <span class='st'>"MANUF"</span>, <span class='st'>"SRVWC"</span><span class='op'>)</span>, </span>
<span>         importer <span class='op'>=</span> <span class='st'>"USA"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                   USA
ESP|MEX_TOTAL 756.1258
ESP|MEX_MANUF 251.3334
ESP|MEX_SRVWC 257.0910</code></pre>
</div>
<p>If the vertical line <code>"|"</code> is used to join, the exception marker is <code>"x"</code>. It
allows us, for instance, to calculate NAFTA exports, both intra-regional and
extra-regional, employing services and non-services, using as extra-regional
<code>"WLDxNAFTA"</code> and as non-services <code>"TOTALxSRVWC"</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exvadec.all</span>, <span class='st'>"EXGR"</span>, exporter <span class='op'>=</span> <span class='st'>"NAFTA"</span>, </span>
<span>         sector <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TOTAL"</span>, <span class='st'>"TOTALxSRVWC"</span>, <span class='st'>"SRVWC"</span><span class='op'>)</span>, </span>
<span>         importer <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"WLD"</span>, <span class='st'>"NAFTA"</span>, <span class='st'>"WLDxNAFTA"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                        WLD    NAFTA WLDxNAFTA
NAFTA_TOTAL       13087.740 2602.338 10485.402
NAFTA_TOTALxSRVWC  8736.552 1502.340  7234.212
NAFTA_SRVWC        4351.188 1099.998  3251.189</code></pre>
</div>
<p>Let us use <code>get_data()</code>to calculate the relative comparative advantage (RCA) in
terms of gross exports and compare it with that in terms of VAX. The RCA is
the relation between the proportion of exports of sector <span class="math inline">\(i\)</span> in country <span class="math inline">\(s\)</span>
to total exports of <span class="math inline">\(s\)</span> (<span class="math inline">\(E_{si}/E_s\)</span>) and the proportion of world exports of
sector <span class="math inline">\(i\)</span> to total world exports (<span class="math inline">\(E_{wi}/E_w\)</span>). If RCA is more than 1, it
means that country <span class="math inline">\(s\)</span> has a relative specialization (and a comparative
advantage) in sector <span class="math inline">\(i%\)</span> compared to the world average.</p>
<p>We will create a function to calculate the RCA so it can be used with both
gross exports (<code>EXGR</code>) and value added exported (<code>VAX</code>). As we can see,
<code>get_data()</code> considerably simplifies the calculation of country exports
and sector exports.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>RCA</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>exva</span>, <span class='va'>exvar</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>Esi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exva</span>, <span class='va'>exvar</span>, exporter <span class='op'>=</span> <span class='st'>"all"</span>, sector <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span></span>
<span>  <span class='va'>Es</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exva</span>, <span class='va'>exvar</span>, exporter <span class='op'>=</span> <span class='st'>"all"</span>, sector <span class='op'>=</span> <span class='st'>"TOTAL"</span><span class='op'>)</span></span>
<span>  <span class='va'>Es</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Es</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='va'>exva</span><span class='op'>$</span><span class='va'>dims</span><span class='op'>$</span><span class='va'>N</span><span class='op'>)</span></span>
<span>  <span class='va'>Ewi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exva</span>, <span class='va'>exvar</span>, exporter <span class='op'>=</span> <span class='st'>"WLD"</span>, sector <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span></span>
<span>  <span class='va'>Ewi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Ewi</span><span class='op'>)</span>, <span class='va'>exva</span><span class='op'>$</span><span class='va'>dims</span><span class='op'>$</span><span class='va'>G</span><span class='op'>)</span></span>
<span>  <span class='va'>Ew</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exva</span>, <span class='va'>exvar</span>, exporter <span class='op'>=</span> <span class='st'>"WLD"</span>, sector <span class='op'>=</span> <span class='st'>"TOTAL"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>rca</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>Esi</span><span class='op'>/</span><span class='va'>Es</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>Ewi</span><span class='op'>/</span><span class='va'>Ew</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>rca</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"RCA"</span>, <span class='st'>"."</span>, <span class='va'>exvar</span><span class='op'>)</span></span>
<span>  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>rca</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'>RCA</span><span class='op'>(</span><span class='va'>exvadec.all</span>, <span class='st'>"EXGR"</span><span class='op'>)</span>,</span>
<span>           <span class='fu'>RCA</span><span class='op'>(</span><span class='va'>exvadec.all</span>, <span class='st'>"VAX"</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>           RCA.EXGR   RCA.VAX
ESP_01T09 0.7981206 0.4575154
ESP_10T39 1.1110328 1.0953243
ESP_41T98 1.0883393 1.3971980
FRA_01T09 1.0378051 0.7268141
FRA_10T39 1.0686493 1.1512224
FRA_41T98 0.8963249 1.0970064
MEX_01T09 1.0752922 1.3324652
MEX_10T39 0.9908369 1.0324864
MEX_41T98 0.9356388 0.6658469
USA_01T09 1.0464957 1.2057567</code></pre>
</div>
<p>We can see that some relative advantage (RCA &gt; 1) in terms of gross exports
disappear when calculated in terms of VAX, while some other appear.</p>
<p>Another useful application is the calculation of bilateral balances. We can
see that there are considerable difference in bilateral balances when
calculated in terms of value added compared to the same balances using gross
exports.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>EXGR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exvadec.all</span>, <span class='st'>"EXGR"</span>, <span class='st'>"all"</span>, importer <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span></span>
<span><span class='va'>IMGR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/bkt.html'>bkt</a></span><span class='op'>(</span><span class='va'>EXGR</span><span class='op'>)</span></span>
<span><span class='va'>VAX</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_data.html'>get_data</a></span><span class='op'>(</span><span class='va'>exvadec.all</span>, <span class='st'>"VAX"</span>, <span class='st'>"all"</span>, importer <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span></span>
<span><span class='va'>VAM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/bkt.html'>bkt</a></span><span class='op'>(</span><span class='va'>VAX</span><span class='op'>)</span></span>
<span><span class='va'>BALGR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>EXGR</span> <span class='op'>-</span> <span class='va'>IMGR</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>BALVA</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>VAX</span> <span class='op'>-</span> <span class='va'>VAM</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>BALGR</span>, <span class='st'>" "</span><span class='op'>=</span><span class='st'>" "</span>, <span class='va'>BALVA</span><span class='op'>)</span>,</span>
<span>              row.names <span class='op'>=</span> <span class='va'>exvadec.all</span><span class='op'>$</span><span class='va'>names</span><span class='op'>$</span><span class='va'>g_names</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>    ESP  FRA  MEX  USA  CHN ROW    ESP FRA  MEX  USA  CHN ROW
ESP   0    8 -394 -130 -158  49      0  30 -151  -34  -92 111
FRA  -8    0   53 -290 -544 173    -30   0  -28 -127 -253  96
MEX 394  -53    0  263  189 459    151  28    0   84   68 279
USA 130  290 -263    0 -570 -19     34 127  -84    0 -297  74
CHN 158  544 -189  570    0 464     92 253  -68  297    0 319
ROW -49 -173 -459   19 -464   0   -111 -96 -279  -74 -319   0</code></pre>
</div>
<h2 data-number="9" id="other-useful-commands"><span class="header-section-number">9</span> Other useful commands</h2>
<p><a href="https://cran.r-project.org/package=exvatools">exvatools</a> provides several additional commands, some of them
resulting from the mere combination of <code>make_exvadir()</code> and <code>get_data()</code> with
specific default arguments. Of course, it would be easy to create other custom combinations.</p>
<h3 data-number="9.1" id="detailed-origin-of-value-added"><span class="header-section-number">9.1</span> Detailed origin of value added</h3>
<p>The command <code>get_va_exgr()</code> provides a detailed sector and geographical origin
and destination of value added.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_va_exgr.html'>get_va_exgr</a></span><span class='op'>(</span><span class='va'>wio_object</span>, va_type <span class='op'>=</span> <span class='st'>"FC"</span>, </span>
<span>            geo_orig <span class='op'>=</span> <span class='st'>"all"</span>, sec_orig <span class='op'>=</span> <span class='st'>"TOTAL"</span>,</span>
<span>            <span class='va'>geo_export</span>, sec_export <span class='op'>=</span> <span class='st'>"TOTAL"</span>, as_numeric <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>It allows to analyze, for instance, the percentage of services (both domestic
and foreign) embedded in Spanish exports of manufactures, i.e. the so-called
‘servicification’ of Spanish exports:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_va_exgr.html'>get_va_exgr</a></span><span class='op'>(</span><span class='va'>wio</span>, va_type <span class='op'>=</span> <span class='st'>"TC"</span>, </span>
<span>            geo_orig <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ESP"</span>, <span class='st'>"WLDxESP"</span><span class='op'>)</span>, sec_orig <span class='op'>=</span> <span class='st'>"SRVWC"</span>,</span>
<span>            geo_export <span class='op'>=</span> <span class='st'>"ESP"</span>, sec_export <span class='op'>=</span> <span class='st'>"MANUF"</span>, </span>
<span>            as_numeric <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                    WLD
ESP_MANUF      84.95594
WLDxESP_MANUF 263.71717</code></pre>
</div>
<p>On the other hand, if we wanted the value added in services of the US
incorporated in the Spanish exports of manufactures, i.e., the Spanish
dependence of US services to produce exports of manufactures:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_va_exgr.html'>get_va_exgr</a></span><span class='op'>(</span><span class='va'>wio</span>, geo_orig <span class='op'>=</span> <span class='st'>"USA"</span>, sec_orig <span class='op'>=</span> <span class='st'>"SRVWC"</span>,</span>
<span>            geo_export <span class='op'>=</span> <span class='st'>"ESP"</span>, sec_export <span class='op'>=</span> <span class='st'>"MANUF"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 51.31605</code></pre>
</div>
<h3 data-number="9.2" id="detailed-final-absorption-of-value-added"><span class="header-section-number">9.2</span> Detailed final absorption of value added</h3>
<p>Sometimes we are not only interested in the origin, but also in the country of
final absorption. For that we have the command <code>get_va_exgry()</code>. This is
equivalent to the OECD’s Gross Exports by Origin of Value Added and Final
destination (<code>FD_EXGR_VA</code>, <code>FD_EXGRFNL_VA</code> and <code>FD_EXGRINT_VA</code>), but with much
more flexible geographical and sector options. Since the OECD TiVA database no
longer provides this indicator in their online version, this command becomes
particularly useful.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_va_exgry.html'>get_va_exgry</a></span><span class='op'>(</span><span class='va'>wio_object</span>, va_type <span class='op'>=</span> <span class='st'>"TC"</span>, flow_type <span class='op'>=</span> <span class='st'>"EXGRY"</span>,</span>
<span>             geo_orig <span class='op'>=</span> <span class='st'>"WLD"</span>, <span class='va'>geo_export</span>, sec_export <span class='op'>=</span> <span class='st'>"TOTAL"</span>,</span>
<span>             geo_fd <span class='op'>=</span> <span class='st'>"WLD"</span>, as_numeric <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Here <code>flow_type</code> are exports (expressed in terms of final demand), whether
total (<code>"EXGRY"</code>), final (<code>"EXGRY_FIN"</code>) or intermediate (<code>"EXGRY_INT"</code>), and
<code>geo_fd</code> is the country or region of final demand.</p>
<p>This allows, for instance, to calculate what part of US value added incorporated
in China’s exports of manufactures ends up absorbed back in the US.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_va_exgry.html'>get_va_exgry</a></span><span class='op'>(</span><span class='va'>wio</span>, geo_orig <span class='op'>=</span> <span class='st'>"USA"</span>, geo_export <span class='op'>=</span> <span class='st'>"CHN"</span>,</span>
<span>             sec_export <span class='op'>=</span> <span class='st'>"MANUF"</span>, geo_fd <span class='op'>=</span> <span class='st'>"USA"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 53.81984</code></pre>
</div>
<h3 data-number="9.3" id="value-added-induced-by-final-demand"><span class="header-section-number">9.3</span> Value added induced by final demand</h3>
<p><a href="https://cran.r-project.org/package=exvatools">exvatools</a> also provides a simple command to obtain details of both the
geographical and sector origin of the value added incorporated in exports
induced by final demand.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_va_fd.html'>get_va_fd</a></span><span class='op'>(</span><span class='va'>wio_object</span>, va_type <span class='op'>=</span> <span class='st'>"TOTAL"</span>,</span>
<span>          geo_orig <span class='op'>=</span> <span class='st'>"WLD"</span>, sec_orig <span class='op'>=</span> <span class='st'>"TOTAL"</span>,</span>
<span>          geo_fd <span class='op'>=</span> <span class='st'>"WLD"</span>, sec_fd <span class='op'>=</span> <span class='st'>"TOTAL"</span>, intra <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>This would allow, for instance, the calculation of the Chinese
total value added (or GDP) induced by US final demand for manufactures:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/exvatools/man/get_va_fd.html'>get_va_fd</a></span><span class='op'>(</span><span class='va'>wio</span>, geo_orig <span class='op'>=</span> <span class='st'>"CHN"</span>, sec_orig <span class='op'>=</span> <span class='st'>"TOTAL"</span>,</span>
<span>          geo_fd <span class='op'>=</span> <span class='st'>"USA"</span>, sec_fd <span class='op'>=</span> <span class='st'>"MANUF"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>              WLD
CHN_TOTAL 229.385</code></pre>
</div>
<h2 data-number="10" id="summary-and-conclusions"><span class="header-section-number">10</span> Summary and conclusions</h2>
<p>We have presented the package <a href="https://cran.r-project.org/package=exvatools">exvatools</a> for decomposition of value
added in exports using international-input out tables in <strong>R</strong>.
<a href="https://cran.r-project.org/package=exvatools">exvatools</a> provides a convenient tool for calculating and manipulating
international input-output matrices, and simplifies the decomposition of value
added in exports (using alternative methodologies). It also allows a
straightforward calculation of custom value added indicators.</p>
<p>The purpose of <a href="https://cran.r-project.org/package=exvatools">exvatools</a> is to provide the scientific community with
tools to take advantage of the valuable statistical resources that are the
international input-output tables, facilitating the analysis of the complex
interaction between trade in goods and services and between economic sectors in
different countries.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="10.1" id="cran-packages-used"><span class="header-section-number">10.1</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=exvatools">exvatools</a>, <a href="https://cran.r-project.org/package=ioanalysis">ioanalysis</a>, <a href="https://cran.r-project.org/package=decompr">decompr</a></p>
<h3 class="appendix" data-number="10.2" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">10.2</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Econometrics">Econometrics</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-arto_measuring_2019" class="csl-entry" role="listitem">
I. Arto, E. Dietzenbacher, J. M. Rueda-Cantuche, European Commission and Joint Research Centre. Measuring <span>Bilateral</span> <span>Trade</span> in <span>Terms</span> of <span>Value</span> <span>Added</span>. 2019. URL <a href="https://doi.org/10.2760/639612">https://doi.org/10.2760/639612</a> [online; last accessed May 27, 2020].
</div>
<div id="ref-asian_development_bank_multiregional_2023" class="csl-entry" role="listitem">
Asian Development Bank. Multiregional <span>Input</span>-<span>Output</span> <span>Database</span> (<span>ADB-MRIO</span>). 2023. URL <a href="https://kidb.adb.org/mrio">https://kidb.adb.org/mrio</a>.
</div>
<div id="ref-belotti_icio_2021" class="csl-entry" role="listitem">
F. Belotti, A. Borin and M. Mancini. Icio: <span>Economic</span> analysis with intercountry input–output tables. <em>The Stata Journal</em>, 21(3): 708–755, 2021. URL <a href="https://doi.org/10.1177/1536867X211045573">https://doi.org/10.1177/1536867X211045573</a> [online; last accessed November 23, 2021].
</div>
<div id="ref-borin_measuring_2023" class="csl-entry" role="listitem">
A. Borin and M. Mancini. Measuring what matters in value-added trade. <em>Economic Systems Research</em>, 1–28, 2023. URL <a href="https://doi.org/10.1080/09535314.2022.2153221">https://doi.org/10.1080/09535314.2022.2153221</a> [online; last accessed January 20, 2023].
</div>
<div id="ref-daudin_who_2011" class="csl-entry" role="listitem">
G. Daudin, C. Rifflart and D. Schweisguth. Who produces for whom in the world economy? <em>Canadian Journal of Economics</em>, 44(4): 1403–1437, 2011. URL <a href="https://doi.org/10.1111/j.1540-5982.2011.01679.x">https://doi.org/10.1111/j.1540-5982.2011.01679.x</a> [online; last accessed April 26, 2021].
</div>
<div id="ref-foster-mcgregor_value_2013" class="csl-entry" role="listitem">
N. Foster-McGregor and R. Stehrer. Value added content of trade: <span>A</span> comprehensive approach. <em>Economics Letters</em>, 120(2): 354–357, 2013. URL <a href="https://doi.org/10.1016/j.econlet.2013.05.003">https://doi.org/10.1016/j.econlet.2013.05.003</a> [online; last accessed June 4, 2022].
</div>
<div id="ref-johnson_measuring_2018" class="csl-entry" role="listitem">
R. C. Johnson. Measuring <span>Global</span> <span>Value</span> <span>Chains</span>. <em>Annual Review of Economics</em>, 10(1): 207–236, 2018. URL <a href="https://doi.org/10.1146/annurev-economics-080217-053600">https://doi.org/10.1146/annurev-economics-080217-053600</a> [online; last accessed June 11, 2021].
</div>
<div id="ref-johnson_accounting_2012" class="csl-entry" role="listitem">
R. C. Johnson and G. Noguera. Accounting for intermediates: <span>Production</span> sharing and trade in value added. <em>Journal of International Economics</em>, 86(2): 224–236, 2012. URL <a href="https://doi.org/10.1016/j.jinteco.2011.10.003">https://doi.org/10.1016/j.jinteco.2011.10.003</a> [online; last accessed April 26, 2021].
</div>
<div id="ref-koopman_tracing_2014" class="csl-entry" role="listitem">
R. Koopman, Z. Wang and S.-J. Wei. Tracing <span>Value</span>-<span>Added</span> and <span>Double</span> <span>Counting</span> in <span>Gross</span> <span>Exports</span>. <em>American Economic Review</em>, 104(2): 459–494, 2014. URL <a href="https://doi.org/10.1257/aer.104.2.459">https://doi.org/10.1257/aer.104.2.459</a> [online; last accessed May 27, 2020].
</div>
<div id="ref-lenzen_building_2013" class="csl-entry" role="listitem">
M. Lenzen, D. Moran, K. Kanemoto and A. Geschke. Building <span>Eora</span>: <span>A</span> <span>Global</span> <span>Multi</span>-<span>Region</span> <span>Input</span>–<span>Output</span> <span>Database</span> at <span>High</span> <span>Country</span> and <span>Sector</span> <span>Resolution</span>. <em>Economic Systems Research</em>, 25(1): 20–49, 2013. URL <a href="https://doi.org/10.1080/09535314.2013.769938">https://doi.org/10.1080/09535314.2013.769938</a> [online; last accessed June 4, 2022].
</div>
<div id="ref-leontief_quantitative_1936" class="csl-entry" role="listitem">
W. W. Leontief. Quantitative <span>Input</span> and <span>Output</span> <span>Relations</span> in the <span>Economic</span> <span>System</span> of the <span>United</span> <span>States</span>. <em>Review of Economics and Statistics</em>, 18: 105–125, 1936.
</div>
<div id="ref-los_measuring_2018" class="csl-entry" role="listitem">
B. Los and M. P. Timmer. Measuring <span>Bilateral</span> <span>Exports</span> of <span>Value</span> <span>Added</span>: <span>A</span> <span>Unified</span> <span>Framework</span>. w24896. NBER. 2018. URL <a href="https://www.nber.org/papers/w24896">https://www.nber.org/papers/w24896</a> [online; last accessed April 26, 2021].
</div>
<div id="ref-los_tracing_2016" class="csl-entry" role="listitem">
B. Los, M. P. Timmer and G. J. de Vries. Tracing <span>Value</span>-<span>Added</span> and <span>Double</span> <span>Counting</span> in <span>Gross</span> <span>Exports</span>: <span>Comment</span>. <em>American Economic Review</em>, 106(7): 1958–1966, 2016. URL <a href="https://doi.org/10.1257/aer.20140883">https://doi.org/10.1257/aer.20140883</a> [online; last accessed October 10, 2020].
</div>
<div id="ref-miroudot_decomposing_2021" class="csl-entry" role="listitem">
S. Miroudot and M. Ye. Decomposing <span>Value</span> <span>Added</span> in <span>Gross</span> <span>Exports</span>. <em>Economic Systems Research</em>, 33(1): 67–87, 2021. URL <a href="https://doi.org/10.1080/09535314.2020.1730308">https://doi.org/10.1080/09535314.2020.1730308</a> [online; last accessed May 16, 2021].
</div>
<div id="ref-nagengast_accounting_2016" class="csl-entry" role="listitem">
A. J. Nagengast and R. Stehrer. Accounting for the <span>Differences</span> <span>Between</span> <span>Gross</span> and <span>Value</span> <span>Added</span> <span>Trade</span> <span>Balances</span>. <em>The World Economy</em>, 39(9): 1276–1306, 2016. URL <a href="https://doi.org/10.1111/twec.12401">https://doi.org/10.1111/twec.12401</a> [online; last accessed October 10, 2020].
</div>
<div id="ref-oecd_oecd_2023" class="csl-entry" role="listitem">
OECD. <span>OECD</span> <span>Inter</span>-<span>Country</span> <span>Input</span>-<span>Output</span> <span>Database</span>. 2023. URL <a href="http://oe.cd/icio">http://oe.cd/icio</a>.
</div>
<div id="ref-quast_decompr_2015" class="csl-entry" role="listitem">
B. Quast and V. Kummritz. Decompr: <span>Global</span> <span>Value</span> <span>Chain</span> <span>Decomposition</span> in <span>R</span>. 2015-01. Centre for Trade &amp; Economic Integration. 2015. URL <a href="https://qua.st/decompr/">https://qua.st/decompr/</a>.
</div>
<div id="ref-remond-tierrez_eu_2019" class="csl-entry" role="listitem">
<span class="smallcaps">I. Remond-Tierrez and J. M. Rueda-Cantuche, eds</span>. <em><span>EU</span> inter-country supply, use and input-output tables: Full international and global accounts for research in input output analysis (<span>FIGARO</span>): 2019 edition.</em> LU: EU Publications Office, 2019. URL <a href="https://doi.org/10.2785/008780">https://doi.org/10.2785/008780</a> [online; last accessed June 11, 2023].
</div>
<div id="ref-statacorp_stata_2021" class="csl-entry" role="listitem">
StataCorp. Stata <span>Statistical</span> <span>Software</span>: <span>Release</span> 17. 2021.
</div>
<div id="ref-timmer_illustrated_2015" class="csl-entry" role="listitem">
M. P. Timmer, E. Dietzenbacher, B. Los, R. Stehrer and G. J. de Vries. An <span>Illustrated</span> <span>User</span> <span>Guide</span> to the <span>World</span> <span>Input</span>-<span>Output</span> <span>Database</span>: The <span>Case</span> of <span>Global</span> <span>Automotive</span> <span>Production</span>. <em>Review of International Economics</em>, 23(3): 575–605, 2015. URL <a href="https://doi.org/10.1111/roie.12178">https://doi.org/10.1111/roie.12178</a> [online; last accessed June 4, 2022].
</div>
<div id="ref-wade_ioanalysis_2020" class="csl-entry" role="listitem">
J. Wade and I. Sarmiento-Barbieri. Ioanalysis: <span>Input</span> <span>Output</span> <span>Analysis</span>. 2020. URL <a href="https://cran.r-project.org/web/packages/ioanalysis/ioanalysis.pdf">https://cran.r-project.org/web/packages/ioanalysis/ioanalysis.pdf</a>.
</div>
<div id="ref-wang_quantifying_2013" class="csl-entry" role="listitem">
Z. Wang, S.-J. Wei and K. Zhu. Quantifying <span>International</span> <span>Production</span> <span>Sharing</span> at the <span>Bilateral</span> and <span>Sector</span> <span>Levels</span>. 19677. National Bureau of Economic Research, Inc. 2013. URL <a href="https://econpapers.repec.org/paper/nbrnberwo/19677.htm">https://econpapers.repec.org/paper/nbrnberwo/19677.htm</a> [online; last accessed November 14, 2020].
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Feás, "exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools", The R Journal, 2024</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@article{RJ-2023-092,
  author = {Feás, Enrique},
  title = {exvatools: Value Added in Exports and Other Input-Output Table Analysis Tools},
  journal = {The R Journal},
  year = {2024},
  note = {https://doi.org/10.32614/RJ-2023-092},
  doi = {10.32614/RJ-2023-092},
  volume = {15},
  issue = {4},
  issn = {2073-4859},
  pages = {216-235}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
