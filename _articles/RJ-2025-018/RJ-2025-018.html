<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>CvmortalityMult: Cross-Validation for Multi-Population Mortality Models</title>

  <meta property="description" itemprop="description" content="This article presents the CvmortalityMult&#10;R package, a novel tool designed for modelling, forecasting and&#10;evaluating mortality models for several populations. The package&#10;facilitates the fitting and forecasting of multipopulation mortality&#10;models, providing accurate projections in an increasingly&#10;interconnected world characterized by minimal or no borders between&#10;countries. By incorporating different cross-validation (CV)&#10;techniques, the package allows for the assessment of the forecasting&#10;accuracy of multipopulation mortality models for specific countries or&#10;regions within a country. Through an empirical application to Spanish&#10;regions, we demonstrate the efficacy and simplicity of the&#10;CvmortalityMult&#10;R package in selecting and evaluating multipopulation mortality&#10;models. By providing accessible tools for mortality modelling,&#10;forecasting and testing, this package stands out as a valuable&#10;resource for advancing the understanding and forecasting of mortality&#10;trends across diverse populations. Its contributions extend to&#10;enhancing decision-making in critical fields such as life insurance,&#10;public health, and pension plan sustainability."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-09-24"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-09-24"/>
  <meta name="article:author" content="David Atance"/>
  <meta name="article:author" content="Ana Debón"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="CvmortalityMult: Cross-Validation for Multi-Population Mortality Models"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This article presents the CvmortalityMult&#10;R package, a novel tool designed for modelling, forecasting and&#10;evaluating mortality models for several populations. The package&#10;facilitates the fitting and forecasting of multipopulation mortality&#10;models, providing accurate projections in an increasingly&#10;interconnected world characterized by minimal or no borders between&#10;countries. By incorporating different cross-validation (CV)&#10;techniques, the package allows for the assessment of the forecasting&#10;accuracy of multipopulation mortality models for specific countries or&#10;regions within a country. Through an empirical application to Spanish&#10;regions, we demonstrate the efficacy and simplicity of the&#10;CvmortalityMult&#10;R package in selecting and evaluating multipopulation mortality&#10;models. By providing accessible tools for mortality modelling,&#10;forecasting and testing, this package stands out as a valuable&#10;resource for advancing the understanding and forecasting of mortality&#10;trends across diverse populations. Its contributions extend to&#10;enhancing decision-making in critical fields such as life insurance,&#10;public health, and pension plan sustainability."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="CvmortalityMult: Cross-Validation for Multi-Population Mortality Models"/>
  <meta property="twitter:description" content="This article presents the CvmortalityMult&#10;R package, a novel tool designed for modelling, forecasting and&#10;evaluating mortality models for several populations. The package&#10;facilitates the fitting and forecasting of multipopulation mortality&#10;models, providing accurate projections in an increasingly&#10;interconnected world characterized by minimal or no borders between&#10;countries. By incorporating different cross-validation (CV)&#10;techniques, the package allows for the assessment of the forecasting&#10;accuracy of multipopulation mortality models for specific countries or&#10;regions within a country. Through an empirical application to Spanish&#10;regions, we demonstrate the efficacy and simplicity of the&#10;CvmortalityMult&#10;R package in selecting and evaluating multipopulation mortality&#10;models. By providing accessible tools for mortality modelling,&#10;forecasting and testing, this package stands out as a valuable&#10;resource for advancing the understanding and forecasting of mortality&#10;trends across diverse populations. Its contributions extend to&#10;enhancing decision-making in critical fields such as life insurance,&#10;public health, and pension plan sustainability."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="CvmortalityMult: Cross-Validation for Multi-Population Mortality Models"/>
  <meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-018"/>
  <meta name="citation_pdf_url" content="RJ-2025-018.pdf"/>
  <meta name="citation_volume" content="17"/>
  <meta name="citation_issue" content="2"/>
  <meta name="citation_doi" content="10.32614/RJ-2025-018"/>
  <meta name="citation_journal_title" content="The R Journal"/>
  <meta name="citation_issn" content="2073-4859"/>
  <meta name="citation_firstpage" content="1"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2025/09/24"/>
  <meta name="citation_publication_date" content="2025/09/24"/>
  <meta name="citation_author" content="David Atance"/>
  <meta name="citation_author_institution" content="Universidad de Alcalá"/>
  <meta name="citation_author" content="Ana Debón"/>
  <meta name="citation_author_institution" content="Universitat Politècnica de València"/>
  <!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","slug","citation_url","packages","preview","bibliography","CTV","legacy_pdf","legacy_converted","output","draft","pdf_url","doi","creative_commons","csl"]}},"value":[{"type":"character","attributes":{},"value":["CvmortalityMult: Cross-Validation for Multi-Population Mortality Models"]},{"type":"character","attributes":{},"value":["This article presents the CvmortalityMult\nR package, a novel tool designed for modelling, forecasting and\nevaluating mortality models for several populations. The package\nfacilitates the fitting and forecasting of multipopulation mortality\nmodels, providing accurate projections in an increasingly\ninterconnected world characterized by minimal or no borders between\ncountries. By incorporating different cross-validation (CV)\ntechniques, the package allows for the assessment of the forecasting\naccuracy of multipopulation mortality models for specific countries or\nregions within a country. Through an empirical application to Spanish\nregions, we demonstrate the efficacy and simplicity of the\nCvmortalityMult\nR package in selecting and evaluating multipopulation mortality\nmodels. By providing accessible tools for mortality modelling,\nforecasting and testing, this package stands out as a valuable\nresource for advancing the understanding and forecasting of mortality\ntrends across diverse populations. Its contributions extend to\nenhancing decision-making in critical fields such as life insurance,\npublic health, and pension plan sustainability.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","orcid_id","address"]}},"value":[{"type":"character","attributes":{},"value":["David Atance"]},{"type":"character","attributes":{},"value":["Universidad de Alcalá"]},{"type":"character","attributes":{},"value":["0000-0001-5860-0584"]},{"type":"character","attributes":{},"value":["Departmento de Economía y Dirección de Empresas","Facultad de Ciencias Económicas, Empresariales y Turismo","Plaza San Diego s/n, 6020, Alcalá de Henares","Spain","[david.atance@uah.es](david.atance@uah.es){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","orcid_id","address"]}},"value":[{"type":"character","attributes":{},"value":["Ana Debón"]},{"type":"character","attributes":{},"value":["Universitat Politècnica de València"]},{"type":"character","attributes":{},"value":["0000-0002-5116-289X"]},{"type":"character","attributes":{},"value":["Centro de Gestión de la Calidad y del Cambio","Facultad de Administración y Dirección de Empresas","Camino de Vera, s/n, 46022, Valencia","Spain","[andeau@eio.upv.es](andeau@eio.upv.es){.uri}\n"]}]}]},{"type":"character","attributes":{},"value":["2025-09-24"]},{"type":"character","attributes":{},"value":["2024-10-01"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"double","attributes":{},"value":[1]},{"type":"NULL"}]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[2]},{"type":"character","attributes":{},"value":["RJ-2025-018"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-018"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"list","attributes":{},"value":[]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"list","attributes":{},"value":[]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","mathjax","md_extension"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"]},{"type":"character","attributes":{},"value":["-tex_math_single_backslash"]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["RJ-2025-018.pdf"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-018"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/home/hyndman/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["blocked_MSE_males.png","code/CvmortalityMult_reproduction.R","FIXED-ORIGIN.png","ForecastAddi.png","ForecastLC.png","ForecastMult.png","Ii_males.png","LOOCV_MSE_females.png","mapa_cas.png","MSE_ages.png","MSE_futpers.png","parametros_Addit_male.png","parametros_LC_male.png","parametros_Mult_male.png","RJ-2025-018_files/anchor-4.2.2/anchor.min.js","RJ-2025-018_files/bowser-1.9.3/bowser.min.js","RJ-2025-018_files/distill-2.2.21/template.v2.js","RJ-2025-018_files/header-attrs-2.29/header-attrs.js","RJ-2025-018_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2025-018_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2025-018_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2025-018_files/popper-2.6.0/popper.min.js","RJ-2025-018_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2025-018_files/tippy-6.2.7/tippy-light-border.css","RJ-2025-018_files/tippy-6.2.7/tippy.css","RJ-2025-018_files/tippy-6.2.7/tippy.umd.min.js","RJ-2025-018_files/webcomponents-2.0.0/webcomponents.js","RJ-2025-018.pdf","RJ-2025-018.zip","RJournal.sty","RJreferences.bib","RJtemplate.tex","RJwrapper.aux","RJwrapper.bbl","RJwrapper.blg","RJwrapper.brf","RJwrapper.fdb_latexmk","RJwrapper.fls","RJwrapper.log","RJwrapper.out","RJwrapper.synctex.gz","RJwrapper.tex","Rlogo-5.png","RO_RECALIBRATION.png","RW_RECALIBRATION.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="RJ-2025-018_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="RJ-2025-018_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="RJ-2025-018_files/popper-2.6.0/popper.min.js"></script>
  <link href="RJ-2025-018_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="RJ-2025-018_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="RJ-2025-018_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="RJ-2025-018_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="RJ-2025-018_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="RJ-2025-018_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="RJ-2025-018_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"CvmortalityMult: Cross-Validation for Multi-Population Mortality Models","description":"This article presents the CvmortalityMult\nR package, a novel tool designed for modelling, forecasting and\nevaluating mortality models for several populations. The package\nfacilitates the fitting and forecasting of multipopulation mortality\nmodels, providing accurate projections in an increasingly\ninterconnected world characterized by minimal or no borders between\ncountries. By incorporating different cross-validation (CV)\ntechniques, the package allows for the assessment of the forecasting\naccuracy of multipopulation mortality models for specific countries or\nregions within a country. Through an empirical application to Spanish\nregions, we demonstrate the efficacy and simplicity of the\nCvmortalityMult\nR package in selecting and evaluating multipopulation mortality\nmodels. By providing accessible tools for mortality modelling,\nforecasting and testing, this package stands out as a valuable\nresource for advancing the understanding and forecasting of mortality\ntrends across diverse populations. Its contributions extend to\nenhancing decision-making in critical fields such as life insurance,\npublic health, and pension plan sustainability.","doi":"10.32614/RJ-2025-018","authors":[{"author":"David Atance","authorURL":"#","affiliation":"Universidad de Alcalá","affiliationURL":"#","orcidID":"0000-0001-5860-0584"},{"author":"Ana Debón","authorURL":"#","affiliation":"Universitat Politècnica de València","affiliationURL":"#","orcidID":"0000-0002-5116-289X"}],"publishedDate":"2025-09-24T00:00:00.000+10:00","citationText":"Atance & Debón, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>CvmortalityMult: Cross-Validation for Multi-Population Mortality Models</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>This article presents the CvmortalityMult
R package, a novel tool designed for modelling, forecasting and
evaluating mortality models for several populations. The package
facilitates the fitting and forecasting of multipopulation mortality
models, providing accurate projections in an increasingly
interconnected world characterized by minimal or no borders between
countries. By incorporating different cross-validation (CV)
techniques, the package allows for the assessment of the forecasting
accuracy of multipopulation mortality models for specific countries or
regions within a country. Through an empirical application to Spanish
regions, we demonstrate the efficacy and simplicity of the
CvmortalityMult
R package in selecting and evaluating multipopulation mortality
models. By providing accessible tools for mortality modelling,
forecasting and testing, this package stands out as a valuable
resource for advancing the understanding and forecasting of mortality
trends across diverse populations. Its contributions extend to
enhancing decision-making in critical fields such as life insurance,
public health, and pension plan sustainability.</p></p>
</div>

<div class="d-byline">
  David Atance  (Universidad de Alcalá)
  
,   Ana Debón  (Universitat Politècnica de València)
  
<br/>2025-09-24
</div>

<div class="d-article">
<div class="article">
<h3 data-number="1" id="sec:intro"><span class="header-section-number">1</span> Introduction</h3>
<p><br />
Currently, the loss of clear and defined borders between
states/countries is leading populations worldwide to experience a
similar dynamic of mortality. Indeed, mortality improvements or
reductions can rapidly spread to other countries, causing correlated
mortality dynamics, as observed with the COVID-19 pandemic. Thus,
multipopulation mortality models provide a valuable approach for
considering mortality membership in a group rather than individually (N.
Li and Lee 2005). These models enable the joint fitting of multiple
populations, regions in the same country, or both sexes simultaneously.</p>
<p>On the basis of the original Lee and Carter (1992) model, many
researchers have developed models to fit the mortality of related
populations or countries with similar socioeconomic statutes or even
both sexes in the same population (Brouhns, Denuit, and Vermunt 2002;
Debón, Montes, and Martı́nez-Ruiz 2011; Dowd et al. 2011; Jarner and
Kryger 2011; J. S.-H. Li and Hardy 2011; Russolillo, Giordano, and
Haberman 2011; Villegas and Haberman 2014; Danesi, Haberman, and
Millossovich 2015; Chen and Millossovich 2018; Bégin, Sanders, and Xu
2023). The application of these multipopulation mortality models is
relevant in diverse contexts, facilitating the concurrent modelling of
multiple populations. This is particularly true within the field of life
insurance, where companies operate worldwide and make assumptions about
future mortality trends. Therefore, using such models ensures the
consistency and reliability of the products across different countries.
Notably, in the European Union, where gender-neutral pricing is
enforced, it is necessary to model both sexes simultaneously (Ahmadi and
Li 2014). Moreover, multipopulation mortality models can include the
correlation structure among populations when projecting future trends
(Antonio et al. 2017; Bozikas and Pitselis 2020).</p>
<p>The rise of “big data” has shifted the focus of many problems, and its
methods have become a new field complementary to statistics. Within this
domain, “resampling methods” are fundamental tools; these techniques are
based on repeatedly drawing samples from a dataset and refitting models
to obtain additional information. Advances in computational power have
increased researchers’ interest in these methods, which were developed
in 1990. The two most common types of “resampling methods” are bootstrap
and “cross-validation” (CV) methods (James, Witten, Hastie, and
Tibshirani 2013).</p>
<p>Bootstrap is a fundamental tool in the actuarial field that has had
multiple applications throughout the literature. This method has been
employed for various purposes, such as prediction errors in claim
insurance (England and Verrall 1999), establishing confidence bounds for
discounted reserves (Hoedemakers et al. 2003), and estimating confidence
intervals in mortality through different bootstrap versions (Brouhns,
Denuit, and Van Keilegom 2005; Koissi, Shapiro, and Högnäs 2006; Debón,
Montes, and Puig 2008; Liu and Braun 2010; D’Amato et al. 2012). The CV
method divides sample data into k folds, where <span class="math inline">\(k-1\)</span> subsets are
typically employed to train the model(s), and the remaining set is used
to test the forecasting accuracy (Hastie, Tibshirani, and Friedman
2009). The process is iterated k times. For time series data, preserving
the chronological order of the sets is necessary. This technique has
been employed in other fields, such as finance, biology, and marketing.
When applying CV methods to mortality modelling, these techniques must
be adapted to time series analysis to use all available data for both
testing and training (Tashman 2000; Bergmeir and Benı́tez 2012), which
are also known as time series CVs (Hastie, Tibshirani, and Friedman
2009). Specifically, in each iteration, the training set must consist of
observations that chronologically occurred before the test set
observations corresponding to the end of each series (Hyndman and
Athanasopoulos 2021). Furthermore, in our analysis, each observation
corresponds to a three-way array involving three categories: age, period
and region or country. As a result, these methods have been adapted to
assess the forecasting ability of multipopulation mortality models
appropriately.</p>
<p>In the context of mortality modelling it should be noted that only
recently researchers have applied CV techniques. However, most
applications have focused on single-population models, see, for
instance, Villegas et al. (2017; Hyndman et al. 2019; Atance, Debón, and
Navarro 2020; Kessy et al. 2022; SriDaran et al. 2022; Lindholm and
Palmborg 2022), and Barigou et al. (2023). To the best of our knowledge,
the existing literature on the use of resampling methods in mortality
modelling has focused on single-population mortality models, and among
these studies, only one SriDaran et al. (2022) introduced a CV function
designed for fitting, forecasting, and testing out-of-sample
age-specific probabilities of death, with the selection of the testing
period based on the mean squared error (MSE) measure.</p>
<p>This paper introduces the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package, which allows us to fit and forecast five multipopulation
mortality models. Moreover, this package enables the application of CV
methods to select the “best” multipopulation mortality model in
forecasting among different scenarios. The idea is to determine which
model produces the best forecasting outcomes for the period and the
selected countries or regions. To achieve this goal, we implement
several CV techniques following the terminology established by Tashman
(2000) and Bergmeir and Benı́tez (2012) for evaluating time-series
forecasts. Additionally, we adapt the methodology proposed by Atance,
Debón, and Navarro (2020), which is primarily designed for
single-population mortality models, to evaluate the forecasting ability
of multipopulation mortality models over short, medium and long term
horizons. The package incorporates multiple CV techniques to facilitate
this evaluation.</p>
<p>Moreover, the package includes five variations of the classical Lee and
Carter (1992) model to fit and forecast mortality in regions/populations
that form part of a group rather than considering them individually.
First, Russolillo, Giordano, and Haberman (2011) proposed adding a new
multiplicative effect to represent different countries/regions within a
multiplicative mortality model. Second, Debón, Montes, and Martı́nez-Ruiz
(2011) integrated the region/country effect as an additive index through
an additive model. Third, Carter and Lee (1992) and N. Li and Lee (2005)
first modelled the entire group and then incorporated a specific term
for each region/country using the common-factor model. Fourth, Carter
and Lee (1992) and Wilmoth and Valkonen (2001) proposed the joint-K
model, which includes two specific country/region terms along with a
common trend. Finally, N. Li and Lee (2005) and Hyndman and Ullah (2007)
extended the common-factor model by incorporating two additional
region/country terms with the augmented common-factor model. These five
multipopulation mortality models were chosen because of their promising
results compared with those of other mortality models (Debón, Montes,
and Martı́nez-Ruiz 2011; Dong et al. 2020), and their frequent usage in
multipopulation modelling literature (Villegas et al. 2017). We
introduce into the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package several functions that allow us to fit, forecast and
evaluate those five multipopulation mortality models. However, if the
functions detect only one population, they can fit the well-known Lee
and Carter (1992) model.</p>
<p>The paper is structured as follows. Section 2 focuses on describing
multipopulation mortality models. Section 3 discusses the CV methods in
multipopulation mortality models. Section 4 presents the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package, installation and the main functions. Section 5 presents a
case study detailing the use of the package. Finally, Section 6 draws
conclusions from the results in the previous section.</p>
<h3 data-number="2" id="sec:models"><span class="header-section-number">2</span> Models</h3>
<p>In this section, we introduce five of the most important multipopulation
mortality models, which serve as benchmarks to test the forecasting
accuracy using CV methods. Indeed, the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package requires a set of crude age-specific probabilities of death
for age <span class="math inline">\(x\)</span>, period <span class="math inline">\(t\)</span> and, in each region <span class="math inline">\(i\)</span>, <span class="math inline">\(\dot{q}_{x,t,i}\)</span>.
These crude rates are directly obtained as
<span class="math inline">\(\dot{q}_{x,t,i}=d_{x,t,i}/E^{0}_{x,t,i}\)</span>, where <span class="math inline">\(d_{x,t,i}\)</span> represents
the number of recorded deaths and <span class="math inline">\(E_{x,t,i}\)</span> denotes the initial
population exposed to risk for an age <span class="math inline">\(x\)</span>, period <span class="math inline">\(t\)</span> and, region <span class="math inline">\(i\)</span>.
Crude mortality rates, along with other life table indicators, can be
obtained using the <code>LifeTable</code> function from the <strong>MortalityLaws</strong> <em>R</em>
package (Pascariu 2022). This set of crude probabilities is then used to
generate smoothed and forecasted estimates, <span class="math inline">\(\hat{q}_{x,t,i}\)</span>, of the
true but unknown mortality probabilities <span class="math inline">\(q_{x,t,i}\)</span>. Therefore, in the
context of multipopulation mortality data, “one observation ahead”
corresponds to a set of data containing the probabilities of death for
all ages and populations considered for the following year.</p>
<h4 class="unnumbered" data-number="2.1" id="multiplicative-mortality-model">Multiplicative mortality model</h4>
<p>Russolillo, Giordano, and Haberman (2011) proposed incorporating a
multiplicative index term into the Lee and Carter (1992) model to shift
the mortality for each region in the population group. That is:
<span class="math display" id="eq:EQ-ruso">\[\textrm{logit}\left(q_{x,t,i} \right)=\textrm{log}\left(\frac{q_{x,t,i}}{1-q_{x,t,i}}\right)=a_x + b_x \cdot k_t \cdot I_i + \varepsilon_{x,t,i};
\label{EQ_ruso}   \tag{1}\]</span>
where <span class="math inline">\(a_x\)</span> captures the general age shape of the mortality curve, <span class="math inline">\(k_t\)</span>
describes the general trend of the group of populations over time, <span class="math inline">\(b_x\)</span>
represents how each age-specific probability of death reacts to changes
in the general level of mortality, and <span class="math inline">\(I_i\)</span> represents a multiplicative
index associated with mortality for each member of the group of
populations considered. Both <span class="math inline">\(a_x\)</span> and <span class="math inline">\(b_x\)</span> are the common
age-dependent and time-independent parameters for all the regions
considered respectively, whereas <span class="math inline">\(k_t\)</span> is the same for all considered
regions and corresponds with the time-dependent parameter, as in the
initial version of Lee and Carter (1992), <span class="math inline">\(I_i\)</span> is a different index for
each population considered.</p>
<p>Notably, the logit link function is employed to fit the age-specific
probabilities of death. The logit transformation ensures that values of
<span class="math inline">\(q_{x,t,i}\)</span> between 0 and 1 (Lee 2000) are obtained. This transformation
also maintains the historical ties to the early actuarial work of Perks
(1932), as noted by Haberman and Renshaw (2011).</p>
<h4 class="unnumbered" data-number="2.2" id="additive-mortality-model">Additive mortality model</h4>
<p>Debón, Montes, and Martı́nez-Ruiz (2011) propose incorporating an
additive index term into the Lee-Carter structure to modify the
mortality of each region in the multipopulation model. Its expression is
as follows:
<span class="math display" id="eq:EQ-addit">\[\textrm{logit}\left(q_{x,t,i} \right)=\textrm{log}\left(\frac{q_{x,t,i}}{1-q_{x,t,i}}\right)=a_x + b_x \cdot k_t + I_i + \varepsilon_{x,t,i}.
\label{EQ_addit}   \tag{2}\]</span>
As in the previous model, the same components <span class="math inline">\(a_x\)</span>, <span class="math inline">\(b_x\)</span> and <span class="math inline">\(k_t\)</span> are
shared across all the studied regions (populations). This fact is a
necessary and sufficient condition to avoid divergence in the
forecasting of age-specific probabilities of death of subpopulations;
see Debón, Montes, and Martı́nez-Ruiz (2011) and Ahcan et al. (2014). The
number of parameters is the same as that in the model of Russolillo,
Giordano, and Haberman (2011), with similar interpretations except for
<span class="math inline">\(I_i\)</span>; more details are given in Debón, Montes, and Martı́nez-Ruiz
(2011). However, the additive formulation provides a more
straightforward structure than the multiplicative formulation does
because it incorporates regional effects through an additive index term.</p>
<h4 class="unnumbered" data-number="2.3" id="common-factor-mortality-model">Common-factor mortality model</h4>
<p>Carter and Lee (1992) and N. Li and Lee (2005) proposed modelling the
mortality of different populations through a common long-term component
for the whole group combined with an age-dependent specific term for
each population <span class="math inline">\(i\)</span>. This model is represented as:
<span class="math display" id="eq:EQ-CFM">\[\textrm{logit}\left(q_{x,t,i} \right)=\textrm{log}\left(\frac{q_{x,t,i}}{1-q_{x,t,i}}\right)=a_{x,i} + B_x \cdot K_t + \varepsilon_{x,t,i},
\label{EQ_CFM}   \tag{3}\]</span>
where <span class="math inline">\(a_{x,i}\)</span> represents the baseline shape of the mortality curve for
each <span class="math inline">\(i\)</span>th specific population, while the long-term change over time
across the whole mortality group is captured by <span class="math inline">\(B_x \cdot K_t\)</span>. These
parameters serve the same function as <span class="math inline">\(b_x\)</span> and <span class="math inline">\(k_t\)</span> do in previous
mortality models but apply to the whole group of populations.</p>
<h4 class="unnumbered" data-number="2.4" id="joint-k-mortality-model">Joint-k mortality model</h4>
<p>Carter and Lee (1992) and Wilmoth and Valkonen (2001) introduced a model
that assumes two specific population age-dependent terms, and a common
trend among the group of populations, is given by:
<span class="math display" id="eq:EQ-jointk">\[\textrm{logit}\left(q_{x,t,i} \right)=\textrm{log}\left(\frac{q_{x,t,i}}{1-q_{x,t,i}}\right)=a_{x,i} + b_{x,i} \cdot k_{t} + \varepsilon_{x,t,i}.
\label{EQ_jointk}   \tag{4}\]</span>
where <span class="math inline">\(k_{t}\)</span> represents a common mortality trend among the different
considered populations while <span class="math inline">\(a_{x_{i}}\)</span> and <span class="math inline">\(b_{x_{i}}\)</span> are specific
for each population <span class="math inline">\(i\)</span>. Indeed, the <span class="math inline">\(a_{x_{i}}\)</span> parameter retains the
same meaning as in the common factor mortality model, and <span class="math inline">\(b_{x_{i}}\)</span>
captures the effect of a time-varying mortality index <span class="math inline">\(k_t\)</span> at age <span class="math inline">\(x\)</span>
for each population <span class="math inline">\(i\)</span>.</p>
<h4 class="unnumbered" data-number="2.5" id="augmented-common-factor-mortality-model">Augmented common-factor mortality model</h4>
<p>N. Li and Lee (2005) and Hyndman, Booth, and Yasmeen (2013) introduced
two population-specific terms to the common factor model. This model is
expressed as:
<span class="math display" id="eq:EQ-ACFM">\[\textrm{logit}\left(q_{x,t,i} \right)=\textrm{log}\left(\frac{q_{x,t,i}}{1-q_{x,t,i}}\right)=a_{x,i} + B_x \cdot K_t + b_{x,i} \cdot k_{t,i} + \varepsilon_{x,t,i}.
\label{EQ_ACFM}   \tag{5}\]</span>
The first three terms correspond to the components of the common-factor
mortality model <a href="#eq:EQ-CFM">(3)</a>, whereas <span class="math inline">\(b_{x_i} \cdot k_{t_i}\)</span>
captures deviations in the short to medium-term changes in the
age-specific probability of death for each population <span class="math inline">\(i\)</span> to the common
trend. Importantly, including the population-specific terms <span class="math inline">\(b_{x_i}\)</span>
and <span class="math inline">\(k_{t_i}\)</span> may imply significant divergences in the mortality
forecasts across different populations. Our choice of capital letters in
Equations <a href="#eq:EQ-CFM">(3)</a> and <a href="#eq:EQ-ACFM">(5)</a> follows the notation
introduced by N. Li and Lee (2005), who use upper-case symbols to denote
the common (or “group-wide”) Lee–Carter factor and lower-case symbols
for the population-specific effects.</p>
<p>All the models discussed are implemented using the software R Core Team
(2022) via the <strong>gnm</strong> library (Turner and Firth 2023). Details on the
calibration approach can be found in Debón, Montes, and Martı́nez-Ruiz
(2011). The parameters are obtained by maximizing the model’s
log-likelihood, assuming a quasi-Binomial distribution of deaths in all
considered models:
<span class="math display">\[L\left( q_{x,t,i}; \hat{q}_{x,t,i}\right) = \sum_{x} \sum_{t} \sum_{i} w_{x,t,i} \left\lbrace q_{x,t,i} \cdot \log \left( \hat{q}_{x,t,i}\right) + \left(1 - q_{x,t,i}\right) \cdot \log\left(1-\hat{q}_{x,t,i}\right) + \textrm{cte} \right\rbrace,\]</span>
where <span class="math inline">\(w_{x,t,i}\)</span> corresponds to weights assigned to each age, period,
and population considered, <span class="math inline">\(\hat{q}_{x,t,i}\)</span> is derived by rearranging
the terms in Equation <a href="#eq:EQ-ruso">(1)</a>:
<span class="math display">\[\hat{q}_{x,t,i} = \frac{e^{a_x + b_x \cdot k_t \cdot I_i}}{1+e^{a_x + b_x \cdot k_t \cdot I_i}},\]</span>
in the case of the multiplicative model. For the other models, the
corresponding inverse transformations apply for <a href="#eq:EQ-addit">(2)</a> –
<a href="#eq:EQ-ACFM">(5)</a>. We maximize the log-likelihood function because it is
an effective estimation method in the actuarial and demography
literature for the parameter estimation process (Brouhns, Denuit, and
Vermunt 2002; Renshaw and Haberman 2006; A. J. Cairns et al. 2009).</p>
<h4 class="unnumbered" data-number="2.6" id="forecasting-multipopulation-mortality-models">Forecasting multipopulation mortality models</h4>
<p>To project the age-specific probabilities of death, <span class="math inline">\(q_{x,t,i}\)</span>, it is
essential to forecast the value of the trend parameters <span class="math inline">\(k_{t_{n}}\)</span>,
<span class="math inline">\(k_{t_{n},i}\)</span>, and <span class="math inline">\(K_{t_n}\)</span> for all the multipopulation mortality
models. These models are formulated as follows:
<span class="math display">\[\begin{split}
\textrm{Multiplicative} &amp; \rightarrow \textrm{logit} \left(q_{x,t_n + s,i} \right) = a_x + b_x \cdot k_{t_n + s} \cdot I_i,\\
\textrm{Additive} &amp; \rightarrow \textrm{logit} \left(q_{x,t_n + s,i} \right) = a_x + b_x \cdot k_{t_n + s} + I_i,\\
\textrm{Common-factor} &amp; \rightarrow \textrm{logit} \left(q_{x,t_n + s,i} \right) = a_{x,i} + B_x \cdot K_{t_n + s},\\
\textrm{Joint-k} &amp; \rightarrow \textrm{logit} \left(q_{x,t_n + s,i} \right) = a_{x,i} + b_{x,i} \cdot k_{t_n + s},\\
\textrm{Augmented common-factor} &amp; \rightarrow \textrm{logit} \left(q_{x,t_n + s,i} \right) = a_{x,i} + B_x \cdot K_{t_n + s} + b_{x,i} \cdot k_{t_{\left({n} + s\right)},i},\\
\end{split}\]</span>
where <span class="math inline">\(q_{x,t_n + s,i}\)</span> corresponds to the forecasted age-specific
probability of death for age <span class="math inline">\(x\)</span>, period <span class="math inline">\(t_{n} + s\)</span> and population <span class="math inline">\(i\)</span>,
and <span class="math inline">\(k_{t_n + s}\)</span>, <span class="math inline">\(k_{t_{\left({n} + s\right)},i}\)</span>, <span class="math inline">\(K_{t_n + s}\)</span> are
the projections of the trend parameters <span class="math inline">\(k_{t_{n}}\)</span>, <span class="math inline">\(k_{t_{n},i}\)</span>, and
<span class="math inline">\(K_{t_n}\)</span> considering that <span class="math inline">\(t_n\)</span> is the last in-sample period.</p>
<p>In the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package, three alternative approaches are considered to project the
time series <span class="math inline">\(k_t\)</span>, <span class="math inline">\(K_{t}\)</span> and <span class="math inline">\(k_{t_i}\)</span>, assuming they follow ARIMA
(autoregressive integrated moving average model) independent processes.
First, a random walk with drift (ARIMA (0,1,0) with drift) is assumed,
which is a common assumption in the actuarial literature (A. Cairns,
Blake, and Dowd 2006; Haberman and Renshaw 2011; Villegas, Kaishev, and
Millossovich 2018). Second, the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package allows the user to assume the best ARIMA (p,d,q) model
according to the <code>auto.arima</code> function in the <strong>forecast</strong> R- package
(Hyndman and Khandakar 2008; Hyndman et al. 2023) for each trend
parameter <span class="math inline">\(k_t\)</span>, <span class="math inline">\(K_{t}\)</span> and/or <span class="math inline">\(k_{t_i}\)</span>, as described by Debón,
Montes, and Puig (2008), Villegas, Kaishev, and Millossovich (2018) and
Hunt and Blake (2020). The <code>auto.arima</code> function determines the best
ARIMA (p,d,q) model on the basis of the outcomes according to the
corrected Akaike information criterion (AICc). Third, users can specify
the (p, d, q) order for each ARIMA model by setting the corresponding
parameters. Across the three approaches, the user can decide whether to
include different ARIMA configurations by changing the arguments in the
<code>auto.arima</code> or <code>Arima</code> functions as in the <strong>forecast</strong> <em>R</em> package.</p>
<h3 data-number="3" id="sCV"><span class="header-section-number">3</span> Cross-validation methods</h3>
<p>CV is a tool that focuses on assessing the predictive power of models.
Identifying the best model benefits insurance companies in actuarial and
financial applications, such as pricing and reserving, where forecasting
is arguably more relevant than explanation (SriDaran et al. 2022). Thus,
this methodology is valuable for identifying which model is the most
accurate forecaster for single-population mortality models (Atance,
Debón, and Navarro 2020) and can be used for a set of related
populations. This section describes the CV methods (Burman 1989;
Bergmeir and Benı́tez 2012) applied to evaluate the out-of-sample
accuracy of multipopulation models.</p>
<p>The performance of a model varies between in-sample and out-of-sample
evaluations (Bartolomei and Sweet 1989; Pant and Starbuck 1990).
Therefore, partitioning data into training and test sets is fundamental
for accurately assessing the forecasting ability of models. Various
possibilities exist for evaluating time series forecasts, also referred
to as the CV in time series (Hastie, Tibshirani, and Friedman 2009).
These methods differ on the basis of the forecast horizon and the method
of forecasting the out-of-sample validation, also known as “last block
evaluation” in individual time series analysis (Tashman 2000; Bergmeir
and Benı́tez 2012). Among the different available methods, we have
adapted several approaches in
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package to assess the forecasting ability of multipopulation
mortality models from different perspectives. Specifically, we follow
the terminology established by Tashman (2000) and Bergmeir and Benı́tez
(2012) to evaluate time series forecasting but adapt it for
multipopulation mortality models.</p>
<h4 class="unnumbered" data-number="3.1" id="fixed-origin-evaluation">Fixed-origin evaluation</h4>
<p>Fixed-origin evaluation, also known as the out-of-sample test or
hold-out method (Lachenbruch and Mickey 1968; Tashman 2000), is one of
the most commonly used methods for assessing the forecasting accuracy of
mortality models (Ahcan et al. 2014; Atance, Balbás, and Navarro 2020).
In this approach, adapted for time series analysis, the dataset is
chronologically divided only once into training and test sets. The model
is fitted using the training set, with its final point as the fixed
origin for forecasting, as shown <a href="#fig1" data-reference-type="ref" data-reference="fig1">1</a> for a three-way array that incorporates three
dimensions: ages in rows, periods in columns, and regions in the third
dimension. This fixed-origin method generates a single forecast to
predict all or specific periods in the test set. The forecasting
accuracy is then evaluated for different forecast horizons.</p>
<p>This CV approach has also been employed for assessing the forecasting
ability of multipopulation mortality models; see, for instance, Danesi,
Haberman, and Millossovich (2015), Antonio et al. (2017) and Bozikas and
Pitselis (2020).</p>
<figure id="fig1">
<img src="FIXED-ORIGIN.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 1: A schematic representation of the three-way array utilizing
the fixed-origin cross-validation (CV) technique. The training and test
sets are shown in blue and orange, respectively. In our package, the
initial training set size is specified by the argument <code>trainset1</code>,
whereas the forecast horizon is defined by <code>nahead</code>. To ensure the
proper application of the fixed-origin evaluation, the sum of
<code>trainset1</code> and <code>nahead</code> must equal the total number of provided
periods.</figcaption>
</figure>
<h4 class="unnumbered" data-number="3.2" id="rolling-origin-recalibration-evaluation">Rolling-origin-recalibration evaluation</h4>
<p>In rolling-origin-recalibration (RO-recalibration) evaluation for time
series, we initiate the procedure by partitioning the sample into “k”
subsets of data, while maintaining the chronological order. The first
subset corresponds to the training set, and forecasts are generated with
a fixed horizon to assess the model’s performance. In each iteration,
the model is recalibrated by incorporating all preceding information in
the training set (Armstrong and Grohman 1972; Tashman 2000; Bergmeir and
Benı́tez 2012; Hyndman and Athanasopoulos 2021). The test set periods are
sequentially added to the training set to forecast the next set of
periods, as shown in <a href="#fig2" data-reference-type="ref" data-reference="fig2">2</a>.
Consequently, the beginning of the evaluation shifts forward at each
iteration. The model’s accuracy is assessed using the average
forecasting performance across the <span class="math inline">\(k\)</span> iterations:
<span class="math display" id="eq:Eq-KFold">\[\textrm{RO-recalibration}_k = \frac{1}{k}\sum^k_{i=1} \textrm{Goodness of fit measure}_i.
\label{Eq.KFold}   \tag{6}\]</span>
In this type of time series CV, the specific variant of rolling-origin
(RO) recalibration applied depends on the size of the initial training
set and the forecast horizon of each test set. For instance, k-fold CV
(Hastie, Tibshirani, and Friedman 2009; James, Witten, Hastie,
Tibshirani, and others 2013; Bergmeir, Hyndman, and Koo 2018) requires
the training set size and forecast horizon for each test set to be
equal. Notably, to our knowledge, the application of the k-fold CV for
analysing the forecasting proficiency of multipopulation mortality
models has yet to be documented. We recommend that the initial training
set contain more periods than the forecast horizon does to ensure
reliable results. If the training and test set sizes differ, the common
version RO-recalibration should be applied.</p>
<p>Notably, the “leave-one-out CV” (LOOCV) (Burman 1989; Shao 1993) is a
special case of RO-recalibration, where the forecast horizon is equal to
one, regardless of the initial training set size. Unlike approaches that
generate two subsets of comparable size, LOOCV is a distinct approach
that involves selecting and forecasting a single observation as the test
set, whereas the preceding available observations constitute the
training set. To implement this approach, the procedure is repeated (n -
<code>trainset1</code>) times, where <span class="math inline">\(n\)</span> denotes the total number of observations
in the dataset and (<code>trainset1</code>) is the size of the initial training
set.</p>
<p>Among the different resampling methods, this technique is widely
acknowledged for assessing the predictive performance of single
mortality models, as evidenced in various studies, such as those in H.
Li and O’Hare (2019), Atance, Debón, and Navarro (2020), Barigou et al.
(2023), and Atance and Navarro (2024). Additionally, only one
preliminary work Atance and Debón (2022) applied RO-recalibration LOOCV,
i.e., the prediction of multipopulation mortality models moving forward
by one year for each iteration.</p>
<figure id="fig2">
<img src="RO_RECALIBRATION.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 2: Schematic representation of the cross-validation method for
a three-way array using the rolling-origin (RO) recalibration technique.
The training, test, and omitted sets are depicted in blue, orange, and
white, respectively. The initial training set size is denoted as
<code>trainset1</code>, whereas <code>nahead</code> specifies both the forecast horizon and
the size of each test set.</figcaption>
</figure>
<h4 class="unnumbered" data-number="3.3" id="rolling-window-evaluation">Rolling-window evaluation</h4>
<p>“Rolling-window evaluation” is similar to RO-recalibration but maintains
a constant training set size across each forecast iteration (Armstrong
and Grohman 1972; Tashman 2000). It is also referred to as “time series
CV” (TSCV) (Hart 1994; Bergmeir and Benı́tez 2012), “fixed-size
rolling-window” (Swanson and White 1997), or “fixed-size rolling sample”
(Callen et al. 1996). Data are partitioned into training and test sets
as in previous techniques. In each iteration, the training set
incorporates the forecasted periods from the test set while discarding
the earliest observations and preserving chronological order, as shown
in <a href="#fig3" data-reference-type="ref" data-reference="fig3">3</a>. The model and the
forecast origin are also recalibrated at each window/iteration. The
forecasting accuracy of the model is assessed using the same procedure
as that in RO-recalibration, as expressed in Eq. (<a href="#eq:Eq-KFold">(6)</a>).</p>
<p>Similar to the RO-recalibration technique, there are different variants
of rolling-window evaluation. Indeed, the common CV, k-fold CV and LOOCV
approaches are also variants. However, in these approaches, the training
set size is constant throughout the iterations.</p>
<figure id="fig3">
<img src="RW_RECALIBRATION.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 3: Schematic representation of the cross-validation method for
a three-way array using the rolling-window evaluation technique. The
training, test, and omitted sets are depicted in blue, orange, and
white, respectively. The training set size, denoted as <code>trainset1</code>,
remains consistent across iterations, starting with an initial training
set. The argument <code>nahead</code> specifies both the forecast horizon and the
size of each test set.</figcaption>
</figure>
<p>To our knowledge, the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package provides the first function for analysing the forecasting
ability of multipopulation mortality models using CV techniques.
Notably, RO recalibration and rolling-window evaluation have not
previously been implemented in any <em>R</em> package for assessing the
forecasting accuracy of multipopulation mortality models. The
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package addresses this gap by enabling the application of various
time series CV methods.</p>
<h3 data-number="4" id="the-cvmortalitymult-r-package-secdescription-of-cvmortalitymult"><span class="header-section-number">4</span> The CvmortalityMult R-package {#sec:description of CvmortalityMult}</h3>
<p>Table <a href="#tab:T1" data-reference-type="ref" data-reference="T_functions">1</a>
introduces the main functions incorporated in the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package, along with a brief description of every function.
Furthermore, these functions have been categorized into four groups:
fitting, forecasting, plotting, and CV. In the following sections, we
explain with several examples the procedural details and parameter
structure essential for using the primary functions of the package.</p>
<p>Initially, the procedure involves the use of five mortality
multipopulation functions to calibrate age-specific probabilities of
death across various regions (populations). Notably, the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package allows for the fitting of a single-mortality model when the
user provides data for only one population.</p>
<p>During the forecasting stage, the package subsequently facilitates
age-specific probabilities of death projections under various
<span class="math inline">\(ARIMA (p,d,q)\)</span> specifications, employing the object obtained in the
preceding step. During the plotting stage, users have the opportunity to
visualize the parameters obtained in the initial fitting stage,
forecasts of the age-specific probability of death, and displays
specific values across the Spanish regions in a geographical map. This
procedure allows for a comprehensive understanding of the behaviour
exhibited by each population under consideration.</p>
<p>Finally, during the CV stage, we introduce the function for applying
different resampling methods to assess the forecasting accuracy of
multipopulation mortality models. This function enables the modification
of the fitting and forecasting periods, uses the functions of the
preceding steps, and allows for the evaluation of the model forecasting
performance using various goodness-of-fit measures. Notably, the
structure of the multipopulation mortality data was aligned with a
three-way array (age <span class="math inline">\(\times\)</span> time <span class="math inline">\(\times\)</span> region/population). For each
probability of death, data are available for different ages, periods and
regions/populations. Consequently, the applications of CV techniques
need to be adapted to evaluate the projecting ability of these models
effectively.</p>
<p>Notably, this paper does not include an example of every function
argument. However, the reader is referred to the function documentation
and the package vignette for a complete description of the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package.</p>
<div id="T_functions">
<table style="width:98%;">
<caption><span id="tab:T1">Table 1: </span> Summary of the main functions in the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package.</caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 21%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">Function name</th>
<th style="text-align: left;">Brief description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fitting</td>
<td style="text-align: left;"><code>fitLCmulti()</code></td>
<td style="text-align: left;">Fitting the multiplicative, additive,</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">common-factor, joint-k or</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">augmented common-factor multipopulation</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">mortality models, and the single version</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">of the Lee-Carter model.</td>
</tr>
<tr class="even">
<td>Forecasting</td>
<td style="text-align: left;"><code>forecast.fitLCmulti()</code></td>
<td style="text-align: left;">Forecasting the multiplicative, additive,</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;">or S3 method <code>forecast()</code></td>
<td style="text-align: left;">common-factor, joint-k or</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">augmented common-factor multipopulation</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">mortality models, and the single version</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">of the Lee-Carter model.</td>
</tr>
<tr class="odd">
<td>Plotting</td>
<td style="text-align: left;"><code>plot.fitLCmulti()</code></td>
<td style="text-align: left;">Plot the parameters for</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;">the S3 method <code>plot()</code></td>
<td style="text-align: left;">the multipopulation or single-population</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">mortality models.</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"><code>plot.forLCmulti()</code></td>
<td style="text-align: left;">Plot the forecasting parameters for</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;">the S3 method <code>plot()</code></td>
<td style="text-align: left;">the multipopulation or single-population</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">mortality models.</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"><code>SpainMap()</code></td>
<td style="text-align: left;">Plot the regions of</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Spain with the percentiles of the</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">variable chosen by the users.</td>
</tr>
<tr class="even">
<td>CV</td>
<td style="text-align: left;"><code>multipopulation_cv()</code></td>
<td style="text-align: left;">CV techniques using the</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">methods described in Section <a href="#sCV" data-reference-type="ref" data-reference="sCV">3</a>.</td>
</tr>
<tr class="even">
<td>Measures of accuracy</td>
<td style="text-align: left;"><code>MeasureAccuracy()</code></td>
<td style="text-align: left;">Measure for testing the accuracy</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">of the single-population or multipopulation</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">mortality models.</td>
</tr>
</tbody>
</table>
</div>
<p>Two datasets are included in the package: <code>SpainRegions</code> and <code>SpainNat</code>.
These datasets originate from the Spanish National Institute (Instituto
Nacional de Estadística, INE). Life tables and abridged lifetables were
obtained with the methodology proposed by Muriel, Cantalapiedra, and
López (2010) on the basis of the work in Elandt-Johnson and Johnson
(1980). On the one hand, the <code>SpainRegions</code> dataset comprises 10800
observations, encompassing 20 age groups, 30 periods (1990 - 2020), and
18 regions for both males and females in Spain, including national data
(the regions in Spain are referred to as autonomous communities). On the
other hand, the <code>SpainNat</code> dataset contains 600 observations,
corresponding to national data for males and females in Spain covering
20 age groups, 30 periods (this dataset was created for the application
of a single-population mortality model, and it can be obtained as a
subgroup of the <code>SpainRegions</code> database). These datasets are structured
as a data frame and include the following variables:</p>
<ul>
<li><p><code>ccaa</code>: A vector of the 17 different regions of Spain, including
national data. Figure <a href="#Spainmap" data-reference-type="ref" data-reference="Spainmap">4</a> shows the identification of each region on the
Spanish map.</p></li>
<li><p><code>years</code>: A vector of the period range, spanning from 1990 - 2020 for
both datasets.</p></li>
<li><p><code>ages</code>: A vector of the age groups (children under 1 year, between 1
year and 5 years, and then by groups of 5 years, with the last group
being between 90 and 94 years).</p></li>
<li><p><code>qx_male</code>: A vector of the age-specific probabilities of death for the
male population.</p></li>
<li><p><code>qx_female</code>: A vector of the age-specific probabilities of death for
the female population.</p></li>
<li><p><code>lx_male</code>: A vector of the estimated number of individual males living
in each age group during each period in a specific region/population,
based on an initial group of <span class="math inline">\(l_{0}=100,000\)</span> individuals aged 0
(Pitacco et al. 2009).</p></li>
<li><p><code>lx_female</code>: A vector of the estimated number of individual females
alive in each age group during each period in a specific
region/population.</p></li>
<li><p><code>series</code>: The sex included in both datasets “male and female
population”.</p></li>
<li><p><code>label</code>: A tag indicating the dataset type, either “Spain regions” or
“Spain National population”.</p></li>
</ul>
<figure id="fig4">
<img src="mapa_cas.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 4: Administrative structure of Spain (regions are
referred to as autonomous communities).</figcaption>
</figure>
<p>Furthermore, we have included the dataset <code>regions</code>, which contains the
geographical values of the Spanish regions. The <code>SpainMap</code> function
facilitates the creation of a map displaying the Spanish regions along
with the variables incorporated in this dataset.</p>
<h3 data-number="5" id="sec:application"><span class="header-section-number">5</span> Application of the CvmortalityMult R- package</h3>
<h4 class="unnumbered" data-number="5.1" id="sec:fitting">Fitting</h4>
<p>Model fitting of the age-specific probabilities of death, <span class="math inline">\(q_{x,t,i}\)</span>
(at age <span class="math inline">\(x\)</span>, period <span class="math inline">\(t\)</span>, and <span class="math inline">\(i\)</span> region/population), under a
quasi-Binomial distribution of deaths and a logit link is performed
using the <strong>gnm</strong> package developed by Turner and Firth (2023).</p>
<p>The proposed multipopulation mortality models present challenges related
to parameter identifiability. The parameter solution for the considered
multipopulation mortality models
<span class="math inline">\(\left(a_{x}, a_{x_{i}}, b_{x}, B_{x}, b_{x_{i}}, k_{t}, K_{t}, k_{t_{i}}, I_{i}\right)\)</span>
are not unique, as any transformation of these parameters that preserves
the model structure is also a solution, highlighting inherent
identifiability problems in mortality models (Enchev, Kleinow, and
Cairns 2017; Villegas, Kaishev, and Millossovich 2018). This
identifiability problem is addressed as follows: by setting
<span class="math inline">\(k_{t_0} = 0\)</span>, <span class="math inline">\(b_0 = 1\)</span> and <span class="math inline">\(I_1 = 1\)</span> for the multiplicative model; by
setting <span class="math inline">\(k_{t_0} = 0\)</span>, <span class="math inline">\(b_0 = 1\)</span> and <span class="math inline">\(I_1 = 0\)</span> for the additive model
(Debón, Montes, and Martı́nez-Ruiz 2011), by setting <span class="math inline">\(B_{0}=1\)</span>, and
<span class="math inline">\(K_{t_0}=0\)</span> for the common-factor model (Carter and Lee 1992), by
setting <span class="math inline">\(b_{0,1}=1\)</span>, and <span class="math inline">\(k_{t_0} = 0\)</span> for the joint-K model (Carter and
Lee 1992), and by setting <span class="math inline">\(B_{0}=1\)</span>, <span class="math inline">\(b_{0,1}=1\)</span>, <span class="math inline">\(K_{t_0}=0\)</span>, and
<span class="math inline">\(k_{t_{0,1}}=0\)</span> for the augmented-common-factor model (N. Li and Lee
2005).</p>
<p>The <code>fitLCmulti()</code> facilitates the fitting of multipopulation mortality
models, including the multiplicative model (Russolillo, Giordano, and
Haberman 2011), additive model (Debón, Montes, and Martı́nez-Ruiz 2011),
common-factor model (CFM) (Carter and Lee 1992), joint-K model (Carter
and Lee 1992) and augmented common-factor model (ACFM) (N. Li and Lee
2005). It also supports fitting a single version of the Lee-Carter model
(Lee and Carter 1992) in the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package. The synopsis of this function is outlined below:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitLCmulti</span>(model, qxt, periods, ages, nPop, <span class="at">lxt =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p>The fitting function requires the following information as input:</p>
<ul>
<li><p>The <code>model</code> refers to the multipopulation mortality model chosen to
fit the mortality rates. The available options include
<code>c(’additive’, ’multiplicative’, ’CFM’, ’joint-K’, ’ACFM’)</code>. Users
must select one model to fit.</p></li>
<li><p><code>qxt</code> is a vector or matrix containing the crude age-specific
probabilities of death for every age, period, and region. The function
automatically identifies the data structure (vector or matrix) that
users provide.</p></li>
<li><p><code>lxt</code> is a vector or matrix with the estimated number of individual
males alive in each age group during each period in a specific region.
The function automatically identifies the data structure (vector or
matrix) that users provide. If this argument is not included (<code>NULL</code>),
the function internally estimates this value to obtain the parameters
for fitting the multipopulation mortality model.</p></li>
<li><p>The <code>periods</code>, and <code>ages</code> vectors reflect the period range and age
range, respectively, from the dataset.</p></li>
<li><p><code>nPop</code> is a numeric value that indicates the number of
populations/regions considered in the dataset.</p></li>
</ul>
<p>Importantly, for the effective utilization of the fitting functions, the
array or matrix containing the <code>qxt</code> and <code>lxt</code> (if it is included)
should be organized chronologically with the primary or general
population placed first. This fact is essential for the ACFM, which
needs to fit first the mortality of the whole group. In the dataset
labelled <code>SpainRegions</code>, the principal population pertains to the
mortality data encompassing the entire nation of Spain and is positioned
as the first entry in the dataset.</p>
<p>We demonstrate the application of this function by fitting the additive
and multiplicative multipopulation mortality models to the
<code>SpainRegions</code> dataset for both male and female cases. However, the
other multipopulation mortality models can be applied only by modifying
the <code>model</code> input. Indeed, in the explanation of the function
<code>fitLCmulti()</code> in the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package, users can find examples of how other multipopulation
mortality models (common-factor, joint-k and augmented common-factor)
are fitted and forecasted for male Spain regions. Additionally, we
generate a vector containing the lower age in each age group considered
in the paper.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> SpainRegions</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Mortality Data</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Spain Regions <span class="cf">for</span> males and females</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Years <span class="dv">1991</span> <span class="sc">:</span> <span class="dv">2020</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Abridged Ages <span class="dv">0</span> <span class="sc">:</span> <span class="dv">90</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>          <span class="dv">45</span>, <span class="dv">50</span>, <span class="dv">55</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">90</span>)</span></code></pre></div>
<p>In fact, multiplicative and additive multipopulation mortality models
can be fitted using the following code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> additive_Spainmales <span class="ot">&lt;-</span> <span class="fu">fitLCmulti</span>(<span class="at">model=</span> <span class="st">&#39;additive&#39;</span>, <span class="at">qxt =</span> SpainRegions<span class="sc">$</span>qx_male,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span> <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">18</span>, <span class="at">lxt =</span> SpainRegions<span class="sc">$</span>lx_male)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> additive_Spainfemales <span class="ot">&lt;-</span> <span class="fu">fitLCmulti</span>(<span class="at">model=</span> <span class="st">&#39;additive&#39;</span>, <span class="at">qxt =</span> SpainRegions<span class="sc">$</span>qx_female,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span> <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">18</span>, <span class="at">lxt =</span> SpainRegions<span class="sc">$</span>lx_female)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> multi_Spainmales <span class="ot">&lt;-</span> <span class="fu">fitLCmulti</span>(<span class="at">model=</span> <span class="st">&#39;multiplicative&#39;</span>, <span class="at">qxt =</span> SpainRegions<span class="sc">$</span>qx_male,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span> <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">18</span>, <span class="at">lxt =</span> SpainRegions<span class="sc">$</span>lx_male)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> multi_Spainfemales <span class="ot">&lt;-</span> <span class="fu">fitLCmulti</span>(<span class="at">model =</span> <span class="st">&#39;multiplicative&#39;</span>, <span class="at">qxt =</span> SpainRegions<span class="sc">$</span>qx_female,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span> <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">18</span>, <span class="at">lxt =</span> SpainRegions<span class="sc">$</span>lx_female)</span></code></pre></div>
<p>The output from the fitting functions is an object of the class
<code>fitLCmulti</code>, which provides a brief summary of the fitting process,
including among other things, the following information:</p>
<ul>
<li><p><code>ax</code>, <code>bx</code>, <code>kt</code>, and <code>Ii</code> are the estimated parameters for the
multipopulation mortality models.</p></li>
<li><p><code>formula</code>, and <code>model</code> refer to the gnm formula and the fitted
multipopulation mortality model, respectively.</p></li>
<li><p><code>data.used</code> includes mortality rates to fit the mortality data.</p></li>
<li><p><code>qxt.crude</code> refers to the crude values of the probabilities of death
for every age, period, and region. These values are provided by the
user for fitting the selected mortality model.</p></li>
<li><p><code>qxt.fitted</code>, and <code>logit.qxt.fitted</code> are the fitted values of the
probabilities of death for every age, period, and region using the
multipopulation mortality model on a probability or logit scale
<span class="math inline">\(\left(\frac{q_{x,t}}{1-q_{x,t}} \right)\)</span>.</p></li>
</ul>
<p>Once we have adjusted the crude age-specific probabilities of death for
different groups of ages, periods, and regions, the <code>plot.fitLCmulti()</code>
function allows us to show the parameters obtained.
Figures <a href="#MultipliParam" data-reference-type="ref" data-reference="MultipliParam">5</a> and <a href="#AdditiveParam" data-reference-type="ref" data-reference="AdditiveParam">6</a> provide the fitted parameters of the additive
and multiplicative multipopulation mortality models, respectively, for
male populations in Spain. The plots are generated using the following
code:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(additive_Spainmales)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(multiplicative_Spainmales)</span></code></pre></div>
<p>Notably, the <code>plot.fitLCmulti()</code> function generates different plots
depending on the selected model. For example, if the augmented
common-factor model is chosen by setting <code>model = ’ACFM’</code>, the plot
function will display the estimated parameters, <span class="math inline">\(a_{x_i}\)</span>, <span class="math inline">\(B_x\)</span>, <span class="math inline">\(K_t\)</span>,
<span class="math inline">\(b_{x_i}\)</span>, and <span class="math inline">\(k_{t_i}\)</span>, for the provided populations.</p>
<p>Our example is the dataset of Spanish regions. We have included the
<code>SpainMap</code> function in the package. This function facilitates the
plotting of the <span class="math inline">\(I_i\)</span> parameters of the regions of Spain in
Figure <a href="#Iiparams" data-reference-type="ref" data-reference="Iiparams">7</a>. We
recommend reviewing the <code>regions</code> dataset to identify the order of the
regions before using the <code>SpainMap</code> function. In the context of
multipopulation mortality models, the multiplicative and additive
indices for the regions of Spain (with the reminder that the first
population is the national dataset and will not be shown) can be
obtained with the following code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">SpainMap</span>(multiplicative_Spainmales<span class="sc">$</span>Ii[<span class="dv">2</span><span class="sc">:</span><span class="dv">18</span>],</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">main =</span> <span class="fu">c</span>(<span class="st">&quot;Multiplicative for males&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Ii&quot;</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">SpainMap</span>(<span class="at">regionvalue =</span> additive_Spainmales<span class="sc">$</span>Ii[<span class="dv">2</span><span class="sc">:</span><span class="dv">18</span>],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">main =</span> <span class="fu">c</span>(<span class="st">&quot;Additive for males&quot;</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Ii&quot;</span>), <span class="at">bigred =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<figure id="MultipliParam">
<img src="parametros_Mult_male.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 5: Parameters for the multiplicative mortality model fitted to
the male population of Spain for ages 0 – 90 and the period 1991 –
2020.</figcaption>
</figure>
<p>Additionally, the fitting function applies to a single population.
Specifically, we design this function to fit cases where mortality data
are provided for only one population, and the Lee-Carter mortality model
for a single population is fitted. Users can implement this by using the
following <em>R</em> code:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> LC_SpainNatmales <span class="ot">&lt;-</span> <span class="fu">fitLCmulti</span>(<span class="at">model =</span> <span class="st">&#39;additive&#39;</span>, <span class="at">qxt =</span> SpainNat<span class="sc">$</span>qx_male,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span> <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">1</span>, <span class="at">lxt =</span> SpainNat<span class="sc">$</span>lx_male)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> LC_SpainNatfemales <span class="ot">&lt;-</span> <span class="fu">fitLCmulti</span>(<span class="at">model =</span> <span class="st">&#39;multiplicative&#39;</span>, <span class="at">qxt =</span> SpainNat<span class="sc">$</span>qx_female,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span> <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">1</span>, <span class="at">lxt =</span> SpainNat<span class="sc">$</span>lx_female)</span></code></pre></div>
<p>We use two of the five multipopulation models to demonstrate the
operation of the function for one-single population independently of the
model provided. However, there is no need to specify this argument in
the <code>fitLCmulti</code> function, as it inherently fits the Lee-Carter version
for a single population.</p>
<p>Similarly, the parameters of the Lee-Carter model for single-population
mortality can be plotted using the <code>plot.fitLCmulti()</code> function.
Therefore, Figure <a href="#LCParam" data-reference-type="ref" data-reference="LCParam">8</a> can be obtained using the following code:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LC_SpainNatmales)</span></code></pre></div>
<figure id="AdditiveParam">
<img src="parametros_Addit_male.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 6: Parameters for the additive mortality model fitted to the
male population in Spain regions for ages 0 – 90 and the period 1991 –
2020.</figcaption>
</figure>
<figure id="Iiparams">
<img src="Ii_males.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 7: Geographical index, <span class="math inline">\(I_i\)</span>, for multiplicative (left) and
additive (right) multipopulation mortality models for the male
populations in Spain regions for ages 0 – 90 and the period 1991 –
2020.</figcaption>
</figure>
<figure id="LCParam">
<img src="parametros_LC_male.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 8: Parameters for the LC single-population mortality model
fitted to the Spain male population for ages 0 – 90 and the period 1991
– 2020.</figcaption>
</figure>
<p>From Figures <a href="#MultipliParam" data-reference-type="ref" data-reference="MultipliParam">5</a>-<a href="#LCParam" data-reference-type="ref" data-reference="LCParam">8</a>, several interesting results emerge:</p>
<ul>
<li><p>All the left panels, <span class="math inline">\(a_x\)</span>, correspond to the average behaviour of
age-specific probabilities of death across all studied periods and
regions.</p></li>
<li><p>The second panels, <span class="math inline">\(b_x\)</span>, demonstrate how age-specific probabilities
of death for each age group (considering all regions) respond to
changes in mortality trend, as captured by <span class="math inline">\(k_t\)</span>. Large values of
<span class="math inline">\(b_x\)</span> are observed among Spanish males between 20 and 40 years of age;
therefore, there is a substantial reduction in the age-specific
probabilities of death in this age group (1991 - 2020). This
phenomenon is attributed to the impact of AIDS and drugs on Spanish
males during the 1980s and 1990s, which led to an initial increase in
age-specific probabilities of death and total deaths in these age
groups, followed by a significant decline in age-specific
probabilities of death due to the introduction of new therapies and
medications during the 1990s and 2000s (Felipe, Guillén, and
Perez-Marin 2002; Debón et al. 2008; Atance, Balbás, and Navarro
2020), as can be observed in <span class="math inline">\(b_{x}\)</span> for the additive and
multiplicative models.</p></li>
<li><p>The third panels reveal the impact of the COVID-19 pandemic on the
trend parameter <span class="math inline">\(k_t\)</span> for all considered models among males in Spain.
Similar trends can be observed for females, although these trends are
not shown. However, they can be generated by modifying the fitting
object in the plot function. The incorporation of 2020 into the model
fitting process induces an upturn in age-specific probabilities of
death in the final observed period, disrupting the declining trend
observed in the preceding years (1990 - 2019).</p></li>
<li><p>Finally, the right panels, <span class="math inline">\(I_i\)</span>, in the multipopulation approach
depict the geographical distribution of the indices corresponding to
each region. These panels allow us to discern distinct regional
behaviours on the basis of the chosen multipopulation approach. To
complement this presentation, we have included
Figure <a href="#Iiparams" data-reference-type="ref" data-reference="Iiparams">7</a>,
which displays the values of <span class="math inline">\(I_i\)</span> for Spanish males in each region
using the additive and multiplicative models with the regions with the
highest mortality highlighted in red. Notably, the parameter <span class="math inline">\(I_i\)</span>
leads to a different interpretation in each model. In the
multiplicative model, higher values indicate lower age-specific
probabilities of death as the region value is multiplied by the trend
parameter. Therefore, with a decreasing trend parameter, as observed
in the case of Spain, higher values of <span class="math inline">\(I_i\)</span> correspond to lower
age-specific probabilities of death. Conversely, the additive model
incorporates the region index to the general trend among the regions
(<span class="math inline">\(a_x + b_x \cdot k_t\)</span>). Consequently, lower values or the most
negative index regions present lower age-specific probabilities of
death.</p></li>
</ul>
<h4 class="unnumbered" data-number="5.2" id="forecasting">Forecasting</h4>
<p>The
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package enables the projection of future age-specific probabilities
of death using the ARIMA (p,d,q) processes. This projection applies to
the trend parameters, <span class="math inline">\(k_t\)</span>, <span class="math inline">\(K_t\)</span>, and <span class="math inline">\(k_{t,i}\)</span> in multipopulation
mortality models. Two common assumptions for the trend parameters <span class="math inline">\(k_t\)</span>,
<span class="math inline">\(K_t\)</span>, and <span class="math inline">\(k_{t,i}\)</span> in the actuarial and demography literature are
often considered: first, a multivariate random walk with drift
(ARIMA(0,1,0)) (A. Cairns, Blake, and Dowd 2006; A. J. Cairns et al.
2009; Haberman and Renshaw 2011; Villegas et al. 2017), and second, the
selection of the best ARIMA (p,d,q) process (Renshaw and Haberman 2006;
Debón, Montes, and Puig 2008; Villegas et al. 2017; Atance, Balbás, and
Navarro 2020) for estimating the future values of <span class="math inline">\(k_t\)</span>, <span class="math inline">\(K_t\)</span>, and
<span class="math inline">\(k_{t_i}\)</span>. To estimate the future values of the trend parameters <span class="math inline">\(k_t\)</span>,
<span class="math inline">\(K_t\)</span>, and <span class="math inline">\(k_{t_i}\)</span>, we employ the <code>forecast</code> function from the
<strong>forecast</strong> <em>R</em> package (Hyndman and Khandakar 2008), allowing the
projection of the future values for various types of ARIMA processes
considered in our package. In the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package, users can choose different ARIMA processes,
<code>ktmethod=c(’arima010’,’arimapdq’, ’arimauser’)</code>. The selection process
is applied for single or all trend parameters considered in each
multipopulation or single-population mortality model. The ellipsis
argument (<code>...</code>) provides users with the flexibility to include
different ARIMA configurations, changing the arguments in the
<code>auto.arima</code> or <code>Arima</code> functions, depending on the <code>ktmethod</code> provided.
This functionality mirrors the behavior of the <strong>forecast</strong> <em>R</em> package
for time series (Hyndman and Khandakar 2008). Additionally, users must
provide <code>nahead</code>, indicating the number of periods to forecast the
future value of age-specific probabilities of death for each considered
region. For example, the code below provides future age-specific
probabilities of death for Spanish male and female regions for the next
ten years (<code>nahead = 10</code>), using different ARIMA options in the package:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> fut_additive_Spainmales <span class="ot">&lt;-</span> <span class="fu">forecast</span>(<span class="at">object =</span> additive_Spainmales,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">nahead =</span> <span class="dv">10</span>, <span class="at">ktmethod =</span> <span class="st">&#39;arimapdq&#39;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> fut_multiplicative_Spainmales <span class="ot">&lt;-</span> <span class="fu">forecast</span>(<span class="at">object =</span> multiplicative_Spainmales,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">nahead =</span> <span class="dv">10</span>, <span class="at">ktmethod =</span> <span class="st">&#39;arima010&#39;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> fut_additive_Spainfemales <span class="ot">&lt;-</span> <span class="fu">forecast</span>(<span class="at">object =</span> additive_Spainfemales,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">nahead =</span> <span class="dv">10</span>, <span class="at">ktmethod =</span> <span class="st">&#39;arimapdq&#39;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> fut_multiplicative_Spainfemales <span class="ot">&lt;-</span> <span class="fu">forecast</span>(<span class="at">object =</span> multiplicative_Spainfemales,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">nahead =</span> <span class="dv">10</span>, <span class="at">ktmethod =</span> <span class="st">&#39;arima010&#39;</span>)</span></code></pre></div>
<p>The outputs from these forecast functions are objects of the class
<code>forLCmulti</code>, which provides a brief summary of the forecasting process,
with the following information:</p>
<ul>
<li><p><code>ax</code>, <code>bx</code>, <code>kt</code>, and <code>Ii</code> provide the estimated parameters for the
multipopulation mortality models.</p></li>
<li><p><code>arimakt</code> provides the ARIMA (p,d,q) process considered to adjust the
time series <span class="math inline">\(k_t\)</span>, <span class="math inline">\(K_t\)</span>, or <span class="math inline">\(k_{t_i}\)</span> and the obtained coefficients.</p></li>
<li><p><code>kt.fut</code> provides the future values of <span class="math inline">\(k_t\)</span>, <span class="math inline">\(K_t\)</span>, or <span class="math inline">\(k_{t,i}\)</span>
using the selected ARIMA (p,d,q) configurations for the <code>nahead</code>
periods.</p></li>
<li><p><code>kt.futintervals</code> provides estimates of the future values of <span class="math inline">\(k_t\)</span>,
<span class="math inline">\(K_t\)</span>, or <span class="math inline">\(k_{t,i}\)</span> for the point forecast (<code>kt.fut</code>). Additionally,
it includes the lower and upper 80% and 95% confidence intervals,
utilizing the chosen ARIMA (p,d,q) process for the specified <code>nahead</code>
periods.</p></li>
<li><p><code>formula</code> and <code>model</code> define the <code>gnm</code> formula and the forecasted
multipopulation mortality model, respectively.</p></li>
<li><p><code>qxt.crude</code> represents the crude values of the probabilities of death
for every age, period, and region. These values are provided by the
user for fitting the selected mortality models.</p></li>
<li><p><code>qxt.future</code>, and <code>logit.qxt.future</code> represent the future values of
the probabilities of death for every, age, period and region using the
chosen multipopulation mortality model in the probability or logit
scale.</p></li>
</ul>
<p>Once we have projected the age-specific probabilities of death from
different ages, periods, and regions, the <code>plot.forLCmulti()</code> function
allows us to show the projected values of trend parameters <span class="math inline">\(k_t\)</span>, <span class="math inline">\(K_t\)</span>,
and <span class="math inline">\(k_{t_i}\)</span>. The logit death probabilities for the mean in-sample age
and the out-of-sample forecast are shown for all the populations
considered. Figures <a href="#ForecasMult" data-reference-type="ref" data-reference="ForecasMult">9</a> and <a href="#ForecastAddi" data-reference-type="ref" data-reference="ForecastAddi">10</a> provide these interesting results for the
additive and multiplicative multipopulation mortality models,
respectively, for males in Spain. The visualizations are generated with
the following code:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(fut_additive_Spainmales)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(fut_multiplicative_Spainmales)</span></code></pre></div>
<figure id="ForecasMult">
<img src="ForecastMult.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 9: The left panel represents to the in-sample trend parameter
<span class="math inline">\(k_t\)</span> and its projected value. The right panel displays the actual and
projected logit mortality rates using the multiplicative multipopulation
mortality model for the 18 populations considered for age 40 (mean age
in the populations considered) in terms of the in-sample period from
1991 – 2020 and the out-of-sample period extending, 10 years
ahead.</figcaption>
</figure>
<figure id="ForecastAddi">
<img src="ForecastAddi.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 10: The left panel represents the in-sample trend parameter
<span class="math inline">\(k_t\)</span> and its projected value. The right panel displays the actual and
projected logit mortality rates using the additive multipopulation
mortality model for the 18 populations considered for age 40 (mean age
in the populations considered) in terms of the in-sample period from
1991 – 2020 and the out-of-sample period extending, 10 years
ahead.</figcaption>
</figure>
<p>Similarly, during the forecasting process, users can employ the same
function to project future values of age-specific probabilities of death
when providing data for a single population. Specifically, the function
forecasts age-specific probabilities of death using the Lee-Carter model
for a single population, as demonstrated below:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> fut_LC_Spainmales <span class="ot">&lt;-</span> <span class="fu">forecast</span>(<span class="at">object =</span> LC_SpainNatmales,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">nahead =</span> <span class="dv">10</span>, <span class="at">ktmethod =</span> <span class="st">&#39;arimapdq&#39;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> fut_LC_Spainfemales <span class="ot">&lt;-</span> <span class="fu">forecast</span>(<span class="at">object =</span> LC_SpainNatfemales,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">nahead =</span> <span class="dv">10</span>, <span class="at">ktmethod =</span> <span class="st">&#39;arima010&#39;</span>)</span></code></pre></div>
<p>Equally, for the single-population mortality model, users can plot two
remarkable results. For example,
Figure <a href="#ForecastLC" data-reference-type="ref" data-reference="ForecastLC">11</a>
can be obtained using the following code:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(fut_LC_Spainmales)</span></code></pre></div>
<figure id="ForecastLC">
<img src="ForecastLC.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 11: The left panel represents the in-sample trend parameter
<span class="math inline">\(k_t\)</span> and its projected value. The right panel displays the actual and
projected logit mortality rates using the Lee-Carter model for a single
population for the only population considered for age 40 (mean age in
the populations considered) in terms of the in-sample period from 1991
– 2020 and the out-of-sample period extending, 10 years
ahead.</figcaption>
</figure>
<h4 class="unnumbered" data-number="5.3" id="cross-validation">Cross-Validation</h4>
<p>In this section, we present the CV function developed in the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package to evaluate the forecasting ability of multipopulation
mortality models with different CV methods. Thus, the CV time series
function uses the next synopsis:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multipopulation_cv</span>(qxt, <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;multiplicative&#39;</span>, <span class="st">&#39;additive&#39;</span>, <span class="st">&#39;CFM&#39;</span>, <span class="st">&#39;joint-K&#39;</span>, <span class="st">&#39;ACFM&#39;</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   periods, ages, nPop, <span class="at">lxt =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   nahead, trainset1, <span class="at">fixed_train_origin =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">ktmethod =</span> <span class="fu">c</span>(<span class="st">&#39;arimapdq&#39;</span>, <span class="st">&#39;arima010&#39;</span>, <span class="st">&#39;arimauser&#39;</span>), <span class="at">order =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">&#39;SSE&#39;</span>, <span class="st">&#39;MSE&#39;</span>, <span class="st">&#39;MAE&#39;</span>, <span class="st">&#39;MAPE&#39;</span>, <span class="st">&#39;All&#39;</span>))</span></code></pre></div>
<p>This CV function requires the following information as input:</p>
<ul>
<li><p><code>qxt</code>, <code>lxt</code>, <code>periods</code>, <code>ages</code>, <code>nPop</code>, <code>ktmethod</code> and <code>order</code> should
match the corresponding values used as in the fitting and forecasting
functions for the multipopulation and single mortality models as
inputs.</p></li>
<li><p><code>model = c(’multiplicative’, ’additive’, ’CFM’, ’joint-K’, ’ACFM’)</code>
specifies the multipopulation mortality model that users wish to
assess for forecasting ability using the specific resampling
technique. Users can apply the multiplicative, additive,
common-factor, joint-K, and augmented common-factor multipopulation
models and the single version of the Lee-Carter model presented in
this paper separately.</p></li>
<li><p><code>measures = c(’SSE’, ’MSE’, ’MAE’, ’MAPE’, ’All’)</code> denotes the
adjustment measure that users wish to employ for testing the
forecasting ability of the model using the specific resampling
technique. If <code>measures = c(’All’)</code>, all the measures will be provided
by the function. Additionally, each accuracy measure has a dedicated
help function to clarify the underlying equations. Users can access
this help function in the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package using the following code: <code>?MeasureAccuracy</code>, where users
can select the specific measure of accuracy for testing the
age-specific mortality rates (SSE, MSE, MAE or MAPE).</p></li>
<li><p><code>trainset1</code> specifies the number of chronological periods to consider
as the initial training set. This value must be greater than 2 to meet
the minimum time series size (Hyndman and Khandakar 2008).
Additionally, we recommend that this value be greater than <code>nahead</code> to
maintain consistency among the forecasts in every iteration (Tashman
2000).</p></li>
<li><p><code>nahead</code> is the number of periods to project ahead in each iteration
and the size of each test set among the selected CV techniques.
Moreover, it should be noted that the <code>multipopulation_cv()</code> function
aims to maintain a uniform length for all the testing sets
(iterations). However, the last test set may have fewer periods to
align with the total number of periods provided by the user as
(<code>periods</code>).</p></li>
<li><p><code>fixed_train_origin = c(TRUE, FALSE, ’add_remove1’)</code> is a logical
variable that specifies whether the starting point of the initial
training set remains fixed throughout the CV process. This option
allows users to maintain a constant starting point where the model
will be fitted in every iteration or allow it to shift, thereby
determining whether a rolling window evaluation is applied. By
default, the package sets <code>fixed_train_origin = TRUE</code>, meaning that
the first period in the training set remains fixed across all
iterations and the model recalibrations of the CV method. However,
users can opt to allow the training set starting point to shift by
setting <code>fixed_train_origin = FALSE</code> or
<code>fixed_train_origin = ’add_remove1’</code>, thereby implementing a
rolling-window evaluation while keeping the training set size constant
in each iteration, defined by the user by <code>nahead</code> argument. When
<code>fixed_train_origin = FALSE</code>, in every iteration, the user-defined
<code>nahead</code> periods are removed from the beginning of the training set,
while the next <code>nahead</code> periods are added to the training set from the
previous test set. Consequently, the number of projected periods
(<code>nahead</code>) also determines how many periods are added or deleted in
every iteration. In contrast, when
<code>fixed_train_origin = ’add_remove1’</code>, the training set size is also
fixed across iterations. However, only one new period is added and one
period is removed in each forecast. This process allows users to
evaluate the forecasting accuracy of <code>nahead</code>-step-ahead projections
using more test samples. Users may specify
<code>fixed_train_origin = ’add_remove1’</code>, and any value of <code>nahead</code>
greater than or equal to one, provided it is consistent with the
number of periods available in the dataset. Notably, when
<code>nahead = 1</code>, the configuration <code>fixed_train_origin = ’add_remove1’</code>
yields results equivalent to those obtained using
<code>fixed_train_origin = FALSE</code>, which means in a LOOCV method keeping
the same size of the training set (<code>trainset1</code>) across iterations.</p></li>
</ul>
<p>The sizes of <code>nahead</code> and <code>trainset1</code> can be determined by the temporal
correlation within the values of the analysed series by using “blocks”
of data rather than choosing data randomly (Racine 2000; Bergmeir and
Benı́tez 2012).</p>
<p>With this function, the user can apply different CV methods for
multipopulation models depending on three main inputs that must be
provided: <code>nahead</code>, <code>trainset1</code>, and <code>fixed_train_origin</code>. Indeed, the
following CV techniques can be applied:</p>
<ol type="1">
<li><p><strong>Fixed-origin evaluation</strong> is implemented by setting the arguments
so that <code>nahead</code> + <code>trainset1</code> = <code>periods</code> while keeping the default
value of <code>fixed_train_origin = TRUE</code>.</p></li>
<li><p><strong>RO-recalibration evaluation</strong> requires that <code>trainset1</code> &gt; 2 and
that <code>fixed_train_origin = TRUE</code> remain at its default value,
regardless of the value assigned to <code>nahead</code>. Specifically, when
<code>nahead = 1</code>, leave-one-out CV (LOOCV) is applied. When
<code>nahead = trainset1</code>, k-fold CV (CV) is performed. For all other
values, a standard time series CV approach is used while keeping the
origin of the first training set fixed in all possible options.</p></li>
<li><p><strong>Rolling-window evaluation</strong> requires setting
<code>fixed_train_origin = FALSE</code> or
<code>fixed_train_origin = ’add_remove1’</code>, independently of the values
assigned to <code>nahead</code> and <code>trainset1</code>. As in the previous CV
technique, if <code>nahead = 1</code>, a LOOCV approach with a rolling window
of 1 is applied, which remains equivalent whether
<code>fixed_train_origin</code> is set to <code>FALSE</code> or <code>’add_remove1’</code>. When
<code>nahead &gt; 1</code> and <code>fixed_train_origin = FALSE</code>, the training set is
updated by incorporating and discarding <code>nahead</code> periods in each
iteration. Conversely, when <code>fixed_train_origin = ’add_remove1’</code>,
the training set updates by adding and removing only one observation
per iteration while forecasting <code>nahead</code> periods.</p></li>
</ol>
<p>We present the results for RO-recalibration using the standard CV
approach for male Spanish regions. The main input parameters are set as
follows: <code>trainset1 = 8</code>, <code>nahead = 5</code> and <code>fixed_train_origin = TRUE</code>
(default value). This procedure is applied to the five multipopulation
mortality models included in the package. To replicate these results,
the user can use the following code:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> SpainRegions</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="dv">45</span>, <span class="dv">50</span>, <span class="dv">55</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">90</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cv_SM_multi <span class="ot">&lt;-</span> <span class="fu">multipopulation_cv</span>(<span class="at">qxt =</span> SpainRegions<span class="sc">$</span>qx_male,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;multiplicative&#39;</span>), <span class="co">#see options below</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span> <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">18</span>, <span class="at">lxt =</span> SpainRegions<span class="sc">$</span>lx_male,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">trainset1 =</span> <span class="dv">8</span>, <span class="at">nahead =</span> <span class="dv">5</span>, <span class="at">ktmethod =</span> <span class="fu">c</span>(<span class="st">&#39;arimapdq&#39;</span>), <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">&quot;MSE&quot;</span>))</span></code></pre></div>
<p>While we executed to female Spanish regions an RO-recalibration was
performed using <code>trainset1 = 10</code>, <code>nahead = 1</code> and
<code>fixed_train_origin = TRUE</code> (default value). This configuration
corresponds to a LOOCV approach, which fixes the origin in the first
training, using the following code:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> loocv_SF_multi <span class="ot">&lt;-</span> <span class="fu">multipopulation_cv</span>(<span class="at">qxt =</span> SpainRegions<span class="sc">$</span>qx_female,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;multiplicative&#39;</span>), <span class="co">#see options below</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">periods =</span>  <span class="fu">c</span>(<span class="dv">1991</span><span class="sc">:</span><span class="dv">2020</span>), <span class="at">ages =</span> <span class="fu">c</span>(ages), <span class="at">nPop =</span> <span class="dv">18</span>, <span class="at">lxt =</span> SpainRegions<span class="sc">$</span>lx_female,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">trainset1 =</span> <span class="dv">10</span>, <span class="at">nahead =</span> <span class="dv">1</span>, <span class="at">ktmethod =</span> <span class="fu">c</span>(<span class="st">&#39;arimapdq&#39;</span>), <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">&quot;MSE&quot;</span>))</span></code></pre></div>
<p>Available values for
<code>model = ’additive’, ’multiplicative’, ’CFM’, ’joint-K’</code>, and <code>’ACFM’</code>.
Changing the string assigned to <code>model</code> is sufficient to switch to the
corresponding specification. The output from the CV function is an
object of the <code>MultiCv</code> class, which provides a brief summary of the CV
method employed, including the following information:</p>
<ul>
<li><p><code>ax</code>, <code>bx</code>, <code>Ii</code>, <code>kt.fitted</code>, <code>kt.future</code>, and <code>kt.arima</code> correspond
to the same outputs as those in the adjustment and forecast functions.
However, since the adjustment process has been repeated several times
(depending on the process), each of these outputs is a list of the
iterations executed, denoted as follows:
<code>loop-h from period-1 to period-2</code>, where “h” denotes the
corresponding iteration.</p></li>
<li><p><code>meas_ages</code>, <code>meas_periodsfut</code>, <code>meas_pop</code>, and <code>meas_total</code> represent
the accuracy measures provided by the resampling technique, each
emphasizing different aspects of the forecasting ability. Indeed, the
objective of the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package is to provide a tool for evaluating the forecasting
accuracy of multipopulation models from various ages, namely, across
different age groups, future periods, regions considered, or a global
measure spanning all ages, future periods, and regions considered.
This function allows users the flexibility to choose the specific
viewpoint they wish to prioritize in the decision-making process
regarding forecasting capabilities.</p></li>
<li><p><code>model</code>, and <code>CV_method</code> designate the multipopulation mortality model
and the CV-method that users wish to apply for testing the forecasting
ability, respectively. Users can apply both, the multiplicative and
additive models presented in this paper separately.</p></li>
</ul>
<p>Figures <a href="#MSE_ages" data-reference-type="ref" data-reference="MSE_ages">12</a>-<a href="#MSE_per" data-reference-type="ref" data-reference="MSE_per">13</a> present the results of the CV techniques for the
five multipopulation mortality models applied across ages, periods and
regions, respectively. Additionally, we have included Figures
<a href="#MSE_block" data-reference-type="ref" data-reference="MSE_block">14</a> and
<a href="#MSE_loocv" data-reference-type="ref" data-reference="MSE_loocv">15</a> with the
MSE measure throughout different regions of Spain only for the
multiplicative and additive multipopulation mortality models. The result
of the other models are available upon request to the authors and can be
found in the reproduction file. These plots can be reproduced using the
R script entitled <code>CvmortalityMult_reproduction.R</code>. From
Figures <a href="#MSE_per" data-reference-type="ref" data-reference="MSE_per">13</a>-<a href="#MSE_loocv" data-reference-type="ref" data-reference="MSE_loocv">15</a>, we note the following points:</p>
<ul>
<li><p>The ACFM and joint-K models present lower forecasting results when the
MSE measure is used across the ages and future periods considered,
using both CV time series techniques.</p></li>
<li><p>The five considered models yield similar results for the age range 0 -
60, whereas for the last section of the mortality curve (60 - 90), the
ACFM and joint-K model perform better in terms of the forecasting
results.</p></li>
<li><p>Concerning the forecasting periods, the ACFM and joint-K models
demonstrate better forecasting results in the medium term, as captured
by RO-recalibration CV. However, while the five models exhibit
comparable results when evaluating short-term forecasting ability,
RO-recalibration LOOCV with the multiplicative model yields the worst
result.</p></li>
<li><p>The MSE measures for the different regions of Spain considered for
each CV method are shown in Figures 
<a href="#MSE_block" data-reference-type="ref" data-reference="MSE_block">14</a> and
<a href="#MSE_loocv" data-reference-type="ref" data-reference="MSE_loocv">15</a>. The
multipopulation mortality model produces different results depending
on the region. Specifically, the multiplicative model yields the best
forecasting results for Galicia, Pais Vasco, Cataluña, and Comunidad
Valencia. In contrast, depending on the CV model and population
considered, the additive model produces superior outcomes for Galicia,
Asturias, Pais Vasco, Cataluña, Comunidad Valencia, and Andalucia.</p></li>
</ul>
<p>Notably, the CV function allows the computation of global measures of
forecasting ability considering all ages, future periods, and regions,
as shown in Table <a href="#tab:T2" data-reference-type="ref" data-reference="T_GlobalMEAS">2</a>. The results indicate that the ACFM and
joint-K model for standard CV, whereas the CFM and ACFM for LOOCV
demonstrate better forecasting ability when all available forecasting
information is used. This finding is consistent with the observations
mentioned above.</p>
<p>Therefore, the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package displays the forecasting ability of the multipopulation
mortality models in various ways, allowing the user to determine the
most suitable model for their specific objectives. We present two
alternatives to assess the forecasting ability of the models but there
are other additional CV time series techniques that can be implemented
with the <code>multipopulation_cv()</code> function modifying <code>nahead</code>, <code>trainset1</code>
and <code>fixed_train_origin</code>.</p>
<div id="T_GlobalMEAS">
<table style="width:95%;">
<caption><span id="tab:T2">Table 2: </span> Summary of the MSE global measure of forecasting
ability.</caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 21%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">CV method</th>
<th colspan="5" style="text-align: left;">Multipopulation mortality model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Common CV
males</td>
<td style="text-align: left;">Multiplicative</td>
<td style="text-align: left;">Additive</td>
<td style="text-align: left;">CFM</td>
<td style="text-align: left;">joint-K</td>
<td style="text-align: left;">ACFM</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSE</td>
<td style="text-align: left;">0.000160</td>
<td style="text-align: left;">0.000142</td>
<td style="text-align: left;">0.000142</td>
<td style="text-align: left;">0.000132</td>
<td style="text-align: left;">0.000124</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LOOCV
females</td>
<td style="text-align: left;">Multiplicative</td>
<td style="text-align: left;">Additive</td>
<td style="text-align: left;">CFM</td>
<td style="text-align: left;">joint-K</td>
<td style="text-align: left;">ACFM</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSE</td>
<td style="text-align: left;">0.000089</td>
<td style="text-align: left;">0.000066</td>
<td style="text-align: left;">0.000061</td>
<td style="text-align: left;">0.000062</td>
<td style="text-align: left;">0.000059</td>
</tr>
</tbody>
</table>
</div>
<figure id="MSE_ages">
<img src="MSE_ages.png" style="width:100.0%"
alt="graphic without alt text" />
<p>
multipopulation mortality models. <span id="MSE_ages" data-label="MSE_ages"></span>
</p>
<figcaption>
Figure 12: Plot visualizing the MSE over the group of ages
considered in regions of Spain for males and females, applying CV time
series techniques for five
</figcaption>
</figure>
<figure id="MSE_per">
<img src="MSE_futpers.png" style="width:100.0%"
alt="graphic without alt text" />
<p>
multipopulation mortality models. <span id="MSE_per" data-label="MSE_per"></span>
</p>
<figcaption>
Figure 13: Plot visualizing the MSE over the test sets of
future periods considered in regions of Spain for males and females,
applying two CV time series techniques for five
</figcaption>
</figure>
<figure id="MSE_block">
<img src="blocked_MSE_males.png" style="width:100.0%"
alt="graphic without alt text" />
<p>
multipopulation mortality models. <span id="MSE_block" data-label="MSE_block"></span>
</p>
<figcaption>
Figure 14: Plot visualizing the MSE in regions of Spain for
males, applying RO-recalibration CV for the multiplicative and
additive
</figcaption>
</figure>
<figure id="MSE_loocv">
<img src="LOOCV_MSE_females.png" style="width:100.0%" alt="graphic without alt text" />
<figcaption>Figure 15: Plot visualizing the MSE in regions of Spain for males,
applying RO-recalibration LOOCV for the multiplicative and additive
multipopulation mortality models.</figcaption>
</figure>
<h3 data-number="6" id="sec:summary"><span class="header-section-number">6</span> Summary and discussion</h3>
<p>Accurately forecasting age-specific probabilities of death is essential
for dealing with life-contingent risk, ensuring solvency within the
European (re)insurance industry, and addressing the sustainability of
public pension system plans, among other purposes. Multipopulation
mortality models offer a valuable approach to forecasting age-specific
probabilities of death. These models allow the incorporation of data
from regions in the same country or group of countries with similar
characteristics, transcending borders in a globalized context, where
national and international movements occur daily. Moreover, these models
are recommended to enrich mortality data with observations from
different regions in the same country or group of countries sharing
similar characteristics. The
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package facilitates access to five of these multipopulation
mortality models, providing an <em>R</em> interface to the functions necessary
for model fitting and forecasting simply.</p>
<p>Furthermore, comparing various models can be challenging when the most
suitable model is selected. Indeed, CV methods offer a valuable tool for
evaluating the forecasting ability of models. The
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package allows the application of several CV time series techniques,
for assessing the forecasting ability of multiple populations over
short, medium and long term horizon. To the best of our knowledge, the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package is the first to apply these methods to multipopulation
mortality models, especially for three-way array data. Users only need
to provide multipopulation mortality data, specify the number of periods
to be used as the training or testing set, and decide whether it remains
fixed at the origin of the first training set. Then, the
<a href="https://cran.r-project.org/web/packages/CvmortalityMult/index.html">CvmortalityMult</a>
<em>R</em> package computes various measures highlighting different forecasting
ability aspects. Consequently, users can prioritize selecting the most
appropriate multipopulation mortality model on the basis of their
specific requirements and perspectives.</p>
<h3 data-number="7" id="acknowledgements"><span class="header-section-number">7</span> Acknowledgements</h3>
<p>The authors express their gratitude to the anonymous referees for their
thorough review and valuable feedback on the manuscript. Appreciation is
also extended to Christoph Bergmeir for clarifying doubts related to
cross-validation terminology in time series, which has influenced the
final version of the manuscript.<br />
A. Debón’s work was partially supported by grants PID2023-152106OB-I00
and CIAICO/2023/272, funded by MCIN/AEI/10.13039/501100011033 and the
Generalitat Valenciana, respectively.<br />
D. Atance acknowledges the support of Generalitat Valenciana through
projects CIGE/2023/7 (Conselleria de Educación, Universidades y Empleo).</p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Ahcan2014" class="csl-entry" role="listitem">
Ahcan, Ales, Darko Medved, Annamaria Olivieri, and Ermanno Pitacco.
2014. “Forecasting Mortality for Small Populations by Mixing Mortality
Data.” <em>Insurance: Mathematics and Economics</em> 54: 12–27.
</div>
<div id="ref-Ahmadi2014" class="csl-entry" role="listitem">
Ahmadi, Seyed Saeed, and Johnny Siu-Hang Li. 2014. “Coherent Mortality
Forecasting with Generalized Linear Models: A Modified
Time–Transformation Approach.” <em>Insurance: Mathematics and Economics</em>
59: 194–221.
</div>
<div id="ref-Antonio2017" class="csl-entry" role="listitem">
Antonio, Katrien, Sander Devriendt, Wouter de Boer, Robert de Vries,
Anja De Waegenaere, Hok-Kwan Kan, Egbert Kromme, et al. 2017. “Producing
the Dutch and Belgian Mortality Projections: A Stochastic
Multi–Population Standard.” <em>European Actuarial Journal</em> 7: 297–336.
</div>
<div id="ref-Armstrong1972" class="csl-entry" role="listitem">
Armstrong, J Scott, and Michael C Grohman. 1972. “A Comparative Study of
Methods for Long–Range Market Forecasting.” <em>Management Science</em> 19
(2): 211–21.
</div>
<div id="ref-Atance2020const" class="csl-entry" role="listitem">
Atance, David, Alejandro Balbás, and Eliseo Navarro. 2020. “Constructing
Dynamic Life Tables with a Single–Factor Model.” <em>Decisions in
Economics and Finance</em> 43 (2): 787–825.
</div>
<div id="ref-risk2022" class="csl-entry" role="listitem">
Atance, David, and Ana Debón. 2022. “Contributions to Risk Analysis:
RISK 2022.” In, edited by José María Sarabia, Manuela Alcañiz, Faustino
Prieto, and Montserrat Guillén, 51–58. Fundación MAPFRE.
</div>
<div id="ref-Atance2020" class="csl-entry" role="listitem">
Atance, David, Ana Debón, and Eliseo Navarro. 2020. “A Comparison of
Forecasting Mortality Models Using Resampling Methods.” <em>Mathematics</em> 8
(9): 1550.
</div>
<div id="ref-Atance2024" class="csl-entry" role="listitem">
Atance, David, and Eliseo Navarro. 2024. “A Simplified Model for
Measuring Longevity Risk for Life Insurance Products.” <em>Financial
Innovation</em> 1: 61.
</div>
<div id="ref-Barigou2023" class="csl-entry" role="listitem">
Barigou, Karim, Pierre-Olivier Goffard, Stéphane Loisel, and Yahia
Salhi. 2023. “Bayesian Model Averaging for Mortality Forecasting Using
Leave–Future–Out Validation.” <em>International Journal of Forecasting</em>
39 (2): 674–90.
</div>
<div id="ref-Bartolomei1989" class="csl-entry" role="listitem">
Bartolomei, Sonia M, and Arnold L Sweet. 1989. “A Note on a Comparison
of Exponential Smoothing Methods for Forecasting Seasonal Series.”
<em>International Journal of Forecasting</em> 5 (1): 111–16.
</div>
<div id="ref-Begin2023" class="csl-entry" role="listitem">
Bégin, Jean-François, Barbara Sanders, and Xueyi Xu. 2023. “Modeling and
Forecasting Subnational Mortality in the Presence of Aggregated Data.”
<em>North American Actuarial Journal</em> 0 (0): 1–27.
<a href="https://doi.org/10.1080/10920277.2023.2231996" class="uri">https://doi.org/10.1080/10920277.2023.2231996</a>.
</div>
<div id="ref-Berg2012" class="csl-entry" role="listitem">
Bergmeir, Christoph, and José M Benı́tez. 2012. “On the Use of
Cross-Validation for Time Series Predictor Evaluation.” <em>Information
Sciences</em> 191: 192–213.
</div>
<div id="ref-Bergmeir2018" class="csl-entry" role="listitem">
Bergmeir, Christoph, Rob J Hyndman, and Bonsoo Koo. 2018. “A Note on the
Validity of Cross–Validation for Evaluating Autoregressive Time Series
Prediction.” <em>Computational Statistics &amp; Data Analysis</em> 120: 70–83.
</div>
<div id="ref-Bozikas2020" class="csl-entry" role="listitem">
Bozikas, Apostolos, and Georgios Pitselis. 2020. “Incorporating Crossed
Classification Credibility into the Lee–Carter Model for
Multi-Population Mortality Data.” <em>Insurance: Mathematics and Economics</em>
93: 353–68.
</div>
<div id="ref-Brouhns2005" class="csl-entry" role="listitem">
Brouhns, Natacha, Michel Denuit, and Ingrid Van Keilegom. 2005.
“Bootstrapping the Poisson Log–Bilinear Model for Mortality
Forecasting.” <em>Scandinavian Actuarial Journal</em> 2005 (3): 212–24.
</div>
<div id="ref-Brouhns2002" class="csl-entry" role="listitem">
Brouhns, Natacha, Michel Denuit, and Jeroen K Vermunt. 2002. “A Poisson
Log–Bilinear Regression Approach to the Construction of Projected
Lifetables.” <em>Insurance: Mathematics and Economics</em> 31 (3): 373–93.
</div>
<div id="ref-Bur1989" class="csl-entry" role="listitem">
Burman, Prabir. 1989. “A Comparative Study of Ordinary Cross-Validation,
v-Fold Cross-Validation and the Repeated Learning-Testing Methods.”
<em>Biometrika</em> 76 (3): 503–14.
</div>
<div id="ref-Cairns2006" class="csl-entry" role="listitem">
Cairns, AJG, David Blake, and Kevin Dowd. 2006. “A Two–Factor Model for
Stochastic Mortality with Parameter Uncertainty: Theory and
Calibration.” <em>Journal of Risk and Insurance</em> 73 (4): 687–718.
</div>
<div id="ref-Cairns2009" class="csl-entry" role="listitem">
Cairns, Andrew JG, David Blake, Kevin Dowd, Guy D Coughlan, David
Epstein, Alen Ong, and Igor Balevich. 2009. “A Quantitative Comparison
of Stochastic Mortality Models Using Data from England and Wales and the
United States.” <em>North American Actuarial Journal</em> 13 (1): 1–35.
</div>
<div id="ref-Callen1996" class="csl-entry" role="listitem">
Callen, Jeffrey L, Clarence CY Kwan, Patrick CY Yip, and Yufei Yuan.
1996. “Neural Network Forecasting of Quarterly Accounting Earnings.”
<em>International Journal of Forecasting</em> 12 (4): 475–82.
</div>
<div id="ref-Carter1992" class="csl-entry" role="listitem">
Carter, Lawrence R, and Ronald D Lee. 1992. “Modeling and Forecasting US
Sex Differentials in Mortality.” <em>International Journal of Forecasting</em>
8 (3): 393–411.
</div>
<div id="ref-Chen2018" class="csl-entry" role="listitem">
Chen, Ree Yongqing, and Pietro Millossovich. 2018. “Sex–Specific
Mortality Forecasting for UK Countries: A Coherent Approach.” <em>European
Actuarial Journal</em> 8 (1): 69–95.
</div>
<div id="ref-Damato2012" class="csl-entry" role="listitem">
D’Amato, Valeria, Steven Haberman, Gabriella Piscopo, and Maria
Russolillo. 2012. “Modelling Dependent Data for Longevity Projections.”
<em>Insurance: Mathematics and Economics</em> 51 (3): 694–701.
</div>
<div id="ref-Danesi2015" class="csl-entry" role="listitem">
Danesi, Ivan Luciano, Steven Haberman, and Pietro Millossovich. 2015.
“Forecasting Mortality in Subpopulations Using Lee–Carter Type Models:
A Comparison.” <em>Insurance: Mathematics and Economics</em> 62: 151–61.
</div>
<div id="ref-Debon2008modelling" class="csl-entry" role="listitem">
Debón, Ana, F Montes, Jorge Mateu, Emilio Porcu, and Moreno Bevilacqua.
2008. “Modelling Residuals Dependence in Dynamic Life Tables: A
Geostatistical Approach.” <em>Computational Statistics &amp; Data Analysis</em> 52
(6): 3128–47.
</div>
<div id="ref-Debon2011" class="csl-entry" role="listitem">
Debón, Ana, Francisco Montes, and Francisco Martı́nez-Ruiz. 2011.
“Statistical Methods to Compare Mortality for a Group with
Non–Divergent Populations: An Application to Spanish Regions.”
<em>European Actuarial Journal</em> 1 (2): 291–308.
</div>
<div id="ref-Debon2008" class="csl-entry" role="listitem">
Debón, Ana, Francisco Montes, and Francisco Puig. 2008. “Modelling and
Forecasting Mortality in Spain.” <em>European Journal of Operational
Research</em> 189 (3): 624–37.
</div>
<div id="ref-Dong2020" class="csl-entry" role="listitem">
Dong, Yumo, Fei Huang, Honglin Yu, and Steven Haberman. 2020.
“Multi–Population Mortality Forecasting Using Tensor Decomposition.”
<em>Scandinavian Actuarial Journal</em> 2020 (8): 754–75.
</div>
<div id="ref-Dowd2011" class="csl-entry" role="listitem">
Dowd, Kevin, Andrew JG Cairns, David Blake, Guy D Coughlan, and Marwa
Khalaf-Allah. 2011. “A Gravity Model of Mortality Rates for Two Related
Populations.” <em>North American Actuarial Journal</em> 15 (2): 334–56.
</div>
<div id="ref-Elandt-Johnson80" class="csl-entry" role="listitem">
Elandt-Johnson, R. C., and N. L. Johnson. 1980. <em>Survival Models and
Data Analysis</em>. Wiley, New York.
</div>
<div id="ref-Enchev2017" class="csl-entry" role="listitem">
Enchev, Vasil, Torsten Kleinow, and Andrew JG Cairns. 2017.
“Multi–Population Mortality Models: Fitting, Forecasting and
Comparisons.” <em>Scandinavian Actuarial Journal</em> 2017 (4): 319–42.
</div>
<div id="ref-England1999" class="csl-entry" role="listitem">
England, Peter, and Richard Verrall. 1999. “Analytic and Bootstrap
Estimates of Prediction Errors in Claims Reserving.” <em>Insurance:
Mathematics and Economics</em> 25 (3): 281–93.
</div>
<div id="ref-Felipe2002" class="csl-entry" role="listitem">
Felipe, A, M Guillén, and AM Perez-Marin. 2002. “Recent Mortality Trends
in the Spanish Population.” <em>British Actuarial Journal</em> 8 (4): 757–86.
</div>
<div id="ref-Haberman2011" class="csl-entry" role="listitem">
Haberman, Steven, and Arthur Renshaw. 2011. “A Comparative Study of
Parametric Mortality Projection Models.” <em>Insurance: Mathematics and
Economics</em> 48 (1): 35–55.
</div>
<div id="ref-Hart1994" class="csl-entry" role="listitem">
Hart, Jeffrey D. 1994. “Automated Kernel Smoothing of Dependent Data by
Using Time Series Cross–Validation.” <em>Journal of the Royal Statistical
Society Series B: (Methodological)</em> 56 (3): 529–42.
</div>
<div id="ref-Hastie2009" class="csl-entry" role="listitem">
Hastie, Trevor, Robert Tibshirani, and Jerome H Friedman. 2009. <em>The
Elements of Statistical Learning: Data Mining, Inference, and
Prediction</em>. Vol. 2. Springer Series: New York, NY, USA.
</div>
<div id="ref-Hoedemakers2003" class="csl-entry" role="listitem">
Hoedemakers, Tom, Jan Beirlant, Marc J Goovaerts, and Jan Dhaene. 2003.
“Confidence Bounds for Discounted Loss Reserves.” <em>Insurance:
Mathematics and Economics</em> 33 (2): 297–316.
</div>
<div id="ref-Hunt2020" class="csl-entry" role="listitem">
Hunt, Andrew, and David Blake. 2020. “Identifiability in
Age/Period/Cohort Mortality Models.” <em>Annals of Actuarial Science</em> 14
(2): 500–536.
</div>
<div id="ref-Hyndman2021" class="csl-entry" role="listitem">
Hyndman, Rob J, and George Athanasopoulos. 2021. <em>Forecasting:
Principles and Practice</em>. 3rd edition. Melbourne, Australia: OTexts.
<a href="http://OTexts.org/fpp3/" class="uri">http://OTexts.org/fpp3/</a>.
</div>
<div id="ref-Hyndman2023" class="csl-entry" role="listitem">
Hyndman, Rob J, George Athanasopoulos, Christoph Bergmeir, Gabriel
Caceres, Leanne Chhay, Mitchell O’Hara-Wild, Fotios Petropoulos, Slava
Razbash, Earo Wang, and Farah Yasmeen. 2023. <em><span class="nocase">forecast</span>:
Forecasting Functions for Time Series and Linear Models</em>.
<a href="https://pkg.robjhyndman.com/forecast/" class="uri">https://pkg.robjhyndman.com/forecast/</a>.
</div>
<div id="ref-Hyndman2019" class="csl-entry" role="listitem">
Hyndman, Rob J, Heather Booth, Leonie Tickle, and John Maindonald. 2019.
<em>Demography: Forecasting Mortality, Fertility, Migration and Population
Data</em>. <a href="https://CRAN.R-project.org/package=demography" class="uri">https://CRAN.R-project.org/package=demography</a>.
</div>
<div id="ref-Hyndman2013" class="csl-entry" role="listitem">
Hyndman, Rob J, Heather Booth, and Farah Yasmeen. 2013. “Coherent
Mortality Forecasting: The Product–Ratio Method with Functional Time
Series Models.” <em>Demography</em> 50: 261–83.
</div>
<div id="ref-Hyndman2008" class="csl-entry" role="listitem">
Hyndman, Rob J, and Yeasmin Khandakar. 2008. “Automatic Time Series
Forecasting: The Forecast Package for R.” <em>Journal of Statistical
Software</em> 26 (3): 1–22. <a href="https://doi.org/10.18637/jss.v027.i03" class="uri">https://doi.org/10.18637/jss.v027.i03</a>.
</div>
<div id="ref-Hyndman2007" class="csl-entry" role="listitem">
Hyndman, Rob J, and Md Shahid Ullah. 2007. “Robust Forecasting of
Mortality and Fertility Rates: A Functional Data Approach.”
<em>Computational Statistics &amp; Data Analysis</em> 51 (10): 4942–56.
</div>
<div id="ref-James2013" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, Robert Tibshirani, et al.
2013. <em>An Introduction to Statistical Learning with Application in R</em>.
Vol. 112. Springer Series: New York, NY USA.
</div>
<div id="ref-Gareth2013" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani.
2013. <em>An Introduction to Statistical Learning: With Applications in R</em>.
Vol. 1. Springer: New York, NY, USA.
</div>
<div id="ref-Jarner2011" class="csl-entry" role="listitem">
Jarner, Søren Fiig, and Esben Masotti Kryger. 2011. “Modelling Adult
Mortality in Small Populations: The SAINT Model.” <em>ASTIN Bulletin</em> 41
(2): 377–418.
</div>
<div id="ref-Kessy2022" class="csl-entry" role="listitem">
Kessy, Salvatory R, Michael Sherris, Andrés M Villegas, and Jonathan
Ziveyi. 2022. “Mortality Forecasting Using Stacked Regression
Ensembles.” <em>Scandinavian Actuarial Journal</em> 2022 (7): 591–626.
</div>
<div id="ref-Koissi2006" class="csl-entry" role="listitem">
Koissi, Marie-Claire, Arnold F Shapiro, and Göran Högnäs. 2006.
“Evaluating and Extending the Lee–Carter Model for Mortality
Forecasting: Bootstrap Confidence Interval.” <em>Insurance: Mathematics and
Economics</em> 38 (1): 1–20.
</div>
<div id="ref-Lachenbruch1968" class="csl-entry" role="listitem">
Lachenbruch, Peter A, and M Ray Mickey. 1968. “Estimation of Error Rates
in Discriminant Analysis.” <em>Technometrics</em> 10 (1): 1–11.
</div>
<div id="ref-Lee2000" class="csl-entry" role="listitem">
Lee, Ronald D. 2000. “The Lee–Carter Method for Forecasting Mortality,
with Various Extensions and Applications.” <em>North American Actuarial
Journal</em> 4 (1): 80–91.
</div>
<div id="ref-Lee1992" class="csl-entry" role="listitem">
Lee, Ronald D, and Lawrence R Carter. 1992. “Modeling and Forecasting US
Mortality.” <em>Journal of the American Statistical Association</em> 87 (419):
659–71.
</div>
<div id="ref-Li2019" class="csl-entry" role="listitem">
Li, Han, and Colin O’Hare. 2019. “Mortality Forecasting: How Far Back
Should We Look in Time?” <em>Risks</em> 7 (1): 22.
</div>
<div id="ref-Li2011" class="csl-entry" role="listitem">
Li, Johnny Siu-Hang, and Mary R Hardy. 2011. “Measuring Basis Risk in
Longevity Hedges.” <em>North American Actuarial Journal</em> 15 (2): 177–200.
</div>
<div id="ref-Li2005" class="csl-entry" role="listitem">
Li, Nan, and Ronald D Lee. 2005. “Coherent Mortality Forecasts for a
Group of Populations: An Extension of the Lee-Carter Method.”
<em>Demography</em> 42 (3): 575–94.
</div>
<div id="ref-Lindholm2022" class="csl-entry" role="listitem">
Lindholm, Mathias, and Lina Palmborg. 2022. “Efficient Use of Data for
LSTM Mortality Forecasting.” <em>European Actuarial Journal</em> 12: 749–78.
</div>
<div id="ref-Liu2010" class="csl-entry" role="listitem">
Liu, Xiaoming, and W John Braun. 2010. “Investigating Mortality
Uncertainty Using the Block Bootstrap.” <em>Journal of Probability and
Statistics</em> 2010: 1–15.
</div>
<div id="ref-ine10b" class="csl-entry" role="listitem">
Muriel, S., M. Cantalapiedra, and F. López. 2010. “Towards Advanced
Methods for Computing Life Tables.” Instituto Nacional de Estadı́stica.
<a href="https://www.ine.es">www.ine.es</a>.
</div>
<div id="ref-Pant1990" class="csl-entry" role="listitem">
Pant, P Narayan, and William H Starbuck. 1990. “Innocents in the Forest:
Forecasting and Research Methods.” <em>Journal of Management</em> 16 (2):
433–60.
</div>
<div id="ref-Pascariu2022" class="csl-entry" role="listitem">
Pascariu, M. D. 2022. <em><span class="nocase">MortalityLaws: Parametric Mortality Models, Life
Tables and HMD</span></em>.
<a href="https://CRAN.R-project.org/package=MortalityLaws" class="uri">https://CRAN.R-project.org/package=MortalityLaws</a>.
</div>
<div id="ref-Perks1932" class="csl-entry" role="listitem">
Perks, Wilfred. 1932. “On Some Experiments in the Graduation of
Mortality Statistics.” <em>Journal of the Institute of Actuaries</em> 63 (1):
12–57.
</div>
<div id="ref-Pitacco2009" class="csl-entry" role="listitem">
Pitacco, Ermanno, Michel Denuit, Steven Haberman, and Annamaria
Olivieri. 2009. <em>Modelling Longevity Dynamics for Pensions and Annuity
Business</em>. Oxford University Press, Oxford.
</div>
<div id="ref-R2022" class="csl-entry" role="listitem">
R Core Team. 2022. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.
</div>
<div id="ref-Racine2000" class="csl-entry" role="listitem">
Racine, Jeff. 2000. “Consistent Cross–Validatory Model–Selection for
Dependent Data: Hv–Block Cross–Validation.” <em>Journal of Econometrics</em>
99 (1): 39–61.
</div>
<div id="ref-Renshaw2006" class="csl-entry" role="listitem">
Renshaw, Arthur E, and Steven Haberman. 2006. “A Cohort–Based Extension
to the Lee–Carter Model for Mortality Reduction Factors.” <em>Insurance:
Mathematics and Economics</em> 38 (3): 556–70.
</div>
<div id="ref-Russolillo2011" class="csl-entry" role="listitem">
Russolillo, Maria, Giuseppe Giordano, and Steven Haberman. 2011.
“Extending the Lee–Carter Model: A Three–Way Decomposition.”
<em>Scandinavian Actuarial Journal</em> 2011 (2): 96–117.
</div>
<div id="ref-Shao1993" class="csl-entry" role="listitem">
Shao, Jun. 1993. “Linear Model Selection by Cross–Validation.” <em>Journal
of the American Statistical Association</em> 88 (422): 486–94.
</div>
<div id="ref-Sridaran2022" class="csl-entry" role="listitem">
SriDaran, Dilan, Michael Sherris, Andrés M Villegas, and Jonathan
Ziveyi. 2022. “A Group Regularisation Approach for Constructing
Generalised Age–Period–Cohort Mortality Projection Models.” <em>ASTIN
Bulletin</em> 52 (1): 247–89.
</div>
<div id="ref-Swanson1997" class="csl-entry" role="listitem">
Swanson, Norman R, and Halbert White. 1997. “Forecasting Economic Time
Series Using Flexible Versus Fixed Specification and Linear Versus
Nonlinear Econometric Models.” <em>International Journal of Forecasting</em> 13
(4): 439–61.
</div>
<div id="ref-Tashman2000" class="csl-entry" role="listitem">
Tashman, Leonard J. 2000. “Out–of–Sample Tests of Forecasting
Accuracy: An Analysis and Review.” <em>International Journal of
Forecasting</em> 16 (4): 437–50.
</div>
<div id="ref-Turner2023" class="csl-entry" role="listitem">
Turner, Heather, and David Firth. 2023. <em>Gnm: Generalized Nonlinear
Models</em>. <a href="https://CRAN.R-project.org/package=gnm" class="uri">https://CRAN.R-project.org/package=gnm</a>.
</div>
<div id="ref-Villegas2014" class="csl-entry" role="listitem">
Villegas, Andrés M, and Steven Haberman. 2014. “On the Modeling and
Forecasting of Socioeconomic Mortality Differentials: An Application to
Deprivation and Mortality in England.” <em>North American Actuarial
Journal</em> 18 (1): 168–93.
</div>
<div id="ref-Villegas2017" class="csl-entry" role="listitem">
Villegas, Andrés M, Steven Haberman, Vladimir K Kaishev, and Pietro
Millossovich. 2017. “A Comparative Study of Two–Population Models for
the Assessment of Basis Risk in Longevity Hedges.” <em>ASTIN Bulletin</em> 47
(3): 631–79.
</div>
<div id="ref-Villegas2018" class="csl-entry" role="listitem">
Villegas, Andrés M, Vladimir K. Kaishev, and Pietro Millossovich. 2018.
“StMoMo: An R Package for Stochastic Mortality Modeling.” <em>Journal of
Statistical Software</em> 84 (3): 1–38.
<a href="https://doi.org/10.18637/jss.v084.i03" class="uri">https://doi.org/10.18637/jss.v084.i03</a>.
</div>
<div id="ref-Wilmoth2001" class="csl-entry" role="listitem">
Wilmoth, John, and Tapani Valkonen. 2001. “A Parametric Representation
of Mortality Differentials over Age and Time.” In <em><span class="nocase">Fifth Seminar of the
EAPS Working Group on Differentials in Health, Morbidity and Mortality
in Europe, Pontignano, Italy</span></em>.
</div>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="8" id="supplementary-materials"><span class="header-section-number">8</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-018.zip">RJ-2025-018.zip</a></p>
<h3 class="appendix" data-number="9" id="note"><span class="header-section-number">9</span> Note</h3>
<p>This article is converted from a Legacy LaTeX article using the
<a href="https://cran.r-project.org/package=texor">texor</a> package.
The pdf version is the official version. To report a problem with the html,
refer to CONTRIBUTE on the R Journal homepage.</p>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Atance &amp; Debón, "CvmortalityMult: Cross-Validation for Multi-Population Mortality Models", The R Journal, 2025</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@article{RJ-2025-018,
  author = {Atance, David and Debón, Ana},
  title = {CvmortalityMult: Cross-Validation for Multi-Population Mortality Models},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2025-018},
  doi = {10.32614/RJ-2025-018},
  volume = {17},
  issue = {2},
  issn = {2073-4859},
  pages = {1}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
