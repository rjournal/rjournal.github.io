# Generated by `rjournal_pdf_article()` using `knitr::purl()`: do not edit by hand
# Please edit RJ-2025-014.Rmd to modify this file

## ----setup, include=FALSE-----------------------------------------------------
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(yuima)


## ----eval = FALSE, include=TRUE, echo=TRUE------------------------------------
# setLRM(unit_Levy, yuima_regressors, LevyRM = "Y", coeff = c("mu", "sigma0"), data = NULL,
#   sampling = NULL, characteristic = NULL, functional = NULL)


## ----eval = FALSE, include=TRUE, echo=TRUE------------------------------------
# estimation_LRM(start, model, data, upper, lower)


## ----tLRm, echo=FALSE, fig.cap="Scheme of classes and methods in \\texttt{yuima} for the t-Lévy Regression model.", fig.align='center', out.width='100%'----
library(knitr)
include_graphics("figures/Tikz_standalone.png")


## ----eval = FALSE, include=TRUE, echo=TRUE------------------------------------
# setLaw_th(h = 1, method = "LAG", up = 7, low = -7, N = 180, N_grid = 1000,
#   regular_par = NULL)


## ----echo = TRUE, eval = FALSE------------------------------------------------
# # To instal YUIMA from Github repository
# R> library(pak)
# R> pak::pkg_install("yuimaproject/yuima")
# 
# ##########
# # Inputs #
# ##########
# R> library(yuima)
# R> nu <- 3
# R> h <- 1 # step size for the interval time
# R> up <- 10
# R> low <- -10
# 
# # Support definition for variable x
# R> x <- seq(low,up,length.out=100001)
# 
# # Definition of yuima.th-object
# R> law_LAG <- setLaw_th(h = h, method = "LAG", up = up, low = low, N = 180) # Laguerre
# R> law_COS <- setLaw_th(h = h, method = "COS", up = up, low = low, N = 180) # COS
# R> law_FFT <- setLaw_th(h = h, method = "FFT", up = up, low = low, N = 180) # FFT
# 
# # Cumulative Distribution Function: we apply the cdf method to the yuima.th-object
# R> Lag_time <- system.time(ycdf_LAG <- cdf(law_LAG, x, list(nu=nu))) # Laguerre
# R> COS_time <- system.time(ycdf_COS<-cdf(law_COS, x, list(nu=nu))) # COS
# R> FFT_time <- system.time(ycdf_FFT<-cdf(law_FFT, x, list(nu=nu))) # FFT


## ----CDComparisonnu3h1, echo=FALSE, fig.cap="Cumulative distribution function comparison for a Student-$t$ random variable with $\\nu=3$.", fig.align='center', out.width='100%'----
library(knitr)
include_graphics("figures/CDF_Comparison_nu3_h1.png")


## ----Table2Example1, echo=FALSE, eval = TRUE----------------------------------
library(knitr)

# Data for the table
data <- data.frame(
  Metric = c("RMSE", "Max", "Min", "sec."),
  COS = c(0.021, 0.032, 7.88e-05, 1.47),
  FFT = c(0.021, 0.032, 2.18e-05, 0.04),
  LAG = c(0.064, 0.085, 4.97e-04, 1.2)
)

# Create the table
kable(data, caption = "Summary comparison of the distance between each method available in yuima and the cumulative distribution function obtained using the R function `pt`.", booktabs = TRUE, align = "lccc")


## ----CDFComparisonnu3h001, echo=FALSE, fig.cap="Cumulative distribution function comparison for a Student-$t$ Lévy increment with $\\nu=3$ and $h=0.01$.", fig.align='center', out.width='100%'----
library(knitr)
include_graphics("figures/CDF_Comparison_nu3_h001.png")


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> library(yuima)
# ##########
# # Inputs #
# ##########
# # Inputs for Fourier Inversion
# R> method_Fourier <- "FFT"; up <- 6; low <- -6; N <- 2^17; N_grid <- 60000
# 
# # Inputs for the sample grid time
# R> Factor <- 1
# R> Factor1 <- 1
# R> initial <- 0; Final_Time <- 50 * Factor; h <- 0.02/Factor1


## ----echo = TRUE, eval = FALSE------------------------------------------------
# #######################################
# # Example 1: Deterministic Regressors #
# #######################################
# 
# R> mu1 <- 5; mu2 <- -1; scale <- 3; nu <- 3 # Model Parameters
# 
# # Model Definition
# R> law1 <- setLaw_th(method = method_Fourier, up = up, low = low,
#   N = N, N_grid = N_grid) # yuima.th
# 
# R> class(yuima_law)
# [1] "yuima.th"
# attr(,"package")
# [1] "yuima"


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> regr1 <- setModel(drift = c("-5*sin(5*t)", "cos(t)"), diffusion = matrix("0",2,1),
#      solve.variable = c("X1","X2"), xinit = c(1,0)) # Regressors definition
# 
# R> Mod1 <- setLRM(unit_Levy = law1, yuima_regressors = regr1) # t-Regression Model
# 
# R> class(Mod1)
# [1] "yuima.LevyRM"
# attr(,"package")
# [1] "yuima"


## ----echo = TRUE, eval = FALSE------------------------------------------------
# # Simulation
# R> samp <- setSampling(initial, Final_Time, n = Final_Time/h)
# R> true.par <- unlist(list(mu1 = mu1, mu2 = mu2, sigma0 = scale, nu = nu))
# 
# R> set.seed(1)
# 
# R> sim1 <- simulate(Mod1, true.parameter = true.par, sampling = samp)


## ----SimulationMod1, echo=FALSE, fig.cap="Simulated Trajectory of the Student Lévy Regression model defined in \\@ref(eq:Regr1).", fig.align='center', out.width='100%'----
library(knitr)
include_graphics("figures/Simulation_Mod1.png")


## ----echo = TRUE, eval = FALSE------------------------------------------------
# # Estimation
# R> lower <- list(mu1 = -10, mu2 = -10,  sigma0 = 0.1)
# R> upper <- list(mu1 = 10, mu2 = 10, sigma0 = 10.01)
# 
# R> start <- list(mu1 = runif(1, -10, 10), mu2 = runif(1, -10, 10),
# +    sigma0 = runif(1, 0.01, 4))
# 
# R> Bn <- 15*Factor
# 
# R> est1 <- estimation_LRM(start = start, model = sim1, data = sim1@data,
# +    upper = upper, lower = lower, PT = Bn)
# 
# R> class(est1)
# [1] "yuima.qmle"
# attr(,"package")
# [1] "yuima"


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> summary(est1)
# Quasi-Maximum likelihood estimation
# 
# Call:
# estimation_LRM(start = start, model = sim1, data = sim1@data,
#     upper = upper, lower = lower, PT = Bn)
# 
# Coefficients:
#         Estimate Std. Error
# mu1     5.029555 0.03538355
# mu2    -1.128905 0.18026088
# sigma0  2.425147 0.12523404
# nu      2.735344 0.47457435
# 
# -2 log L: 3236.535 73.3833


## ----echo = TRUE, eval = FALSE------------------------------------------------
# # Dataset construction without YUIMA
# R> time_t <- index(get.zoo.data(sim1@data)[[1]])
# R> X1 <- zoo(cos(5*time_t), order.by = time_t)
# R> X2 <- zoo(sin(time_t), order.by = time_t)
# R> law1_h <- setLaw_th(h = h, method = method_Fourier, up = up, low = low,
#      N = N, N_grid = N_grid)
# 
# R> print(c(law1_h@h,law1@h))
# [1] 0.02 1.00


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> set.seed(1)
# R> names(nu)<- "nu"
# # Simulation a t-Levy process Z_t.
# R> Z_t <- zoo(cumsum(c(0,rand(law1_h, Final_Time/h,nu))), order.by = time_t)
# # Sample path a scaled t-Levy process J_t
# R> J_t <- Z_t/sqrt(nu)
# # Sample path of a t-Levy regression model
# R> Y <- mu1 * X1 + mu2 * X2 + scale * J_t
# R> data1_a <- merge(X1, X2, Y)


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> est1_a <- estimation_LRM(start = start, model = Mod1, data = setData(data1_a),
# +    upper = upper, lower = lower, PT = Bn)
# R> summary(est1_a)
# Quasi-Maximum likelihood estimation
# 
# Call:
# estimation_LRM(start = start, model = Mod1, data = setData(data1_a),
#     upper = upper, lower = lower, PT = Bn)
# 
# Coefficients:
#         Estimate Std. Error
# mu1     4.987778 0.03642823
# mu2    -1.164138 0.18558422
# sigma0  2.495930 0.12888927
# nu      2.407683 0.41221590
# 
# -2 log L: 3232.784 85.32438


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> info_sum <- summary(est1_a)@coef
# R> alpha <- 0.025
# R> Confidence_Int_95 <- rbind(info_sum[,1]+info_sum[,2]*qnorm(alpha),
# +     info_sum[,1]+info_sum[,2]*qnorm(1-alpha),unlist(true.par),
# +     info_sum[,1])
# R> rownames(Confidence_Int_95) <- c("LB","UB","True_par","Est_par")
# R> print(Confidence_Int_95, digit = 4)
#            mu1      mu2  sigma0     nu
# LB       4.916  -1.5279   2.243  1.600
# UB       5.059  -0.8004   2.749  3.216
# True_par 5.000  -1.0000   3.000  3.000
# Est_par  4.988  -1.1641   2.496  2.408


## ----table, echo=FALSE--------------------------------------------------------
library(knitr)
library(kableExtra)
options(knitr.table.format = "latex")
# Data for the table (estimates and standard errors)
data <- data.frame(
  Parameter = c("$\\hat{\\mu_1}$"," ", "$\\hat{\\mu_2}$", " ", "$\\hat{\\sigma_0}$", " ", "$\\hat{\\nu}$"," ", "sec."," " ),
  `Lag_0.01` = c("4.968", "(0.029)", "-1.065", "(0.146)", "2.770", "(0.101)", "3.462", "(0.615)", "2.07", NA),
  `Lag_0.005` = c("5.019", "(0.020)", "-1.044", "(0.104)", "2.794", "(0.072)", "3.281", "(0.580)", "2.02", NA),
  `Lag_1_365` = c("4.976", "(0.014)", "-0.914", "(0.074)", "2.657", "(0.051)", "3.067", "(0.538)", "2.07", NA),
  `COS_0.01` = c("4.939", "(0.041)", "-1.192", "(0.210)", "3.993", "(0.145)", "2.827", "(0.492)", "1.10", NA),
  `COS_0.005` = c("5.065", "(0.049)", "-1.195", "(0.247)", "6.654", "(0.172)", "2.223", "(0.377)", "1.24", NA),
  `COS_1_365` = c("4.875", "(0.054)", "-0.555", "(0.277)", "10.010", "(0.192)", "2.227", "(0.378)", "1.34", NA),
  `FFT_0.01` = c("4.934", "(0.042)", "-1.179", "(0.213)", "4.055", "(0.148)", "5.749", "(1.063)", "0.15", NA),
  `FFT_0.005` = c("5.069", "(0.049)", "-1.178", "(0.248)", "6.674", "(0.172)", "8.310", "(1.571)", "0.24", NA),
  `FFT_1_365` = c("4.876", "(0.054)", "-0.528", "(0.277)", "10.010", "(0.193)", "15.175", "(2.940)", "0.39", NA)
)[1:9, ]  # Remove NA row

if (knitr::is_latex_output()) {
  colnames(data) <- gsub("_", "\\\\_", colnames(data))
}

# Generate the table
kbl(data, booktabs = TRUE,
    align = c("l", rep("c", 9)),
    caption = "Estimated parameters for $h = 0.01, 0.005, 1/365$ and different integration methods. The number of points for the inversion of the characteristic function is $N=180$. The parenthesis shows the asymptotic standard error. The last row reports the seconds necessary for the simulation of a sample path.",
    label = "CompN180",
    escape = FALSE) %>%
  add_header_above(c(" " = 1, "Laguerre Method" = 3, "COS Method" = 3, "FFT Method" = 3)) %>%
  # ... [rest of your formatting pipes] ... %>%
  kable_styling(latex_options = c("hold_position", "scale_down"))


## ----table-comph365, echo=FALSE-----------------------------------------------
library(knitr)
library(kableExtra)
options(knitr.table.format = "latex")
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
data <- data.frame(
  Parameter = c("$\\mu_1$", " ", "$\\mu_2$", " ", "$\\sigma_0$", " ", "$\\nu$", " ", "sec.", " "),
  `COS_1000` = c("4.968", "(0.034)", "-0.887", "(0.174)", "3.300", "(0.064)", "2.713", "(0.470)", "3.49", NA),
  `COS_5000` = c("4.975", "(0.016)", "-0.909", "(0.082)", "2.964", "(0.057)", "2.765", "(0.480)", "14.83", NA),
  `COS_10000` = c("4.975", "(0.016)", "-0.909", "(0.082)", "2.964", "(0.057)", "2.765", "(0.480)", "33.70", NA),
  `FFT_1000` = c("4.968", "(0.035)", "-0.886", "(0.177)", "3.363", "(0.065)", "3.279", "(0.579)", "0.38", NA),
  `FFT_5000` = c("4.975", "(0.306)", "-0.908", "(0.022)", "2.963", "(0.057)", "2.760", "(0.479)", "0.44", NA),
  `FFT_10000` = c("4.975", "(0.016)", "-0.908", "(0.082)", "2.964", "(0.057)", "2.702", "(0.468)", "0.45", NA)
)[1:9,]  # Remove NA row

if (knitr::is_latex_output()) {
  colnames(data) <- gsub("_", "\\\\_", colnames(data))
}
kbl(data, booktabs = TRUE, align = c("l", rep("c", 6)), escape = FALSE,
    caption = "Estimated parameters for $N = 1000, 5000, 10^4$ in the \\code{COS} and the \\code{FFT} methods. The step size $h$ is $1/365$. The parenthesis shows the asymptotic standard error. The last row reports the seconds necessary for the simulation of a sample path.",
    label = "Comph365") %>%
  add_header_above(c(" " = 1, "COS Method" = 3, "FFT Method" = 3)) %>%
  kable_styling(latex_options = c("hold_position"))


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> library(yuima)
# ##########
# # Inputs #
# ##########
# # Inputs for Fourier Inversion
# R> method_Fourier = "FFT"; up = 6; low = -6; N = 2^17; N_grid = 60000
# 
# # Inputs for the sample grid time
# R> Factor <- 1
# R> Factor1 <- 1
# R> initial <- 0; Final_Time <- 50 * Factor; h <- 0.02/Factor1


## ----echo = TRUE, eval = FALSE------------------------------------------------
# ####################################################
# # Regressor: Integrated NIG-Levy driven OU process #
# ####################################################
# R> mu1 <- -3; mu2 <- 0;  scale <- 3; nu <- 2.5 # Model Parameters
# 
# # Model Definition
# R> lawILOU <- setLaw_th(method = method_Fourier, up = up, low = low, N = N,
# +    N_grid = N_grid) # yuima.th
# 
# R> regrILOU <- setModel(drift = c("X2", "-X2"), jump.coeff = c("0", "2"),
# +    solve.variable = c("X1","X2"), xinit = c(0,0), measure.type = "code",
# +    measure = list(df = "rNIG(z, 1, 0, 1, 0)")) # Regressors definition
# 
# # t-Regression model
# R> ModILOU <- setLRM(unit_Levy = lawILOU, yuima_regressors = regrILOU)
# 
# # Simulation
# R> sampILOU <- setSampling(initial, Final_Time, n = Final_Time/h)
# R> true.parILOU <- unlist(list(mu1 = mu1, mu2 = mu2, sigma0 = scale, nu = nu))
# R> set.seed(1)
# R> simILOU <- simulate(ModILOU, true.parameter = true.parILOU, sampling = sampILOU)


## ----SimulationMod2, echo=FALSE, fig.cap="Simulated Trajectory of the Student Lévy Regression model defined in \\@ref(eq:yuex1)", fig.align='center', out.width='100%'----
library(knitr)
include_graphics("figures/Simulation_Mod2.png")


## ----echo = TRUE, eval = FALSE------------------------------------------------
# # Data extraction
# R> Dataset <- get.zoo.data(simILOU)
# R> newData <- Dataset[-2]
# R> newData <- merge(newData$X1, newData$Y)
# R> colnames(newData) <- c("X1","Y")
# R> plot(newData)
# 
# # Define the model for estimation
# R> regrILOU1 <- setModel(drift = c("0"), diffusion = matrix(c("0"),1,1),
# +    solve.variable = c("X1"), xinit = c(0)) # Regressors definition
# 
# # t-Regression model
# R> ModILOU1 <- setLRM(unit_Levy = lawILOU, yuima_regressors = regrILOU1)
# 
# # Estimation
# R> lower1 <- list(mu1 = -10,  sigma0 = 0.1)
# R> upper1 <- list(mu1 = 10, sigma0 = 10.01)
# R> startILOU1 <- list(mu1 = runif(1, -10, 10), sigma0 = runif(1, 0.01, 4))
# 
# R> Bn <- 15*Factor
# R> Data1 <- setData(newData)
# R> estILOU1 <- estimation_LRM(start = startILOU1, model = ModILOU1, data = Data1,
# +    upper = upper1, lower = lower1, PT = Bn)
# R> summary(estILOU1)
# Quasi-Maximum likelihood estimation
# 
# Call:
# estimation_LRM(start = startILOU1, model = ModILOU1, data = Data1,
#     upper = upper1, lower = lower1, PT = Bn)
# 
# Coefficients:
#         Estimate Std. Error
# mu1    -2.959621 0.02112734
# sigma0  2.778659 0.03208519
# nu      2.404843 0.13018410
# 
# -2 log L: 69711.32 854.3838


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> library(yuima)
# ##########
# # Inputs #
# ##########
# # Inputs for Fourier Inversion
# R> method_Fourier = "FFT"; up = 6; low = -6; N = 2^17; N_grid = 60000
# 
# # Inputs for the sample grid time
# R> Factor <- 20
# R> Factor1 <- 4
# R> initial <- 0; Final_Time <- 50 * Factor; h <- 0.02/Factor1
# 
# ############################################################
# # Regressor: Integrated stochastic FitzHugh-Nagumo process #
# ############################################################
# 
# R> mu1 <- 8; mu2 <- -4; mu3 <- 0; mu4 <- 0;  scale <- 8; nu <- 3 # Model Parameters
# # Model Definition
# R> lawFN <- setLaw_th(method = method_Fourier, up = up, low = low,
# +    N = N, N_grid = N_grid) # yuima.th
# 
# R> regrFN <- setModel(drift = c("V3", "V4", "3*(V3-V3^3-V4)", "1.5*V3-V4+0.5"),
# +    diffusion = matrix(c("0", "0", "0", "2"),4,1),
# +    solve.variable = c("V1","V2", "V3", "V4"),
# +    xinit = c(0,0,0,0)) # Regressors definition
# 
# R> ModFN <- setLRM(unit_Levy = lawFN, yuima_regressors = regrFN) #  t-regression model
# 
# # Simulation
# R> sampFN <- setSampling(initial, Final_Time, n = Final_Time/h)
# R> true.parFN <- unlist(list(mu1 = mu1, mu2 = mu2, mu3 = mu3, mu4 = mu4,
# +    sigma0 = scale, nu = nu))
# R> set.seed(12)
# R> simFN <- simulate(ModFN, true.parameter = true.parFN, sampling = sampFN)


## ----SimulationMod3, echo=FALSE, fig.cap="Simulated Trajectory of the Student Lévy Regression model defined in \\@ref(eq:yuex2).", fig.align='center', out.width='100%'----
library(knitr)
include_graphics("figures/Simulation_Mod3.png")


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> Dataset <- get.zoo.data(simFN)
# R> newData <- Dataset[-c(3,4)]
# R> newData <- merge(newData$X1,newData$X2, newData$Y)
# R> colnames(newData) <- c("X1","X2", "Y")
# R> plot(newData)
# 
# # Define the model for estimation
# R> regrFN1 <- setModel(drift = c("0", "0"), diffusion = matrix(c("0", "0"),2,1),
# +    solve.variable = c("X1", "X2"), xinit = c(0,0)) # Regressors definition
# R> ModFN1 <- setLRM(unit_Levy = lawFN, yuima_regressors = regrFN1) # t-Regression model.
# 
# # Estimation
# R> lower1 <- list(mu1 = -10, mu2 = -10,  sigma0 = 0.1)
# R> upper1 <- list(mu1 = 10, mu2 =10, sigma0 = 10.01)
# R> startFN1 <- list(mu1 = runif(1, -10, 10), mu2 = runif(1, -10, 10),
# +    sigma0 = runif(1, 0.01, 4))
# 
# R> Bn <- 15*Factor
# R> Data1 <- setData(newData)
# 
# R> estFN1 <- estimation_LRM(start = startFN1, model = ModFN1, data = Data1,
# +    upper = upper1, lower = lower1, PT = Bn)
# R> summary(estFN1)
# Quasi-Maximum likelihood estimation
# 
# Call:
# estimation_LRM(start = startFN1, model = ModFN1, data = Data1,
#     upper = upper1, lower = lower1, PT = Bn)
# 
# Coefficients:
#         Estimate Std. Error
# mu1     8.041838 0.04895791
# mu2    -4.041518 0.04495255
# sigma0  7.712157 0.04452616
# nu      3.020972 0.11837331
# 
# -2 log L: 403960.9 1291.516


## ----echo = TRUE, eval = FALSE------------------------------------------------
# R> library(yuima)
# R> library(quantmod)
# R> getSymbols("^SPX", from = "2014-12-04", to = "2023-05-12")
# # Regressors
# R> getSymbols("EURUSD=X", from = "2014-12-04", to = "2023-05-12")
# R> getSymbols("VIX", from = "2014-12-04", to = "2023-05-12")
# R> getSymbols("JPYUSD=X", from = "2014-12-04", to = "2023-05-12")
# 
# R> SP <- zoo(x = SPX$SPX.Close, order.by = index(SPX$SPX.Close))
# R> Vix <- zoo(x = VIX$VIX.Close/1000, order.by = index(VIX$VIX.Close))
# R> EURUSD <- zoo(x = `EURUSD=X`[,4], order.by = index(`EURUSD=X`))
# R> JPYUSD <- zoo(x = `JPYUSD=X`[,4], order.by = index(`JPYUSD=X`))
# R> Data <- na.omit(na.approx(merge(Vix, EURUSD, JPYUSD, SP)))
# R> colnames(Data) <- c("VIX", "EURUSD", "JPYUSD", "SP")
# R> days <- as.numeric(index(Data))-as.numeric(index(Data))[1]
# 
# # equally spaced grid time data
# R> Data <- zoo(log(Data), order.by = days)
# R> Data_eq <- na.approx(Data, xout = days[1] : tail(days,1L))
# R> yData <- setData(zoo(Data_eq, order.by = index(Data_eq)/30)) # Data on monthly basis


## ----RealDataset, echo=FALSE, fig.cap="Financial data observed on a monthly equally grid time ranging from December 14th 2014 to May 12th 2023.", fig.align='center', out.width='100%'----
library(knitr)
include_graphics("figures/RealDataset.png")


## ----echo = TRUE, eval = FALSE------------------------------------------------
# # Inputs for integration in the inversion formula
# R> method_Fourier <- "FFT"; up <- 6; low <- -6; N <- 10000; N_grid <- 60000
# 
# # Model Definition
# R> law <- setLaw_th(method = method_Fourier, up = up, low = low, N = N,
# +    N_grid = N_grid)
# R> regr <- setModel(drift = c("0", "0", "0"), diffusion = matrix("0",3,1),
# +    solve.variable = c("VIX", "EURUSD", "JPYUSD"), xinit = c(0,0,0))
# Mod <- setLRM(unit_Levy = law, yuima_regressors = regr, LevyRM = "SP")
# 
# # Estimation
# R> lower <- list(mu1 = -100, mu2 = -200, mu3 = -100,  sigma0 = 0.01)
# R> upper <- list(mu1 = 100, mu2 = 100, mu3 = 100, sigma0 = 200.01)
# R> start <- list(mu1 = runif(1, -100, 100), mu2 = runif(1, -100, 100),
# +    mu3 = runif(1, -100, 100), sigma0 = runif(1, 0.01, 100))
# R> est <- estimation_LRM(start = start, model = Mod, data = yData, upper = upper,
# +    lower = lower, PT = floor(tail(index(Data_eq)/30,1L)/2))
# R> summary(est)
# 
# Quasi-Maximum likelihood estimation
# 
# Call:
# estimation_LRM(start = start, model = Mod, data = yData, upper = upper,
#     lower = lower, PT = floor(tail(index(Data_eq)/30, 1L)/2))
# 
# Coefficients:
#            Estimate  Std. Error
# mu1     0.000335328 0.004901559
# mu2    -0.062235188 0.033027232
# mu3     0.016291220 0.039382559
# sigma0  0.082031691 0.004859138
# nu      3.062728822 0.616466913
# 
# -2 log L: -1506.067 48.17592

