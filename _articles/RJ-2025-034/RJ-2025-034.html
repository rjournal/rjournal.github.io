<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>longevity: An R Package for Modelling Excess Lifetimes</title>

  <meta property="description" itemprop="description" content="The longevity R package provides a maximum likelihood estimation routine for modelling of survival data that are subject to non-informative censoring or truncation. It includes a selection of 12 parametric models of varying complexity, with a focus on tools for extreme value analysis and more specifically univariate peaks over threshold modelling. The package provides utilities for univariate threshold selection, parametric and nonparametric maximum likelihood estimation, goodness of fit diagnostics and model comparison tools. These different methods are illustrated using individual Dutch records and aggregated Japanese human lifetime data."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2026-01-06"/>
  <meta property="article:created" itemprop="dateCreated" content="2026-01-06"/>
  <meta name="article:author" content="Léo R. Belzile"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="longevity: An R Package for Modelling Excess Lifetimes"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="The longevity R package provides a maximum likelihood estimation routine for modelling of survival data that are subject to non-informative censoring or truncation. It includes a selection of 12 parametric models of varying complexity, with a focus on tools for extreme value analysis and more specifically univariate peaks over threshold modelling. The package provides utilities for univariate threshold selection, parametric and nonparametric maximum likelihood estimation, goodness of fit diagnostics and model comparison tools. These different methods are illustrated using individual Dutch records and aggregated Japanese human lifetime data."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="longevity: An R Package for Modelling Excess Lifetimes"/>
  <meta property="twitter:description" content="The longevity R package provides a maximum likelihood estimation routine for modelling of survival data that are subject to non-informative censoring or truncation. It includes a selection of 12 parametric models of varying complexity, with a focus on tools for extreme value analysis and more specifically univariate peaks over threshold modelling. The package provides utilities for univariate threshold selection, parametric and nonparametric maximum likelihood estimation, goodness of fit diagnostics and model comparison tools. These different methods are illustrated using individual Dutch records and aggregated Japanese human lifetime data."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="longevity: An R Package for Modelling Excess Lifetimes"/>
  <meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2025-034"/>
  <meta name="citation_pdf_url" content="RJ-2025-034.pdf"/>
  <meta name="citation_volume" content="17"/>
  <meta name="citation_issue" content="4"/>
  <meta name="citation_doi" content="10.32614/RJ-2025-034"/>
  <meta name="citation_journal_title" content="The R Journal"/>
  <meta name="citation_issn" content="2073-4859"/>
  <meta name="citation_firstpage" content="37"/>
  <meta name="citation_lastpage" content="58"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2026/01/06"/>
  <meta name="citation_publication_date" content="2026/01/06"/>
  <meta name="citation_author" content="Léo R. Belzile"/>
  <meta name="citation_author_institution" content="Department of Decision Sciences, HEC Montréal"/>
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=On some experiments in the graduation of mortality statistics;citation_publisher=Cambridge University Press;citation_volume=63;citation_doi=10.1017/s0020268100046680;citation_author=Wilfred Perks"/>
  <meta name="citation_reference" content="citation_title=On the distribution of the likelihood ratio;citation_publisher=Institute of Mathematical Statistics;citation_volume=25;citation_doi=10.1214/aoms/1177728725;citation_author=Herman Chernoff"/>
  <meta name="citation_reference" content="citation_title=Nonparametric estimation from incomplete observations;citation_volume=53;citation_doi=10.1080/01621459.1958.10501452;citation_author=Edward L. Kaplan;citation_author=Paul Meier"/>
  <meta name="citation_reference" content="citation_title=The empirical distribution function with arbitrarily grouped, censored and truncated data;citation_volume=38;citation_doi=10.1111/j.2517-6161.1976.tb01597.x;citation_author=Bruce W. Turnbull"/>
  <meta name="citation_reference" content="citation_title=Asymptotic properties of maximum likelihood estimators and likelihood ratio tests under nonstandard conditions;citation_publisher=Taylor &amp; Francis;citation_volume=82;citation_doi=10.1080/01621459.1987.10478472;citation_author=Steven G. Self;citation_author=Kung-Yee Liang"/>
  <meta name="citation_reference" content="citation_title=A note on the product-limit estimator under right censoring and left truncation;citation_volume=74;citation_doi=10.1093/biomet/74.4.883;citation_author=Wei-Yann Tsai;citation_author=Nicholas P. Jewell;citation_author=Mei-Cheng Wang"/>
  <meta name="citation_reference" content="citation_title=Probability plotting with censored data;citation_volume=46;citation_doi=10.1080/00031305.1992.10475837;citation_author=Lance A. Waller;citation_author=Bruce W. Turnbull"/>
  <meta name="citation_reference" content="citation_title=Maximum likelihood for interval censored data: Consistency and computation;citation_volume=81;citation_doi=10.1093/biomet/81.3.618;citation_issn=0006-3444;citation_author=Robert Gentleman;citation_author=Charles J. Geyer"/>
  <meta name="citation_reference" content="citation_title=A note on nonparametric estimation of the distribution function from interval-censored and truncated observations;citation_publisher=[Royal Statistical Society, Wiley];citation_volume=56;citation_doi=10.1111/j.2517-6161.1994.tb01960.x;citation_issn=00359246;citation_author=Halina Frydman"/>
  <meta name="citation_reference" content="citation_title=Vector generalized additive models;citation_volume=58;citation_doi=10.1111/j.2517-6161.1996.tb02095.x;citation_author=Thomas W. Yee;citation_author=C. J. Wild"/>
  <meta name="citation_reference" content="citation_title=Methods for interval-censored data;citation_volume=17;citation_doi=10.1002/(sici)1097-0258(19980130)17:2&lt;219::aid-sim735&gt;3.0.co;2-o;citation_author=Jane C. Lindsey;citation_author=Louise M. Ryan"/>
  <meta name="citation_reference" content="citation_title=Nonparametric methods for doubly truncated data;citation_volume=94;citation_doi=10.1080/01621459.1999.10474187;citation_author=Bradley Efron;citation_author=Vahe Petrosian"/>
  <meta name="citation_reference" content="citation_title=A vitality-based model relating stressors and environmental properties to organism survival;citation_volume=70;citation_doi=10.1890/0012-9615(2000)070[0445:avbmrs]2.0.co;2;citation_author=James J. Anderson"/>
  <meta name="citation_reference" content="citation_title=Likelihood-based inference with singular information matrix;citation_publisher=Bernoulli Society for Mathematical Statistics; Probability;citation_volume=6;citation_doi=bj/1081788028;citation_author=Andrea Rotnitzky;citation_author=David R. Cox;citation_author=Matteo Bottai;citation_author=James Robins"/>
  <meta name="citation_reference" content="citation_title=evd: Extreme value distributions;citation_volume=2;citation_author=A. G. Stephenson"/>
  <meta name="citation_reference" content="citation_title=Flexible parametric proportional-hazards and proportional-odds models for censored survival data, with application to prognostic modelling and estimation of treatment effects;citation_volume=21;citation_doi=10.1002/sim.1203;citation_author=Patrick Royston;citation_author=Mahesh K. B. Parmar"/>
  <meta name="citation_reference" content="citation_title=The vitality model: A way to understand population survival and demographic heterogeneity;citation_volume=76;citation_doi=10.1016/j.tpb.2009.05.004;citation_issn=0040-5809;citation_author=Ting Li;citation_author=James J. Anderson"/>
  <meta name="citation_reference" content="citation_title=Exact and asymptotic weighted logrank tests for interval censored data: The interval R package;citation_volume=36;citation_doi=10.18637/jss.v036.i02;citation_author=Michael P. Fay;citation_author=Pamela A. Shaw"/>
  <meta name="citation_reference" content="citation_title=Nonparametric analysis of doubly truncated data;citation_volume=62;citation_doi=10.1007/s10463-008-0192-2;citation_issn=1572-9052;citation_author=Pao-Sheng Shen"/>
  <meta name="citation_reference" content="citation_title=Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory;citation_publisher=JMLR.org;citation_volume=11;citation_issn=1532-4435;citation_author=Sumio Watanabe"/>
  <meta name="citation_reference" content="citation_title=Functional boxplots;citation_publisher=Taylor &amp; Francis;citation_volume=20;citation_doi=10.1198/jcgs.2011.09224;citation_author=Ying Sun;citation_author=Marc G. Genton"/>
  <meta name="citation_reference" content="citation_title=A handbook of parametric survival models for actuarial use;citation_publisher=Taylor &amp; Francis;citation_volume=2012;citation_doi=10.1080/03461238.2010.506688;citation_author=Stephens J. Richards"/>
  <meta name="citation_reference" content="citation_title=bshazard: A flexible tool for nonparametric smoothing of the hazard function;citation_volume=6;citation_doi=10.32614/rj-2014-028;citation_author=Paola Rebora;citation_author=Agus Salim;citation_author=Marie Reilly"/>
  <meta name="citation_reference" content="citation_title=Improved diagnostic plots for extreme value analyses;citation_volume=17;citation_doi=10.1007/s10687-014-0183-z;citation_author=Paul J. Northrop;citation_author=Claire L. Coleman"/>
  <meta name="citation_reference" content="citation_title=fitdistrplus: An R package for fitting distributions;citation_volume=64;citation_doi=10.18637/jss.v064.i04;citation_author=Marie Laure Delignette-Muller;citation_author=Christophe Dutang"/>
  <meta name="citation_reference" content="citation_title=extRemes 2.0: An extreme value analysis package in R;citation_volume=72;citation_doi=10.18637/jss.v072.i08;citation_author=Eric Gilleland;citation_author=Richard W. Katz"/>
  <meta name="citation_reference" content="citation_title=flexsurv: A platform for parametric survival modeling in R;citation_volume=70;citation_doi=10.18637/jss.v070.i08;citation_author=Christopher Jackson"/>
  <meta name="citation_reference" content="citation_title=An efficient implementation of the EMICM algorithm for the interval censored NPMLE;citation_publisher=Taylor &amp; Francis;citation_volume=26;citation_doi=10.1080/10618600.2016.1208616;citation_author=Clifford Anderson-Bergman"/>
  <meta name="citation_reference" content="citation_title=icenReg: Regression models for interval censored data in R;citation_volume=81;citation_doi=10.18637/jss.v081.i12;citation_author=Clifford Anderson-Bergman"/>
  <meta name="citation_reference" content="citation_title=The plateau of human mortality: Demography of longevity pioneers;citation_publisher=American Association for the Advancement of Science;citation_volume=360;citation_doi=10.1126/science.aat3119;citation_issn=0036-8075;citation_author=Elisabetta Barbi;citation_author=Francesco Lagona;citation_author=Marco Marsili;citation_author=James W. Vaupel;citation_author=Kenneth W. Wachter"/>
  <meta name="citation_reference" content="citation_title=Parametric and penalized generalized survival models;citation_volume=27;citation_doi=10.1177/0962280216664760;citation_author=Xing-Rong Liu;citation_author=Yudi Pawitan;citation_author=Mark Clements"/>
  <meta name="citation_reference" content="citation_title=Limits to human life span through extreme value theory;citation_publisher=Taylor &amp; Francis;citation_volume=114;citation_doi=10.1080/01621459.2018.1537912;citation_author=Jesson J. Einmahl;citation_author=John H. J. Einmahl;citation_author=Laurens Haan"/>
  <meta name="citation_reference" content="citation_title=Is there a cap on longevity? A statistical review;citation_volume=9;citation_doi=10.1146/annurev-statistics-040120-025426;citation_author=Léo R. Belzile;citation_author=Anthony C. Davison;citation_author=Jutta Gampe;citation_author=Holger Rootzén;citation_author=Dmitrii Zholud"/>
  <meta name="citation_reference" content="citation_title=casebase: An alternative framework for survival analysis and comparison of event rates;citation_volume=14;citation_doi=10.32614/rj-2022-052;citation_issn=2073-4859;citation_author=Sahir Rai Bhatnagar;citation_author=Maxime Turgeon;citation_author=Jesse Islam;citation_author=James A. Hanley;citation_author=Olli Saarela"/>
  <meta name="citation_reference" content="citation_title=The curse of the plateau. Measuring confidence in human mortality estimates at extreme ages;citation_volume=144;citation_doi=10.1016/j.tpb.2022.01.002;citation_author=Carlo Giovanni Camarda"/>
  <meta name="citation_reference" content="citation_title=Graphical test for discrete uniformity and its applications in goodness of fit evaluation and multiple sample comparison;citation_volume=32;citation_doi=10.1007/s11222-022-10090-6;citation_author=Teemu Säilynoja;citation_author=Paul-Christian Bürkner;citation_author=Aki Vehtari"/>
  <meta name="citation_reference" content="citation_title=evgam: An R package for generalized additive extreme value models;citation_volume=103;citation_doi=10.18637/jss.v103.i03;citation_author=Benjamin D. Youngman"/>
  <meta name="citation_reference" content="citation_title=A modeler’s guide to extreme value software;citation_publisher=Springer;citation_volume=26;citation_doi=10.1007/s10687-023-00475-9;citation_author=Léo R. Belzile;citation_author=Christophe Dutang;citation_author=Paul J. Northrop;citation_author=Thomas Opitz"/>
  <meta name="citation_reference" content="citation_title=Non-uniform random variate generation;citation_publisher=Springer;citation_author=L. Devroye"/>
  <meta name="citation_reference" content="citation_title=Information bounds and nonparametric maximum likelihood estimation;citation_doi=10.1007/978-3-0348-8621-5;citation_author=Piet Groeneboom;citation_author=Jon A. Wellner"/>
  <meta name="citation_reference" content="citation_title=Modeling survival data: Extending the Cox model;citation_publisher=Springer;citation_doi=10.1007/978-1-4757-3294-8;citation_author=Terry M. Therneau;citation_author=Patricia M. Grambsch"/>
  <meta name="citation_reference" content="citation_title=Vector generalized linear and additive models: With an implementation in R;citation_publisher=Springer;citation_doi=10.1007/978-1-4939-2818-7;citation_author=Thomas W. Yee"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Elegant graphics for data analysis;citation_publisher=Springer-Verlag New York;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Exceptional lifespans;citation_publisher=Springer;citation_doi=10.1007/978-3-030-49970-9"/>
  <meta name="citation_reference" content="citation_title=Age-specific mortality and fertility rates for probabilistic population projections;citation_publisher=Springer;citation_doi=10.1007/978-3-319-26603-9_15;citation_author=Hana Ševčíková;citation_author=Nan Li;citation_author=Vladimíra Kantorová;citation_author=Patrick Gerland;citation_author=Adrian E. Raftery"/>
  <meta name="citation_reference" content="citation_title=The international database on longevity: Data resource profile;citation_publisher=Springer;citation_doi=10.1007/978-3-030-49970-9_2;citation_author=Dmitri A. Jdanov;citation_author=Vladimir M. Shkolnikov;citation_author=Sigrid Gellers-Barkmann"/>
  <meta name="citation_reference" content="citation_title=A theory of mortality based on actuarial, biological and medical considerations;citation_publisher=International Union for the Scientific Study of Population;citation_volume=1;citation_author=Robert E. Beard"/>
  <meta name="citation_reference" content="citation_title=Statistics of extremes for incomplete data, with application to lifetime and liability claim modeling;citation_publisher=CRC Press;citation_author=Léo R. Belzile;citation_author=Johanna G. Nešlehová"/>
  <meta name="citation_reference" content="citation_title=Interior algorithms for linear, quadratic, and linearly constrained non-linear programming;citation_publisher=Department of ESS, Stanford University;citation_author=Yinyu Ye"/>
  <meta name="citation_reference" content="citation_title=Timing and spatial selection bias in rapid extreme event attribution;citation_volume=41;citation_doi=10.1016/j.wace.2023.100584;citation_author=Ophélia Miralles;citation_author=Anthony C. Davison"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","author","description","draft","preamble","type","output","bibliography","nocite","date_received","volume","issue","slug","journal","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl"]}},"value":[{"type":"character","attributes":{},"value":["longevity: An R Package for Modelling Excess Lifetimes"]},{"type":"character","attributes":{},"value":["2026-01-06"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Léo R. Belzile"]},{"type":"character","attributes":{},"value":["Department of Decision Sciences, HEC Montréal"]},{"type":"character","attributes":{},"value":["3000, chemin de la Côte-Sainte-Catherine","Montréal (Québec), Canada","H3T 2A7"]},{"type":"character","attributes":{},"value":["https://lbelzile.bitbucket.io"]},{"type":"character","attributes":{},"value":["0000-0002-9135-014X"]},{"type":"character","attributes":{},"value":["leo.belzile@hec.ca"]}]}]},{"type":"character","attributes":{},"value":["The longevity R package provides a maximum likelihood estimation routine for modelling of survival data that are subject to non-informative censoring or truncation. It includes a selection of 12 parametric models of varying complexity, with a focus on tools for extreme value analysis and more specifically univariate peaks over threshold modelling. The package provides utilities for univariate threshold selection, parametric and nonparametric maximum likelihood estimation, goodness of fit diagnostics and model comparison tools. These different methods are illustrated using individual Dutch records and aggregated Japanese human lifetime data.\n"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["\\usepackage{amsfonts}\n"]},{"type":"character","attributes":{},"value":["package"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article","rjtools::rjournal_pdf_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["longevity.bib"]},{"type":"character","attributes":{},"value":["@survival-package, @Icens-package, @DTDA-package, @muhaz-package, @mev-package, @Rsolnp-pkg, @demography-package, @MortCast-package, @MortalityLaws-package, @vitality-package, @prodlim-package, @dblcens-package, @dplyr-package, @tranSurv-package, @rust-package, @fda-package, @lubridate-package, @tidyverse"]},{"type":"character","attributes":{},"value":["2024-01-11"]},{"type":"integer","attributes":{},"value":[17]},{"type":"integer","attributes":{},"value":[4]},{"type":"character","attributes":{},"value":["RJ-2025-034"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[37]},{"type":"integer","attributes":{},"value":[58]}]},{"type":"character","attributes":{},"value":["RJ-2025-034.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2025-034"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2025-034"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["longevity","evd","mev","extRemes","evgam","survival","MortCast","demography","MortalityLaws","vitality","fitdistrplus","VGAM","prodlim","icenReg","dblcens","interval","tranSurv","DTDA","Rsolnp","ggplot2","casebase","flexsurv","bshazard","muhaz","rstpm2","rust","fda"]},{"type":"character","attributes":{},"value":["Icens"]}]},{"type":"character","attributes":{},"value":["ActuarialScience","ChemPhys","ClinicalTrials","Distributions","Econometrics","Environmetrics","ExtremeValue","FunctionalData","MissingData","NetworkAnalysis","Optimization","Phylogenetics","Psychometrics","Spatial","Survival","TeachingStatistics"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.5/rjtools/rjournal.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["fig/Lexis_local_hazard.pdf","fig/Lexis_local_hazard.png","fig/Lexis_local_hazard.tex","fig/nesting_graph.pdf","fig/nesting_graph.png","fig/nesting_graph.tex","longevity_files/anchor-4.2.2/anchor.min.js","longevity_files/bowser-1.9.3/bowser.min.js","longevity_files/distill-2.2.21/template.v2.js","longevity_files/figure-html5/fig-ecdf-1.png","longevity_files/figure-html5/fig-endpoint-confint-1.png","longevity_files/figure-html5/fig-hazard-1.png","longevity_files/figure-html5/fig-parameterstab-1.png","longevity_files/figure-html5/fig-qqplots-1.png","longevity_files/figure-html5/fig-turnbull-1.png","longevity_files/header-attrs-2.30/header-attrs.js","longevity_files/tippy-6.2.7/tippy-bundle.umd.min.js","longevity_files/tippy-6.2.7/tippy-light-border.css","longevity_files/tippy-6.2.7/tippy.css","longevity_files/tippy-6.2.7/tippy.umd.min.js","longevity.bib","longevity.log","longevity.Rmd.bak","longevity.tex","RJ-2025-034_files/anchor-4.2.2/anchor.min.js","RJ-2025-034_files/bowser-1.9.3/bowser.min.js","RJ-2025-034_files/distill-2.2.21/template.v2.js","RJ-2025-034_files/figure-html5/fig-ecdf-1.png","RJ-2025-034_files/figure-html5/fig-endpoint-confint-1.png","RJ-2025-034_files/figure-html5/fig-hazard-1.png","RJ-2025-034_files/figure-html5/fig-parameterstab-1.png","RJ-2025-034_files/figure-html5/fig-qqplots-1.png","RJ-2025-034_files/figure-html5/fig-turnbull-1.png","RJ-2025-034_files/figure-latex/fig-ecdf-1.pdf","RJ-2025-034_files/figure-latex/fig-endpoint-confint-1.pdf","RJ-2025-034_files/figure-latex/fig-hazard-1.pdf","RJ-2025-034_files/figure-latex/fig-parameterstab-1.pdf","RJ-2025-034_files/figure-latex/fig-qqplots-1.pdf","RJ-2025-034_files/figure-latex/fig-turnbull-1.pdf","RJ-2025-034_files/header-attrs-2.30/header-attrs.js","RJ-2025-034_files/jquery-3.6.0/jquery-3.6.0.js","RJ-2025-034_files/jquery-3.6.0/jquery-3.6.0.min.js","RJ-2025-034_files/jquery-3.6.0/jquery-3.6.0.min.map","RJ-2025-034_files/popper-2.6.0/popper.min.js","RJ-2025-034_files/tippy-6.2.7/tippy-bundle.umd.min.js","RJ-2025-034_files/tippy-6.2.7/tippy-light-border.css","RJ-2025-034_files/tippy-6.2.7/tippy.css","RJ-2025-034_files/tippy-6.2.7/tippy.umd.min.js","RJ-2025-034_files/webcomponents-2.0.0/webcomponents.js","RJ-2025-034.log","RJ-2025-034.tex","RJ-2025-034.zip","RJournal.sty","RJwrapper.log","RJwrapper.tex","Rlogo-5.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="RJ-2025-034_files/header-attrs-2.30/header-attrs.js"></script>
  <script src="RJ-2025-034_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="RJ-2025-034_files/popper-2.6.0/popper.min.js"></script>
  <link href="RJ-2025-034_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="RJ-2025-034_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="RJ-2025-034_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="RJ-2025-034_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="RJ-2025-034_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="RJ-2025-034_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="RJ-2025-034_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      
      // Conditionally add supplementary files button
      if (document.getElementById('supplementary-materials')) {
        // create element safely
        const btn_suppl = document.createElement('a');
        btn_suppl.href = slug + '.zip';
        btn_suppl.className = 'dt-tag';
        btn_suppl.innerHTML = '<i class="fas fa-file-zipper"></i> Supplement';
        buttons.append(btn_suppl);
      }

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"longevity: An R Package for Modelling Excess Lifetimes","description":"The longevity R package provides a maximum likelihood estimation routine for modelling of survival data that are subject to non-informative censoring or truncation. It includes a selection of 12 parametric models of varying complexity, with a focus on tools for extreme value analysis and more specifically univariate peaks over threshold modelling. The package provides utilities for univariate threshold selection, parametric and nonparametric maximum likelihood estimation, goodness of fit diagnostics and model comparison tools. These different methods are illustrated using individual Dutch records and aggregated Japanese human lifetime data.","doi":"10.32614/RJ-2025-034","authors":[{"author":"Léo R. Belzile","authorURL":"https://lbelzile.bitbucket.io","affiliation":"Department of Decision Sciences, HEC Montréal","affiliationURL":"#","orcidID":"0000-0002-9135-014X"}],"publishedDate":"2026-01-06T00:00:00.000+11:00","citationText":"Belzile, 2026"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>longevity: An R Package for Modelling Excess Lifetimes</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>The longevity R package provides a maximum likelihood estimation routine for modelling of survival data that are subject to non-informative censoring or truncation. It includes a selection of 12 parametric models of varying complexity, with a focus on tools for extreme value analysis and more specifically univariate peaks over threshold modelling. The package provides utilities for univariate threshold selection, parametric and nonparametric maximum likelihood estimation, goodness of fit diagnostics and model comparison tools. These different methods are illustrated using individual Dutch records and aggregated Japanese human lifetime data.</p></p>
</div>

<div class="d-byline">
  Léo R. Belzile <a href="https://lbelzile.bitbucket.io" class="uri">https://lbelzile.bitbucket.io</a> (Department of Decision Sciences, HEC Montréal)
  
<br/>2026-01-06
</div>

<div class="d-article">
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Many data sets collected by demographers for the analysis of human longevity have unusual features and for which limited software implementations exist. The <a href="https://cran.r-project.org/package=longevity">longevity</a> package was initially built for dealing with human longevity records and data from the International Database on Longevity (IDL), which provides age at death of supercentenarians, i.e., people who died above age 110. Data for the statistical analysis of (human) longevity can take the form of aggregated counts per age at death, or most commonly life trajectory of individuals with both birth and death dates. Such lifetimes are often interval truncated (only age at death of individuals dying between two calendar dates are recorded) or left truncated and right censored (when data of individuals still alive at the end of the collection period are also included). Another frequent format is death counts, aggregated per age band. Censoring and truncation are typically of administrative nature and thus non-informative about death.</p>
<p>Supercentenarians are extremely rare and records are sparse. The most popular parametric models used by practitioners are justified by asymptotic arguments and have their roots in extreme value theory. Univariate extreme value distributions are well implemented in software and <span class="citation" data-cites="Belzile.Dutang.Northrop.Opitz:2022">Belzile et al. (<a href="#ref-Belzile.Dutang.Northrop.Opitz:2022" role="doc-biblioref">2023b</a>)</span> provides a recent review of existing implementations. While there are many standard R packages for the analysis of univariate extremes using likelihood-based inference, such as <a href="https://cran.r-project.org/package=evd">evd</a> <span class="citation" data-cites="evd">(<a href="#ref-evd" role="doc-biblioref">Stephenson 2002</a>)</span>, <a href="https://cran.r-project.org/package=mev">mev</a> and <a href="https://cran.r-project.org/package=extRemes">extRemes</a> <span class="citation" data-cites="extRemes">(<a href="#ref-extRemes" role="doc-biblioref">Gilleland and Katz 2016</a>)</span>, only the <a href="https://cran.r-project.org/package=evgam">evgam</a> package includes functionalities to fit threshold exceedance models with censoring, as showcased in <span class="citation" data-cites="evgam">Youngman (<a href="#ref-evgam" role="doc-biblioref">2022</a>)</span> with rounded rainfall measurements. Support for survival data for extreme value models is in general wholly lacking, which motivated the development of <a href="https://cran.r-project.org/package=longevity">longevity</a>.</p>
<p>The <a href="https://cran.r-project.org/package=longevity">longevity</a> package also includes several parametric models commonly used in demography. Many existing packages that focus on tools for modelling mortality rates, typically through life tables, are listed in the CRAN Task View <a href="https://CRAN.R-project.org/view=ActuarialScience">ActuarialScience</a> in the Life insurance section. They do not however allow for truncation or more general survival mechanisms, as the aggregated data used are typically complete except for potential right censoring for the oldest age group. The <a href="https://cran.r-project.org/package=survival">survival</a> package <span class="citation" data-cites="survival-book">(<a href="#ref-survival-book" role="doc-biblioref">Therneau and Grambsch 2000</a>)</span> includes utilities for accelerated failure time models for 10 parametric models. The <a href="https://cran.r-project.org/package=MortCast">MortCast</a> package can be used to estimate age-specific mortality rates using the Kannisto and Lee–Carter approaches, among others <span class="citation" data-cites="Sevcikova:2016">(<a href="#ref-Sevcikova:2016" role="doc-biblioref">Ševčíková et al. 2016</a>)</span>. The <a href="https://cran.r-project.org/package=demography">demography</a> package provides forecasting methods for death rates based on constructed life tables using the Lee–Carter or ARIMA models. <a href="https://cran.r-project.org/package=MortalityLaws">MortalityLaws</a> includes utilities to download data from the Human Mortality Database (HMD), and fit a total of 27 parametric models for life table data (death counts and population at risk per age group) using Poisson, binomial or alternative loss functions. The <a href="https://cran.r-project.org/package=vitality">vitality</a> package fits the family of vitality models <span class="citation" data-cites="Li.Anderson:2009 Anderson:2000">(<a href="#ref-Anderson:2000" role="doc-biblioref">Anderson 2000</a>; <a href="#ref-Li.Anderson:2009" role="doc-biblioref">Li and Anderson 2009</a>)</span> via maximum likelihood based on empirical survival data. The <a href="https://cran.r-project.org/package=fitdistrplus">fitdistrplus</a> <span class="citation" data-cites="fitdistrplus-package">(<a href="#ref-fitdistrplus-package" role="doc-biblioref">Delignette-Muller and Dutang 2015</a>)</span> allows for generic parametric distributions to be fitted to interval censored data via maximum likelihood, with various S3 methods for model assessment. The package also allows user-specified models, thereby permitting custom definitions for truncated distributions whose truncation bounds are passed as fixed vector parameters. Parameter uncertainty can be obtained via additional functions using nonparametric bootstrap. Many parametric distributions also appear in the <a href="https://cran.r-project.org/package=VGAM">VGAM</a> package <span class="citation" data-cites="Yee.Wild:1996 VGAMbook">(<a href="#ref-Yee.Wild:1996" role="doc-biblioref">Yee and Wild 1996</a>; <a href="#ref-VGAMbook" role="doc-biblioref">Yee 2015</a>)</span>, which allows for vector generalized linear modelling. The <a href="https://cran.r-project.org/package=longevity">longevity</a> package is less general and offers support only for selected parametric distributions, but contrary to the aforementioned packages allows for truncation and general patterns. One strength of <a href="https://cran.r-project.org/package=longevity">longevity</a> is that it also includes model comparison tools that account for non-regular asymptotics and goodness of fit diagnostics.</p>
<p>Nonparametric methods are popular tools for the analysis of survival data with large samples, owing to their limited set of assumptions. They also serve for the validation of parametric models. Without explanatory variable, a closed-form estimator of the nonparametric maximum likelihood estimator of the survival function can be derived in particular instances, including the product limit estimator <span class="citation" data-cites="Kaplan.Meier:1958">(<a href="#ref-Kaplan.Meier:1958" role="doc-biblioref">Kaplan and Meier 1958</a>)</span> for the case of random or non-informative right censoring and an extension allowing for left truncation <span class="citation" data-cites="Tsai.Jewell.Wang:1987">(<a href="#ref-Tsai.Jewell.Wang:1987" role="doc-biblioref">Tsai et al. 1987</a>)</span>. In general, the nonparametric maximum likelihood estimator of the survival function needs to be computed using an expectation-maximization (EM) algorithm <span class="citation" data-cites="Turnbull:1976">(<a href="#ref-Turnbull:1976" role="doc-biblioref">Turnbull 1976</a>)</span>. Nonparametric estimators only assign probability mass on observed failure times and intervals and so cannot be used for extrapolation beyond the range of the data, limiting its utility in extreme value analysis.</p>
<p>The CRAN Task View on <a href="https://CRAN.R-project.org/view=Survival">Survival</a> Analysis lists various implementations of nonparametric maximum likelihood estimators of the survival or hazard functions: <a href="https://cran.r-project.org/package=survival">survival</a> implements the Kaplan–Meier and Nelson–Aalen estimators. Many packages focus on the case of interval censoring <span class="citation" data-cites="Groeneboom.Wellner:1992">(<a href="#ref-Groeneboom.Wellner:1992" role="doc-biblioref">Groeneboom and Wellner 1992 3.2</a>)</span>, including <a href="https://cran.r-project.org/package=prodlim">prodlim</a>; <span class="citation" data-cites="Anderson-Bergman:2017">Anderson-Bergman (<a href="#ref-Anderson-Bergman:2017" role="doc-biblioref">2017a</a>)</span> reviews the performance of the implementations in <a href="https://cran.r-project.org/package=icenReg">icenReg</a> <span class="citation" data-cites="icensReg">(<a href="#ref-icensReg" role="doc-biblioref">Anderson-Bergman 2017b</a>)</span> and <a href="https://www.bioconductor.org/packages/Icens/">Icens</a>. The latter uses the incidence matrix as input data. Routines for doubly censored data are provided by <a href="https://cran.r-project.org/package=dblcens">dblcens</a>. The <a href="https://cran.r-project.org/package=interval">interval</a> <span class="citation" data-cites="interval">(<a href="#ref-interval" role="doc-biblioref">Fay and Shaw 2010</a>)</span> implements Turnbull’s EM algorithm for interval censored data. The case of left truncated and right censored data is handled by <a href="https://cran.r-project.org/package=survival">survival</a>, and <a href="https://cran.r-project.org/package=tranSurv">tranSurv</a> provides transformation models with the potential to account for truncation dependent on survival times. For interval truncated data, dedicated algorithms that use gradient-based steps <span class="citation" data-cites="Efron.Petrosian:1999">(<a href="#ref-Efron.Petrosian:1999" role="doc-biblioref">Efron and Petrosian 1999</a>)</span> or inverse probability weighting <span class="citation" data-cites="Shen:2010">(<a href="#ref-Shen:2010" role="doc-biblioref">Shen 2010</a>)</span> exist and can be more efficient than the EM algorithm of <span class="citation" data-cites="Turnbull:1976">Turnbull (<a href="#ref-Turnbull:1976" role="doc-biblioref">1976</a>)</span>. Many of these are implemented in the <a href="https://cran.r-project.org/package=DTDA">DTDA</a> package. The <a href="https://cran.r-project.org/package=longevity">longevity</a> package includes a C<span class="math inline">\(^{++}\)</span> implementation of the corrected Turnbull’s algorithm <span class="citation" data-cites="Turnbull:1976">(<a href="#ref-Turnbull:1976" role="doc-biblioref">Turnbull 1976</a>)</span>, returning the nonparametric maximum likelihood estimator for arbitrary censoring and truncation patterns, as opposed to the specific existing aforementioned implementations already available which focus on specific subcases. With a small number of observations, it is also relatively straightforward to maximize the log likelihood for the concave program subject to linear constraints using constrained optimization algorithms; <a href="https://cran.r-project.org/package=longevity">longevity</a> relies for this on <a href="https://cran.r-project.org/package=Rsolnp">Rsolnp</a>, which uses augmented Lagrangian methods and sequential quadratic programming <span class="citation" data-cites="Ye:1987">(<a href="#ref-Ye:1987" role="doc-biblioref">Ye 1987</a>)</span>.</p>
<h3 data-number="1.1" id="motivating-examples"><span class="header-section-number">1.1</span> Motivating examples</h3>
<p>To showcase the functionality of the package and particularity for the modelling of threshold exceedances, we consider Dutch and Japanese life lengths. The <code>dutch</code> database contains the age at death (in days) of Dutch people who died above age 92 between 1986 and 2015; these data were obtained from Statistics Netherlands and analyzed in <span class="citation" data-cites="Einmahl:2019">Einmahl et al. (<a href="#ref-Einmahl:2019" role="doc-biblioref">2019</a>)</span> and <span class="citation" data-cites="ARSIA:2022">Belzile et al. (<a href="#ref-ARSIA:2022" role="doc-biblioref">2022</a>)</span>. Records are interval truncated, as people are included in the database only if they died during the collection period. In addition, there are 226 interval censored and interval truncated records for which only the month and year of birth and death are known, as opposed to exact dates.</p>
<p>The second database we consider is drawn from <span class="citation" data-cites="ExceptionalLifespans">Maier et al. (<a href="#ref-ExceptionalLifespans" role="doc-biblioref">2021</a>)</span>. The data frame <code>japanese2</code> consists of counts of Japanese above age 100 by age band and are stratified by both birth cohort and sex. To illustrate the format of the data, counts for female Japanese are reproduced in Table <a href="#tab:tbl-japanese-women">1</a>. The data were constructed using the extinct cohort method and are interval censored between <span class="math inline">\(\texttt{age}\)</span> and <span class="math inline">\(\texttt{age} + 1\)</span> and right truncated at the age reached by the oldest individuals of their birth cohort in 2020. The <code>count</code> variable lists the number of instances in the contingency table, and serves as a weight for likelihood contributions.</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption><span id="tab:tbl-japanese-women">Table 1: </span>Death count by birth cohort and age band for female Japanese.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">age</th>
<th style="text-align: right;">1874-1878</th>
<th style="text-align: right;">1879-1883</th>
<th style="text-align: right;">1884-1888</th>
<th style="text-align: right;">1889-1893</th>
<th style="text-align: right;">1894-1898</th>
<th style="text-align: right;">1899-1900</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1648</td>
<td style="text-align: right;">2513</td>
<td style="text-align: right;">4413</td>
<td style="text-align: right;">8079</td>
<td style="text-align: right;">16036</td>
<td style="text-align: right;">9858</td>
</tr>
<tr class="even">
<td style="text-align: right;">101</td>
<td style="text-align: right;">975</td>
<td style="text-align: right;">1596</td>
<td style="text-align: right;">2921</td>
<td style="text-align: right;">5376</td>
<td style="text-align: right;">11047</td>
<td style="text-align: right;">7091</td>
</tr>
<tr class="odd">
<td style="text-align: right;">102</td>
<td style="text-align: right;">597</td>
<td style="text-align: right;">987</td>
<td style="text-align: right;">1864</td>
<td style="text-align: right;">3446</td>
<td style="text-align: right;">7487</td>
<td style="text-align: right;">4869</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">345</td>
<td style="text-align: right;">597</td>
<td style="text-align: right;">1153</td>
<td style="text-align: right;">2230</td>
<td style="text-align: right;">5014</td>
<td style="text-align: right;">3293</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: right;">191</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">662</td>
<td style="text-align: right;">1403</td>
<td style="text-align: right;">3242</td>
<td style="text-align: right;">2133</td>
</tr>
<tr class="even">
<td style="text-align: right;">105</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">381</td>
<td style="text-align: right;">855</td>
<td style="text-align: right;">2084</td>
<td style="text-align: right;">1357</td>
</tr>
<tr class="odd">
<td style="text-align: right;">106</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">495</td>
<td style="text-align: right;">1284</td>
<td style="text-align: right;">836</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">274</td>
<td style="text-align: right;">774</td>
<td style="text-align: right;">521</td>
</tr>
<tr class="odd">
<td style="text-align: right;">108</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">433</td>
<td style="text-align: right;">297</td>
</tr>
<tr class="even">
<td style="text-align: right;">109</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">252</td>
<td style="text-align: right;">167</td>
</tr>
<tr class="odd">
<td style="text-align: right;">110</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: right;">111</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="odd">
<td style="text-align: right;">112</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: right;">113</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">114</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">115</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">116</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">117</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<h2 data-number="2" id="package-functionalities"><span class="header-section-number">2</span> Package functionalities</h2>
<p>The <a href="https://cran.r-project.org/package=longevity">longevity</a> package uses the S3 object oriented system and provides a series of functions with common arguments. The syntax used by the <a href="https://cran.r-project.org/package=longevity">longevity</a> package purposely mimics that of the <a href="https://cran.r-project.org/package=survival">survival</a> package <span class="citation" data-cites="survival-book">(<a href="#ref-survival-book" role="doc-biblioref">Therneau and Grambsch 2000</a>)</span>, except that it does not specify models using a formula. Users must provide vectors for the time or age (or bounds in case of intervals) via arguments <code>time</code> and <code>time2</code>, as well as lower and upper truncation bounds (<code>ltrunc</code> and <code>rtrunc</code>) if applicable. The integer vector <code>event</code> is used to indicate the type of event, where following <a href="https://cran.r-project.org/package=survival">survival</a> <code>0</code> indicates right-censoring, <code>1</code> observed events, <code>2</code> left-censoring and <code>3</code> interval censoring. Together, these five vectors characterize the data and the survival mechanisms at play. Depending on the sampling scheme, not all arguments are required or relevant and they need not be of the same length, but are common to most functions. Users can also specify a named list <code>args</code> to pass arguments: as illustrated below, this is convenient to avoid specifying repeatedly the common arguments in each function call. Default values are overridden by elements in <code>args</code>, with the exception of those that are passed by the user directly in the call. Relative to <a href="https://cran.r-project.org/package=survival">survival</a>, functions have additional arguments <code>ltrunc</code> and <code>rtrunc</code> for left and right truncation limits, as these are also possibly matrices for the case of double interval truncation <span class="citation" data-cites="ARSIA:2022">(<a href="#ref-ARSIA:2022" role="doc-biblioref">Belzile et al. 2022</a>)</span>, since both censoring and truncation can be present simultaneously.</p>
<p>We can manipulate the data set to build the time vectors and truncation bounds for the Dutch data. We re-scale observations to years for interpretability and keep only records above age 98 for simplicity. We split the data to handle the observed age at death first: these are treated as observed (uncensored) whenever <code>time</code> and <code>time2</code> coincide. When exact dates are not available, we compute the range of possible age at which individuals may have died, given their birth and death years and months. The truncation bounds for each individual can be obtained by subtracting from the endpoints of the sampling frame the birth dates, with left and right truncation bounds
<span class="math display">\[\begin{align*}
\texttt{ltrunc}=\min\{92 \text{ years}, 1986.01.01 - \texttt{bdate}\}, \qquad \texttt{rtrunc} = 2015.12.31- \texttt{bdate}.
\end{align*}\]</span>
Table <a href="#tab:tbl-dutch-preview">2</a> shows a sample of five individuals, two of whom are interval-censored, and the corresponding vectors of arguments along with two covariates, gender (<code>gender</code>) and birth year (<code>byear</code>).</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption><span id="tab:tbl-dutch-preview">Table 2: </span>Sample of five Dutch records, formatted so that the inputs match the function arguments used by the package. Columns give the age in years at death (or plausible interval), lower and upper truncation bounds giving minimum and maximum age for inclusion, an integer indicating the type of censoring, gender and birth year.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">time</th>
<th style="text-align: right;">time2</th>
<th style="text-align: right;">ltrunc</th>
<th style="text-align: right;">rtrunc</th>
<th style="text-align: right;">event</th>
<th style="text-align: left;">gender</th>
<th style="text-align: right;">byear</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">104.67</td>
<td style="text-align: right;">105.74</td>
<td style="text-align: right;">80.00</td>
<td style="text-align: right;">111.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1905</td>
</tr>
<tr class="even">
<td style="text-align: right;">103.50</td>
<td style="text-align: right;">104.58</td>
<td style="text-align: right;">78.00</td>
<td style="text-align: right;">109.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1907</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100.28</td>
<td style="text-align: right;">100.28</td>
<td style="text-align: right;">92.01</td>
<td style="text-align: right;">104.50</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1911</td>
</tr>
<tr class="even">
<td style="text-align: right;">100.46</td>
<td style="text-align: right;">100.46</td>
<td style="text-align: right;">92.01</td>
<td style="text-align: right;">102.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">1913</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100.51</td>
<td style="text-align: right;">100.51</td>
<td style="text-align: right;">92.01</td>
<td style="text-align: right;">104.35</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1911</td>
</tr>
</tbody>
</table>
</div>
<p>We can proceed similarly for the Japanese data. Ages of centenarians are rounded down to the nearest year, so all observations are interval censored within one-year intervals. Assuming that the ages at death are independent and identically distributed with distribution function <span class="math inline">\(F(\cdot; \boldsymbol{\theta})\)</span>, the log likelihood for exceedances <span class="math inline">\(y_i = \texttt{age}_i - u\)</span> above age <span class="math inline">\(u\)</span> is
<span class="math display">\[\begin{align*}
\ell(\boldsymbol{\theta}) = \sum_{i: \texttt{age}_i &gt; u}n_i \left[\log \{F(y_i+1; \boldsymbol{\theta}) - F(y_i; \boldsymbol{\theta})\} - \log F(r_i - u; \boldsymbol{\theta})\right]
\end{align*}\]</span>
where <span class="math inline">\(n_i\)</span> is the count of the number of individuals in cell <span class="math inline">\(i\)</span> and <span class="math inline">\(r_i &gt; \texttt{age}_i+1\)</span> is the right truncation limit for that cell, i.e., the maximum age that could have been achieved for that birth cohort by the end of the data collection period.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>japanese2</span>, package <span class='op'>=</span> <span class='st'>"longevity"</span><span class='op'>)</span></span>
<span><span class='co'># Keep only non-empty cells</span></span>
<span><span class='va'>japanese2</span> <span class='op'>&lt;-</span> <span class='va'>japanese2</span><span class='op'>[</span><span class='va'>japanese2</span><span class='op'>$</span><span class='va'>count</span> <span class='op'>&gt;</span> <span class='fl'>0</span>, <span class='op'>]</span></span>
<span><span class='co'># Define arguments that are recycled</span></span>
<span><span class='va'>japanese2</span><span class='op'>$</span><span class='va'>rtrunc</span> <span class='op'>&lt;-</span> <span class='fl'>2020</span> <span class='op'>-</span> </span>
<span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>japanese2</span><span class='op'>$</span><span class='va'>bcohort</span>, <span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># The line above extracts the earliest year of the birth cohort</span></span>
<span><span class='co'># Create a list with all arguments common to package functions</span></span>
<span><span class='va'>args_japan</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>japanese2</span>, </span>
<span>       <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>        time <span class='op'>=</span> <span class='va'>age</span>, <span class='co'># lower censoring bound</span></span>
<span>        time2 <span class='op'>=</span> <span class='va'>age</span> <span class='op'>+</span> <span class='fl'>1L</span>, <span class='co'># upper censoring bound</span></span>
<span>        event <span class='op'>=</span> <span class='fl'>3</span>, <span class='co'># define interval censoring</span></span>
<span>        type <span class='op'>=</span> <span class='st'>"interval2"</span>,</span>
<span>        rtrunc <span class='op'>=</span> <span class='va'>rtrunc</span>, <span class='co'># right truncation limit</span></span>
<span>        weights <span class='op'>=</span> <span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># counts as weights</span></span></code></pre>
</div>
</div>
<h3 data-number="2.1" id="parametric-models-and-maximum-likelihood-estimation"><span class="header-section-number">2.1</span> Parametric models and maximum likelihood estimation</h3>
<p>Various models are implemented in <a href="https://cran.r-project.org/package=longevity">longevity</a>: their hazard functions are reported in Table <a href="#tab:tbl-parametric-models">3</a>. Two of those models, labelled <code>perks</code> and <code>beard</code> are logistic-type hazard functions proposed in <span class="citation" data-cites="Perks:1932">Perks (<a href="#ref-Perks:1932" role="doc-biblioref">1932</a>)</span> that have been used by <span class="citation" data-cites="Beard:1963">Beard (<a href="#ref-Beard:1963" role="doc-biblioref">1963</a>)</span>, and popularized in work of Kannisto and Thatcher; we use the parametrization of <span class="citation" data-cites="Richards:2012">Richards (<a href="#ref-Richards:2012" role="doc-biblioref">2012</a>)</span>, from which we also adopt the nomenclature. Users can compare the models with those available in <a href="https://cran.r-project.org/package=MortalityLaws">MortalityLaws</a>; see <code>?availableLaws</code> for the list of hazard functions and parametrizations.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption>
<span id="tab:tbl-parametric-models">Table 3: </span>List of parametric models for excess lifetime supported by the package, with parametrization and hazard functions. The models are expressed in terms of scale parameter <span class="math inline">\(\sigma\)</span>, rate parameters <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\nu\)</span>, and shape parameters <span class="math inline">\(\xi\)</span>, <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\beta\)</span>.
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:left;">
hazard function
</th>
<th style="text-align:left;">
constraints
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>exp</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma^{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma &gt; 0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>gomp</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma^{-1}\exp(\beta t/\sigma)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma &gt; 0, \beta \ge 0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>gp</code>
</td>
<td style="text-align:left;">
<span class="math inline">\((\sigma + \xi t)_{+}^{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma &gt; 0, \xi \in \mathbb{R}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>weibull</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma^{-\alpha} \alpha t^{\alpha-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma &gt; 0, \alpha &gt; 0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>extgp</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta\sigma^{-1}\exp(\beta t/\sigma)[\beta+\xi\{\exp(\beta t/\sigma) -1\}]^{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma &gt; 0, \beta \ge 0, \xi \in \mathbb{R}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>extweibull</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\alpha\sigma^{-\alpha}t^{\alpha-1}\{1+\xi(t/\sigma)^{\alpha}\}_{+}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sigma &gt; 0, \alpha &gt; 0, \xi \in \mathbb{R}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>perks</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\alpha\exp(\nu x)/\{1+\alpha\exp(\nu x)\}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\nu \ge 0, \alpha &gt;0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>beard</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\alpha\exp(\nu x)/\{1+\alpha\beta\exp(\nu x)\}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\nu \ge 0, \alpha &gt;0, \beta \ge 0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>gompmake</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda + \sigma^{-1}\exp(\beta t/\sigma)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda \ge 0, \sigma &gt; 0, \beta \ge 0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>perksmake</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda + \alpha\exp(\nu x)/\{1+\alpha\exp(\nu x)\}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda \ge 0, \nu \ge 0, \alpha &gt; 0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>beardmake</code>
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda + \alpha\exp(\nu x)/\{1+\alpha\beta\exp(\nu x)\}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda \ge 0, \nu \ge 0, \alpha &gt; 0, \beta \ge 0\)</span>
</td>
</tr>
</tbody>
</table>
</div>
<p>Many of the models are nested and Figure <a href="#fig:fig-nesting">1</a> shows the logical relation between the various families. The function <code>fit_elife</code> allows users to fit all of the parametric models of Table <a href="#tab:tbl-parametric-models">3</a>: the <code>print</code> method returns a summary of the sampling mechanism, the number of observations, the maximum log likelihood and parameter estimates with standard errors. Depending on the data, some models may be overparametrized and parameters need not be numerically identifiable. To palliate such issues, the optimization routine, which uses <a href="https://cran.r-project.org/package=Rsolnp">Rsolnp</a>, can try multiple starting values or fit various sub-models to ensure that the parameter values returned are indeed the maximum likelihood estimates. If one tries to compare nested models and the fit of the simpler model is better than the alternative, the <code>anova</code> function will return an error message.</p>
<p>The <code>fit_elife</code> function handles arbitrary censoring patterns over single intervals, along with single interval truncation and interval censoring. To accommodate the sampling scheme of the International Database on Longevity (IDL), an option also allows for double interval truncation <span class="citation" data-cites="ARSIA:2022">(<a href="#ref-ARSIA:2022" role="doc-biblioref">Belzile et al. 2022</a>)</span>, whereby observations are included only if the person dies between time intervals, potentially overlapping, which defines the observation window over which dead individuals are recorded.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>thresh</span> <span class='op'>&lt;-</span> <span class='fl'>108</span></span>
<span><span class='va'>model0</span> <span class='op'>&lt;-</span> <span class='fu'>fit_elife</span><span class='op'>(</span>arguments <span class='op'>=</span> <span class='va'>args_japan</span>,</span>
<span>          thresh <span class='op'>=</span> <span class='va'>thresh</span>, </span>
<span>          family <span class='op'>=</span> <span class='st'>"exp"</span><span class='op'>)</span></span>
<span><span class='op'>(</span><span class='va'>model1</span> <span class='op'>&lt;-</span> <span class='fu'>fit_elife</span><span class='op'>(</span>arguments <span class='op'>=</span> <span class='va'>args_japan</span>,</span>
<span>           thresh <span class='op'>=</span> <span class='va'>thresh</span>, </span>
<span>           family <span class='op'>=</span> <span class='st'>"gomp"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; Model: Gompertz distribution. 
#&gt; Sampling: interval censored, right truncated
#&gt; Log-likelihood: -3599.037 
#&gt; 
#&gt; Threshold: 108 
#&gt; Number of exceedances: 2489 
#&gt; 
#&gt; Estimates
#&gt;  scale   shape  
#&gt; 1.6855  0.0991  
#&gt; 
#&gt; Standard Errors
#&gt;  scale   shape  
#&gt; 0.0523  0.0273  
#&gt; 
#&gt; Optimization Information
#&gt;   Convergence: TRUE</code></pre>
</div>
<h3 data-number="2.2" id="model-comparisons"><span class="header-section-number">2.2</span> Model comparisons</h3>
<p>Goodness of fit of nested models can be compared using likelihood ratio tests via the <code>anova</code> method. Most of the interrelations between models yield non-regular model comparisons since, to recover the simpler model, one must often fix parameters to values that lie on the boundary of the parameter space. For example, if we compare a Gompertz model with the exponential, the limiting null distribution is a mixture of a point mass at zero and a <span class="math inline">\(\chi^2_1\)</span> variable, both with probability half <span class="citation" data-cites="Chernoff:1954">(<a href="#ref-Chernoff:1954" role="doc-biblioref">Chernoff 1954</a>)</span>. Many authors <span class="citation" data-cites="Camarda:2022">(e.g., <a href="#ref-Camarda:2022" role="doc-biblioref">Camarda 2022</a>)</span> fail to recognize this fact. The case becomes more complicated with more than one boundary constraint: for example, the deviance statistic comparing the Beard–Makeham and the Gompertz model, which constrains two parameters on the boundary of the parameter space, has a null distribution which is a mixture of <span class="math inline">\(\chi^2_2/4 + \chi^2_1/2 + \chi^2_0/4\)</span> <span class="citation" data-cites="Self.Liang:1987">(<a href="#ref-Self.Liang:1987" role="doc-biblioref">Self and Liang 1987</a>)</span>.</p>
<p>Nonidentifiability impacts testing: for example, if the rate parameter of the Perks–Makeham model (<code>perksmake</code>) <span class="math inline">\(\nu \to 0\)</span>, the limiting hazard, <span class="math inline">\(\lambda + \exp(\alpha)/\{1+\exp(\alpha)\}\)</span>, is constant (exponential model), but neither <span class="math inline">\(\alpha\)</span> nor <span class="math inline">\(\lambda\)</span> is identifiable. The usual asymptotics for the likelihood ratio test break down as the information matrix is singular <span class="citation" data-cites="Rotnitzky:2000">(<a href="#ref-Rotnitzky:2000" role="doc-biblioref">Rotnitzky et al. 2000</a>)</span>. As such, all three families that include a Makeham component cannot be directly compared to the exponential in <a href="https://cran.r-project.org/package=longevity">longevity</a> and the call to <code>anova</code> returns an error message.</p>
<p>Users can also access information criteria, <code>AIC</code> and <code>BIC</code>. The correction factors implemented depend on the number of parameters of the distribution, but do not account for singular fit, non-identifiable parameters or singular models for which the usual corrections <span class="math inline">\(2p\)</span> and <span class="math inline">\(\ln(n)p\)</span> are inadequate <span class="citation" data-cites="Watanabe:2010">(<a href="#ref-Watanabe:2010" role="doc-biblioref">Watanabe 2010</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-nesting"></span>
<img src="fig/nesting_graph.png" alt="Graph with parametric model names, and arrows indicating the relationship between these. Dashed arrows indicate non-regular comparisons between nested models, and the expression indicates which parameter to fix to obtain the submodel." width="100%" />
<p class="caption">
Figure 1: Relationship between parametric models showing nested relations. Dashed arrows represent restrictions that lead to nonregular asymptotic null distribution for comparison of nested models. Comparisons between models with Makeham components and exponential are not permitted by the software because of nonidentifiability issues.
</p>
</div>
</div>
<p>To showcase how hypothesis testing is performed, we consider a simple example with two nested models. We test whether the exponential model is an adequate simplification of the Gompertz model for exceedances above 108 years — an irregular testing problem since <span class="math inline">\(\beta=0\)</span> is a restriction on the boundary of the parameter space. The drop in log likelihood is quite large, indicating the exponential model is not an adequate simplification of the Gompertz fit. This is also what is suggested by the Bayesian information criterion, which is much lower for the Gompertz model than for the exponential.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Model comparison</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>model1</span>, <span class='va'>model0</span><span class='op'>)</span></span>
<span><span class='co'># Information criteria</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"exponential"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></span><span class='op'>(</span><span class='va'>model0</span><span class='op'>)</span>, <span class='st'>"Gompertz"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></span><span class='op'>(</span><span class='va'>model1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">npar</th>
<th style="text-align: right;">Deviance</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Chisq</th>
<th style="text-align: right;">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">gomp</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7198.07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">exp</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7213.25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.17</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<pre><code>#&gt; exponential    Gompertz 
#&gt;    7221.065    7213.713</code></pre>
</div>
<h3 data-number="2.3" id="simulation-based-inference"><span class="header-section-number">2.3</span> Simulation-based inference</h3>
<p>Given the poor finite sample properties of the aforementioned tests, it may be preferable to rely on a parametric bootstrap rather than on the asymptotic distribution of the test statistic <span class="citation" data-cites="ARSIA:2022">(<a href="#ref-ARSIA:2022" role="doc-biblioref">Belzile et al. 2022</a>)</span> for model comparison.
Simulation-based inference requires capabilities for drawing new data sets whose features match those of the original one. For example, the <a href="supercentenarians.org">International Database on Longevity</a> (IDL) <span class="citation" data-cites="IDL:2021">(<a href="#ref-IDL:2021" role="doc-biblioref">Jdanov et al. 2021</a>)</span> features data that are interval truncated above 110 years, but doubly interval truncated since the sampling period for semisupercentenarians (who died age 105 to 110) and supercentenarians (who died above 110) are not always the same <span class="citation" data-cites="ARSIA:2022">(<a href="#ref-ARSIA:2022" role="doc-biblioref">Belzile et al. 2022</a>)</span>. The 2018 Istat semisupercentenarians database analyzed by <span class="citation" data-cites="Barbi:2018">Barbi et al. (<a href="#ref-Barbi:2018" role="doc-biblioref">2018</a>)</span> on Italians includes left truncated right censored records.</p>
<p>To mimic the postulated data generating mechanism while accounting for the sampling scheme, we could use the observed birth dates, or simulate new birth dates (possibly through a kernel estimator of the empirical distribution of birth dates) while keeping the sampling frame with the first and last date of data collection to define the truncation interval. In other settings, one could obtain the nonparametric maximum likelihood estimator of the distribution of the upper truncation bound <span class="citation" data-cites="Shen:2010">(<a href="#ref-Shen:2010" role="doc-biblioref">Shen 2010</a>)</span> using an inverse probability weighted estimator, which for fixed data collection windows is equivalent to setting the birth date.</p>
<p>The <code>samp_elife</code> function includes multiple <code>type2</code> arguments to handle these. For interval truncated data (<code>type2="ltrt"</code>), it uses the inversion method (Section 2 of <span class="citation" data-cites="Devroye:1986">Devroye (<a href="#ref-Devroye:1986" role="doc-biblioref">1986</a>)</span>): for <span class="math inline">\(F\)</span> an absolutely continuous distribution function and <span class="math inline">\(F^{-1}\)</span> the corresponding quantile function, a random variable distributed according to <span class="math inline">\(F\)</span> truncated on <span class="math inline">\([a,b]\)</span> is generated as <span class="math inline">\(X \sim F^{-1}[F(a) + U\{F(b)-F(a)\}]\)</span>
where <span class="math inline">\(U \sim \mathsf{U}(0,1)\)</span> is standard uniform.</p>
<p>The function <code>samp_elife</code> also has an argument <code>upper</code> which serves for both right truncation, and right censoring. For the latter, any record simulated that exceeds <code>upper</code> is capped at that upper bound and declared partially observed. This is useful for simulating administrative censoring, whereby the birth date and the upper bound of the collection window fully determine whether an observation is right censored or not. An illustrative example is provided in the next section.</p>
<!-- The International Database on Longevity (IDL) which provides validated records of (semi)-supercentenarians who died above age 105 and 110 years, is the foremost source of information for studying lifespan as it is free of age-ascertainment bias due to selective reporting and self-selection inherent to many other data sources. The data are freely available for researchers upon registration and an R [script](https://raw.githubusercontent.com/lbelzile/arsia-longevity/main/idl_preprocessing.R) can be used to transform the raw comma separated-value (CSV) file into a tidy data frame. However, and since these data cannot be shared, we use simulated data that mimic the sampling scheme for illustration purposes. We consider England and Wales supercentenarians from the fourth release of the IDL: the 179 individuals died between 1968 and 2020 based on the metadata, so the latest birth date for an individual reaching 110 years old is December 31st, 1910. The distribution of birth dates prior to this bound is well described (for the purpose of our illustration) by a Gamma distribution with shape 1.615 and scale 9.945 years, truncated above at 55 years. We sample truncated Gamma components and subtract them the latest possible birth date: equipped with these simulated birth dates, we next generate new life lengths from an interval truncated generalized Pareto distribution, enforcing the left and right truncation bounds for the age for them to appear in the observation window. Simulated data are stored in the data frame `ewsim4`. -->
<div class="layout-chunk" data-layout="l-body">

</div>
<p>The <code>anova</code> method call uses the asymptotic null distribution for comparison of nested parametric distributions <span class="math inline">\(\mathcal{F}_0 \subseteq \mathcal{F}_1\)</span>. We could use the bootstrap to see how good this approximation to the null distribution is. To mimic as closely as possible the data generating mechanism, which is custom in most scenarios, we condition on the sampling frame and the number of individuals in each birth cohort. The number dying at each age is random, but the right truncation limits will be the same for anyone in that cohort. We simulate excess lifetimes, then interval censor observations by keeping only the corresponding age bracket. Under the null hypothesis, the data are drawn from <span class="math inline">\(\widehat{F}_0 \in \mathcal{F}_0\)</span> and we generate observations from this right truncated distribution using the <code>samp_elife</code> utility, which also supports double interval truncation and left truncation right censoring. This must be done within a for loop since we have count attached to each upper bound, but the function is vectorized should we use a single vector containing all of the right truncation limits.</p>
<p>The bootstrap <span class="math inline">\(p\)</span>-value for comparing models <span class="math inline">\(M_0 \subset M_1\)</span> would be obtained by repeating the following steps <span class="math inline">\(B\)</span> times and calculating the rank of the observed test statistic among alternatives:</p>
<ol type="1">
<li>Simulate new birth dates <span class="math inline">\(d_i\)</span> <span class="math inline">\((i=1, \ldots, n)\)</span> (e.g., drawing from a smoothed empirical distribution of birth dates); the latest possible birth date is one which ensures the person reached at least the threshold by the end of the period.</li>
<li>Subtract the endpoints of the sampling period, say <span class="math inline">\(c_1\)</span> and <span class="math inline">\(c_2\)</span> to get the minimum (maximum) age at death, <span class="math inline">\(c_1 - d_i\)</span> (respectively <span class="math inline">\(c_2 - d_i\)</span>) days, which define the truncation bounds.</li>
<li>Use the function <code>samp_elife</code> to simulate new observations from a parametric interval truncated distribution from the null model <span class="math inline">\(M_0\)</span></li>
<li>Use the optimization procedure in <code>fit_elife</code> to fit the model with both <span class="math inline">\(M_1\)</span> and <span class="math inline">\(M_2\)</span> and calculate the deviance, and from them the likelihood ratio statistic.</li>
</ol>
<p>The algorithm is implemented below for comparing the Gompertz and the exponential model. Since the procedure is computationally intensive, users must trade off between the precision of the bootstrap <span class="math inline">\(p\)</span>-value estimate and the number of replications, <span class="math inline">\(B\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2022</span><span class='op'>)</span></span>
<span><span class='co'># Count of unique right truncation limit</span></span>
<span><span class='va'>db_rtrunc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>~</span> <span class='va'>rtrunc</span>, </span>
<span>        FUN <span class='op'>=</span> <span class='st'>"sum"</span>, </span>
<span>        data <span class='op'>=</span> <span class='va'>japanese2</span>,</span>
<span>        subset <span class='op'>=</span> <span class='va'>age</span> <span class='op'>&gt;=</span> <span class='va'>thresh</span><span class='op'>)</span></span>
<span><span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fl'>1000L</span> <span class='co'># Number of bootstrap replications</span></span>
<span><span class='va'>boot_anova</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='va'>B</span><span class='op'>)</span></span>
<span><span class='va'>boot_gof</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='va'>B</span><span class='op'>)</span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>b</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>B</span> <span class='op'>-</span> <span class='fl'>1L</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span> <span class='va'>boot_samp</span> <span class='op'>&lt;-</span>  <span class='co'># Generate bootstrap sample</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>, <span class='co'>#merge data frames</span></span>
<span>   <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>db_rtrunc</span>, <span class='fl'>1</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span>  <span class='co'># for each rtrunc and count</span></span>
<span>   <span class='va'>count</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span> <span class='co'>#tabulate count</span></span>
<span>   <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span><span class='op'>(</span> <span class='co'>#round down</span></span>
<span>    <span class='fu'>samp_elife</span><span class='op'>(</span> <span class='co'># sample right truncated exponential</span></span>
<span>     n <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span><span class='st'>"count"</span><span class='op'>]</span>,   </span>
<span>       scale <span class='op'>=</span> <span class='va'>model0</span><span class='op'>$</span><span class='va'>par</span>,</span>
<span>       family <span class='op'>=</span> <span class='st'>"exp"</span>, <span class='co'>#null model</span></span>
<span>       upper <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span><span class='st'>"rtrunc"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>thresh</span>,</span>
<span>       type2 <span class='op'>=</span> <span class='st'>"ltrt"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>   <span class='co'># return data frame</span></span>
<span>    count <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span>,</span>
<span>    rtrunc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"rtrunc"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>thresh</span>,</span>
<span>    eage <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span> <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span> <span class='va'>boot_mod0</span> <span class='op'>&lt;-</span> <span class='co'># Fit null model to bootstrap sample</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>boot_samp</span>,</span>
<span>     <span class='fu'>fit_elife</span><span class='op'>(</span>time <span class='op'>=</span> <span class='va'>eage</span>, </span>
<span>      time2 <span class='op'>=</span> <span class='va'>eage</span> <span class='op'>+</span> <span class='fl'>1L</span>,</span>
<span>      rtrunc <span class='op'>=</span> <span class='va'>rtrunc</span>,</span>
<span>      type <span class='op'>=</span> <span class='st'>"interval"</span>,</span>
<span>      event <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"exp"</span>,</span>
<span>      weights <span class='op'>=</span> <span class='va'>count</span><span class='op'>)</span><span class='op'>)</span></span>
<span> <span class='va'>boot_mod1</span> <span class='op'>&lt;-</span>  <span class='co'># Fit alternative model to bootstrap sample</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>boot_samp</span>,</span>
<span>     <span class='fu'>fit_elife</span><span class='op'>(</span>time <span class='op'>=</span> <span class='va'>eage</span>, </span>
<span>      time2 <span class='op'>=</span> <span class='va'>eage</span> <span class='op'>+</span> <span class='fl'>1L</span>,</span>
<span>      rtrunc <span class='op'>=</span> <span class='va'>rtrunc</span>,</span>
<span>      type <span class='op'>=</span> <span class='st'>"interval"</span>,</span>
<span>      event <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"gomp"</span>,</span>
<span>      weights <span class='op'>=</span> <span class='va'>count</span><span class='op'>)</span><span class='op'>)</span></span>
<span> <span class='va'>boot_anova</span><span class='op'>[</span><span class='va'>b</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>boot_mod0</span><span class='op'>)</span> <span class='op'>-</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>boot_mod1</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='co'># Add original statistic</span></span>
<span><span class='va'>boot_anova</span><span class='op'>[</span><span class='va'>B</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>model1</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>model0</span><span class='op'>)</span></span>
<span><span class='co'># Bootstrap p-value</span></span>
<span><span class='op'>(</span><span class='va'>pval</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rank.html'>rank</a></span><span class='op'>(</span><span class='va'>boot_anova</span><span class='op'>)</span><span class='op'>[</span><span class='va'>B</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>B</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; [1] 0.001</code></pre>
</div>
<p>The asymptotic approximation is of similar magnitude as the bootstrap <span class="math inline">\(p\)</span>-value. Both suggest that the more complex Gompertz model provides a significantly better fit.</p>
<h3 data-number="2.4" id="extreme-value-analysis"><span class="header-section-number">2.4</span> Extreme value analysis</h3>
<p>Extreme value theory suggests that, in many instances, the limiting conditional distribution of exceedances of a random variable <span class="math inline">\(Y\)</span> with distribution function <span class="math inline">\(F\)</span> is generalized Pareto, meaning
<span class="math display" id="eq:gpd">\[\begin{align}
\lim_{u \to x^*}\Pr(Y-u &gt; y \mid Y &gt; u)= \begin{cases}
\left(1+\xi y/\sigma\right)_{+}^{-1/\xi}, &amp; \xi \neq 0;\\
\exp(-y/\sigma), &amp; \xi = 0;
\end{cases}
\tag{1}
\end{align}\]</span>
with <span class="math inline">\(x_{+} = \max\{x, 0\}\)</span> and <span class="math inline">\(x^*=\sup\{x: F(x) &lt; 1\}\)</span>. This justifies the use of Equation <a href="#eq:gpd">(1)</a> for the survival function of threshold exceedances when dealing with rare events. The model has two parameters: a scale <span class="math inline">\(\sigma\)</span> and a shape <span class="math inline">\(\xi\)</span> which determines the behavior of the upper tail. Negative shape parameters correspond to bounded upper tails and a finite right endpoint for the support.</p>
<p>Study of population dynamics and mortality generally requires knowledge of the total population from which observations are drawn to derive rates. By contrast, the peaks over threshold method, by which one models the <span class="math inline">\(k\)</span> largest observations of a sample, is a conditional analysis (e.g., given survival until a certain age), and is therefore free of denominator specification since we only model exceedances above a high threshold <span class="math inline">\(u\)</span>. For modelling purposes, we need to pick a threshold <span class="math inline">\(u\)</span> that is smaller than the upper endpoint <span class="math inline">\(x^*\)</span> in order to have sufficient number of observations to estimate parameters. The threshold selection problem is a classical instance of bias-variance trade-off: the parameter estimators are possibly biased if the threshold is too low because the generalized Pareto approximation is not good enough, whereas choosing a larger threshold to ensure we are closer to the asymptotic regime leads to reduced sample size and increased parameter uncertainty.</p>
<p>To aid threshold selection, users commonly resort to parameter stability plots. These are common visual diagnostics consisting of a plot of estimates of the shape parameter <span class="math inline">\(\widehat{\xi}\)</span> (with confidence or credible intervals) based on sample exceedances over a range of thresholds <span class="math inline">\(u_1, \ldots, u_K\)</span>. If the data were drawn from a generalized Pareto distribution, the conditional distribution above higher threshold <span class="math inline">\(v &gt; u\)</span> is also generalized Pareto with the same shape: this threshold stability property is the basis for extrapolation beyond the range of observed records. Indeed, if the change in estimation of <span class="math inline">\(\xi\)</span> is nearly constant, this provides reassurance that the approximation can be used for extrapolation. The only difference with survival data, relative to the classical setting, is that the likelihood must account for censoring and truncation. Note that, when we use threshold exceedances with a nonzero threshold (argument <code>thresh</code>), it however isn’t possible to unambiguously determine whether left censored observations are still exceedances: such cases yield errors in the functions.</p>
<p>Theory on penultimate extremes suggests that, for finite levels and general distribution function <span class="math inline">\(F\)</span> for which <a href="#eq:gpd">(1)</a> holds, the shape parameter varies as a function of the threshold <span class="math inline">\(u\)</span>, behaving like the derivative of the reciprocal hazard <span class="math inline">\(r(x) = \{1-F(x)\}/f(x)\)</span>. We can thus model the shape as piece-wise constant by fitting a piece-wise generalized Pareto model due to <span class="citation" data-cites="Northrop.Coleman:2014">Northrop and Coleman (<a href="#ref-Northrop.Coleman:2014" role="doc-biblioref">2014</a>)</span> and adapted in <span class="citation" data-cites="ARSIA:2022">Belzile et al. (<a href="#ref-ARSIA:2022" role="doc-biblioref">2022</a>)</span> for survival data. The latter can be viewed as a mixture of generalized Pareto over <span class="math inline">\(K\)</span> disjoint intervals with continuity constraints to ensure a smooth hazard, which reduces to the generalized Pareto if we force the <span class="math inline">\(K+1\)</span> shape parameters to be equal. We can use a likelihood ratio test to compare the model, or a score test if the latter is too computationally intensive, and plot the <span class="math inline">\(p\)</span>-values for each of the <span class="math inline">\(K\)</span> thresholds, corresponding to the null hypotheses <span class="math inline">\(\mathrm{H}_k: \xi_k = \cdots = \xi_{K}\)</span> (<span class="math inline">\(k=1, \ldots, K-1\)</span>). As the model quickly becomes overparametrized, optimization is difficult and the score test may be a safer option as it only requires estimation of the null model of a single generalized Pareto over the whole range.</p>
<p>To illustrate these diagnostic tools, Figure <a href="#fig:fig-parameterstab">2</a> shows a threshold stability plot, which features a small increase in the shape parameters as the threshold increases, corresponding to a stabilization or even a slight decrease of the hazard at higher ages. We can envision a threshold of 108 years as being reasonable: the Northrop–Coleman diagnostic plot suggests lower thresholds are compatible with a constant shape above 100. Additional goodness-of-fit diagnostics are necessary to determine if the generalized Pareto model fits well.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, mar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> </span>
<span><span class='co'># Threshold sequence</span></span>
<span><span class='va'>u</span> <span class='op'>&lt;-</span> <span class='fl'>100</span><span class='op'>:</span><span class='fl'>110</span></span>
<span><span class='co'># Threshold stability plot</span></span>
<span><span class='fu'>tstab</span><span class='op'>(</span>arguments <span class='op'>=</span> <span class='va'>args_japan</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"gp"</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"profile"</span>,</span>
<span>      which.plot <span class='op'>=</span> <span class='st'>"shape"</span>,</span>
<span>      thresh <span class='op'>=</span> <span class='va'>u</span><span class='op'>)</span></span>
<span><span class='co'># Northrop-Coleman diagnostic based on score tests</span></span>
<span><span class='va'>nu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>u</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1L</span></span>
<span><span class='va'>nc_score</span> <span class='op'>&lt;-</span> <span class='fu'>nc_test</span><span class='op'>(</span>arguments <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>args_japan</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>thresh <span class='op'>=</span> <span class='va'>u</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>score_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>nc_score</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>graphics.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-parameterstab"></span>
<img src="RJ-2025-034_files/figure-html5/fig-parameterstab-1.png" alt="Threshold stability plots. The left panel shows shape parameter estimates with 95\% confidence intervals as a function of the threshold value from 100 until 111 years. The right panel shows p-values from a score test for nested models as a function of the same thresholds." width="100%" />
<p class="caption">
Figure 2: Threshold diagnostic tools: parameter stability plots for the generalized Pareto model (left) and Northrop–Coleman <span class="math inline">\(p\)</span>-value path (right) for the Japanese centenarian dataset. Both suggest that a threshold as low as 100 may be suitable for peaks-over-threshold analysis.
</p>
</div>
</div>
<p>Each plot in the package can be produced using base R or using <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span>, which implements the grammar of graphics. To keep the list of package dependencies lean and adhere to the <a href="https://cran.r-project.org/web/packages/pacs/vignettes/tinyverse.html"><code>tinyverse</code> principle</a>, the latter can be obtained by using the argument <code>plot.type</code> with the generic S3 method <code>plot</code>, or via <code>autoplot</code>, provided the <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> package is already installed.</p>
<h3 data-number="2.5" id="graphical-goodness-of-fit-diagnostics"><span class="header-section-number">2.5</span> Graphical goodness of fit diagnostics</h3>
<p>Determining whether a parametric model fits well to survival data is no easy task due to the difficulty in specifying the null distribution of many goodness of fit statistics, such as the Cramér–von Mises statistic, which differ for survival data. As such, the <a href="https://cran.r-project.org/package=longevity">longevity</a> package relies mostly on visual diagnostic tools. <span class="citation" data-cites="Waller.Turnbull:1992">Waller and Turnbull (<a href="#ref-Waller.Turnbull:1992" role="doc-biblioref">1992</a>)</span> discusses how classical visual graphics can be adapted in the presence of censoring. Most notably, only observed failure times are displayed on the <span class="math inline">\(y\)</span>-axis against their empirical plotting position on the <span class="math inline">\(x\)</span>-axis. Contrary to the independent and identically distributed case, the uniform plotting positions <span class="math inline">\(F_n(y_i)\)</span> are based on the nonparametric maximum likelihood estimator discussed in Section 3.</p>
<p>The situation is more complicated with truncated data <span class="citation" data-cites="ARSIA:2022">(<a href="#ref-ARSIA:2022" role="doc-biblioref">Belzile et al. 2022</a>)</span>, since the data are not identically distributed: indeed, the distribution function of observation <span class="math inline">\(Y_i\)</span> truncated on the interval <span class="math inline">\([a_i, b_i]\)</span> is <span class="math inline">\(F_i(y_i) = \{F(y_i)-F(a_i)\}/\{F(b_i) - F(a_i)\}\)</span>, so the data arise from different distributions even if these share common parameters. One way out of this conundrum is using the probability integral transform and the quantile transform to map observations to the uniform scale and back onto the data scale. Taking <span class="math inline">\(\widetilde{F}(y_i) = F_n(y_i)=\mathrm{rank}(y_i)/(n+1)\)</span> to denote the empirical distribution function estimator, a probability-probability plot would show <span class="math inline">\(x_i = \widetilde{F}_{i}(y_i)\)</span> against <span class="math inline">\(y_i = F_i(y_i)\)</span>, leading to approximately uniform samples if the parametric distribution <span class="math inline">\(F\)</span> is suitable. Another option is to standardize the observation, taking the collection <span class="math inline">\(\widetilde{y}_i=F^{-1}\{F_i(y_i)\}\)</span> of rescaled exceedances and comparing them to the usual plotting positions <span class="math inline">\(x_{(i)} =\{i/(n+1)\}\)</span>. The drawback of the latter approach is that the quantities displayed on the <span class="math inline">\(y\)</span>-axis are not raw observations and the ranking of the empirical quantiles may change, a somewhat counter-intuitive feature. However, this means that the sample <span class="math inline">\(\{F_i(y_i)\}\)</span> should be uniform under the null hypothesis, and this allows one to use methods from <span class="citation" data-cites="Sailynoja.Burkner.Vehtari:2021">Säilynoja et al. (<a href="#ref-Sailynoja.Burkner.Vehtari:2021" role="doc-biblioref">2022</a>)</span> to obtain point-wise and simultaneous confidence intervals.</p>
<p><a href="https://cran.r-project.org/package=longevity">longevity</a> offers users the choice between three types of quantile-quantile plots: regular (Q-Q, <code>"qq"</code>), Tukey’s mean detrended Q-Q plots (<code>"tmd"</code>) and exponential Q-Q plots (<code>"exp"</code>). Other options on uniform scale are probability-probability (P-P, <code>"pp"</code>) plots and empirically rescaled plots (ERP, <code>"erp"</code>) <span class="citation" data-cites="Waller.Turnbull:1992">(<a href="#ref-Waller.Turnbull:1992" role="doc-biblioref">Waller and Turnbull 1992</a>)</span>, designed to ease interpretation with censored observations by rescaling axes. We illustrate the graphical tools with the <code>dutch</code> data above age 105 in Figure <a href="#fig:fig-qqplots">3</a>. The fit is correct above 110, but there is a notable dip due to excess mortality around 109.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit_dutch</span> <span class='op'>&lt;-</span> <span class='fu'>fit_elife</span><span class='op'>(</span></span>
<span>  arguments <span class='op'>=</span> <span class='va'>dutch_data</span>,</span>
<span>  event <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>  type <span class='op'>=</span> <span class='st'>"interval2"</span>,</span>
<span>  family <span class='op'>=</span> <span class='st'>"gp"</span>,</span>
<span>  thresh <span class='op'>=</span> <span class='fl'>105</span>,</span>
<span>  export <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit_dutch</span>, </span>
<span>   which.plot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pp"</span>,<span class='st'>"qq"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-qqplots"></span>
<img src="RJ-2025-034_files/figure-html5/fig-qqplots-1.png" alt="Probability-probability and quantile-quantile plots for generalized Pareto model fitted above age 105 years to Dutch data. The plots indicate broadly good agreement with the observation, except for some individuals who died age 109 for which too many have deaths close to their birthdates." width="100%" />
<p class="caption">
Figure 3: Probability-probability and quantile-quantile plots for generalized Pareto model fitted above age 105 years to Dutch data. The plots indicate broadly good agreement with the observation, except for some individuals who died age 109 for which too many have deaths close to their birthdates.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Censored observations are used to compute the plotting positions, but are not displayed. As such, we cannot use graphical goodness of fit diagnostics for the Japanese interval censored data. An alternative, given that data are tabulated in a contingency table, is to use a chi-squared test for independence, conditioning on the number of individuals per birth cohort. The expected number in each cell (birth cohort and age band) can be obtained by computing the conditional probability of falling in that age band. The asymptotic null distribution should be <span class="math inline">\(\chi^2\)</span> with <span class="math inline">\((k-1)(p-1)\)</span> degrees of freedom, where <span class="math inline">\(k\)</span> is the number of age bands and <span class="math inline">\(p\)</span> the number of birth cohorts. In finite samples, the expected count for large excess lifetimes are very low so one can expect the <span class="math inline">\(\chi^2\)</span> approximation to be poor. To mitigate this, we can pool observations and resort to simulation to approximate the null distribution of the test statistic. The bootstrap <span class="math inline">\(p\)</span>-value for the exponential model above 108 years, pooling observations with excess lifetime of 5 years and above, is 0.872, indicating no evidence that the model is inadequate, but the test here may have low power.</p>
<h3 data-number="2.6" id="stratification"><span class="header-section-number">2.6</span> Stratification</h3>
<p>Demographers may suspect differences between individuals of different sex, from different countries or geographic areas, or by birth cohort. All of these are instances of categorical covariates. One possibility is to incorporate these covariates with suitable link function through parameters, but we consider instead stratification. We can split the data by levels of <code>covariate</code> (with factors) into sub-data and compare the goodness of fit of the <span class="math inline">\(K\)</span> models relative to that which pools all observations. The <code>test_elife</code> function performs likelihood ratio tests for the comparisons. The test statistic is <span class="math inline">\(-2\{\ell(\widehat{\boldsymbol{\theta}}_0) - \ell(\widehat{\boldsymbol{\theta}})\}\)</span>, where <span class="math inline">\(\widehat{\boldsymbol{\theta}}_0\)</span> is the maximum likelihood estimator under the null model with common parameters, and <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> is the unrestricted maximum likelihood estimator for the alternative model with the same distribution, but which allows for stratum-specific parameters. We illustrate this with a generalized Pareto model for the excess lifetime. The null hypothesis is <span class="math inline">\(\mathrm{H}_0: \sigma_{\texttt{f}} = \sigma_{\texttt{m}}, \xi_{\texttt{f}}=\xi_{\texttt{m}}\)</span> against the alternative that at least one equality doesn’t hold and so the hazard and endpoints are different.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span></span>
<span>  <span class='fu'>test_elife</span><span class='op'>(</span></span>
<span>    arguments <span class='op'>=</span> <span class='va'>args_japan</span>,</span>
<span>    thresh <span class='op'>=</span> <span class='fl'>110</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"gp"</span>,</span>
<span>    covariate <span class='op'>=</span> <span class='va'>japanese2</span><span class='op'>$</span><span class='va'>gender</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; Model: generalized Pareto distribution. 
#&gt; Threshold: 110 
#&gt; Number of exceedances per covariate level:
#&gt; female   male 
#&gt;    642     61 
#&gt; 
#&gt; Likelihood ratio statistic: 0.364
#&gt; Null distribution: chi-square (2)
#&gt; Asymptotic p-value:  0.833</code></pre>
</div>
<p>In the present example, there is no evidence against any difference in lifetime distribution between male and female; this is unsurprising given the large imbalance between counts for each covariate level, with far fewer males than females.</p>
<h3 data-number="2.7" id="extrapolation"><span class="header-section-number">2.7</span> Extrapolation</h3>
<p>If the maximum likelihood estimator of the shape <span class="math inline">\(\xi\)</span> for the generalized Pareto model is negative, then the distribution has a finite upper endpoint; otherwise, the latter is infinite. With <span class="math inline">\(\xi &lt; 0\)</span>, we can look at the profile log likelihood for the endpoint <span class="math inline">\(\eta = -\sigma/\xi\)</span>, using the function <code>prof_gp_endpt</code>, to draw the curve and obtain confidence intervals. The argument <code>psi</code> is used to give a grid of values over which to compute the profile log likelihood. The bounds of the <span class="math inline">\((1-\alpha)\)</span> confidence intervals are obtained by fitting a cubic smoothing spline for <span class="math inline">\(y=\eta\)</span> as a function of the shifted profile curve <span class="math inline">\(x = 2\{\ell_p(\eta)-\ell_p(\widehat{\eta})\}\)</span> on both sides of the maximum likelihood estimator and predicting the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = -\chi^2_1(1-\alpha)\)</span>. This technique works well unless the profile is nearly flat or the bounds lie beyond the range of values of <code>psi</code> provided; the user may wish to change them if they are too far. If <span class="math inline">\(\widehat{\xi} \approx 0\)</span>, then the upper bound of the confidence interval may be infinite and the profile log likelihood may never reach the cutoff value of the asymptotic <span class="math inline">\(\chi^2_1\)</span> distribution.</p>
<p>The profile log likelihood curve for the endpoint, shifted vertically so that its value is zero at the maximum likelihood estimator, highlights the marked asymmetry of the distribution of <span class="math inline">\(\eta\)</span>, shown in <a href="#fig:fig-endpoint-confint">4</a>, with the horizontal dashed lines showing the limits for the 95% profile likelihood confidence intervals. These suggest that the endpoint, or a potential finite lifespan, could lie very much beyond observed records. The routine used to calculate the upper bound computes the cutoff value by fitting a smoothing spline with the role of the <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> axes reversed and by predicting the value of <span class="math inline">\(\eta\)</span> at <span class="math inline">\(y=0\)</span>. In this example, the upper confidence limit is extrapolated from the model: more accurate measures can be obtained by specifying a longer and finer sequence of values of <code>psi</code> such that the profile log likelihood drops below the <span class="math inline">\(\chi^2_1\)</span> quantile cutoff.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Create grid of threshold values</span></span>
<span><span class='va'>thresholds</span> <span class='op'>&lt;-</span> <span class='fl'>105</span><span class='op'>:</span><span class='fl'>110</span></span>
<span><span class='co'># Grid of values at which to evaluate profile</span></span>
<span><span class='va'>psi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>120</span>, <span class='fl'>200</span>, length.out <span class='op'>=</span> <span class='fl'>101</span><span class='op'>)</span></span>
<span><span class='co'># Calculate the profile for the endpoint</span></span>
<span><span class='co'># of the generalized Pareto at each threshold</span></span>
<span><span class='va'>endpt_tstab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>endpoint.tstab</span>,</span>
<span>  args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='va'>args_japan</span>, </span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>psi <span class='op'>=</span> <span class='va'>psi</span>, </span>
<span>         thresh <span class='op'>=</span> <span class='va'>thresholds</span>,</span>
<span>         plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># Compute corresponding confidence intervals</span></span>
<span><span class='va'>profile</span> <span class='op'>&lt;-</span> <span class='fu'>endpoint.profile</span><span class='op'>(</span></span>
<span>  arguments <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>args_japan</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>thresh <span class='op'>=</span> <span class='fl'>110</span>, psi <span class='op'>=</span> <span class='va'>psi</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># Plot point estimates and confidence intervals</span></span>
<span><span class='va'>g1</span> <span class='op'>&lt;-</span> <span class='fu'>autoplot</span><span class='op'>(</span><span class='va'>endpt_tstab</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span>, ylab <span class='op'>=</span> <span class='st'>"lifespan (in years)"</span><span class='op'>)</span></span>
<span><span class='co'># Plot the profile curve with cutoffs for conf. int. for 110</span></span>
<span><span class='va'>g2</span> <span class='op'>&lt;-</span> <span class='fu'>autoplot</span><span class='op'>(</span><span class='va'>profile</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='fu'>patchwork</span><span class='fu'>::</span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/wrap_plots.html'>wrap_plots</a></span><span class='op'>(</span><span class='va'>g1</span>, <span class='va'>g2</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-endpoint-confint"></span>
<img src="RJ-2025-034_files/figure-html5/fig-endpoint-confint-1.png" alt="Maximum likelihood estimates with 95\% confidence intervals as a function of threshold (left) and profile likelihood for exceedances above 110 years (right) for Japanese centenarian data. As the threshold increases, the number of exceedances decreases and the intervals for the upper bound become wider. At 110, the right endpoint of the interval would go until infinity." width="100%" />
<p class="caption">
Figure 4: Maximum likelihood estimates with 95% confidence intervals as a function of threshold (left) and profile likelihood for exceedances above 110 years (right) for Japanese centenarian data. As the threshold increases, the number of exceedances decreases and the intervals for the upper bound become wider. At 110, the right endpoint of the interval would go until infinity.
</p>
</div>
</div>
<p>Depending on the model, the conclusions about the risk of mortality change drastically: the Gompertz model implies an ever increasing hazard, but no finite endpoint for the distribution of exceedances. The exponential model implies a constant hazard and no endpoint. By contrast, the generalized Pareto can accommodate both finite and infinite endpoints. The marked asymmetry of the distribution of lifespan defined by the generalized Pareto shows that inference obtained using symmetric confidence intervals (i.e., Wald-based) is likely very misleading: the drop in fit from having a zero or positive shape parameter <span class="math inline">\(\xi\)</span> is seemingly smaller than the cutoffs for a 95% confidence interval, suggesting that while the best point estimate is around 128 years, the upper bound is so large (and extrapolated) that everything is possible. The model however also suggests a very high probability of dying in any given year, regardless of whether the hazard is constant, decreasing or increasing.</p>
<h3 data-number="2.8" id="hazard"><span class="header-section-number">2.8</span> Hazard</h3>
<p>The parameters of the models are seldom of interest in themselves: rather, we may be interested in a summary such as the hazard function. At present, <a href="https://cran.r-project.org/package=longevity">longevity</a> does not allow general linear modelling of model parameters or time-varying covariates, but other software implementations can tackle this task. For example, <a href="https://cran.r-project.org/package=casebase">casebase</a> <span class="citation" data-cites="casebase">(<a href="#ref-casebase" role="doc-biblioref">Bhatnagar et al. 2022</a>)</span> fits flexible hazard models using logistic or multinomial regression with potential inclusion of penalties for the parameters associated to covariates and splines effects. Another alternative is <a href="https://cran.r-project.org/package=flexsurv">flexsurv</a> <span class="citation" data-cites="flexsurv">(<a href="#ref-flexsurv" role="doc-biblioref">Jackson 2016</a>)</span>, which offers 10 parametric models and allows for user-specified models.
The <a href="https://cran.r-project.org/package=bshazard">bshazard</a> package <span class="citation" data-cites="bshazard">(<a href="#ref-bshazard" role="doc-biblioref">Rebora et al. 2014</a>)</span> provides nonparametric smoothing via <span class="math inline">\(B\)</span>-splines, whereas <a href="https://cran.r-project.org/package=muhaz">muhaz</a> handles kernel-based hazard for right censored data; both could be used for validation of the parametric models in the case of right censoring. The <a href="https://cran.r-project.org/package=rstpm2">rstpm2</a> package <span class="citation" data-cites="rstpm2">(<a href="#ref-rstpm2" role="doc-biblioref">Liu et al. 2018</a>)</span> handles generalized modelling for censoring with the Royston–Parmar model built from natural cubic splines <span class="citation" data-cites="Royston.Parmar:2002">(<a href="#ref-Royston.Parmar:2002" role="doc-biblioref">Royston and Parmar 2002</a>)</span>. Contrasting with all of the aforementioned approaches, we focus on parametric models: this is partly because there are few observations for the user case we consider and covariates, except perhaps for gender and birth year, are not available.</p>
<p>The hazard changes over time; the only notable exception is the exponential hazard, which is constant. <a href="https://cran.r-project.org/package=longevity">longevity</a> includes utilities for computing the hazard function from a fitted model object and computing point-wise confidence intervals using symmetric Wald intervals or the profile likelihood.
Specifically, the <code>hazard_elife</code> function calculates the hazard <span class="math inline">\(h(t; \boldsymbol{\theta})\)</span> point-wise at times <span class="math inline">\(t=\)</span><code>x</code>; Wald-based confidence intervals are obtained using the delta-method, whereas profile likelihood intervals are obtained by reparametrizing the model in terms of <span class="math inline">\(h(t)\)</span> for each time <span class="math inline">\(t\)</span>. More naturally perhaps, we can consider a Bayesian analysis of the Japanese excess lifetime above 108 years. Using the likelihood and encoded log posterior provided in <code>logpost_elife</code>, we obtained independent samples from the posterior of the generalized Pareto parameters <span class="math inline">\((\sigma, \xi)\)</span> with maximal data information prior using the <a href="https://cran.r-project.org/package=rust">rust</a> package. Each parameter combination was then fed into <code>helife</code> and the hazard evaluated over a range of values. Figure <a href="#fig:fig-hazard">5</a> shows the posterior samples and functional boxplots <span class="citation" data-cites="Sun.Genton:2011">(<a href="#ref-Sun.Genton:2011" role="doc-biblioref">Sun and Genton 2011</a>)</span> of the hazard curves, obtained using the <a href="https://cran.r-project.org/package=fda">fda</a> package. The risk of dying increases with age, but comes with substantial uncertainty, as evidenced by the increasing width of the boxes and interquartile range.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig-hazard"></span>
<img src="RJ-2025-034_files/figure-html5/fig-hazard-1.png" alt="Left: scatterplot of 1000 independent posterior samples from generalized Pareto model with maximum data information prior; the contour curves give the percentiles of credible intervals, and show approximate normality of the posterior. Right: functional boxplots for the corresponding hazard curves, with increasing width at higher ages." width="100%" />
<p class="caption">
Figure 5: Left: scatterplot of 1000 independent posterior samples from generalized Pareto model with maximum data information prior; the contour curves give the percentiles of credible intervals, and show approximate normality of the posterior. Right: functional boxplots for the corresponding hazard curves, with increasing width at higher ages.
</p>
</div>
</div>
<h3 data-number="2.9" id="sec-nonparametric"><span class="header-section-number">2.9</span> Nonparametric maximum likelihood estimation</h3>
<p>The nonparametric maximum likelihood estimator is unique only up to equivalence classes. The data for individual <span class="math inline">\(i\)</span> consists of the tuple <span class="math inline">\(\{L_i, R_i, V_i, U_i\}\)</span>, where the censoring interval is <span class="math inline">\([L_i, R_i]\)</span> and the truncation interval is <span class="math inline">\([V_i, U_i\}\)</span>, with <span class="math inline">\(0 \leq V_i \leq L_i \leq R_i \leq U_i \leq \infty\)</span>. <span class="citation" data-cites="Turnbull:1976">Turnbull (<a href="#ref-Turnbull:1976" role="doc-biblioref">1976</a>)</span> shows how one can build disjoint intervals <span class="math inline">\(C = \bigsqcup_{j=1}^m [a_j, b_j]\)</span> where <span class="math inline">\(a_j \in \mathcal{L} = \{L_1, \ldots, L_n\}\)</span> and <span class="math inline">\(b_j \in \mathcal{R} = \{R_1, \ldots, R_n\}\)</span> satisfy <span class="math inline">\(a_1 \leq b_1 &lt; \cdots &lt; a_m \leq b_m\)</span> and the intervals <span class="math inline">\([a_j, b_j]\)</span> contain no other members of <span class="math inline">\(L\)</span> or <span class="math inline">\(R\)</span> except at the endpoints. This last condition notably ensures that the intervals created include all observed failure times as singleton sets in the absence of truncation. Other authors <span class="citation" data-cites="Lindsey.Ryan:1998">(<a href="#ref-Lindsey.Ryan:1998" role="doc-biblioref">Lindsey and Ryan 1998</a>)</span> have taken interval censored data as semi-open intervals <span class="math inline">\((L_i, R_i]\)</span>, a convention we adopt here for numerical reasons. For interval censored and truncated data, <span class="citation" data-cites="Frydman:1994">Frydman (<a href="#ref-Frydman:1994" role="doc-biblioref">1994</a>)</span> shows that this construction must be amended by taking instead <span class="math inline">\(a_j \in \mathcal{L} \cup \{U_1, \ldots, U_n\}\)</span> and <span class="math inline">\(b_j \in \mathcal{R} \cup \{V_1, \ldots, V_n\}\)</span>.</p>
<p>We assign probability <span class="math inline">\(p_j = F(b_j^{+}) - F(a_j^{-}) \ge 0\)</span> to each of the resulting <span class="math inline">\(m\)</span> intervals under the constraint <span class="math inline">\(\sum_{j=1}^m p_j = 1\)</span> and <span class="math inline">\(p_j \ge 0\)</span> <span class="math inline">\((j=1, \ldots, m)\)</span>. The nonparametric maximum likelihood estimator of the distribution function <span class="math inline">\(F\)</span> is then
<span class="math display">\[\begin{align*}
\widehat{F}(t) = \begin{cases} 0, &amp; t &lt; a_1;\\
\widehat{p}_1 + \cdots + \widehat{p}_j, &amp; b_j &lt; t &lt; a_{j+1} \quad (1 \leq j \leq m-1);\\
1, &amp; t &gt; b_m;
\end{cases}
\end{align*}\]</span>
and is undefined for <span class="math inline">\(t \in [a_j, b_j]\)</span> <span class="math inline">\((j=1, \ldots, m)\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-turnbull"></span>
<img src="RJ-2025-034_files/figure-html5/fig-turnbull-1.png" alt="Illustration of the truncation (pale grey) and censoring intervals (dark grey) equivalence classes based on Turnbull's algorithm. Observations must fall within equivalence classes defined by the former." width="100%" />
<p class="caption">
Figure 6: Illustration of the truncation (pale grey) and censoring intervals (dark grey) equivalence classes based on Turnbull’s algorithm. Observations must fall within equivalence classes defined by the former.
</p>
</div>
</div>
<p>The procedure of Turnbull can be encoded using <span class="math inline">\(m \times n\)</span> matrices. For censoring, we build <span class="math inline">\(\mathbf{A}\)</span> whose <span class="math inline">\((i,j)\)</span>th entry <span class="math inline">\(\alpha_{ij}=1\)</span> if <span class="math inline">\([a_j, b_j] \subseteq A_i\)</span> and zero otherwise. Since the intervals forming the set <span class="math inline">\(C\)</span> are disjoint and in increasing order, a more storage efficient manner of keeping track of the intervals is to find the smallest integer <span class="math inline">\(j\)</span> such that <span class="math inline">\(L_i \leq a_j\)</span> and the largest <span class="math inline">\(R_i \ge b_j\)</span> <span class="math inline">\((j=1, \ldots, m)\)</span> for each observation. The same idea applies for the truncation sets <span class="math inline">\(B_i = (V_i, U_i)\)</span> and matrix <span class="math inline">\(\mathbf{B}\)</span> with <span class="math inline">\((i,j)\)</span> element <span class="math inline">\(\beta_{ij}\)</span>.</p>
<p>The log likelihood function is
<span class="math display">\[\begin{align*}
\ell(\boldsymbol{p}) = \sum_{i=1}^n w_i \log \left( \sum_{j=1}^m \alpha_{ij}p_j\right) - w_i\log \left( \sum_{j=1}^m \beta_{ij}p_j\right)
\end{align*}\]</span></p>
<p>The numerical implementation of the EM is in principle forward: first identify the equivalence classes <span class="math inline">\(C\)</span>, next calculate the entries of <span class="math inline">\(A_i\)</span> and <span class="math inline">\(B_i\)</span> (or the vectors of ranges) and finally run the EM algorithm. In the second step, we need to account for potential ties in the presence of (interval) censoring and treat the intervals as open on the left for censored data. For concreteness, consider the toy example <span class="math inline">\(\boldsymbol{T} =(1,1,2)\)</span> and <span class="math inline">\(\boldsymbol{\delta} = (0,1,1)\)</span>, where <span class="math inline">\(\delta_i = 1\)</span> if the observation is a failure time and <span class="math inline">\(\delta_i=0\)</span> in case of right censoring.
The left and right censoring bounds are <span class="math inline">\(\mathcal{L} = \{1, 2\}\)</span> and <span class="math inline">\(\mathcal{R} = \{1, 2, \infty\}\)</span> with <span class="math inline">\(A_1 = (1, \infty)\)</span>, <span class="math inline">\(A_2 = \{1\}\)</span> and <span class="math inline">\(A_3 = \{2\}\)</span> and <span class="math inline">\(C_1=\{1\}, C_2=\{2\}\)</span>. If we were to treat instead <span class="math inline">\(A_1\)</span> as a semi-closed interval <span class="math inline">\([1, \infty)\)</span>, direct maximization of the log likelihood in eq. 2.2 of <span class="citation" data-cites="Turnbull:1976">Turnbull (<a href="#ref-Turnbull:1976" role="doc-biblioref">1976</a>)</span> would give probability half to each observed failure time. By contrast, the Kaplan–Meier estimator, under the convention that right censored observations at time <span class="math inline">\(t\)</span> were at risk up to and until <span class="math inline">\(t\)</span>, assigns probability 1/3 to the first failure. To retrieve this solution with Turnbull’s EM estimator, we need the convention that <span class="math inline">\(C_1 \notin A_1\)</span>, but this requires comparing the bound with itself. The numerical tolerance in the implementation is taken to be the square root of the machine epsilon for doubles.</p>
<p>The maximum likelihood estimator (MLE) need not be unique, and the EM algorithm is only guaranteed a local maximum. For interval censored data, <span class="citation" data-cites="Gentleman.Geyer:1994">Gentleman and Geyer (<a href="#ref-Gentleman.Geyer:1994" role="doc-biblioref">1994</a>)</span> consider using the Karush–Kuhn–Tucker conditions to determine whether the probability in some intervals is exactly zero and whether the returned value is indeed the MLE.</p>
<p>Due to data scarcity, statistical inference for human lifespan is best conducted using parametric models supported by asymptotic theory, reserving nonparametric estimators to assess goodness of fit. The empirical cumulative hazard for Japanese is very close to linear from early ages, suggesting that the hazard may not be very far from exponential even if more complex models are likely to be favored given the large sample size.</p>
<p>The function <code>np_elife</code> returns a list with Turnbull’s intervals <span class="math inline">\([a_j, b_j]\)</span> and the probability weights assigned to each, provided the latter are positive. It also contains an object of class <code>stepfun</code> with a weighting argument that defines a cumulative distribution function.
<!-- Users have the option to specify the value in the interval as left or right continuous. --></p>
<p>We can use the nonparametric maximum likelihood estimator of the distribution function to assess a fitted parametric model by comparing the density with a binned distribution, or the cumulative distribution function. The distribution function is defined over equivalence classes, which may be isolated observations or intervals. The data interval over which there is non-zero probability of events is broken down into equispaced bins and the probability of failing in the latter estimated nonparametrically based on the distribution function. Alternatively, users can also provide a set of <code>breaks</code>, or the number of bins.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ecdf</span> <span class='op'>&lt;-</span> <span class='fu'>np_elife</span><span class='op'>(</span>arguments <span class='op'>=</span> <span class='va'>args_japan</span>, thresh <span class='op'>=</span> <span class='fl'>108</span><span class='op'>)</span></span>
<span><span class='co'># Summary statistics, accounting for censoring</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ecdf</span><span class='op'>)</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  109.00  110.00  111.00  110.01  111.00  118.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Plots of fitted parametric model and nonparametric CDF</span></span>
<span><span class='va'>model_gp</span> <span class='op'>&lt;-</span> <span class='fu'>fit_elife</span><span class='op'>(</span></span>
<span>  arguments <span class='op'>=</span> <span class='va'>args_japan</span>, </span>
<span>  thresh <span class='op'>=</span> <span class='fl'>108</span>, </span>
<span>  family <span class='op'>=</span> <span class='st'>"gp"</span>,</span>
<span>  export <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='co'># ggplot2 plots, wrapped to display side by side</span></span>
<span><span class='fu'>patchwork</span><span class='fu'>::</span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/wrap_plots.html'>wrap_plots</a></span><span class='op'>(</span></span>
<span>  <span class='fu'>autoplot</span><span class='op'>(</span></span>
<span>    <span class='va'>model_gp</span>, <span class='co'># fitted model</span></span>
<span>    plot <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># return list of ggplots</span></span>
<span>    which.plot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"dens"</span>, <span class='st'>"cdf"</span><span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0L</span>, <span class='fl'>8L</span>, by <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>)</span> <span class='co'># set bins for histogram</span></span>
<span>  <span class='op'>)</span> </span>
<span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-ecdf"></span>
<img src="RJ-2025-034_files/figure-html5/fig-ecdf-1.png" alt="Nonparametric maximum likelihood estimate of the density (bar plot, left) and distribution function (staircase function, right), with superimposed generalized Pareto fit for excess lifetimes above 108 years. Except for the discreteness inherent to the nonparametric estimates, the two representations broadly agree at year marks." width="100%" />
<p class="caption">
Figure 7: Nonparametric maximum likelihood estimate of the density (bar plot, left) and distribution function (staircase function, right), with superimposed generalized Pareto fit for excess lifetimes above 108 years. Except for the discreteness inherent to the nonparametric estimates, the two representations broadly agree at year marks.
</p>
</div>
</div>
<h2 data-number="3" id="conclusion"><span class="header-section-number">3</span> Conclusion</h2>
<p>This paper describes the salient features of <a href="https://cran.r-project.org/package=longevity">longevity</a>, explaining the theoretical underpinning of the methods and the design considerations followed when writing the package. While <a href="https://cran.r-project.org/package=longevity">longevity</a> was conceived for modelling lifetimes, the package could be used for applications outside of demography. Survival data in extreme value theory is infrequent yet hardly absent. For example, rainfall observations can be viewed as rounded due to the limited instrumental precision of rain gauges and treated as interval-censored. Some historical records, which are often lower bounds on the real magnitude of natural catastrophes, can be added as right-censored observations in a peaks-over-threshold analysis. In insurance, losses incurred by the company due to liability claims may be right-censored if they exceed the policy cap and are covered by a reinsurance company, or rounded <span class="citation" data-cites="Belzile.Neslehova:2025">(<a href="#ref-Belzile.Neslehova:2025" role="doc-biblioref">Belzile and Nešlehová 2025</a>)</span>. In climate science, attribution studies often focus on data just after a record-breaking event, and the stopping rule leads to truncation <span class="citation" data-cites="Miralles.Davison:2023">(<a href="#ref-Miralles.Davison:2023" role="doc-biblioref">Miralles and Davison 2023</a>)</span>, which biases results if ignored.</p>
<p>The package has features that are interesting in their own right, including adapted quantile-quantile and other visual goodness of fit diagnostics for model validation. The testing procedures correctly handle tests for restrictions lying on the boundary of the parameter space. Parametric bootstrap procedures for such tests are not straightforward to implement given the heavy reliance on the data generating mechanism and the diversity of possible scenarios: this paper however shows how the utilities of the package can be coupled to ease such estimation and the code in the supplementary material illustrates how this can be extended for goodness of fit testing.</p>
<h2 class="unnumbered" id="acknowledgements">Acknowledgements</h2>
<p>The author thanks four anonymous reviewers for valuable feedback. This research was supported financially by the Natural Sciences and Engineering Research Council of Canada (NSERC) via Discovery Grant RGPIN-2022-05001.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="3.1" id="supplementary-materials"><span class="header-section-number">3.1</span> Supplementary materials</h3>
<p>Supplementary materials are available in addition to this article. It can be downloaded at
<a href="RJ-2025-034.zip">RJ-2025-034.zip</a></p>
<h3 class="appendix" data-number="3.2" id="cran-packages-used"><span class="header-section-number">3.2</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=longevity">longevity</a>, <a href="https://cran.r-project.org/package=evd">evd</a>, <a href="https://cran.r-project.org/package=mev">mev</a>, <a href="https://cran.r-project.org/package=extRemes">extRemes</a>, <a href="https://cran.r-project.org/package=evgam">evgam</a>, <a href="https://cran.r-project.org/package=survival">survival</a>, <a href="https://cran.r-project.org/package=MortCast">MortCast</a>, <a href="https://cran.r-project.org/package=demography">demography</a>, <a href="https://cran.r-project.org/package=MortalityLaws">MortalityLaws</a>, <a href="https://cran.r-project.org/package=vitality">vitality</a>, <a href="https://cran.r-project.org/package=fitdistrplus">fitdistrplus</a>, <a href="https://cran.r-project.org/package=VGAM">VGAM</a>, <a href="https://cran.r-project.org/package=prodlim">prodlim</a>, <a href="https://cran.r-project.org/package=icenReg">icenReg</a>, <a href="https://cran.r-project.org/package=dblcens">dblcens</a>, <a href="https://cran.r-project.org/package=interval">interval</a>, <a href="https://cran.r-project.org/package=tranSurv">tranSurv</a>, <a href="https://cran.r-project.org/package=DTDA">DTDA</a>, <a href="https://cran.r-project.org/package=Rsolnp">Rsolnp</a>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=casebase">casebase</a>, <a href="https://cran.r-project.org/package=flexsurv">flexsurv</a>, <a href="https://cran.r-project.org/package=bshazard">bshazard</a>, <a href="https://cran.r-project.org/package=muhaz">muhaz</a>, <a href="https://cran.r-project.org/package=rstpm2">rstpm2</a>, <a href="https://cran.r-project.org/package=rust">rust</a>, <a href="https://cran.r-project.org/package=fda">fda</a></p>
<h3 class="appendix" data-number="3.3" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">3.3</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=ActuarialScience">ActuarialScience</a>, <a href="https://cran.r-project.org/view=ChemPhys">ChemPhys</a>, <a href="https://cran.r-project.org/view=ClinicalTrials">ClinicalTrials</a>, <a href="https://cran.r-project.org/view=Distributions">Distributions</a>, <a href="https://cran.r-project.org/view=Econometrics">Econometrics</a>, <a href="https://cran.r-project.org/view=Environmetrics">Environmetrics</a>, <a href="https://cran.r-project.org/view=ExtremeValue">ExtremeValue</a>, <a href="https://cran.r-project.org/view=FunctionalData">FunctionalData</a>, <a href="https://cran.r-project.org/view=MissingData">MissingData</a>, <a href="https://cran.r-project.org/view=NetworkAnalysis">NetworkAnalysis</a>, <a href="https://cran.r-project.org/view=Optimization">Optimization</a>, <a href="https://cran.r-project.org/view=Phylogenetics">Phylogenetics</a>, <a href="https://cran.r-project.org/view=Psychometrics">Psychometrics</a>, <a href="https://cran.r-project.org/view=Spatial">Spatial</a>, <a href="https://cran.r-project.org/view=Survival">Survival</a>, <a href="https://cran.r-project.org/view=TeachingStatistics">TeachingStatistics</a></p>
<h3 class="appendix" data-number="3.4" id="bioconductor-packages-used"><span class="header-section-number">3.4</span> Bioconductor packages used</h3>
<p><a href="https://www.bioconductor.org/packages/Icens">Icens</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Anderson:2000" class="csl-entry" role="listitem">
J. J. Anderson. A vitality-based model relating stressors and environmental properties to organism survival. <em>Ecological Monographs</em>, 70(3): 445–470, 2000. URL <a href="https://doi.org/10.1890/0012-9615(2000)070[0445:AVBMRS]2.0.CO;2">https://doi.org/10.1890/0012-9615(2000)070[0445:AVBMRS]2.0.CO;2</a>.
</div>
<div id="ref-Anderson-Bergman:2017" class="csl-entry" role="listitem">
C. Anderson-Bergman. An efficient implementation of the <span>EMICM</span> algorithm for the interval censored <span>NPMLE</span>. <em>Journal of Computational and Graphical Statistics</em>, 26(2): 463–467, 2017a. URL <a href="https://doi.org/10.1080/10618600.2016.1208616">https://doi.org/10.1080/10618600.2016.1208616</a>.
</div>
<div id="ref-icensReg" class="csl-entry" role="listitem">
C. Anderson-Bergman. <span class="nocase">icenReg</span>: Regression models for interval censored data in <span>R</span>. <em>Journal of Statistical Software</em>, 81(12): 1–23, 2017b. URL <a href="https://doi.org/10.18637/jss.v081.i12">https://doi.org/10.18637/jss.v081.i12</a>.
</div>
<div id="ref-Barbi:2018" class="csl-entry" role="listitem">
E. Barbi, F. Lagona, M. Marsili, J. W. Vaupel and K. W. Wachter. The plateau of human mortality: Demography of longevity pioneers. <em>Science</em>, 360(6396): 1459–1461, 2018. URL <a href="https://doi.org/10.1126/science.aat3119">https://doi.org/10.1126/science.aat3119</a>.
</div>
<div id="ref-Beard:1963" class="csl-entry" role="listitem">
R. E. Beard. A theory of mortality based on actuarial, biological and medical considerations. In <em>Proceedings of the international population conference, new york</em>, 1963. London: International Union for the Scientific Study of Population.
</div>
<div id="ref-mev-package" class="csl-entry" role="listitem">
L. R. Belzile et al. <em><span class="nocase">mev</span>: Modelling extreme values.</em> 2023a. URL <a href="https://CRAN.R-project.org/package=mev">https://CRAN.R-project.org/package=mev</a>. R package version 1.15.
</div>
<div id="ref-ARSIA:2022" class="csl-entry" role="listitem">
L. R. Belzile, A. C. Davison, J. Gampe, H. Rootzén and D. Zholud. Is there a cap on longevity? <span>A</span> statistical review. <em>Annual Review of Statistics and its Application</em>, 9: 22–45, 2022. URL <a href="https://doi.org/10.1146/annurev-statistics-040120-025426">https://doi.org/10.1146/annurev-statistics-040120-025426</a>.
</div>
<div id="ref-Belzile.Dutang.Northrop.Opitz:2022" class="csl-entry" role="listitem">
L. R. Belzile, C. Dutang, P. J. Northrop and T. Opitz. A modeler’s guide to extreme value software. <em>Extremes</em>, 26: 595–638, 2023b. URL <a href="https://doi.org/10.1007/s10687-023-00475-9">https://doi.org/10.1007/s10687-023-00475-9</a>.
</div>
<div id="ref-Belzile.Neslehova:2025" class="csl-entry" role="listitem">
L. R. Belzile and J. G. Nešlehová. Statistics of extremes for incomplete data, with application to lifetime and liability claim modeling. In <em>Handbook on statistics of extremes</em>, Eds M. de Carvalho, R. Huser, P. Naveau and B. J. Reich pages. in press 2025. CRC Press.
</div>
<div id="ref-casebase" class="csl-entry" role="listitem">
S. R. Bhatnagar, M. Turgeon, J. Islam, J. A. Hanley and O. Saarela. <span class="nocase">casebase</span>: An alternative framework for survival analysis and comparison of event rates. <em>The R Journal</em>, 14: 59–79, 2022. URL <a href="https://doi.org/10.32614/RJ-2022-052">https://doi.org/10.32614/RJ-2022-052</a>.
</div>
<div id="ref-Camarda:2022" class="csl-entry" role="listitem">
C. G. Camarda. The curse of the plateau. Measuring confidence in human mortality estimates at extreme ages. <em>Theoretical Population Biology</em>, 144: 24–36, 2022. URL <a href="https://doi.org/10.1016/j.tpb.2022.01.002">https://doi.org/10.1016/j.tpb.2022.01.002</a>.
</div>
<div id="ref-Chernoff:1954" class="csl-entry" role="listitem">
H. Chernoff. On the distribution of the likelihood ratio. <em>The Annals of Mathematical Statistics</em>, 25(3): 573–578, 1954. URL <a href="https://doi.org/10.1214/aoms/1177728725">https://doi.org/10.1214/aoms/1177728725</a>.
</div>
<div id="ref-tranSurv-package" class="csl-entry" role="listitem">
S. H. (Steven) Chiou and J. Qian. <em><span class="nocase">tranSurv</span>: Transformation model based estimation of survival and regression under dependent truncation and independent censoring.</em> 2021. URL <a href="https://CRAN.R-project.org/package=tranSurv">https://CRAN.R-project.org/package=tranSurv</a>. R package version 1.2.2.
</div>
<div id="ref-fitdistrplus-package" class="csl-entry" role="listitem">
M. L. Delignette-Muller and C. Dutang. <span class="nocase">fitdistrplus</span>: An <span>R</span> package for fitting distributions. <em>Journal of Statistical Software</em>, 64(4): 1–34, 2015. DOI <a href="https://doi.org/10.18637/jss.v064.i04">10.18637/jss.v064.i04</a>.
</div>
<div id="ref-Devroye:1986" class="csl-entry" role="listitem">
L. Devroye. <em>Non-uniform random variate generation.</em> New York: Springer, 1986. URL <a href="http://www.nrbook.com/devroye/">http://www.nrbook.com/devroye/</a>.
</div>
<div id="ref-Efron.Petrosian:1999" class="csl-entry" role="listitem">
B. Efron and V. Petrosian. Nonparametric methods for doubly truncated data. <em>Journal of the American Statistical Association</em>, 94(447): 824–834, 1999. URL <a href="https://doi.org/10.1080/01621459.1999.10474187">https://doi.org/10.1080/01621459.1999.10474187</a>.
</div>
<div id="ref-Einmahl:2019" class="csl-entry" role="listitem">
J. J. Einmahl, J. H. J. Einmahl and L. de Haan. Limits to human life span through extreme value theory. <em>Journal of the American Statistical Association</em>, 114(527): 1075–1080, 2019. URL <a href="https://doi.org/10.1080/01621459.2018.1537912">https://doi.org/10.1080/01621459.2018.1537912</a>.
</div>
<div id="ref-interval" class="csl-entry" role="listitem">
M. P. Fay and P. A. Shaw. Exact and asymptotic weighted logrank tests for interval censored data: The <span class="nocase">interval</span> <span>R</span> package. <em>Journal of Statistical Software</em>, 36(2): 1–34, 2010. URL <a href="https://doi.org/10.18637/jss.v036.i02">https://doi.org/10.18637/jss.v036.i02</a>.
</div>
<div id="ref-Frydman:1994" class="csl-entry" role="listitem">
H. Frydman. A note on nonparametric estimation of the distribution function from interval-censored and truncated observations. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, 56(1): 71–74, 1994. URL <a href="https://doi.org/10.1111/j.2517-6161.1994.tb01960.x">https://doi.org/10.1111/j.2517-6161.1994.tb01960.x</a>.
</div>
<div id="ref-Gentleman.Geyer:1994" class="csl-entry" role="listitem">
R. Gentleman and C. J. Geyer. Maximum likelihood for interval censored data: Consistency and computation. <em>Biometrika</em>, 81(3): 618–623, 1994. URL <a href="https://doi.org/10.1093/biomet/81.3.618">https://doi.org/10.1093/biomet/81.3.618</a>.
</div>
<div id="ref-Icens-package" class="csl-entry" role="listitem">
R. Gentleman and A. Vandal. <em><span>Icens</span>: <span>NPMLE</span> for censored and truncated data.</em> 2024. URL <a href="https://CRAN.R-project.org/package=DTDA">https://CRAN.R-project.org/package=DTDA</a>. R package version 1.76.0.
</div>
<div id="ref-prodlim-package" class="csl-entry" role="listitem">
T. A. Gerds. <em><span class="nocase">prodlim</span>: Product-limit estimation for censored event history analysis.</em> 2024. URL <a href="https://CRAN.R-project.org/package=prodlim">https://CRAN.R-project.org/package=prodlim</a>. R package version 2024.06.25.
</div>
<div id="ref-Rsolnp-pkg" class="csl-entry" role="listitem">
A. Ghalanos and S. Theussl. <em><span>Rsolnp</span>: General non-linear optimization using augmented <span>L</span>agrange multiplier method.</em> 2015. URL <a href="https://CRAN.R-project.org/package=Rsolnp">https://CRAN.R-project.org/package=Rsolnp</a>. R package version 1.16.
</div>
<div id="ref-extRemes" class="csl-entry" role="listitem">
E. Gilleland and R. W. Katz. <span class="nocase">extRemes</span> 2.0: An extreme value analysis package in <span>R</span>. <em>Journal of Statistical Software</em>, 72(8): 1–39, 2016. DOI <a href="https://doi.org/10.18637/jss.v072.i08">10.18637/jss.v072.i08</a>.
</div>
<div id="ref-Groeneboom.Wellner:1992" class="csl-entry" role="listitem">
P. Groeneboom and J. A. Wellner. <em>Information bounds and nonparametric maximum likelihood estimation.</em> Basel, Switzerland, 1992. URL <a href="https://doi.org/10.1007/978-3-0348-8621-5">https://doi.org/10.1007/978-3-0348-8621-5</a>.
</div>
<div id="ref-lubridate-package" class="csl-entry" role="listitem">
G. Grolemund and H. Wickham. Dates and times made easy with <span class="nocase">lubridate</span>. <em>Journal of Statistical Software</em>, 40(3): 1–25, 2011. URL <a href="https://www.jstatsoft.org/v40/i03/">https://www.jstatsoft.org/v40/i03/</a>.
</div>
<div id="ref-muhaz-package" class="csl-entry" role="listitem">
K. Hess and R. Gentleman. <em><span class="nocase">muhaz</span>: Hazard function estimation in survival analysis.</em> 2021. URL <a href="https://CRAN.R-project.org/package=muhaz">https://CRAN.R-project.org/package=muhaz</a>. R package version 1.2.6.4.
</div>
<div id="ref-demography-package" class="csl-entry" role="listitem">
R. Hyndman. <em><span class="nocase">demography</span>: Forecasting mortality, fertility, migration and population data.</em> 2023. URL <a href="https://pkg.robjhyndman.com/demography/">https://pkg.robjhyndman.com/demography/</a>. R package version 2.0.
</div>
<div id="ref-flexsurv" class="csl-entry" role="listitem">
C. Jackson. <span class="nocase">flexsurv</span>: A platform for parametric survival modeling in <span>R</span>. <em>Journal of Statistical Software</em>, 70(8): 1–33, 2016. URL <a href="https://www.jstatsoft.org/index.php/jss/article/view/v070i08">https://www.jstatsoft.org/index.php/jss/article/view/v070i08</a>.
</div>
<div id="ref-IDL:2021" class="csl-entry" role="listitem">
D. A. Jdanov, V. M. Shkolnikov and S. Gellers-Barkmann. The international database on longevity: Data resource profile. In <em>Exceptional lifespans</em>, Eds H. Maier, B. Jeune and J. W. Vaupel pages. 22–24 2021. Cham, Switzerland: Springer. URL <a href="https://doi.org/10.1007/978-3-030-49970-9_2">https://doi.org/10.1007/978-3-030-49970-9_2</a>.
</div>
<div id="ref-Kaplan.Meier:1958" class="csl-entry" role="listitem">
E. L. Kaplan and P. Meier. Nonparametric estimation from incomplete observations. <em>Journal of the American Statistical Association</em>, 53: 457–481, 1958. URL <a href="https://doi.org/10.1080/01621459.1958.10501452">https://doi.org/10.1080/01621459.1958.10501452</a>.
</div>
<div id="ref-Li.Anderson:2009" class="csl-entry" role="listitem">
T. Li and J. J. Anderson. The vitality model: A way to understand population survival and demographic heterogeneity. <em>Theoretical Population Biology</em>, 76(2): 118–131, 2009. URL <a href="https://doi.org/10.1016/j.tpb.2009.05.004">https://doi.org/10.1016/j.tpb.2009.05.004</a>.
</div>
<div id="ref-Lindsey.Ryan:1998" class="csl-entry" role="listitem">
J. C. Lindsey and L. M. Ryan. Methods for interval-censored data. <em>Statistics in Medicine</em>, 17(2): 219–238, 1998. URL <a href="https://doi.org/10.1002/(SICI)1097-0258(19980130)17:2&lt;219::AID-SIM735&gt;3.0.CO;2-O">https://doi.org/10.1002/(SICI)1097-0258(19980130)17:2&lt;219::AID-SIM735&gt;3.0.CO;2-O</a>.
</div>
<div id="ref-rstpm2" class="csl-entry" role="listitem">
X.-R. Liu, Y. Pawitan and M. Clements. Parametric and penalized generalized survival models. <em>Statistical Methods in Medical Research</em>, 27(5): 1531–1546, 2018. URL <a href="https://doi.org/10.1177/0962280216664760">https://doi.org/10.1177/0962280216664760</a>.
</div>
<div id="ref-ExceptionalLifespans" class="csl-entry" role="listitem">
<span class="smallcaps">H. Maier, B. Jeune and J. W. Vaupel, eds</span>. <em>Exceptional lifespans.</em> Cham, Switzerland: Springer, 2021. URL <a href="https://doi.org/10.1007/978-3-030-49970-9">https://doi.org/10.1007/978-3-030-49970-9</a>.
</div>
<div id="ref-Miralles.Davison:2023" class="csl-entry" role="listitem">
O. Miralles and A. C. Davison. Timing and spatial selection bias in rapid extreme event attribution. <em>Weather and Climate Extremes</em>, 41: 100584, 2023. URL <a href="https://doi.org/10.1016/j.wace.2023.100584">https://doi.org/10.1016/j.wace.2023.100584</a>.
</div>
<div id="ref-DTDA-package" class="csl-entry" role="listitem">
C. Moreira, J. de Uña-Álvarez and R. Crujeiras. <em><span>DTDA</span>: Doubly truncated data analysis.</em> 2022. URL <a href="https://bioconductor.org/packages/Icens/">https://bioconductor.org/packages/Icens/</a>. R package version 3.0.1.
</div>
<div id="ref-rust-package" class="csl-entry" role="listitem">
P. J. Northrop. <em><span class="nocase">rust</span>: Ratio-of-uniforms simulation with transformation.</em> 2023. URL <a href="https://paulnorthrop.github.io/rust/">https://paulnorthrop.github.io/rust/</a>. R package version 1.4.2, https://github.com/paulnorthrop/rust.
</div>
<div id="ref-Northrop.Coleman:2014" class="csl-entry" role="listitem">
P. J. Northrop and C. L. Coleman. Improved diagnostic plots for extreme value analyses. <em>Extremes</em>, 17: 289–303, 2014. URL <a href="https://doi.org/10.1007/s10687-014-0183-z">https://doi.org/10.1007/s10687-014-0183-z</a>.
</div>
<div id="ref-MortalityLaws-package" class="csl-entry" role="listitem">
M. D. Pascariu. <em><span>MortalityLaws</span>: Parametric mortality models, life tables and <span>HMD</span>.</em> 2024. URL <a href="https://CRAN.R-project.org/package=MortalityLaws">https://CRAN.R-project.org/package=MortalityLaws</a>. R package version 2.1.0.
</div>
<div id="ref-vitality-package" class="csl-entry" role="listitem">
G. Passolt, J. J. Anderson, T. Li, D. H. Salinger and D. J. Sharrow. <em><span class="nocase">vitality</span>: Fitting routines for the vitality family of mortality models.</em> 2018. URL <a href="https://CRAN.R-project.org/package=vitality">https://CRAN.R-project.org/package=vitality</a>. R package version 1.3.
</div>
<div id="ref-Perks:1932" class="csl-entry" role="listitem">
W. Perks. On some experiments in the graduation of mortality statistics. <em>Journal of the Institute of Actuaries</em>, 63(1): 12–57, 1932. DOI <a href="https://doi.org/10.1017/s0020268100046680">10.1017/s0020268100046680</a>.
</div>
<div id="ref-fda-package" class="csl-entry" role="listitem">
J. Ramsay. <em><span class="nocase">fda</span>: Functional data analysis.</em> 2024. URL <a href="http://www.functionaldata.org">http://www.functionaldata.org</a>. R package version 6.1.8.
</div>
<div id="ref-bshazard" class="csl-entry" role="listitem">
P. Rebora, A. Salim and M. Reilly. <span class="nocase">bshazard</span>: A flexible tool for nonparametric smoothing of the hazard function. <em>The R Journal</em>, 6(2): 114–122, 2014. URL <a href="https://doi.org/10.32614/RJ-2014-028">https://doi.org/10.32614/RJ-2014-028</a>.
</div>
<div id="ref-Richards:2012" class="csl-entry" role="listitem">
S. J. Richards. A handbook of parametric survival models for actuarial use. <em>Scandinavian Actuarial Journal</em>, 2012(4): 233–257, 2012. URL <a href="https://doi.org/10.1080/03461238.2010.506688">https://doi.org/10.1080/03461238.2010.506688</a>.
</div>
<div id="ref-Rotnitzky:2000" class="csl-entry" role="listitem">
A. Rotnitzky, D. R. Cox, M. Bottai and J. Robins. Likelihood-based inference with singular information matrix. <em>Bernoulli</em>, 6(2): 243–284, 2000. URL <a href="https://doi.org/">https://doi.org/</a>.
</div>
<div id="ref-Royston.Parmar:2002" class="csl-entry" role="listitem">
P. Royston and M. K. B. Parmar. Flexible parametric proportional-hazards and proportional-odds models for censored survival data, with application to prognostic modelling and estimation of treatment effects. <em>Statistics in Medicine</em>, 21(15): 2175–2197, 2002. URL <a href="https://doi.org/10.1002/sim.1203">https://doi.org/10.1002/sim.1203</a>.
</div>
<div id="ref-Sailynoja.Burkner.Vehtari:2021" class="csl-entry" role="listitem">
T. Säilynoja, P.-C. Bürkner and A. Vehtari. Graphical test for discrete uniformity and its applications in goodness of fit evaluation and multiple sample comparison. <em>Statistics and Computing</em>, 32(2): 32, 2022. URL <a href="https://doi.org/10.1007/s11222-022-10090-6">https://doi.org/10.1007/s11222-022-10090-6</a>.
</div>
<div id="ref-Self.Liang:1987" class="csl-entry" role="listitem">
S. G. Self and K.-Y. Liang. Asymptotic properties of maximum likelihood estimators and likelihood ratio tests under nonstandard conditions. <em>Journal of the American Statistical Association</em>, 82(398): 605–610, 1987. URL <a href="https://doi.org/10.1080/01621459.1987.10478472">https://doi.org/10.1080/01621459.1987.10478472</a>.
</div>
<div id="ref-Sevcikova:2016" class="csl-entry" role="listitem">
H. Ševčíková, N. Li, V. Kantorová, P. Gerland and A. E. Raftery. Age-specific mortality and fertility rates for probabilistic population projections. In <em>Dynamic demographic analysis</em>, Ed R. Schoen pages. 285–310 2016. Cham, Switzerland: Springer. ISBN 978-3-319-26603-9. URL <a href="https://doi.org/10.1007/978-3-319-26603-9_15">https://doi.org/10.1007/978-3-319-26603-9_15</a>.
</div>
<div id="ref-MortCast-package" class="csl-entry" role="listitem">
H. Ševčı́ková, N. Li and P. Gerland. <em><span>MortCast</span>: Estimation and projection of age-specific mortality rates.</em> 2022. URL <a href="https://CRAN.R-project.org/package=MortCast">https://CRAN.R-project.org/package=MortCast</a>. R package version 2.7-0.
</div>
<div id="ref-Shen:2010" class="csl-entry" role="listitem">
P.-S. Shen. Nonparametric analysis of doubly truncated data. <em>Annals of the Institute of Statistical Mathematics</em>, 62(5): 835–853, 2010. URL <a href="https://doi.org/10.1007/s10463-008-0192-2">https://doi.org/10.1007/s10463-008-0192-2</a>.
</div>
<div id="ref-evd" class="csl-entry" role="listitem">
A. G. Stephenson. <span class="nocase">evd</span>: Extreme value distributions. <em>R News</em>, 2(2): 2002. URL <a href="https://cran.r-project.org/doc/Rnews/Rnews_2002-2.pdf">https://cran.r-project.org/doc/Rnews/Rnews_2002-2.pdf</a>.
</div>
<div id="ref-Sun.Genton:2011" class="csl-entry" role="listitem">
Y. Sun and M. G. Genton. Functional boxplots. <em>Journal of Computational and Graphical Statistics</em>, 20(2): 316–334, 2011. DOI <a href="https://doi.org/10.1198/jcgs.2011.09224">10.1198/jcgs.2011.09224</a>.
</div>
<div id="ref-survival-package" class="csl-entry" role="listitem">
T. M. Therneau. <em>A package for survival analysis in <span>R</span>.</em> 2022. URL <a href="https://CRAN.R-project.org/package=survival">https://CRAN.R-project.org/package=survival</a>. R package version 3.3-1.
</div>
<div id="ref-survival-book" class="csl-entry" role="listitem">
T. M. Therneau and P. M. Grambsch. <em>Modeling survival data: Extending the <span>C</span>ox model.</em> New York: Springer, 2000. URL <a href="https://doi.org/10.1007/978-1-4757-3294-8">https://doi.org/10.1007/978-1-4757-3294-8</a>.
</div>
<div id="ref-Tsai.Jewell.Wang:1987" class="csl-entry" role="listitem">
W.-Y. Tsai, N. P. Jewell and M.-C. Wang. A note on the product-limit estimator under right censoring and left truncation. <em>Biometrika</em>, 74(4): 883–886, 1987. URL <a href="https://doi.org/10.1093/biomet/74.4.883">https://doi.org/10.1093/biomet/74.4.883</a>.
</div>
<div id="ref-Turnbull:1976" class="csl-entry" role="listitem">
B. W. Turnbull. The empirical distribution function with arbitrarily grouped, censored and truncated data. <em>Journal of the Royal Statistical Society, Series B</em>, 38: 290–295, 1976. URL <a href="https://doi.org/10.1111/j.2517-6161.1976.tb01597.x">https://doi.org/10.1111/j.2517-6161.1976.tb01597.x</a>.
</div>
<div id="ref-Waller.Turnbull:1992" class="csl-entry" role="listitem">
L. A. Waller and B. W. Turnbull. Probability plotting with censored data. <em>American Statistician</em>, 46(1): 5–12, 1992. URL <a href="https://doi.org/10.1080/00031305.1992.10475837">https://doi.org/10.1080/00031305.1992.10475837</a>.
</div>
<div id="ref-Watanabe:2010" class="csl-entry" role="listitem">
S. Watanabe. Asymptotic equivalence of <span>B</span>ayes cross validation and widely applicable information criterion in singular learning theory. <em>Journal of Machine Learning Research</em>, 11: 3571–3594, 2010. URL <a href="https://dl.acm.org/doi/10.5555/1756006.1953045">https://dl.acm.org/doi/10.5555/1756006.1953045</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
H. Wickham. <em><span class="nocase">ggplot2</span>: Elegant graphics for data analysis.</em> Springer-Verlag New York, 2016. URL <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
H. Wickham, M. Averick, J. Bryan, W. Chang, L. D. McGowan, R. François, G. Grolemund, A. Hayes, L. Henry, J. Hester, et al. Welcome to the <span class="nocase">tidyverse</span>. <em>Journal of Open Source Software</em>, 4(43): 1686, 2019. URL <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-dplyr-package" class="csl-entry" role="listitem">
H. Wickham, R. François, L. Henry, K. Müller and D. Vaughan. <em><span class="nocase">dplyr</span>: A grammar of data manipulation.</em> 2023. URL <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>. R package version 1.1.4.
</div>
<div id="ref-Ye:1987" class="csl-entry" role="listitem">
Y. Ye. Interior algorithms for linear, quadratic, and linearly constrained non-linear programming. 1987.
</div>
<div id="ref-VGAMbook" class="csl-entry" role="listitem">
T. W. Yee. <em>Vector generalized linear and additive models: With an implementation in <span>R</span>.</em> New York, NY: Springer, 2015. URL <a href="https://doi.org/10.1007/978-1-4939-2818-7">https://doi.org/10.1007/978-1-4939-2818-7</a>.
</div>
<div id="ref-Yee.Wild:1996" class="csl-entry" role="listitem">
T. W. Yee and C. J. Wild. Vector generalized additive models. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, 58(3): 481–493, 1996. URL <a href="https://doi.org/10.1111/j.2517-6161.1996.tb02095.x">https://doi.org/10.1111/j.2517-6161.1996.tb02095.x</a>.
</div>
<div id="ref-evgam" class="csl-entry" role="listitem">
B. D. Youngman. <span class="nocase">evgam</span>: An <span>R</span> package for generalized additive extreme value models. <em>Journal of Statistical Software</em>, 103(3): 1–26, 2022. URL <a href="https://www.jstatsoft.org/index.php/jss/article/view/v103i03">https://www.jstatsoft.org/index.php/jss/article/view/v103i03</a>.
</div>
<div id="ref-dblcens-package" class="csl-entry" role="listitem">
M. Zhou, L. Lee, K. Chen and Y. Yang. <em><span class="nocase">dblcens</span>: Compute the <span>NPMLE</span> of distribution function from doubly censored data, plus the empirical likelihood ratio for <span class="math inline">\(F(T)\)</span>.</em> 2023. URL <a href="https://CRAN.R-project.org/package=dblcens">https://CRAN.R-project.org/package=dblcens</a>. R package version 1.1.9.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Belzile, "longevity: An R Package for Modelling Excess Lifetimes", The R Journal, 2026</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@article{RJ-2025-034,
  author = {Belzile, Léo R.},
  title = {longevity: An R Package for Modelling Excess Lifetimes},
  journal = {The R Journal},
  year = {2026},
  note = {https://doi.org/10.32614/RJ-2025-034},
  doi = {10.32614/RJ-2025-034},
  volume = {17},
  issue = {4},
  issn = {2073-4859},
  pages = {37-58}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
