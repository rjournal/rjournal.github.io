<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Fitting a Quantile Regression Model for Residual Life with the R Package qris</title>

  <meta property="description" itemprop="description" content="In survival analysis, regression modeling has traditionally focused on&#10;assessing covariate effects on survival times, which is defined as the&#10;elapsed time between a baseline and event time. Nevertheless, focusing&#10;on residual life can provide a more dynamic assessment of covariate&#10;effects, as it offers more updated information at specific time points&#10;between the baseline and event occurrence. Statistical methods for&#10;fitting quantile regression models have recently been proposed,&#10;providing favorable alternatives to modeling the mean of residual&#10;lifetimes. Despite these progresses, the lack of computer software&#10;that implements these methods remains an obstacle for researchers&#10;analyzing data in practice. In this paper, we introduce an R package&#10;qris, which&#10;implements methods for fitting semiparametric quantile regression&#10;models on residual life subject to right censoring. We demonstrate the&#10;effectiveness and versatility of this package through comprehensive&#10;simulation studies and a real-world data example, showcasing its&#10;valuable contributions to survival analysis research."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-01-10"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-01-10"/>
  <meta name="article:author" content="Kyu Hyun Kim"/>
  <meta name="article:author" content="Sangwook Kang"/>
  <meta name="article:author" content="Sy Han Chiou"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Fitting a Quantile Regression Model for Residual Life with the R Package qris"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In survival analysis, regression modeling has traditionally focused on&#10;assessing covariate effects on survival times, which is defined as the&#10;elapsed time between a baseline and event time. Nevertheless, focusing&#10;on residual life can provide a more dynamic assessment of covariate&#10;effects, as it offers more updated information at specific time points&#10;between the baseline and event occurrence. Statistical methods for&#10;fitting quantile regression models have recently been proposed,&#10;providing favorable alternatives to modeling the mean of residual&#10;lifetimes. Despite these progresses, the lack of computer software&#10;that implements these methods remains an obstacle for researchers&#10;analyzing data in practice. In this paper, we introduce an R package&#10;qris, which&#10;implements methods for fitting semiparametric quantile regression&#10;models on residual life subject to right censoring. We demonstrate the&#10;effectiveness and versatility of this package through comprehensive&#10;simulation studies and a real-world data example, showcasing its&#10;valuable contributions to survival analysis research."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Fitting a Quantile Regression Model for Residual Life with the R Package qris"/>
  <meta property="twitter:description" content="In survival analysis, regression modeling has traditionally focused on&#10;assessing covariate effects on survival times, which is defined as the&#10;elapsed time between a baseline and event time. Nevertheless, focusing&#10;on residual life can provide a more dynamic assessment of covariate&#10;effects, as it offers more updated information at specific time points&#10;between the baseline and event occurrence. Statistical methods for&#10;fitting quantile regression models have recently been proposed,&#10;providing favorable alternatives to modeling the mean of residual&#10;lifetimes. Despite these progresses, the lack of computer software&#10;that implements these methods remains an obstacle for researchers&#10;analyzing data in practice. In this paper, we introduce an R package&#10;qris, which&#10;implements methods for fitting semiparametric quantile regression&#10;models on residual life subject to right censoring. We demonstrate the&#10;effectiveness and versatility of this package through comprehensive&#10;simulation studies and a real-world data example, showcasing its&#10;valuable contributions to survival analysis research."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="Fitting a Quantile Regression Model for Residual Life with the R Package qris"/>
  <meta name="citation_fulltext_html_url" content="https://doi.org/10.32614/RJ-2024-007"/>
  <meta name="citation_pdf_url" content="RJ-2024-007.pdf"/>
  <meta name="citation_volume" content="16"/>
  <meta name="citation_issue" content="1"/>
  <meta name="citation_doi" content="10.32614/RJ-2024-007"/>
  <meta name="citation_journal_title" content="The R Journal"/>
  <meta name="citation_issn" content="2073-4859"/>
  <meta name="citation_firstpage" content="114"/>
  <meta name="citation_lastpage" content="134"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2025/01/10"/>
  <meta name="citation_publication_date" content="2025/01/10"/>
  <meta name="citation_author" content="Kyu Hyun Kim"/>
  <meta name="citation_author_institution" content="Department of Statistics and Data Science and Department of Applied&#10;Statistics"/>
  <meta name="citation_author" content="Sangwook Kang"/>
  <meta name="citation_author_institution" content="Department of Statistics and Data Science and Department of Applied&#10;Statistics"/>
  <meta name="citation_author" content="Sy Han Chiou"/>
  <meta name="citation_author_institution" content="Department of Statistics and Data Science"/>
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Smoothed quantile regression analysis of competing risks;citation_publisher=Wiley Online Library;citation_volume=60;citation_author=Sangbum Choi;citation_author=Sangwook Kang;citation_author=Xuelin Huang"/>
  <meta name="citation_reference" content="citation_title=Regression on quantile residual life;citation_publisher=Wiley Online Library;citation_volume=65;citation_author=Sin-Ho Jung;citation_author=Jong-Hyeon Jeong;citation_author=Hanna Bandos"/>
  <meta name="citation_reference" content="citation_title=Censored quantile regression for residual lifetimes;citation_publisher=Springer;citation_volume=18;citation_author=Mi-Ok Kim;citation_author=Mai Zhou;citation_author=Jong-Hyeon Jeong"/>
  <meta name="citation_reference" content="citation_title=Survival analysis with quantile regression models;citation_publisher=Taylor &amp; Francis;citation_volume=103;citation_author=Limin Peng;citation_author=Yijian Huang"/>
  <meta name="citation_reference" content="citation_title=Semiparametric accelerated failure time modeling for clustered failure times from stratified sampling;citation_publisher=Taylor &amp; Francis;citation_volume=110;citation_author=Sy Han Chiou;citation_author=Sangwook Kang;citation_author=Jun Yan"/>
  <meta name="citation_reference" content="citation_title=Regression quantiles;citation_publisher=JSTOR;citation_author=Roger Koenker;citation_author=Gilbert Bassett Jr"/>
  <meta name="citation_reference" content="citation_title=Quantreg: Quantile regression;citation_author=Roger Koenker"/>
  <meta name="citation_reference" content="citation_title=Qris: Quantile regression model for residual lifetime using an induced smoothing approach;citation_author=Kyu Hyun Kim;citation_author=Sangwook Kang;citation_author=Sy Han Chiou"/>
  <meta name="citation_reference" content="citation_title=Quantile residual life regression with longitudinal biomarker measurements for dynamic prediction;citation_publisher=Wiley-Blackwell;citation_volume=65;citation_author=Ruosha Li;citation_author=Xuelin Huang;citation_author=Jorge E Cortes"/>
  <meta name="citation_reference" content="citation_title=Rank-based estimating equations with general weight for accelerated failure time models: An induced smoothing approach;citation_publisher=Wiley Online Library;citation_volume=34;citation_author=S Chiou;citation_author=Sangwook Kang;citation_author=J Yan"/>
  <meta name="citation_reference" content="citation_title=Survival analysis with median regression models;citation_publisher=Taylor &amp; Francis;citation_volume=90;citation_author=Zhiliang Ying;citation_author=Sin-Ho Jung;citation_author=Lee-Jen Wei"/>
  <meta name="citation_reference" content="citation_title=Censored regression quantiles;citation_publisher=Taylor &amp; Francis;citation_volume=98;citation_author=Stephen Portnoy"/>
  <meta name="citation_reference" content="citation_title=Inference for the proportional mean residual life model;citation_publisher=JSTOR;citation_author=David Oakes;citation_author=Tamraparni Dasu"/>
  <meta name="citation_reference" content="citation_title=Semiparametric estimation of proportional mean residual life model in presence of censoring;citation_publisher=Wiley Online Library;citation_volume=61;citation_author=YQ Chen;citation_author=NP Jewell;citation_author=X Lei;citation_author=SC Cheng"/>
  <meta name="citation_reference" content="citation_title=Estimation in the mean residual life regression model;citation_publisher=Wiley Online Library;citation_volume=56;citation_author=Gangaji Maguluri;citation_author=Cun-Hui Zhang"/>
  <meta name="citation_reference" content="citation_title=A note on residual life;citation_publisher=Oxford University Press;citation_volume=77;citation_author=David Oakes;citation_author=Tamraparni Dasu"/>
  <meta name="citation_reference" content="citation_title=Linear life expectancy regression with censored data;citation_publisher=Oxford University Press;citation_volume=93;citation_author=Ying Qing Chen;citation_author=Seu Cheng"/>
  <meta name="citation_reference" content="citation_title=Additive expectancy regression;citation_publisher=Taylor &amp; Francis;citation_volume=102;citation_author=Ying Qing Chen"/>
  <meta name="citation_reference" content="citation_title=Goodness-of-fit tests for additive mean residual life model under right censoring;citation_publisher=Springer;citation_volume=16;citation_author=Zhigang Zhang;citation_author=Xingqiu Zhao;citation_author=Liuquan Sun"/>
  <meta name="citation_reference" content="citation_title=Regression analysis of mean residual life function;citation_publisher=North Carolina State University. Dept. of Statistics;citation_author=Shufang Liu;citation_author=Sujit K Ghosh"/>
  <meta name="citation_reference" content="citation_title=Quasi-likelihood for median regression models;citation_publisher=Taylor &amp; Francis Group;citation_volume=91;citation_author=Sin-Ho Jung"/>
  <meta name="citation_reference" content="citation_title=The gaussian hare and the laplacian tortoise: Computability of squared-error versus absolute-error estimators;citation_publisher=Institute of Mathematical Statistics;citation_volume=12;citation_author=Stephen Portnoy;citation_author=Roger Koenker"/>
  <meta name="citation_reference" content="citation_title=Quantile regression methods for reference growth charts;citation_publisher=Wiley Online Library;citation_volume=25;citation_author=Ying Wei;citation_author=Anneli Pere;citation_author=Roger Koenker;citation_author=Xuming He"/>
  <meta name="citation_reference" content="citation_title=Quantile calculus and censored regression;citation_publisher=NIH Public Access;citation_volume=38;citation_doi=10.1214/09-AOS771;citation_author=Yijian Huang"/>
  <meta name="citation_reference" content="citation_title=Induced smoothing for the semiparametric accelerated failure time model: Asymptotics and extensions to clustered data;citation_publisher=Oxford University Press;citation_volume=96;citation_author=Lynn M Johnson;citation_author=Robert L Strawderman"/>
  <meta name="citation_reference" content="citation_title=Fast accelerated failure time modeling for case-cohort data;citation_publisher=Springer;citation_volume=24;citation_author=Sy Han Chiou;citation_author=Sangwook Kang;citation_author=Jun Yan"/>
  <meta name="citation_reference" content="citation_title=Aftgee: Accelerated failure time model with generalized estimating equations;citation_author=Sy Han Chiou;citation_author=Sangwook Kang;citation_author=Jun Yan"/>
  <meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;citation_publisher=R Foundation for Statistical Computing;citation_author=R: A language and environment for statistical computing"/>
  <meta name="citation_reference" content="citation_title=Standard errors and covariance matrices for smoothed rank estimators;citation_publisher=Oxford University Press;citation_volume=92;citation_author=BM Brown;citation_author=You-Gan Wang"/>
  <meta name="citation_reference" content="citation_title=Fitting semiparametric accelerated failure time models for nested case–control data;citation_publisher=Taylor &amp; Francis;citation_volume=87;citation_author=Sangwook Kang"/>
  <meta name="citation_reference" content="citation_title=Brq: Bayesian analysis of quantile regression models;citation_author=Rahim Alhamzawi"/>
  <meta name="citation_reference" content="citation_title=cmprskQR: Analysis of competing risks using quantile regressions;citation_author=Stephan Dlugosz;citation_author=Limin Peng;citation_author=Ruosha Li;citation_author=Shuolin Shi"/>
  <meta name="citation_reference" content="citation_title=Prospective evaluation of prognostic variables from patient-completed questionnaires. North Central Cancer Treatment Group.;citation_volume=12;citation_author=Charles Lawrence Loprinzi;citation_author=John A Laurie;citation_author=H Sam Wieand;citation_author=James E Krook;citation_author=Paul J Novotny;citation_author=John W Kugler;citation_author=Joan Bartel;citation_author=Marlys Law;citation_author=Marilyn Bateman;citation_author=Nancy E Klatt"/>
  <meta name="citation_reference" content="citation_title=Smoothed quantile regression for censored residual life;citation_volume=38;citation_author=Kyu Hyun Kim;citation_author=Daniel J Caplan;citation_author=Sangwook Kang"/>
  <meta name="citation_reference" content="citation_title=Censored regression quantiles;citation_publisher=Elsevier;citation_volume=32;citation_author=James L Powell"/>
  <meta name="citation_reference" content="citation_title=Ctqr: Censored and truncated quantile regression;citation_author=Paolo Frumento"/>
  <meta name="citation_reference" content="citation_title=Rcpp: Seamless r and c++ integration;citation_author=Dirk Eddelbuettel;citation_author=Romain Francois;citation_author=JJ Allaire;citation_author=Kevin Ushey;citation_author=Qiang Kou;citation_author=Nathan Russell;citation_author=Inaki Ucar;citation_author=Douglas Bates;citation_author=John Chambers"/>
  <meta name="citation_reference" content="citation_title=RcppArmadillo: “Rcpp” integration for the “armadillo” templated linear algebra library;citation_author=Dirk Eddelbuettel;citation_author=Romain Francois;citation_author=Doug Bates;citation_author=Binxiang Ni;citation_author=Conrad Sanderson"/>
  <meta name="citation_reference" content="citation_title=Cancer statistics, 2021;citation_publisher=Wiley Online Library;citation_volume=71;citation_author=Rebecca L Siegel;citation_author=Kimberly D Miller;citation_author=Hannah E Fuchs;citation_author=Ahmedin Jemal"/>
  <meta name="citation_reference" content="citation_title=A case-cohort design for epidemiologic cohort studies and disease prevention trials;citation_publisher=Oxford University Press;citation_volume=73;citation_author=Ross L Prentice"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Create elegant data visualisations using the grammar of graphics;citation_author=Hadley Wickham;citation_author=Winston Chang;citation_author=Lionel Henry;citation_author=Thomas Lin Pedersen;citation_author=Kohske Takahashi;citation_author=Claus Wilke;citation_author=Kara Woo;citation_author=Hiroaki Yutani;citation_author=Dewey Dunnington"/>
  <meta name="citation_reference" content="citation_title=Quantile smoothing splines;citation_publisher=Oxford University Press;citation_volume=81;citation_author=Roger Koenker;citation_author=Pin Ng;citation_author=Stephen Portnoy"/>
  <meta name="citation_reference" content="citation_title=Penalized triograms: Total variation regularization for bivariate smoothing;citation_publisher=Wiley Online Library;citation_volume=66;citation_author=Roger Koenker;citation_author=Ivan Mizera"/>
  <meta name="citation_reference" content="citation_title=Survival: Survival analysis;citation_author=Terry M Therneau"/>
  <meta name="citation_reference" content="citation_title=Advanced Bayesian multilevel modeling with the R package brms;citation_volume=10;citation_doi=10.32614/RJ-2018-017;citation_author=Paul-Christian Bürkner"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","date_received","journal","volume","issue","slug","citation_url","packages","preview","bibliography","CTV","legacy_pdf","legacy_converted","output","draft","pdf_url","doi","creative_commons","csl"]}},"value":[{"type":"character","attributes":{},"value":["Fitting a Quantile Regression Model for Residual Life with the R Package qris"]},{"type":"character","attributes":{},"value":["In survival analysis, regression modeling has traditionally focused on\nassessing covariate effects on survival times, which is defined as the\nelapsed time between a baseline and event time. Nevertheless, focusing\non residual life can provide a more dynamic assessment of covariate\neffects, as it offers more updated information at specific time points\nbetween the baseline and event occurrence. Statistical methods for\nfitting quantile regression models have recently been proposed,\nproviding favorable alternatives to modeling the mean of residual\nlifetimes. Despite these progresses, the lack of computer software\nthat implements these methods remains an obstacle for researchers\nanalyzing data in practice. In this paper, we introduce an R package\nqris, which\nimplements methods for fitting semiparametric quantile regression\nmodels on residual life subject to right censoring. We demonstrate the\neffectiveness and versatility of this package through comprehensive\nsimulation studies and a real-world data example, showcasing its\nvaluable contributions to survival analysis research.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Kyu Hyun Kim"]},{"type":"character","attributes":{},"value":["Department of Statistics and Data Science and Department of Applied\nStatistics"]},{"type":"character","attributes":{},"value":["Yonsei University","50 Yonsei-ro, Seodaemun-gu, Seoul","Republic of Korea","[kyuhyunkim07@yonsei.ac.kr](kyuhyunkim07@yonsei.ac.kr){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Sangwook Kang"]},{"type":"character","attributes":{},"value":["Department of Statistics and Data Science and Department of Applied\nStatistics"]},{"type":"character","attributes":{},"value":["Yonsei University","50 Yonsei-ro, Seodaemun-gu, Seoul","Republic of Korea","[kanggi1@yonsei.ac.kr](kanggi1@yonsei.ac.kr){.uri}\n"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Sy Han Chiou"]},{"type":"character","attributes":{},"value":["Department of Statistics and Data Science"]},{"type":"character","attributes":{},"value":["Southern Methodist University","P.O. Box 750332, Dallas, TX","USA","[schiou@smu.edu](schiou@smu.edu){.uri}","<https://www.sychiou.com/>\n"]}]}]},{"type":"character","attributes":{},"value":["2025-01-10"]},{"type":"character","attributes":{},"value":["2022-10-21"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"integer","attributes":{},"value":[114]},{"type":"integer","attributes":{},"value":[134]}]},{"type":"integer","attributes":{},"value":[16]},{"type":"integer","attributes":{},"value":[1]},{"type":"character","attributes":{},"value":["RJ-2024-007"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/RJ-2024-007"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["qris","quantreg","aftgee","ctqr","Brq","brms","cmprskQR","ggplot2","Rcpp","RcppArmadillo","survival"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"character","attributes":{},"value":["2022-185_R3.bib"]},{"type":"character","attributes":{},"value":["Bayesian","ChemPhys","ClinicalTrials","Econometrics","Environmetrics","HighPerformanceComputing","MetaAnalysis","MixedModels","NetworkAnalysis","NumericalMathematics","Optimization","Phylogenetics","ReproducibleResearch","Robust","Spatial","Survival","TeachingStatistics"]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","mathjax","md_extension"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"]},{"type":"character","attributes":{},"value":["-tex_math_single_backslash"]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["RJ-2024-007.pdf"]},{"type":"character","attributes":{},"value":["10.32614/RJ-2024-007"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["/home/mitchell/R/x86_64-pc-linux-gnu-library/4.4/rjtools/rjournal.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["2022-185_R3.bib","2022-185_R3.tex","figures/realdata_multi_basetime.pdf","figures/realdata_multi_quantile.pdf","figures/realdata_nonsmooth_quantile.pdf","figures/realdata_smooth_quantile.pdf","figures/simulation_smooth_quantile.pdf","figures/simulation_smooth_t0.pdf","figures/vplot_pmb_t0_c3_Q50.pdf","figures/vplot_pmb_t1_c3_Q50.pdf","figures/vplot_t0_c3_Q50.pdf","figures/vplot_t1_c3_Q50.pdf","qris.bib","qris.pdf","qris.tex","realdata_multi_basetime.png","realdata_multi_quantile.png","realdata_nonsmooth_quantile.png","realdata_smooth_quantile.png","RJ-2024-007_files/figure-html5/unnamed-chunk-12-1.png","RJ-2024-007_files/figure-html5/unnamed-chunk-14-1.png","RJ-2024-007_files/figure-html5/unnamed-chunk-14-2.png","RJ-2024-007_files/figure-html5/unnamed-chunk-25-1.png","RJ-2024-007_files/figure-html5/unnamed-chunk-25-2.png","RJ-2024-007_files/figure-html5/unnamed-chunk-25-3.png","RJ-2024-007_files/figure-html5/unnamed-chunk-25-4.png","RJournal.sty","RJwrapper.log","RJwrapper.tex","simulation_smooth_quantile.png","simulation_smooth_t0.png","supp/2022-185_Supp.pdf","vplot_pmb_t0_c3_Q50.pdf","vplot_pmb_t0_c3_Q50.png","vplot_pmb_t1_c3_Q50.pdf","vplot_pmb_t1_c3_Q50.png","vplot_t0_c3_Q50.pdf","vplot_t0_c3_Q50.png","vplot_t1_c3_Q50.pdf","vplot_t1_c3_Q50.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="RJ-2024-007_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="RJ-2024-007_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="RJ-2024-007_files/popper-2.6.0/popper.min.js"></script>
  <link href="RJ-2024-007_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="RJ-2024-007_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="RJ-2024-007_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="RJ-2024-007_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="RJ-2024-007_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="RJ-2024-007_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="RJ-2024-007_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Fitting a Quantile Regression Model for Residual Life with the R Package qris","description":"In survival analysis, regression modeling has traditionally focused on\nassessing covariate effects on survival times, which is defined as the\nelapsed time between a baseline and event time. Nevertheless, focusing\non residual life can provide a more dynamic assessment of covariate\neffects, as it offers more updated information at specific time points\nbetween the baseline and event occurrence. Statistical methods for\nfitting quantile regression models have recently been proposed,\nproviding favorable alternatives to modeling the mean of residual\nlifetimes. Despite these progresses, the lack of computer software\nthat implements these methods remains an obstacle for researchers\nanalyzing data in practice. In this paper, we introduce an R package\nqris, which\nimplements methods for fitting semiparametric quantile regression\nmodels on residual life subject to right censoring. We demonstrate the\neffectiveness and versatility of this package through comprehensive\nsimulation studies and a real-world data example, showcasing its\nvaluable contributions to survival analysis research.","doi":"10.32614/RJ-2024-007","authors":[{"author":"Kyu Hyun Kim","authorURL":"#","affiliation":"Department of Statistics and Data Science and Department of Applied\nStatistics","affiliationURL":"#","orcidID":""},{"author":"Sangwook Kang","authorURL":"#","affiliation":"Department of Statistics and Data Science and Department of Applied\nStatistics","affiliationURL":"#","orcidID":""},{"author":"Sy Han Chiou","authorURL":"#","affiliation":"Department of Statistics and Data Science","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-01-10T00:00:00.000+11:00","citationText":"Kim, et al., 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Fitting a Quantile Regression Model for Residual Life with the R Package qris</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>In survival analysis, regression modeling has traditionally focused on
assessing covariate effects on survival times, which is defined as the
elapsed time between a baseline and event time. Nevertheless, focusing
on residual life can provide a more dynamic assessment of covariate
effects, as it offers more updated information at specific time points
between the baseline and event occurrence. Statistical methods for
fitting quantile regression models have recently been proposed,
providing favorable alternatives to modeling the mean of residual
lifetimes. Despite these progresses, the lack of computer software
that implements these methods remains an obstacle for researchers
analyzing data in practice. In this paper, we introduce an R package
qris, which
implements methods for fitting semiparametric quantile regression
models on residual life subject to right censoring. We demonstrate the
effectiveness and versatility of this package through comprehensive
simulation studies and a real-world data example, showcasing its
valuable contributions to survival analysis research.</p></p>
</div>

<div class="d-byline">
  Kyu Hyun Kim  (Department of Statistics and Data Science and Department of Applied
Statistics)
  
,   Sangwook Kang  (Department of Statistics and Data Science and Department of Applied
Statistics)
  
,   Sy Han Chiou  (Department of Statistics and Data Science)
  
<br/>2025-01-10
</div>

<div class="d-article">
<div class="article">
<h3 data-number="1" id="sec:intro"><span class="header-section-number">1</span> Introduction</h3>
<p>In the analysis of time-to-event data, standard statistical inference
procedures often focus on quantities based on failure time and its
relationship with covariates measured at baseline. However, throughout
the follow-up process, inference procedures based on residual life
become increasingly intuitive for assessing the survival of subjects and
can offer insights into the effectiveness of treatments in prolonging
the remaining lifetime. As covariates can substantially change over time
and models based solely on baseline covariates have limited potential
for long-term prognosis, there is a growing interest in modeling the
remaining lifetime of a surviving subject with updated patient
information. Many efforts have been made to model the mean residual life
including proportional mean residual life models
<span class="citation" data-cites="maguluri1994estimation oakes1990note oakes2003inference chen2005semiparametric">(<a href="#ref-oakes1990note" role="doc-biblioref">Oakes and Dasu 1990</a>, <a href="#ref-oakes2003inference" role="doc-biblioref">2003</a>; <a href="#ref-maguluri1994estimation" role="doc-biblioref">Maguluri and Zhang 1994</a>; <a href="#ref-chen2005semiparametric" role="doc-biblioref">Chen et al. 2005</a>)</span>,
additive mean residual life models
<span class="citation" data-cites="chen2006linear chen2007additive zhang2010goodness">(<a href="#ref-chen2006linear" role="doc-biblioref">Chen and Cheng 2006</a>; <a href="#ref-chen2007additive" role="doc-biblioref">Chen 2007</a>; <a href="#ref-zhang2010goodness" role="doc-biblioref">Zhang et al. 2010</a>)</span>, and
proportional scaled mean residual life models <span class="citation" data-cites="liu2008regression">(<a href="#ref-liu2008regression" role="doc-biblioref">Liu and Ghosh 2008</a>)</span>.
Given that failure times are usually right-skewed and heavy-tailed, the
mean of the residual life might not be identifiable if the follow-up
time is not sufficiently long. For this reason, quantiles, which are
robust under skewed distribution, have traditionally been used more
frequently as alternative summary measures. For example, the approach on
the semiparametric quantile regression model for continuous responses
<span class="citation" data-cites="koenker1978regression">(<a href="#ref-koenker1978regression" role="doc-biblioref">Koenker and Bassett Jr 1978</a>)</span> has been extended to uncensored failure time
data <span class="citation" data-cites="jung1996quasi portnoy1997gaussian wei2006quantile">(<a href="#ref-jung1996quasi" role="doc-biblioref">Jung 1996</a>; <a href="#ref-portnoy1997gaussian" role="doc-biblioref">Portnoy and Koenker 1997</a>; <a href="#ref-wei2006quantile" role="doc-biblioref">Wei et al. 2006</a>)</span> and
censored failure times data
<span class="citation" data-cites="ying1995survival portnoy2003censored peng2008survival huang2010quantile">(<a href="#ref-ying1995survival" role="doc-biblioref">Ying et al. 1995</a>; <a href="#ref-portnoy2003censored" role="doc-biblioref">Portnoy 2003</a>; <a href="#ref-peng2008survival" role="doc-biblioref">Peng and Huang 2008</a>; <a href="#ref-huang2010quantile" role="doc-biblioref">Huang 2010</a>)</span>.</p>
<p>When the outcome variable is the residual life, semiparametric quantile
models that apply the inverse probability of censoring weighting (IPCW)
principle to address right-censored observations have been explored
<span class="citation" data-cites="jung2009regression kim2012censored li2016quantile">(<a href="#ref-jung2009regression" role="doc-biblioref">Jung et al. 2009</a>; <a href="#ref-kim2012censored" role="doc-biblioref">Kim et al. 2012</a>; <a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>)</span>. These
approaches are based on non-smooth estimating functions with respect to
regression parameters, and the estimates of the regression parameters
are obtained either through zero-crossing of non-smooth estimating
functions using grid search techniques <span class="citation" data-cites="jung2009regression">(<a href="#ref-jung2009regression" role="doc-biblioref">Jung et al. 2009</a>)</span> or by
optimizing non-smooth objective functions with <span class="math inline">\(L_1\)</span>-minimization
algorithms <span class="citation" data-cites="kim2012censored li2016quantile">(<a href="#ref-kim2012censored" role="doc-biblioref">Kim et al. 2012</a>; <a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>)</span>. While these methods are
relatively straightforward to implement, an additional challenge lies in
standard error estimation, which necessitates the computationally
intensive use of a multiplier bootstrap method <span class="citation" data-cites="li2016quantile">(<a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>)</span>.
Alternatively, <span class="citation" data-cites="jung2009regression">Jung et al. (<a href="#ref-jung2009regression" role="doc-biblioref">2009</a>)</span> and <span class="citation" data-cites="kim2012censored">Kim et al. (<a href="#ref-kim2012censored" role="doc-biblioref">2012</a>)</span> utilized the
minimum dispersion statistic and the empirical likelihood method,
respectively, to bypass the need to directly estimate the variance of
the regression parameter estimator for hypothesis testing and
constructing confidence intervals. The non-smooth nature of the
estimating functions in these approaches precludes the estimation of
variance using the robust sandwich-type variance estimator typically
employed in equation-based estimation methods. To lessen the associated
computational burden, an induced smoothing was proposed
<span class="citation" data-cites="brown2005standard">(<a href="#ref-brown2005standard" role="doc-biblioref">Brown and Wang 2005</a>)</span>, which modifies the non-smooth estimating equations
into smooth ones. Leveraging the asymptotic normality of the non-smooth
estimator, the smooth estimating functions are constructed by averaging
out the random perturbations inherent in the non-smooth estimating
functions. The resulting estimating functions become smooth with respect
to the regression parameters, allowing for the straightforward
application of standard numerical algorithms, such as the Newton-Raphson
method. Furthermore, these smoothed estimating functions facilitate the
straightforward computation of variances using the robust sandwich-type
estimator. The induced smoothing approach has been employed in fitting
semiparametric accelerated failure time (AFT) models via the rank-based
approach
<span class="citation" data-cites="johnson2009induced aftgeepackage chiou2015semiparametric Kang:fitt:2016">(<a href="#ref-johnson2009induced" role="doc-biblioref">Johnson and Strawderman 2009</a>; <a href="#ref-chiou2015semiparametric" role="doc-biblioref">Chiou et al. 2015a</a>, <a href="#ref-aftgeepackage" role="doc-biblioref">2021</a>; <a href="#ref-Kang:fitt:2016" role="doc-biblioref">Kang 2017</a>)</span>.
Regarding quantile regression, <span class="citation" data-cites="choi2018smoothed">Choi et al. (<a href="#ref-choi2018smoothed" role="doc-biblioref">2018</a>)</span> considered the induced
smoothing approach under a competing-risks setting. All of these methods
are based on modeling event times. Recently, <span class="citation" data-cites="kim2023smoothed">Kim et al. (<a href="#ref-kim2023smoothed" role="doc-biblioref">2023</a>)</span> proposed
an induced smoothing estimator for fitting a semiparametric quantile
regression model for residual life.</p>
<p>The availability of published R packages for fitting quantile regression
models is somewhat limited. The <code>rq()</code>, <code>nlrq()</code>, <code>rqss()</code>, and <code>crq()</code>
functions in the package
<a href="https://CRAN.R-project.org/package=quantreg"><strong>quantreg</strong></a>
<span class="citation" data-cites="quantregpackage">(<a href="#ref-quantregpackage" role="doc-biblioref">Koenker 2022</a>)</span> are predominantly used and provide various features
for fitting linear, nonlinear, non-parametric, and censored quantile
regression models, respectively. The <code>rq()</code> function minimizes
non-smooth objective functions to obtain point estimates of regression
coefficients and can accommodate right-censored survival times by
incorporating weights. By redefining survival times as the remaining
lifetime at time <span class="math inline">\(t_0\)</span>, one can also obtain a non-smoothed estimator for
quantile regression models for residual life <span class="citation" data-cites="kim2012censored">(<a href="#ref-kim2012censored" role="doc-biblioref">Kim et al. 2012</a>)</span>. On the
other hand, the <code>nlrq()</code> function is designed to fit a nonlinear
quantile regression model, while the <code>rqss()</code> function fits additive
quantile regression models with nonparametric terms, including
univariate components and bivariate components, using smoothing splines
and total variation regularization techniques
<span class="citation" data-cites="koenker1994quantile koenker2004penalized">(<a href="#ref-koenker1994quantile" role="doc-biblioref">Koenker et al. 1994</a>; <a href="#ref-koenker2004penalized" role="doc-biblioref">Koenker and Mizera 2004</a>)</span>. Furthermore, the <code>crq()</code>
function fits a quantile regression model for censored data on the
<span class="math inline">\(\tau\)</span>-th conditional quantile function of the response variable.
Overall, the <a href="https://CRAN.R-project.org/package=quantreg"><strong>quantreg</strong></a>
implements three methods for handling right-censored survival times:
<span class="citation" data-cites="powell1986censored">Powell (<a href="#ref-powell1986censored" role="doc-biblioref">1986</a>)</span>’s estimator, <span class="citation" data-cites="portnoy2003censored">Portnoy (<a href="#ref-portnoy2003censored" role="doc-biblioref">2003</a>)</span>’s estimator and
<span class="citation" data-cites="peng2008survival">Peng and Huang (<a href="#ref-peng2008survival" role="doc-biblioref">2008</a>)</span>’s estimator. However, none of the implemented methods
in the <code>nlrq()</code>, <code>rqss()</code>, or <code>crq()</code> functions are applicable for
handling censored residual life using the induced smoothing methods. The
only function that implements the induced smoothing method is the
<code>aftsrr()</code> function in the package
<a href="https://CRAN.R-project.org/package=aftgee"><strong>aftgee</strong></a>
<span class="citation" data-cites="aftgeepackage">(<a href="#ref-aftgeepackage" role="doc-biblioref">Chiou et al. 2021</a>)</span>, but it is specifically designed for fitting
semiparametric AFT models, which are not directly applicable to fitting
quantile regression models.</p>
<p>Other R packages that can be used to fit quantile regression models for
survival data include the package
<a href="https://CRAN.R-project.org/package=ctqr"><strong>ctqr</strong></a> <span class="citation" data-cites="ctqrpackage">(<a href="#ref-ctqrpackage" role="doc-biblioref">Frumento 2021</a>)</span>,
package <a href="https://CRAN.R-project.org/package=Brq"><strong>Brq</strong></a> <span class="citation" data-cites="Brqpackage">(<a href="#ref-Brqpackage" role="doc-biblioref">Alhamzawi 2020</a>)</span>,
package <a href="https://CRAN.R-project.org/package=brms"><strong>brms</strong></a>
<span class="citation" data-cites="brmspackage">(<a href="#ref-brmspackage" role="doc-biblioref">Bürkner 2018</a>)</span>, and package
<a href="https://CRAN.R-project.org/package=cmprskQR"><strong>cmprskQR</strong></a>
<span class="citation" data-cites="cmprskQRpackage">(<a href="#ref-cmprskQRpackage" role="doc-biblioref">Dlugosz et al. 2019</a>)</span>. The <code>ctqr()</code> function in the package
<a href="https://CRAN.R-project.org/package=ctqr"><strong>ctqr</strong></a> implements the
methods proposed in <span class="citation" data-cites="ctqrpackage">Frumento (<a href="#ref-ctqrpackage" role="doc-biblioref">2021</a>)</span> for right or interval-censored failure
times with left-truncation. The <code>Bqr()</code> function in the package
<a href="https://CRAN.R-project.org/package=Brq"><strong>Brq</strong></a> implements Bayesian
methods based on the asymmetric Laplace distribution. In the package
<a href="https://CRAN.R-project.org/package=brms"><strong>brms</strong></a>, the <code>brm()</code>
function with the <code>family=asym_laplace()</code> option enables the
implementation of full Bayesian inference. The <code>crrQR()</code> function in the
package <a href="https://CRAN.R-project.org/package=cmprskQR"><strong>cmprskQR</strong></a>
allows fitting quantile regression models with competing risks. All of
these R packages are designed for fitting quantile regression models for
failure times defined from a baseline and are not applicable to the
residual life setting.</p>
<p>The recently developed R package
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> <span class="citation" data-cites="R:qris">(<a href="#ref-R:qris" role="doc-biblioref">Kim et al. 2022</a>)</span> provides
an efficient tool for fitting semiparametric quantile regression models
for residual life subject to right censoring. The
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package offers three
methods for estimating the regression parameters: <span class="math inline">\(L_1\)</span>-minimization of
non-smooth objective functions, induced smoothing with a non-iterative
approach, and an iterative procedure. For standard error estimation, the
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package provides two
resampling-based approaches: the partial multiplier bootstrap and the
full multiplier bootstrap methods. The partial multiplier bootstrap
method utilizes the robust sandwich-type estimator by incorporating the
sample variance of perturbed estimating functions, while the full
multiplier bootstrap method is obtained by considering the sample
variance from the solutions of perturbed estimating functions. To
enhance the interpretability of results, the
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package incorporates
graphical visualizations of covariate effects at different quantiles and
base times, utilizing the plotting environment similar to that in the
<a href="https://CRAN.R-project.org/package=ggplot2"><strong>ggplot2</strong></a> package
<span class="citation" data-cites="ggplot2package">(<a href="#ref-ggplot2package" role="doc-biblioref">Wickham et al. 2022</a>)</span>, thereby allowing for extensive flexibility and
customization. The ultimate goal of creating the
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package is to
facilitate the easy incorporation of quantile regression for residual
life into daily routines. The package
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> is available on the
Comprehensive R Archive Network (CRAN) at
<a href="https://CRAN.R-project.org/package=qris" class="uri">https://CRAN.R-project.org/package=qris</a>.</p>
<p>The rest of the article is organized as follows: Section <a href="#sec:nsm">2</a>
introduces a semiparametric regression model for quantiles of residual
life and the estimation methods implemented in the package.
Section <a href="#sec:implementation">3</a> provides details about computing
algorithms. Illustrations of the package using a simulated dataset and
the real data from the North Central Cancer Treatment Group are
presented in Section <a href="#sec:illustration">4</a>. Finally, in
Section <a href="#sec:conclusion">5</a>, concluding remarks are provided along with
some discussions.</p>
<h3 data-number="2" id="sec:nsm"><span class="header-section-number">2</span> Semiparametric quantile regression for residual life</h3>
<p>Define <span class="math inline">\(T\)</span> as the potential failure time that is subject to right
censoring by <span class="math inline">\(C\)</span> and <span class="math inline">\(\mathbf{X}\)</span> as a <span class="math inline">\(p \times 1\)</span> vector of
covariates, where <span class="math inline">\(p\)</span> is the number of covariates, including an
intercept. The observed data consists of <span class="math inline">\(n\)</span> independent copies of
<span class="math inline">\((Z, \delta, \mathbf{X})\)</span>, where <span class="math inline">\(Z = \min(T, C)\)</span>,
<span class="math inline">\(\delta = I(T \leq C)\)</span>, and <span class="math inline">\(I(\cdot)\)</span> is an indicator function. We also
assume <span class="math inline">\(T\)</span> and <span class="math inline">\(C\)</span> are marginally independent. Define the <span class="math inline">\(\tau\)</span>-th
quantile of the residual life at <span class="math inline">\(t_0 &gt; 0\)</span> as <span class="math inline">\(\theta_{\tau}(t_0)\)</span> that
satisfies
<span class="math inline">\(P(T_i - t_0 \geq \theta_{\tau}(t_0) \ | \ T_i &gt; t_0) = 1 - \tau\)</span>. We
consider the semiparametric quantile regression model for the residual
life <span class="citation" data-cites="kim2012censored kim2023smoothed">(<a href="#ref-kim2012censored" role="doc-biblioref">Kim et al. 2012</a>; <a href="#ref-kim2023smoothed" role="doc-biblioref">Kim et al. 2023</a>)</span>. Given <span class="math inline">\(T_i &gt; t_0\)</span>,
<span class="math display" id="eq:qrmod1">\[\label{qr:mod1}
  \log(T_i - t_0) = \mathbf{X}_{i}^{\top}\boldsymbol{\mathbf{\beta}}_0(\tau, t_0) + \epsilon_i, i = 1, \ldots, n, %\label{qr:mod2}   \tag{1}\]</span>
where <span class="math inline">\(\boldsymbol{\mathbf{\beta}}_0(\tau, t_0)\)</span> is a <span class="math inline">\(p \times 1\)</span>
vector of regression coefficients, and <span class="math inline">\(\epsilon_i\)</span> is a random error
having zero <span class="math inline">\(\tau\)</span>-th quantile. The quantile regression model for a
continuous response <span class="citation" data-cites="koenker1978regression">(<a href="#ref-koenker1978regression" role="doc-biblioref">Koenker and Bassett Jr 1978</a>)</span> is a special case of
Equation <a href="#eq:qrmod1">(1)</a> when <span class="math inline">\(t_0 = 0\)</span>. For ease of notation, we omit
<span class="math inline">\(\tau\)</span> and <span class="math inline">\(t_0\)</span> in <span class="math inline">\(\boldsymbol{\mathbf{\beta}}_0(\tau, t_0)\)</span> and
<span class="math inline">\(\theta_{\tau}(t_0)\)</span> and write <span class="math inline">\(\boldsymbol{\mathbf{\beta}}_0\)</span> and
<span class="math inline">\(\theta\)</span>. We present different estimation procedures to estimate
<span class="math inline">\(\boldsymbol{\mathbf{\beta}}_0\)</span> given <span class="math inline">\(\tau\)</span> and <span class="math inline">\(t_0\)</span> in the following.</p>
<h4 class="unnumbered" data-number="2.1" id="sec:nsm:pt">Estimation using non-smooth functions</h4>
<p>When there is no censoring, an estimator for <span class="math inline">\(\beta_0\)</span> in
Equation <a href="#eq:qrmod1">(1)</a> can be obtained by solving the estimating
equation <span class="citation" data-cites="kim2012censored">(<a href="#ref-kim2012censored" role="doc-biblioref">Kim et al. 2012</a>)</span>, where
<span class="math display" id="eq:nsobj1">\[\label{eq:ns:obj1}
  \frac{1}{n}\sum_{i=0}^{n}I[T_i \ge t_0] \mathbf{X}_i \left\{I\left[\log(T_i - t_0) \leq \mathbf{X}_i^{\top}\boldsymbol{\mathbf{\beta}} \right] - \tau \right\} = 0.   \tag{2}\]</span>
However, Equation <a href="#eq:nsobj1">(2)</a> cannot be directly used when
<span class="math inline">\(T_i - t_0\)</span> is subject to right censoring. The IPCW technique can be
incorporated into Equation <a href="#eq:nsobj1">(2)</a> to account for the right
censoring <span class="citation" data-cites="li2016quantile">(<a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>)</span>. Specifically, in the presence of right
censoring, the estimator for <span class="math inline">\(\boldsymbol{\mathbf{\beta}}_0\)</span> in
Equation <a href="#eq:qrmod1">(1)</a> can be obtained as the root of the following
weighted estimating equations:
<span class="math display" id="eq:nsmipw">\[\label{eq:nsm:ipw}
  U_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau) = \frac{1}{n}\sum_{i=1}^{n}I[Z_i \ge t_0] \mathbf{X}_i  \left\{I \left[\log(Z_i - t_0) \leq \mathbf{X}_i^{\top} \boldsymbol{\mathbf{\beta}} \right]\frac{\delta_i}{\widehat{G}(Z_i)/\widehat{G}(t_0)}  -\tau \right\},   \tag{3}\]</span>
where <span class="math inline">\(\widehat{G}(\cdot)\)</span> is the Kaplan-Meier estimate of the survival
function <span class="math inline">\(G(\cdot)\)</span> of the censoring time <span class="math inline">\(C\)</span> and
<span class="math inline">\(\widehat{G}(t) = \prod_{i: t_i \leq t} (1 - \sum_{j=1}^n (1 - \delta_j)I(Z_j \leq t_i) / \sum_{j=1}^n I(Z_j \geq t_i))\)</span>.
A computational challenge arises because the exact solution to
Equation <a href="#eq:nsmipw">(3)</a> might not exist due to the non-smoothness in
<span class="math inline">\(\beta\)</span> caused by the involvement of indicator functions. When the exact
solutions do not exist, the root of Equation <a href="#eq:nsmipw">(3)</a> can be
approximated by minimizing the <span class="math inline">\(L_1\)</span>-objective function
<span class="math inline">\(L_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau)\)</span> <span class="citation" data-cites="li2016quantile">(<a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>)</span>,
<span class="math display" id="eq:l1nsm">\[\begin{aligned}
  \label{l1:nsm}
  \nonumber
  L_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau) = &amp; \frac{1}{n}\sum_{i=1}^n \frac{\delta_i I[Z_i &gt; t_0]}{\widehat{G}(Z_i)/\widehat{G}(t_0)} \left| \log(Z_i - t_0) - \mathbf{X}_i^{\top}\beta \right| + \\
                              &amp; \left| M - \boldsymbol{\mathbf{\beta}}^{\top}\sum_{l=1}^n - \mathbf{X}_l \frac{\delta_l I[Z_l &gt; t_0]}{\widehat{G}(Z_l)/\widehat{G}(t_0)}\right|
                                + \ \left| M - \boldsymbol{\mathbf{\beta}}^{\top}\sum_{l=1}^n 2\tau \mathbf{X}_l I[Z_l &gt; t_0]\right|,
\end{aligned}   \tag{4}\]</span>
where <span class="math inline">\(M &gt; 0\)</span> bounds
<span class="math inline">\(\left| \boldsymbol{\mathbf{\beta}}^{\top}\sum_{i=1}^n - \mathbf{X}_i \frac{\delta_i I[Z_i &gt; t_0]}{\widehat{G}(Z_i)/ \widehat{G}(t_0)}\right|\)</span>
and
<span class="math inline">\(\left| \boldsymbol{\mathbf{\beta}}^{\top}\sum_{i=1}^n 2\tau \mathbf{X}_i I[Z_i &gt; t_0]\right|\)</span>
from above. Numerically, the limit <span class="math inline">\(M\)</span> is set to be an extremely large
number, and the <code>qris()</code> function uses <span class="math inline">\(M = 10^6\)</span>. Denote the resulting
estimator to be <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny NS}\)</span>. It
has been shown that <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny NS}\)</span>
is consistent for <span class="math inline">\(\boldsymbol{\mathbf{\beta}}_0\)</span> and asymptotically
normally distributed <span class="citation" data-cites="li2016quantile">(<a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>)</span>.</p>
<p>Despite the well-established asymptotic properties, directly estimating
the variance of <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny NS}\)</span> is
impractical because it involves the derivative of non-smooth functions.
A multiplier bootstrap method has typically been employed
<span class="citation" data-cites="li2016quantile">(<a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>)</span> to address this difficulty. The multiplier bootstrap
method considers the perturbed version of <span class="math inline">\(U_{t_0}(\beta, \tau)\)</span>,
defined as
<span class="math display" id="eq:nsmrev">\[\label{eq:nsm:rev}
  U_{t_0}^{\ast}(\beta, \tau) = \frac{1}{n}\sum_{i=1}^{n} \eta_i I[Z_i \ge t_0] \mathbf{X}_i  \left\{I \left[\log(Z_i - t_0) \leq \mathbf{X}_i^{\top} \boldsymbol{\mathbf{\beta}} \right]\frac{\delta_i}{\widehat{G}^{\ast}(Z_i)/\widehat{G}^{\ast}(t_0)}  -\tau \right\},   \tag{5}\]</span>
where <span class="math inline">\(\eta_i, i = 1, \ldots, n,\)</span> are independently and identically
(iid) generated from a positive random variable with unity mean and
variance, and <span class="math inline">\(\widehat{G}^\ast(\cdot)\)</span> is a perturbed version of
<span class="math inline">\(\widehat{G}(\cdot)\)</span>, constructed as <span class="math inline">\(\widehat{G}^\ast(t) =
\prod_{i: t_i \leq t} (1 - \sum_{j=1}^n \eta_j(1 - \delta_j)I(Z_j \leq t_i) / \sum_{j=1}^n \eta_jI(Z_j \geq t_i))\)</span>
for a given realization of <span class="math inline">\(\eta_i\)</span>. On the other hand, a perturbed
<span class="math inline">\(L_1\)</span>-objective function, denoted as
<span class="math inline">\(L_{t_0}^{\ast}(\boldsymbol{\mathbf{\beta}}, \tau)\)</span>, can be similarly
constructed, where
<span class="math display">\[\begin{aligned}
  L_{t_0}^{\ast}(\boldsymbol{\mathbf{\beta}}, \tau) = &amp; \frac{1}{n}\sum_{i=1}^n \frac{\delta_i I[Z_i &gt; t_0]}{\widehat{G}^{\ast}(Z_i)/\widehat{G}^{\ast}(t_0)} \left| \log(Z_i - t_0) - \mathbf{X}_i^{\top}\boldsymbol{\mathbf{\beta}} \right| + \nonumber \\
                                     &amp; \left| M - \boldsymbol{\mathbf{\beta}}^{\top}\sum_{l=1}^n - \mathbf{X}_l \frac{\delta_l I[Z_l &gt; t_0]}{\widehat{G}^{\ast}(Z_l)/\widehat{G}^{\ast}(t_0)}\right|
                                       + \ \left| M - \beta^{\top}\sum_{l=1}^n 2\tau \mathbf{X}_l \eta_l I[Z_l &gt; t_0]\right|.
\end{aligned}\]</span>
Solving for <span class="math inline">\(U_{t_0}^{\ast}(\boldsymbol{\mathbf{\beta}}, \tau) = 0\)</span>, or
equivalently, minimizing
<span class="math inline">\(L_{t_0}^{\ast}(\boldsymbol{\mathbf{\beta}}, \tau)\)</span>, yields one
realization of <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny NS}\)</span>. The
multiplier bootstrap variance is computed as the sample variance of a
large number of realizations of
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny NS}\)</span>.</p>
<h4 class="unnumbered" data-number="2.2" id="sec:IS:pt">Estimation using induced smoothed functions</h4>
<p>The regression coefficient in Equation <a href="#eq:qrmod1">(1)</a> can be more
efficiently obtained through the induced smoothed version of
Equation <a href="#eq:nsmipw">(3)</a>. The induced smoothed estimating functions are
constructed by taking the expectation with respect to a mean-zero random
noise added to the regression parameters in Equation <a href="#eq:nsmipw">(3)</a>.
Specifically,
<span class="math display" id="eq:is">\[\begin{aligned}
\label{eq:is}
  \widetilde{U}_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau, H) &amp; = E_w \{U_{t_0}(\boldsymbol{\mathbf{\beta}}+\mathbf{H}^{1/2}\mathbf{W}, \tau)\}\nonumber\\
                                           &amp; = \frac{1}{n} \sum_{i=1}^{n} I[Z_i &gt; t_0] \mathbf{X}_i \left\{ \Phi\left(\frac{\mathbf{X}_i^\top\boldsymbol{\mathbf{\beta}}-\log(Z_i-t_0)}{\sqrt{\mathbf{X}_i^{\top} \mathbf{H} \mathbf{X}_{i}}}\right)\frac{\delta_i}{\widehat{G}(Z_i)/\widehat{G}(t_0) }  -\tau \right\},
\end{aligned}   \tag{6}\]</span>
where <span class="math inline">\(\mathbf{H} = O(n^{-1})\)</span>, <span class="math inline">\(\mathbf{W} \sim N(0, \mathbf{I}_p)\)</span> is
a standard normal random vector, <span class="math inline">\(\mathbf{I}_p\)</span> is the <span class="math inline">\(p \times p\)</span>
identity matrix, and <span class="math inline">\(\Phi(\cdot)\)</span> is the cumulative distribution
function of a standard normal random variable. A typical choice for
<span class="math inline">\(\mathbf{H}\)</span> is to fix it at <span class="math inline">\(n^{-1}\mathbf{I}_p\)</span>, while some
alternative choices are explored in <span class="citation" data-cites="chiou2015rank">Chiou et al. (<a href="#ref-chiou2015rank" role="doc-biblioref">2015b</a>)</span>. Let
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span> be the solution to
<span class="math inline">\(\widetilde{U}_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau, \mathbf{H}) = 0\)</span>.
Since Equation <a href="#eq:is">(6)</a> is a smooth function in
<span class="math inline">\(\boldsymbol{\mathbf{\beta}}\)</span>, the estimator can be obtained using
standard numerical algorithms such as the Newton-Raphson method.
Moreover, the induced smoothed estimator for
<span class="math inline">\(\boldsymbol{\mathbf{\beta}}_0\)</span> has been shown to be asymptotically
equivalent to its non-smooth counterpart <span class="citation" data-cites="kim2023smoothed">(<a href="#ref-kim2023smoothed" role="doc-biblioref">Kim et al. 2023</a>)</span>.</p>
<p>Following the idea in Section <a href="#sec:nsm:pt">2.1</a>, the multiplier
bootstrap procedure can be similarly employed to estimate the variance
of <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span>. The perturbed
version of Equation <a href="#eq:is">(6)</a> takes the form of
<span class="math display" id="eq:7">\[\label{eq:7}
  \widetilde{U}^{\ast}_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau, \mathbf{H}) = \frac{1}{n} \sum_{i=1}^{n} \eta_i I[Z_i &gt; t_0] \mathbf{X}_i  \left\{ \Phi\left(\frac{\mathbf{X}_i^\top\boldsymbol{\mathbf{\beta}} - \log(Z_i-t_0)}{\sqrt{\mathbf{X}_i^{\top} \mathbf{H} \mathbf{X}_{i}}}\right)\frac{\widehat{G}^{\ast}(t_0) \delta_i}{\widehat{G}^{\ast}(Z_i)} -\tau \right\}.   \tag{7}\]</span>
The multiplier bootstrap procedure estimates the variance of
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span> by calculating the
sample variance of a large number of realizations of
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span> obtained by
repeatedly solving Equation <a href="#eq:7">(7)</a>.</p>
<p>It has been shown that the asymptotic variance
<span class="math inline">\(\mathop{\rm Var}\nolimits(\boldsymbol{\mathbf{\beta}}, \tau)\)</span> can be
decomposed into
<span class="math inline">\(\mathbf{A}(\boldsymbol{\mathbf{\beta}})^{\top} \mathbf{V}(\boldsymbol{\mathbf{\beta}}) \mathbf{A}(\boldsymbol{\mathbf{\beta}})\)</span>
<span class="citation" data-cites="kim2023smoothed">(<a href="#ref-kim2023smoothed" role="doc-biblioref">Kim et al. 2023</a>)</span>, where the two components,
<span class="math inline">\(\mathbf{A}(\boldsymbol{\mathbf{\beta}})\)</span> and
<span class="math inline">\(\mathbf{V}(\boldsymbol{\mathbf{\beta}})\)</span>, can be estimated separately.
Since Equation <a href="#eq:is">(6)</a> is a smooth function in
<span class="math inline">\(\boldsymbol{\mathbf{\beta}}\)</span>, the slope matrix,
<span class="math inline">\(\mathbf{A}(\boldsymbol{\mathbf{\beta}})\)</span>, can be conveniently estimated
by differentiating
<span class="math inline">\(\widetilde{U}_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau, \mathbf{H})\)</span>
with respect to <span class="math inline">\(\boldsymbol{\mathbf{\beta}}\)</span>. The explicit form of
<span class="math inline">\(\mathbf{A}(\boldsymbol{\mathbf{\beta}})\)</span> is as follows:
<span class="math display" id="eq:covslp">\[\begin{aligned}
\label{eq:cov:slp}
  \mathbf{A}(\boldsymbol{\mathbf{\beta}}) &amp; = \frac{\partial \widetilde{U}_{t_0}(\boldsymbol{\mathbf{\beta}}, \tau, \mathbf{H})}{\partial \boldsymbol{\mathbf{\beta}}} \nonumber \\
                       &amp; = \frac{1}{n}\sum_{i=1}^{n} I[Z_i &gt; t_0] \mathbf{X}_i \frac{G(t_0) \delta_i}{G(Z_i)} \phi\left(\frac{{\mathbf{X}_i}^{\top}\boldsymbol{\mathbf{\beta}} - \log(Z_i-t_0)}{\sqrt{{\mathbf{X}_i}^{\top}\mathbf{H} \mathbf{X}_i}}\right)\left(\frac{-{\mathbf{X}_i}}{\sqrt{{\mathbf{X}_i}^{\top} \mathbf{H} {\mathbf{X}_i}}}\right),
\end{aligned}   \tag{8}\]</span>
where <span class="math inline">\(\phi (\cdot)\)</span> is the density function of the standard normal
random variable.</p>
<p>The slope matrix,
<span class="math inline">\(\widehat{\mathbf{A}}(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS})\)</span>,
can be evaluated directly by plugging in
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span> and
<span class="math inline">\(\widehat{G}(\cdot)\)</span>. On the other hand, the variance of the estimating
function, <span class="math inline">\(\widehat{\mathbf{V}}(\boldsymbol{\mathbf{\beta}})\)</span>, can be
obtained by a computationally efficient resampling method motivated by
the multiplier bootstrap procedure in Section <a href="#sec:nsm:pt">2.1</a>.
Specifically, we propose estimating
<span class="math inline">\(\widehat{\mathbf{V}}(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS})\)</span>
as the simple variance of a large set of realizations of the perturbed
version of
<span class="math inline">\(\widetilde{U}_{t_0}(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}, \tau, \mathbf{H})\)</span>
presented in Equation <a href="#eq:7">(7)</a>. We refer to this procedure as the
partial multiplier bootstrapping approach because it utilizes the
perturbed estimating function, similar to the full multiplier
bootstrapping approach, but the computation of
<span class="math inline">\(\widehat{\mathbf{A}}(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS})\)</span>
and
<span class="math inline">\(\widehat{\mathbf{V}}(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS})\)</span>
does not involve the repeated solving of the perturbed estimating
equations. Thus, the partial multiplier bootstrapping approach is
expected to be computationally more efficient than the multiplier
bootstrap method. A similar procedure and its performance have been
studied in modeling failure times with semiparametric AFT models
<span class="citation" data-cites="chiou2014fast aftgeepackage">(<a href="#ref-chiou2014fast" role="doc-biblioref">Chiou et al. 2014</a>, <a href="#ref-aftgeepackage" role="doc-biblioref">2021</a>)</span>.</p>
<h4 class="unnumbered" data-number="2.3" id="sec:iter">Iterative procedure in induced smoothing estimation</h4>
<p>The induced estimator <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span>
is obtained with a fixed <span class="math inline">\(\mathbf{H}\)</span>, as described in
Section <a href="#sec:IS:pt">2.2</a>, and its variance is estimated separately.
This estimation procedure can be viewed as a special case of the
following iterative procedure, which updates <span class="math inline">\(\mathbf{H}\)</span> and
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span> iteratively.
Specifically, the iterative algorithm utilizes the Newton-Raphson method
while sequentially updating
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS}\)</span> and
<span class="math inline">\(\widehat{\mathop{\rm Var}\nolimits}(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IS})\)</span>
until convergence. Similar iterative algorithms have also been
considered previously in the induced smoothing approach for
semiparametric AFT models
<span class="citation" data-cites="johnson2009induced chiou2014fast chiou2015semiparametric choi2018smoothed">(<a href="#ref-johnson2009induced" role="doc-biblioref">Johnson and Strawderman 2009</a>; <a href="#ref-chiou2014fast" role="doc-biblioref">Chiou et al. 2014</a>, <a href="#ref-chiou2015semiparametric" role="doc-biblioref">2015a</a>; <a href="#ref-choi2018smoothed" role="doc-biblioref">Choi et al. 2018</a>)</span>.
The iterative procedure is summarized as follows:</p>
<dl>
<dt><strong>Step 1:</strong></dt>
<dd>
<p>Set the initial values
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}^{(0)}\)</span>,
<span class="math inline">\(\widehat{\mathbf{\Sigma}}^{(0)} = \mathbf{I}_{p}\)</span>, and
<span class="math inline">\(\mathbf{H}^{(0)} = n^{-1}\widehat{\mathbf{\Sigma}}^{(0)}\)</span>.</p>
</dd>
<dt><strong>Step 2:</strong></dt>
<dd>
<p>Given <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k)}\)</span> and
<span class="math inline">\(\mathbf{H}^{(k)}\)</span> at the <span class="math inline">\(k\)</span>-th step, update
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k)}\)</span> by
<span class="math display">\[\widehat{\boldsymbol{\mathbf{\beta}}}^{(k+1)}=\widehat{\boldsymbol{\mathbf{\beta}}}^{(k)} - \widehat{\mathbf{A}}(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k)})^{-1}{\widetilde{U}_{t_0}(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k)}, \tau, \mathbf{H}^{(k)}}).\]</span></p>
</dd>
<dt><strong>Step 3:</strong></dt>
<dd>
<p>Given <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k+1)}\)</span> and
<span class="math inline">\(\widehat{\mathbf{\Sigma}}^{(k)}\)</span>, update
<span class="math inline">\(\widehat{\mathbf{\Sigma}}^{(k)}\)</span> by
<span class="math display">\[\widehat{\mathbf{\Sigma}}^{(k+1)} = \widehat{\mathbf{A}}(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k+1)})^{-1} \widehat{\mathbf{V}}(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k+1)}, \tau) \widehat{\mathbf{A}}(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k+1)})^{-1}.\]</span></p>
</dd>
<dt><strong>Step 4:</strong></dt>
<dd>
<p>Set <span class="math inline">\(\mathbf{H}^{(k+1)} = n^{-1}\widehat{\mathbf{\Sigma}}^{(k+1)}\)</span>.
Repeat Steps 2, 3 and 4 until
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k)}\)</span> and
<span class="math inline">\(\widehat{\mathbf{\Sigma}}^{(k)}\)</span> converge.</p>
</dd>
</dl>
<p>The initial value, <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}^{(0)}\)</span>, could
be chosen as <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny NS}\)</span>. We
define <span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IT}\)</span> and
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\Sigma}}}_{\tiny IT}\)</span> as the values of
<span class="math inline">\(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k)}\)</span> and
<span class="math inline">\(\widehat{\mathbf{\Sigma}}^{(k)}\)</span> at convergence, and
<span class="math inline">\(\widehat{\mathop{\rm Var}\nolimits}(\widehat{\boldsymbol{\mathbf{\beta}}}_{\tiny IT}) = n^{-1}\widehat{\mathbf{\Sigma}}_{\tiny IT}\)</span>.
In Step 3,
<span class="math inline">\(\widehat{\mathbf{V}}(\widehat{\boldsymbol{\mathbf{\beta}}}^{(k+1)}, \tau)\)</span>
is obtained using the partial multiplier bootstrap approach. However,
the full multiplier bootstrap approach can also be employed but would
require longer computation times.</p>
<h3 data-number="3" id="sec:implementation"><span class="header-section-number">3</span> Package implementation</h3>
<p>The main function in the
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package for
estimating the regression parameters in the quantile regression model
for residual life is the <code>qris()</code> function. The <code>qris()</code> function is
written in C++ and incorporated into R using the
<a href="https://CRAN.R-project.org/package=Rcpp"><strong>Rcpp</strong></a> <span class="citation" data-cites="Rcpppackage">(<a href="#ref-Rcpppackage" role="doc-biblioref">Eddelbuettel et al. 2022a</a>)</span> and
<a href="https://CRAN.R-project.org/package=RcppArmadillo"><strong>RcppArmadillo</strong></a>
<span class="citation" data-cites="RcppArmadillopackage">(<a href="#ref-RcppArmadillopackage" role="doc-biblioref">Eddelbuettel et al. 2022b</a>)</span> packages. The synopsis of <code>qris</code> is:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/args.html'>args</a></span><span class='op'>(</span><span class='va'>qris</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>function (formula, data, t0 = 0, Q = 0.5, nB = 100, method = c(&quot;smooth&quot;, 
    &quot;iterative&quot;, &quot;nonsmooth&quot;), se = c(&quot;fmb&quot;, &quot;pmb&quot;), init = c(&quot;rq&quot;, 
    &quot;noeffect&quot;), verbose = FALSE, control = qris.control()) 
NULL</code></pre>
</div>
<p>The required argument is <code>formula</code>, which specifies the quantile
regression model to be fitted using the variables in <code>data</code>. The
<code>formula</code> assumes that the response variable is a ‘<code>Surv</code>’ object
created by the <code>Surv()</code> function in the
<a href="https://CRAN.R-project.org/package=survival"><strong>survival</strong></a> package
<span class="citation" data-cites="survivalpackage">(<a href="#ref-survivalpackage" role="doc-biblioref">Therneau 2021</a>)</span>. This formula structure is commonly adopted for
handling survival data in R, as seen in functions like <code>survreg()</code> and
<code>coxph()</code> in the
<a href="https://CRAN.R-project.org/package=survival"><strong>survival</strong></a> package. The
argument <code>t0</code> specifies the base time used in defining residual life.
The default value of <code>t0</code> is set to zero, in which case residual life
reduces to a failure time. The <code>Q</code> argument is used to specify the
target quantile of residual life to estimate, with the default value
being set to 0.5 (median). The <code>nB</code> argument specifies the bootstrapping
size used in standard error estimation, with the default value set to
100. The <code>method</code> argument specifies one of the three estimation
methods: <code>"nonsmooth"</code>, <code>"smooth"</code>, and <code>"iterative"</code>, corresponding to
the estimating procedures outlined in Sections <a href="#sec:nsm:pt">2.1</a>,
<a href="#sec:IS:pt">2.2</a>, and <a href="#sec:iter">2.3</a>, respectively. Given the point
estimates of the regression parameters, their standard errors can be
estimated using one of two implemented methods: <code>se = "fmb"</code> and
<code>se = "pmb"</code>. The <code>se = "fmb"</code> method employs a full-multiplier
bootstrapping approach to estimate the variance by the sample variance
of large realizations of <span class="math inline">\(\widehat\beta\)</span>. The <code>se = "pmb"</code> method
estimates the variance using a robust sandwich variance estimator and
employs the computationally efficient partial multiplier bootstrapping
approach described in Section <a href="#sec:IS:pt">2.2</a>. The <code>"fmb"</code> option is
available for all three point estimation methods, whereas the <code>"pmb"</code>
option is not available for the <code>"nonsmooth"</code> point estimation method
due to the lack of a closed-form sandwich variance estimator. The <code>init</code>
argument allows users to specify the initial value for estimating
regression parameters by either a <span class="math inline">\(p\)</span>-dimensional numerical vector or a
character string. In the latter case, the options <code>init = "rq"</code> and
<code>init = "noeffect"</code> correspond to the point estimate obtained from the
<code>rq()</code> function in the
<a href="https://CRAN.R-project.org/package=quantreg"><strong>quantreg</strong></a> package and
a <span class="math inline">\(p\)</span>-dimensional vector of zeros, respectively. The default value for
<code>init</code> is <code>init = "rq"</code>. Among the three methods implemented for point
estimation, <code>method = "smooth"</code> and <code>method = "nonsmooth"</code> are
non-iterative, in the sense that point estimation is performed
separately from the estimation of standard errors. On the other hand,
<code>method = "iterative"</code> calculates point estimates and the corresponding
standard error estimates simultaneously through iterative updates. When
<code>method = "iterative"</code>, users can define specific convergence criteria
using <code>qris.control()</code>. The available options in <code>qris.control()</code> are as
follows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/args.html'>args</a></span><span class='op'>(</span><span class='va'>qris.control</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>function (maxiter = 10, tol = 0.001, trace = FALSE) 
NULL</code></pre>
</div>
<p>The <code>maxiter</code> argument specifies the maximum number of iterations. The
default value for <code>maxiter</code> is ten, as the proposed algorithm typically
converges within ten steps based on our exploration. The convergence
tolerance is controlled using the <code>tol</code> argument, which has a default
value of <code>1e-3</code>. The <code>trace</code> argument takes a logical value and is used
to determine whether to print the result for each iteration. The default
setting is <code>trace = FALSE</code>. The ‘<code>qris</code>’ object is fully compatible with
many of R’s generic functions, including <code>coef()</code>, <code>confint()</code>,
<code>plot()</code>, <code>predict()</code>, <code>print()</code>, <code>residuals()</code>, <code>summary()</code>, and
<code>vcov()</code>.</p>
<p>Among the available <code>S3</code> methods, a unique feature of the
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package’s <code>S3 plot</code>
method, when applied to a ‘<code>qris</code>’ object, is its ability to
automatically update the original object by extending the range of
<span class="math inline">\(\tau\)</span> or <span class="math inline">\(t_0\)</span> values. This extension enables the generation of a
covariate effect plot over the newly specified values of <span class="math inline">\(\tau\)</span> or
<span class="math inline">\(t_0\)</span>, providing a comprehensive visualization of the covariate effects
across the extended range. The <code>S3</code> method for plotting a ‘<code>qris</code>’
object is shown below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/getAnywhere.html'>argsAnywhere</a></span><span class='op'>(</span><span class='va'>plot.qris</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>function (x, t0s = NULL, Qs = NULL, nB = NULL, vari = NULL, byQs = FALSE, 
    ggextra = NULL, ...) 
NULL</code></pre>
</div>
<p>The argument <code>x</code> is a ‘<code>qris</code>’ object created using the <code>qris()</code>
function. The <code>t0s</code> and <code>Qs</code> arguments are numeric vectors that enable
users to specify the values of <span class="math inline">\(t_0\)</span> or <span class="math inline">\(\tau\)</span> for plotting the
covariate effect. If <code>t0s</code> and <code>Qs</code> are not specified, the covariate
effects are plotted against <span class="math inline">\(\tau = 0.1, 0.2, \ldots, 0.9\)</span> at the base
time (<span class="math inline">\(t_0\)</span>) inherited from the ‘<code>qris</code>’ object specified in <code>x</code>. The
<code>nB</code> argument is a numerical variable that controls the sample size for
bootstrapping, used to compute standard error estimations based on the
variance estimation specified in the original ‘<code>qris</code>’ object. When <code>nB</code>
is specified, the function calculates standard errors for all
combinations of <span class="math inline">\(t_0\)</span> and <span class="math inline">\(\tau\)</span> specified in <code>t0s</code> and <code>Qs</code>, computes
95% confidence intervals accordingly, and includes them in the covariate
effect plot. The <code>vari</code> argument is a character string that allows users
to specify the names of the covariates they want to display in the
effect plots. When the <code>vari</code> argument is not specified, all covariates
will be included in the plots by default. The coefficient event plot can
be plotted against the specified quantiles by setting <code>byQs = TRUE</code> or
against the specified base times by setting <code>byQs = FALSE</code>. Finally, the
<code>ggextra</code> argument allows users to pass additional graphical parameters
to the <a href="https://CRAN.R-project.org/package=ggplot2"><strong>ggplot2</strong></a>
package, offering further customization options for the plots. When the
<code>plot()</code> function is called, it internally invokes the <code>qris.extend()</code>
function to compute the covariate effects at additional values. The
syntax for the <code>qris.extend()</code> function is provided below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/args.html'>args</a></span><span class='op'>(</span><span class='va'>qris.extend</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>function (x, t0s = NULL, Qs = NULL, nB = NULL, vari = NULL) 
NULL</code></pre>
</div>
<p>The arguments in <code>qris.extend()</code> are inherited from the arguments
specified in the <code>plot()</code> function. To reduce runtime when repeatedly
calling the <code>plot()</code>, one can calculate the desired covariate effects by
applying <code>qris.extend()</code> outside of <code>plot()</code> first and then supply the
results to <code>plot()</code>. This approach allows for pre-computation of the
covariate effects, making it more efficient when generating multiple
plots. Overall, the unique plotting feature in
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> provides users with
a seamless and effortless approach to conducting a comprehensive
assessment of the covariate effects across different quantiles or base
times.</p>
<h3 data-number="4" id="sec:illustration"><span class="header-section-number">4</span> Illustration</h3>
<h4 class="unnumbered" data-number="4.1" id="subsec:simulation">Simulated data</h4>
<p>In this subsection, we present a simple simulation example to validate
the implementations in the proposed
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package. The
simulation involves five covariates, denoted as <span class="math inline">\(X_1, \ldots, X_5\)</span>.
Among these covariates, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_4\)</span> follow a standard uniform
distribution, <span class="math inline">\(X_2\)</span> follows a binomial distribution with a success
probability of 0.5, <span class="math inline">\(X_3\)</span> follows a standard normal distribution, and
<span class="math inline">\(X_5\)</span> follows a standard exponential distribution. We assume that
<span class="math inline">\(X_2, X_3, X_4\)</span>, and <span class="math inline">\(X_5\)</span> do not impact the residual life, meaning
their corresponding coefficient values <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\beta_3\)</span>, <span class="math inline">\(\beta_4\)</span>,
and <span class="math inline">\(\beta_5\)</span> are zero. The survival time <span class="math inline">\(T\)</span> is generated from a
Weibull distribution with the survival function
<span class="math inline">\(S(t) = \exp\{-(\rho t)^\kappa\}\)</span> for <span class="math inline">\(t &gt; 0\)</span>, where <span class="math inline">\(\kappa = 2\)</span>, and
<span class="math inline">\(\rho\)</span> is obtained by solving
<span class="math display" id="eq:simweibull">\[\label{eq:sim:weibull}
  \rho^{-1}\{ (\rho t_0)^\kappa - \log (1-\tau) \}^{(1/\kappa)}- t_0 = \exp\{\beta_0 + \beta_1 X_1\},   \tag{9}\]</span>
for a specified <span class="math inline">\(t_0\)</span> and <span class="math inline">\(\tau\)</span>. We set the intercept
<span class="math inline">\(\beta_0 = \log(5)\)</span> and <span class="math inline">\(\beta_1 = \log(2)\)</span> at <span class="math inline">\(t_0 = 0\)</span>. Given <span class="math inline">\(\rho\)</span>,
<span class="math inline">\(\tau\)</span>, and <span class="math inline">\(X_1\)</span>, the true values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> can be
obtained sequentially from Equation <a href="#eq:simweibull">(9)</a> for different
<span class="math inline">\(t_0 &gt; 0\)</span>. In our case, the corresponding true values of <span class="math inline">\(\beta_0\)</span> are
approximately 1.411 and 1.219 for <span class="math inline">\(t_0=1\)</span> and 2, respectively.
Similarly, the true values of <span class="math inline">\(\beta_1\)</span> are approximately 0.797 and
0.907 for <span class="math inline">\(t_0=1\)</span> and 2, respectively. The closed-form expression for
generating <span class="math inline">\(T\)</span> is then <span class="math inline">\(\{ -\log(1 - u) \}^{1/\kappa} / \rho\)</span>, where <span class="math inline">\(u\)</span>
is a uniform random variable over <span class="math inline">\((0, 1)\)</span>. Given these specifications,
we have implemented the <code>data.gen()</code> function to generate simulation
data. The <code>data.gen()</code> function takes four arguments: <code>n</code>, <code>t0</code>, <code>cen</code>,
and <code>Q</code>, representing the sample size, <span class="math inline">\(t_0\)</span>, censoring proportion, and
<span class="math inline">\(\tau\)</span>, respectively. We generate censoring times <span class="math inline">\(C\)</span> from an
independent uniform distribution over <span class="math inline">\((0, c)\)</span>, where <span class="math inline">\(c\)</span> is chosen to
achieve the desired censoring proportions of 10% and 30%. Using the
generated dataset, we fit the model using three different estimation
methods: induced smoothing, non-smooth, and iterative-induced smoothing.
All analyses were conducted on a 4.2 GHz Intel(R) quad Core(TM) i7-7700K
central processing unit (CPU) using R 4.3.0 <span class="citation" data-cites="r2021">(<a href="#ref-r2021" role="doc-biblioref">R Core Team 2021</a>)</span>. The following code
demonstrates the implementation of <code>data.gen()</code> to generate a simulation
dataset.</p>
<p>The <code>data.gen()</code> function generates a <code>data.frame</code> containing seven
variables. The <code>Time</code> variable represents the observed survival time,
while the <code>status</code> variable serves as the event indicator, taking the
value 1 for observed events and 0 for censored observations. The
variables <code>X1</code>, <span class="math inline">\(\ldots\)</span>, <code>X5</code> are the covariates. The implementation in
the <code>data.gen()</code> function generates the Weibull survival times using the
inverse probability integral transform technique. Alternatively, users
can use the <code>rweibull()</code> function with the parameters <code>shape = 2</code> and
<code>scale = 1 / rho</code> to generate these Weibull survival times directly.</p>
<p>We assess the performance of the proposed implementation across various
scenarios, including three sample sizes (<span class="math inline">\(n = 200, 400, 1000\)</span>), three
levels of <span class="math inline">\(t_0\)</span> (<span class="math inline">\(0, 1, 2\)</span>), two censoring proportions (10% and 30%),
and two values of <span class="math inline">\(\tau\)</span> (0.25 and 0.50). For a given dataset, we apply
the full-multiplier bootstrapping approach with 200 bootstrap samples to
all three available estimating procedures: <code>method = "nonsmooth"</code>,
<code>method = "smooth"</code>, and <code>method = "iterative"</code>. To facilitate the
evaluation process, we create the <code>do_fmb()</code> function to record the
coefficient estimates, standard errors, and computing times for fitting
a single simulated dataset generated from <code>data.gen()</code>. The following is
the implementation of the <code>do_fmb()</code> function and the corresponding code
to run the simulation with 200 replications. We present the code and
result of the simulation experiments conducted at three different sample
sizes, with <span class="math inline">\(t_0\)</span> values set to 0 and 1, while holding the censoring
proportion at 30% and <span class="math inline">\(\tau\)</span> value at 0.5. The results for other
simulation scenarios are provided in the Supplementary Materials.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>do_fmb</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span>, <span class='va'>cen</span>, <span class='va'>Q</span>, <span class='va'>nB</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>data.gen</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span>, <span class='va'>cen</span>, <span class='va'>Q</span><span class='op'>)</span></span>
<span>  <span class='va'>fm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>Time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span> <span class='op'>+</span> <span class='va'>X4</span> <span class='op'>+</span> <span class='va'>X5</span></span>
<span>  <span class='va'>stamp</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span>  <span class='va'>stamp</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='va'>f1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>dat</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, Q <span class='op'>=</span> <span class='va'>Q</span>, nB <span class='op'>=</span> <span class='va'>nB</span>, method <span class='op'>=</span> <span class='st'>"smooth"</span>, se <span class='op'>=</span> <span class='st'>"fmb"</span><span class='op'>)</span></span>
<span>  <span class='va'>stamp</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='va'>f2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>dat</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, Q <span class='op'>=</span> <span class='va'>Q</span>, nB <span class='op'>=</span> <span class='va'>nB</span>, method <span class='op'>=</span> <span class='st'>"nonsmooth"</span>, se <span class='op'>=</span> <span class='st'>"fmb"</span><span class='op'>)</span></span>
<span>  <span class='va'>stamp</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='va'>f3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>dat</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, Q <span class='op'>=</span> <span class='va'>Q</span>, nB <span class='op'>=</span> <span class='va'>nB</span>, method <span class='op'>=</span> <span class='st'>"iterative"</span>, se <span class='op'>=</span> <span class='st'>"fmb"</span><span class='op'>)</span></span>
<span>  <span class='va'>stamp</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>smooth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>f1</span><span class='op'>$</span><span class='va'>coef</span>, <span class='va'>f1</span><span class='op'>$</span><span class='va'>std</span><span class='op'>)</span>,</span>
<span>       nonsmooth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>f2</span><span class='op'>$</span><span class='va'>coef</span>, <span class='va'>f2</span><span class='op'>$</span><span class='va'>std</span><span class='op'>)</span>,</span>
<span>       iter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>f3</span><span class='op'>$</span><span class='va'>coef</span>, <span class='va'>f3</span><span class='op'>$</span><span class='va'>std</span><span class='op'>)</span>,</span>
<span>       times <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>stamp</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='va'>sims0_fmb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='va'>B</span>, <span class='fu'>do_fmb</span><span class='op'>(</span><span class='va'>n</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, cen <span class='op'>=</span> <span class='fl'>.3</span>, Q <span class='op'>=</span> <span class='fl'>.5</span>, nB <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fl'>400</span>, <span class='fl'>1000</span><span class='op'>)</span>, t0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, SIMPLIFY <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span>
<span><span class='va'>sim1_fmb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='va'>B</span>, <span class='fu'>do_fmb</span><span class='op'>(</span><span class='va'>n</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, cen <span class='op'>=</span> <span class='fl'>.3</span>, Q <span class='op'>=</span> <span class='fl'>.5</span>, nB <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fl'>400</span>, <span class='fl'>1000</span><span class='op'>)</span>, t0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, SIMPLIFY <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Figure <a href="#fig:figsim1t0">1</a> displays violin plots that provide visualizations
of the empirical distribution of the coefficient estimates. As expected,
all three estimators exhibit small biases, which are calculated as the
difference between the point estimates (PE) and the true regression
coefficients. Furthermore, the empirical distributions of the PEs
demonstrate a normal-like shape, aligning with the asymptotic properties
of the proposed method <span class="citation" data-cites="li2016quantile kim2023smoothed">(<a href="#ref-li2016quantile" role="doc-biblioref">Li et al. 2016</a>; <a href="#ref-kim2023smoothed" role="doc-biblioref">Kim et al. 2023</a>)</span>. When the
sample size is smaller (e.g., <span class="math inline">\(n = 200\)</span> and 400), the <code>nonsmooth</code>
approach appears to yield slightly larger empirical standard errors
(ESE) compared to the <code>smooth</code> or <code>iterative</code> approaches. However, when
<span class="math inline">\(n = 1000\)</span>, the ESEs are similar across all approaches. On the other
hand, the comprehensive simulation results presented in Table 1 of the
Supplementary Materials confirm that all coefficient estimates closely
approximate the true regression coefficients. On the other hand, the
ESEs and the averaged estimated standard errors (ASE) are in close
agreement for all scenarios, indicating the validity of the variance
estimation. Furthermore, the computation times, which are presented
separately in the upper panel of Table <a href="#tab:time">1</a>, indicate that
when employing the full multiplier bootstrapping approach, the
<code>nonsmooth</code> approach demonstrates a slight advantage in terms of
computational efficiency over the <code>smooth</code> approach, while the
<code>iterative</code> approach takes 5.1 to 9.5 times longer than the <code>smooth</code>
approach. In summary, the timing results show that the proposed method
can yield valid inference results within seconds, even with large
datasets of up to 1000 observations or when using the computationally
demanding full multiplier bootstrapping approach for variance
estimation.</p>
<div class="figure*">
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figsim1t0"></span>
<img src="vplot_t0_c3_Q50.png" alt="graphic without alt text" width="95.0%" />
<p class="caption">
Figure 1: <span class="math inline">\(t_0 = 0\)</span>
</p>
</div>
</div>
<p><br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figsim1t1"></span>
<img src="vplot_t1_c3_Q50.png" alt="graphic without alt text" width="95.0%" />
<p class="caption">
Figure 2: <span class="math inline">\(t_0 = 1\)</span>
</p>
</div>
</div>
</div>
<p>When <span class="math inline">\(t_0 = 0\)</span>, the targeted semiparametric quantile regression model
for residual life simplifies to the standard quantile regression model
for survival time. In such cases, existing functions like <code>crq()</code> from
the <a href="https://CRAN.R-project.org/package=quantreg"><strong>quantreg</strong></a> package
<span class="citation" data-cites="quantregpackage">(<a href="#ref-quantregpackage" role="doc-biblioref">Koenker 2022</a>)</span> can be employed. A comparison between the performance
of <code>crq()</code> and our proposed implementation when <span class="math inline">\(t_0 = 0\)</span> is presented
in the Supplementary Materials, where the standard errors of the <code>crq()</code>
are obtained from the bootstrap method with 200 bootstrap samples.
Overall, the performance of <code>crq()</code> is comparable to the proposed
methods in terms of bias and standard errors. However, we have
occasionally encountered situations where the <code>crq()</code> function fails to
converge, particularly when the sample size is large, as in the case of
<span class="math inline">\(n = 1000\)</span>. In the other extended simulation scenarios outlined in the
Supplementary Materials, which encompass various levels of <span class="math inline">\(t_0\)</span>,
censoring proportions, and <span class="math inline">\(\tau\)</span>, the proposed methods consistently
exhibit satisfactory performance across all settings.</p>
<p>The true potential of the proposed smooth approach lies in its
capability for efficient variance estimation through the implementation
of the partial multiplier bootstrapping approach. This approach
eliminates the need for repetitive solving of estimating equations,
resulting in improved computational efficiency in variance estimation.
To demonstrate its usefulness, we conducted a simulation using both the
smooth approach and the iterative approach with the partial multiplier
bootstrapping approach (<code>se = "pmb"</code>). This simulation was conducted
under the settings of <span class="math inline">\(\tau = 0.5\)</span>, <span class="math inline">\(t_0 = 0\)</span> and <span class="math inline">\(1\)</span>, and a 30%
censoring rate. The <code>do_pmb()</code> function was accordingly modified as
follows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>do_pmb</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span>, <span class='va'>cen</span>, <span class='va'>Q</span>, <span class='va'>nB</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>data.gen</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span>, <span class='va'>cen</span>, <span class='va'>Q</span><span class='op'>)</span></span>
<span>  <span class='va'>fm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>Time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span> <span class='op'>+</span> <span class='va'>X4</span> <span class='op'>+</span> <span class='va'>X5</span></span>
<span>  <span class='va'>stamp</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span>  <span class='va'>stamp</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='va'>f1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>dat</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, Q <span class='op'>=</span> <span class='va'>Q</span>, nB <span class='op'>=</span> <span class='va'>nB</span>, method <span class='op'>=</span> <span class='st'>"smooth"</span>, se <span class='op'>=</span> <span class='st'>"pmb"</span><span class='op'>)</span></span>
<span>  <span class='va'>stamp</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='va'>f2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='va'>fm</span>, data <span class='op'>=</span> <span class='va'>dat</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, Q <span class='op'>=</span> <span class='va'>Q</span>, nB <span class='op'>=</span> <span class='va'>nB</span>, method <span class='op'>=</span> <span class='st'>"iterative"</span>, se <span class='op'>=</span> <span class='st'>"pmb"</span><span class='op'>)</span></span>
<span>  <span class='va'>stamp</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>smooth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>f1</span><span class='op'>$</span><span class='va'>coef</span>, <span class='va'>f1</span><span class='op'>$</span><span class='va'>std</span><span class='op'>)</span>,</span>
<span>       iter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>f2</span><span class='op'>$</span><span class='va'>coef</span>, <span class='va'>f2</span><span class='op'>$</span><span class='va'>std</span><span class='op'>)</span>,</span>
<span>       times <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>stamp</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='va'>sims0_pmb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='va'>B</span>, <span class='fu'>do_pmb</span><span class='op'>(</span><span class='va'>n</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, cen <span class='op'>=</span> <span class='fl'>.3</span>, Q <span class='op'>=</span> <span class='fl'>.5</span>, nB <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fl'>400</span>, <span class='fl'>1000</span><span class='op'>)</span>, t0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, SIMPLIFY <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span>
<span><span class='va'>sims1_pmb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>t0</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='va'>B</span>, <span class='fu'>do_pmb</span><span class='op'>(</span><span class='va'>n</span>, t0 <span class='op'>=</span> <span class='va'>t0</span>, cen <span class='op'>=</span> <span class='fl'>.3</span>, Q <span class='op'>=</span> <span class='fl'>.5</span>, nB <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fl'>400</span>, <span class='fl'>1000</span><span class='op'>)</span>, t0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, SIMPLIFY <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The simulation results obtained using the partial multiplier
bootstrapping approach are presented in Figure <a href="#fig:figsim2t0">3</a> and
Tables 7 – 12 in the Supplementary Materials, while the computing times
are displayed in the lower panel of Table <a href="#tab:time">1</a>. Overall, the
estimation results obtained using <code>se = "pmb"</code> in Figure <a href="#fig:figsim2t0">3</a>
closely resemble those in Figure <a href="#fig:figsim1t0">1</a> with <code>se = "fmb"</code>. As
seen in Tables 7 and 8, the ESEs from the non-iterative and iterative
methods are comparable, while the ASEs slightly overestimate the ESEs
when the sample size is small. The gaps are slightly smaller for the
iterative method, as shown in some cases
<span class="citation" data-cites="johnson2009induced kim2021comparison">(<a href="#ref-johnson2009induced" role="doc-biblioref">Johnson and Strawderman 2009</a>; <a href="#ref-kim2021comparison" role="doc-biblioref">Kim et al. 2021</a>)</span>. The magnitudes of the
differences are not large, and they also become smaller when the sample
size reaches <span class="math inline">\(n = 1000\)</span>. More importantly, the computing times with
<code>se = "pmb"</code> show significant speed improvements compared to when
<code>se = "fmb"</code> is used in every case; we observed up to 79% timing
improvements.</p>
<div class="figure*">
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figsim2t0"></span>
<img src="vplot_pmb_t0_c3_Q50.png" alt="graphic without alt text" width="95.0%" />
<p class="caption">
Figure 3: <span class="math inline">\(t_0 = 0\)</span>
</p>
</div>
</div>
<p><br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figsim2t1"></span>
<img src="vplot_pmb_t1_c3_Q50.png" alt="graphic without alt text" width="95.0%" />
<p class="caption">
Figure 4: <span class="math inline">\(t_0 = 1\)</span>
</p>
</div>
</div>
</div>
<div id="tab:time">
<table style="width:98%;">
<caption>Table 1: Runtimes (in seconds) when <code>se = fmb</code> and <code>se = pmb</code>.</caption>
<colgroup>
<col style="width: 36%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 2%" />
<col style="width: 2%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th></th>
<th style="text-align: right;"><span class="math inline">\(t_0 = 0\)</span></th>
<th></th>
<th></th>
<th style="text-align: right;"><span class="math inline">\(t_0 = 1\)</span></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>se</td>
<td>method</td>
<td style="text-align: right;">200</td>
<td>400</td>
<td>1000</td>
<td style="text-align: right;">200</td>
<td>400</td>
<td>1000</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>fmb</code></td>
<td>Smooth</td>
<td style="text-align: right;">0.103</td>
<td>0.174</td>
<td>0.471</td>
<td style="text-align: right;">0.106</td>
<td>0.178</td>
<td>0.480</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>Nonsmooth</td>
<td style="text-align: right;">0.080</td>
<td>0.142</td>
<td>0.472</td>
<td style="text-align: right;">0.080</td>
<td>0.141</td>
<td>0.468</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Iterative</td>
<td style="text-align: right;">0.981</td>
<td>1.500</td>
<td>2.410</td>
<td style="text-align: right;">0.985</td>
<td>1.567</td>
<td>2.882</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>pmb</code></td>
<td>Smooth</td>
<td style="text-align: right;">0.022</td>
<td>0.052</td>
<td>0.223</td>
<td style="text-align: right;">0.022</td>
<td>0.053</td>
<td>0.224</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Iterative</td>
<td style="text-align: right;">0.296</td>
<td>0.580</td>
<td>1.407</td>
<td style="text-align: right;">0.296</td>
<td>0.581</td>
<td>1.435</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>After confirming the satisfactory performance of the proposed
methodologies, we now proceed to illustrate the application of the
<code>init</code> argument. This argument controls the initial values assigned to
the root-finding algorithm’s estimates and the plotting capacity of the
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package. For this
illustrative example, we consider a simpler simulation scenario that
involves a single binary covariate. This simplified simulation can be
generated using the revised version of the <code>data.gen()</code> function
provided below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>## Global parameters</span></span>
<span><span class='va'>rho0</span> <span class='op'>&lt;-</span> <span class='fl'>.2</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>rho1</span> <span class='op'>&lt;-</span> <span class='fl'>.1</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>data.gen</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>censoring <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='fl'>23.41</span><span class='op'>)</span>,</span>
<span>                      Time0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>                      X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>1</span>, <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='va'>dat</span><span class='op'>$</span><span class='va'>Time0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>X</span> <span class='op'>&gt;</span> <span class='fl'>0</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>Time0</span> <span class='op'>/</span> <span class='va'>rho1</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>Time0</span> <span class='op'>/</span> <span class='va'>rho0</span><span class='op'>)</span></span>
<span>    <span class='va'>dat</span><span class='op'>$</span><span class='va'>Time</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>pmin</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Time0</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>censoring</span><span class='op'>)</span></span>
<span>    <span class='va'>dat</span><span class='op'>$</span><span class='va'>status</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Time0</span> <span class='op'>&lt;</span> <span class='va'>dat</span><span class='op'>$</span><span class='va'>censoring</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>dat</span>, select <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Time</span>, <span class='va'>status</span>, <span class='va'>X</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>data.gen</span><span class='op'>(</span><span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>       Time status X
1  6.034713      1 1
2  7.181451      0 1
3  9.993908      0 1
4 16.225520      0 1
5  1.993033      0 1
6  5.277471      0 0</code></pre>
</div>
<p>The updated <code>data.gen()</code> function returns a <code>data.frame</code> comprising
three variables: <code>Time</code>, <code>status</code>, and <code>X</code>, representing the observed
survival time, event indicator, and binary covariate, respectively. We
will first illustrate the usage of the argument <code>init</code> by considering
three different initial values: <code>init = "rq"</code>, <code>init = c(1,1)</code>, and a
random vector <code>init = rnorm(2)</code>, all used in conjunction with the smooth
estimator <code>method = "smooth"</code>. The following codes provide an example
with different initial values.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='op'>(</span><span class='va'>random</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 1.5025446 0.5904095</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>f1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>Time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>X</span>, data <span class='op'>=</span> <span class='va'>dat</span>, t0 <span class='op'>=</span> <span class='fl'>1</span>, init <span class='op'>=</span> <span class='st'>"rq"</span>, nB <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>f2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>f1</span>, init <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>f3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>f1</span>, init <span class='op'>=</span> <span class='va'>random</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>f1</span><span class='op'>$</span><span class='va'>coef</span>, <span class='va'>f2</span><span class='op'>$</span><span class='va'>coef</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>f2</span><span class='op'>$</span><span class='va'>coef</span>, <span class='va'>f3</span><span class='op'>$</span><span class='va'>coef</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
</div>
<p>The ‘<code>qris</code>’ object, with its <code>call</code> component, is compatible with the
<code>update()</code> function, a built-in function commonly used for updating the
attributes of an existing object without requiring redundant and
repetitive code. In the example above, we used the <code>update()</code> function
to modify the initial value specification in <code>f1</code>. We observed that
different initial values yield identical point estimates, thereby
affirming the robustness of the proposed method against fluctuations in
initial values.</p>
<p>The covariate effects, along with their associated 95% point-wise
confidence intervals across various quantiles or base times, can be
visually assessed by applying the generic function <code>plot()</code> to a
‘<code>qris</code>’ object. We demonstrate this feature using the following <code>qris</code>
fit, where the standard errors are obtained using <code>se = "pmb"</code>,
<span class="math inline">\(t_0 = 1\)</span>, and all other parameters are set to their default values. We
update the <code>qris</code> fit with extended quantiles over
<span class="math inline">\({0.4, 0.5, 0.6, 0.7}\)</span> and plot the covariate effects against these
quantiles using the <code>plot()</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>Time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>X</span>, data <span class='op'>=</span> <span class='va'>dat</span>, t0 <span class='op'>=</span> <span class='fl'>1</span>, se <span class='op'>=</span> <span class='st'>"pmb"</span><span class='op'>)</span></span>
<span><span class='va'>fit2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.extend.html'>qris.extend</a></span><span class='op'>(</span><span class='va'>fit</span>, Qs <span class='op'>=</span> <span class='fl'>4</span><span class='op'>:</span><span class='fl'>7</span> <span class='op'>/</span> <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The extended ‘<code>qris</code>’ fit generated by the <code>qris.extend()</code> function
inherits all the attributes from the original ‘<code>qris</code>’ object and
includes additional <code>ggdat</code> components. The following code compares the
components of the returned values from the extended ‘<code>qris</code>’ fit and the
original ‘<code>qris</code>’ fit.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>fit2</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;qris&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;call&quot;        &quot;coefficient&quot; &quot;data&quot;        &quot;formula&quot;    
[5] &quot;para&quot;        &quot;stderr&quot;      &quot;varNames&quot;    &quot;vcov&quot;       </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>fit2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;ggdat&quot;</code></pre>
</div>
<p>Specifically, the extended ‘<code>qris</code>’ fit inherits <code>call</code>, <code>coefficient</code>,
<code>para</code>, <code>stderr</code>, <code>varNames</code>, and <code>vcov</code> from the original ‘<code>qris</code>’
object. The <code>call</code> component is the function call from the original
<code>qris()</code> fit, while <code>coefficient</code>, <code>stderr</code>, and <code>vcov</code> are used to
store the point estimates, standard error estimates, and covariance
matrix, respectively. The <code>para</code> component is a list containing the
parameters specified during the fitting of the quantile regression
model, and <code>varNames</code> is a character string representing the variable
names in the function call. The newly added values are <code>ggdat</code> and <code>gg</code>.
The <code>ggdat</code> is a data frame containing covariate information generated
under the different quantiles and base times specified in the
<code>qris.extend()</code>. Finally, the corresponding covariate effect plot can be
generated by plotting the extended ‘<code>qris</code>’ fit as follows.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="RJ-2024-007_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<p>The true values of <span class="math inline">\(\beta\)</span>’s at different quantiles and base times,
computed from Equation <a href="#eq:simweibull">(9)</a>, can be implemented in the
following commands.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>## Global parameters </span></span>
<span><span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>1</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>10</span></span>
<span><span class='va'>k</span> <span class='op'>&lt;-</span> <span class='fl'>2</span></span>
<span><span class='va'>trueB</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>t0</span>, <span class='va'>tau</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='va'>r</span> <span class='op'>*</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>r</span> <span class='op'>*</span> <span class='va'>t0</span><span class='op'>)</span> <span class='op'>^</span> <span class='va'>k</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>tau</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='va'>k</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>t0</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>b</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>b</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='va'>true_Q</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>:</span><span class='fl'>7</span> <span class='op'>/</span> <span class='fl'>10</span>, <span class='va'>trueB</span>, t0 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>true_t0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='va'>trueB</span>, tau <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The following code extends the ‘<code>ggplot</code>’ objects generated by
<code>plot.qris()</code> by adding additional layers of true value curves and
incorporating various <code>ggplot</code> options. The resulting figures,
Figure <a href="#fig:figsimulation-quantile">5</a> and
Figure <a href="#fig:figsimulation-t0">6</a>, present the output based on whether
the covariate effects are plotted against quantiles or base times,
respectively. This observed trend aligns with the specifications
described in Equation <a href="#eq:simweibull">(9)</a>, where increasing <span class="math inline">\(\tau\)</span>
corresponds to an increasing <span class="math inline">\(\beta_0\)</span> while keeping <span class="math inline">\(\rho\)</span> and <span class="math inline">\(X\)</span>
fixed. On the other hand, the covariate effect does not change with
quantiles but slightly increases with base times, echoing the model
specification where <span class="math inline">\(\beta_0\)</span> is inversely related to <span class="math inline">\(t_0\)</span> and
<span class="math inline">\(\beta_1\)</span> increases as <span class="math inline">\(t_0\)</span> increases.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Qs</span>, y <span class='op'>=</span> <span class='va'>true_Q</span>, col <span class='op'>=</span> <span class='va'>variable</span>, linetype <span class='op'>=</span> <span class='st'>"True value"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_linetype_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>""</span>, values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"True value"</span> <span class='op'>=</span> <span class='st'>"dotdash"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<img src="RJ-2024-007_files/figure-html5/unnamed-chunk-14-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit2</span>, t0s <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, byQs <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span>
<span><span class='va'>b</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>t0s</span>, y <span class='op'>=</span> <span class='va'>true_t0</span>, col <span class='op'>=</span> <span class='va'>variable</span>,</span>
<span>                  linetype <span class='op'>=</span> <span class='st'>"True value"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_linetype_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>""</span>, values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"True value"</span> <span class='op'>=</span> <span class='st'>"dotdash"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="RJ-2024-007_files/figure-html5/unnamed-chunk-14-2.png" width="624" /></p>
</div>
<div class="figure*">
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figsimulation-quantile"></span>
<img src="simulation_smooth_quantile.png" alt="graphic without alt text" width="100.0%" />
<p class="caption">
Figure 5: Plot for <span class="math inline">\(Q\in\{0.4, \ldots, 0.7\}\)</span> at <span class="math inline">\(t_0 = 1\)</span>
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figsimulation-t0"></span>
<img src="simulation_smooth_t0.png" alt="graphic without alt text" width="100.0%" />
<p class="caption">
Figure 6: Plot for <span class="math inline">\(t_0\in\{1, \ldots, 3\}\)</span> at <span class="math inline">\(Q = 0.5\)</span>
</p>
</div>
</div>
</div>
<h4 class="unnumbered" data-number="4.2" id="subsec:lung">North Central Cancer Treatment Group Lung Cancer Data</h4>
<p>The North Central Cancer Treatment Group Lung Cancer Data records the
survival of patients with advanced lung cancer, along with assessments
of the patients’ performance status measured by both physicians and the
patients themselves <span class="citation" data-cites="loprinzi1994prospective">(<a href="#ref-loprinzi1994prospective" role="doc-biblioref">Loprinzi et al. 1994</a>)</span>. The original objective
of the study was to ascertain whether descriptive information from a
patient-completed questionnaire could offer prognostic insights. The
original objective of the study was to determine whether descriptive
information from a patient-completed questionnaire could provide
prognostic information. However, for this illustration, we focus on how
gender and weight loss affect the quantiles of residual life for
patients diagnosed with advanced lung cancer at different time points.
The lung cancer data are publicly available from the
<a href="https://CRAN.R-project.org/package=survival"><strong>survival</strong></a> package
<span class="citation" data-cites="survivalpackage">(<a href="#ref-survivalpackage" role="doc-biblioref">Therneau 2021</a>)</span> as <code>lung</code>. The following code displays the structure
of the <code>lung</code> dataset with variables of interest.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>cancer</span>, package <span class='op'>=</span> <span class='st'>"survival"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>lung</span>, select <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>status</span>, <span class='va'>sex</span>, <span class='va'>wt.loss</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>&#39;data.frame&#39;:   228 obs. of  4 variables:
 $ time   : num  306 455 1010 210 883 ...
 $ status : num  2 2 1 2 2 1 2 2 2 2 ...
 $ sex    : num  1 1 1 1 1 1 2 2 1 1 ...
 $ wt.loss: num  NA 15 15 11 0 0 10 1 16 34 ...</code></pre>
</div>
<p>The <code>lung</code> data contains 228 patients whose observed survival times in
days and censoring status (1 = censored, 2 = dead) are recorded in the
<code>time</code> and the <code>status</code> columns, respectively. Although the censoring
status in this dataset is not recorded in the typical 0-1 fashion, the
<code>Surv()</code> function is still applicable to create the corresponding
“<code>Surv</code>" object. The <code>lung</code> data yields a censoring rate of <span class="math inline">\(27.6\%\)</span>
with a median survival time of 310 days. The covariates of interest are
gender (<code>sex = 1</code> if male, <code>sex = 2</code> if female) and weight loss
(<code>wt.loss</code>). In the following, we use the proposed semiparametric
quantile regression models to assess the gender and standardized weight
loss effects on different quantiles of residual life at different base
times.</p>
<p>We first model the median residual life (<code>Q = 0.5</code>) when the base time
is one month (<code>t0 = 30</code>). Since the estimated median survival times for
combined lung cancers are typically less than one year, with a range of
8 to 13 months <span class="citation" data-cites="siegel2021cancer">(<a href="#ref-siegel2021cancer" role="doc-biblioref">Siegel et al. 2021</a>)</span>, setting the base time at one month
provides insight into how gender and weight loss impact the residual
time in early follow-up. In the following, we obtain the regression
coefficient estimates using the induced smoothing functions and the
corresponding variance estimate with the partial multiplier bootstrap
approach.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lung</span><span class='op'>$</span><span class='va'>male</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>lung</span><span class='op'>$</span><span class='va'>sex</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Male"</span>, <span class='st'>"Female"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>lung</span><span class='op'>$</span><span class='va'>std.wt.loss</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>lung</span><span class='op'>$</span><span class='va'>wt.loss</span><span class='op'>)</span></span>
<span><span class='va'>fit1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/qris/man/qris.html'>qris</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>male</span> <span class='op'>+</span> <span class='va'>std.wt.loss</span>,</span>
<span>             data <span class='op'>=</span> <span class='va'>lung</span>, t0 <span class='op'>=</span> <span class='fl'>30</span>, Q <span class='op'>=</span> <span class='fl'>.5</span>, nB <span class='op'>=</span> <span class='fl'>100</span>,</span>
<span>             method <span class='op'>=</span> <span class='st'>"smooth"</span>, se <span class='op'>=</span> <span class='st'>"pmb"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
qris(formula = Surv(time, status) ~ male + std.wt.loss, data = lung, 
    t0 = 30, Q = 0.5, nB = 100, method = &quot;smooth&quot;, se = &quot;pmb&quot;)

qris Estimator
            estimate std.Error z.value p.value    
(Intercept)   5.5611    0.0950  58.539  &lt;2e-16 ***
maleFemale    0.4804    0.1616   2.972  0.0030 ** 
std.wt.loss  -0.0731    0.0807  -0.905  0.3652    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>Subjects with missing values (in any of the variables relevant for the
modeling task) are automatically removed when <code>qris()</code> is called. The
estimated intercept implies that the median residual life for patients
who have survived up to 30 days is <span class="math inline">\(\exp(5.5611) = 260.1\)</span> days for a
male with an average weight loss. More interestingly, the summary shows
that the gender effect is statistically significant at the 0.05
significance level, indicating that a female patient is expected to have
a median residual life at 30 days that is <span class="math inline">\(\exp(0.4804) = 1.617\)</span> times
that of a male patient with the same weight loss. The effect of the
weight loss is not statistically significant at the 0.05 level. In
addition to <code>summary()</code>, important statistics such as the coefficient
and variance estimates can be extracted by <code>S3</code> methods <code>coef()</code> and
<code>vcov()</code>, respectively.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>(Intercept)           X 
  1.4302204   0.9322628 </code></pre>
</div>
<p>Moreover, the corresponding 95% Wald-type confidence interval can be
printed by applying the <code>confint()</code> function to the ‘<code>qris</code>’ object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>fit1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                 2.5 %     97.5 %
(Intercept)  5.3749261 5.74731362
maleFemale   0.1636200 0.79726457
std.wt.loss -0.2312535 0.08510084</code></pre>
</div>
<p>The <code>update()</code> function can be conveniently applied to update existing
‘<code>qris</code>’ objects. The following examples update the <code>method</code> and <code>se</code>
arguments from <code>fit1</code>. The updated results yield similar coefficient
estimates, but the non-smooth procedure (<code>method = "nonsmooth"</code>) yields
slightly greater standard error estimates.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit1</span>, method <span class='op'>=</span> <span class='st'>"nonsmooth"</span>, se <span class='op'>=</span> <span class='st'>"fmb"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
qris(formula = Surv(time, status) ~ male + std.wt.loss, data = lung, 
    t0 = 30, Q = 0.5, nB = 100, method = &quot;nonsmooth&quot;, se = &quot;fmb&quot;)

qris Estimator
            estimate std.Error z.value p.value    
(Intercept)   5.5585    0.1025  54.249  &lt;2e-16 ***
maleFemale    0.4695    0.1872   2.508  0.0122 *  
std.wt.loss  -0.0668    0.0944  -0.708  0.4789    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit1</span>, method <span class='op'>=</span> <span class='st'>"iterative"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
qris(formula = Surv(time, status) ~ male + std.wt.loss, data = lung, 
    t0 = 30, Q = 0.5, nB = 100, method = &quot;iterative&quot;, se = &quot;pmb&quot;)

qris Estimator
            estimate std.Error z.value p.value    
(Intercept)   5.5599    0.0904  61.518  &lt;2e-16 ***
maleFemale    0.4818    0.1786   2.698  0.0070 ** 
std.wt.loss  -0.0716    0.0942  -0.761  0.4467    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>At a lower (<code>Q = 0.25</code>) and a higher (<code>Q = 0.75</code>) quantiles, the gender
effect remains significant at the 0.05 significance level indicating
female patients are associated with longer lower-quantile and
higher-quantile residual life than male patients with the same weight
loss. Among these models, we observed that female patients tend to have
higher coefficient estimates when fitting higher-quantile residual life.
While the sign of the estimated regression coefficient for weight loss
changes to a negative value when considering the lower quantile, the
effects remain statistically insignificant for both the lower and higher
quantiles.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit1</span>, Q <span class='op'>=</span> <span class='fl'>0.25</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
qris(formula = Surv(time, status) ~ male + std.wt.loss, data = lung, 
    t0 = 30, Q = 0.25, nB = 100, method = &quot;smooth&quot;, se = &quot;pmb&quot;)

qris Estimator
            estimate std.Error z.value p.value    
(Intercept)   4.9111    0.1000  49.115  &lt;2e-16 ***
maleFemale    0.4651    0.1851   2.513  0.0120 *  
std.wt.loss   0.0543    0.0548   0.991  0.3218    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit1</span>, Q <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
qris(formula = Surv(time, status) ~ male + std.wt.loss, data = lung, 
    t0 = 30, Q = 0.75, nB = 100, method = &quot;smooth&quot;, se = &quot;pmb&quot;)

qris Estimator
            estimate std.Error z.value p.value    
(Intercept)   6.0748    0.1085  55.971  &lt;2e-16 ***
maleFemale    0.5237    0.1621   3.231  0.0012 ** 
std.wt.loss  -0.0171    0.1083  -0.158  0.8746    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>We also consider the base time at six months <code>t0 = 180</code>, which enables
us to assess gender and weight loss effects in median residual time at a
moderate length of follow-up. The estimated effect for the gender and
weight loss increases as <span class="math inline">\(t_0\)</span> increases from <span class="math inline">\(30\)</span> days to <span class="math inline">\(180\)</span> days
and becomes significant at the 0.05 significant level. Additionally, the
effect of the weight loss seems to be associated with a shorter survival
time after <span class="math inline">\(180\)</span> days, with a <span class="math inline">\(p\)</span>-value of <span class="math inline">\(0.0008\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit1</span>, t0 <span class='op'>=</span> <span class='fl'>180</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
qris(formula = Surv(time, status) ~ male + std.wt.loss, data = lung, 
    t0 = 180, Q = 0.5, nB = 100, method = &quot;smooth&quot;, se = &quot;pmb&quot;)

qris Estimator
            estimate std.Error z.value p.value    
(Intercept)   5.2243    0.0923  56.629  &lt;2e-16 ***
maleFemale    0.5821    0.1975   2.948  0.0032 ** 
std.wt.loss  -0.2515    0.0891  -2.821  0.0048 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>The ‘<code>qris</code>’ object is designed to be compatible with <code>S3</code> methods:
<code>predict()</code> and <code>residuals()</code> functions. The following presents the
fitted survival times for two hypothetical male and female patients with
no weight loss, as well as the first five residual values for the
dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lung.new</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>male <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Male"</span>, <span class='st'>"Female"</span><span class='op'>)</span>, std.wt.loss <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>fit2</span>, newdata <span class='op'>=</span> <span class='va'>lung.new</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>       1        2 
444.9026 289.4422 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>fit2</span><span class='op'>)</span>, <span class='fl'>5</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>         1          2          3          4          5 
 -20.86127 -575.86127  232.44474 -416.82295 -555.82295 </code></pre>
</div>
<p>To better understand the covariate effects on different quantiles of
residual time and across different base times, we plot the estimated
regression coefficients of the intercept, sex, and weight loss in <code>fit1</code>
and <code>fit2</code>. Figures <a href="#fig:figrealdata-smooth">7</a>
and <a href="#fig:figrealdata-nonsmooth">8</a> display the estimated regression
coefficients when <code>method = "smooth"</code> and <code>method = "nonsmooth"</code>,
respectively, at different quantiles ranging from 0.2 and 0.5 at
<span class="math inline">\(t_0 = 30\)</span> days. The <code>plot.qris()</code> function is currently not available
for the iterative estimator. This is mainly due to an extended
computation time involved, as indicated by our simulation results, and
the nature of plotting that necessitates computations across various
quantiles or base times. As expected, the two plots show very similar
patterns. We plot the estimated regression coefficients of the
intercept, sex, and weight loss for different quantiles in the range of
0.2 to 0.5 at <span class="math inline">\(t_0= 50\)</span>, 60, 70, and 80 days
(Figure <a href="#fig:figrealdata-multi-quantile">9</a>), as well as for different
base times in the range of 50 to 80 days at <span class="math inline">\(\tau=0.2\)</span>, 0.3, 0.4, and
0.5 (Figure <a href="#fig:figrealdata-multi-basetime">10</a>). The estimation
method used is non-iterative induced smoothed estimation
(<code>method = "smooth"</code>). In Figure <a href="#fig:figrealdata-multi-quantile">9</a>,
the estimated intercept increases as the quantile increases (for a given
base time). The estimated slopes for sex remain largely the same, but
those for weight loss tend to decrease slightly across different
quantiles (for a given base time). These patterns remain consistent for
different base times. In Figure <a href="#fig:figrealdata-multi-basetime">10</a>,
the estimated intercepts increase as the quantiles increase, but with a
given quantile, they remain flat across the different base times
considered. The estimated regression coefficients for the two covariates
do not appear to change significantly for different base times.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>hide</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit1</span>, Qs <span class='op'>=</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span> <span class='op'>/</span> <span class='fl'>10</span>, byQs <span class='op'>=</span> <span class='cn'>TRUE</span>, ggextra <span class='op'>=</span> <span class='va'>hide</span><span class='op'>)</span></span></code></pre>
</div>
<img src="RJ-2024-007_files/figure-html5/unnamed-chunk-25-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit2</span>, Qs <span class='op'>=</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span> <span class='op'>/</span> <span class='fl'>10</span>, byQs <span class='op'>=</span> <span class='cn'>TRUE</span>, ggextra <span class='op'>=</span> <span class='va'>hide</span><span class='op'>)</span></span></code></pre>
</div>
<img src="RJ-2024-007_files/figure-html5/unnamed-chunk-25-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit1</span>, Qs <span class='op'>=</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span> <span class='op'>/</span> <span class='fl'>10</span>, t0s <span class='op'>=</span> <span class='fl'>5</span><span class='op'>:</span><span class='fl'>8</span> <span class='op'>*</span> <span class='fl'>10</span>, byQs <span class='op'>=</span> <span class='cn'>TRUE</span>, ggextra <span class='op'>=</span> <span class='va'>hide</span><span class='op'>)</span></span></code></pre>
</div>
<img src="RJ-2024-007_files/figure-html5/unnamed-chunk-25-3.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit1</span>, Qs <span class='op'>=</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span> <span class='op'>/</span> <span class='fl'>10</span>, t0s <span class='op'>=</span> <span class='fl'>5</span><span class='op'>:</span><span class='fl'>8</span> <span class='op'>*</span> <span class='fl'>10</span>, byQs <span class='op'>=</span> <span class='cn'>FALSE</span>, ggextra <span class='op'>=</span> <span class='va'>hide</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="RJ-2024-007_files/figure-html5/unnamed-chunk-25-4.png" width="624" /></p>
</div>
<div class="figure*">
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figrealdata-smooth"></span>
<img src="realdata_smooth_quantile.png" alt="graphic without alt text" width="100.0%" />
<p class="caption">
Figure 7: method = ”smooth” and se = ”pmb”
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figrealdata-nonsmooth"></span>
<img src="realdata_nonsmooth_quantile.png" alt="graphic without alt text" width="100.0%" />
<p class="caption">
Figure 8: method = ”nonsmooth” and se = ”fmb”
</p>
</div>
</div>
<p><br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figrealdata-multi-quantile"></span>
<img src="realdata_multi_quantile.png" alt="graphic without alt text" width="100.0%" />
<p class="caption">
Figure 9: method = ”smooth” and se = ”pmb”
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figrealdata-multi-basetime"></span>
<img src="realdata_multi_basetime.png" alt="graphic without alt text" width="100.0%" />
<p class="caption">
Figure 10: Multiple covariate effect plot against base time
</p>
</div>
</div>
</div>
<h3 data-number="5" id="sec:conclusion"><span class="header-section-number">5</span> Conclusion</h3>
<p>The purpose of the <a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a>
package is to provide a comprehensive tool for fitting quantile
regression models on residual life for right-censored survival data,
with the aim of promoting widespread dissemination and utilization. This
package implements one estimation method based on non-smooth estimating
functions and two estimation methods based on their induced smoothed
versions. The non-smooth estimator is calculated through <span class="math inline">\(L_{1}\)</span>-type
minimization while incorporating the IPCW technique, and its variance is
calculated using full multiplier bootstrapping. The first type of the
induced smoothed estimator, a non-iterative version, directly solves
estimating functions, and its variance can be calculated using either
the full multiplier bootstrapping or the robust sandwich form with
partial multiplier bootstrapping. As evidenced by the simulation
results, this enables one to substantially reduce computing times
without sacrificing estimation accuracy and stability compared to the
original non-smooth function-based method. The iterative smoothed
estimator has an advantage in obtaining more precise estimates than its
non-iterative version, although it requires longer computing times. For
all these methods, estimates of the regression coefficients and their
variances can be calculated at user-defined quantiles and base times, as
long as they are identifiable. Additionally, the package provides
features for plotting estimates with associated 95% confidence intervals
against quantiles and base times using the generic <code>plot</code> function.
These plots visualize patterns of estimates at different quantiles and
base times, helping users to easily grasp the overall picture. The
package <a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> and its
included functions are verified through illustrations using simulated
data with interpretation of the results demonstrated through a real data
application.</p>
<p>Some possible directions for extending our package are as follows.
Efforts can be made to reduce the computational burden associated with
variance estimation, which currently accounts for a significant portion
of the computing time. In particular, the iterative-induced smoothed
method employs the partial multiplier bootstrap method to calculate
variance estimates in each iteration. Since this method requires
multiple iterations, it is crucial to explore more computationally
efficient variance estimation procedures for each iteration to reduce
the currently relatively longer computation time. One approach is to
utilize a closed-form estimation of the mid-part of the sandwich-type
variance, as discussed in <span class="citation" data-cites="chiou2014fast choi2018smoothed">Chiou et al. (<a href="#ref-chiou2014fast" role="doc-biblioref">2014</a>; <a href="#ref-choi2018smoothed" role="doc-biblioref">Choi et al. 2018</a>)</span>.
Implementing this direct variance estimation in each iteration is
expected to further enhance computation efficiency. Another direction is
to generalize the approaches to allow for the inclusion of sampling
weights, which is useful for bias correction when failure time data are
generated from non-random sampling designs, such as case-cohort designs
<span class="citation" data-cites="prentice1986case chiou2015semiparametric">(<a href="#ref-prentice1986case" role="doc-biblioref">Prentice 1986</a>; <a href="#ref-chiou2015semiparametric" role="doc-biblioref">Chiou et al. 2015a</a>)</span>. The current estimating
functions implemented in the
<a href="https://CRAN.R-project.org/package=qris"><strong>qris</strong></a> package assume that
the data are randomly sampled, with sampling weights set to 1." To the
best of our knowledge, there is a lack of model-checking procedures and
model-comparison methods specifically designed for the non-smooth
estimator, and a logical next step would be to develop these procedures
for subsequent integration into the package.</p>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="6" id="cran-packages-used"><span class="header-section-number">6</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=qris">qris</a>, <a href="https://cran.r-project.org/package=quantreg">quantreg</a>, <a href="https://cran.r-project.org/package=aftgee">aftgee</a>, <a href="https://cran.r-project.org/package=ctqr">ctqr</a>, <a href="https://cran.r-project.org/package=Brq">Brq</a>, <a href="https://cran.r-project.org/package=brms">brms</a>, <a href="https://cran.r-project.org/package=cmprskQR">cmprskQR</a>, <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, <a href="https://cran.r-project.org/package=Rcpp">Rcpp</a>, <a href="https://cran.r-project.org/package=RcppArmadillo">RcppArmadillo</a>, <a href="https://cran.r-project.org/package=survival">survival</a></p>
<h3 class="appendix" data-number="7" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">7</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=Bayesian">Bayesian</a>, <a href="https://cran.r-project.org/view=ChemPhys">ChemPhys</a>, <a href="https://cran.r-project.org/view=ClinicalTrials">ClinicalTrials</a>, <a href="https://cran.r-project.org/view=Econometrics">Econometrics</a>, <a href="https://cran.r-project.org/view=Environmetrics">Environmetrics</a>, <a href="https://cran.r-project.org/view=HighPerformanceComputing">HighPerformanceComputing</a>, <a href="https://cran.r-project.org/view=MetaAnalysis">MetaAnalysis</a>, <a href="https://cran.r-project.org/view=MixedModels">MixedModels</a>, <a href="https://cran.r-project.org/view=NetworkAnalysis">NetworkAnalysis</a>, <a href="https://cran.r-project.org/view=NumericalMathematics">NumericalMathematics</a>, <a href="https://cran.r-project.org/view=Optimization">Optimization</a>, <a href="https://cran.r-project.org/view=Phylogenetics">Phylogenetics</a>, <a href="https://cran.r-project.org/view=ReproducibleResearch">ReproducibleResearch</a>, <a href="https://cran.r-project.org/view=Robust">Robust</a>, <a href="https://cran.r-project.org/view=Spatial">Spatial</a>, <a href="https://cran.r-project.org/view=Survival">Survival</a>, <a href="https://cran.r-project.org/view=TeachingStatistics">TeachingStatistics</a></p>
<h3 class="appendix" data-number="8" id="note"><span class="header-section-number">8</span> Note</h3>
<p>This article is converted from a Legacy LaTeX article using the
<a href="https://cran.r-project.org/package=texor">texor</a> package.
The pdf version is the official version. To report a problem with the html,
refer to CONTRIBUTE on the R Journal homepage.</p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Brqpackage" class="csl-entry" role="listitem">
R. Alhamzawi. <em>Brq: Bayesian analysis of quantile regression models.</em> 2020. URL <a href="https://CRAN.R-project.org/package=Brq">https://CRAN.R-project.org/package=Brq</a>. R package version 3.0.
</div>
<div id="ref-brown2005standard" class="csl-entry" role="listitem">
B. Brown and Y.-G. Wang. Standard errors and covariance matrices for smoothed rank estimators. <em>Biometrika</em>, 92(1): 149–158, 2005. URL <a href="https://doi.org/10.1093/biomet/92.1.149.">https://doi.org/10.1093/biomet/92.1.149.</a>
</div>
<div id="ref-brmspackage" class="csl-entry" role="listitem">
P.-C. Bürkner. Advanced <span>Bayesian</span> multilevel modeling with the <span>R</span> package <span class="nocase">brms</span>. <em>The R Journal</em>, 10(1): 395–411, 2018. DOI <a href="https://doi.org/10.32614/RJ-2018-017">10.32614/RJ-2018-017</a>.
</div>
<div id="ref-chen2007additive" class="csl-entry" role="listitem">
Y. Q. Chen. Additive expectancy regression. <em>Journal of the American Statistical Association</em>, 102(477): 153–166, 2007. URL <a href="https://doi.org/10.1198/016214506000000870">https://doi.org/10.1198/016214506000000870</a>.
</div>
<div id="ref-chen2006linear" class="csl-entry" role="listitem">
Y. Q. Chen and S. Cheng. Linear life expectancy regression with censored data. <em>Biometrika</em>, 93(2): 303–313, 2006. URL <a href="https://doi.org/10.1093/biomet/93.2.303">https://doi.org/10.1093/biomet/93.2.303</a>.
</div>
<div id="ref-chen2005semiparametric" class="csl-entry" role="listitem">
Y. Chen, N. Jewell, X. Lei and S. Cheng. Semiparametric estimation of proportional mean residual life model in presence of censoring. <em>Biometrics</em>, 61(1): 170–178, 2005. URL <a href="https://doi.org/10.1111/j.0006-341X.2005.030224.x">https://doi.org/10.1111/j.0006-341X.2005.030224.x</a>.
</div>
<div id="ref-aftgeepackage" class="csl-entry" role="listitem">
S. H. Chiou, S. Kang and J. Yan. <em>Aftgee: Accelerated failure time model with generalized estimating equations.</em> 2021. URL <a href="https://CRAN.R-project.org/package=aftgee">https://CRAN.R-project.org/package=aftgee</a>. R package version 1.1.6.
</div>
<div id="ref-chiou2014fast" class="csl-entry" role="listitem">
S. H. Chiou, S. Kang and J. Yan. Fast accelerated failure time modeling for case-cohort data. <em>Statistics and Computing</em>, 24(4): 559–568, 2014. URL <a href="https://doi.org/10.1007/s11222-013-9388-2">https://doi.org/10.1007/s11222-013-9388-2</a>.
</div>
<div id="ref-chiou2015semiparametric" class="csl-entry" role="listitem">
S. H. Chiou, S. Kang and J. Yan. Semiparametric accelerated failure time modeling for clustered failure times from stratified sampling. <em>Journal of the American Statistical Association</em>, 110(510): 621–629, 2015a. URL <a href="https://doi.org/10.1080/01621459.2014.917978">https://doi.org/10.1080/01621459.2014.917978</a>.
</div>
<div id="ref-chiou2015rank" class="csl-entry" role="listitem">
S. Chiou, S. Kang and J. Yan. Rank-based estimating equations with general weight for accelerated failure time models: <span>A</span>n induced smoothing approach. <em>Statistics in Medicine</em>, 34(9): 1495–1510, 2015b. URL <a href="https://doi.org/10.1002/sim.6415">https://doi.org/10.1002/sim.6415</a>.
</div>
<div id="ref-choi2018smoothed" class="csl-entry" role="listitem">
S. Choi, S. Kang and X. Huang. Smoothed quantile regression analysis of competing risks. <em>Biometrical Journal</em>, 60(5): 934–946, 2018. URL <a href="https://doi.org/10.1002/bimj.201700104">https://doi.org/10.1002/bimj.201700104</a>.
</div>
<div id="ref-cmprskQRpackage" class="csl-entry" role="listitem">
S. Dlugosz, L. Peng, R. Li and S. Shi. <em>cmprskQR: Analysis of competing risks using quantile regressions.</em> 2019. URL <a href="https://CRAN.R-project.org/package=cmprskQR">https://CRAN.R-project.org/package=cmprskQR</a>. R package version 0.9.2.
</div>
<div id="ref-Rcpppackage" class="csl-entry" role="listitem">
D. Eddelbuettel, R. Francois, J. Allaire, K. Ushey, Q. Kou, N. Russell, I. Ucar, D. Bates and J. Chambers. <em>Rcpp: Seamless r and c++ integration.</em> 2022a. URL <a href="https://CRAN.R-project.org/package=Rcpp">https://CRAN.R-project.org/package=Rcpp</a>. R package version 1.0.9.
</div>
<div id="ref-RcppArmadillopackage" class="csl-entry" role="listitem">
D. Eddelbuettel, R. Francois, D. Bates, B. Ni and C. Sanderson. <em>RcppArmadillo: <span>“Rcpp”</span> integration for the <span>“armadillo”</span> templated linear algebra library.</em> 2022b. URL <a href="https://CRAN.R-project.org/package=RcppArmadillo">https://CRAN.R-project.org/package=RcppArmadillo</a>. R package version 0.11.1.1.0.
</div>
<div id="ref-ctqrpackage" class="csl-entry" role="listitem">
P. Frumento. <em>Ctqr: <span>C</span>ensored and truncated quantile regression.</em> 2021. URL <a href="https://CRAN.R-project.org/package=ctqr">https://CRAN.R-project.org/package=ctqr</a>. R package version 2.0.
</div>
<div id="ref-huang2010quantile" class="csl-entry" role="listitem">
Y. Huang. Quantile calculus and censored regression. <em>Annals of Statistics</em>, 38(3): 1607, 2010. DOI <a href="https://doi.org/10.1214/09-AOS771">10.1214/09-AOS771</a>.
</div>
<div id="ref-johnson2009induced" class="csl-entry" role="listitem">
L. M. Johnson and R. L. Strawderman. Induced smoothing for the semiparametric accelerated failure time model: <span>A</span>symptotics and extensions to clustered data. <em>Biometrika</em>, 96(3): 577–590, 2009. URL <a href="https://doi.org/10.1093/biomet/asp025">https://doi.org/10.1093/biomet/asp025</a>.
</div>
<div id="ref-jung1996quasi" class="csl-entry" role="listitem">
S.-H. Jung. Quasi-likelihood for median regression models. <em>Journal of the American Statistical Association</em>, 91(433): 251–257, 1996. URL <a href="https://doi.org/10.1080/01621459.1996.10476683">https://doi.org/10.1080/01621459.1996.10476683</a>.
</div>
<div id="ref-jung2009regression" class="csl-entry" role="listitem">
S.-H. Jung, J.-H. Jeong and H. Bandos. Regression on quantile residual life. <em>Biometrics</em>, 65(4): 1203–1212, 2009. URL <a href="https://doi.org/10.1111/j.1541-0420.2009.01196.x">https://doi.org/10.1111/j.1541-0420.2009.01196.x</a>.
</div>
<div id="ref-Kang:fitt:2016" class="csl-entry" role="listitem">
S. Kang. Fitting semiparametric accelerated failure time models for nested case–control data. <em>Journal of Statistical Computation and Simulation</em>, 87(4): 652–663, 2017. URL <a href="https://doi.org/10.1080/00949655.2016.1222611">https://doi.org/10.1080/00949655.2016.1222611</a>.
</div>
<div id="ref-kim2023smoothed" class="csl-entry" role="listitem">
K. H. Kim, D. J. Caplan and S. Kang. Smoothed quantile regression for censored residual life. <em>Computational Statistics</em>, 38: 1001–1022, 2023. URL <a href="https://doi.org/10.1007/s00180-022-01262-z">https://doi.org/10.1007/s00180-022-01262-z</a>.
</div>
<div id="ref-R:qris" class="csl-entry" role="listitem">
K. H. Kim, S. Kang and S. H. Chiou. <em>Qris: Quantile regression model for residual lifetime using an induced smoothing approach.</em> 2022. URL <a href="https://CRAN.R-project.org/package=qris">https://CRAN.R-project.org/package=qris</a>. R package version 1.0.0.
</div>
<div id="ref-kim2021comparison" class="csl-entry" role="listitem">
K. Kim, J. Ko and S. Kang. Comparison of variance estimation methods in semiparametric accelerated failure time models for multivariate failure time data. <em>Japanese Journal of Statistics and Data Science</em>, 4(2): 1179–1202, 2021. URL <a href="https://doi.org/10.1007/s42081-021-00126-y">https://doi.org/10.1007/s42081-021-00126-y</a>.
</div>
<div id="ref-kim2012censored" class="csl-entry" role="listitem">
M.-O. Kim, M. Zhou and J.-H. Jeong. Censored quantile regression for residual lifetimes. <em>Lifetime Data Analysis</em>, 18(2): 177–194, 2012. URL <a href="https://doi.org/10.1007/s10985-011-9212-2">https://doi.org/10.1007/s10985-011-9212-2</a>.
</div>
<div id="ref-quantregpackage" class="csl-entry" role="listitem">
R. Koenker. <em>Quantreg: Quantile regression.</em> 2022. URL <a href="https://CRAN.R-project.org/package=quantreg">https://CRAN.R-project.org/package=quantreg</a>. R package version 5.87.
</div>
<div id="ref-koenker1978regression" class="csl-entry" role="listitem">
R. Koenker and G. Bassett Jr. Regression quantiles. <em>Econometrica: Journal of the Econometric Society</em>, 33–50, 1978. URL <a href="https://doi.org/10.2307/1913643">https://doi.org/10.2307/1913643</a>.
</div>
<div id="ref-koenker2004penalized" class="csl-entry" role="listitem">
R. Koenker and I. Mizera. Penalized triograms: <span>T</span>otal variation regularization for bivariate smoothing. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, 66(1): 145–163, 2004. URL <a href="https://doi.org/10.1111/j.1467-9868.2004.00437.x">https://doi.org/10.1111/j.1467-9868.2004.00437.x</a>.
</div>
<div id="ref-koenker1994quantile" class="csl-entry" role="listitem">
R. Koenker, P. Ng and S. Portnoy. Quantile smoothing splines. <em>Biometrika</em>, 81(4): 673–680, 1994. URL <a href="https://doi.org/10.1093/biomet/81.4.673">https://doi.org/10.1093/biomet/81.4.673</a>.
</div>
<div id="ref-li2016quantile" class="csl-entry" role="listitem">
R. Li, X. Huang and J. E. Cortes. Quantile residual life regression with longitudinal biomarker measurements for dynamic prediction. <em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, 65(5): 755–773, 2016. URL <a href="http://www.jstor.org/stable/44681854">http://www.jstor.org/stable/44681854</a>.
</div>
<div id="ref-liu2008regression" class="csl-entry" role="listitem">
S. Liu and S. K. Ghosh. Regression analysis of mean residual life function. North Carolina State University. Dept. of Statistics. 2008. URL <a href="https://repository.lib.ncsu.edu/bitstream/handle/1840.4/3041/mimeo2613.pdf?sequence=1">https://repository.lib.ncsu.edu/bitstream/handle/1840.4/3041/mimeo2613.pdf?sequence=1</a>.
</div>
<div id="ref-loprinzi1994prospective" class="csl-entry" role="listitem">
C. L. Loprinzi, J. A. Laurie, H. S. Wieand, J. E. Krook, P. J. Novotny, J. W. Kugler, J. Bartel, M. Law, M. Bateman and N. E. Klatt. Prospective evaluation of prognostic variables from patient-completed questionnaires. <span>N</span>orth <span>C</span>entral <span>C</span>ancer <span>T</span>reatment <span>G</span>roup. <em>Journal of Clinical Oncology</em>, 12(3): 601–607, 1994. URL <a href="https://doi.org/10.1200/JCO.1994.12.3.601">https://doi.org/10.1200/JCO.1994.12.3.601</a>.
</div>
<div id="ref-maguluri1994estimation" class="csl-entry" role="listitem">
G. Maguluri and C.-H. Zhang. Estimation in the mean residual life regression model. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, 56(3): 477–489, 1994. URL <a href="https://doi.org/10.1111/j.2517-6161.1994.tb01994.x">https://doi.org/10.1111/j.2517-6161.1994.tb01994.x</a>.
</div>
<div id="ref-oakes1990note" class="csl-entry" role="listitem">
D. Oakes and T. Dasu. A note on residual life. <em>Biometrika</em>, 77(2): 409–410, 1990. URL <a href="https://doi.org/10.1093/biomet/77.2.409">https://doi.org/10.1093/biomet/77.2.409</a>.
</div>
<div id="ref-oakes2003inference" class="csl-entry" role="listitem">
D. Oakes and T. Dasu. Inference for the proportional mean residual life model. <em>Lecture Notes-Monograph Series</em>, 105–116, 2003. URL <a href="http://www.jstor.org/stable/4356266">http://www.jstor.org/stable/4356266</a>.
</div>
<div id="ref-peng2008survival" class="csl-entry" role="listitem">
L. Peng and Y. Huang. Survival analysis with quantile regression models. <em>Journal of the American Statistical Association</em>, 103(482): 637–649, 2008. URL <a href="https://doi.org/10.1198/016214508000000355">https://doi.org/10.1198/016214508000000355</a>.
</div>
<div id="ref-portnoy2003censored" class="csl-entry" role="listitem">
S. Portnoy. Censored regression quantiles. <em>Journal of the American Statistical Association</em>, 98(464): 1001–1012, 2003. URL <a href="https://doi.org/10.1198/016214503000000954">https://doi.org/10.1198/016214503000000954</a>.
</div>
<div id="ref-portnoy1997gaussian" class="csl-entry" role="listitem">
S. Portnoy and R. Koenker. The gaussian hare and the laplacian tortoise: Computability of squared-error versus absolute-error estimators. <em>Statistical Science</em>, 12(4): 279–300, 1997. URL <a href="https://doi.org/10.1214/ss/1030037960">https://doi.org/10.1214/ss/1030037960</a>.
</div>
<div id="ref-powell1986censored" class="csl-entry" role="listitem">
J. L. Powell. Censored regression quantiles. <em>Journal of Econometrics</em>, 32(1): 143–155, 1986. URL <a href="https://doi.org/10.1016/0304-4076(86)90016-3">https://doi.org/10.1016/0304-4076(86)90016-3</a>.
</div>
<div id="ref-prentice1986case" class="csl-entry" role="listitem">
R. L. Prentice. A case-cohort design for epidemiologic cohort studies and disease prevention trials. <em>Biometrika</em>, 73(1): 1–11, 1986. URL <a href="https://doi.org/10.1093/biomet/73.1.1">https://doi.org/10.1093/biomet/73.1.1</a>.
</div>
<div id="ref-r2021" class="csl-entry" role="listitem">
R Core Team. <em>R: <span>A</span> language and environment for statistical computing.</em> Vienna, Austria: R Foundation for Statistical Computing, 2021. URL <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-siegel2021cancer" class="csl-entry" role="listitem">
R. L. Siegel, K. D. Miller, H. E. Fuchs and A. Jemal. Cancer statistics, 2021. <em>CA: A Cancer Journal for Clinicians</em>, 71(1): 7–33, 2021. URL <a href="https://doi.org/10.3322/caac.21654">https://doi.org/10.3322/caac.21654</a>.
</div>
<div id="ref-survivalpackage" class="csl-entry" role="listitem">
T. M. Therneau. <em>Survival: Survival analysis.</em> 2021. URL <a href="https://CRAN.R-project.org/package=survival">https://CRAN.R-project.org/package=survival</a>. R package version 3.2-13.
</div>
<div id="ref-wei2006quantile" class="csl-entry" role="listitem">
Y. Wei, A. Pere, R. Koenker and X. He. Quantile regression methods for reference growth charts. <em>Statistics in Medicine</em>, 25(8): 1369–1382, 2006. URL <a href="https://doi.org/10.1002/sim.2271">https://doi.org/10.1002/sim.2271</a>.
</div>
<div id="ref-ggplot2package" class="csl-entry" role="listitem">
H. Wickham, W. Chang, L. Henry, T. L. Pedersen, K. Takahashi, C. Wilke, K. Woo, H. Yutani and D. Dunnington. <em>ggplot2: Create elegant data visualisations using the grammar of graphics.</em> 2022. URL <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>. R package version 3.3.6.
</div>
<div id="ref-ying1995survival" class="csl-entry" role="listitem">
Z. Ying, S.-H. Jung and L.-J. Wei. Survival analysis with median regression models. <em>Journal of the American Statistical Association</em>, 90(429): 178–184, 1995. URL <a href="https://doi.org/10.1080/01621459.1995.10476500">https://doi.org/10.1080/01621459.1995.10476500</a>.
</div>
<div id="ref-zhang2010goodness" class="csl-entry" role="listitem">
Z. Zhang, X. Zhao and L. Sun. Goodness-of-fit tests for additive mean residual life model under right censoring. <em>Lifetime Data Analysis</em>, 16(3): 385–408, 2010. URL <a href="https://doi.org/10.1007/s10985-010-9152-2">https://doi.org/10.1007/s10985-010-9152-2</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Kim, et al., "Fitting a Quantile Regression Model for Residual Life with the R Package qris", The R Journal, 2025</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@article{RJ-2024-007,
  author = {Kim, Kyu Hyun and Kang, Sangwook and Chiou, Sy Han},
  title = {Fitting a Quantile Regression Model for Residual Life with the R Package qris},
  journal = {The R Journal},
  year = {2025},
  note = {https://doi.org/10.32614/RJ-2024-007},
  doi = {10.32614/RJ-2024-007},
  volume = {16},
  issue = {1},
  issn = {2073-4859},
  pages = {114-134}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
